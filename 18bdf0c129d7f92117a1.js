"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[821],{2174(e,t,n){n.d(t,{Sv:()=>J,m_:()=>D});var r=n(467),a=n(5767),i=n(365),u=n(3422),o=n(3459),d=n(8179),s=n(8024),l=n(4537),c=n(904),f=n(9119),p=(0,d.bv)(".mf"),h=(0,d.aI)(p,".nf"),v=(0,d.aI)(h,".of"),g=(0,d.aI)(v,".pf"),m=(0,d.aI)(p,".qf"),y=(0,d.aI)(m,".rf"),b={},A=!1,I=15e3,C=5e3,_=15e3,w=!0,x=0,E=0,L="",S=!1,T=!1,M=!1;function k(e){var t=e;if(S){var n=t.detail.progress-1;g.style.setProperty("--uf",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,k)}function $(){var e=(0,s.zx)(),t=document.createElement("div");t.classList.add("vf"),t.id=e;var n=document.createElement("div");n.classList.add("wf"),t.appendChild(n);var r=document.createElement("div");r.classList.add("xf");var a=document.createElement("div");a.classList.add("yf"),r.appendChild(a);var i=document.createElement("div");i.classList.add("zf"),r.appendChild(i);var u=document.createElement("div");u.classList.add("_f"),r.appendChild(u);var o=document.createElement("div");o.classList.add("ag");var d=document.createElement("span");return d.appendChild((0,l.YC)("close")),o.appendChild(d),r.appendChild(o),t.appendChild(r),{element:t,id:e}}function j(e,t,n){function r(e,r,a){function i(e,t){(0,d.aI)(e,".wf").innerText=t.hours}function u(e,t){var n=(0,d.aI)(e,".xf");(0,d.aI)(n,".yf").innerText=t.minutes}function o(e,t){var n=(0,d.aI)(e,".xf");(0,d.aI)(n,"._f").innerText=t.name}function l(e,t){var n=(0,d.aI)(e,".xf");(0,d.aI)(n,".zf").innerText=`${t.route.name} - 往${t.route.direction}`}function c(e,t){var n=(0,d.aI)(e,".xf");(0,d.aI)(n,".ag").onclick=function(){!function(e,t){O.apply(this,arguments)}(e.id,t.schedule_id)}}function f(e,t){e.setAttribute("first",(0,s.xZ)(t.is_first))}function p(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function h(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}null==a?(i(e,r),u(e,r),o(e,r),l(e,r),c(e,r),f(e,r),p(e,n),h(e,t)):(r.hours!==a.hours&&i(e,r),r.minutes!==a.minutes&&u(e,r),(0,s.hw)(a.schedule_id,r.schedule_id)||(o(e,r),l(e,r),c(e,r)),a.is_first!==r.is_first&&f(e,r),false!==n&&p(e,n),A!==t&&h(e,t))}var a=e.itemQuantity,i=e.items,u=(0,d.jg)(y,".vf").length;if(a!==u){var o=u-a;if(o<0){for(var l=new DocumentFragment,c=0,f=Math.abs(o);c<f;c++){var p=$();l.appendChild(p.element)}y.append(l)}else for(var h=(0,d.jg)(y,".vf"),v=0,g=Math.abs(o);v<g;v++){h[u-1-v].remove()}}for(var m=(0,d.jg)(y,".vf"),I=0;I<a;I++){var C=m[I],_=i[I];if(b.hasOwnProperty("items"))if(b.items[I])r(C,_,b.items[I]);else r(C,_,null);else r(C,_,null)}b=e,A=t}function Z(){return P.apply(this,arguments)}function P(){return(P=(0,r.A)(function*(){var e=(0,o.Js)("playing_animation"),t=(0,o.Js)("refresh_interval");w=t.dynamic,I=t.baseInterval,S=!0,L=(0,s.zx)(),g.setAttribute("refreshing","true"),g.classList.remove("tf"),document.addEventListener(L,k);var n=yield(0,u.e3)(L);j(n,!1,e);var r=0;w&&(r=yield(0,a.wz)()),x=(new Date).getTime(),E=w?Math.max(x+C,n.dataUpdateTime+I/r):x+I,_=Math.max(C,E-x),S=!1,g.setAttribute("refreshing","false"),g.style.setProperty("--sf",`${_}ms`),g.classList.add("tf")})).apply(this,arguments)}function z(){return R.apply(this,arguments)}function R(){return(R=(0,r.A)(function*(){Z().then(function(){T?setTimeout(function(){z()},Math.max(C,E-(new Date).getTime())):M=!1}).catch(function(e){T?setTimeout(function(){z()},1e4):M=!1})})).apply(this,arguments)}function J(){(0,c.WR)("NotificationScheduleManager"),p.setAttribute("displayed","true"),function(){for(var e=(0,o.Js)("playing_animation"),t=(0,c.gO)("window"),n=(t.width,t.height),r=Math.floor(n/50)+5,a=[],i=0;i<r;i++)a.push({name:"",stop_id:0,estimate_time:0,schedule_id:"null",scheduled_time:0,route:{name:"",direction:"",id:0,pathAttributeId:[]},is_first:!0,date:"",hours:"",minutes:""});j({items:a,itemQuantity:r,dataUpdateTime:0},!0,e)}(),T||(T=!0,M?Z():(M=!0,z())),(0,c.Z_)()}function D(){p.setAttribute("displayed","false"),T=!1,(0,c.l$)()}function O(){return(O=(0,r.A)(function*(e,t){if((0,f.a)("manufacturing","處理中"),yield(0,i.G)(t)){if((0,d.aI)(y,`.vf#${e}`).remove(),(0,f.a)("check_circle","已取消通知"),!S){var n=(0,o.Js)("playing_animation");j(yield(0,u.e3)(L),!1,n)}}else(0,f.a)("error","取消失敗")})).apply(this,arguments)}},5693(e,t,n){n.d(t,{Dn:()=>w,Xy:()=>_,bF:()=>C,gv:()=>b});var r=n(3453),a=n(467),i=n(5352),u=n(8179),o=n(5579),d=n(904),s=(0,u.bv)(".bg"),l=(0,u.aI)(s,".cg"),c=(0,u.aI)(s,".dg"),f=(0,u.aI)(c,".eg"),p=(0,u.aI)(l,".fg"),h=(0,u.aI)(p,'.gg[group="schedule-name"] .hg input'),v=(0,u.aI)(p,'.gg[group="schedule-start-time"] .hg input'),g=(0,u.aI)(p,'.gg[group="schedule-end-time"] .hg input'),m=(0,u.aI)(p,'.gg[group="schedule-days"] .hg'),y=(0,u.jg)(m,".ig");function b(e){return A.apply(this,arguments)}function A(){return(A=(0,a.A)(function*(e){for(var t=h.value,n=v.value,a=g.value,u=String(n).split(":").map(function(e){return parseInt(e)}),o=(0,r.A)(u,2),d=o[0],s=o[1],l=String(a).split(":").map(function(e){return parseInt(e)}),c=(0,r.A)(l,2),f=c[0],p=c[1],m=[],b=0;b<7;b++){var A=y[b],I=A.getAttribute("highlighted"),C=parseInt(A.getAttribute("day"));"true"===I&&m.push(C)}var w=yield(0,i.qZ)(e);w.name=t,w.days=m,w.period.start.hours=d,w.period.start.minutes=s,w.period.end.hours=f,w.period.end.minutes=p,yield(0,i.nL)(w),_()})).apply(this,arguments)}function I(){return(I=(0,a.A)(function*(e){var t=yield(0,i.qZ)(e);h.value=t.name,v.value=(0,o.pn)(t.period.start),g.value=(0,o.pn)(t.period.end);for(var n=0;n<7;n++){var r=y[n];t.days.indexOf(n)>-1?r.setAttribute("highlighted","true"):r.setAttribute("highlighted","false")}f.onclick=function(){b(e)}})).apply(this,arguments)}function C(e){(0,d.WR)("PersonalScheduleEditor"),s.setAttribute("displayed","true"),function(e){I.apply(this,arguments)}(e),(0,d.Z_)()}function _(){s.setAttribute("displayed","false"),(0,d.l$)()}function w(e){var t=(0,u.aI)(m,`.ig[day="${e}"]`);"true"===t.getAttribute("highlighted")?t.setAttribute("highlighted","false"):t.setAttribute("highlighted","true")}},7891(e,t,n){n.d(t,{Z:()=>m,z:()=>g});var r=n(467),a=n(5352),i=n(8179),u=n(4537),o=n(904),d=n(5693);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=(0,i.bv)(".jg"),f=(0,i.aI)(c,".kg"),p=(0,i.aI)(f,".lg");function h(e){var t=document.createElement("div");t.classList.add("mg"),t.onclick=function(){(0,d.bF)(e.id)};var n=document.createElement("div");n.classList.add("ng"),n.appendChild(document.createTextNode(e.name)),t.appendChild(n);var r=document.createElement("div");r.classList.add("og");var a=document.createElement("span");return a.appendChild((0,u.YC)("arrow_forward_ios")),r.appendChild(a),t.appendChild(r),{element:t,id:""}}function v(){return(v=(0,r.A)(function*(){p.innerHTML="";var e,t=yield(0,a.ty)(),n=new DocumentFragment,r=s(t);try{for(r.s();!(e=r.n()).done;){var i=h(e.value);n.appendChild(i.element)}}catch(e){r.e(e)}finally{r.f()}p.append(n)})).apply(this,arguments)}function g(){(0,o.WR)("PersonalScheduleManager"),c.setAttribute("displayed","true"),function(){v.apply(this,arguments)}()}function m(){(0,o.kr)("PersonalScheduleManager"),c.setAttribute("displayed","false")}},8279(e,t,n){n.d(t,{Vc:()=>s,X8:()=>d});var r=n(8179),a=n(2648),i=n(904),u=(0,r.bv)(".pg"),o=(0,r.aI)(u,".qg");function d(e){(0,i.WR)("QRCode"),u.setAttribute("displayed","true"),function(e){var t=(0,a.$)(e,"M",.5,.3,1,"var(--a)",4);o.innerHTML=t}(e)}function s(){(0,i.kr)("QRCode"),u.setAttribute("displayed","false")}},8380(e,t,n){n.d(t,{GJ:()=>y,I1:()=>m,Ps:()=>g,om:()=>b});var r=n(3453),a=n(5352),i=n(8179),u=n(904),o=n(9119),d=(0,i.bv)(".rg"),s=(0,i.aI)(d,".sg"),l=(0,i.aI)(s,".tg"),c=(0,i.aI)(l,'.ug[group="schedule-name"] .vg input'),f=(0,i.aI)(l,'.ug[group="schedule-start-time"] .vg input'),p=(0,i.aI)(l,'.ug[group="schedule-end-time"] .vg input'),h=(0,i.aI)(l,'.ug[group="schedule-days"] .vg'),v=(0,i.jg)(h,".wg");function g(){for(var e=c.value,t=f.value,n=p.value,i=String(t).split(":").map(function(e){return parseInt(e)}),u=(0,r.A)(i,2),d=u[0],s=u[1],l=String(n).split(":").map(function(e){return parseInt(e)}),h=(0,r.A)(l,2),g=h[0],m=h[1],b=[],A=0;A<7;A++){var I=v[A],C=I.getAttribute("highlighted"),_=parseInt(I.getAttribute("day"));"true"===C&&b.push(_)}(0,a.Qh)(e,d,s,g,m,b).then(function(e){e?(y(),(0,o.a)("calendar_view_day","已建立個人化行程")):(0,o.a)("error","無法建立個人化行程")})}function m(){(0,u.WR)("PersonalScheduleCreator"),d.setAttribute("displayed","true"),(0,u.Z_)()}function y(){d.setAttribute("displayed","false"),(0,u.l$)()}function b(e){var t=(0,i.aI)(h,`.wg[day="${e}"]`);"true"===t.getAttribute("highlighted")?t.setAttribute("highlighted","false"):t.setAttribute("highlighted","true")}},9119(e,t,n){n.d(t,{a:()=>l});var r=n(2284),a=n(3459),i=n(8179),u=n(8024),o=n(4537);function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){var s=(0,i.e0)(".xg");if(null!==s){var l,c=d(s);try{for(c.s();!(l=c.n()).done;){l.value.remove()}}catch(e){c.e(e)}finally{c.f()}}var f=(0,a.Js)("playing_animation"),p=document.createElement("div");p.classList.add("xg"),p.setAttribute("animation",(0,u.xZ)(f));var h=document.createElement("div");h.classList.add("yg"),h.appendChild((0,o.YC)(e)),p.appendChild(h);var v=document.createElement("div");if(v.classList.add("zg"),v.innerText=t,p.appendChild(v),"object"===(0,r.A)(n)&&null!=n&&"function"==typeof(null==n?void 0:n.action)){var g=document.createElement("div");g.classList.add("_g"),g.innerText=n.text,g.addEventListener("click",function(){n.action()},{once:!0}),p.appendChild(g)}p.addEventListener("animationend",function(e){null!=e&&e.target&&e.target.remove()},{once:!0}),document.body.appendChild(p)}}}]);
//# sourceMappingURL=18bdf0c129d7f92117a1.js.map