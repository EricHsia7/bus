"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[474],{4690(t,e,a){a.d(e,{S5:()=>at,SR:()=>bt,U7:()=>gt});var n=a(467),i=a(5767),s=a(9566),d=a(3422),r=a(5314),o=a(7123),l=a(3459),u=a(8179),c=a(7968),p=a(8024),m=a(5579),v=a(4537),f=a(904),h=a(3030),b=a(9119),g=a(3041),A=a(752),y=a(5286);function C(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return L(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?L(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("E0")}var s,d=!0,r=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return d=t.done,t},e:function(t){r=!0,s=t},f:function(){try{d||null==a.return||a.return()}finally{if(r)throw s}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=Array(e);a<e;a++)n[a]=t[a];return n}var I=(0,u.bv)(".jm"),E=(0,u.aI)(I,".tm"),x=(0,u.aI)(E,".wm"),w=(0,u.aI)(x,"span"),T=(0,u.aI)(E,".vm"),k=(0,u.aI)(E,".bn .cn"),j=(0,u.aI)(E,".xm"),_=(0,u.aI)(j,".ym"),R=(0,u.aI)(E,"._m"),S=(0,u.aI)(R,".an"),$=(0,u.aI)(I,".en"),M={},Z=!1,P=!1,D=0,N=0,B=0,z={},Y={},Q=0,F=!1,q=15e3,H=5e3,O=15e3,U=!0,J=0,W=0,G="",K=!1,X=!1,V=!1,tt=0,et=[];function at(){$.addEventListener("touchstart",function(){D=Math.round($.scrollLeft/Q)},{passive:!0}),$.addEventListener("scroll",function(t){F=!0;var e=t.target.scrollLeft/Q;N=e>D?D+1:D-1;var a=e-D,n=Math.abs(a);n>1&&(a>0?(D=Math.floor(e),N=D+1):(D=Math.ceil(e),N=D-1),n=Math.abs(e-D));var i=Y[`g_${D}`]||{width:0,offset:0},s=Y[`g_${N}`]||{width:0,offset:0},d=i.width+(s.width-i.width)*n,r=-1*(i.offset+(s.offset-i.offset)*n)+.5*Q-.5*d;nt(B,r,d-20,e)},{passive:!0}),$.addEventListener("scrollend",function(t){var e=t.target.scrollLeft/Q;D=Math.round(e),F=!1},{passive:!0})}function nt(t,e,a,n){$.style.setProperty("--im",t.toString()),S.style.setProperty("--nm",a.toString()),_.style.setProperty("--om",`${e.toString()}px`),_.style.setProperty("--qm",n.toString())}function it(t){var e=t;if(K){var a=e.detail.progress-1;k.style.setProperty("--rm",a.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,it)}function st(){var t=document.createElement("div");t.classList.add("nn"),t.setAttribute("stretched","false"),t.setAttribute("stretching","false"),t.setAttribute("push-direction","0"),t.setAttribute("push-state","0");var e=document.createElement("div");e.classList.add("on");var a=document.createElement("div");a.classList.add("yn"),a.setAttribute("displayed","false"),e.appendChild(a);var n=document.createElement("div");n.classList.add("pn");var i=document.createElement("div");i.classList.add("tf"),i.setAttribute("code","0"),i.setAttribute("displayed","false"),n.appendChild(i);var s=document.createElement("div");return s.classList.add("uf"),s.setAttribute("code","0"),s.setAttribute("displayed","true"),n.appendChild(s),t.appendChild(e),t.appendChild(n),t}function dt(t){var e=document.createElement("div");e.classList.add("jn"),e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var a=document.createElement("div");a.classList.add("kn");var n=document.createElement("div");n.classList.add("ln"),a.appendChild(n);var i=document.createElement("div");i.classList.add("mn");var s=document.createElement("div");s.classList.add("zn");var d=document.createElement("div");d.classList.add("tf"),d.setAttribute("code","0"),d.setAttribute("displayed","false"),s.appendChild(d);var r=document.createElement("div");r.classList.add("uf"),r.setAttribute("code","0"),r.setAttribute("displayed","true"),s.appendChild(r),i.appendChild(s);var o=document.createElement("div");o.classList.add("_n"),o.appendChild((0,v.YC)("keyboard_arrow_down")),o.onclick=function(){!function(t,e){var a=(0,u.aI)(t,".bo"),n=t.parentElement,i=e.parentElement,s=(0,u.ji)(e,"nn"),d=(0,u.ji)(t,"jn"),r=d.length,o=n.getBoundingClientRect(),l=t.getBoundingClientRect(),c=i.getBoundingClientRect(),p=e.getBoundingClientRect(),m=p.top-c.top,v=l.top-o.top,f="true"===t.getAttribute("stretched"),h="true"===t.getAttribute("animation");if(h){var b=f?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--op",`${m}px`),t.setAttribute("stretching","true"),t.style.setProperty("--qp",`${v}px`);for(var g=0;g<r;g++){var A=d[g],y=s[g];y.style.setProperty("--rp",(-1*g-1).toString()),y.setAttribute("push-direction",b),y.setAttribute("push-state","1"),A.setAttribute("push-direction",b),A.setAttribute("push-state","1")}t.addEventListener("transitionend",function(){for(var a=0;a<r;a++){var n=d[a],i=s[a];i.setAttribute("push-direction","0"),i.setAttribute("push-state","0"),n.setAttribute("push-direction","0"),n.setAttribute("push-state","0")}e.setAttribute("stretching","false"),t.setAttribute("stretching","false")},{once:!0}),t.addEventListener("transitionstart",function(){for(var t=0;t<r;t++){var e=d[t];s[t].setAttribute("push-state","2"),e.setAttribute("push-state","2")}},{once:!0})}f?(h?a.addEventListener("transitionend",function(){a.setAttribute("displayed","false")},{once:!0}):a.setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false")):(a.setAttribute("displayed","true"),t.setAttribute("stretched","true"),e.setAttribute("stretched","true"))}(e,t)},i.appendChild(o);var l=document.createElement("div");l.classList.add("ao"),i.appendChild(l),a.appendChild(i);var c=document.createElement("div");c.classList.add("bo"),c.setAttribute("displayed","false");var p=document.createElement("div");p.classList.add("co");var m=document.createElement("div");m.classList.add("do"),m.setAttribute("highlighted","true"),m.setAttribute("type","tab"),m.setAttribute("code","0"),m.onclick=function(){yt(e,0)};var f=document.createElement("div");f.classList.add("eo"),f.appendChild((0,v.YC)("directions_bus")),m.appendChild(f),m.appendChild(document.createTextNode("公車")),p.appendChild(m);var h=document.createElement("div");h.classList.add("do"),h.setAttribute("highlighted","false"),h.setAttribute("type","tab"),h.setAttribute("code","1"),h.onclick=function(){yt(e,1)};var b=document.createElement("div");b.classList.add("eo"),b.appendChild((0,v.YC)("departure_board")),h.appendChild(b),h.appendChild(document.createTextNode("抵達時間")),p.appendChild(h);var g=document.createElement("div");g.classList.add("do"),g.setAttribute("highlighted","false"),g.setAttribute("type","tab"),g.setAttribute("code","2"),g.onclick=function(){yt(e,2)};var A=document.createElement("div");A.classList.add("eo"),A.appendChild((0,v.YC)("route")),g.appendChild(A),g.appendChild(document.createTextNode("路線")),p.appendChild(g);var y=document.createElement("div");y.classList.add("do"),y.setAttribute("highlighted","false"),y.setAttribute("type","tab"),y.setAttribute("code","3"),y.onclick=function(){yt(e,3)};var C=document.createElement("div");C.classList.add("eo"),C.appendChild((0,v.YC)("location_on")),y.appendChild(C),y.appendChild(document.createTextNode("地點")),p.appendChild(y);var L=document.createElement("div");L.classList.add("do"),L.setAttribute("highlighted","false"),L.setAttribute("type","save-to-folder");var I=document.createElement("div");I.classList.add("eo"),I.appendChild((0,v.YC)("folder")),L.appendChild(I),L.appendChild(document.createTextNode("儲存")),p.appendChild(L);var E=document.createElement("div");E.classList.add("do"),E.setAttribute("highlighted","false"),E.setAttribute("type","schedule-notification"),E.setAttribute("enabled","true");var x=document.createElement("div");x.classList.add("eo"),x.appendChild((0,v.YC)("notifications")),E.appendChild(x),E.appendChild(document.createTextNode("通知")),p.appendChild(E),c.appendChild(p);var w=document.createElement("div");w.classList.add("fo"),w.setAttribute("displayed","true"),c.appendChild(w);var T=document.createElement("div");T.classList.add("go"),T.setAttribute("displayed","false"),c.appendChild(T);var k=document.createElement("div");k.classList.add("ho"),k.setAttribute("displayed","false"),c.appendChild(k);var j=document.createElement("div");return j.classList.add("io"),j.setAttribute("displayed","false"),c.appendChild(j),e.appendChild(a),e.appendChild(c),e}function rt(){var t=document.createElement("div");t.classList.add("fn");var e=document.createElement("div");e.classList.add("gn");var a=document.createElement("div");a.classList.add("hn");var n=document.createElement("div");n.classList.add("jo");var i=document.createElement("div");i.classList.add("in");var s=document.createElement("div");return s.classList.add("ko"),i.appendChild(s),a.appendChild(n),e.appendChild(a),e.appendChild(i),t.appendChild(e),t}function ot(){var t=document.createElement("div");t.classList.add("zm");var e=document.createElement("span");return t.appendChild(e),t}function lt(){var t=document.createElement("div");t.classList.add("lo"),t.setAttribute("on-this-route","false");var e=document.createElement("div");e.classList.add("mo");var a=document.createElement("div");a.classList.add("no"),a.appendChild((0,v.YC)("directions_bus"));var n=document.createElement("div");n.classList.add("oo");var i=document.createElement("div");i.classList.add("po");var s=document.createElement("div");s.classList.add("qo");var d=document.createElement("div");d.classList.add("ro");var r=document.createElement("div");return r.classList.add("so"),e.appendChild(a),e.appendChild(n),t.appendChild(e),i.appendChild(s),i.appendChild(d),i.appendChild(r),t.appendChild(i),t}function ut(){var t=document.createElement("div");t.classList.add("to");var e=document.createElement("div");e.classList.add("uo");var a=document.createElement("div");a.classList.add("vo"),a.appendChild((0,v.YC)("route"));var n=document.createElement("div");n.classList.add("wo");var i=document.createElement("div");i.classList.add("xo");var s=document.createElement("div");s.classList.add("yo");var d=document.createElement("div");d.classList.add("zo"),d.setAttribute("type","view-route"),d.innerText="查看路線";var r=document.createElement("div");return r.classList.add("zo"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存路線",e.appendChild(a),e.appendChild(n),t.appendChild(e),t.appendChild(i),s.appendChild(d),s.appendChild(r),t.appendChild(s),t}function ct(){var t=document.createElement("div");t.classList.add("_o");var e=document.createElement("div");e.classList.add("ap");var a=document.createElement("div");a.classList.add("bp"),a.appendChild((0,v.YC)("calendar_view_day"));var n=document.createElement("div");n.classList.add("cp");var i=document.createElement("div");i.classList.add("dp");var s=document.createElement("div");return s.classList.add("ep"),e.appendChild(a),e.appendChild(n),e.appendChild(i),t.appendChild(e),t.appendChild(s),t}function pt(){var t=document.createElement("div");t.classList.add("fp");var e=document.createElement("div");e.classList.add("gp");var a=document.createElement("div");a.classList.add("hp"),a.appendChild((0,v.YC)("location_on"));var n=document.createElement("div");n.classList.add("ip");var i=document.createElement("div");i.classList.add("jp");var s=document.createElement("div");s.classList.add("kp");var d=document.createElement("div");d.classList.add("lp"),d.setAttribute("type","view-location"),d.innerText="查看地點";var r=document.createElement("div");return r.classList.add("lp"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存地點",e.appendChild(a),e.appendChild(n),t.appendChild(e),t.appendChild(i),s.appendChild(d),s.appendChild(r),t.appendChild(s),t}function mt(t,e,a){var n,i;function r(e,a,n,i,r,o){function l(t,e,a,n,i){var s=(0,u.aI)(e,".pn"),d=(0,u.aI)(s,".uf"),r=(0,u.aI)(s,".tf"),o=(0,u.aI)(t,".zn"),l=(0,u.aI)(o,".uf"),c=(0,u.aI)(o,".tf");if(r.setAttribute("code",a.status.code.toString()),c.setAttribute("code",a.status.code.toString()),c.innerText=a.status.text,!n&&i){var p=t.getBoundingClientRect(),m=p.top,v=p.left,f=p.bottom,h=p.right,b=window.innerWidth,g=window.innerHeight;if(f>0&&m<g&&h>0&&v<b)return d.addEventListener("animationend",function(){d.setAttribute("code",a.status.code.toString()),d.classList.remove("wf"),r.setAttribute("displayed","false")},{once:!0}),l.addEventListener("animationend",function(){l.setAttribute("code",a.status.code.toString()),l.innerText=a.status.text,l.classList.remove("wf"),c.setAttribute("displayed","false")},{once:!0}),c.setAttribute("displayed","true"),r.setAttribute("displayed","true"),d.classList.add("wf"),void l.classList.add("wf")}d.setAttribute("code",a.status.code.toString()),l.setAttribute("code",a.status.code.toString()),l.innerText=a.status.text}function c(t,e,a){t.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer)),e.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer))}function v(t,e){(0,u.aI)(t,".ln").innerText=e.name}function f(t,e){var a=(0,u.aI)(t,".fo"),n=(0,u.jg)(a,".lo"),i=n.length,s=e.buses.length,d=i-s;if(d<0){for(var r=new DocumentFragment,o=0,l=Math.abs(d);o<l;o++){var c=lt();r.appendChild(c)}a.append(r)}else for(var m=0,v=Math.abs(d);m<v;m++){n[i-1-m].remove()}for(var f=(0,u.jg)(a,".lo"),h=0;h<s;h++){var b=e.buses[h],g=f[h],A=(0,u.aI)(g,".mo"),y=(0,u.aI)(A,".oo"),C=(0,u.aI)(g,".po"),L=(0,u.aI)(C,".qo"),I=(0,u.aI)(C,".ro"),E=(0,u.aI)(C,".so");g.setAttribute("on-this-route",(0,p.xZ)(b.onThisRoute)),y.innerText=b.carNumber,L.innerText=`路線：${b.RouteName}`,I.innerText=`狀態：${b.status.text}`,E.innerText=`類型：${b.type}`}a.setAttribute("empty",(0,p.xZ)(0===s))}function b(t,e){var a=(0,u.aI)(t,".go"),n=(0,u.jg)(a,".to"),i=n.length,d=e.overlappingRoutes.length,r=i-d;if(r<0){for(var o=new DocumentFragment,l=0,c=Math.abs(r);l<c;l++){var m=ut();o.appendChild(m)}a.append(o)}else for(var v=0,f=Math.abs(r);v<f;v++){n[i-1-v].remove()}for(var h=(0,u.jg)(a,".to"),b=0;b<d;b++){var A=e.overlappingRoutes[b],y=h[b],C=(0,u.aI)(y,".uo"),L=(0,u.aI)(C,".wo"),I=(0,u.aI)(y,".xo"),E=(0,u.aI)(y,".yo"),x=(0,u.aI)(E,'.zo[type="view-route"]'),w=(0,u.aI)(E,'.zo[type="save-to-folder"]');L.innerText=A.name,I.innerText=A.RouteEndPoints.text,function(t,e,a){t.onclick=function(){At(e,a)}}(x,A.RouteID,A.PathAttributeId),function(t,e){t.onclick=function(){(0,g.B)("route",[e],t)},(0,s.LH)("route",e).then(function(e){t.setAttribute("highlighted",(0,p.xZ)(e))})}(w,A.RouteID)}a.setAttribute("empty",(0,p.xZ)(0===d))}function y(t,e){var a=(0,u.aI)(t,".ho"),n=(0,u.jg)(a,"._o"),i=n.length,s=e.busArrivalTimes.length,d=i-s;if(d<0){for(var r=new DocumentFragment,o=0,l=Math.abs(d);o<l;o++){var c=ct();r.appendChild(c)}a.append(r)}else for(var v=0,f=Math.abs(d);v<f;v++){n[i-1-v].remove()}for(var h=(0,u.jg)(a,"._o"),b=0;b<s;b++){var g=e.busArrivalTimes[b],A=h[b],y=(0,u.aI)(A,".ap"),C=(0,u.aI)(y,".cp"),L=(0,u.aI)(y,".dp"),I=(0,u.aI)(A,".ep");C.innerText=g.personalSchedule.name,L.innerText=`週${(0,m.kd)(g.day).name} ${(0,m.pn)(g.personalSchedule.period.start)} - ${(0,m.pn)(g.personalSchedule.period.end)}`,I.innerHTML=g.chart}a.setAttribute("empty",(0,p.xZ)(0===s))}function C(t,e){var a=(0,u.aI)(t,".io"),n=(0,u.jg)(a,".fp"),i=n.length,d=e.nearbyLocations.length,r=i-d;if(r<0){for(var o=new DocumentFragment,l=0,c=Math.abs(r);l<c;l++){var m=pt();o.appendChild(m)}a.append(o)}else for(var v=0,f=Math.abs(r);v<f;v++){n[i-1-v].remove()}for(var b=(0,u.jg)(a,".fp"),A=0;A<d;A++){var y=e.nearbyLocations[A],C=b[A],L=(0,u.aI)(C,".gp"),I=(0,u.aI)(L,".ip"),E=(0,u.aI)(C,".jp"),x=(0,u.aI)(C,".kp"),w=(0,u.aI)(x,'.lp[type="view-location"]'),T=(0,u.aI)(x,'.lp[type="save-to-folder"]');I.innerText=y.name,E.innerText=`${y.distance}公尺`,function(t,e){t.onclick=function(){(0,h.so)(e)}}(w,y.hash),function(t,e){t.onclick=function(){(0,g.B)("location",[e],t)},(0,s.LH)("location",e).then(function(e){t.setAttribute("highlighted",(0,p.xZ)(e))})}(T,y.hash)}a.setAttribute("empty",(0,p.xZ)(0===d))}function L(t,e,a){t.setAttribute("nearest",(0,p.xZ)(a.nearest)),e.setAttribute("nearest",(0,p.xZ)(a.nearest))}function I(t,e,a,n,i){var s=(null==a?void 0:a.progress)||0,d=(null==e?void 0:e.progress)||0,r=(0,u.aI)(t,".on .yn");if(!n&&i&&0!==s&&0===d&&Math.abs(d-s)>0)return r.style.setProperty("--mp","100%"),void r.addEventListener("transitionend",function(){r.setAttribute("displayed","false"),r.style.setProperty("--mp","-100%")},{once:!0});d>0?(r.setAttribute("displayed","true"),r.style.setProperty("--mp",100*(d-1)+"%")):r.setAttribute("displayed","false")}function E(t,e,a){a&&((0,u.aI)(t,".bo").setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false"))}function x(t,e,a){t.setAttribute("animation",(0,p.xZ)(a)),e.setAttribute("animation",(0,p.xZ)(a))}function w(t,e,a){t.setAttribute("skeleton-screen",(0,p.xZ)(a)),e.setAttribute("skeleton-screen",(0,p.xZ)(a))}function T(e,a){var n=(0,u.aI)(e,'.bo .co .do[type="save-to-folder"]');n.onclick=function(){(0,g.B)("stop",[a.id,t.RouteID],n)},(0,s.LH)("stop",a.id).then(function(t){n.setAttribute("highlighted",(0,p.xZ)(t))})}function k(e,a){var n=(0,u.aI)(e,'.bo .co .do[type="schedule-notification"]');n.onclick=function(){(0,A.Ho)(n,a.id,t.RouteID,a.status.time)};var i=(0,d.Zc)(a.id);n.setAttribute("highlighted",(0,p.xZ)(i))}null===i?(l(e,a,n,r,o),v(e,n),f(e,n),b(e,n),y(e,n),C(e,n),c(e,a,n),L(e,a,n),I(a,n,i,r,o),E(e,a,r),x(e,a,o),w(e,a,r),T(e,n),k(e,n)):(n.status.time!==i.status.time&&(l(e,a,n,r,o),k(e,n)),(0,p.hw)(i.buses,n.buses)||f(e,n),(0,p.hw)(i.busArrivalTimes,n.busArrivalTimes)||y(e,n),i.nearest!==n.nearest&&L(e,a,n),i.progress!==n.progress&&I(a,n,i,r,o),i.id!==n.id&&(v(e,n),c(e,a,n),b(e,n),C(e,n),T(e,n),k(e,n)),Z!==o&&x(e,a,o),P!==r&&(E(e,a,r),w(e,a,r)))}function o(t,e,a,n,i,s){function d(t,e){(0,u.aI)(t,"span").innerText=e}function r(t,e){t.style.setProperty("--km",`${e.offset}px`)}function o(t,e){t.style.setProperty("--lm",`${e.width}px`)}null!=i&&(i.width!==e.width&&o(t,e),i.offset!==e.offset&&r(t,e)),null!=s?s!==a&&d(t,a):(d(t,a),o(t,e),r(t,e),function(t,e){t.style.setProperty("--mm",e.toString())}(t,n))}function l(t){_.style.setProperty("--pm",`${t}px`)}var v=(0,f.gO)("window"),b=v.width,C=v.height,L=t.groupQuantity,I=t.itemQuantity,E=t.groupedItems,k=t.groupNames;B=L,Q=b;for(var S=0,N=0;N<L;N++){var q=`g_${N}`,H=(0,c.q_)(k[N],500,"17px",'"Noto Sans TC", sans-serif')+20;Y[q]={width:H,offset:S},S+=H}Y[`g_${L}`]={width:0,offset:S},P!==e&&(x.setAttribute("skeleton-screen",(0,p.xZ)(e)),j.setAttribute("skeleton-screen",(0,p.xZ)(e)),R.setAttribute("skeleton-screen",(0,p.xZ)(e))),Z!==a&&(x.setAttribute("animation",(0,p.xZ)(a)),j.setAttribute("animation",(0,p.xZ)(a)),R.setAttribute("animation",(0,p.xZ)(a))),(null===(n=M)||void 0===n?void 0:n.RouteID)!==t.RouteID&&(T.onclick=function(){(0,y.GS)(t.RouteID,t.PathAttributeId)}),(null===(i=M)||void 0===i?void 0:i.RouteName)!==t.RouteName&&(w.innerText=t.RouteName);var O=(0,u.jg)($,".fn").length;if(L!==O){var U=O-L;if(U<0){for(var J=new DocumentFragment,W=new DocumentFragment,G=0,K=Math.abs(U);G<K;G++){var X=rt();J.appendChild(X);var V=ot();W.appendChild(V)}$.append(J),_.append(W)}else for(var tt=(0,u.jg)($,".fn"),et=(0,u.jg)(_,".zm"),at=0,it=Math.abs(U);at<it;at++){var mt=O-1-at;tt[mt].remove(),et[mt].remove()}}for(var vt=(0,u.jg)($,".fn"),ft=0;ft<L;ft++){var ht=`g_${ft}`,bt=vt[ft],gt=(0,u.aI)(bt,".in"),yt=(0,u.aI)(bt,".hn"),Ct=(0,u.jg)(gt,".jn").length;if(I[ht]!==Ct){var Lt=Ct-I[ht];if(Lt<0){for(var It=new DocumentFragment,Et=new DocumentFragment,xt=0,wt=Math.abs(Lt);xt<wt;xt++){var Tt=st(),kt=dt(Tt);It.appendChild(kt),Et.appendChild(Tt)}gt.append(It),yt.append(Et)}else for(var jt=(0,u.jg)(gt,".jn"),_t=(0,u.jg)(yt,".nn"),Rt=0,St=Math.abs(Lt);Rt<St;Rt++){var $t=Ct-1-Rt;jt[$t].remove(),_t[$t].remove()}}}for(var Mt=(0,u.jg)(_,".zm"),Zt=0;Zt<L;Zt++){var Pt=`g_${Zt}`,Dt=Mt[Zt],Nt=Y[Pt],Bt=k[Zt],zt=null;(0,p.mQ)(z,Pt)&&(zt=z[Pt]);var Yt=null;(0,p.mQ)(M,"groupNames")&&(Yt=M.groupNames[Zt]),o(Dt,Nt,Bt,Zt,zt,Yt);var Qt=vt[Zt];e&&(Qt.scrollTop=0);for(var Ft=(0,u.aI)(Qt,".in"),qt=(0,u.aI)(Qt,".hn"),Ht=(0,u.jg)(Ft,".jn"),Ot=(0,u.jg)(qt,".nn"),Ut=0;Ut<I[Pt];Ut++){var Jt=Ht[Ut],Wt=Ot[Ut],Gt=E[Pt][Ut];if((0,p.mQ)(M,"groupedItems"))if((0,p.mQ)(M.groupedItems,Pt))if(M.groupedItems[Pt][Ut])r(Jt,Wt,Gt,M.groupedItems[Pt][Ut],e,a);else r(Jt,Wt,Gt,null,e,a);else r(Jt,Wt,Gt,null,e,a);else r(Jt,Wt,Gt,null,e,a)}}if((0,p.mQ)(z,`g_${L}`)?z[`g_${L}`].offset!==S&&l(S):l(S),!F){var Kt=Y[`g_${D}`],Xt=-1*Kt.offset+.5*Q-.5*Kt.width,Vt=Kt.width-20;nt(B,Xt,Vt,D)}z=Y,M=t,Z=a,P=e}function vt(){return ft.apply(this,arguments)}function ft(){return(ft=(0,n.A)(function*(){var t=(0,l.Js)("playing_animation"),e=(0,l.Js)("refresh_interval"),a=(0,f.gO)("route-bus-arrival-time-chart");U=e.dynamic,q=e.baseInterval,K=!0,G=(0,p.zx)(),k.setAttribute("refreshing","true"),k.classList.remove("dn"),document.addEventListener(G,it);var n=yield(0,o.R)(tt,et,a.width,a.height,G);mt(n,!1,t);var s=0;U&&(s=yield(0,i.wz)()),J=(new Date).getTime(),W=U?Math.max(J+H,n.dataUpdateTime+q/s):J+q,O=Math.max(H,W-J),K=!1,k.setAttribute("refreshing","false"),k.style.setProperty("--sm",`${O}ms`),k.classList.add("dn")})).apply(this,arguments)}function ht(){vt().then(function(){X?setTimeout(function(){ht()},Math.max(H,W-(new Date).getTime())):V=!1}).catch(function(t){X?((0,b.a)("error","路線網路連線中斷，將在10秒後重試。"),setTimeout(function(){ht()},1e4)):V=!1})}function bt(t,e){(0,f.WR)("Route"),(0,r.XK)("route",t),tt=t,et=e,D=0,Y={},I.setAttribute("displayed","true"),$.scrollLeft=0,$.focus(),function(t,e){for(var a=(0,l.Js)("playing_animation"),n=(0,f.gO)("window"),i=(n.width,n.height),s=Math.floor(i/50)+5,d={},r=0;r<2;r++){var o=`g_${r}`;d[o]=[];for(var u=0;u<s;u++)d[o].push({name:"",goBack:"0",status:{code:8,text:"",time:-6},buses:[],overlappingRoutes:[],busArrivalTimes:[],nearbyLocations:[],sequence:u,position:{longitude:0,latitude:0},nearest:!1,progress:0,segmentBuffer:{isSegmentBuffer:!1,isStartingPoint:!1,isEndingPoint:!1},id:0})}mt({groupNames:["載入中","載入中"],groupedItems:d,groupQuantity:2,itemQuantity:{g_0:s,g_1:s},RouteName:"載入中",RouteEndPoints:{RouteDeparture:"載入中",RouteDestination:"載入中"},RouteID:t,PathAttributeId:e,dataUpdateTime:0},!0,a)}(t,e),X||(X=!0,V?vt():(V=!0,ht())),(0,f.Z_)()}function gt(){I.setAttribute("displayed","false"),X=!1,(0,f.l$)()}function At(t,e){X=!1,bt(t,e)}function yt(t,e){var a,n=(0,u.aI)(t,".co"),i=C((0,u.jg)(n,'.do[highlighted="true"][type="tab"]'));try{for(i.s();!(a=i.n()).done;){a.value.setAttribute("highlighted","false")}}catch(t){i.e(t)}finally{i.f()}switch((0,u.aI)(n,`.do[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:(0,u.aI)(t,".fo").setAttribute("displayed","true"),(0,u.aI)(t,".ho").setAttribute("displayed","false"),(0,u.aI)(t,".go").setAttribute("displayed","false"),(0,u.aI)(t,".io").setAttribute("displayed","false");break;case 1:(0,u.aI)(t,".fo").setAttribute("displayed","false"),(0,u.aI)(t,".ho").setAttribute("displayed","true"),(0,u.aI)(t,".go").setAttribute("displayed","false"),(0,u.aI)(t,".io").setAttribute("displayed","false");break;case 2:(0,u.aI)(t,".fo").setAttribute("displayed","false"),(0,u.aI)(t,".ho").setAttribute("displayed","false"),(0,u.aI)(t,".go").setAttribute("displayed","true"),(0,u.aI)(t,".io").setAttribute("displayed","false");break;case 3:(0,u.aI)(t,".fo").setAttribute("displayed","false"),(0,u.aI)(t,".ho").setAttribute("displayed","false"),(0,u.aI)(t,".go").setAttribute("displayed","false"),(0,u.aI)(t,".io").setAttribute("displayed","true")}}}}]);
//# sourceMappingURL=cb64fbab20060c138ffb.js.map