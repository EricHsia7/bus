"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[470],{2303(t,e,r){r.d(e,{$Q:()=>a,AS:()=>u,Ov:()=>f,aU:()=>o,eu:()=>l,s$:()=>d,w_:()=>s,zi:()=>p});var i=r(8024),n=r(5579);function a(t,e){if("string"==typeof t){var r=parseInt(t);if(-3===r)return{code:6,text:"末班駛離",time:r};if(-4===r)return{code:5,text:"今日停駛",time:r};if(-2===r)return{code:4,text:"交通管制",time:r};if(-1===r)return{code:3,text:"未發車",time:r};if(0<=r&&r<=10)return{code:2,text:"進站中",time:r};if(10<r&&r<=180)return{code:1,text:(0,n.fU)(r,e),time:r};if(180<r&&r<=250)return{code:.5,text:(0,n.fU)(r,e),time:r};if(250<r)return{code:0,text:(0,n.fU)(r,e),time:r}}return{code:7,text:"發生錯誤",time:-5}}function o(t,e){var r=t.length;if(0===e){var i=0,n=0;return 4===r&&(i=parseInt(t.substring(0,2)),n=parseInt(t.substring(2,4))),2===r&&(n=parseInt(t)),{type:"moment",hours:i,minutes:n}}if(1===e){var a=0,o=0;if(4===r){var s=parseInt(t.substring(0,2)),u=parseInt(t.substring(2,4));a=Math.min(s,u),o=Math.max(s,u)}if(2===r){var f=parseInt(t);a=f,o=f}return{type:"range",min:a,max:o}}}function s(t,e,r,n,a){var o={},s={};for(var u of e){s[u.BusID]=u}for(var f of t){var p={};p.CarType=f.CarType,p.BusStatus=f.BusStatus,p.BusID=f.BusID,p.CarOnStop=f.CarOnStop;var l=parseInt(f.RouteID),d=String(f.BusID),c=!1,y=0;l===n||a.indexOf(l)>-1||l===10*n?(c=!0,y=d.charCodeAt(0)*Math.pow(10,-5)):(c=!1,y=d.charCodeAt(0)),p.onThisRoute=c,p.index=y;var v={};if((0,i.mQ)(s,d)){v=s[d],p.position={latitude:parseFloat(v.Latitude),longitude:parseFloat(v.Longitude)};var m={},h=!1;for(var g in r){var _=r[g];if(_.pid.indexOf(l)>-1){m=_,h=!0;break}}p.RouteName=h?m.n:"未知路線",p.RouteID=h?m.id:null;var b=`s_${f.StopID}`;(0,i.mQ)(o,b)||(o[b]=[]),o[b].push(p)}}return o}function u(t,e,r,n){var a={},o={};for(var s of e){o[s.BusID]=s}for(var u of t){var f={},p=parseInt(u.StopID),l=parseInt(u.RouteID),d=String(u.BusID);if(!(n.indexOf(p)<0)){f.index=d.charCodeAt(0),f.onThisRoute=!0,f.CarType=u.CarType,f.BusStatus=u.BusStatus,f.BusID=u.BusID,f.CarOnStop=u.CarOnStop;var c={};if((0,i.mQ)(o,d)){c=o[d],f.position={latitude:parseFloat(c.Latitude),longitude:parseFloat(c.Longitude)};var y={},v=!1;for(var m in r){var h=r[m];if(h.pid.indexOf(l)>-1){y=h,v=!0;break}}f.RouteName=v?y.n:"未知路線",f.RouteID=v?y.id:null;var g=`s_${p}`;(0,i.mQ)(a,g)||(a[g]=[]),a[g].push(f)}}}return a}function f(t){var e="";switch(t){case"0":e="一般";break;case"1":e="低底盤";break;case"2":e="大復康巴士";break;case"3":e="狗狗友善專車";break;default:e="未知類型"}return e}function p(t){var e="";switch(t){case"0":e="離站";break;case"1":e="進站";break;default:e="未知狀態"}return e}function l(t){var e="";switch(t){case"0":e="正常";break;case"1":e="車禍";break;case"2":e="故障";break;case"3":e="塞車";break;case"4":e="緊急求援";break;case"5":e="加油";break;case"99":e="非營運狀態";break;default:e="未知狀態"}return e}function d(t){var e={},r=f(t.CarType);e.type=r;var i=p(t.CarOnStop),n=l(t.BusStatus);return e.carNumber=t.BusID,e.status={onStop:i,situation:n,text:`${i} | ${n}`},e.RouteName=t.RouteName,e.onThisRoute=t.onThisRoute,e.index=t.index,e.position=t.position,e}},2757(t,e,r){r.d(e,{R:()=>$});var i=r(467),n=r(4256),a=r(574),o=r(8024),s=r(2945),u=r(5428),f=r(6483),p=r(6802),l=r(7810),d=r(2063),c=r(8011),y=r(4293),v=r(424),m=r(2303),h=r(6788),g=r(3459),_=r(1238);function b(t,e){var r={},i=[];for(var n in t){var a=t[n],o=a.StopID,s=parseInt(a.EstimateTime);s>=0&&e.indexOf(o)>-1&&i.push([o,s])}var u=i.length;i.sort(function(t,e){return t[1]-e[1]});var f=1;for(var p of i){var l=f/u,d=(l-l%.25)/.25;r[`s_${p[0]}`]={number:f,text:f.toString(),code:d},f+=1}return r}function $(t,e,r,i){return S.apply(this,arguments)}function S(){return(S=(0,i.A)(function*(t,e,r,i){(0,h.Mf)(i,"getLocation_0",0,!1),(0,h.Mf)(i,"getLocation_1",0,!1),(0,h.Mf)(i,"getRoute_0",0,!1),(0,h.Mf)(i,"getRoute_1",0,!1),(0,h.Mf)(i,"getStop_0",0,!1),(0,h.Mf)(i,"getStop_1",0,!1),(0,h.Mf)(i,"getEstimateTime_0",0,!1),(0,h.Mf)(i,"getEstimateTime_1",0,!1),(0,h.Mf)(i,"getBusEvent_0",0,!1),(0,h.Mf)(i,"getBusEvent_1",0,!1),(0,h.Mf)(i,"getBusData_0",0,!1),(0,h.Mf)(i,"getBusData_1",0,!1);for(var $=yield(0,d.K)(i),S=yield(0,c.g)(i,1),I=yield(0,y.a)(i,!0),Q=yield(0,v.T)(i),k=yield(0,l.J)(i),x=yield(0,p.d)(i),D=yield(0,f.Io)(e,r),O=(0,g.Js)("time_formatting_mode"),A=(0,g.Js)("location_labels"),C=(0,g.Js)("display_user_orientation"),w={},L={},N={},T=(0,_.Y)(),J=S[`ml_${t}`],B=J.n,M=J.id,R=J.v,E=[],q=[],F=M.length,z=0;z<F;z++)for(var j=0,U=J.s[z].length;j<U;j++)E.push(J.s[z][j]),q.push(J.r[z][j]);var Z=function(t,e){var r={};for(var i of t)e.indexOf(i.StopID)>-1&&(r[`s_${i.StopID}`]=i);return r}($,E),K=(0,m.AS)(k,x,I,E),P=[];for(var X of R){var V=0,G=0;for(var H of X)V+=H[0],G+=H[1];var W=(0,u.hF)([V,G]),Y=(0,a.DK)(W);P.push(Y)}var tt=[];switch(A){case"address":tt=(0,n._q)(J.a);break;case"letters":tt=(0,s.V)(F);break;case"directions":tt=(0,s.M)(P)}for(var et=0;et<F;et++){var rt=`g_${et}`;w[rt]=[],L[rt]=0,N[rt]={name:tt[et],properties:[{key:"address",icon:"personal_places",value:(0,n.pD)(J.a[et])},{key:"exact_position",icon:"location_on",value:`${J.la[et].toFixed(5)}, ${J.lo[et].toFixed(5)}`},{key:"cardinal_direction",icon:P[et].icon,value:`${P[et].name}${C&&-1!==T.cardinalDirection.id&&T.cardinalDirection.id===P[et].id?"（目前指向）":""}`}]};for(var it=J.s[et],nt=it.length,at=b(Z,it),ot=0;ot<nt;ot++){var st={},ut=J.s[et][ot],ft=`s_${ut}`,pt={};if((0,o.mQ)(Q,ft)){pt=Q[ft],st.stopId=ut;var lt={number:0,text:"--",code:-1};(0,o.mQ)(at,ft)&&(lt=at[ft]),st.ranking=lt;var dt=J.r[et][ot],ct=`r_${dt}`,yt={};if((0,o.mQ)(I,ct)){yt=I[ct],st.route_name=yt.n,st.route_direction=`往${[yt.des,yt.dep,""][parseInt(pt.goBack)]}`,st.routeId=dt;var vt={};if((0,o.mQ)(Z,ft)){vt=Z[ft];var mt=(0,m.$Q)(vt.EstimateTime,O);st.status=mt;var ht=[];(0,o.mQ)(K,ft)&&(ht=K[ft].map(function(t){return(0,m.s$)(t)})),st.buses=ht;var gt=[];(0,o.mQ)(D,ft)&&(gt=D[ft]),st.busArrivalTimes=gt,w[rt].push(st),L[rt]+=1}}}}}for(var _t in w)w[_t].sort(function(t,e){return t.routeId-e.routeId});var bt={groupedItems:w,groups:N,groupQuantity:F,itemQuantity:L,LocationName:B,hash:t,dataUpdateTime:(0,h.Zt)(i)};return(0,h.LQ)(i),(0,h.gC)(i),bt})).apply(this,arguments)}},5427(t,e,r){r.d(e,{Qx:()=>m});var i=r(467),n=r(9566),a=r(5352),o=r(5314),s=r(3459),u=r(4311);function f(t){return p.apply(this,arguments)}function p(){return(p=(0,i.A)(function*(t){for(var e of t){var r=e,i=!1,a=!1,o=`f_${r.id}`;if((yield(0,u.Ct)(11,o))?i=yield(0,n.g$)(r.id,r.name,r.icon):a=yield(0,n.vV)(r.name,r.icon),i)for(var s of e.content)yield(0,n.z$)(e.id,s);if(a)for(var f of e.content)yield(0,n.z$)(a,f)}})).apply(this,arguments)}function l(t){return d.apply(this,arguments)}function d(){return(d=(0,i.A)(function*(t){for(var e of t){var r=(0,s.PL)(e.key);r&&"select"===r.type&&(yield(0,s.aN)(e.key,e.option))}return!0})).apply(this,arguments)}function c(t){return y.apply(this,arguments)}function y(){return(y=(0,i.A)(function*(t){for(var e of t){(yield(0,a.qZ)(e.id))?yield(0,a.nL)(e):yield(0,a.Qh)(e.name,e.period.start.hours,e.period.start.minutes,e.period.end.hours,e.period.end.minutes,e.days)}return!0})).apply(this,arguments)}function v(){return(v=(0,i.A)(function*(t){for(var e of t)switch(e.type){case"route":(yield(0,o.DF)("route",e.id))||(yield(0,o.XK)(e.type,e.id));break;case"location":(yield(0,o.DF)("location",e.hash))||(yield(0,o.XK)(e.type,e.hash));break;case"bus":(yield(0,o.DF)("bus",e.id))||(yield(0,o.XK)(e.type,e.id))}return!0})).apply(this,arguments)}function m(t){return h.apply(this,arguments)}function h(){return h=(0,i.A)(function*(t){var e=JSON.parse(t);switch(e.version){case 1:return yield f(e.folders),!0;case 2:return yield f(e.folders),yield l(e.settings),!0;case 3:return yield f(e.folders),yield l(e.settings),yield c(e.personal_schedules),!0;case 4:return yield f(e.folders),yield l(e.settings),yield c(e.personal_schedules),yield function(t){return v.apply(this,arguments)}(e.recent_views),!0;default:return!1}}),h.apply(this,arguments)}},5976(t,e,r){r.d(e,{R:()=>u});var i=r(467),n=r(9566),a=r(5352),o=r(5314),s=r(3459);function u(){return f.apply(this,arguments)}function f(){return(f=(0,i.A)(function*(){var t=yield(0,n.Xi)(),e=(0,s.Gn)(),r=yield(0,a.ty)(),i=yield(0,o.Qj)(),u={};return u.time=(new Date).toISOString(),u.version=4,u.folders=t,u.settings=e,u.personal_schedules=r,u.recent_views=i,JSON.stringify(u)})).apply(this,arguments)}},6160(t,e,r){r.d(e,{i:()=>c});var i=r(467),n=r(8024),a=r(6802),o=r(7810),s=r(9734),u=r(8011),f=r(424),p=r(2303),l=r(6788),d=r(8134);function c(t,e){return y.apply(this,arguments)}function y(){return(y=(0,i.A)(function*(t,e){var r=`c_${t}`,i=yield(0,s.j)(e,!0),c=yield(0,a.d)(e),y=yield(0,o.J)(e),v=yield(0,f.T)(e),m=yield(0,u.g)(e,0),h={properties:[],LocationName:""},g={};if(!(0,n.mQ)(i,r))return h;var _=(g=i[r]).CarNum;h.properties.push({key:"car_number",icon:"tag",value:_});var b=g.CarType,$=(0,p.Ov)(b);h.properties.push({key:"car_type",icon:"directions_bus",value:$});var S={};for(var I of c){if(I.BusID===_){S=I;break}}var Q=parseInt(S.RouteID),k=S.BusStatus,x=(0,p.eu)(k),D=parseInt(S.GoBack),O={};for(var A of y){if(A.BusID===_){O=A;break}}var C=O.CarOnStop,w=(0,p.zi)(C);h.properties.push({key:"status",icon:"vital_signs",value:`${w} | ${x}`});var L=O.StopID,N=yield(0,d.F6)(Q),T={};if(!(N.length>0))return h;var J=(T=N[0]).id,B=T.pid,M=T.n,R=T.dep,E=[T.des,R,""][D||0];h.properties.push({key:"route",icon:"route",value:`${M} - 往${E}`}),h.RouteID=J,h.FullPathAttributeId=B;var q=`s_${L}`;if(!(0,n.mQ)(v,q))return h;var F=m[`l_${v[q].stopLocationId}`].n;return h.properties.push({key:"location_name",icon:"location_on",value:F}),(0,l.LQ)(e),(0,l.gC)(e),h})).apply(this,arguments)}},6788(t,e,r){r.d(e,{Fd:()=>l,LQ:()=>h,Mf:()=>v,ZL:()=>b,Zt:()=>$,_M:()=>m,gC:()=>S});var i=r(2284),n=r(467),a=r(8024),o=r(4750),s=r(5579),u=r(8925),f={},p=new Error("E21");function l(t,e,r,i){return d.apply(this,arguments)}function d(){return(d=(0,n.A)(function*(t,e,r,i){if((0,a.mQ)(f,t)){if(f[t].processing)return yield new Promise(function(i,n){f[t].requests.push([i,n,e,r])});if(null!==f[t].result&&(new Date).getTime()<=f[t].timestamp)return v(e,r,0,!0),f[t].result}else f[t]={processing:!0,requests:[],failed:!1,timestamp:-1,result:null};var n=yield fetch(t);if(!n.ok)throw v(e,r,0,!0),new Error("E22");for(var s=parseInt(String(n.headers.get("content-length"))),d=n.body.getReader(),y=[],m=0;;){var h=yield d.read(),g=h.done,_=h.value;if(g)break;y.push(_);var b=(m+=_.length)/s;if(v(e,r,b,!1),(0,a.mQ)(f,t))for(var $ of f[t].requests)v($[2],$[3],b,!1)}var S=new Uint8Array(m),I=0;for(var Q of y)S.set(Q,I),I+=Q.length;var k,x=new Blob([S],{type:"application/gzip"}),D=yield x.arrayBuffer(),O=yield(0,o.h)(D);switch(i){case"json":k=/^<!doctype html>/.test(O)?yield l(t.replace("https://tcgbusfs.blob.core.windows.net/","https://erichsia7.github.io/bus-alternative-static-apis/"),e,r,i):JSON.parse(O);break;case"xml":k=O}var A=new Date;if(yield(0,u.N$)(s,A),k){if((0,a.mQ)(f,t)){for(var C=m/s,w=f[t].requests.shift();w;)w[0](k),v(w[2],w[3],C,!1),w=f[t].requests.shift();f[t].result=k,f[t].timestamp=A.getTime()+3e4,f[t].processing=!1}return c(),k}if((0,a.mQ)(f,t)){for(var L=f[t].requests.shift();L;)L[1](p),v(L[2],L[3],0,!0),L=f[t].requests.shift();f[t].failed=!0}throw c(),p})).apply(this,arguments)}function c(){var t=(new Date).getTime();for(var e in f)if((0,a.mQ)(f,e)){if(!f[e].processing&&t>f[e].timestamp){delete f[e];continue}if(f[e].failed){delete f[e];continue}}}var y={};function v(t,e,r,i){(0,a.mQ)(y,t)||(y[t]={}),(0,a.mQ)(y[t],e)?(i?y[t][e].expel=!0:(y[t][e].expel=!1,y[t][e].progress=r),g(t,"run")):(y[t][e]={expel:!1,progress:r,total:1},g(t,"start"))}function m(t){if((0,a.mQ)(y,t)&&"object"===(0,i.A)(y[t])){var e=0,r=0;for(var n in y[t])y[t][n].expel||(e+=y[t][n].total,r+=y[t][n].progress);var o=Math.min(Math.max(r/e,0),1);return o===1/0||isNaN(o)?1:o}return 1}function h(t){(0,a.mQ)(y,t)&&(delete y[t],g(t,"end"))}function g(t,e){var r={target:t,stage:e,progress:m(t)},i=new CustomEvent(t,{detail:r});document.dispatchEvent(i)}var _={};function b(t,e){(0,a.mQ)(_,t)||(_[t]=0);var r=0;"string"==typeof e&&(r=(0,s.Zn)(e)),r>_[t]&&(_[t]=r)}function $(t){return(0,a.mQ)(_,t)?1*_[t]:0}function S(t){(0,a.mQ)(_,t)&&delete _[t]}},6983(t,e,r){r.d(e,{v:()=>f});var i=r(467),n=r(1351),a=r(3041),o=r(8024),s=r(8011),u=r(6788);function f(t,e){return p.apply(this,arguments)}function p(){return(p=(0,i.A)(function*(t,e){var r=yield(0,s.g)(e,1);(0,u.LQ)(e),(0,u.gC)(e);var i=`ml_${t}`;if(!(0,o.mQ)(r,i))return{actions:[],actionsQuantity:0,hash:t};r[i];var f=[{icon:"folder",name:"儲存",key:"save-to-folder",action:function(){(0,a.B)("location",[t],null)}},{icon:"ios_share",name:"分享",key:"permalink",action:function(){(0,n.k9)(t)}},{icon:"qr_code_2",name:"二維條碼",key:"permalink-qr-code",action:function(){(0,n.qp)(t)}}];return{actions:f,actionsQuantity:f.length,hash:t}})).apply(this,arguments)}},9566(t,e,r){r.d(e,{$j:()=>T,DW:()=>X,Fq:()=>K,L2:()=>Q,LH:()=>q,NC:()=>z,R_:()=>B,Rh:()=>g,Xi:()=>C,aq:()=>U,bq:()=>G,eD:()=>x,g$:()=>S,l9:()=>L,uT:()=>k,vV:()=>b,z$:()=>R});var i=r(2284),n=r(467),a=r(8024),o=r(6483),s=r(5767),u=r(2063),f=r(8011),p=r(9218),l=r(4293),d=r(424),c=r(2303),y=r(6788),v=r(3459),m=r(4311),h={};function g(){return _.apply(this,arguments)}function _(){return(_=(0,n.A)(function*(){var t=yield(0,m.Su)(11);for(var e of t){var r=yield(0,m.Ct)(11,e);if(r){var i=JSON.parse(r);(0,a.mQ)(h,e)||(h[e]=i)}}})).apply(this,arguments)}function b(t,e){return $.apply(this,arguments)}function $(){return($=(0,n.A)(function*(t,e){var r=(0,a.zx)(),i=yield(0,p.l)(r);(0,y.LQ)(r);for(var n=e.split("_"),o=i.dictionary.split(","),s=n.length-1;s>=0;s--)n.splice(s,1,o.indexOf(n[s]).toString());var u=n.join("_");if(!(0,a.mQ)(i.symbols,u))return!1;var f=(0,a.zx)(),l=`f_${f}`;if((0,a.mQ)(h,l))return!1;if(yield(0,m.Ct)(11,l))return!1;var d={name:t,icon:e,id:f,timestamp:(new Date).getTime()};return h[l]=d,yield(0,m.mL)(11,l,JSON.stringify(d)),yield(0,m.mL)(12,l,JSON.stringify([])),f})).apply(this,arguments)}function S(t,e,r){return I.apply(this,arguments)}function I(){return(I=(0,n.A)(function*(t,e,r){var i=`f_${t}`,n=yield(0,m.Ct)(11,i);if(!n)return!1;var o=JSON.parse(n),s=(0,a.zx)(),u=yield(0,p.l)(s);(0,y.LQ)(s);for(var f=r.split("_"),l=u.dictionary.split(","),d=f.length-1;d>=0;d--)f.splice(d,1,l.indexOf(f[d]).toString());var c=f.join("_");if(!(0,a.mQ)(u.symbols,c))return!1;var v={name:e,icon:r,id:t,timestamp:o.timestamp};return h[i]=v,yield(0,m.mL)(11,i,JSON.stringify(v)),!0})).apply(this,arguments)}function Q(t){var e=`f_${t}`;return!!(0,a.mQ)(h,e)&&{name:h[e].name,icon:h[e].icon,id:h[e].id,timestamp:h[e].timestamp}}function k(){var t=[];for(var e in h){var r={name:h[e].name,icon:h[e].icon,id:h[e].id,timestamp:h[e].timestamp};t.push(r)}return t.sort(function(t,e){return t.timestamp-e.timestamp}),t}function x(t){return D.apply(this,arguments)}function D(){return(D=(0,n.A)(function*(t){var e=[],r=`f_${t}`,i=Q(t);if("boolean"==typeof i&&!1===i)return e;var n=yield(0,m.Ct)(12,r);if(!n)return e;var a=JSON.parse(n);if(0===a.length){return e.push({type:"empty",id:0}),e}for(var o of a){var s=yield(0,m.Ct)(13,o);if(s){var u=JSON.parse(s);e.push(u)}}return e})).apply(this,arguments)}function O(t){return A.apply(this,arguments)}function A(){return(A=(0,n.A)(function*(t){var e=`f_${t}`,r=yield(0,m.Ct)(12,e);return r?JSON.parse(r).length:0})).apply(this,arguments)}function C(){return w.apply(this,arguments)}function w(){return(w=(0,n.A)(function*(){var t=k(),e=[];for(var r of t){var i=yield x(r.id),n=yield O(r.id);e.push({name:r.name,icon:r.icon,id:r.id,timestamp:r.timestamp,content:i,contentLength:n})}return e})).apply(this,arguments)}function L(){return N.apply(this,arguments)}function N(){return(N=(0,n.A)(function*(){var t=k(),e=[];for(var r of t){var i=yield O(r.id);e.push({name:r.name,icon:r.icon,id:r.id,timestamp:r.timestamp,contentLength:i})}return e})).apply(this,arguments)}function T(t){return J.apply(this,arguments)}function J(){return(J=(0,n.A)(function*(t){var e=!0;"object"===(0,i.A)(t)&&Array.isArray(t)||(e=!1);var r=[],n=yield(0,m.Su)(13);for(var a of n){var o=yield(0,m.Ct)(13,a);if(o){var s=JSON.parse(o);e?t.indexOf(s.type)>-1&&r.push(s):r.push(s)}}return r})).apply(this,arguments)}function B(t){return M.apply(this,arguments)}function M(){return(M=(0,n.A)(function*(t){(0,y.Mf)(t,"getEstimateTime_0",0,!1),(0,y.Mf)(t,"getEstimateTime_1",0,!1),(0,y.Mf)(t,"getRoute_0",0,!1),(0,y.Mf)(t,"getRoute_1",0,!1);var e=yield(0,u.K)(t),r=yield(0,l.a)(t,!0),i=yield C(),n=(0,v.Js)("time_formatting_mode"),f=(0,v.Js)("power_saving"),p=(0,v.Js)("refresh_interval"),d=[];for(var m of i)for(var h=0,g=m.content.length;h<g;h++)"stop"===m.content[h].type&&d.push(m.content[h].id);var _={};for(var b of e){if(d.indexOf(b.StopID)>-1)_[`s_${b.StopID}`]=b}var $=[];for(var S of i){var I={name:S.name,icon:S.icon,id:S.id,timestamp:S.timestamp,content:[],contentLength:S.contentLength};for(var Q of S.content){var k=Q;switch(k.type){case"stop":var x=`s_${k.id}`,D={};if(!(0,a.mQ)(_,x))break;D=_[x],k.status=(0,c.$Q)(D.EstimateTime,n);var O=r[`r_${k.route.id}`];k.route.pathAttributeId=O.pid;break;case"route":var A=r[`r_${k.id}`];k.pathAttributeId=A.pid}I.content.push(k)}$.push(I)}var w={folders:$,dataUpdateTime:(0,y.Zt)(t)};return(0,y.LQ)(t),(0,y.gC)(t),f||(p.dynamic&&(yield(0,s.Eu)(e)),yield(0,o.VZ)(e)),w})).apply(this,arguments)}function R(t,e){return E.apply(this,arguments)}function E(){return(E=(0,n.A)(function*(t,e){var r=`f_${t}`,i=`${e.type}_${e.id}`,n=Q(t);if("boolean"==typeof n&&!1===n)return!1;var a=yield(0,m.Ct)(12,r);if(!a)return!1;var o=JSON.parse(a);return(0===o.length||o.indexOf(i)<0)&&(o.push(i),yield(0,m.mL)(12,r,JSON.stringify(o)),yield(0,m.mL)(13,i,JSON.stringify(e)),!0)})).apply(this,arguments)}function q(t,e){return F.apply(this,arguments)}function F(){return(F=(0,n.A)(function*(t,e){var r=`${t}_${e}`,i=yield(0,m.Su)(12);for(var n of i){var a=yield(0,m.Ct)(12,n);if(a)if(JSON.parse(a).indexOf(r)>-1)return!0}return!1})).apply(this,arguments)}function z(t,e,r){return j.apply(this,arguments)}function j(){return(j=(0,n.A)(function*(t,e,r){var i=`f_${t}`,n=`${e}_${r}`,a=Q(t);if("boolean"==typeof a&&!1===a)return!1;var o=yield(0,m.Ct)(12,i);if(!o)return!1;var s=JSON.parse(o),u=s.indexOf(n);return u>-1&&s.length>0&&(s.splice(u,1),yield(0,m.mL)(12,i,JSON.stringify(s))),!1===(yield q(e,r))&&(yield(0,m.iQ)(13,n)),!0})).apply(this,arguments)}function U(t,e,r){return Z.apply(this,arguments)}function Z(){return(Z=(0,n.A)(function*(t,e,r){var i=(0,a.zx)(),n=yield(0,d.T)(i),o=yield(0,f.g)(i,0),s=yield(0,l.a)(i,!0),u=n[`s_${e}`],p=parseInt(u.goBack),c=o[`l_${u.stopLocationId}`].n,y=s[`r_${r}`],v=y.n,m=y.dep,h=y.des,g={type:"stop",id:e,timestamp:(new Date).getTime(),name:c,direction:p,route:{name:v,endPoints:{departure:m,destination:h},id:r}};return yield R(t,g)})).apply(this,arguments)}function K(t,e){return P.apply(this,arguments)}function P(){return(P=(0,n.A)(function*(t,e){var r=(0,a.zx)(),i=yield(0,l.a)(r,!0);(0,y.LQ)(r),(0,y.gC)(r);var n=`r_${e}`,o={};if(!(0,a.mQ)(i,n))return!1;o=i[n];var s={type:"route",id:e,timestamp:(new Date).getTime(),name:o.n,endPoints:{departure:o.dep,destination:o.des}};return yield R(t,s)})).apply(this,arguments)}function X(t,e){return V.apply(this,arguments)}function V(){return(V=(0,n.A)(function*(t,e){var r=(0,a.zx)(),i=yield(0,f.g)(r,1);(0,y.LQ)(r),(0,y.gC)(r);var n=`ml_${e}`,o={};if(!(0,a.mQ)(i,n))return!1;o=i[n];var s={type:"location",id:e,timestamp:(new Date).getTime(),name:o.n};return yield R(t,s)})).apply(this,arguments)}function G(t,e,r,i){return H.apply(this,arguments)}function H(){return(H=(0,n.A)(function*(t,e,r,i){var n=`f_${t}`,a=`${e}_${r}`,o=Q(t);if("boolean"==typeof o&&!1===o)return!1;var s=yield(0,m.Ct)(12,n);if(!s)return!1;var u=JSON.parse(s),f=u.indexOf(a);if(f>-1&&u.length>1){var p=0;switch(i){case"up":p=-1;break;case"down":p=1;break;default:p=0}return u.splice(f,1),u.splice(f+p,0,a),yield(0,m.mL)(12,n,JSON.stringify(u)),!0}return!1})).apply(this,arguments)}}}]);
//# sourceMappingURL=ed18dbb83875464e7503.js.map