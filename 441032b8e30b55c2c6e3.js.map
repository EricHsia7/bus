{"version":3,"file":"441032b8e30b55c2c6e3.js","mappings":"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","sources":["webpack://bus/./src/tools/cardinal-direction.ts","webpack://bus/./src/tools/array.ts","webpack://bus/./src/interface/route/details/properties.ts","webpack://bus/./src/tools/labels.ts","webpack://bus/./src/tools/pako-inflate/index.ts","webpack://bus/./src/tools/text.ts","webpack://bus/./src/interface/settings/index.ts","webpack://bus/./src/tools/style.ts","webpack://bus/./src/tools/convert.ts","webpack://bus/./src/tools/graphic.ts","webpack://bus/./src/tools/elements.ts","webpack://bus/./src/interface/route/details/actions.ts","webpack://bus/./src/interface/route/details/calendar.ts"],"sourcesContent":["import { MaterialSymbols } from '../interface/icons/material-symbols-type';\nimport { normalizeVector } from './math';\n\nexport type CardinalDirectionVector = [number, number];\n\nexport interface CardinalDirection {\n  vector: CardinalDirectionVector;\n  id: number;\n  name: string;\n  symbol: string;\n  icon: MaterialSymbols;\n}\n\nexport const UnknownCardinalDirection: CardinalDirection = {\n  vector: [0, 0],\n  id: -1,\n  name: '未知',\n  symbol: '?',\n  icon: 'explore'\n};\n\n// cardinal directions\nexport const NorthCardinalDirection: CardinalDirection = {\n  vector: [0, 1], // 90 degress\n  id: 0,\n  name: '北',\n  symbol: '↑',\n  icon: 'north'\n};\n\nexport const WestCardinalDirection: CardinalDirection = {\n  vector: [1, 0], // 0 degres\n  id: 1,\n  name: '東',\n  symbol: '→',\n  icon: 'east'\n};\n\nexport const SouthCardinalDirection: CardinalDirection = {\n  vector: [0, -1], // 270 degress\n  id: 2,\n  name: '南',\n  symbol: '↓',\n  icon: 'south'\n};\n\nexport const EastCardinalDirection: CardinalDirection = {\n  vector: [-1, 0], // 180 degress\n  id: 3,\n  name: '西',\n  symbol: '←',\n  icon: 'west'\n};\n\n// intercardinal directions\nconst NorthEastCardinalDirection: CardinalDirection = {\n  vector: [Math.SQRT1_2, Math.SQRT1_2], // 45 degrees\n  id: 4,\n  name: '東北',\n  symbol: '↗',\n  icon: 'north_east'\n};\n\nconst SouthEastCardinalDirection: CardinalDirection = {\n  vector: [Math.SQRT1_2, -Math.SQRT1_2], // 135 degrees\n  id: 5,\n  name: '東南',\n  symbol: '↘',\n  icon: 'south_east'\n};\n\nexport const SouthWestCardinalDirection: CardinalDirection = {\n  vector: [-Math.SQRT1_2, -Math.SQRT1_2], // 225 degrees\n  id: 6,\n  name: '西南',\n  symbol: '↙',\n  icon: 'south_west'\n};\n\nexport const NorthWestCardinalDirection: CardinalDirection = {\n  vector: [-Math.SQRT1_2, Math.SQRT1_2], // 315 degrees\n  id: 7,\n  name: '西北',\n  symbol: '↖',\n  icon: 'north_west'\n};\n\nexport function getCardinalDirectionFromVector(vector: [number, number]): CardinalDirection {\n  const directions: Array<CardinalDirection> = [UnknownCardinalDirection, NorthCardinalDirection, EastCardinalDirection, SouthCardinalDirection, WestCardinalDirection, NorthEastCardinalDirection, SouthEastCardinalDirection, SouthWestCardinalDirection, NorthWestCardinalDirection];\n  const unitVector = normalizeVector(vector);\n  let maxDotProduct = -Infinity;\n  let bestMatch: CardinalDirection = directions[0];\n  for (const direction of directions) {\n    const dotProduct = direction.vector[0] * unitVector[0] + direction.vector[1] * unitVector[1];\n    if (dotProduct > maxDotProduct) {\n      maxDotProduct = dotProduct;\n      bestMatch = direction;\n    }\n  }\n  return bestMatch;\n}\n","// Function to split data based on delta\n\n/**\n * Splits data into groups based on delta between consecutive elements.\n *\n * @param {Array<[number, number]>} data - Array of tuples where each tuple contains two numbers.\n * @returns {Array<Array<[number, number]>>} - Array of groups, each containing arrays of tuples.\n */\n\nexport function splitDataByDelta(data: Array<[number, number]>): Array<Array<[number, number]>> {\n  const result: Array<Array<[number, number]>> = [];\n  let currentGroup: Array<[number, number]> = [];\n\n  for (let i = 0; i < data.length; i++) {\n    if (i === 0 || data[i][0] - data[i - 1][0] > 0) {\n      if (currentGroup.length > 0) {\n        result.push(currentGroup);\n      }\n      currentGroup = [data[i]];\n    } else {\n      currentGroup.push(data[i]);\n    }\n  }\n\n  if (currentGroup.length > 0) {\n    result.push(currentGroup);\n  }\n\n  return result;\n}\n\nexport function areItemsDifferent(arr: Array): boolean {\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = i + 1; j < arr.length; j++) {\n      if (arr[i] === arr[j]) {\n        return false; // Found a duplicate\n      }\n    }\n  }\n  return true; // No duplicates found\n}\n\n/**\n * Get common items from the two arrays\n * @param arrayA - The first array\n * @param arrayB - The second array\n * @returns An array of the common items\n */\n\nexport function getIntersection(arrayA: Array, arrayB: Array): Array {\n  let result = [];\n  if (arrayA.length <= arrayB.length) {\n    for (const item of arrayA) {\n      if (arrayB.indexOf(item) > -1) {\n        result.push(item);\n      }\n    }\n  } else {\n    for (const item of arrayB) {\n      if (arrayA.indexOf(item) > -1) {\n        result.push(item);\n      }\n    }\n  }\n  return result;\n}\n","import { getSettingOptionValue } from '../../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { booleanToString, compareThings } from '../../../tools/index';\nimport { getBlankIconElement, setIcon } from '../../icons/index';\nimport { GeneratedElement } from '../../index';\nimport { PropertiesGroupBodyElement, PropertiesGroupElement } from './index';\n\nlet previousProperties = [];\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nfunction generateElementOfProperty(): GeneratedElement {\n  const propertyElement = document.createElement('div');\n  propertyElement.classList.add('css_route_details_property');\n\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_route_details_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n  propertyElement.appendChild(iconElement);\n\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_route_details_property_value');\n  propertyElement.appendChild(valueElement);\n\n  return {\n    element: propertyElement,\n    id: ''\n  };\n}\n\nexport function setUppropertiesGroupSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultPropertyQuantity = 5;\n  const properties = [];\n  for (let i = 0; i < defaultPropertyQuantity; i++) {\n    properties.push({\n      key: i,\n      icon: 'none',\n      value: ''\n    });\n  }\n  updatePropertiesField(properties, true, playing_animation);\n}\n\nexport function updatePropertiesField(properties: Array, skeletonScreen: boolean, animation: boolean): void {\n  function updateProperty(thisElement: HTMLElement, thisProperty: object, previousProperty: object): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: object): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_route_details_property_icon');\n      setIcon(thisIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: object): void {\n      elementQuerySelector(thisElement, '.css_route_details_property_value').innerText = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (previousAnimation !== animation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (previousSkeletonScreen !== skeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const propertyQuantity = properties.length;\n\n  if (skeletonScreen !== previousSkeletonScreen) {\n    PropertiesGroupElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  const currentPropertyCapacity = elementQuerySelectorAll(PropertiesGroupBodyElement, '.css_route_details_property').length;\n  if (propertyQuantity !== currentPropertyCapacity) {\n    const difference = currentPropertyCapacity - propertyQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        // const propertyIndex = currentPropertyCapacity + o;\n        const newPropertyElement = generateElementOfProperty();\n        fragment.appendChild(newPropertyElement.element);\n      }\n      PropertiesGroupBodyElement.append(fragment);\n    } else {\n      const propertyElements = elementQuerySelectorAll(PropertiesGroupBodyElement, '.css_route_details_property');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const propertyIndex = currentPropertyCapacity - 1 - o;\n        propertyElements[propertyIndex].remove();\n      }\n    }\n  }\n\n  const propertyElements = elementQuerySelectorAll(PropertiesGroupBodyElement, '.css_route_details_property');\n  for (let i = 0; i < propertyQuantity; i++) {\n    const thisPropertyElement = propertyElements[i];\n    const thisProperty = properties[i];\n    if (previousProperties.length === 0) {\n      updateProperty(thisPropertyElement, thisProperty, null);\n    } else {\n      updateProperty(thisPropertyElement, thisProperty, previousProperties[i]);\n    }\n  }\n\n  previousProperties = properties;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n","import { CardinalDirection } from './cardinal-direction';\nimport { convertNumberToLetters } from './convert';\n\nexport function generateLetterLabels(quantity: number): Array<string> {\n  let result: Array<string> = [];\n  for (let i = 0; i < quantity; i++) {\n    result.push(`地點${convertNumberToLetters(i + 1)}`);\n  }\n  return result;\n}\n\nexport function generateDirectionLabels(cardinalDirections: Array<CardinalDirection>): Array<string> {\n  const result: Array<string> = [];\n  for (const cardinalDirection of cardinalDirections) {\n    result.push(`向${cardinalDirection.name}${cardinalDirection.symbol}`);\n  }\n  return result;\n}\n","import { generateIdentifier } from '../index';\n\nlet pakoInflateWorkerResponses = {};\nvar port;\n\n// Check if SharedWorker is supported, and fall back to Worker if not\nif (typeof SharedWorker !== 'undefined') {\n  const pakoInflateSharedWorker = new SharedWorker(new URL('./worker.ts', import.meta.url)); // Reusable shared worker\n  port = pakoInflateSharedWorker.port; // Access the port for communication\n  port.start(); // Start the port (required by some browsers)\n} else {\n  const pakoInflateWorker = new Worker(new URL('./worker.ts', import.meta.url)); // Fallback to standard worker\n  port = pakoInflateWorker; // Use Worker directly for communication\n}\n\n// Handle messages from the worker\nport.onmessage = function (e) {\n  const [result, taskID] = e.data;\n  if (pakoInflateWorkerResponses[taskID]) {\n    pakoInflateWorkerResponses[taskID](result); // Resolve the correct promise\n    delete pakoInflateWorkerResponses[taskID]; // Clean up the response handler\n  }\n};\n\n// Handle errors\nport.onerror = function (e) {\n  console.error(e.message);\n};\n\nexport async function pakoInflate(buffer: ArrayBuffer): Promise<string> {\n  const taskID = generateIdentifier();\n\n  const result = await new Promise((resolve, reject) => {\n    pakoInflateWorkerResponses[taskID] = resolve; // Store the resolve function for this taskID\n\n    port.onerror = function (e) {\n      reject(e.message);\n    };\n\n    port.postMessage([buffer, taskID]); // Send the task to the worker\n  });\n\n  return result;\n}","import { getTextWidth } from './graphic';\n\nexport function getUnicodes(string: string, unique: boolean = true): Array<number> {\n  let result = [];\n  if (typeof string === 'string') {\n    const stringLength = string.length;\n    for (let i = 0; i < stringLength; i++) {\n      const unicode = string.charCodeAt(i);\n      if (result.indexOf(unicode) < 0 || !unique) {\n        result.push(unicode);\n      }\n    }\n  }\n  return result;\n}\n\nexport function containPhoneticSymbols(string: string): boolean {\n  const regex = /[\\u3100-\\u312F\\ˇ\\ˋ\\ˊ\\˙]/gm;\n  if (regex.test(string)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function truncateText(text: string, weight: number, size: string, fontFamily: string, maxWidth: number): string {\n  const ellipsis = '...';\n  const ellipsisWidth = getTextWidth(ellipsis, weight, size, fontFamily);\n  const fullTextWidth = getTextWidth(text, weight, size, fontFamily);\n  const fullTextLength = text.length;\n  if (fullTextLength === 0) {\n    return text;\n  }\n  if (fullTextWidth <= maxWidth) {\n    return text;\n  } else {\n    const averageCharacterWidth = fullTextWidth / fullTextLength;\n    const truncatedLength = Math.floor(maxWidth / averageCharacterWidth) - 2;\n    let lengthAdjustment = 0;\n    let lastLength = 0;\n    for (let i = 0; i < 5; i++) {\n      const adjustedText = text.substring(0, truncatedLength + lengthAdjustment);\n      const adjustedTextWidth = getTextWidth(adjustedText, weight, size, fontFamily) + ellipsisWidth;\n      if (adjustedTextWidth <= maxWidth) {\n        lastLength = truncatedLength + lengthAdjustment;\n        lengthAdjustment += 1;\n      } else {\n        break;\n      }\n    }\n    return `${text.substring(0, lastLength)}${ellipsis}`;\n  }\n}\n\nexport function formatNumberWithSuffix(num: number, maxLength: number = 4): string {\n  const suffixes = ['', 'K', 'M', 'B', 'T', 'Q'];\n  let magnitude = 0;\n\n  while (Math.abs(num) >= 1000 && magnitude < suffixes.length - 1) {\n    num /= 1000;\n    magnitude++;\n  }\n\n  let numStr = num.toFixed(1).replace(/\\.0$/, '');\n\n  while (numStr.length + suffixes[magnitude].length > maxLength && numStr.includes('.')) {\n    numStr = numStr.slice(0, -1);\n  }\n\n  return numStr + suffixes[magnitude];\n}\n","import { exportData } from '../../data/export/index';\nimport { importData } from '../../data/import/index';\nimport { listSettings, Setting } from '../../data/settings/index';\nimport { getTreeURLOfCurrentVersion } from '../../data/settings/version';\nimport { askForPersistentStorage } from '../../data/storage/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { generateIdentifier, releaseFile } from '../../tools/index';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst SettingsField = documentQuerySelector('.css_settings_field');\nconst SettingsBodyElement = elementQuerySelector(SettingsField, '.css_settings_body');\nconst SettingsElement = elementQuerySelector(SettingsBodyElement, '.css_settings');\n\nfunction generateElementOfItem(item: Setting): GeneratedElement {\n  const settingElement = document.createElement('div');\n  settingElement.classList.add('css_setting');\n  settingElement.setAttribute('type', item.type);\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_setting_icon');\n  const iconSpanElement = document.createElement('span');\n  iconSpanElement.appendChild(getIconElement(item.icon));\n  iconElement.appendChild(iconSpanElement);\n\n  // Name\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_setting_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_setting_status');\n  statusElement.appendChild(document.createTextNode(item.status));\n\n  // Arrow\n  const arrowElement = document.createElement('div');\n  arrowElement.classList.add('css_setting_arrow');\n  const arrowSpanElement = document.createElement('span');\n  arrowSpanElement.appendChild(getIconElement('arrow_forward_ios'));\n  arrowElement.appendChild(arrowSpanElement);\n\n  // Event handler (lambda)\n  if (typeof item.action === 'function') {\n    settingElement.onclick = function () {\n      item.action();\n    };\n  } else if (typeof item.action === 'string') {\n    settingElement.setAttribute('onclick', item.action);\n  }\n\n  // Assemble\n  settingElement.appendChild(iconElement);\n  settingElement.appendChild(nameElement);\n  settingElement.appendChild(statusElement);\n  settingElement.appendChild(arrowElement);\n\n  return {\n    element: settingElement,\n    id: ''\n  };\n}\n\nasync function initializeSettingsField() {\n  const list = await listSettings();\n  SettingsElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  for (const item of list) {\n    const thisElement = generateElementOfItem(item);\n    fragment.appendChild(thisElement.element);\n  }\n  SettingsElement.append(fragment);\n}\n\nexport function openSettings(): void {\n  pushPageHistory('Settings');\n  SettingsField.setAttribute('displayed', 'true');\n  initializeSettingsField();\n}\n\nexport function closeSettings(): void {\n  revokePageHistory('Settings');\n  SettingsField.setAttribute('displayed', 'false');\n}\n\nexport async function downloadExportFile() {\n  promptMessage('manufacturing', '資料匯出中');\n  const content = await exportData();\n  releaseFile(content, 'application/json', 'bus-export.json');\n}\n\nexport function openFileToImportData(): void {\n  const identifier = generateIdentifier();\n  const fileInput = document.createElement('input');\n  fileInput.setAttribute('type', 'file');\n  fileInput.setAttribute('accept', 'application/json');\n  fileInput.setAttribute('name', identifier);\n  fileInput.id = identifier;\n  fileInput.classList.add('css_import_file_input');\n  fileInput.addEventListener(\n    'change',\n    function (event) {\n      // Check if a file is selected\n      if (event.target.files.length === 0) {\n        documentQuerySelector(`body #${identifier}`).remove();\n      } else {\n        // Get the first file selected by the user\n        const file = event.target.files[0];\n        const reader = new FileReader();\n\n        // When the file is successfully read\n        reader.onload = function (e) {\n          // Get the file content as text\n          const fileTextContent = e.target.result;\n\n          // Import the data\n          importData(fileTextContent).then((f) => {\n            if (f) {\n              promptMessage('check_circle', '已匯入資料');\n            } else {\n              promptMessage('error', '無法匯入資料');\n            }\n            documentQuerySelector(`body #${identifier}`).remove();\n          });\n        };\n\n        // Read the file as text\n        reader.readAsText(file);\n      }\n    },\n    { once: true }\n  );\n  fileInput.addEventListener(\n    'cancel',\n    function () {\n      documentQuerySelector(`body #${identifier}`).remove();\n    },\n    { once: true }\n  );\n\n  document.body.append(fileInput);\n  documentQuerySelector(`body #${identifier}`).click();\n}\n\nexport function viewSourceCodeOfCurrentVersion(): void {\n  const url = getTreeURLOfCurrentVersion();\n  window.open(url);\n}\n\nexport function viewGitHubRepository(): void {\n  const url = 'https://github.com/EricHsia7/bus';\n  window.open(url);\n}\n\nexport function showPromptToAskForPersistentStorage(): void {\n  askForPersistentStorage().then((e) => {\n    switch (e) {\n      case 'granted':\n        promptMessage('check_circle', '已開啟永久儲存');\n        break;\n      case 'denied':\n        promptMessage('cancel', '永久儲存權限已被拒絕');\n        break;\n      case 'unsupported':\n        promptMessage('warning', '此瀏覽器不支援永久儲存');\n        break;\n      default:\n        promptMessage('error', '發生錯誤');\n        break;\n    }\n  });\n}\n","export type ColorScheme = 'light' | 'dark';\n\nexport function getColorScheme(): ColorScheme {\n  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n  if (mediaQuery.matches) {\n    return 'dark';\n  } else {\n    return 'light';\n  }\n}\n\nconst CssVariableValueCache = {\n  light: {},\n  dark: {}\n};\n\nexport function getCSSVariableValue(property: string): string {\n  const CurrentColorScheme = getColorScheme();\n  if (CssVariableValueCache[CurrentColorScheme].hasOwnProperty(property)) {\n    return CssVariableValueCache[CurrentColorScheme][property];\n  }\n  const value = getComputedStyle(document.documentElement).getPropertyValue(property);\n  CssVariableValueCache[CurrentColorScheme][property] = value;\n  return value;\n}\n","export function convertPositionsToDistance(lat1: number, lon1: number, lat2: number, lon2: number): number {\n  const R = 6378.137;\n  const dLat = (lat2 * Math.PI) / 180 - (lat1 * Math.PI) / 180;\n  const dLon = (lon2 * Math.PI) / 180 - (lon1 * Math.PI) / 180;\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos((lat1 * Math.PI) / 180) * Math.cos((lat2 * Math.PI) / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const d = R * c;\n  return d * 1000; // measured in meters\n}\n\nexport function convertBytes(contentLength: number): string {\n  const units = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n  let i = 0;\n\n  while (contentLength >= 1000 && i < units.length - 1) {\n    contentLength /= 1000;\n    i++;\n  }\n\n  return `${Math.floor(contentLength * 100) / 100} ${units[i]}`;\n}\n\nexport function convertNumberToLetters(number: number): string {\n  let result = '';\n  while (number > 0) {\n    let remainder = (number - 1) % 26; // Adjust for 1-based indexing\n    let letter = String.fromCharCode(remainder + 65); // A=65 in ASCII\n    result = letter + result;\n    number = Math.floor((number - 1) / 26); // Update number for next iteration\n  }\n  return result;\n}\n","export function getTextWidth(text: string, weight: number, size: string, fontFamily: string): number {\n  const canvas: HTMLCanvasElement = getTextWidth.canvas || (getTextWidth.canvas = document.createElement('canvas'));\n  const context = canvas.getContext('2d');\n  const font: string = `${weight} ${size} ${fontFamily}`;\n  context.font = font;\n  return context.measureText(text).width;\n}\n\nexport function getTextHeight(text: string, weight: number, size: string, fontFamily: string): number {\n  const canvas: HTMLCanvasElement = getTextHeight.canvas || (getTextHeight.canvas = document.createElement('canvas'));\n  const context = canvas.getContext('2d');\n  const font: string = `${weight} ${size} ${fontFamily}`;\n  context.font = font;\n  context.textBaseline = 'top';\n  return context.measureText(text).actualBoundingBoxDescent;\n}\n\ninterface CornerRadius {\n  tl: number;\n  tr: number;\n  br: number;\n  bl: number;\n}\n\nexport function drawRoundedRect(ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, radius: number | CornerRadius, fill: string): void {\n  // If radius is a single value, treat it as the same for all corners\n  if (typeof radius === 'number') {\n    radius = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    // Set defaults if individual radii are not provided\n    radius = {\n      tl: radius.tl || 0,\n      tr: radius.tr || 0,\n      br: radius.br || 0,\n      bl: radius.bl || 0\n    };\n  }\n\n  // Start path\n  ctx.beginPath();\n  // Move to the top-left corner, accounting for the top-left radius\n  ctx.moveTo(x + radius.tl, y);\n  // Draw the top line, rounding the top-right corner\n  ctx.lineTo(x + width - radius.tr, y);\n  ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\n  // Draw the right side, rounding the bottom-right corner\n  ctx.lineTo(x + width, y + height - radius.br);\n  ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);\n  // Draw the bottom side, rounding the bottom-left corner\n  ctx.lineTo(x + radius.bl, y + height);\n  ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\n  // Draw the left side, rounding the top-left corner\n  ctx.lineTo(x, y + radius.tl);\n  ctx.quadraticCurveTo(x, y, x + radius.tl, y);\n  // Complete the path\n  ctx.closePath();\n\n  ctx.fillStyle = fill;\n  ctx.fill(); // To fill the shape\n}\n\nexport function generateRoundedRectPath(x: number, y: number, width: number, height: number, radius: number | CornerRadius, inverted: boolean): Array<string> {\n  // Normalize the radius object\n  if (typeof radius === 'number') {\n    radius = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    radius = {\n      tl: radius.tl || 0,\n      tr: radius.tr || 0,\n      br: radius.br || 0,\n      bl: radius.bl || 0\n    };\n  }\n  const { tl, tr, br, bl } = radius;\n  const command = [];\n  if (inverted) {\n    if (tl !== 0) {\n      command.push(`M${x} ${y + tl}`, `Q${x} ${y} ${x + tl} ${y}`, `H${x}`, `V${y + tl}`);\n    }\n    if (tr !== 0) {\n      command.push(`M${x + width - tr} ${y}`, `Q${x + width} ${y} ${x + width} ${y + tr}`, `V${y}`, `H${x + width - tr}`);\n    }\n    if (br !== 0) {\n      command.push(`M${x + width} ${y + height - br}`, `Q${x + width} ${y + height} ${x + width - br} ${y + height}`, `H${x + width}`, `V${y + height - br}`);\n    }\n    if (bl !== 0) {\n      command.push(`M${x + bl} ${y + height}`, `Q${x} ${y + height} ${x} ${y + height - bl}`, `V${y + height}`, `H${x + bl}`);\n    }\n  } else {\n    command.push(`M${x + tl} ${y}`, `H${x + width - tr}`, `Q${x + width} ${y} ${x + width} ${y + tr}`, `V${y + height - br}`, `Q${x + width} ${y + height} ${x + width - br} ${y + height}`, `H${x + bl}`, `Q${x} ${y + height} ${x} ${y + height - bl}`, `V${y + tl}`, `Q${x} ${y} ${x + tl} ${y}`);\n  }\n  return command;\n}\n","export function documentQuerySelector(selectorExpression: string): HTMLElement {\n  return document.querySelector(selectorExpression);\n}\n\nexport function documentQuerySelectorAll(selectorExpression: string): NodeListOf<HTMLElement> {\n  return document.querySelectorAll(selectorExpression);\n}\n\nexport function elementQuerySelector(element: HTMLElement, selectorExpression: string): HTMLElement {\n  return element.querySelector(selectorExpression);\n}\n\nexport function elementQuerySelectorAll(element: HTMLElement, selectorExpression: string): NodeListOf<HTMLElement> {\n  return element.querySelectorAll(selectorExpression);\n}\n\nexport function getElementsBelow(referenceElement: HTMLElement, className: string): Array<HTMLElement> {\n  const elements = [];\n  let sibling = referenceElement.nextElementSibling;\n\n  while (sibling) {\n    if (sibling.classList.contains(className)) {\n      elements.push(sibling);\n    }\n    sibling = sibling.nextElementSibling;\n  }\n\n  return elements;\n}\n\nexport function removeFirstChild(element: HTMLElement): void {\n  const firstChild = element.firstChild;\n  if (firstChild !== null) {\n    element.removeChild(firstChild);\n  }\n}\n","import { searchRouteByRouteID } from '../../../data/search/index';\nimport { getPermalink } from '../../../tools/permalink';\nimport { promptMessage } from '../../prompt/index';\nimport { openQRCode } from '../../qrcode/index';\n\nexport async function shareRoutePermalink(RouteID: number) {\n  const thisRoute = await searchRouteByRouteID(RouteID);\n  if (thisRoute !== false) {\n    const link = getPermalink(0, {\n      id: RouteID,\n      name: thisRoute.n\n    });\n    if (navigator.share) {\n      navigator\n        .share({\n          title: thisRoute.n,\n          url: link\n        })\n        .then(() => {\n          promptMessage('check_circle', '已分享路線');\n        })\n        .catch((e) => {\n          promptMessage('cancel', '已取消分享');\n          console.error(e);\n        });\n    }\n  }\n}\n\nexport async function showRoutePermalinkQRCode(RouteID: number) {\n  const thisRoute = await searchRouteByRouteID(RouteID);\n  if (thisRoute !== false) {\n    const link = getPermalink(0, {\n      id: RouteID,\n      name: thisRoute.n\n    });\n    openQRCode(link);\n  }\n}\n","import { Calendar, CalendarDay, CalendarEvent, CalendarEventGroup } from '../../../data/route/details';\nimport { getSettingOptionValue } from '../../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { drawRoundedRect } from '../../../tools/graphic';\nimport { booleanToString } from '../../../tools/index';\nimport { getCSSVariableValue } from '../../../tools/style';\nimport { GeneratedElement, querySize } from '../../index';\nimport { CalendarDaysElement, CalendarEventGroupsElement } from './index';\n\nconst calendarRatio = 70;\nconst scaleLimit = 3150 / (calendarRatio * 24);\nconst gridlineBoxHeight = 10;\nconst gridlineWidth = 1.2;\nconst gridlineLabelWidthLimit = 45;\nconst fontFamily: string = '\"Noto Sans TC\", sans-serif';\n\nlet canvasSize = querySize('route-details-canvas');\nlet canvasWidth = canvasSize.width;\nlet canvasHeight = canvasSize.height;\nlet canvasScale = Math.min(window.devicePixelRatio, scaleLimit) || 1;\n\nlet previousCalendar = {} as Calendar;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nfunction resizeRouteDetailsCalendarCanvas(canvas: HTMLCanvasElement): void {\n  canvasSize = querySize('route-details-canvas');\n  canvasWidth = canvasSize.width;\n  canvasHeight = canvasSize.height;\n  canvasScale = Math.min(window.devicePixelRatio, scaleLimit) || 1;\n\n  // Set the new size\n  canvas.width = canvasWidth * canvasScale;\n  canvas.height = canvasHeight * canvasScale;\n\n  // Reset transformations before scaling\n  const context = canvas.getContext('2d');\n  context.setTransform(1, 0, 0, 1, 0, 0);\n  context.scale(canvasScale, canvasScale);\n}\n\nfunction generateElementOfDay(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_route_details_calendar_day');\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction generateElementOfEventGroup(): GeneratedElement {\n  // Main event group element\n  const eventGroupElement = document.createElement('div');\n  eventGroupElement.classList.add('css_route_details_calendar_event_group');\n\n  // Canvas element\n  const canvasElement = document.createElement('canvas');\n  canvasElement.classList.add('css_route_details_calendar_event_group_canvas');\n  eventGroupElement.appendChild(canvasElement);\n\n  return {\n    element: eventGroupElement,\n    id: ''\n  };\n}\n\nexport function setUpCalendarGroupSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultEventQuantity = {\n    d_0: 47,\n    d_1: 47,\n    d_2: 47,\n    d_3: 47,\n    d_4: 47,\n    d_5: 47,\n    d_6: 47\n  };\n  const defaultDayQuantity = 7;\n  let calendarEventGroups = {};\n  let calendarDays = {};\n  for (let i = 0; i < defaultDayQuantity; i++) {\n    const eventGroupKey = `d_${i}`;\n    calendarEventGroups[eventGroupKey] = [];\n    calendarDays[eventGroupKey] = {\n      day: i,\n      code: `d_{i}`,\n      name: ''\n    };\n    for (let j = 0; j < defaultEventQuantity[eventGroupKey]; j++) {\n      const date = new Date();\n      date.setHours(0);\n      date.setMinutes(j * 30);\n      date.setSeconds(0);\n      date.setMilliseconds(0);\n      calendarEventGroups[eventGroupKey].push({\n        date: date,\n        dateString: '',\n        duration: 15\n      });\n    }\n  }\n  updateCalendarGroup(\n    {\n      calendarEventGroups: calendarEventGroups,\n      calendarDays: calendarDays,\n      calendarDayQuantity: defaultDayQuantity,\n      calendarEventQuantity: defaultEventQuantity\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateDay(thisDayElement: HTMLElement, thisDay: CalendarDay, currentDay: number, skeletonScreen: boolean, animation: boolean, index: number): void {\n  thisDayElement.innerText = thisDay.name;\n  thisDayElement.setAttribute('day', index.toString());\n  thisDayElement.onclick = function () {\n    switchCalendarDay(index);\n  };\n  thisDayElement.setAttribute('highlighted', currentDay === index ? 'true' : 'false');\n  thisDayElement.setAttribute('animation', booleanToString(animation));\n  thisDayElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n}\n\nfunction updateEventGroup(thisCalendarEventGroupElement: HTMLElement, thisCalendarEventGroup: CalendarEventGroup, currentDay: number, mainColor: string, mainColorR: string, mainColorG: string, mainColorB: string, mainColorA: string, gridColor: string, index: number): void {\n  function drawGridline(thisContext: CanvasRenderingContext2D, hours: number, gridColor: string): void {\n    const boxX = 0;\n    const boxY = hours * calendarRatio;\n\n    // Cache the color value once\n    thisContext.fillStyle = gridColor;\n\n    // Draw line\n    thisContext.fillRect(boxX + gridlineLabelWidthLimit, boxY + 5, canvasWidth - gridlineLabelWidthLimit, gridlineWidth);\n\n    // Draw label\n    thisContext.font = `400 ${12}px ${fontFamily}`;\n    thisContext.textBaseline = 'top';\n    const labelText = `${String(hours).padStart(2, '0')}:00`;\n    const labelMeasurement = thisContext.measureText(labelText);\n    const labelWidth = labelMeasurement.width;\n    const labelHeight = labelMeasurement.actualBoundingBoxDescent;\n    thisContext.fillText(labelText, (gridlineLabelWidthLimit - labelWidth) / 2, boxY + (gridlineBoxHeight - labelHeight) / 2, labelWidth);\n  }\n\n  function drawEvent(thisContext: CanvasRenderingContext2D, thisCalendarEvent: CalendarEvent, mainColor: string, mainColorR: string, mainColorG: string, mainColorB: string, mainColorA: string): void {\n    // Calculate the start of the day for this event only once.\n    const thisDayStart = new Date();\n    thisDayStart.setDate(1);\n    thisDayStart.setMonth(0);\n    thisDayStart.setFullYear(thisCalendarEvent.date.getFullYear());\n    thisDayStart.setMonth(thisCalendarEvent.date.getMonth());\n    thisDayStart.setDate(thisCalendarEvent.date.getDate());\n    thisDayStart.setHours(0);\n    thisDayStart.setMinutes(0);\n    thisDayStart.setSeconds(0);\n    thisDayStart.setMilliseconds(0);\n\n    const boxX = gridlineLabelWidthLimit;\n    const boxY = ((thisCalendarEvent.date.getTime() - thisDayStart.getTime()) / (24 * 60 * 60 * 1000)) * 24 * calendarRatio;\n    const boxWidth = canvasWidth - gridlineLabelWidthLimit;\n    const boxHeight = ((thisCalendarEvent.duration * 60 * 1000) / (24 * 60 * 60 * 1000)) * 24 * calendarRatio;\n\n    // Draw background with rounded rectangle\n    drawRoundedRect(thisContext, boxX, boxY, boxWidth, boxHeight, 3, `rgba(${mainColorR}, ${mainColorG}, ${mainColorB}, ${mainColorA})`);\n\n    // Draw decoration (a thin rounded rectangle)\n    drawRoundedRect(thisContext, boxX, boxY, 3, boxHeight, { tl: 3, tr: 0, bl: 3, br: 0 }, mainColor);\n\n    // Draw event text\n    thisContext.font = `400 ${14}px ${fontFamily}`;\n    thisContext.textBaseline = 'top';\n    thisContext.fillStyle = mainColor;\n    const text = thisCalendarEvent.dateString;\n    const textMeasurement = thisContext.measureText(text);\n    const textWidth = textMeasurement.width;\n    const textHeight = textMeasurement.actualBoundingBoxDescent;\n    thisContext.fillText(text, boxX + 8, boxY + (boxHeight - textHeight) / 2, textWidth);\n  }\n\n  function updateDisplayed(thisCalendarEventGroupElement: HTMLElement, currentDay: number, index: number): void {\n    // Set the displayed attribute based on whether it is the current day.\n    const isDisplayed = currentDay === index;\n    thisCalendarEventGroupElement.setAttribute('displayed', booleanToString(isDisplayed));\n  }\n\n  // Get the canvas and its 2D context.\n  const thisCalendarEventGroupCanvas = elementQuerySelector(thisCalendarEventGroupElement, '.css_route_details_calendar_event_group_canvas') as HTMLCanvasElement;\n  const thisCalendarEventGroupCanvasContext = thisCalendarEventGroupCanvas.getContext('2d');\n\n  // Update the displayed attribute\n  updateDisplayed(thisCalendarEventGroupElement, currentDay, index);\n\n  // Always resize the canvas to ensure proper dimensions.\n  resizeRouteDetailsCalendarCanvas(thisCalendarEventGroupCanvas);\n\n  const isDisplayed = currentDay === index;\n  if (isDisplayed) {\n    // Clear the canvas and redraw the content when displayed.\n    thisCalendarEventGroupCanvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n\n    // Draw the gridlines.\n    for (let hours = 0; hours < 24; hours++) {\n      drawGridline(thisCalendarEventGroupCanvasContext, hours, gridColor);\n    }\n\n    // Draw all events for this group.\n    for (const thisCalendarEvent of thisCalendarEventGroup) {\n      drawEvent(thisCalendarEventGroupCanvasContext, thisCalendarEvent, mainColor, mainColorR, mainColorG, mainColorB, mainColorA);\n    }\n  } else {\n    // When not displayed, clear the canvas.\n    thisCalendarEventGroupCanvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  }\n}\n\nexport function updateCalendarGroup(calendar: Calendar, skeletonScreen: boolean, animation: boolean): void {\n  // The default day to display.\n  const currentDay = new Date().getDay();\n\n  // Retrieve the CSS variable values just once\n  const mainColorR = getCSSVariableValue('--b-cssvar-main-color-r');\n  const mainColorG = getCSSVariableValue('--b-cssvar-main-color-g');\n  const mainColorB = getCSSVariableValue('--b-cssvar-main-color-b');\n  const mainColorA = getCSSVariableValue('--b-cssvar-main-color-opacity-e');\n  const mainColor = getCSSVariableValue('--b-cssvar-main-color');\n  const gridColor = getCSSVariableValue('--b-cssvar-ededf2');\n\n  const eventGroups = calendar.calendarDays;\n  const eventGroupQuantity = calendar.calendarDayQuantity;\n  const calendarEventGroups = calendar.calendarEventGroups;\n  const eventQuantity = calendar.calendarEventQuantity;\n\n  const currentEventGroupCapacity = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group').length;\n  if (eventGroupQuantity !== currentEventGroupCapacity) {\n    const difference = currentEventGroupCapacity - eventGroupQuantity;\n    if (difference < 0) {\n      // Add missing day and event group elements.\n      const calendarDaysFragment = new DocumentFragment();\n      const calendarEventGroupsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newDayElement = generateElementOfDay();\n        calendarDaysFragment.appendChild(newDayElement.element);\n        const newEventGroupElement = generateElementOfEventGroup();\n        calendarEventGroupsFragment.appendChild(newEventGroupElement.element);\n      }\n      CalendarDaysElement.append(calendarDaysFragment);\n      CalendarEventGroupsElement.append(calendarEventGroupsFragment);\n    } else {\n      // Remove extra elements.\n      const CalendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n      const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const eventGroupIndex = currentEventGroupCapacity - 1 - o;\n        CalendarDayElements[eventGroupIndex].remove();\n        CalendarEventGroupElements[eventGroupIndex].remove();\n      }\n    }\n  }\n\n  // Update each day and its corresponding event group.\n  const CalendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n  const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n  for (let i = 0; i < eventGroupQuantity; i++) {\n    const eventGroupKey = `d_${i}`;\n    const thisDay = eventGroups[eventGroupKey];\n    const thisEventGroup = calendarEventGroups[eventGroupKey];\n\n    const thisDayElement = CalendarDayElements[i];\n    const thisEventGroupElement = CalendarEventGroupElements[i];\n\n    updateDay(thisDayElement, thisDay, currentDay, skeletonScreen, animation, i);\n    updateEventGroup(thisEventGroupElement, thisEventGroup, currentDay, mainColor, mainColorR, mainColorG, mainColorB, mainColorA, gridColor, i);\n  }\n\n  previousCalendar = calendar;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nexport function switchCalendarDay(day: number): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const calendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n  const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n  for (let i = 0; i < 7; i++) {\n    const thisCalendarDayElement = calendarDayElements[i];\n    // const thisCalendarDayElementDay = parseInt(thisCalendarDayElement.getAttribute('day'));\n    const thisEventGroupElement = CalendarEventGroupElements[i];\n    // if (thisCalendarDayElementDay === day) {\n    /*\n      thisCalendarDayElement.setAttribute('highlighted', 'true');\n      thisEventGroupElement.setAttribute('displayed', 'true');\n      */\n    const eventGroupKey = `d_${i}`;\n    const calendarEventGroup = previousCalendar?.calendarEventGroups[eventGroupKey];\n    const calendarDay = previousCalendar?.calendarDays[eventGroupKey];\n    if (calendarEventGroup && calendarDay) {\n      // Retrieve the CSS variable values just once\n      const mainColorR = getCSSVariableValue('--b-cssvar-main-color-r');\n      const mainColorG = getCSSVariableValue('--b-cssvar-main-color-g');\n      const mainColorB = getCSSVariableValue('--b-cssvar-main-color-b');\n      const mainColorA = getCSSVariableValue('--b-cssvar-main-color-opacity-e');\n      const mainColor = getCSSVariableValue('--b-cssvar-main-color');\n      const gridColor = getCSSVariableValue('--b-cssvar-ededf2');\n\n      // Reuse the drawing logic from updateEventGroup and updateDay for the visible event group.\n      updateDay(thisCalendarDayElement, calendarDay, day, false, playing_animation, i);\n      updateEventGroup(thisEventGroupElement, calendarEventGroup, day, mainColor, mainColorR, mainColorG, mainColorB, mainColorA, gridColor, i);\n    }\n    /*} else {\n      thisCalendarDayElement.setAttribute('highlighted', 'false');\n      thisEventGroupElement.setAttribute('displayed', 'false');\n\n      // Clear the canvas for non-displayed elements.\n      const canvas = elementQuerySelector(thisEventGroupElement, '.css_route_details_calendar_event_group_canvas') as HTMLCanvasElement;\n      const ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n    }*/\n  }\n}\n"],"names":["UnknownCardinalDirection","vector","id","name","symbol","icon","NorthCardinalDirection","WestCardinalDirection","SouthCardinalDirection","EastCardinalDirection","NorthEastCardinalDirection","Math","SQRT1_2","SouthEastCardinalDirection","SouthWestCardinalDirection","NorthWestCardinalDirection","getCardinalDirectionFromVector","directions","unitVector","normalizeVector","maxDotProduct","Infinity","bestMatch","_i","_directions","length","direction","dotProduct","areItemsDifferent","arr","i","j","getIntersection","arrayA","arrayB","result","_step","_iterator","_createForOfIteratorHelper","s","n","done","item","value","indexOf","push","err","e","f","_step2","_iterator2","previousProperties","previousAnimation","previousSkeletonScreen","generateElementOfProperty","propertyElement","document","createElement","classList","add","iconElement","appendChild","getBlankIconElement","valueElement","element","setUppropertiesGroupSkeletonScreen","playing_animation","getSettingOptionValue","properties","key","updatePropertiesField","skeletonScreen","animation","updateProperty","thisElement","thisProperty","previousProperty","updateIcon","thisIconElement","elementQuerySelector","setIcon","updateValue","innerText","updateAnimation","setAttribute","booleanToString","updateSkeletonScreen","compareThings","propertyQuantity","PropertiesGroupElement","currentPropertyCapacity","elementQuerySelectorAll","PropertiesGroupBodyElement","difference","fragment","DocumentFragment","o","d","abs","newPropertyElement","append","propertyElements","remove","thisPropertyElement","generateLetterLabels","quantity","convertNumberToLetters","generateDirectionLabels","cardinalDirections","cardinalDirection","port","pakoInflateWorkerResponses","SharedWorker","pakoInflateSharedWorker","URL","start","pakoInflateWorker","Worker","pakoInflate","_x","_pakoInflate","apply","arguments","buffer","taskID","generateIdentifier","Promise","resolve","reject","onerror","message","postMessage","onmessage","_e$data","_slicedToArray","data","getUnicodes","string","unique","undefined","stringLength","unicode","charCodeAt","containPhoneticSymbols","test","SettingsField","documentQuerySelector","SettingsBodyElement","SettingsElement","generateElementOfItem","settingElement","type","iconSpanElement","getIconElement","nameElement","createTextNode","statusElement","status","arrowElement","arrowSpanElement","action","onclick","_initializeSettingsField","_asyncToGenerator","list","listSettings","innerHTML","openSettings","pushPageHistory","initializeSettingsField","closeSettings","revokePageHistory","downloadExportFile","_downloadExportFile","promptMessage","content","exportData","releaseFile","openFileToImportData","identifier","fileInput","addEventListener","event","target","files","file","reader","FileReader","onload","fileTextContent","importData","then","readAsText","once","body","click","viewSourceCodeOfCurrentVersion","url","getTreeURLOfCurrentVersion","window","open","viewGitHubRepository","showPromptToAskForPersistentStorage","askForPersistentStorage","CssVariableValueCache","light","dark","getCSSVariableValue","property","CurrentColorScheme","matchMedia","matches","hasOwnProperty","getComputedStyle","documentElement","getPropertyValue","convertPositionsToDistance","lat1","lon1","lat2","lon2","dLat","PI","dLon","a","sin","cos","atan2","sqrt","convertBytes","contentLength","units","floor","number","remainder","String","fromCharCode","getTextWidth","text","weight","size","fontFamily","context","canvas","getContext","font","measureText","width","drawRoundedRect","ctx","x","y","height","radius","fill","tl","tr","br","bl","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","fillStyle","generateRoundedRectPath","inverted","_radius","command","selectorExpression","querySelector","documentQuerySelectorAll","querySelectorAll","getElementsBelow","referenceElement","className","elements","sibling","nextElementSibling","contains","shareRoutePermalink","_shareRoutePermalink","RouteID","thisRoute","searchRouteByRouteID","link","getPermalink","navigator","share","title","showRoutePermalinkQRCode","_x2","_showRoutePermalinkQRCode","openQRCode","canvasSize","querySize","canvasWidth","canvasHeight","canvasScale","min","devicePixelRatio","previousCalendar","generateElementOfDay","generateElementOfEventGroup","eventGroupElement","canvasElement","setUpCalendarGroupSkeletonScreen","defaultEventQuantity","d_0","d_1","d_2","d_3","d_4","d_5","d_6","calendarEventGroups","calendarDays","eventGroupKey","day","code","date","Date","setHours","setMinutes","setSeconds","setMilliseconds","dateString","duration","updateCalendarGroup","calendarDayQuantity","calendarEventQuantity","updateDay","thisDayElement","thisDay","currentDay","index","toString","calendarDayElements","CalendarDaysElement","CalendarEventGroupElements","CalendarEventGroupsElement","_previousCalendar","_previousCalendar2","thisCalendarDayElement","thisEventGroupElement","calendarEventGroup","calendarDay","mainColorR","mainColorG","mainColorB","mainColorA","mainColor","gridColor","updateEventGroup","switchCalendarDay","thisCalendarEventGroupElement","thisCalendarEventGroup","drawGridline","thisContext","hours","boxY","fillRect","boxX","textBaseline","labelText","padStart","labelMeasurement","labelWidth","labelHeight","actualBoundingBoxDescent","fillText","drawEvent","thisCalendarEvent","thisDayStart","setDate","setMonth","setFullYear","getFullYear","getMonth","getDate","getTime","boxWidth","boxHeight","textMeasurement","textWidth","textHeight","thisCalendarEventGroupCanvas","thisCalendarEventGroupCanvasContext","isDisplayed","updateDisplayed","setTransform","scale","resizeRouteDetailsCalendarCanvas","clearRect","calendar","getDay","eventGroups","eventGroupQuantity","currentEventGroupCapacity","calendarDaysFragment","calendarEventGroupsFragment","newDayElement","newEventGroupElement","CalendarDayElements","eventGroupIndex","thisEventGroup"],"ignoreList":[],"sourceRoot":""}