"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[537],{4131(t,e,n){n.d(e,{a:()=>x,b:()=>$,c:()=>w});var a=n(467),i=n(2937),r=n(8179),o=n(7968),d=n(8024),c=n(5579),l=n(904),s=(0,r.c)(".f"),u=(0,r.e)(s,".g"),f=Array.from((0,r.d)(u,".h")),p=new Date,v={},h=["","",""],g=0,m=!1;function b(t,e,n){for(var a="'Noto Sans TC', sans-serif",i=[],r=[],d=0;d<24;d++){var l=`${d.toString().padStart(2,"0")}:00`,s=70*d+10;i.push(`M35 ${s}`,"h"+(n-35)),r.push(`<text x="5" y="${s+3}" font-weight="400" font-size="10" font-family="${a}" component="gridline-label">${l}</text>`)}for(var u=`<path d="${i.join(" ")}" fill="none" stroke-width="0.35" component="gridline"/>`,f=1700,p=e.getDay(),v=p<1?6:p-1,h=t.repeated[v],g=t.scheduled,m=(0,c.h)(e,0,0,t.timeZoneOffset-e.getTimezoneOffset()),b=[m.getFullYear(),m.getMonth()+1,m.getDate()],y=g.length-1;y>=0;y--)b[0]===g[y].date[0]&&b[1]===g[y].date[1]&&b[2]===g[y].date[2]&&h.push({type:"repeated",time:g[y].time,interval:g[y].interval,count:g[y].count,day:p});for(var w=[],x=[],$=[],A=h.length-1;A>=0;A--){var k=h[A].time[0]/1440*f,D=n-35,S=(h[A].time[1]-h[A].time[0])/1440*f,C=h[A].time[0]%60,T=(h[A].time[0]-C)/60,L=h[A].time[1]%60,M=(h[A].time[1]-L)/60,_=`${T.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")} - ${M.toString().padStart(2,"0")}:${L.toString().padStart(2,"0")}`,j=`每${h[A].interval[0]===h[A].interval[1]?h[A].interval[0]:h[A].interval.join(" - ")}分鐘一班 | ${h[A].count[0]===h[A].count[1]?h[A].count[0]:h[A].count.join(" - ")}班`;Array.prototype.push.apply(w,(0,o.b)(35,k,D,S,5,!1)),x.push(`M38 ${k+3}`,"v"+(S-6)),$.push(`<text x="44" y="${k+3+17}" font-weight="500" font-size="15" font-family="${a}" component="event-title">${_}</text>`,`<text x="44" y="${k+3+17+17}" font-weight="500" font-size="15" font-family="${a}" component="event-description">${j}</text>`)}var F=`<path d="${w.join(" ")}" stroke="none" component="event-box"/>`,E=`<path d="${x.join(" ")}" fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" component="event-decoration"/>`;return`<svg width="${n}" height="1700" viewBox="0 0 ${n} 1700" xmlns="http://www.w3.org/2000/svg">${u}${r.join("")}${F}${E}${$.join("")}</svg>`}function y(){return(y=(0,a.a)(function*(t){var e=(0,l.d)("window");g=e.width,p=new Date;var n=(0,d.c)(),a=yield(0,i.a)(t,n);v=a;for(var r=0;r<3;r++){var o=(0,c.h)(p,r-1,0,0);h[r]=b(a,o,g),f[r].innerHTML=h[r]}m||(m=!0,u.addEventListener("scrollend",function(){var t=u.scrollLeft,e=Math.round(t/g);if(0===e){p=(0,c.h)(p,-1,0,0);var n=(0,c.h)(p,-1,0,0);f[0].before(f[2]),u.scrollTo({left:g});var a=[f[2],f[0],f[1]];f[0]=a[0],f[1]=a[1],f[2]=a[2];var i=[b(v,n,g),h[0],h[1]];h[0]=i[0],h[1]=i[1],h[2]=i[2],f[0].innerHTML=h[0]}else if(2===e){p=(0,c.h)(p,1,0,0);var r=(0,c.h)(p,1,0,0);f[2].after(f[0]),u.scrollTo({left:g});var o=[f[1],f[2],b(v,r,g)];f[0]=o[0],f[1]=o[1],f[2]=o[2],f[2].innerHTML=h[2]}}),u.scrollTo({left:g}))})).apply(this,arguments)}function w(){s.setAttribute("displayed","true")}function x(){s.setAttribute("displayed","false")}function $(t){(0,l.c)("RouteCalendar"),w(),function(t){y.apply(this,arguments)}(t),(0,l.b)()}},5286(t,e,n){n.d(e,{a:()=>G,b:()=>Y,c:()=>J,d:()=>I,e:()=>X,f:()=>V,g:()=>W,h:()=>U});var a=n(467),i=n(9566),r=n(8621),o=n(3459),d=n(8179),c=n(8024),l=n(904),s=n(3041),u=n(8134),f=n(9469),p=n(251),v=n(8279);function h(){return(h=(0,a.a)(function*(t){var e=yield(0,u.e)(t);if(!1!==e){var n=(0,f.a)(0,{id:t,name:e.n});(0,p.b)(e.n,n)}})).apply(this,arguments)}function g(){return(g=(0,a.a)(function*(t){var e=yield(0,u.e)(t);if(!1!==e){var n=(0,f.a)(0,{id:t,name:e.n});(0,v.c)(n)}})).apply(this,arguments)}var m=n(7968),b=n(6141),y='"Noto Sans TC", sans-serif',w=(0,l.d)("route-details-canvas"),x=w.width,$=w.height,A=Math.min(window.devicePixelRatio,1.875)||1,k={};function D(){var t=(0,d.a)();return t.classList.add("i"),t}function S(){var t=(0,d.a)();t.classList.add("j");var e=document.createElement("canvas");return e.classList.add("k"),t.appendChild(e),t}function C(t,e,n,a,i,r){t.innerText=e.name,t.setAttribute("day",r.toString()),t.onclick=function(){!function(t){for(var e=(0,o.b)("playing_animation"),n=(0,d.d)(G,".i"),a=(0,d.d)(Y,".j"),i=0;i<7;i++){var r,c,l=n[i],s=a[i],u=`d_${i}`,f=null===(r=k)||void 0===r?void 0:r.calendarEventGroups[u],p=null===(c=k)||void 0===c?void 0:c.calendarDays[u];if(f&&p){var v=(0,b.a)("--b"),h=(0,b.a)("--l"),g=(0,b.a)("--m");C(l,p,t,!1,e,i),T(s,f,t,v,h,g,i)}}}(r)},t.setAttribute("highlighted",n===r?"true":"false"),t.setAttribute("animation",(0,c.a)(i)),t.setAttribute("skeleton-screen",(0,c.a)(a))}function T(t,e,n,a,i,r,o){function s(t,e,n){var a=70*e;t.fillStyle=n,t.fillRect(45,a+5,x-45,1.2),t.font=`400 12px ${y}`,t.textBaseline="top";var i=`${String(e).padStart(2,"0")}:00`,r=t.measureText(i),o=r.width,d=r.actualBoundingBoxDescent;t.fillText(i,(45-o)/2,a+(10-d)/2,o)}function u(t,e,n,a){var i=new Date;i.setDate(1),i.setMonth(0),i.setFullYear(e.date.getFullYear()),i.setMonth(e.date.getMonth()),i.setDate(e.date.getDate()),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0);var r=(e.date.getTime()-i.getTime())/864e5*24*70,o=x-45,d=60*e.duration*1e3/864e5*24*70;(0,m.a)(t,45,r,o,d,3,a),(0,m.a)(t,45,r,3,d,{tl:3,tr:0,bl:3,br:0},n),t.font=`400 14px ${y}`,t.textBaseline="top",t.fillStyle=n;var c=e.dateString,l=t.measureText(c),s=l.width,u=l.actualBoundingBoxDescent;t.fillText(c,53,r+(d-u)/2,s)}var f=(0,d.e)(t,".k"),p=f.getContext("2d");if(function(t,e,n){var a=e===n;t.setAttribute("displayed",(0,c.a)(a))}(t,n,o),function(t){w=(0,l.d)("route-details-canvas"),x=w.width,$=w.height,A=Math.min(window.devicePixelRatio,1.875)||1,t.width=x*A,t.height=$*A;var e=t.getContext("2d");e.setTransform(1,0,0,1,0,0),e.scale(A,A)}(f),n===o){p.clearRect(0,0,x,$);for(var v=0;v<24;v++)s(p,v,r);for(var h of e)u(p,h,a,i)}else p.clearRect(0,0,x,$)}function L(t,e,n){var a=(new Date).getDay(),i=(0,b.a)("--b"),r=(0,b.a)("--l"),o=(0,b.a)("--m"),c=t.calendarDays,l=t.calendarDayQuantity,s=t.calendarEventGroups,u=(t.calendarEventQuantity,Array.from((0,d.d)(Y,".j"))),f=Array.from((0,d.d)(G,".i")),p=u.length;if(l!==p){var v=p-l;if(v<0){for(var h=new DocumentFragment,g=new DocumentFragment,m=0;m>v;m--){var y=D();h.appendChild(y),f.push(y);var w=S();g.appendChild(w),u.push(w)}G.append(h),Y.append(g)}else if(v>0)for(var x=p-1,$=p-v-1;x>$;x--)f[x].remove(),f.splice(x,1),u[x].remove(),u.splice(x,1)}for(var A=0;A<l;A++){var L=`d_${A}`,M=c[L],_=s[L],j=f[A],F=u[A];C(j,M,a,e,n,A),T(F,_,a,i,r,o,A)}k=t}var M=n(4537),_=[],j=!1,F=!1;function E(){var t=(0,d.a)();t.classList.add("n");var e=(0,d.a)();e.classList.add("o"),e.appendChild((0,M.a)()),t.appendChild(e);var n=(0,d.a)();return n.classList.add("p"),t.appendChild(n),t}function R(t,e,n){function a(t,a,i){function r(t,e){var n=(0,d.e)(t,".o");(0,M.c)(n,e.icon)}function o(t,e){(0,d.e)(t,".p").innerText=e.value}function l(t,e){t.setAttribute("animation",(0,c.a)(e))}function s(t,e){t.setAttribute("skeleton-screen",(0,c.a)(e))}null==i?(r(t,a),o(t,a),l(t,n),s(t,e)):((0,c.b)(i,a)||r(t,a),(0,c.b)(i,a)||o(t,a),j!==n&&l(t,n),F!==e&&s(t,e))}var i=t.length;e!==F&&I.setAttribute("skeleton-screen",(0,c.a)(e));var r=Array.from((0,d.d)(J,".n")),o=r.length;if(i!==o){var l=o-i;if(l<0){for(var s=new DocumentFragment,u=0;u>l;u--){var f=E();s.appendChild(f),r.push(f)}J.append(s)}else if(l>0)for(var p=o-1,v=o-l-1;p>v;p--)r[p].remove(),r.splice(p,1)}for(var h=0;h<i;h++){var g=r[h],m=t[h];0===_.length?a(g,m,null):a(g,m,_[h])}_=t,j=n,F=e}var B=(0,d.c)(".q"),H=(0,d.e)(B,".r"),z=(0,d.e)(H,".s"),N=(0,d.e)(z,'.t[group="calendar"]'),Q=(0,d.e)(N,".u"),G=(0,d.e)(Q,".v"),Y=(0,d.e)(Q,".w"),q=(0,d.e)(B,'.r .s .t[group="actions"]'),O=(0,d.e)(q,'.u .x[action="save-to-folder"]'),P=(0,d.e)(q,'.u .x[action="get-permalink"]'),Z=(0,d.e)(q,'.u .x[action="show-permalink-qrcode"]'),I=(0,d.e)(z,'.t[group="properties"]'),J=(0,d.e)(I,".u");function K(){return K=(0,a.a)(function*(t,e){var n=(0,o.b)("playing_animation"),a=yield(0,i.e)("route",t);O.setAttribute("animation",(0,c.a)(n)),O.setAttribute("highlighted",(0,c.a)(a)),O.onclick=function(){(0,s.c)("route",[t],O)},P.setAttribute("animation",(0,c.a)(n)),P.onclick=function(){!function(t){h.apply(this,arguments)}(t)},Z.setAttribute("animation",(0,c.a)(n)),Z.onclick=function(){!function(t){g.apply(this,arguments)}(t)},function(){for(var t=(0,o.b)("playing_animation"),e=[],n=0;n<5;n++)e.push({key:n,icon:"none",value:""});R(e,!0,t)}(),function(){for(var t=(0,o.b)("playing_animation"),e={d_0:47,d_1:47,d_2:47,d_3:47,d_4:47,d_5:47,d_6:47},n={},a={},i=0;i<7;i++){var r=`d_${i}`;n[r]=[],a[r]={day:i,code:"d_{i}",name:""};for(var d=0;d<e[r];d++){var c=new Date;c.setHours(0),c.setMinutes(30*d),c.setSeconds(0),c.setMilliseconds(0),n[r].push({date:c,dateString:"",duration:15})}}L({calendarEventGroups:n,calendarDays:a,calendarDayQuantity:7,calendarEventQuantity:e},!0,t)}();var d=(0,c.c)(),l=yield(0,r.a)(t,e,d);R(l.properties,!1,n),L(l.calendar,!1,n)}),K.apply(this,arguments)}function U(){B.setAttribute("displayed","true")}function V(){B.setAttribute("displayed","false")}function W(t,e){(0,l.c)("RouteDetails"),U(),function(t,e){K.apply(this,arguments)}(t,e),(0,l.b)()}function X(){V(),(0,l.i)(),(0,l.e)("RouteDetails");var t=(0,d.d)(Y,".j");for(var e of t)e.remove();var n=(0,d.d)(G,".i");for(var a of n)a.remove()}},3041(t,e,n){n.d(e,{a:()=>$,b:()=>w,c:()=>x,d:()=>y});var a=n(9566),i=n(8179),r=n(8024),o=n(6052),d=n(4537),c=n(904),l=n(9119),s=(0,i.c)(".y"),u=(0,i.e)(s,".z"),f=(0,i.e)(u,"._"),p=(0,i.e)(s,".aa"),v=(0,i.e)(p,".ba"),h="已儲存至資料夾",g="無法儲存";function m(t,e,n,o){var c=(0,i.a)();c.classList.add("ca");var s=(0,i.a)();s.classList.add("da");var u=document.createElement("span");u.appendChild((0,d.b)(t.icon)),s.appendChild(u);var f=(0,i.a)();switch(f.classList.add("ea"),f.innerText=t.name,c.appendChild(s),c.appendChild(f),e){case"stop":c.onclick=function(){(0,a.n)(t.id,n[0],n[1]).then(function(t){t?(0,a.e)("stop",n[0]).then(function(t){t&&(null!=o&&o.setAttribute("highlighted",(0,r.a)(t)),(0,l.a)("folder",h),$())}):(0,l.a)("warning",g)})};break;case"route":c.onclick=function(){(0,a.m)(t.id,n[0]).then(function(t){t?(0,a.e)("route",n[0]).then(function(t){t&&(null!=o&&o.setAttribute("highlighted",(0,r.a)(t)),(0,l.a)("folder",h),$())}):(0,l.a)("warning",g)})};break;case"location":c.onclick=function(){(0,a.l)(t.id,n[0]).then(function(t){t?(0,a.e)("location",n[0]).then(function(t){t&&(null!=o&&o.setAttribute("highlighted",(0,r.a)(t)),(0,l.a)("folder",h),$())}):(0,l.a)("warning",g)})}}return c}function b(t,e,n){v.onclick=function(){(0,o.c)(function(){b(t,e,n)})};var i=(0,a.j)();f.innerHTML="";var r=new DocumentFragment;for(var d of i){var c=m(d,t,e,n);r.appendChild(c)}f.append(r)}function y(){s.setAttribute("displayed","true")}function w(){s.setAttribute("displayed","false")}function x(t,e,n){(0,c.c)("SaveToFolder"),y(),b(t,e,n),(0,c.b)()}function $(){w(),(0,c.i)(),(0,c.e)("SaveToFolder")}},752(t,e,n){n.d(e,{a:()=>h,b:()=>p,c:()=>v,d:()=>f});var a=n(3422),i=n(8179),r=n(4537),o=n(904),d=n(9119),c=(0,i.c)(".fa"),l=(0,i.e)(c,".ga"),s=(0,i.e)(l,".ha");function u(t,e,n,o,c){var l=(0,i.a)();l.classList.add("ia");var s=(0,i.a)();s.classList.add("ja");var u=document.createElement("span");u.appendChild((0,r.b)(t.icon)),s.appendChild(u);var f=(0,i.a)();f.classList.add("ka"),f.innerText=t.name;var p=t.index;return l.onclick=function(){!function(t,e,n,i,r){(0,d.a)("manufacturing","處理中"),t.setAttribute("enabled","false"),h(),(0,a.m)(e,n,i,r).then(function(e){switch(e){case 0:(0,d.a)("error","設定失敗"),t.setAttribute("enabled","true");break;case 1:(0,d.a)("check_circle","設定成功"),t.setAttribute("enabled","true"),t.setAttribute("highlighted","true");break;case 2:(0,d.a)("warning","在設定中註冊後才可設定到站通知"),t.setAttribute("enabled","true")}})}(e,n,o,c,p)},l.appendChild(s),l.appendChild(f),l}function f(){c.setAttribute("displayed","true")}function p(){c.setAttribute("displayed","false")}function v(t,e,n,i){(0,o.c)("ScheduleNotification"),f(),function(t,e,n,i){s.innerHTML="";var r=new DocumentFragment;for(var o of a.n){var d=u(o,t,e,n,i);r.appendChild(d)}s.append(r)}(t,e,n,i),(0,o.b)()}function h(){p(),(0,o.i)(),(0,o.e)("ScheduleNotification")}},4680(){},7820(){},1580(){},3127(){},7868(){},1306(){},3058(){},6388(){},1102(){},1743(){},6597(){},3777(){},9991(){},2421(){},2696(){},5461(){},5392(){},3534(){},6018(){},7225(){},1308(){},7723(){},1603(){},3749(){},7217(){},7287(){}}]);
//# sourceMappingURL=071be20a73e05f7b330a.js.map