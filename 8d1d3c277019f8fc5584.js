"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[343],{4225(t,e,r){r.d(e,{F:()=>u});var n=r(467),a=r(7183),i=r(4311);function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){l=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t){var e="",r="";switch((0,i.pD)(t)){case"cacheStore":e="快取",r="cache";break;case"settingsStore":e="設定",r="settings";break;case"dataUsageStatsStore":case"updateRateDataStore":case"updateRateDataWriteAheadLogStore":case"busArrivalTimeDataWriteAheadLogStore":case"busArrivalTimeDataStore":e="分析",r="analytics";break;case"personalScheduleStore":e="個人化行程",r="personalSchedule";break;case"recentViewsStore":e="最近檢視",r="recentViews";break;case"folderListStore":case"folderContentIndexStore":case"folderContentStore":e="資料夾",r="folders";break;case"notificationStore":case"notificationScheduleStore":e="通知",r="notification";break;default:e="其他",r="others"}return{name:e,key:r}}function u(){return f.apply(this,arguments)}function f(){return(f=(0,n.A)(function*(){for(var t=0,e={},r=(0,i.le)(),n=0;n<r;n++){var s,u=0,f=o(yield(0,i.Su)(n));try{for(f.s();!(s=f.n()).done;){var c=s.value,m=yield(0,i.Ct)(n,c),y=String(m).length+c.length;t+=y,u+=y}}catch(t){f.e(t)}finally{f.f()}var d=l(n),v=d.key;e.hasOwnProperty(v)||(e[v]={category:d,size:0}),e[d.key].size+=u}var p=(0,a.tH)(t),g={};for(var h in e){var S=e[h].category,w=e[h].size;g[h]={category:S,size:(0,a.tH)(w)}}return{totalSize:p,categorizedSizes:g}})).apply(this,arguments)}},5767(t,e,r){r.d(e,{Eu:()=>S,MN:()=>O,cy:()=>b,fV:()=>M,wz:()=>x});var n=r(3453),a=r(467),i=r(8024),o=r(5428),s=r(4311);function l(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var f=[],c="",m=!1,y=0,d={data:{},timestamp:0,id:""},v=[],p={};function g(t){var e,r=0,n=0,a=0,i=0,o=0,s=l(t);try{for(s.s();!(e=s.n()).done;){var u=e.value,f=u[0],c=u[1];o+=1,r+=f,a+=c,n+=Math.pow(f,2),i+=Math.pow(c,2)}}catch(t){s.e(t)}finally{s.f()}var m,y=r/o,d=a/o,v=n/o-Math.pow(y,2),p=i/o-Math.pow(d,2),g=Math.sqrt(v),h=Math.sqrt(p),S=0,w=l(t);try{for(w.s();!(m=w.n()).done;){var b=m.value;S+=(b[0]-y)*(b[1]-d)}}catch(t){w.e(t)}finally{w.f()}return{estimate_time:{average:y,stdev:g},timestamp:{average:d,stdev:h},length:o,correlation:(S/=o)/(g*h)}}function h(t,e){var r=t.length+e.length,n=(t.estimate_time.average*t.length+e.estimate_time.average*e.length)/r,a=(t.timestamp.average*t.length+e.timestamp.average*e.length)/r;return{estimate_time:{average:n,stdev:(0,o.VY)(t.estimate_time.average,t.estimate_time.stdev,t.length,e.estimate_time.average,e.estimate_time.stdev,e.length)},timestamp:{average:a,stdev:(0,o.VY)(t.timestamp.average,t.timestamp.stdev,t.length,e.timestamp.average,e.timestamp.stdev,e.length)},length:r,correlation:(0,o.Hi)(t.estimate_time.average,t.timestamp.average,t.estimate_time.stdev,t.timestamp.stdev,t.length,t.correlation,e.estimate_time.average,e.timestamp.average,e.estimate_time.stdev,e.timestamp.stdev,e.length,e.correlation)}}function S(t){return w.apply(this,arguments)}function w(){return(w=(0,a.A)(function*(t){var e=(new Date).getTime(),r=!1;if(!m){m=!0,f=[],c=(0,i.zx)(),d={data:{},timestamp:e,id:c},y=0;for(var n=t.length-1,a=0;a<32;a++){var o=t[Math.floor(Math.random()*n)];f.push(o.StopID)}}var u,S=l(t);try{for(S.s();!(u=S.n()).done;){var w=u.value,b=w.StopID,A=`s_${b}`;f.indexOf(b)>-1&&(d.data.hasOwnProperty(A)||(d.data[A]=[]),d.data[A].push([parseInt(w.EstimateTime),Math.floor((e-d.timestamp)/1e3)]))}}catch(t){S.e(t)}finally{S.f()}if((y+=1)>45&&(r=!0),y%5==0&&(yield(0,s.mL)(4,c,JSON.stringify(d))),r){var O,D=l(f);try{for(D.s();!(O=D.n()).done;){var M=O.value,_=`s_${M}`,I=d.data[_],N={},k=yield(0,s.Ct)(3,_);if(k){var C=JSON.parse(k);N.stats=h(C.stats,g(I)),N.timestamp=C.timestamp,N.id=M}else N.stats=g(I),N.timestamp=e,N.id=M;if(yield(0,s.mL)(3,_,JSON.stringify(N)),p.hasOwnProperty(_)){var x=p[_];v.splice(x,1,N)}else v[_]=v.length,v.push(N);yield(0,s.iQ)(4,c)}}catch(t){D.e(t)}finally{D.f()}m=!1}})).apply(this,arguments)}function b(){return A.apply(this,arguments)}function A(){return(A=(0,a.A)(function*(){var t,e=(new Date).getTime()-252e5,r=l(yield(0,s.Su)(4));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,s.Ct)(4,n);if(a){var i=JSON.parse(a),o=i.timestamp,u=i.id;if(o>e)for(var f in i.data){var c=i.data[f],m={},y=yield(0,s.Ct)(3,f);if(y){var d=JSON.parse(y);m.stats=h(d.stats,g(c)),m.timestamp=d.timestamp,m.id=d.id}else m.stats=g(c),m.timestamp=o,m.id=parseInt(f.split("_")[1]);if(yield(0,s.mL)(3,f,JSON.stringify(m)),p.hasOwnProperty(f)){var S=p[f];v.splice(S,1,m)}else v[f]=v.length,v.push(m)}yield(0,s.iQ)(4,u)}}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}function O(){return D.apply(this,arguments)}function D(){return(D=(0,a.A)(function*(){var t,e=(new Date).getTime()-252e5,r=0,n=l(yield(0,s.Su)(3));try{for(n.s();!(t=n.n()).done;){var a=t.value,i=yield(0,s.Ct)(3,a);if(i){var o=JSON.parse(i);o.timestamp>e&&(v.push(o),p[a]=r,r+=1)}}}catch(t){n.e(t)}finally{n.f()}})).apply(this,arguments)}function M(){return _.apply(this,arguments)}function _(){return(_=(0,a.A)(function*(){var t,e=(new Date).getTime()-252e5,r=l(yield(0,s.Su)(3));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,s.Ct)(3,n);JSON.parse(a).timestamp<=e&&(yield(0,s.iQ)(3,n))}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}var I,N={};if("undefined"!=typeof SharedWorker){var k=new SharedWorker(new URL(r.p+r.u(958),r.b));(I=k.port).start()}else{var C=new Worker(new URL(r.p+r.u(577),r.b));I=C}function x(){return J.apply(this,arguments)}function J(){return(J=(0,a.A)(function*(){var t,e=yield(t=(new Date).getTime()-252e5,v.filter(function(e){return e.timestamp>t})),r=(0,i.zx)();return yield new Promise(function(t,n){N[r]=t,I.onerror=function(t){n(t.message)},I.postMessage([e,r])})})).apply(this,arguments)}I.onmessage=function(t){var e=(0,n.A)(t.data,2),r=e[0],a=e[1];N[a]&&(N[a](r),delete N[a])},I.onerror=function(t){}},6483(t,e,r){r.d(e,{$t:()=>b,Io:()=>N,VZ:()=>S});var n=r(3453),a=r(467),i=r(8024),o=r(5428),s=r(9566),l=r(5352),u=r(4311);function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var m="",y=!1,d=[],v={data:{},timestamp:0,id:""},p=0;function g(t){for(var e=new Uint32Array(1440),r=t.length-1;r>=0;r--){var n=t[r],a=0,i=0;n[0]>=0?(a=n[1]+1e3*n[0],i=1):(a=n[1],i=0);var o=new Date(a);e[60*o.getHours()+o.getMinutes()]+=i}return Array.from(e)}function h(t,e){for(var r=new Uint32Array(1440),n=1439;n>=0;n--)r[n]=t[n]+e[n];return Array.from(r)}function S(t){return w.apply(this,arguments)}function w(){return(w=(0,a.A)(function*(t){var e=new Date,r=e.getTime(),n=e.getDay(),a=!1;if(!y){y=!0,m=(0,i.zx)(),v={id:m,timestamp:r,data:{}},p=0;var c=yield(0,s.$j)(["stop"]);d=c.map(function(t){return t.id})}if((0,l.vQ)(e)){var S,w=f(t);try{for(w.s();!(S=w.n()).done;){var b=S.value,A=b.StopID,O=`s_${A}_${n}`;d.indexOf(A)>-1&&(v.data.hasOwnProperty(O)||(v.data[O]=[]),v.data[O].push([parseInt(b.EstimateTime),r]))}}catch(t){w.e(t)}finally{w.f()}if((p+=1)>32&&(a=!0),(a||p%8==0)&&(yield(0,u.mL)(5,m,JSON.stringify(v))),a){var D,M=f(d);try{for(M.s();!(D=M.n()).done;){var _=D.value,I=`s_${_}_${n}`,N=v.data[I],k={},C=yield(0,u.Ct)(6,I);if(C){var x=JSON.parse(C),J=g(N),T=h(x.stats,J);k.stats=T;var L=(0,o.mn)(T);k.min=L[0],k.max=L[1],k.day=n,k.timestamp=x.timestamp,k.id=_}else{var $=g(N);k.stats=$;var U=(0,o.mn)($);k.min=U[0],k.max=U[1],k.day=n,k.timestamp=r,k.id=_}yield(0,u.mL)(6,I,JSON.stringify(k)),yield(0,u.iQ)(5,m)}}catch(t){M.e(t)}finally{M.f()}y=!1}}})).apply(this,arguments)}function b(){return A.apply(this,arguments)}function A(){return(A=(0,a.A)(function*(){console.log(0);var t=new Date;console.log(1);var e=t.getTime();console.log(2);var r=t.getDay();console.log(3);var n=yield(0,u.Su)(5);console.log(4);var a,i=f(n);try{for(i.s();!(a=i.n()).done;){var s=a.value;console.log(5);var l=yield(0,u.Ct)(5,s);console.log(6);var c=JSON.parse(l);console.log(7);var m=c.id;for(var y in console.log(8),c.data){console.log(9);var d=c[y];console.log(10);var v={};console.log(11);var p=yield(0,u.Ct)(6,y);if(console.log(12),p){console.log(13);var S=JSON.parse(p);console.log(14);var w=g(d);console.log(15),v.stats=h(S.stats,w),console.log(16);var b=(0,o.mn)(w.concat(S.max,S.min));console.log(17),v.min=b[0],v.max=b[1],v.day=S.day,v.timestamp=S.timestamp,v.id=stopID,console.log(18)}else{console.log(19);var A=g(d);console.log(20),v.stats=A,console.log(21);var O=(0,o.mn)(A);console.log(22),v.min=O[0],v.max=O[1],v.day=r,v.timestamp=e,v.id=stopID,console.log(23)}console.log(24),yield(0,u.mL)(6,y,JSON.stringify(v)),console.log(25),yield(0,u.iQ)(5,m),console.log(26)}console.log(27)}}catch(t){i.e(t)}finally{i.f()}console.log(28)})).apply(this,arguments)}function O(){return(O=(0,a.A)(function*(){var t,e=[],r=f(yield(0,u.Su)(6));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,u.Ct)(6,n);if(a){var i=JSON.parse(a);e.push(i)}}}catch(t){r.e(t)}finally{r.f()}return e})).apply(this,arguments)}var D,M={};if("undefined"!=typeof SharedWorker){var _=new SharedWorker(new URL(r.p+r.u(606),r.b));(D=_.port).start()}else{var I=new Worker(new URL(r.p+r.u(225),r.b));D=I}function N(t,e){return k.apply(this,arguments)}function k(){return k=(0,a.A)(function*(t,e){var r=(0,i.zx)(),n=yield(0,l.ty)(),a=yield function(){return O.apply(this,arguments)}();return yield new Promise(function(i,o){M[r]=i,D.onerror=function(t){o(t.message)},D.postMessage([n,a,t,e,r])})}),k.apply(this,arguments)}D.onmessage=function(t){var e=(0,n.A)(t.data,2),r=e[0],a=e[1];M[a]&&(M[a](r),delete M[a])},D.onerror=function(t){}},8925(t,e,r){r.d(e,{Ir:()=>c,LN:()=>y,N$:()=>l});var n=r(467),a=r(5579),i=r(4311);function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){l=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){return u.apply(this,arguments)}function u(){return(u=(0,n.A)(function*(t,e){var r=`d_${(0,a.$T)(e,"YYYY_MM_DD")}`,n=60*e.getHours()+e.getMinutes(),o=yield(0,i.Ct)(2,r);if(o){var s=JSON.parse(o);s.stats.sum+=t,s.data[n]+=t;var l=s.data[n];l>s.stats.max&&(s.stats.max=l),l<s.stats.min&&(s.stats.min=l),yield(0,i.mL)(2,r,JSON.stringify(s))}else{var u={},f=new Uint32Array(1440);f[n]+=t,u.data=Array.from(f),u.stats={sum:t,max:t,min:0},u.date=[e.getFullYear(),e.getMonth()+1,e.getDate()],yield(0,i.mL)(2,r,JSON.stringify(u))}})).apply(this,arguments)}function f(){return(f=(0,n.A)(function*(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);for(var e=(0,a.S1)(t,-7,0,0),r=[],n=1;n<=7;n++){var o=(0,a.S1)(e,n,0,0),s=`d_${(0,a.$T)(o,"YYYY_MM_DD")}`,l=yield(0,i.Ct)(2,s);if(l){var u=JSON.parse(l);r.push(u)}else{var f={},c=new Uint32Array(1440);f.data=Array.from(c),f.stats={sum:0,max:0,min:0},f.date=[o.getFullYear(),o.getMonth()+1,o.getDate()],r.push(f)}}return r})).apply(this,arguments)}function c(){return m.apply(this,arguments)}function m(){return(m=(0,n.A)(function*(){var t,e=(new Date).getTime(),r=o(yield(0,i.Su)(2));try{for(r.s();!(t=r.n()).done;){var n=t.value,s=yield(0,i.Ct)(2,n),l=JSON.parse(s);e-(0,a.uP)(l.date[0],l.date[1],l.date[2]).getTime()>6048e5&&(yield(0,i.iQ)(2,n))}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}function y(t,e,r){return d.apply(this,arguments)}function d(){return d=(0,n.A)(function*(t,e,n){var a=new Worker(new URL(r.p+r.u(106),r.b)),i=yield function(){return f.apply(this,arguments)}();return yield new Promise(function(r,o){a.onmessage=function(t){r(t.data),a.terminate()},a.onerror=function(t){o(t.message),a.terminate()},a.postMessage([i,t,e,n])})}),d.apply(this,arguments)}}}]);
//# sourceMappingURL=8d1d3c277019f8fc5584.js.map