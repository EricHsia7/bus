"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[428],{540(e,t,a){a.d(t,{a:()=>R,b:()=>j});var n=a(467),i=a(5767),s=a(9566),r=a(3459),o=a(8179),d=a(8024),c=a(4537),l=a(904),u=a(3030),p=a(9119),f=a(4690),b=(0,o.c)(".s"),h=(0,o.e)(b,".y"),v=(0,o.e)(b,".ia"),m=(0,o.e)(v,".cb"),y=(0,o.e)(h,".da .fa"),g={},L=!1,k=!1,A=15e3,w=5e3,C=15e3,x=!0,T=0,_=0,P="",E=!1,I=!1,S=!1;function $(){var e=(0,o.a)();e.classList.add("jb"),e.setAttribute("type","stop");var t=(0,o.a)();t.classList.add("kb"),t.appendChild((0,c.b)("location_on"));var a=(0,o.a)();a.classList.add("lb");var n=(0,o.a)();n.classList.add("nb");var i=(0,o.a)();i.classList.add("ob");var s=(0,o.a)();s.classList.add("sb");var r=(0,o.a)();r.classList.add("tb"),r.setAttribute("code","0"),r.setAttribute("displayed","false");var d=(0,o.a)();d.classList.add("ub"),d.setAttribute("code","0"),d.setAttribute("displayed","true"),s.appendChild(r),s.appendChild(d);var l=(0,o.a)();l.classList.add("pb"),l.appendChild((0,c.b)("keyboard_arrow_right"));var u=(0,o.a)();return u.classList.add("qb"),i.appendChild(s),i.appendChild(l),i.appendChild(u),e.appendChild(t),e.appendChild(a),e.appendChild(n),e.appendChild(i),e}function D(){var e=(0,o.a)();e.classList.add("db");var t=(0,o.a)();t.classList.add("fb");var a=(0,o.a)();a.classList.add("gb"),a.appendChild((0,c.a)());var n=(0,o.a)();n.classList.add("hb"),t.appendChild(a),t.appendChild(n);var i=(0,o.a)();return i.classList.add("ib"),e.appendChild(t),e.appendChild(i),e}function M(e){var t=e;if(E){var a=t.detail.progress-1;y.style.setProperty("--w",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,M)}function j(){for(var e=(0,r.b)("playing_animation"),t=(0,l.d)("window"),a=(t.width,t.height),n=Math.floor(a/50/3)+2,i=[],s=0;s<3;s++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:n},d=0;d<n;d++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}U({folders:i,dataUpdateTime:0},!0,e)}function U(e,t,a){function n(e,n,i){function s(e,t){e.setAttribute("type",t.type)}function r(e,t){var a=(0,o.e)(e,".kb"),n="";switch(t.type){case"stop":case"location":n="location_on";break;case"route":n="route";break;case"bus":n="directions_bus";break;case"empty":n="lightbulb";break;default:n=""}(0,c.c)(a,n)}function l(e,t,a){if("stop"===t.type){var n=e.getBoundingClientRect(),i=n.top,s=n.left,r=n.bottom,d=n.right,c=window.innerWidth,l=window.innerHeight,u=(0,o.e)(e,".ob .sb"),p=(0,o.e)(u,".tb"),f=(0,o.e)(u,".ub");p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,a&&r>0&&i<l&&d>0&&s<c?(f.addEventListener("animationend",function(){f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,f.classList.remove("wb"),p.setAttribute("displayed","false")},{once:!0}),p.setAttribute("displayed","true"),f.classList.add("wb")):(f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text)}}function p(e,t){var a="";switch(t.type){case"stop":case"route":case"location":a=t.name;break;case"bus":a=t.busID;break;case"empty":a="沒有內容";break;default:a="null"}(0,o.e)(e,".nb").innerText=a}function b(e,t){var a="";switch(t.type){case"stop":a=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":a=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":a="地點";break;case"bus":break;case"empty":a="提示";break;default:a="null"}(0,o.e)(e,".lb").innerText=a}function h(e,t){var a=(0,o.e)(e,".ob .pb");switch(t.type){case"stop":a.onclick=function(){(0,f.d)(t.route.id,t.route.pathAttributeId)};break;case"route":a.onclick=function(){(0,f.d)(t.id,t.pathAttributeId)};break;case"location":a.onclick=function(){(0,u.d)(t.id)}}}function v(e,t){e.setAttribute("animation",(0,d.a)(t))}function m(e,t){e.setAttribute("skeleton-screen",(0,d.a)(t))}if(null==i)s(e,n),r(e,n),l(e,n,a),p(e,n),b(e,n),h(e,n),v(e,a),m(e,t);else if(n.type!==i.type)s(e,n),r(e,n),l(e,n,a),p(e,n),b(e,n),h(e,n),v(e,a),m(e,t);else{switch(n.type){case"stop":(0,d.b)(i.route,n.route)||(b(e,n),h(e,n)),i.name!==n.name&&p(e,n),i.status.time!==n.status.time&&l(e,n,a);break;case"route":i.id!==n.id&&h(e,n),(0,d.b)(i.endPoints,n.endPoints)||b(e,n),i.name!==n.name&&p(e,n);break;case"location":i.id!==n.id&&h(e,n),i.name!==n.name&&p(e,n);break;case"bus":default:break;case"empty":n.type!==i.type&&(b(e,n),p(e,n))}t!==k&&m(e,t),a!==L&&v(e,a)}}function i(e,n,i){function s(e,t){var a=(0,o.e)(e,".fb");(0,o.e)(a,".hb").innerText=t.name}function r(e,t){var a=(0,o.e)(e,".fb"),n=(0,o.e)(a,".gb");(0,c.c)(n,t.icon)}function l(e,t){e.setAttribute("animation",(0,d.a)(t))}function u(e,t){e.setAttribute("skeleton-screen",(0,d.a)(t))}null==i?(s(e,n),r(e,n),l(e,a),u(e,t)):(n.name!==i.name&&s(e,n),n.icon!==i.icon&&r(e,n),a!==L&&l(e,a),t!==k&&u(e,t))}var s=e.folders,r=s.length,l=Array.from((0,o.d)(m,".db")),p=l.length;if(r!==p){var b=p-r;if(b<0){for(var h=new DocumentFragment,v=0;v>b;v--){var y=D();h.appendChild(y),l.push(y)}m.append(h)}else if(b>0)for(var A=p-1,w=p-b-1;A>w;A--)l[A].remove(),l.splice(A,1)}for(var C=0;C<r;C++){var x=s[C],T=x.content,_=T.length,P=l[C],E=(0,o.e)(P,".ib"),I=Array.from((0,o.d)(E,".jb")),S=I.length;if(_!==S){var M=S-_;if(M<0)for(var j=0;j>M;j--){var U=$();E.appendChild(U),I.push(U)}else if(M>0)for(var q=S-1,B=S-M-1;q>B;q--)I[q].remove(),I.splice(q,1)}if((0,d.e)(g,"folders"))if(g.folders[C])i(P,x,g.folders[C]);else i(P,x,null);else i(P,x,null);for(var F=0;F<_;F++){var H=I[F],R=T[F];if((0,d.e)(g,"folders"))if(g.folders[C])if(g.folders[C].content[F])n(H,R,g.folders[C].content[F]);else n(H,R,null);else n(H,R,null);else n(H,R,null)}}g=e,L=a,k=t}function q(){return B.apply(this,arguments)}function B(){return(B=(0,n.a)(function*(){var e=(0,r.b)("playing_animation"),t=(0,r.b)("refresh_interval");x=t.dynamic,A=t.baseInterval,E=!0,P=(0,d.c)(),y.setAttribute("refreshing","true"),y.classList.remove("ha"),document.addEventListener(P,M);var a=yield(0,s.d)(P);U(a,!1,e);var n=0;x&&(n=yield(0,i.c)()),T=(new Date).getTime(),_=x?Math.max(T+w,a.dataUpdateTime+A/n):T+A,C=Math.max(w,_-T),E=!1,y.setAttribute("refreshing","false"),y.style.setProperty("--x",`${C}ms`),y.classList.add("ha")})).apply(this,arguments)}function F(){return H.apply(this,arguments)}function H(){return(H=(0,n.a)(function*(){q().then(function(){I?setTimeout(function(){F()},Math.max(w,_-(new Date).getTime())):S=!1}).catch(function(e){I?((0,p.a)("error","資料夾網路連線中斷，將在10秒後重試。"),setTimeout(function(){F()},1e4)):S=!1})})).apply(this,arguments)}function R(){I||(I=!0,S?q():(S=!0,F()))}},2547(){},6082(e,t,a){a.d(t,{a:()=>u,b:()=>m,c:()=>L,d:()=>g});var n=a(467),i=a(9734),s=a(8011),r=a(9218),o=a(4293),d=a(6788),c=a(8179),l="downloadData",u=!1,p=(0,c.c)(".s"),f=(0,c.e)(p,".y"),b=(0,c.e)(f,".ca"),h=(0,c.e)(b,'svg#download-svg path[progress="progress"]');function v(e){var t=e,a=189*(1-(0,d.d)(l));h.style.setProperty("--u",`${a}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,v),h.addEventListener("transitionend",function(){b.setAttribute("complete","true")},{once:!0}),h.style.setProperty("--u","0px"),u=!0)}function m(){return y.apply(this,arguments)}function y(){return(y=(0,n.a)(function*(){(0,d.f)(l,"getLocation_0",0,!1),(0,d.f)(l,"getLocation_1",0,!1),(0,d.f)(l,"getCarInfo_0",0,!1),(0,d.f)(l,"getCarInfo_1",0,!1),(0,d.f)(l,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(l,v),yield(0,o.a)(l,!0),yield(0,s.a)(l,1),yield(0,i.a)(l,!0),yield(0,r.a)(l),(0,d.a)(l),(0,d.b)(l)})).apply(this,arguments)}function g(e){var t="ltr"===e?"jg":"gg";p.addEventListener("animationend",function(){p.classList.remove(t)},{once:!0}),p.classList.add(t),p.setAttribute("displayed","true")}function L(e){var t="ltr"===e?"lg":"ig";p.addEventListener("animationend",function(){p.setAttribute("displayed","false"),p.classList.remove(t)},{once:!0}),p.classList.add(t)}},6110(){},6971(){},8933(){},9080(){}}]);
//# sourceMappingURL=ccb413b35c71cc609ec4.js.map