"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[8139],{540(e,t,a){a.d(t,{F:()=>$,a:()=>Q});var n=a(467),i=a(5767),r=a(9566),s=a(3459),o=a(8024),d=a(8179),c=a(4537),l=a(904),u=a(3030),p=a(9119),h=a(4690),m=(0,d.bv)(".ag"),f=(0,d.aI)(m,".fg"),v=(0,d.aI)(m,".og"),g=(0,d.aI)(v,".ah"),b=(0,d.aI)(f,".kg .lg"),y={},k=!1,w=!1,I=15e3,C=5e3,L=15e3,x=!0,A=0,E=0,M="",T=!1,_=!1,P=!1;function j(){var e=document.createElement("div");e.classList.add("gh"),e.setAttribute("type","stop");var t=document.createElement("div");t.classList.add("hh"),t.appendChild((0,c.YC)("location_on"));var a=document.createElement("div");a.classList.add("ih");var n=document.createElement("div");n.classList.add("jh");var i=document.createElement("div");i.classList.add("kh");var r=document.createElement("div");r.classList.add("nh");var s=document.createElement("div");s.classList.add("qa"),s.setAttribute("code","0"),s.setAttribute("displayed","false");var o=document.createElement("div");o.classList.add("ra"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),r.appendChild(s),r.appendChild(o);var d=document.createElement("div");d.classList.add("lh"),d.appendChild((0,c.YC)("keyboard_arrow_right"));var l=document.createElement("div");return l.classList.add("mh"),i.appendChild(r),i.appendChild(d),i.appendChild(l),e.appendChild(t),e.appendChild(a),e.appendChild(n),e.appendChild(i),{element:e,id:""}}function D(){var e=document.createElement("div");e.classList.add("bh");var t=document.createElement("div");t.classList.add("ch");var a=document.createElement("div");a.classList.add("dh"),a.appendChild((0,c.oC)());var n=document.createElement("div");n.classList.add("eh"),t.appendChild(a),t.appendChild(n);var i=document.createElement("div");return i.classList.add("fh"),e.appendChild(t),e.appendChild(i),{element:e,id:""}}function S(e){var t=e;if(T){var a=t.detail.progress-1;b.style.setProperty("--dg",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,S)}function $(){for(var e=(0,s.Js)("playing_animation"),t=(0,l.gO)("window"),a=(t.width,t.height),n=Math.floor(a/50/3)+2,i=[],r=0;r<3;r++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:n},d=0;d<n;d++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}z({folders:i,dataUpdateTime:0},!0,e)}function z(e,t,a){function n(e,n,i){function r(e,t){e.setAttribute("type",t.type)}function s(e,t){var a=(0,d.aI)(e,".hh"),n="";switch(t.type){case"stop":case"location":n="location_on";break;case"route":n="route";break;case"bus":n="directions_bus";break;case"empty":n="lightbulb";break;default:n=""}(0,c.yD)(a,n)}function l(e,t,a){if("stop"===t.type){var n=e.getBoundingClientRect(),i=n.top,r=n.left,s=n.bottom,o=n.right,c=window.innerWidth,l=window.innerHeight,u=(0,d.aI)(e,".kh .nh"),p=(0,d.aI)(u,".qa"),h=(0,d.aI)(u,".ra");p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,a&&s>0&&i<l&&o>0&&r<c?(h.addEventListener("animationend",function(){h.setAttribute("code",t.status.code.toString()),h.innerText=t.status.text,h.classList.remove("hb"),p.setAttribute("displayed","false")},{once:!0}),p.setAttribute("displayed","true"),h.classList.add("hb")):(h.setAttribute("code",t.status.code.toString()),h.innerText=t.status.text)}}function p(e,t){var a="";switch(t.type){case"stop":case"route":case"location":a=t.name;break;case"bus":a=t.busID;break;case"empty":a="沒有內容";break;default:a="null"}(0,d.aI)(e,".jh").innerText=a}function m(e,t){var a="";switch(t.type){case"stop":a=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":a=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":a="地點";break;case"bus":break;case"empty":a="提示";break;default:a="null"}(0,d.aI)(e,".ih").innerText=a}function f(e,t){var a=(0,d.aI)(e,".kh .lh");switch(t.type){case"stop":a.onclick=function(){(0,h.SR)(t.route.id,t.route.pathAttributeId)};break;case"route":a.onclick=function(){(0,h.SR)(t.id,t.pathAttributeId)};break;case"location":a.onclick=function(){(0,u.so)(t.id)}}}function v(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function g(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}if(null==i)r(e,n),s(e,n),l(e,n,a),p(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else if(n.type!==i.type)r(e,n),s(e,n),l(e,n,a),p(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else{switch(n.type){case"stop":(0,o.hw)(i.route,n.route)||(m(e,n),f(e,n)),i.name!==n.name&&p(e,n),i.status.time!==n.status.time&&l(e,n,a);break;case"route":i.id!==n.id&&f(e,n),(0,o.hw)(i.endPoints,n.endPoints)||m(e,n),i.name!==n.name&&p(e,n);break;case"location":i.id!==n.id&&f(e,n),i.name!==n.name&&p(e,n);break;case"bus":default:break;case"empty":n.type!==i.type&&(m(e,n),p(e,n))}t!==w&&g(e,t),a!==k&&v(e,a)}}function i(e,n,i){function r(e,t){var a=(0,d.aI)(e,".ch");(0,d.aI)(a,".eh").innerText=t.name}function s(e,t){var a=(0,d.aI)(e,".ch"),n=(0,d.aI)(a,".dh");(0,c.yD)(n,t.icon)}function l(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function u(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}null==i?(r(e,n),s(e,n),l(e,a),u(e,t)):(n.name!==i.name&&r(e,n),n.icon!==i.icon&&s(e,n),a!==k&&l(e,a),t!==w&&u(e,t))}var r=e.folders,s=r.length,l=(0,d.jg)(g,".bh").length;if(s!==l){var p=l-s;if(p<0){for(var m=new DocumentFragment,f=0,v=Math.abs(p);f<v;f++){var b=D();m.appendChild(b.element)}g.append(m)}else for(var I=(0,d.jg)(g,".bh"),C=0,L=Math.abs(p);C<L;C++){I[l-1-C].remove()}}for(var x=(0,d.jg)(g,".bh"),A=0;A<s;A++){var E=r[A].content.length,M=x[A],T=(0,d.aI)(M,".fh"),_=(0,d.jg)(T,".gh").length;if(E!==_){var P=_-E;if(P<0)for(var S=0,$=Math.abs(P);S<$;S++){var z=j();T.appendChild(z.element)}else for(var J=(0,d.jg)(T,".gh"),Z=0,O=Math.abs(P);Z<O;Z++){J[_-1-Z].remove()}}}for(var R=(0,d.jg)(g,".bh"),Q=0;Q<s;Q++){var U=r[Q],F=U.content,q=F.length,Y=R[Q],B=(0,d.aI)(Y,".fh");if(y.hasOwnProperty("folders"))if(y.folders[Q])i(Y,U,y.folders[Q]);else i(Y,U,null);else i(Y,U,null);for(var H=(0,d.jg)(B,".gh"),W=0;W<q;W++){var X=H[W],G=F[W];if(y.hasOwnProperty("folders"))if(y.folders[Q])if(y.folders[Q].content[W])n(X,G,y.folders[Q].content[W]);else n(X,G,null);else n(X,G,null);else n(X,G,null)}}y=e,k=a,w=t}function J(){return Z.apply(this,arguments)}function Z(){return(Z=(0,n.A)(function*(){var e=(0,s.Js)("playing_animation"),t=(0,s.Js)("refresh_interval");x=t.dynamic,I=t.baseInterval,T=!0,M=(0,o.zx)(),b.setAttribute("refreshing","true"),b.classList.remove("ng"),document.addEventListener(M,S);var a=yield(0,r.R_)(M);z(a,!1,e);var n=0;x&&(n=yield(0,i.wz)()),A=(new Date).getTime(),E=x?Math.max(A+C,a.dataUpdateTime+I/n):A+I,L=Math.max(C,E-A),T=!1,b.setAttribute("refreshing","false"),b.style.setProperty("--eg",`${L}ms`),b.classList.add("ng")})).apply(this,arguments)}function O(){return R.apply(this,arguments)}function R(){return(R=(0,n.A)(function*(){J().then(function(){_?setTimeout(function(){O()},Math.max(C,E-(new Date).getTime())):P=!1}).catch(function(e){_?((0,p.a)("error","資料夾網路連線中斷，將在10秒後重試。"),setTimeout(function(){O()},1e4)):P=!1})})).apply(this,arguments)}function Q(){$(),_||(_=!0,P?J():(P=!0,O()))}},6082(e,t,a){a.d(t,{X:()=>g,m:()=>u});var n=a(467),i=a(9734),r=a(8011),s=a(9218),o=a(4293),d=a(6788),c=a(8179),l="downloadData",u=!1,p=(0,c.bv)(".ag"),h=(0,c.aI)(p,".fg"),m=(0,c.aI)(h,".ig"),f=(0,c.aI)(m,'svg#download-svg path[progress="progress"]');function v(e){var t=e,a=189*(1-(0,d._M)(l));f.style.setProperty("--bg",`${a}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,v),f.addEventListener("transitionend",function(){m.setAttribute("complete","true")},{once:!0}),f.style.setProperty("--bg","0px"),u=!0)}function g(){return b.apply(this,arguments)}function b(){return(b=(0,n.A)(function*(){(0,d.Mf)(l,"getLocation_0",0,!1),(0,d.Mf)(l,"getLocation_1",0,!1),(0,d.Mf)(l,"getCarInfo_0",0,!1),(0,d.Mf)(l,"getCarInfo_1",0,!1),(0,d.Mf)(l,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(l,v),yield(0,o.a)(l,!0),yield(0,r.g)(l,1),yield(0,i.j)(l,!0),yield(0,s.l)(l),(0,d.LQ)(l),(0,d.gC)(l)})).apply(this,arguments)}},6091(e,t,a){a.d(t,{Q:()=>P,u:()=>z});var n=a(467),i=a(5767),r=a(5314),s=a(3459),o=a(8024),d=a(8179),c=a(4884),l=a(4537),u=a(904),p=a(3030),h=a(4690),m=(0,d.bv)(".ag"),f=(0,d.aI)(m,".og"),v=(0,d.aI)(f,".pg"),g=(0,d.aI)(v,".ug"),b={},y=!1,k=!1,w=15e3,I=5e3,C=!0,L=!1,x=0,A=0,E="",M=!1;function T(){var e=document.createElement("div");e.classList.add("vg");var t=document.createElement("div");t.classList.add("wg");var a=document.createElement("div");a.classList.add("xg"),a.appendChild((0,l.oC)());var n=document.createElement("div");n.classList.add("yg");var i=document.createElement("div");i.classList.add("zg"),t.appendChild(a),t.appendChild(n),t.appendChild(i);var r=document.createElement("div");return r.classList.add("_g"),e.appendChild(t),e.appendChild(r),{element:e,id:""}}function _(e,t,a){function n(e,n,i){function r(e,t){var a=(0,d.aI)(e,".wg"),n=(0,d.aI)(a,".xg"),i="";switch(t.type){case"route":i="route";break;case"location":i="location_on";break;case"bus":i="directions_bus";break;case"empty":i="lightbulb"}(0,l.yD)(n,i)}function s(e,t){var a=(0,d.aI)(e,".wg .yg"),n="";switch(t.type){case"route":n="路線";break;case"location":n="地點";break;case"bus":n="公車";break;case"empty":n="提示"}a.innerText=n}function u(e,t){(0,d.aI)(e,".wg .zg").innerText=t.time.relative}function m(e,t){(0,d.aI)(e,"._g").innerText=t.name}function f(e,t){switch(t.type){case"route":e.onclick=function(){(0,h.SR)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,p.so)(t.hash)};break;case"bus":e.onclick=function(){(0,c.$l)(t.id)};break;case"empty":e.onclick=null}}function v(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function g(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}if(null==i)r(e,n),s(e,n),u(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else if(n.type!==i.type)r(e,n),s(e,n),u(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else{switch(n.type){case"location":(0,o.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&u(e,n),(0,o.hw)(i.hash,n.hash)||f(e,n);break;case"route":(0,o.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&u(e,n),(0,o.hw)(i.id,n.id)&&(0,o.hw)(i.pid,n.pid)||f(e,n);break;case"bus":(0,o.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&u(e,n),(0,o.hw)(i.id,n.id)||f(e,n);break;case"empty":i.time!==n.time&&u(e,n)}a!==y&&v(e,a),t!==k&&g(e,t)}}var i=e.itemQuantity,r=(0,d.jg)(g,".vg").length;if(i!==r){var s=r-i;if(s<0){for(var u=new DocumentFragment,m=0,f=Math.abs(s);m<f;m++){var v=T();u.appendChild(v.element)}g.append(u)}else for(var w=(0,d.jg)(g,".vg"),I=0,C=Math.abs(s);I<C;I++){w[r-1-I].remove()}}for(var L=(0,d.jg)(g,".vg"),x=0;x<i;x++){var A=L[x],E=e.items[x];if(b.hasOwnProperty("items"))if(b.items[x])n(A,E,b.items[x]);else n(A,E,null);else n(A,E,null)}b=e,y=a,k=t}function P(){for(var e=(0,s.Js)("playing_animation"),t=(0,u.gO)("window"),a=Math.floor(t.height/70/3)+2,n=[],i=0;i<a;i++)n.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_({items:n,itemQuantity:n.length,dataUpdateTime:0},!0,e)}function j(){return D.apply(this,arguments)}function D(){return(D=(0,n.A)(function*(){var e=(0,s.Js)("playing_animation"),t=(0,s.Js)("refresh_interval");C=t.dynamic,w=t.baseInterval,E=(0,o.zx)();var a=yield(0,r.$i)(E);_(a,!1,e);var n=0;C&&(n=yield(0,i.wz)()),x=(new Date).getTime(),A=C?Math.max(x+I,a.dataUpdateTime+w/n):x+w,Math.max(I,A-x)})).apply(this,arguments)}function S(){return $.apply(this,arguments)}function $(){return($=(0,n.A)(function*(){j().then(function(){L?setTimeout(function(){S()},Math.max(I,A-(new Date).getTime())):M=!1}).catch(function(e){L?setTimeout(function(){S()},1e4):M=!1})})).apply(this,arguments)}function z(){P(),L||(L=!0,M?j():(M=!0,S()))}}}]);
//# sourceMappingURL=bd895b391264f22b09f5.js.map