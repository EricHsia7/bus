"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[8139],{540(e,t,n){n.d(t,{F:()=>z,a:()=>Q});var a=n(5767),i=n(9566),r=n(3459),s=n(8024),o=n(8179),d=n(4537),c=n(904),u=n(3030),l=n(9119),p=n(4690);function f(e,t,n,a,i,r,s){try{var o=e[r](s),d=o.value}catch(e){return void n(e)}o.done?t(d):Promise.resolve(d).then(a,i)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(a,i){var r=e.apply(t,n);function s(e){f(r,a,i,s,o,"next",e)}function o(e){f(r,a,i,s,o,"throw",e)}s(void 0)})}}var v=(0,o.bv)(".kf"),h=(0,o.aI)(v,".pf"),g=(0,o.aI)(v,".yf"),b=(0,o.aI)(g,".kg"),y=(0,o.aI)(h,".uf .vf"),w={},k=!1,x=!1,I=15e3,C=5e3,L=15e3,E=!0,A=0,M=0,T="",P=!1,_=!1,j=!1;function D(){var e=document.createElement("div");e.classList.add("qg"),e.setAttribute("type","stop");var t=document.createElement("div");t.classList.add("rg"),t.appendChild((0,d.YC)("location_on"));var n=document.createElement("div");n.classList.add("sg");var a=document.createElement("div");a.classList.add("tg");var i=document.createElement("div");i.classList.add("ug");var r=document.createElement("div");r.classList.add("xg");var s=document.createElement("div");s.classList.add("yg"),s.setAttribute("code","0"),s.setAttribute("displayed","false");var o=document.createElement("div");o.classList.add("zg"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),r.appendChild(s),r.appendChild(o);var c=document.createElement("div");c.classList.add("vg"),c.appendChild((0,d.YC)("keyboard_arrow_right"));var u=document.createElement("div");return u.classList.add("wg"),i.appendChild(r),i.appendChild(c),i.appendChild(u),e.appendChild(t),e.appendChild(n),e.appendChild(a),e.appendChild(i),{element:e,id:""}}function S(){var e=document.createElement("div");e.classList.add("lg");var t=document.createElement("div");t.classList.add("mg");var n=document.createElement("div");n.classList.add("ng"),n.appendChild((0,d.oC)());var a=document.createElement("div");a.classList.add("og"),t.appendChild(n),t.appendChild(a);var i=document.createElement("div");return i.classList.add("pg"),e.appendChild(t),e.appendChild(i),{element:e,id:""}}function $(e){var t=e;if(P){var n=t.detail.progress-1;y.style.setProperty("--nf",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,$)}function z(){for(var e=(0,r.Js)("playing_animation"),t=(0,c.gO)("window"),n=(t.width,t.height),a=Math.floor(n/50/3)+2,i=[],s=0;s<3;s++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:a},d=0;d<a;d++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}J({folders:i,dataUpdateTime:0},!0,e)}function J(e,t,n){function a(e,a,i){function r(e,t){e.setAttribute("type",t.type)}function c(e,t){var n=(0,o.aI)(e,".rg"),a="";switch(t.type){case"stop":case"location":a="location_on";break;case"route":a="route";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb";break;default:a=""}(0,d.yD)(n,a)}function l(e,t,n){if("stop"===t.type){var a=e.getBoundingClientRect(),i=a.top,r=a.left,s=a.bottom,d=a.right,c=window.innerWidth,u=window.innerHeight,l=(0,o.aI)(e,".ug .xg"),p=(0,o.aI)(l,".yg"),f=(0,o.aI)(l,".zg");p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,n&&s>0&&i<u&&d>0&&r<c?(f.addEventListener("animationend",function(){f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,f.classList.remove("ah"),p.setAttribute("displayed","false")},{once:!0}),p.setAttribute("displayed","true"),f.classList.add("ah")):(f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text)}}function f(e,t){var n="";switch(t.type){case"stop":case"route":case"location":n=t.name;break;case"bus":n=t.busID;break;case"empty":n="沒有內容";break;default:n="null"}(0,o.aI)(e,".tg").innerText=n}function m(e,t){var n="";switch(t.type){case"stop":n=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":n=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":n="地點";break;case"bus":break;case"empty":n="提示";break;default:n="null"}(0,o.aI)(e,".sg").innerText=n}function v(e,t){var n=(0,o.aI)(e,".ug .vg");switch(t.type){case"stop":n.onclick=function(){(0,p.SR)(t.route.id,t.route.pathAttributeId)};break;case"route":n.onclick=function(){(0,p.SR)(t.id,t.pathAttributeId)};break;case"location":n.onclick=function(){(0,u.so)(t.id)}}}function h(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function g(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null==i)r(e,a),c(e,a),l(e,a,n),f(e,a),m(e,a),v(e,a),h(e,n),g(e,t);else if(a.type!==i.type)r(e,a),c(e,a),l(e,a,n),f(e,a),m(e,a),v(e,a),h(e,n),g(e,t);else{switch(a.type){case"stop":(0,s.hw)(i.route,a.route)||(m(e,a),v(e,a)),i.name!==a.name&&f(e,a),i.status.time!==a.status.time&&l(e,a,n);break;case"route":i.id!==a.id&&v(e,a),(0,s.hw)(i.endPoints,a.endPoints)||m(e,a),i.name!==a.name&&f(e,a);break;case"location":i.id!==a.id&&v(e,a),i.name!==a.name&&f(e,a);break;case"bus":default:break;case"empty":a.type!==i.type&&(m(e,a),f(e,a))}t!==x&&g(e,t),n!==k&&h(e,n)}}function i(e,a,i){function r(e,t){var n=(0,o.aI)(e,".mg");(0,o.aI)(n,".og").innerText=t.name}function c(e,t){var n=(0,o.aI)(e,".mg"),a=(0,o.aI)(n,".ng");(0,d.yD)(a,t.icon)}function u(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}null==i?(r(e,a),c(e,a),u(e,n),l(e,t)):(a.name!==i.name&&r(e,a),a.icon!==i.icon&&c(e,a),n!==k&&u(e,n),t!==x&&l(e,t))}var r=e.folders,c=r.length,l=(0,o.jg)(b,".lg").length;if(c!==l){var f=l-c;if(f<0){for(var m=new DocumentFragment,v=0,h=Math.abs(f);v<h;v++){var g=S();m.appendChild(g.element)}b.append(m)}else for(var y=(0,o.jg)(b,".lg"),I=0,C=Math.abs(f);I<C;I++){y[l-1-I].remove()}}for(var L=(0,o.jg)(b,".lg"),E=0;E<c;E++){var A=r[E].content.length,M=L[E],T=(0,o.aI)(M,".pg"),P=(0,o.jg)(T,".qg").length;if(A!==P){var _=P-A;if(_<0)for(var j=0,$=Math.abs(_);j<$;j++){var z=D();T.appendChild(z.element)}else for(var J=(0,o.jg)(T,".qg"),Z=0,O=Math.abs(_);Z<O;Z++){J[P-1-Z].remove()}}}for(var R=(0,o.jg)(b,".lg"),q=0;q<c;q++){var Q=r[q],U=Q.content,F=U.length,Y=R[q],B=(0,o.aI)(Y,".pg");if(w.hasOwnProperty("folders"))if(w.folders[q])i(Y,Q,w.folders[q]);else i(Y,Q,null);else i(Y,Q,null);for(var H=(0,o.jg)(B,".qg"),W=0;W<F;W++){var X=H[W],G=U[W];if(w.hasOwnProperty("folders"))if(w.folders[q])if(w.folders[q].content[W])a(X,G,w.folders[q].content[W]);else a(X,G,null);else a(X,G,null);else a(X,G,null)}}w=e,k=n,x=t}function Z(){return O.apply(this,arguments)}function O(){return(O=m(function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");E=t.dynamic,I=t.baseInterval,P=!0,T=(0,s.zx)(),y.setAttribute("refreshing","true"),y.classList.remove("xf"),document.addEventListener(T,$);var n=yield(0,i.R_)(T);J(n,!1,e);var o=0;E&&(o=yield(0,a.wz)()),A=(new Date).getTime(),M=E?Math.max(A+C,n.dataUpdateTime+I/o):A+I,L=Math.max(C,M-A),P=!1,y.setAttribute("refreshing","false"),y.style.setProperty("--of",`${L}ms`),y.classList.add("xf")})).apply(this,arguments)}function R(){return q.apply(this,arguments)}function q(){return(q=m(function*(){Z().then(function(){_?setTimeout(function(){R()},Math.max(C,M-(new Date).getTime())):j=!1}).catch(function(e){_?((0,l.a)("error","資料夾網路連線中斷，將在10秒後重試。"),setTimeout(function(){R()},1e4)):j=!1})})).apply(this,arguments)}function Q(){z(),_||(_=!0,j?Z():(j=!0,R()))}},6082(e,t,n){n.d(t,{X:()=>g,m:()=>l});var a=n(9734),i=n(8011),r=n(9218),s=n(4293),o=n(6788),d=n(8179);function c(e,t,n,a,i,r,s){try{var o=e[r](s),d=o.value}catch(e){return void n(e)}o.done?t(d):Promise.resolve(d).then(a,i)}var u="downloadData",l=!1,p=(0,d.bv)(".kf"),f=(0,d.aI)(p,".pf"),m=(0,d.aI)(f,".sf"),v=(0,d.aI)(m,'svg#download-svg path[progress="progress"]');function h(e){var t=e,n=189*(1-(0,o._M)(u));v.style.setProperty("--lf",`${n}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,h),v.addEventListener("transitionend",function(){m.setAttribute("complete","true")},{once:!0}),v.style.setProperty("--lf","0px"),l=!0)}function g(){return b.apply(this,arguments)}function b(){var e;return e=function*(){(0,o.Mf)(u,"getLocation_0",0,!1),(0,o.Mf)(u,"getLocation_1",0,!1),(0,o.Mf)(u,"getCarInfo_0",0,!1),(0,o.Mf)(u,"getCarInfo_1",0,!1),(0,o.Mf)(u,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(u,h),yield(0,s.a)(u,!0),yield(0,i.g)(u,1),yield(0,a.j)(u,!0),yield(0,r.l)(u),(0,o.LQ)(u),(0,o.gC)(u)},b=function(){var t=this,n=arguments;return new Promise(function(a,i){var r=e.apply(t,n);function s(e){c(r,a,i,s,o,"next",e)}function o(e){c(r,a,i,s,o,"throw",e)}s(void 0)})},b.apply(this,arguments)}},6091(e,t,n){n.d(t,{Q:()=>j,u:()=>J});var a=n(5767),i=n(5314),r=n(3459),s=n(8024),o=n(8179),d=n(4884),c=n(4537),u=n(904),l=n(3030),p=n(4690);function f(e,t,n,a,i,r,s){try{var o=e[r](s),d=o.value}catch(e){return void n(e)}o.done?t(d):Promise.resolve(d).then(a,i)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(a,i){var r=e.apply(t,n);function s(e){f(r,a,i,s,o,"next",e)}function o(e){f(r,a,i,s,o,"throw",e)}s(void 0)})}}var v=(0,o.bv)(".kf"),h=(0,o.aI)(v,".yf"),g=(0,o.aI)(h,".zf"),b=(0,o.aI)(g,".dg"),y={},w=!1,k=!1,x=15e3,I=5e3,C=!0,L=!1,E=0,A=0,M="",T=!1;function P(){var e=document.createElement("div");e.classList.add("eg");var t=document.createElement("div");t.classList.add("fg");var n=document.createElement("div");n.classList.add("gg"),n.appendChild((0,c.oC)());var a=document.createElement("div");a.classList.add("hg");var i=document.createElement("div");i.classList.add("ig"),t.appendChild(n),t.appendChild(a),t.appendChild(i);var r=document.createElement("div");return r.classList.add("jg"),e.appendChild(t),e.appendChild(r),{element:e,id:""}}function _(e,t,n){function a(e,a,i){function r(e,t){var n=(0,o.aI)(e,".fg"),a=(0,o.aI)(n,".gg"),i="";switch(t.type){case"route":i="route";break;case"location":i="location_on";break;case"bus":i="directions_bus";break;case"empty":i="lightbulb"}(0,c.yD)(a,i)}function u(e,t){var n=(0,o.aI)(e,".fg .hg"),a="";switch(t.type){case"route":a="路線";break;case"location":a="地點";break;case"bus":a="公車";break;case"empty":a="提示"}n.innerText=a}function f(e,t){(0,o.aI)(e,".fg .ig").innerText=t.time.relative}function m(e,t){(0,o.aI)(e,".jg").innerText=t.name}function v(e,t){switch(t.type){case"route":e.onclick=function(){(0,p.SR)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,l.so)(t.hash)};break;case"bus":e.onclick=function(){(0,d.$l)(t.id)};break;case"empty":e.onclick=null}}function h(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function g(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null==i)r(e,a),u(e,a),f(e,a),m(e,a),v(e,a),h(e,n),g(e,t);else if(a.type!==i.type)r(e,a),u(e,a),f(e,a),m(e,a),v(e,a),h(e,n),g(e,t);else{switch(a.type){case"location":(0,s.hw)(i.name,a.name)||m(e,a),i.time!==a.time&&f(e,a),(0,s.hw)(i.hash,a.hash)||v(e,a);break;case"route":(0,s.hw)(i.name,a.name)||m(e,a),i.time!==a.time&&f(e,a),(0,s.hw)(i.id,a.id)&&(0,s.hw)(i.pid,a.pid)||v(e,a);break;case"bus":(0,s.hw)(i.name,a.name)||m(e,a),i.time!==a.time&&f(e,a),(0,s.hw)(i.id,a.id)||v(e,a);break;case"empty":i.time!==a.time&&f(e,a)}n!==w&&h(e,n),t!==k&&g(e,t)}}var i=e.itemQuantity,r=(0,o.jg)(b,".eg").length;if(i!==r){var u=r-i;if(u<0){for(var f=new DocumentFragment,m=0,v=Math.abs(u);m<v;m++){var h=P();f.appendChild(h.element)}b.append(f)}else for(var g=(0,o.jg)(b,".eg"),x=0,I=Math.abs(u);x<I;x++){g[r-1-x].remove()}}for(var C=(0,o.jg)(b,".eg"),L=0;L<i;L++){var E=C[L],A=e.items[L];if(y.hasOwnProperty("items"))if(y.items[L])a(E,A,y.items[L]);else a(E,A,null);else a(E,A,null)}y=e,w=n,k=t}function j(){for(var e=(0,r.Js)("playing_animation"),t=(0,u.gO)("window"),n=Math.floor(t.height/70/3)+2,a=[],i=0;i<n;i++)a.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_({items:a,itemQuantity:a.length,dataUpdateTime:0},!0,e)}function D(){return S.apply(this,arguments)}function S(){return(S=m(function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");C=t.dynamic,x=t.baseInterval,M=(0,s.zx)();var n=yield(0,i.$i)(M);_(n,!1,e);var o=0;C&&(o=yield(0,a.wz)()),E=(new Date).getTime(),A=C?Math.max(E+I,n.dataUpdateTime+x/o):E+x,Math.max(I,A-E)})).apply(this,arguments)}function $(){return z.apply(this,arguments)}function z(){return(z=m(function*(){D().then(function(){L?setTimeout(function(){$()},Math.max(I,A-(new Date).getTime())):T=!1}).catch(function(e){L?setTimeout(function(){$()},1e4):T=!1})})).apply(this,arguments)}function J(){j(),L||(L=!0,T?D():(T=!0,$()))}}}]);
//# sourceMappingURL=bd03724b8512e7c458c3.js.map