/*! For license information please see d3d70f08aba9045c7810.min.js.LICENSE.txt */
!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("bus",[],t):"object"==typeof exports?exports.bus=t():r.bus=t()}(self,(()=>(()=>{var r={2151:r=>{var t={utf8:{stringToBytes:function(r){return t.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(t.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var t=[],n=0;n<r.length;n++)t.push(255&r.charCodeAt(n));return t},bytesToString:function(r){for(var t=[],n=0;n<r.length;n++)t.push(String.fromCharCode(r[n]));return t.join("")}}};r.exports=t},3939:r=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(r,t){return r<<t|r>>>32-t},rotr:function(r,t){return r<<32-t|r>>>t},endian:function(r){if(r.constructor==Number)return 16711935&n.rotl(r,8)|4278255360&n.rotl(r,24);for(var t=0;t<r.length;t++)r[t]=n.endian(r[t]);return r},randomBytes:function(r){for(var t=[];r>0;r--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(r){for(var t=[],n=0,e=0;n<r.length;n++,e+=8)t[e>>>5]|=r[n]<<24-e%32;return t},wordsToBytes:function(r){for(var t=[],n=0;n<32*r.length;n+=8)t.push(r[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(r){for(var t=[],n=0;n<r.length;n++)t.push((r[n]>>>4).toString(16)),t.push((15&r[n]).toString(16));return t.join("")},hexToBytes:function(r){for(var t=[],n=0;n<r.length;n+=2)t.push(parseInt(r.substr(n,2),16));return t},bytesToBase64:function(r){for(var n=[],e=0;e<r.length;e+=3)for(var o=r[e]<<16|r[e+1]<<8|r[e+2],u=0;u<4;u++)8*e+6*u<=8*r.length?n.push(t.charAt(o>>>6*(3-u)&63)):n.push("=");return n.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],e=0,o=0;e<r.length;o=++e%4)0!=o&&n.push((t.indexOf(r.charAt(e-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(r.charAt(e))>>>6-2*o);return n}},r.exports=n},7206:r=>{function t(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}r.exports=function(r){return null!=r&&(t(r)||function(r){return"function"==typeof r.readFloatLE&&"function"==typeof r.slice&&t(r.slice(0,0))}(r)||!!r._isBuffer)}},3503:(r,t,n)=>{var e,o,u,a,i;e=n(3939),o=n(2151).utf8,u=n(7206),a=n(2151).bin,(i=function(r,t){r.constructor==String?r=t&&"binary"===t.encoding?a.stringToBytes(r):o.stringToBytes(r):u(r)?r=Array.prototype.slice.call(r,0):Array.isArray(r)||r.constructor===Uint8Array||(r=r.toString());for(var n=e.bytesToWords(r),f=8*r.length,s=1732584193,c=-271733879,l=-1732584194,d=271733878,y=0;y<n.length;y++)n[y]=16711935&(n[y]<<8|n[y]>>>24)|4278255360&(n[y]<<24|n[y]>>>8);n[f>>>5]|=128<<f%32,n[14+(f+64>>>9<<4)]=f;var h=i._ff,p=i._gg,v=i._hh,g=i._ii;for(y=0;y<n.length;y+=16){var b=s,m=c,x=l,A=d;s=h(s,c,l,d,n[y+0],7,-680876936),d=h(d,s,c,l,n[y+1],12,-389564586),l=h(l,d,s,c,n[y+2],17,606105819),c=h(c,l,d,s,n[y+3],22,-1044525330),s=h(s,c,l,d,n[y+4],7,-176418897),d=h(d,s,c,l,n[y+5],12,1200080426),l=h(l,d,s,c,n[y+6],17,-1473231341),c=h(c,l,d,s,n[y+7],22,-45705983),s=h(s,c,l,d,n[y+8],7,1770035416),d=h(d,s,c,l,n[y+9],12,-1958414417),l=h(l,d,s,c,n[y+10],17,-42063),c=h(c,l,d,s,n[y+11],22,-1990404162),s=h(s,c,l,d,n[y+12],7,1804603682),d=h(d,s,c,l,n[y+13],12,-40341101),l=h(l,d,s,c,n[y+14],17,-1502002290),s=p(s,c=h(c,l,d,s,n[y+15],22,1236535329),l,d,n[y+1],5,-165796510),d=p(d,s,c,l,n[y+6],9,-1069501632),l=p(l,d,s,c,n[y+11],14,643717713),c=p(c,l,d,s,n[y+0],20,-373897302),s=p(s,c,l,d,n[y+5],5,-701558691),d=p(d,s,c,l,n[y+10],9,38016083),l=p(l,d,s,c,n[y+15],14,-660478335),c=p(c,l,d,s,n[y+4],20,-405537848),s=p(s,c,l,d,n[y+9],5,568446438),d=p(d,s,c,l,n[y+14],9,-1019803690),l=p(l,d,s,c,n[y+3],14,-187363961),c=p(c,l,d,s,n[y+8],20,1163531501),s=p(s,c,l,d,n[y+13],5,-1444681467),d=p(d,s,c,l,n[y+2],9,-51403784),l=p(l,d,s,c,n[y+7],14,1735328473),s=v(s,c=p(c,l,d,s,n[y+12],20,-1926607734),l,d,n[y+5],4,-378558),d=v(d,s,c,l,n[y+8],11,-2022574463),l=v(l,d,s,c,n[y+11],16,1839030562),c=v(c,l,d,s,n[y+14],23,-35309556),s=v(s,c,l,d,n[y+1],4,-1530992060),d=v(d,s,c,l,n[y+4],11,1272893353),l=v(l,d,s,c,n[y+7],16,-155497632),c=v(c,l,d,s,n[y+10],23,-1094730640),s=v(s,c,l,d,n[y+13],4,681279174),d=v(d,s,c,l,n[y+0],11,-358537222),l=v(l,d,s,c,n[y+3],16,-722521979),c=v(c,l,d,s,n[y+6],23,76029189),s=v(s,c,l,d,n[y+9],4,-640364487),d=v(d,s,c,l,n[y+12],11,-421815835),l=v(l,d,s,c,n[y+15],16,530742520),s=g(s,c=v(c,l,d,s,n[y+2],23,-995338651),l,d,n[y+0],6,-198630844),d=g(d,s,c,l,n[y+7],10,1126891415),l=g(l,d,s,c,n[y+14],15,-1416354905),c=g(c,l,d,s,n[y+5],21,-57434055),s=g(s,c,l,d,n[y+12],6,1700485571),d=g(d,s,c,l,n[y+3],10,-1894986606),l=g(l,d,s,c,n[y+10],15,-1051523),c=g(c,l,d,s,n[y+1],21,-2054922799),s=g(s,c,l,d,n[y+8],6,1873313359),d=g(d,s,c,l,n[y+15],10,-30611744),l=g(l,d,s,c,n[y+6],15,-1560198380),c=g(c,l,d,s,n[y+13],21,1309151649),s=g(s,c,l,d,n[y+4],6,-145523070),d=g(d,s,c,l,n[y+11],10,-1120210379),l=g(l,d,s,c,n[y+2],15,718787259),c=g(c,l,d,s,n[y+9],21,-343485551),s=s+b>>>0,c=c+m>>>0,l=l+x>>>0,d=d+A>>>0}return e.endian([s,c,l,d])})._ff=function(r,t,n,e,o,u,a){var i=r+(t&n|~t&e)+(o>>>0)+a;return(i<<u|i>>>32-u)+t},i._gg=function(r,t,n,e,o,u,a){var i=r+(t&e|n&~e)+(o>>>0)+a;return(i<<u|i>>>32-u)+t},i._hh=function(r,t,n,e,o,u,a){var i=r+(t^n^e)+(o>>>0)+a;return(i<<u|i>>>32-u)+t},i._ii=function(r,t,n,e,o,u,a){var i=r+(n^(t|~e))+(o>>>0)+a;return(i<<u|i>>>32-u)+t},i._blocksize=16,i._digestsize=16,r.exports=function(r,t){if(null==r)throw new Error("Illegal argument "+r);var n=e.wordsToBytes(i(r,t));return t&&t.asBytes?n:t&&t.asString?a.bytesToString(n):e.bytesToHex(n)}}},t={};function n(e){var o=t[e];if(void 0!==o)return o.exports;var u=t[e]={exports:{}};return r[e](u,u.exports,n),u.exports}var e={};return(()=>{"use strict";function r(r,n){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=t(r))||n&&r&&"number"==typeof r.length){e&&(r=e);var o=0,u=function(){};return{s:u,n:function(){return o>=r.length?{done:!0}:{done:!1,value:r[o++]}},e:function(r){throw r},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,f=!1;return{s:function(){e=e.call(r)},n:function(){var r=e.next();return i=r.done,r},e:function(r){f=!0,a=r},f:function(){try{i||null==e.return||e.return()}finally{if(f)throw a}}}}function t(r,t){if(r){if("string"==typeof r)return e(r,t);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(r,t):void 0}}function e(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=Array(t);n<t;n++)e[n]=r[n];return e}n(3503);function o(t){var n=Math.hypot(t),e=[];if(n>0){var o,u=1/n,a=r(t);try{for(a.s();!(o=a.n()).done;){var i=o.value;e.push(i*u)}}catch(r){a.e(r)}finally{a.f()}return e}return t}function u(r,t){var n="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,t){if(r){if("string"==typeof r)return a(r,t);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(r,t):void 0}}(r))||t&&r&&"number"==typeof r.length){n&&(r=n);var e=0,o=function(){};return{s:o,n:function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,i=!0,f=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return i=r.done,r},e:function(r){f=!0,u=r},f:function(){try{i||null==n.return||n.return()}finally{if(f)throw u}}}}function a(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=Array(t);n<t;n++)e[n]=r[n];return e}self.onmessage=function(r){var t=function(r){var t,n={},e=u(r);try{for(e.s();!(t=e.n()).done;){var a=t.value,i=a.routeId,f="r_".concat(i);n.hasOwnProperty(f)||(n[f]=[]),n[f].push(a)}}catch(r){e.e(r)}finally{e.f()}for(var s in n)n[s]=n[s].sort((function(r,t){return r.seqNo-t.seqNo}));var c,l={},d=u(r);try{for(d.s();!(c=d.n()).done;){for(var y=c.value,h=[0,0],p=n["r_".concat(y.routeId)],v=p.length,g=null,b=0;b<v;b++)if(p[b].Id===y.Id){var m=0;b<v-1&&(m=b+1),g=p[m]}if(g)h=o([parseFloat(g.longitude)-parseFloat(y.longitude),parseFloat(g.latitude)-parseFloat(y.latitude)]);var x="l_".concat(y.stopLocationId);if(l.hasOwnProperty(x))l[x].r.indexOf(y.routeId)>-1||l[x].r.push(y.routeId),l[x].s.indexOf(y.Id)>-1||(l[x].s.push(y.Id),l[x].v.push(h)),l[x].a.push(y.address);else{var A={};A.n=y.nameZh,A.lo=parseFloat(y.longitude),A.la=parseFloat(y.latitude),A.r=[y.routeId],A.s=[y.Id],A.v=[h],A.a=[y.address],l[x]=A}}}catch(r){d.e(r)}finally{d.f()}return l}(r.data);self.postMessage(t)}})(),e=e.default})()));
//# sourceMappingURL=d3d70f08aba9045c7810.min.js.map