/*! For license information please see 861.17f92bfa076dd41fb18d.js.LICENSE.txt */
(self.webpackChunkbus=self.webpackChunkbus||[]).push([[861],{157(t,e,n){const r=n(6886),i=n(9953),a=n(9899),o=n(8820),s=n(6421),u=n(7756),l=n(1332),c=n(7518),d=n(4764),f=n(1427),h=n(4565),p=n(208),v=n(9801);function y(t,e,n){const r=t.size,i=h.getEncodedBits(e,n);let a,o;for(a=0;a<15;a++)o=1==(i>>a&1),a<6?t.set(a,8,o,!0):a<8?t.set(a+1,8,o,!0):t.set(r-15+a,8,o,!0),a<8?t.set(8,r-a-1,o,!0):a<9?t.set(8,15-a-1+1,o,!0):t.set(8,15-a-1,o,!0);t.set(r-8,8,1,!0)}function m(t,e,n){const i=new a;n.forEach(function(e){i.put(e.mode.bit,4),i.put(e.getLength(),p.getCharCountIndicator(e.mode,t)),e.write(i)});const o=8*(r.getSymbolTotalCodewords(t)-c.getTotalCodewordsCount(t,e));for(i.getLengthInBits()+4<=o&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(0);const s=(o-i.getLengthInBits())/8;for(let t=0;t<s;t++)i.put(t%2?17:236,8);return function(t,e,n){const i=r.getSymbolTotalCodewords(e),a=c.getTotalCodewordsCount(e,n),o=i-a,s=c.getBlocksCount(e,n),u=i%s,l=s-u,f=Math.floor(i/s),h=Math.floor(o/s),p=h+1,v=f-h,y=new d(v);let m=0;const g=new Array(s),b=new Array(s);let w=0;const A=new Uint8Array(t.buffer);for(let t=0;t<s;t++){const e=t<l?h:p;g[t]=A.slice(m,m+e),b[t]=y.encode(g[t]),m+=e,w=Math.max(w,e)}const S=new Uint8Array(i);let _,k,I=0;for(_=0;_<w;_++)for(k=0;k<s;k++)_<g[k].length&&(S[I++]=g[k][_]);for(_=0;_<v;_++)for(k=0;k<s;k++)S[I++]=b[k][_];return S}(i,t,e)}function g(t,e,n,i){let a;if(Array.isArray(t))a=v.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");{let r=e;if(!r){const e=v.rawSplit(t);r=f.getBestVersionForData(e,n)}a=v.fromString(t,r||40)}}const c=f.getBestVersionForData(a,n);if(!c)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<c)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+c+".\n")}else e=c;const d=m(e,n,a),h=r.getSymbolSize(e),p=new o(h);return function(t,e){const n=t.size,r=u.getPositions(e);for(let e=0;e<r.length;e++){const i=r[e][0],a=r[e][1];for(let e=-1;e<=7;e++)if(!(i+e<=-1||n<=i+e))for(let r=-1;r<=7;r++)a+r<=-1||n<=a+r||(e>=0&&e<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===e||6===e)||e>=2&&e<=4&&r>=2&&r<=4?t.set(i+e,a+r,!0,!0):t.set(i+e,a+r,!1,!0))}}(p,e),function(t){const e=t.size;for(let n=8;n<e-8;n++){const e=n%2==0;t.set(n,6,e,!0),t.set(6,n,e,!0)}}(p),function(t,e){const n=s.getPositions(e);for(let e=0;e<n.length;e++){const r=n[e][0],i=n[e][1];for(let e=-2;e<=2;e++)for(let n=-2;n<=2;n++)-2===e||2===e||-2===n||2===n||0===e&&0===n?t.set(r+e,i+n,!0,!0):t.set(r+e,i+n,!1,!0)}}(p,e),y(p,n,0),e>=7&&function(t,e){const n=t.size,r=f.getEncodedBits(e);let i,a,o;for(let e=0;e<18;e++)i=Math.floor(e/3),a=e%3+n-8-3,o=1==(r>>e&1),t.set(i,a,o,!0),t.set(a,i,o,!0)}(p,e),function(t,e){const n=t.size;let r=-1,i=n-1,a=7,o=0;for(let s=n-1;s>0;s-=2)for(6===s&&s--;;){for(let n=0;n<2;n++)if(!t.isReserved(i,s-n)){let r=!1;o<e.length&&(r=1==(e[o]>>>a&1)),t.set(i,s-n,r),a--,-1===a&&(o++,a=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}(p,d),isNaN(i)&&(i=l.getBestMask(p,y.bind(null,p,n))),l.applyMask(i,p),y(p,n,i),{modules:p,version:e,errorCorrectionLevel:n,maskPattern:i,segments:a}}e.create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");let n,a,o=i.M;return void 0!==e&&(o=i.from(e.errorCorrectionLevel,i.M),n=f.from(e.version),a=l.from(e.maskPattern),e.toSJISFunc&&r.setToSJISFunction(e.toSJISFunc)),g(t,n,o,a)}},208(t,e,n){const r=n(1878),i=n(7044);e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!r.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return i.testNumeric(t)?e.NUMERIC:i.testAlphanumeric(t)?e.ALPHANUMERIC:i.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return n}}},1332(t,e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n=3,r=3,i=40,a=10;function o(t,n,r){switch(t){case e.Patterns.PATTERN000:return(n+r)%2==0;case e.Patterns.PATTERN001:return n%2==0;case e.Patterns.PATTERN010:return r%3==0;case e.Patterns.PATTERN011:return(n+r)%3==0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case e.Patterns.PATTERN101:return n*r%2+n*r%3==0;case e.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case e.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){const e=t.size;let r=0,i=0,a=0,o=null,s=null;for(let u=0;u<e;u++){i=a=0,o=s=null;for(let l=0;l<e;l++){let e=t.get(u,l);e===o?i++:(i>=5&&(r+=n+(i-5)),o=e,i=1),e=t.get(l,u),e===s?a++:(a>=5&&(r+=n+(a-5)),s=e,a=1)}i>=5&&(r+=n+(i-5)),a>=5&&(r+=n+(a-5))}return r},e.getPenaltyN2=function(t){const e=t.size;let n=0;for(let r=0;r<e-1;r++)for(let i=0;i<e-1;i++){const e=t.get(r,i)+t.get(r,i+1)+t.get(r+1,i)+t.get(r+1,i+1);4!==e&&0!==e||n++}return n*r},e.getPenaltyN3=function(t){const e=t.size;let n=0,r=0,a=0;for(let i=0;i<e;i++){r=a=0;for(let o=0;o<e;o++)r=r<<1&2047|t.get(i,o),o>=10&&(1488===r||93===r)&&n++,a=a<<1&2047|t.get(o,i),o>=10&&(1488===a||93===a)&&n++}return n*i},e.getPenaltyN4=function(t){let e=0;const n=t.data.length;for(let r=0;r<n;r++)e+=t.data[r];return Math.abs(Math.ceil(100*e/n/5)-10)*a},e.applyMask=function(t,e){const n=e.size;for(let r=0;r<n;r++)for(let i=0;i<n;i++)e.isReserved(i,r)||e.xor(i,r,o(t,i,r))},e.getBestMask=function(t,n){const r=Object.keys(e.Patterns).length;let i=0,a=1/0;for(let o=0;o<r;o++){n(o),e.applyMask(o,t);const r=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(o,t),r<a&&(a=r,i=o)}return i}},1427(t,e,n){const r=n(6886),i=n(7518),a=n(9953),o=n(208),s=n(1878),u=r.getBCHDigit(7973);function l(t,e){return o.getCharCountIndicator(t,e)+4}function c(t,e){let n=0;return t.forEach(function(t){const r=l(t.mode,e);n+=r+t.getBitsLength()}),n}e.from=function(t,e){return s.isValid(t)?parseInt(t,10):e},e.getCapacity=function(t,e,n){if(!s.isValid(t))throw new Error("Invalid QR Code version");void 0===n&&(n=o.BYTE);const a=8*(r.getSymbolTotalCodewords(t)-i.getTotalCodewordsCount(t,e));if(n===o.MIXED)return a;const u=a-l(n,t);switch(n){case o.NUMERIC:return Math.floor(u/10*3);case o.ALPHANUMERIC:return Math.floor(u/11*2);case o.KANJI:return Math.floor(u/13);case o.BYTE:default:return Math.floor(u/8)}},e.getBestVersionForData=function(t,n){let r;const i=a.from(n,a.M);if(Array.isArray(t)){if(t.length>1)return function(t,n){for(let r=1;r<=40;r++)if(c(t,r)<=e.getCapacity(r,n,o.MIXED))return r}(t,i);if(0===t.length)return 1;r=t[0]}else r=t;return function(t,n,r){for(let i=1;i<=40;i++)if(n<=e.getCapacity(i,r,t))return i}(r.mode,r.getLength(),i)},e.getEncodedBits=function(t){if(!s.isValid(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;r.getBCHDigit(e)-u>=0;)e^=7973<<r.getBCHDigit(e)-u;return t<<12|e}},1433(t,e,n){const r=n(208),i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(t){this.mode=r.ALPHANUMERIC,this.data=t}a.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let n=45*i.indexOf(this.data[e]);n+=i.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(i.indexOf(this.data[e]),6)},t.exports=a},1878(t,e){e.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}},2151(t){var e={utf8:{stringToBytes:function(t){return e.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(e.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=e},2731(t,e){const n=new Uint8Array(512),r=new Uint8Array(256);!function(){let t=1;for(let e=0;e<255;e++)n[e]=t,r[t]=e,t<<=1,256&t&&(t^=285);for(let t=255;t<512;t++)n[t]=n[t-255]}(),e.log=function(t){if(t<1)throw new Error("log("+t+")");return r[t]},e.exp=function(t){return n[t]},e.mul=function(t,e){return 0===t||0===e?0:n[r[t]+r[e]]}},3503(t,e,n){var r,i,a,o,s;r=n(3939),i=n(2151).utf8,a=n(7206),o=n(2151).bin,(s=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?o.stringToBytes(t):i.stringToBytes(t):a(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var n=r.bytesToWords(t),u=8*t.length,l=1732584193,c=-271733879,d=-1732584194,f=271733878,h=0;h<n.length;h++)n[h]=16711935&(n[h]<<8|n[h]>>>24)|4278255360&(n[h]<<24|n[h]>>>8);n[u>>>5]|=128<<u%32,n[14+(u+64>>>9<<4)]=u;var p=s._ff,v=s._gg,y=s._hh,m=s._ii;for(h=0;h<n.length;h+=16){var g=l,b=c,w=d,A=f;l=p(l,c,d,f,n[h+0],7,-680876936),f=p(f,l,c,d,n[h+1],12,-389564586),d=p(d,f,l,c,n[h+2],17,606105819),c=p(c,d,f,l,n[h+3],22,-1044525330),l=p(l,c,d,f,n[h+4],7,-176418897),f=p(f,l,c,d,n[h+5],12,1200080426),d=p(d,f,l,c,n[h+6],17,-1473231341),c=p(c,d,f,l,n[h+7],22,-45705983),l=p(l,c,d,f,n[h+8],7,1770035416),f=p(f,l,c,d,n[h+9],12,-1958414417),d=p(d,f,l,c,n[h+10],17,-42063),c=p(c,d,f,l,n[h+11],22,-1990404162),l=p(l,c,d,f,n[h+12],7,1804603682),f=p(f,l,c,d,n[h+13],12,-40341101),d=p(d,f,l,c,n[h+14],17,-1502002290),l=v(l,c=p(c,d,f,l,n[h+15],22,1236535329),d,f,n[h+1],5,-165796510),f=v(f,l,c,d,n[h+6],9,-1069501632),d=v(d,f,l,c,n[h+11],14,643717713),c=v(c,d,f,l,n[h+0],20,-373897302),l=v(l,c,d,f,n[h+5],5,-701558691),f=v(f,l,c,d,n[h+10],9,38016083),d=v(d,f,l,c,n[h+15],14,-660478335),c=v(c,d,f,l,n[h+4],20,-405537848),l=v(l,c,d,f,n[h+9],5,568446438),f=v(f,l,c,d,n[h+14],9,-1019803690),d=v(d,f,l,c,n[h+3],14,-187363961),c=v(c,d,f,l,n[h+8],20,1163531501),l=v(l,c,d,f,n[h+13],5,-1444681467),f=v(f,l,c,d,n[h+2],9,-51403784),d=v(d,f,l,c,n[h+7],14,1735328473),l=y(l,c=v(c,d,f,l,n[h+12],20,-1926607734),d,f,n[h+5],4,-378558),f=y(f,l,c,d,n[h+8],11,-2022574463),d=y(d,f,l,c,n[h+11],16,1839030562),c=y(c,d,f,l,n[h+14],23,-35309556),l=y(l,c,d,f,n[h+1],4,-1530992060),f=y(f,l,c,d,n[h+4],11,1272893353),d=y(d,f,l,c,n[h+7],16,-155497632),c=y(c,d,f,l,n[h+10],23,-1094730640),l=y(l,c,d,f,n[h+13],4,681279174),f=y(f,l,c,d,n[h+0],11,-358537222),d=y(d,f,l,c,n[h+3],16,-722521979),c=y(c,d,f,l,n[h+6],23,76029189),l=y(l,c,d,f,n[h+9],4,-640364487),f=y(f,l,c,d,n[h+12],11,-421815835),d=y(d,f,l,c,n[h+15],16,530742520),l=m(l,c=y(c,d,f,l,n[h+2],23,-995338651),d,f,n[h+0],6,-198630844),f=m(f,l,c,d,n[h+7],10,1126891415),d=m(d,f,l,c,n[h+14],15,-1416354905),c=m(c,d,f,l,n[h+5],21,-57434055),l=m(l,c,d,f,n[h+12],6,1700485571),f=m(f,l,c,d,n[h+3],10,-1894986606),d=m(d,f,l,c,n[h+10],15,-1051523),c=m(c,d,f,l,n[h+1],21,-2054922799),l=m(l,c,d,f,n[h+8],6,1873313359),f=m(f,l,c,d,n[h+15],10,-30611744),d=m(d,f,l,c,n[h+6],15,-1560198380),c=m(c,d,f,l,n[h+13],21,1309151649),l=m(l,c,d,f,n[h+4],6,-145523070),f=m(f,l,c,d,n[h+11],10,-1120210379),d=m(d,f,l,c,n[h+2],15,718787259),c=m(c,d,f,l,n[h+9],21,-343485551),l=l+g>>>0,c=c+b>>>0,d=d+w>>>0,f=f+A>>>0}return r.endian([l,c,d,f])})._ff=function(t,e,n,r,i,a,o){var s=t+(e&n|~e&r)+(i>>>0)+o;return(s<<a|s>>>32-a)+e},s._gg=function(t,e,n,r,i,a,o){var s=t+(e&r|n&~r)+(i>>>0)+o;return(s<<a|s>>>32-a)+e},s._hh=function(t,e,n,r,i,a,o){var s=t+(e^n^r)+(i>>>0)+o;return(s<<a|s>>>32-a)+e},s._ii=function(t,e,n,r,i,a,o){var s=t+(n^(e|~r))+(i>>>0)+o;return(s<<a|s>>>32-a)+e},s._blocksize=16,s._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var n=r.wordsToBytes(s(t,e));return e&&e.asBytes?n:e&&e.asString?o.bytesToString(n):r.bytesToHex(n)}},3939(t){var e,n;e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var n=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],a=0;a<4;a++)8*r+6*a<=8*t.length?n.push(e.charAt(i>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&n.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(r))>>>6-2*i);return n}},t.exports=n},4357(t,e,n){const r=n(208);function i(t){this.mode=r.NUMERIC,this.data=t.toString()}i.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){let e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);const i=this.data.length-e;i>0&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,3*i+1))},t.exports=i},4462(t,e,n){var r;!function(){"use strict";var e="input is invalid type",i="object"==typeof window,a=i?window:{};a.JS_SHA512_NO_WINDOW&&(i=!1);var o=!i&&"object"==typeof self;!a.JS_SHA512_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?a=n.g:o&&(a=self);var s=!a.JS_SHA512_NO_COMMON_JS&&t.exports,u=n.amdO,l=!a.JS_SHA512_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,c="0123456789abcdef".split(""),d=[-2147483648,8388608,32768,128],f=[24,16,8,0],h=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],p=["hex","array","digest","arrayBuffer"],v=[],y=Array.isArray;!a.JS_SHA512_NO_NODE_JS&&y||(y=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var m=ArrayBuffer.isView;!l||!a.JS_SHA512_NO_ARRAY_BUFFER_IS_VIEW&&m||(m=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});var g=function(t){var n=typeof t;if("string"===n)return[t,!0];if("object"!==n||null===t)throw new Error(e);if(l&&t.constructor===ArrayBuffer)return[new Uint8Array(t),!1];if(!y(t)&&!m(t))throw new Error(e);return[t,!1]},b=function(t,e){return function(n){return new _(e,!0).update(n)[t]()}},w=function(t){var e=b("hex",t);e.create=function(){return new _(t)},e.update=function(t){return e.create().update(t)};for(var n=0;n<p.length;++n){var r=p[n];e[r]=b(r,t)}return e},A=function(t,e){return function(n,r){return new k(n,e,!0).update(r)[t]()}},S=function(t){var e=A("hex",t);e.create=function(e){return new k(e,t)},e.update=function(t,n){return e.create(t).update(n)};for(var n=0;n<p.length;++n){var r=p[n];e[r]=A(r,t)}return e};function _(t,e){e?(v[0]=v[1]=v[2]=v[3]=v[4]=v[5]=v[6]=v[7]=v[8]=v[9]=v[10]=v[11]=v[12]=v[13]=v[14]=v[15]=v[16]=v[17]=v[18]=v[19]=v[20]=v[21]=v[22]=v[23]=v[24]=v[25]=v[26]=v[27]=v[28]=v[29]=v[30]=v[31]=v[32]=0,this.blocks=v):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],384==t?(this.h0h=3418070365,this.h0l=3238371032,this.h1h=1654270250,this.h1l=914150663,this.h2h=2438529370,this.h2l=812702999,this.h3h=355462360,this.h3l=4144912697,this.h4h=1731405415,this.h4l=4290775857,this.h5h=2394180231,this.h5l=1750603025,this.h6h=3675008525,this.h6l=1694076839,this.h7h=1203062813,this.h7l=3204075428):256==t?(this.h0h=573645204,this.h0l=4230739756,this.h1h=2673172387,this.h1l=3360449730,this.h2h=596883563,this.h2l=1867755857,this.h3h=2520282905,this.h3l=1497426621,this.h4h=2519219938,this.h4l=2827943907,this.h5h=3193839141,this.h5l=1401305490,this.h6h=721525244,this.h6l=746961066,this.h7h=246885852,this.h7l=2177182882):224==t?(this.h0h=2352822216,this.h0l=424955298,this.h1h=1944164710,this.h1l=2312950998,this.h2h=502970286,this.h2l=855612546,this.h3h=1738396948,this.h3l=1479516111,this.h4h=258812777,this.h4l=2077511080,this.h5h=2011393907,this.h5l=79989058,this.h6h=1067287976,this.h6l=1780299464,this.h7h=286451373,this.h7l=2446758561):(this.h0h=1779033703,this.h0l=4089235720,this.h1h=3144134277,this.h1l=2227873595,this.h2h=1013904242,this.h2l=4271175723,this.h3h=2773480762,this.h3l=1595750129,this.h4h=1359893119,this.h4l=2917565137,this.h5h=2600822924,this.h5l=725511199,this.h6h=528734635,this.h6l=4215389547,this.h7h=1541459225,this.h7l=327033209),this.bits=t,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1}function k(t,e,n){var r=g(t);if(t=r[0],r[1]){for(var i,a=[],o=t.length,s=0,u=0;u<o;++u)(i=t.charCodeAt(u))<128?a[s++]=i:i<2048?(a[s++]=192|i>>>6,a[s++]=128|63&i):i<55296||i>=57344?(a[s++]=224|i>>>12,a[s++]=128|i>>>6&63,a[s++]=128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++u)),a[s++]=240|i>>>18,a[s++]=128|i>>>12&63,a[s++]=128|i>>>6&63,a[s++]=128|63&i);t=a}t.length>128&&(t=new _(e,!0).update(t).array());var l=[],c=[];for(u=0;u<128;++u){var d=t[u]||0;l[u]=92^d,c[u]=54^d}_.call(this,e,n),this.update(c),this.oKeyPad=l,this.inner=!0,this.sharedMemory=n}_.prototype.update=function(t){if(this.finalized)throw new Error("finalize already called");var e=g(t);t=e[0];for(var n,r,i=e[1],a=0,o=t.length,s=this.blocks;a<o;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,this.block=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=s[16]=s[17]=s[18]=s[19]=s[20]=s[21]=s[22]=s[23]=s[24]=s[25]=s[26]=s[27]=s[28]=s[29]=s[30]=s[31]=s[32]=0),i)for(r=this.start;a<o&&r<128;++a)(n=t.charCodeAt(a))<128?s[r>>>2]|=n<<f[3&r++]:n<2048?(s[r>>>2]|=(192|n>>>6)<<f[3&r++],s[r>>>2]|=(128|63&n)<<f[3&r++]):n<55296||n>=57344?(s[r>>>2]|=(224|n>>>12)<<f[3&r++],s[r>>>2]|=(128|n>>>6&63)<<f[3&r++],s[r>>>2]|=(128|63&n)<<f[3&r++]):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++a)),s[r>>>2]|=(240|n>>>18)<<f[3&r++],s[r>>>2]|=(128|n>>>12&63)<<f[3&r++],s[r>>>2]|=(128|n>>>6&63)<<f[3&r++],s[r>>>2]|=(128|63&n)<<f[3&r++]);else for(r=this.start;a<o&&r<128;++a)s[r>>>2]|=t[a]<<f[3&r++];this.lastByteIndex=r,this.bytes+=r-this.start,r>=128?(this.block=s[32],this.start=r-128,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this},_.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[32]=this.block,t[e>>>2]|=d[3&e],this.block=t[32],e>=112&&(this.hashed||this.hash(),t[0]=this.block,t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=t[16]=t[17]=t[18]=t[19]=t[20]=t[21]=t[22]=t[23]=t[24]=t[25]=t[26]=t[27]=t[28]=t[29]=t[30]=t[31]=t[32]=0),t[30]=this.hBytes<<3|this.bytes>>>29,t[31]=this.bytes<<3,this.hash()}},_.prototype.hash=function(){var t,e,n,r,i,a,o,s,u,l,c,d,f,p,v,y,m,g,b,w,A,S,_,k,I,C=this.h0h,E=this.h0l,T=this.h1h,$=this.h1l,x=this.h2h,L=this.h2l,M=this.h3h,P=this.h3l,O=this.h4h,D=this.h4l,B=this.h5h,N=this.h5l,j=this.h6h,R=this.h6l,U=this.h7h,F=this.h7l,J=this.blocks;for(t=32;t<160;t+=2)e=((w=J[t-30])>>>1|(A=J[t-29])<<31)^(w>>>8|A<<24)^w>>>7,n=(A>>>1|w<<31)^(A>>>8|w<<24)^(A>>>7|w<<25),r=((w=J[t-4])>>>19|(A=J[t-3])<<13)^(A>>>29|w<<3)^w>>>6,i=(A>>>19|w<<13)^(w>>>29|A<<3)^(A>>>6|w<<26),w=J[t-32],A=J[t-31],u=((S=J[t-14])>>>16)+(w>>>16)+(e>>>16)+(r>>>16)+((s=(65535&S)+(65535&w)+(65535&e)+(65535&r)+((o=((_=J[t-13])>>>16)+(A>>>16)+(n>>>16)+(i>>>16)+((a=(65535&_)+(65535&A)+(65535&n)+(65535&i))>>>16))>>>16))>>>16),J[t]=u<<16|65535&s,J[t+1]=o<<16|65535&a;var z=C,H=E,q=T,Q=$,Y=x,W=L,V=M,K=P,G=O,Z=D,X=B,tt=N,et=j,nt=R,rt=U,it=F;for(y=q&Y,m=Q&W,t=0;t<160;t+=8)e=(z>>>28|H<<4)^(H>>>2|z<<30)^(H>>>7|z<<25),n=(H>>>28|z<<4)^(z>>>2|H<<30)^(z>>>7|H<<25),r=(G>>>14|Z<<18)^(G>>>18|Z<<14)^(Z>>>9|G<<23),i=(Z>>>14|G<<18)^(Z>>>18|G<<14)^(G>>>9|Z<<23),g=(l=z&q)^z&Y^y,b=(c=H&Q)^H&W^m,k=G&X^~G&et,I=Z&tt^~Z&nt,w=J[t],A=J[t+1],w=(u=((S=h[t])>>>16)+(w>>>16)+(k>>>16)+(r>>>16)+(rt>>>16)+((s=(65535&S)+(65535&w)+(65535&k)+(65535&r)+(65535&rt)+((o=((_=h[t+1])>>>16)+(A>>>16)+(I>>>16)+(i>>>16)+(it>>>16)+((a=(65535&_)+(65535&A)+(65535&I)+(65535&i)+(65535&it))>>>16))>>>16))>>>16))<<16|65535&s,A=o<<16|65535&a,S=(u=(g>>>16)+(e>>>16)+((s=(65535&g)+(65535&e)+((o=(b>>>16)+(n>>>16)+((a=(65535&b)+(65535&n))>>>16))>>>16))>>>16))<<16|65535&s,_=o<<16|65535&a,rt=(u=(V>>>16)+(w>>>16)+((s=(65535&V)+(65535&w)+((o=(K>>>16)+(A>>>16)+((a=(65535&K)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,it=o<<16|65535&a,e=((V=(u=(S>>>16)+(w>>>16)+((s=(65535&S)+(65535&w)+((o=(_>>>16)+(A>>>16)+((a=(65535&_)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s)>>>28|(K=o<<16|65535&a)<<4)^(K>>>2|V<<30)^(K>>>7|V<<25),n=(K>>>28|V<<4)^(V>>>2|K<<30)^(V>>>7|K<<25),r=(rt>>>14|it<<18)^(rt>>>18|it<<14)^(it>>>9|rt<<23),i=(it>>>14|rt<<18)^(it>>>18|rt<<14)^(rt>>>9|it<<23),g=(d=V&z)^V&q^l,b=(f=K&H)^K&Q^c,k=rt&G^~rt&X,I=it&Z^~it&tt,w=J[t+2],A=J[t+3],w=(u=((S=h[t+2])>>>16)+(w>>>16)+(k>>>16)+(r>>>16)+(et>>>16)+((s=(65535&S)+(65535&w)+(65535&k)+(65535&r)+(65535&et)+((o=((_=h[t+3])>>>16)+(A>>>16)+(I>>>16)+(i>>>16)+(nt>>>16)+((a=(65535&_)+(65535&A)+(65535&I)+(65535&i)+(65535&nt))>>>16))>>>16))>>>16))<<16|65535&s,A=o<<16|65535&a,S=(u=(g>>>16)+(e>>>16)+((s=(65535&g)+(65535&e)+((o=(b>>>16)+(n>>>16)+((a=(65535&b)+(65535&n))>>>16))>>>16))>>>16))<<16|65535&s,_=o<<16|65535&a,et=(u=(Y>>>16)+(w>>>16)+((s=(65535&Y)+(65535&w)+((o=(W>>>16)+(A>>>16)+((a=(65535&W)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,nt=o<<16|65535&a,e=((Y=(u=(S>>>16)+(w>>>16)+((s=(65535&S)+(65535&w)+((o=(_>>>16)+(A>>>16)+((a=(65535&_)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s)>>>28|(W=o<<16|65535&a)<<4)^(W>>>2|Y<<30)^(W>>>7|Y<<25),n=(W>>>28|Y<<4)^(Y>>>2|W<<30)^(Y>>>7|W<<25),r=(et>>>14|nt<<18)^(et>>>18|nt<<14)^(nt>>>9|et<<23),i=(nt>>>14|et<<18)^(nt>>>18|et<<14)^(et>>>9|nt<<23),g=(p=Y&V)^Y&z^d,b=(v=W&K)^W&H^f,k=et&rt^~et&G,I=nt&it^~nt&Z,w=J[t+4],A=J[t+5],w=(u=((S=h[t+4])>>>16)+(w>>>16)+(k>>>16)+(r>>>16)+(X>>>16)+((s=(65535&S)+(65535&w)+(65535&k)+(65535&r)+(65535&X)+((o=((_=h[t+5])>>>16)+(A>>>16)+(I>>>16)+(i>>>16)+(tt>>>16)+((a=(65535&_)+(65535&A)+(65535&I)+(65535&i)+(65535&tt))>>>16))>>>16))>>>16))<<16|65535&s,A=o<<16|65535&a,S=(u=(g>>>16)+(e>>>16)+((s=(65535&g)+(65535&e)+((o=(b>>>16)+(n>>>16)+((a=(65535&b)+(65535&n))>>>16))>>>16))>>>16))<<16|65535&s,_=o<<16|65535&a,X=(u=(q>>>16)+(w>>>16)+((s=(65535&q)+(65535&w)+((o=(Q>>>16)+(A>>>16)+((a=(65535&Q)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,tt=o<<16|65535&a,e=((q=(u=(S>>>16)+(w>>>16)+((s=(65535&S)+(65535&w)+((o=(_>>>16)+(A>>>16)+((a=(65535&_)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s)>>>28|(Q=o<<16|65535&a)<<4)^(Q>>>2|q<<30)^(Q>>>7|q<<25),n=(Q>>>28|q<<4)^(q>>>2|Q<<30)^(q>>>7|Q<<25),r=(X>>>14|tt<<18)^(X>>>18|tt<<14)^(tt>>>9|X<<23),i=(tt>>>14|X<<18)^(tt>>>18|X<<14)^(X>>>9|tt<<23),g=(y=q&Y)^q&V^p,b=(m=Q&W)^Q&K^v,k=X&et^~X&rt,I=tt&nt^~tt&it,w=J[t+6],A=J[t+7],w=(u=((S=h[t+6])>>>16)+(w>>>16)+(k>>>16)+(r>>>16)+(G>>>16)+((s=(65535&S)+(65535&w)+(65535&k)+(65535&r)+(65535&G)+((o=((_=h[t+7])>>>16)+(A>>>16)+(I>>>16)+(i>>>16)+(Z>>>16)+((a=(65535&_)+(65535&A)+(65535&I)+(65535&i)+(65535&Z))>>>16))>>>16))>>>16))<<16|65535&s,A=o<<16|65535&a,S=(u=(g>>>16)+(e>>>16)+((s=(65535&g)+(65535&e)+((o=(b>>>16)+(n>>>16)+((a=(65535&b)+(65535&n))>>>16))>>>16))>>>16))<<16|65535&s,_=o<<16|65535&a,G=(u=(z>>>16)+(w>>>16)+((s=(65535&z)+(65535&w)+((o=(H>>>16)+(A>>>16)+((a=(65535&H)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,Z=o<<16|65535&a,z=(u=(S>>>16)+(w>>>16)+((s=(65535&S)+(65535&w)+((o=(_>>>16)+(A>>>16)+((a=(65535&_)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,H=o<<16|65535&a;u=(C>>>16)+(z>>>16)+((s=(65535&C)+(65535&z)+((o=(E>>>16)+(H>>>16)+((a=(65535&E)+(65535&H))>>>16))>>>16))>>>16),this.h0h=u<<16|65535&s,this.h0l=o<<16|65535&a,u=(T>>>16)+(q>>>16)+((s=(65535&T)+(65535&q)+((o=($>>>16)+(Q>>>16)+((a=(65535&$)+(65535&Q))>>>16))>>>16))>>>16),this.h1h=u<<16|65535&s,this.h1l=o<<16|65535&a,u=(x>>>16)+(Y>>>16)+((s=(65535&x)+(65535&Y)+((o=(L>>>16)+(W>>>16)+((a=(65535&L)+(65535&W))>>>16))>>>16))>>>16),this.h2h=u<<16|65535&s,this.h2l=o<<16|65535&a,u=(M>>>16)+(V>>>16)+((s=(65535&M)+(65535&V)+((o=(P>>>16)+(K>>>16)+((a=(65535&P)+(65535&K))>>>16))>>>16))>>>16),this.h3h=u<<16|65535&s,this.h3l=o<<16|65535&a,u=(O>>>16)+(G>>>16)+((s=(65535&O)+(65535&G)+((o=(D>>>16)+(Z>>>16)+((a=(65535&D)+(65535&Z))>>>16))>>>16))>>>16),this.h4h=u<<16|65535&s,this.h4l=o<<16|65535&a,u=(B>>>16)+(X>>>16)+((s=(65535&B)+(65535&X)+((o=(N>>>16)+(tt>>>16)+((a=(65535&N)+(65535&tt))>>>16))>>>16))>>>16),this.h5h=u<<16|65535&s,this.h5l=o<<16|65535&a,u=(j>>>16)+(et>>>16)+((s=(65535&j)+(65535&et)+((o=(R>>>16)+(nt>>>16)+((a=(65535&R)+(65535&nt))>>>16))>>>16))>>>16),this.h6h=u<<16|65535&s,this.h6l=o<<16|65535&a,u=(U>>>16)+(rt>>>16)+((s=(65535&U)+(65535&rt)+((o=(F>>>16)+(it>>>16)+((a=(65535&F)+(65535&it))>>>16))>>>16))>>>16),this.h7h=u<<16|65535&s,this.h7l=o<<16|65535&a},_.prototype.hex=function(){this.finalize();var t=this.h0h,e=this.h0l,n=this.h1h,r=this.h1l,i=this.h2h,a=this.h2l,o=this.h3h,s=this.h3l,u=this.h4h,l=this.h4l,d=this.h5h,f=this.h5l,h=this.h6h,p=this.h6l,v=this.h7h,y=this.h7l,m=this.bits,g=c[t>>>28&15]+c[t>>>24&15]+c[t>>>20&15]+c[t>>>16&15]+c[t>>>12&15]+c[t>>>8&15]+c[t>>>4&15]+c[15&t]+c[e>>>28&15]+c[e>>>24&15]+c[e>>>20&15]+c[e>>>16&15]+c[e>>>12&15]+c[e>>>8&15]+c[e>>>4&15]+c[15&e]+c[n>>>28&15]+c[n>>>24&15]+c[n>>>20&15]+c[n>>>16&15]+c[n>>>12&15]+c[n>>>8&15]+c[n>>>4&15]+c[15&n]+c[r>>>28&15]+c[r>>>24&15]+c[r>>>20&15]+c[r>>>16&15]+c[r>>>12&15]+c[r>>>8&15]+c[r>>>4&15]+c[15&r]+c[i>>>28&15]+c[i>>>24&15]+c[i>>>20&15]+c[i>>>16&15]+c[i>>>12&15]+c[i>>>8&15]+c[i>>>4&15]+c[15&i]+c[a>>>28&15]+c[a>>>24&15]+c[a>>>20&15]+c[a>>>16&15]+c[a>>>12&15]+c[a>>>8&15]+c[a>>>4&15]+c[15&a]+c[o>>>28&15]+c[o>>>24&15]+c[o>>>20&15]+c[o>>>16&15]+c[o>>>12&15]+c[o>>>8&15]+c[o>>>4&15]+c[15&o];return m>=256&&(g+=c[s>>>28&15]+c[s>>>24&15]+c[s>>>20&15]+c[s>>>16&15]+c[s>>>12&15]+c[s>>>8&15]+c[s>>>4&15]+c[15&s]),m>=384&&(g+=c[u>>>28&15]+c[u>>>24&15]+c[u>>>20&15]+c[u>>>16&15]+c[u>>>12&15]+c[u>>>8&15]+c[u>>>4&15]+c[15&u]+c[l>>>28&15]+c[l>>>24&15]+c[l>>>20&15]+c[l>>>16&15]+c[l>>>12&15]+c[l>>>8&15]+c[l>>>4&15]+c[15&l]+c[d>>>28&15]+c[d>>>24&15]+c[d>>>20&15]+c[d>>>16&15]+c[d>>>12&15]+c[d>>>8&15]+c[d>>>4&15]+c[15&d]+c[f>>>28&15]+c[f>>>24&15]+c[f>>>20&15]+c[f>>>16&15]+c[f>>>12&15]+c[f>>>8&15]+c[f>>>4&15]+c[15&f]),512==m&&(g+=c[h>>>28&15]+c[h>>>24&15]+c[h>>>20&15]+c[h>>>16&15]+c[h>>>12&15]+c[h>>>8&15]+c[h>>>4&15]+c[15&h]+c[p>>>28&15]+c[p>>>24&15]+c[p>>>20&15]+c[p>>>16&15]+c[p>>>12&15]+c[p>>>8&15]+c[p>>>4&15]+c[15&p]+c[v>>>28&15]+c[v>>>24&15]+c[v>>>20&15]+c[v>>>16&15]+c[v>>>12&15]+c[v>>>8&15]+c[v>>>4&15]+c[15&v]+c[y>>>28&15]+c[y>>>24&15]+c[y>>>20&15]+c[y>>>16&15]+c[y>>>12&15]+c[y>>>8&15]+c[y>>>4&15]+c[15&y]),g},_.prototype.toString=_.prototype.hex,_.prototype.digest=function(){this.finalize();var t=this.h0h,e=this.h0l,n=this.h1h,r=this.h1l,i=this.h2h,a=this.h2l,o=this.h3h,s=this.h3l,u=this.h4h,l=this.h4l,c=this.h5h,d=this.h5l,f=this.h6h,h=this.h6l,p=this.h7h,v=this.h7l,y=this.bits,m=[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o];return y>=256&&m.push(s>>>24&255,s>>>16&255,s>>>8&255,255&s),y>=384&&m.push(u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d>>>24&255,d>>>16&255,d>>>8&255,255&d),512==y&&m.push(f>>>24&255,f>>>16&255,f>>>8&255,255&f,h>>>24&255,h>>>16&255,h>>>8&255,255&h,p>>>24&255,p>>>16&255,p>>>8&255,255&p,v>>>24&255,v>>>16&255,v>>>8&255,255&v),m},_.prototype.array=_.prototype.digest,_.prototype.arrayBuffer=function(){this.finalize();var t=this.bits,e=new ArrayBuffer(t/8),n=new DataView(e);return n.setUint32(0,this.h0h),n.setUint32(4,this.h0l),n.setUint32(8,this.h1h),n.setUint32(12,this.h1l),n.setUint32(16,this.h2h),n.setUint32(20,this.h2l),n.setUint32(24,this.h3h),t>=256&&n.setUint32(28,this.h3l),t>=384&&(n.setUint32(32,this.h4h),n.setUint32(36,this.h4l),n.setUint32(40,this.h5h),n.setUint32(44,this.h5l)),512==t&&(n.setUint32(48,this.h6h),n.setUint32(52,this.h6l),n.setUint32(56,this.h7h),n.setUint32(60,this.h7l)),e},_.prototype.clone=function(){var t=new _(this.bits,!1);return this.copyTo(t),t},_.prototype.copyTo=function(t){var e=0,n=["h0h","h0l","h1h","h1l","h2h","h2l","h3h","h3l","h4h","h4l","h5h","h5l","h6h","h6l","h7h","h7l","start","bytes","hBytes","finalized","hashed","lastByteIndex"];for(e=0;e<n.length;++e)t[n[e]]=this[n[e]];for(e=0;e<this.blocks.length;++e)t.blocks[e]=this.blocks[e]},k.prototype=new _,k.prototype.finalize=function(){if(_.prototype.finalize.call(this),this.inner){this.inner=!1;var t=this.array();_.call(this,this.bits,this.sharedMemory),this.update(this.oKeyPad),this.update(t),_.prototype.finalize.call(this)}},k.prototype.clone=function(){var t=new k([],this.bits,!1);this.copyTo(t),t.inner=this.inner;for(var e=0;e<this.oKeyPad.length;++e)t.oKeyPad[e]=this.oKeyPad[e];return t};var I=w(512);I.sha512=I,I.sha384=w(384),I.sha512_256=w(256),I.sha512_224=w(224),I.sha512.hmac=S(512),I.sha384.hmac=S(384),I.sha512_256.hmac=S(256),I.sha512_224.hmac=S(224),s?t.exports=I:(a.sha512=I.sha512,a.sha384=I.sha384,a.sha512_256=I.sha512_256,a.sha512_224=I.sha512_224,u&&(void 0===(r=function(){return I}.call(I,n,I,t))||(t.exports=r)))}()},4565(t,e,n){const r=n(6886),i=r.getBCHDigit(1335);e.getEncodedBits=function(t,e){const n=t.bit<<3|e;let a=n<<10;for(;r.getBCHDigit(a)-i>=0;)a^=1335<<r.getBCHDigit(a)-i;return 21522^(n<<10|a)}},4668(t){"use strict";t.exports=function(){function t(t,e,n,r,i){return t<e||n<e?t>n?n+1:t+1:r===i?e:e+1}return function(e,n){if(e===n)return 0;if(e.length>n.length){var r=e;e=n,n=r}for(var i=e.length,a=n.length;i>0&&e.charCodeAt(i-1)===n.charCodeAt(a-1);)i--,a--;for(var o=0;o<i&&e.charCodeAt(o)===n.charCodeAt(o);)o++;if(a-=o,0===(i-=o)||a<3)return a;var s,u,l,c,d,f,h,p,v,y,m,g,b=0,w=[];for(s=0;s<i;s++)w.push(s+1),w.push(e.charCodeAt(o+s));for(var A=w.length-1;b<a-3;)for(v=n.charCodeAt(o+(u=b)),y=n.charCodeAt(o+(l=b+1)),m=n.charCodeAt(o+(c=b+2)),g=n.charCodeAt(o+(d=b+3)),f=b+=4,s=0;s<A;s+=2)u=t(h=w[s],u,l,v,p=w[s+1]),l=t(u,l,c,y,p),c=t(l,c,d,m,p),f=t(c,d,f,g,p),w[s]=f,d=c,c=l,l=u,u=h;for(;b<a;)for(v=n.charCodeAt(o+(u=b)),f=++b,s=0;s<A;s+=2)h=w[s],w[s]=f=t(h,u,f,v,w[s+1]),u=h;return f}}()},4713(t,e,n){const r=n(2731);e.mul=function(t,e){const n=new Uint8Array(t.length+e.length-1);for(let i=0;i<t.length;i++)for(let a=0;a<e.length;a++)n[i+a]^=r.mul(t[i],e[a]);return n},e.mod=function(t,e){let n=new Uint8Array(t);for(;n.length-e.length>=0;){const t=n[0];for(let i=0;i<e.length;i++)n[i]^=r.mul(e[i],t);let i=0;for(;i<n.length&&0===n[i];)i++;n=n.slice(i)}return n},e.generateECPolynomial=function(t){let n=new Uint8Array([1]);for(let i=0;i<t;i++)n=e.mul(n,new Uint8Array([1,r.exp(i)]));return n}},4764(t,e,n){const r=n(4713);function i(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(t){this.degree=t,this.genPoly=r.generateECPolynomial(this.degree)},i.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=r.mod(e,this.genPoly),i=this.degree-n.length;if(i>0){const t=new Uint8Array(this.degree);return t.set(n,i),t}return n},t.exports=i},4861(t,e,n){const r=n(208),i=n(6886);function a(t){this.mode=r.KANJI,this.data=t}a.getBitsLength=function(t){return 13*t},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=i.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13)}},t.exports=a},5822(t,e,n){const r=n(208);function i(t){this.mode=r.BYTE,this.data="string"==typeof t?(new TextEncoder).encode(t):new Uint8Array(t)}i.getBitsLength=function(t){return 8*t},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)},t.exports=i},6320(t){"use strict";var e={single_source_shortest_paths:function(t,n,r){var i={},a={};a[n]=0;var o,s,u,l,c,d,f,h=e.PriorityQueue.make();for(h.push(n,0);!h.empty();)for(u in s=(o=h.pop()).value,l=o.cost,c=t[s]||{})c.hasOwnProperty(u)&&(d=l+c[u],f=a[u],(void 0===a[u]||f>d)&&(a[u]=d,h.push(u,d),i[u]=s));if(void 0!==r&&void 0===a[r]){var p=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(p)}return i},extract_shortest_path_from_predecessor_list:function(t,e){for(var n=[],r=e;r;)n.push(r),t[r],r=t[r];return n.reverse(),n},find_path:function(t,n,r){var i=e.single_source_shortest_paths(t,n,r);return e.extract_shortest_path_from_predecessor_list(i,r)},PriorityQueue:{make:function(t){var n,r=e.PriorityQueue,i={};for(n in t=t||{},r)r.hasOwnProperty(n)&&(i[n]=r[n]);return i.queue=[],i.sorter=t.sorter||r.default_sorter,i},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var n={value:t,cost:e};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e},6421(t,e,n){const r=n(6886).getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];const e=Math.floor(t/7)+2,n=r(t),i=145===n?26:2*Math.ceil((n-13)/(2*e-2)),a=[n-7];for(let t=1;t<e-1;t++)a[t]=a[t-1]-i;return a.push(6),a.reverse()},e.getPositions=function(t){const n=[],r=e.getRowColCoords(t),i=r.length;for(let t=0;t<i;t++)for(let e=0;e<i;e++)0===t&&0===e||0===t&&e===i-1||t===i-1&&0===e||n.push([r[t],r[e]]);return n}},6861(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function a(t){for(var e=0;e<t.length;e++)for(var n=e+1;n<t.length;n++)if(t[e]===t[n])return!1;return!0}function o(t,e){var n=[];if(t.length<=e.length){var i,a=r(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;e.indexOf(o)>-1&&n.push(o)}}catch(t){a.e(t)}finally{a.f()}}else{var s,u=r(e);try{for(u.s();!(s=u.n()).done;){var l=s.value;t.indexOf(l)>-1&&n.push(l)}}catch(t){u.e(t)}finally{u.f()}}return n}function s(t,e,n,r){var i=n*Math.PI/180-t*Math.PI/180,a=r*Math.PI/180-e*Math.PI/180,o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 1e3*(6378.137*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))}function u(t){for(var e=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=0;t>=1e3&&n<e.length-1;)t/=1e3,n++;return`${Math.floor(100*t)/100} ${e[n]}`}function l(t){for(var e="";t>0;){var n=(t-1)%26;e=String.fromCharCode(n+65)+e,t=Math.floor((t-1)/26)}return e}function c(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return d(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function f(t){for(var e=[],n=0;n<t;n++)e.push(`地點${l(n+1)}`);return e}function h(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return p(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function v(t){var e=[{suffixes:"市",key:"city",process:function(t){return null===t?null:t.map(function(t){return t.trim()})},type:0},{suffixes:"區",key:"district",process:function(t){return null===t?null:t.map(function(t){return t.trim()})},type:0},{suffixes:"鄉鎮村里",key:"area",process:function(t){return null===t?null:t.map(function(t){return t.trim()})},type:0},{suffixes:"路街道",key:"road",process:function(t){return null===t?null:t.map(function(t){return t.replaceAll(/[\(\)（）]/gim,"").trim()})},type:0},{suffixes:"段",key:"road_section",process:function(t){for(var e=function(t){switch(t){case"一":return 1;case"二":return 2;case"三":return 3;case"四":return 4;case"五":return 5;case"六":return 6;case"七":return 7;case"八":return 8;case"九":return 9;case"十":return 10}return isNaN(parseInt(t))?0:parseInt(t)},n=String(t).length,r=[],i=0;i<n;i++){var a=e(String(t).charAt(i));10===a?r.length>0&&(r=[10*r.reduce(function(t,e){return t+e},0)]):r=[r.reduce(function(t,e){return t+e},0)+a]}return r},type:0},{suffixes:"巷",key:"alley",process:function(t){return null===t?null:t.map(function(t){return parseInt(t.trim().replaceAll(/[巷]/gim))})},type:0},{suffixes:"弄",key:"alley_branch",process:function(t){return null===t?null:t.map(function(t){return parseInt(t.trim().replaceAll(/[弄]/gim))})},type:0},{suffixes:"號",key:"doorplate",process:function(t){var e,n=String(t).match(/[0-9]+/gim);return n=(null===(e=n)||void 0===e?void 0:e.map(function(t){return null===t?null:parseInt(t)}))||null},type:0},{suffixes:"樓",key:"floornumber",process:function(t){return null===t?null:t.map(function(t){return t.trim()})},type:0},{key:"exit",process:function(t){return null===t?null:t.map(function(t){return t.trim()})},type:2},{key:"direction",process:function(t){return null===t?null:t.map(function(t){return t.trim().replace(/[往向]/gim,"")})},type:1}];function n(t){function n(t,e){return 0===e?new RegExp(`([^市區鄉鎮村里路段街道巷弄號樓與]+[${t}])`,"gmi"):1===e?new RegExp("([往向]+[東南西北])","gmi"):2===e?new RegExp("([0-9]+[號]出口)","gmi"):void 0}for(var r={},i=0,a=e;i<a.length;i++){var o,s=a[i],u=n(null===(o=s)||void 0===o?void 0:o.suffixes,s.type);r[s.key]=s.process(String(t).match(u))}return r}return function(t){var r,i={},a=h(t);try{for(a.s();!(r=a.n()).done;)for(var o=n(r.value),s=0,u=e;s<u.length;s++){var l=u[s];i.hasOwnProperty(l.key)||(i[l.key]=[]),i[l.key]=i[l.key].concat(o[l.key])}}catch(t){a.e(t)}finally{a.f()}for(var c in i)i[c]=Array.from(new Set(i[c])).filter(function(t){return!!t}).sort(function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:String(t).charCodeAt(0)-String(e).charCodeAt(0)});return i}(t)}function y(t){return`${t.city.join("")}${t.district.join("")}${t.road.join("、")}${t.road_section.sort(function(t,e){return t-e}).length>0?t.road_section.join("、")+"段":""}${t.alley.length>0?t.alley.sort(function(t,e){return t-e}).join("、")+"巷":""}${t.alley_branch.length>0?t.alley_branch.sort(function(t,e){return t-e}).join("、")+"弄":""}${t.doorplate.length>0?t.doorplate.sort(function(t,e){return t-e}).join("、")+"號":""}${t.floornumber.length>0?t.floornumber.join("、")+"樓":""}${t.direction.length>0?"（朝"+t.direction.join("、")+"）":""}`}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function g(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function b(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function o(t){g(a,r,i,o,s,"next",t)}function s(t){g(a,r,i,o,s,"throw",t)}o(void 0)})}}function w(t,e,n,r){var i=new Date;return i.setDate(1),i.setMonth(0),i.setHours(n),i.setMinutes(r),i.setSeconds(0),i.setMilliseconds(0),i.setFullYear(t.getFullYear()),i.setMonth(t.getMonth()),i.setDate(t.getDate()),i.setDate(i.getDate()+e),i}function A(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss").replaceAll(/Y{4,4}/g,t.getFullYear()).replaceAll(/M{2,2}/g,String(t.getMonth()+1).padStart(2,"0")).replaceAll(/D{2,2}/g,String(t.getDate()).padStart(2,"0")).replaceAll(/h{2,2}/g,String(t.getHours()).padStart(2,"0")).replaceAll(/m{2,2}/g,String(t.getMinutes()).padStart(2,"0")).replaceAll(/s{2,2}/g,String(t.getSeconds()).padStart(2,"0"))}function S(t){var e=t.getTime(),n=Math.floor(((new Date).getTime()-e)/1e3),r=Math.floor(n/31536e3);return r>=1?`${r}年前`:(r=Math.floor(n/2592e3))>=1?`${r}個月前`:(r=Math.floor(n/86400))>=1?`${r}天前`:(r=Math.floor(n/3600))>=1?`${r}小時前`:(r=Math.floor(n/60))>=1?`${r}分鐘前`:n>0?`${n}秒前`:"現在"}function _(t,e){var n=0|t;switch(e){case 0:return`${n}秒`;case 1:return[String((n-n%60)/60),String(n%60)].map(function(t){return t.padStart(2,"0")}).join(":");case 2:return`${n/60|0}分`;case 3:if(n>=3600)return`${parseFloat((n/3600).toFixed(1))}時`;if(60<=n&&n<3600)return`${n/60|0}分`;if(n<60)return`${n}秒`;break;default:return"--"}}function k(t){return[{name:"日",day:0,code:"d_0"},{name:"一",day:1,code:"d_1"},{name:"二",day:2,code:"d_2"},{name:"三",day:3,code:"d_3"},{name:"四",day:4,code:"d_4"},{name:"五",day:5,code:"d_5"},{name:"六",day:6,code:"d_6"}][t]}function I(t){return k(parseInt(t)-1)}function C(t){return`${String(t.hours).padStart(2,"0")}:${String(t.minutes).padStart(2,"0")}`}var E=n(3790),T={cacheStore:!1,settingsStore:!1,dataUsageStatsStore:!1,updateRateDataStore:!1,updateRateDataWriteAheadLogStore:!1,busArrivalTimeDataWriteAheadLogStore:!1,busArrivalTimeDataStore:!1,personalScheduleStore:!1,recentViewsStore:!1,notificationStore:!1,notificationScheduleStore:!1,folderListStore:!1,folderContentIndexStore:!1,folderContentStore:!1},$=["cacheStore","settingsStore","dataUsageStatsStore","updateRateDataStore","updateRateDataWriteAheadLogStore","busArrivalTimeDataWriteAheadLogStore","busArrivalTimeDataStore","personalScheduleStore","recentViewsStore","notificationStore","notificationScheduleStore","folderListStore","folderContentIndexStore","folderContentStore"];function x(t,e,n){return L.apply(this,arguments)}function L(){return(L=b(function*(t,e,n){try{var r=$[t];return!1===T[r]&&(T[r]=yield E.createInstance({name:r})),yield T[r].setItem(e,n)}catch(t){return null}})).apply(this,arguments)}function M(t,e){return P.apply(this,arguments)}function P(){return(P=b(function*(t,e){try{var n=$[t];return!1===T[n]&&(T[n]=yield E.createInstance({name:n})),yield T[n].getItem(e)}catch(t){return null}})).apply(this,arguments)}function O(t,e){return D.apply(this,arguments)}function D(){return(D=b(function*(t,e){try{var n=$[t];return!1===T[n]&&(T[n]=yield E.createInstance({name:n})),yield T[n].removeItem(e)}catch(t){return null}})).apply(this,arguments)}function B(t){return N.apply(this,arguments)}function N(){return(N=b(function*(t){try{var e=$[t];return!1===T[e]&&(T[e]=yield E.createInstance({name:e})),yield T[e].keys()}catch(t){return[]}})).apply(this,arguments)}function j(){return R.apply(this,arguments)}function R(){return(R=b(function*(){if(navigator.storage&&navigator.storage.persist)return yield navigator.storage.persisted();return!1})).apply(this,arguments)}function U(){return(U=b(function*(){if(navigator.storage&&navigator.storage.persist)return(yield navigator.storage.persist())?"granted":"denied";return"unsupported"})).apply(this,arguments)}function F(){return(F=b(function*(t,e){var n=`d_${A(e,"YYYY_MM_DD")}`,r=60*e.getHours()+e.getMinutes(),i=yield M(2,n);if(i){var a=JSON.parse(i);a.stats.sum+=t,a.data[r]+=t;var o=a.data[r];o>a.stats.max&&(a.stats.max=o),o<a.stats.min&&(a.stats.min=o),yield x(2,n,JSON.stringify(a))}else{var s={},u=new Uint32Array(1440);u[r]+=t,s.data=Array.from(u),s.stats={sum:t,max:t,min:0},s.date=[e.getFullYear(),e.getMonth()+1,e.getDate()],yield x(2,n,JSON.stringify(s))}})).apply(this,arguments)}function J(){return(J=b(function*(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);for(var e=w(t,-7,0,0),n=[],r=1;r<=7;r++){var i=w(e,r,0,0),a=`d_${A(i,"YYYY_MM_DD")}`,o=yield M(2,a);if(o){var s=JSON.parse(o);n.push(s)}else{var u={},l=new Uint32Array(1440);u.data=Array.from(l),u.stats={sum:0,max:0,min:0},u.date=[i.getFullYear(),i.getMonth()+1,i.getDate()],n.push(u)}}return n})).apply(this,arguments)}function z(){return z=b(function*(t,e,r){var i=new Worker(new URL(n.p+n.u(818),n.b)),a=yield function(){return J.apply(this,arguments)}();return yield new Promise(function(n,o){i.onmessage=function(t){n(t.data),i.terminate()},i.onerror=function(t){o(t.message),i.terminate()},i.postMessage([a,t,e,r])})}),z.apply(this,arguments)}function H(t){return document.querySelector(t)}function q(t){return document.querySelectorAll(t)}function Q(t,e){return t.querySelector(e)}function Y(t,e){return t.querySelectorAll(e)}function W(t,e){for(var n=[],r=t.nextElementSibling;r;)r.classList.contains(e)&&n.push(r),r=r.nextElementSibling;return n}function V(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4,i=["blobbus","ntpcbus"],a=["BusData","BusEvent","CarInfo","CarUnusual","EstimateTime","IStop","IStopPath","OrgPathAttribute","PathDetail","Provider","Route","Stop","SemiTimeTable","StopLocation","TimeTable","BusRouteFareList"],o=Dd("proxy");return n?`http://erichsia7.github.io/bus-alternative-static-apis/${i[t]}/Get${a[e]}.gz?_=${zd(r)}`:o?`https://bus-proxy.erichsia7.workers.dev?url=https://tcgbusfs.blob.core.windows.net/${i[t]}/Get${a[e]}.gz&_=${zd(r)}`:`https://tcgbusfs.blob.core.windows.net/${i[t]}/Get${a[e]}.gz?_=${zd(r)}`}var K,G=n(3453),Z={};if("undefined"!=typeof SharedWorker){var X=new SharedWorker(new URL(n.p+n.u(444),n.b));(K=X.port).start()}else{var tt=new Worker(new URL(n.p+n.u(444),n.b));K=tt}function et(){return(et=b(function*(t){var e=Jd();return yield new Promise(function(n,r){Z[e]=n,K.onerror=function(t){r(t.message)},K.postMessage([t,e])})})).apply(this,arguments)}function nt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return rt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}K.onmessage=function(t){var e=(0,G.A)(t.data,2),n=e[0],r=e[1];Z[r]&&(Z[r](n),delete Z[r])},K.onerror=function(t){};var it={},at=new Error("FetchError");function ot(t,e,n,r){return st.apply(this,arguments)}function st(){return st=b(function*(t,e,n,r){if(it.hasOwnProperty(t)){if(it[t].processing)return yield new Promise(function(r,i){it[t].requests.push([r,i,e,n])});if(null!==it[t].result&&(new Date).getTime()<=it[t].timestamp)return ct(e,n,0,!0),it[t].result}else it[t]={processing:!0,requests:[],failed:!1,timestamp:-1,result:null};var i=yield fetch(t);if(!i.ok)throw ct(e,n,0,!0),new Error(`HTTP error! status: ${i.status}`);for(var a=parseInt(String(i.headers.get("content-length"))),o=i.body.getReader(),s=[],u=0;;){var l=yield o.read(),c=l.done,d=l.value;if(c)break;s.push(d);var f=(u+=d.length)/a;if(ct(e,n,f,!1),it.hasOwnProperty(t)){var h,p=nt(it[t].requests);try{for(p.s();!(h=p.n()).done;){var v=h.value;ct(v[2],v[3],f,!1)}}catch(t){p.e(t)}finally{p.f()}}}for(var y=new Uint8Array(u),m=0,g=0,b=s;g<b.length;g++){var w=b[g];y.set(w,m),m+=w.length}var A,S=new Blob([y],{type:"application/gzip"}),_=yield S.arrayBuffer(),k=yield function(t){return et.apply(this,arguments)}(_);switch(r){case"json":A=/^<!doctype html>/.test(k)?yield ot(t.replace("https://tcgbusfs.blob.core.windows.net/","https://erichsia7.github.io/bus-alternative-static-apis/"),e,n,r):JSON.parse(k);break;case"xml":A=k}var I=new Date;if(yield function(t,e){return F.apply(this,arguments)}(a,I),A){if(it.hasOwnProperty(t)){for(var C=u/a,E=it[t].requests.shift();E;)E[0](A),ct(E[2],E[3],C,!1),E=it[t].requests.shift();it[t].result=A,it[t].timestamp=I.getTime()+3e4,it[t].processing=!1}return ut(),A}if(it.hasOwnProperty(t)){for(var T=it[t].requests.shift();T;)T[1](at),ct(T[2],T[3],0,!0),T=it[t].requests.shift();it[t].failed=!0}throw ut(),at}),st.apply(this,arguments)}function ut(){var t=(new Date).getTime();for(var e in it)if(it.hasOwnProperty(e)){if(!it[e].processing&&t>it[e].timestamp){delete it[e];continue}if(it[e].failed){delete it[e];continue}}}var lt={};function ct(t,e,n,r){lt.hasOwnProperty(t)||(lt[t]={}),lt[t].hasOwnProperty(e)?(r?lt[t][e].expel=!0:(lt[t][e].expel=!1,lt[t][e].progress=n),ht(t,"run")):(lt[t][e]={expel:!1,progress:n,total:1},ht(t,"start"))}function dt(t){if(lt.hasOwnProperty(t)&&"object"===m(lt[t])){var e=0,n=0;for(var r in lt[t])lt[t][r].expel||(e+=lt[t][r].total,n+=lt[t][r].progress);var i=Math.min(Math.max(n/e,0),1);return i===1/0||isNaN(i)?1:i}return 1}function ft(t){lt.hasOwnProperty(t)&&(delete lt[t],ht(t,"end"))}function ht(t,e){var n={target:t,stage:e,progress:dt(t)},r=new CustomEvent(t,{detail:n});document.dispatchEvent(r)}var pt={};function vt(t,e){pt.hasOwnProperty(t)||(pt[t]=0);var n=0;"string"==typeof e&&(n=function(t){var e=t.match(/[0-9\.]*/gm);if(e){var n=parseInt(e[0]),r=parseInt(e[2]),i=parseInt(e[4]),a=parseInt(e[6]),o=parseInt(e[8]),s=parseInt(e[10]),u=new Date;return u.setDate(1),u.setMonth(0),u.setFullYear(n),u.setMonth(r-1),u.setDate(i),u.setHours(a),u.setMinutes(o),u.setSeconds(s),u.getTime()}return 0}(e)),n>pt[t]&&(pt[t]=n)}function yt(t){return pt.hasOwnProperty(t)?1*pt[t]:0}function mt(t){pt.hasOwnProperty(t)&&delete pt[t]}function gt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return bt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function wt(t){return At.apply(this,arguments)}function At(){return(At=b(function*(t){var e,n=[],r=gt([[0,0],[1,0]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getBusData_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n})).apply(this,arguments)}function St(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return _t(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_t(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function kt(t){return It.apply(this,arguments)}function It(){return(It=b(function*(t){var e,n=[],r=St([[0,1],[1,1]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getBusEvent_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n})).apply(this,arguments)}function Ct(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Et(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Et(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Tt={raw:{data:[],available:!1},simplified:{data:{},available:!1}};function $t(t){return xt.apply(this,arguments)}function xt(){return(xt=b(function*(t){var e=new Worker(new URL(n.p+n.u(439),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function Lt(t){return Mt.apply(this,arguments)}function Mt(){return Mt=b(function*(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(){return r.apply(this,arguments)}function r(){return r=b(function*(){var e,n=[],r=Ct([[0,2],[1,2]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getCarInfo_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),r.apply(this,arguments)}var i=e?"simplified":"raw",a=`bus_${i}_car_info_cache`,o=yield M(0,`${a}_timestamp`);if(null===o){var s,u=yield n();return s=e?yield $t(u):u,yield x(0,`${a}_timestamp`,(new Date).getTime()),yield x(0,a,JSON.stringify(s)),Tt[i].available||(Tt[i].available=!0,Tt[i].data=s),s}if((new Date).getTime()-parseInt(o)>2592e6){var l,c=yield n();return l=e?yield $t(c):c,yield x(0,`${a}_timestamp`,(new Date).getTime()),yield x(0,a,JSON.stringify(l)),l}if(!Tt[i].available){var d=yield M(0,a);Tt[i].available=!0,Tt[i].data=JSON.parse(d)}return ct(t,"getCarInfo_0",0,!0),ct(t,"getCarInfo_1",0,!0),vt(t,-1),Tt[i].data}),Mt.apply(this,arguments)}function Pt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ot(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Dt={simplified:{available:!1,data:{}},merged:{available:!1,data:{}},indexed:{available:!1,data:{}}};function Bt(t){return Nt.apply(this,arguments)}function Nt(){return(Nt=b(function*(t){var e=new Worker(new URL(n.p+n.u(454),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function jt(t){return Rt.apply(this,arguments)}function Rt(){return(Rt=b(function*(t){var e=new Worker(new URL(n.p+n.u(473),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function Ut(t){return Ft.apply(this,arguments)}function Ft(){return(Ft=b(function*(t){var e=new Worker(new URL(n.p+n.u(757),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function Jt(t,e){return zt.apply(this,arguments)}function zt(){return zt=b(function*(t,e){function n(){return r.apply(this,arguments)}function r(){return r=b(function*(){var e,n=[],r=Pt([[0,11],[1,11]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getLocation_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),r.apply(this,arguments)}var i=["simplified","merged","indexed"][e],a=`bus_${i}_location_cache`,o=yield M(0,`${a}_timestamp`);if(null===o){var s;switch(e){case 0:var u=yield n();s=yield Bt(u);break;case 1:var l=yield Jt(t,0);s=yield jt(l);break;case 2:var c=yield Jt(t,1);s=yield Ut(c)}return yield x(0,`${a}_timestamp`,(new Date).getTime()),yield x(0,a,JSON.stringify(s)),Dt[i].available||(Dt[i].available=!0,Dt[i].data=s),s}if((new Date).getTime()-parseInt(o)>2592e6){var d;switch(e){case 0:var f=yield n();d=yield Bt(f);break;case 1:var h=yield Jt(t,0);d=yield jt(h);break;case 2:var p=yield Jt(t,1);d=yield Ut(p)}return yield x(0,`${a}_timestamp`,(new Date).getTime()),yield x(0,a,JSON.stringify(d)),Dt[i].available||(Dt[i].available=!0,Dt[i].data=d),d}if(!Dt[i].available){var v=yield M(0,a);Dt[i].available=!0,Dt[i].data=JSON.parse(v)}return ct(t,"getLocation_0",0,!0),ct(t,"getLocation_1",0,!0),vt(t,-1),Dt[i].data}),zt.apply(this,arguments)}function Ht(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return qt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function qt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Qt=!1,Yt={};function Wt(t){return Vt.apply(this,arguments)}function Vt(){return(Vt=b(function*(t){var e=new Worker(new URL(n.p+n.u(661),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function Kt(t){return Gt.apply(this,arguments)}function Gt(){return Gt=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e,n=[],r=Ht([[0,11],[1,11]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getStop_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),n.apply(this,arguments)}var r="bus_stop_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e(),o=yield Wt(a);return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(o)),Qt||(Qt=!0,Yt=o),o}if((new Date).getTime()-parseInt(i)>3888e6){var s=yield e(),u=yield Wt(s);return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(u)),u}if(!Qt){var l=yield M(0,r);Qt=!0,Yt=JSON.parse(l)}return ct(t,"getStop_0",0,!0),ct(t,"getStop_1",0,!0),vt(t,-1),Yt}),Gt.apply(this,arguments)}function Zt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Xt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function te(t,e){if("string"==typeof t){var n=parseInt(t);if(-3===n)return{code:6,text:"末班駛離",time:n};if(-4===n)return{code:5,text:"今日停駛",time:n};if(-2===n)return{code:4,text:"交通管制",time:n};if(-1===n)return{code:3,text:"未發車",time:n};if(0<=n&&n<=10)return{code:2,text:"進站中",time:n};if(10<n&&n<=180)return{code:1,text:_(n,e),time:n};if(180<n&&n<=250)return{code:.5,text:_(n,e),time:n};if(250<n)return{code:0,text:_(n,e),time:n}}return{code:7,text:"發生錯誤",time:-5}}function ee(t,e){var n=t.length;if(0===e){var r=0,i=0;return 4===n&&(r=parseInt(t.substring(0,2)),i=parseInt(t.substring(2,4))),2===n&&(i=parseInt(t)),{type:"moment",hours:r,minutes:i}}if(1===e){var a=0,o=0;if(4===n){var s=parseInt(t.substring(0,2)),u=parseInt(t.substring(2,4));a=Math.min(s,u),o=Math.max(s,u)}if(2===n){var l=parseInt(t);a=l,o=l}return{type:"range",min:a,max:o}}}function ne(t){var e="";switch(t){case"0":e="一般";break;case"1":e="低底盤";break;case"2":e="大復康巴士";break;case"3":e="狗狗友善專車";break;default:e="未知類型"}return e}function re(t){var e="";switch(t){case"0":e="離站";break;case"1":e="進站";break;default:e="未知狀態"}return e}function ie(t){var e="";switch(t){case"0":e="正常";break;case"1":e="車禍";break;case"2":e="故障";break;case"3":e="塞車";break;case"4":e="緊急求援";break;case"5":e="加油";break;case"99":e="非營運狀態";break;default:e="未知狀態"}return e}function ae(t){var e={},n=ne(t.CarType);e.type=n;var r=re(t.CarOnStop),i=ie(t.BusStatus);return e.carNumber=t.BusID,e.status={onStop:r,situation:i,text:`${r} | ${i}`},e.RouteName=t.RouteName,e.onThisRoute=t.onThisRoute,e.index=t.index,e.position=t.position,e}function oe(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[];if("string"==typeof t)for(var r=t.length,i=0;i<r;i++){var a=t.charCodeAt(i);(n.indexOf(a)<0||!e)&&n.push(a)}return n}function se(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ue(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var le=!1,ce={};function de(t){return fe.apply(this,arguments)}function fe(){return(fe=b(function*(t){var e=new Worker(new URL(n.p+n.u(36),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function he(t){return pe.apply(this,arguments)}function pe(){return pe=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e,n=[],r=se([[0,10],[1,10]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getRoute_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),n.apply(this,arguments)}if(!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]))return yield e();var r="bus_route_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e(),o=yield de(a);return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(o)),le||(le=!0,ce=o),o}if((new Date).getTime()-parseInt(i)>864e5){var s=yield e(),u=yield de(s);return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(u)),le||(le=!0,ce=u),u}if(!le){var l=yield M(0,r);le=!0,ce=JSON.parse(l)}return ct(t,"getRoute_0",0,!0),ct(t,"getRoute_1",0,!0),vt(t,-1),ce}),pe.apply(this,arguments)}function ve(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ye(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function me(t){return ge.apply(this,arguments)}function ge(){return(ge=b(function*(t){var e,n=Jd(),r=yield he(n,!0),i=`r_${t}`;return!!r.hasOwnProperty(i)&&(e=r[i],ft(n),mt(n),e)})).apply(this,arguments)}function be(){return(be=b(function*(t){var e=Jd(),n=yield he(e,!0),r=[];for(var i in n){var a=n[i];String(a.pid).indexOf(t)>-1&&r.push(a)}return ft(e),mt(e),r})).apply(this,arguments)}var we={},Ae=[],Se=!1;function _e(){return(_e=b(function*(){if(!Se){var t=Jd(),e=yield he(t,!0),n=yield Jt(t,1),r=yield Lt(t,!0);ft(t),mt(t);var i={},a=[],o=0;for(var s in e){var u=e[s],l={id:u.id,pid:u.pid,dep:u.dep,des:u.des,n:u.n,hash:"",lo:"",la:"",r:"",s:"",type:0};a.push(l);var c,d=ve(oe(`${l.n.toLowerCase()}${l.dep.toLowerCase()}${l.des.toLowerCase()}`,!0));try{for(d.s();!(c=d.n()).done;){var f=`u_${c.value}`;i.hasOwnProperty(f)||(i[f]=[]),i[f].push(o)}}catch(t){d.e(t)}finally{d.f()}o+=1}for(var h in n){var p=n[h],v={id:p.id,n:p.n,lo:p.lo,la:p.la,r:p.r,s:p.s,hash:p.hash,dep:"",des:"",pid:[],type:1};a.push(v);var y,m=ve(oe(v.n.toLowerCase(),!0));try{for(m.s();!(y=m.n()).done;){var g=`u_${y.value}`;i.hasOwnProperty(g)||(i[g]=[]),i[g].push(o)}}catch(t){m.e(t)}finally{m.f()}o+=1}for(var b in r){var w=r[b],A={id:w.BusId,pid:[],dep:"",des:"",n:w.CarNum,hash:"",lo:"",la:"",r:"",s:"",type:2};a.push(A);var S,_=ve(oe(A.n.toLowerCase(),!0));try{for(_.s();!(S=_.n()).done;){var k=`u_${S.value}`;i.hasOwnProperty(k)||(i[k]=[]),i[k].push(o)}}catch(t){_.e(t)}finally{_.f()}o+=1}we=i,Ae=a,Se=!0}})).apply(this,arguments)}function ke(t,e){var n,r=0,i=0,a=ve(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r+=t.indexOf(o,i)-i,i+=1}}catch(t){a.e(t)}finally{a.f()}return t===e&&(r=10*Math.abs(r)),r}function Ie(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ce(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ce(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ee(){return Ee=b(function*(t,e){var n=`c_${t}`,r=yield Lt(e,!0),i=yield wt(e),a=yield kt(e),o=yield Kt(e),s=yield Jt(e,0),u={properties:[],LocationName:""},l={};if(!r.hasOwnProperty(n))return u;var c=(l=r[n]).CarNum;u.properties.push({key:"car_number",icon:"tag",value:c});var d=ne(l.CarType);u.properties.push({key:"car_type",icon:"directions_bus",value:d});var f,h={},p=Ie(i);try{for(p.s();!(f=p.n()).done;){var v=f.value;if(v.BusID===c){h=v;break}}}catch(t){p.e(t)}finally{p.f()}var y,m=parseInt(h.RouteID),g=ie(h.BusStatus),b=parseInt(h.GoBack),w={},A=Ie(a);try{for(A.s();!(y=A.n()).done;){var S=y.value;if(S.BusID===c){w=S;break}}}catch(t){A.e(t)}finally{A.f()}var _=re(w.CarOnStop);u.properties.push({key:"status",icon:"vital_signs",value:`${_} | ${g}`});var k=w.StopID,I=yield function(t){return be.apply(this,arguments)}(m),C={};if(!(I.length>0))return u;var E=(C=I[0]).id,T=C.pid,$=C.n,x=C.dep,L=[C.des,x,""][b||0];u.properties.push({key:"route",icon:"route",value:`${$} - 往${L}`}),u.RouteID=E,u.FullPathAttributeId=T;var M=`s_${k}`;if(!o.hasOwnProperty(M))return u;var P=s[`l_${o[M].stopLocationId}`].n;return u.properties.push({key:"location_name",icon:"location_on",value:P}),ft(e),mt(e),u}),Ee.apply(this,arguments)}function Te(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $e(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function $e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xe(){return Le.apply(this,arguments)}function Le(){return(Le=b(function*(){var t,e=[],n=(new Date).getTime(),r=Te(yield B(8));try{for(r.s();!(t=r.n()).done;){var i=t.value,a=yield M(8,i),o=JSON.parse(a);n-new Date(o.time).getTime()<=12096e5&&e.push(o)}}catch(t){r.e(t)}finally{r.f()}return 0===e.length&&e.push({type:"empty",time:(new Date).toISOString(),name:"沒有內容",id:0}),e})).apply(this,arguments)}function Me(t,e){return Pe.apply(this,arguments)}function Pe(){return(Pe=b(function*(t,e){var n=Jd(),r=`${t}_${e}`,i=(new Date).toISOString(),a=yield M(8,r);if(a){var o=JSON.parse(a);o.time=i,yield x(8,r,JSON.stringify(o))}else switch(t){case"route":var s=yield he(n,!0),u=`r_${e}`;if(s.hasOwnProperty(u)){var l={type:"route",time:i,name:s[u].n,id:e};yield x(8,r,JSON.stringify(l))}break;case"location":var c=yield Jt(n,1),d=`ml_${e}`;if(c.hasOwnProperty(d)){var f={type:"location",time:i,name:c[d].n,hash:e};yield x(8,r,JSON.stringify(f))}break;case"bus":var h=yield Lt(n,!0),p=`c_${e}`;if(h.hasOwnProperty(p)){var v={type:"bus",time:i,name:h[p].CarNum,id:e};yield x(8,r,JSON.stringify(v))}}})).apply(this,arguments)}function Oe(t,e){return De.apply(this,arguments)}function De(){return(De=b(function*(t,e){var n=`${t}_${e}`,r=yield M(8,n);return!!r&&JSON.parse(r)})).apply(this,arguments)}function Be(t){return`<span class="a">${t}</span>`}function Ne(t){var e=document.createElement("span");return e.classList.add("a"),e.innerText=t,e}function je(){var t=document.createElement("span");return t.classList.add("a"),t}function Re(t,e){Q(t,"span.a").innerText=e}var Ue=[],Fe=!1,Je=!1;function ze(){var t=document.createElement("div");t.classList.add("b");var e=document.createElement("div");e.classList.add("c"),e.appendChild(je());var n=document.createElement("div");return n.classList.add("d"),t.appendChild(e),t.appendChild(n),{element:t,id:""}}function He(t,e,n){function r(t,r,i){function a(t,e){Re(Q(t,".c"),e.icon)}function o(t,e){Q(t,".d").innerText=e.value}function s(t,e){t.setAttribute("animation",e)}function u(t,e){t.setAttribute("skeleton-screen",e)}null==i?(a(t,r),o(t,r),u(t,e),s(t,n)):(Fd(i,r)||a(t,r),Fd(i,r)||o(t,r),e!==Fe&&u(t,e),n!==Je&&s(t,n))}var i=t.length,a=Y(Ve,".b").length;if(i!==a){var o=a-i;if(o<0){for(var s=new DocumentFragment,u=0,l=Math.abs(o);u<l;u++){var c=ze();s.appendChild(c.element)}Ve.append(s)}else for(var d=Y(Ve,".b"),f=0,h=Math.abs(o);f<h;f++){d[a-1-f].remove()}}for(var p=Y(Ve,".b"),v=0;v<i;v++){var y=p[v],m=t[v];0===Ue.length?r(y,m,null):r(y,m,Ue[v])}Ue=t,Je=n,Fe=e}var qe=H(".e"),Qe=(Q(qe,".f"),Q(qe,".g")),Ye=Q(Qe,".h"),We=Q(Ye,'.i[group="properties"]'),Ve=Q(We,".j");Q(Ye,'.i[group="location"]');function Ke(t){mc("Bus"),Me("bus",t),qe.setAttribute("displayed","true"),function(t){Ge.apply(this,arguments)}(t),bc()}function Ge(){return Ge=b(function*(t){!function(){for(var t=Dd("playing_animation"),e=[],n=0;n<5;n++)e.push({key:n,icon:"",value:""});He(e,!0,t)}();var e=Dd("playing_animation"),n=Jd(),r=yield function(t,e){return Ee.apply(this,arguments)}(t,n);He(r.properties,!1,e)}),Ge.apply(this,arguments)}function Ze(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Xe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xe(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Xe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function tn(t,e,n,r,i,a){return en.apply(this,arguments)}function en(){return(en=b(function*(t,e,n,r,i,a){var o=Jd();if(e<0||e>23||n<0||n>59||r<0||r>23||i<0||i>59)return!1;if(!(Number.isInteger(e)&&Number.isInteger(n)&&Number.isInteger(r)&&Number.isInteger(i)))return!1;if(a.length>7)return!1;var s,u=Ze(a);try{for(u.s();!(s=u.n()).done;){var l=s.value;if("number"==typeof l&&(l<0||l>6||!Number.isInteger(l)))return!1}}catch(t){u.e(t)}finally{u.f()}var c={name:t,period:{start:{hours:e,minutes:n},end:{hours:r,minutes:i}},days:a,id:o};return yield x(7,o,JSON.stringify(c)),!0})).apply(this,arguments)}function nn(t){return rn.apply(this,arguments)}function rn(){return(rn=b(function*(t){var e=yield M(7,t);if(e)return JSON.parse(e)})).apply(this,arguments)}function an(t){return on.apply(this,arguments)}function on(){return(on=b(function*(t){(yield nn(t.id))&&(yield x(7,t.id,JSON.stringify(t)))})).apply(this,arguments)}function sn(){return un.apply(this,arguments)}function un(){return(un=b(function*(){var t,e=[],n=Ze(yield B(7));try{for(n.s();!(t=n.n()).done;){var r=t.value,i=yield M(7,r);if(i){var a=JSON.parse(i);e.push(a)}}}catch(t){n.e(t)}finally{n.f()}return e.sort(function(t,e){return 60*t.period.end.hours+t.period.end.minutes-(60*e.period.end.hours+e.period.end.minutes)}),e.sort(function(t,e){return 60*t.period.start.hours+t.period.start.minutes-(60*e.period.start.hours+e.period.start.minutes)}),e})).apply(this,arguments)}function ln(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return cn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function cn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var dn,fn={};if("undefined"!=typeof SharedWorker){var hn=new SharedWorker(new URL(n.p+n.u(627),n.b));(dn=hn.port).start()}else{var pn=new Worker(new URL(n.p+n.u(627),n.b));dn=pn}function vn(){return(vn=b(function*(){var t,e=[],n=ln(yield B(6));try{for(n.s();!(t=n.n()).done;){var r=t.value,i=yield M(6,r);if(i){var a=JSON.parse(i);e.push(a)}}}catch(t){n.e(t)}finally{n.f()}return e})).apply(this,arguments)}dn.onmessage=function(t){var e=(0,G.A)(t.data,2),n=e[0],r=e[1];fn[r]&&(fn[r](n),delete fn[r])},dn.onerror=function(t){};var yn,mn={};if("undefined"!=typeof SharedWorker){var gn=new SharedWorker(new URL(n.p+n.u(113),n.b));(yn=gn.port).start()}else{var bn=new Worker(new URL(n.p+n.u(494),n.b));yn=bn}function wn(t,e){return An.apply(this,arguments)}function An(){return An=b(function*(t,e){var n=Jd(),r=yield sn(),i=yield function(){return vn.apply(this,arguments)}();return yield new Promise(function(a,o){mn[n]=a,yn.onerror=function(t){o(t.message)},yn.postMessage([r,i,t,e,n])})}),An.apply(this,arguments)}yn.onmessage=function(t){var e=(0,G.A)(t.data,2),n=e[0],r=e[1];mn[r]&&(mn[r](n),delete mn[r])},yn.onerror=function(t){};var Sn=[];var _n,kn={};if("undefined"!=typeof SharedWorker){var In=new SharedWorker(new URL(n.p+n.u(275),n.b));(_n=In.port).start()}else{var Cn=new Worker(new URL(n.p+n.u(275),n.b));_n=Cn}function En(){return Tn.apply(this,arguments)}function Tn(){return(Tn=b(function*(){var t,e=yield(t=(new Date).getTime()-252e5,Sn.filter(function(e){return e.timestamp>t})),n=Jd();return yield new Promise(function(t,r){kn[n]=t,_n.onerror=function(t){r(t.message)},_n.postMessage([e,n])})})).apply(this,arguments)}function $n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return xn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function xn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ln(t){return Mn.apply(this,arguments)}function Mn(){return(Mn=b(function*(t){var e,n=[],r=$n([[0,4],[1,4]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getEstimateTime_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n})).apply(this,arguments)}_n.onmessage=function(t){var e=(0,G.A)(t.data,2),n=e[0],r=e[1];kn[r]&&(kn[r](n),delete kn[r])},_n.onerror=function(t){};var Pn=!1,On=[];function Dn(t){return Bn.apply(this,arguments)}function Bn(){return Bn=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e=function(){return`https://erichsia7.github.io/material-symbols-list/search-index.gz?_=${zd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4)}`}();return yield ot(e,t,"getMaterialSymbolsSearchIndex","json")}),n.apply(this,arguments)}var r="bus_material_symbols_search_index_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(a)),Pn||(Pn=!0,On=a),a}if((new Date).getTime()-parseInt(i)>6048e5){var o=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(o)),Pn||(Pn=!0,On=o),o}if(!Pn){var s=yield M(0,r);Pn=!0,On=JSON.parse(s)}return ct(t,"getMaterialSymbolsSearchIndex",0,!0),On}),Bn.apply(this,arguments)}function Nn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return jn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Rn={};function Un(t,e){return Fn.apply(this,arguments)}function Fn(){return(Fn=b(function*(t,e){var n=Jd(),r=yield Dn(n);if(ft(n),!r.symbols.hasOwnProperty(e))return!1;var i=Jd(),a=`f_${i}`;if(Rn.hasOwnProperty(a))return!1;if(yield M(11,a))return!1;var o={name:t,icon:e,id:i,timestamp:(new Date).getTime()};return Rn[a]=o,yield x(11,a,JSON.stringify(o)),yield x(12,a,JSON.stringify([])),i})).apply(this,arguments)}function Jn(t,e,n){return zn.apply(this,arguments)}function zn(){return(zn=b(function*(t,e,n){var r=`f_${t}`,i=yield M(11,r);if(!i)return!1;var a=JSON.parse(i),o=Jd(),s=yield Dn(o);if(ft(o),!s.symbols.hasOwnProperty(n))return!1;var u={name:e,icon:n,id:t,timestamp:a.timestamp};return Rn[r]=u,yield x(11,r,JSON.stringify(u)),!0})).apply(this,arguments)}function Hn(t){var e=`f_${t}`;return!!Rn.hasOwnProperty(e)&&{name:Rn[e].name,icon:Rn[e].icon,id:Rn[e].id,timestamp:Rn[e].timestamp}}function qn(t){return Qn.apply(this,arguments)}function Qn(){return(Qn=b(function*(t){var e=[],n=`f_${t}`,r=Hn(t);if("boolean"==typeof r&&!1===r)return e;var i=yield M(12,n);if(!i)return e;var a=JSON.parse(i);if(0===a.length){return e.push({type:"empty",id:0,index:0}),e}var o,s=Nn(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=yield M(13,u);if(l){var c=JSON.parse(l);e.push(c)}}}catch(t){s.e(t)}finally{s.f()}return e})).apply(this,arguments)}function Yn(t){return Wn.apply(this,arguments)}function Wn(){return(Wn=b(function*(t){var e=`f_${t}`,n=yield M(12,e);return n?JSON.parse(n).length:0})).apply(this,arguments)}function Vn(){return Kn.apply(this,arguments)}function Kn(){return(Kn=b(function*(){var t,e=yield function(){var t=[];for(var e in Rn){var n={name:Rn[e].name,icon:Rn[e].icon,id:Rn[e].id,timestamp:Rn[e].timestamp};t.push(n)}return t.sort(function(t,e){return t.timestamp-e.timestamp}),t}(),n=[],r=Nn(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=yield qn(i.id),o=yield Yn(i.id);n.push({name:i.name,icon:i.icon,id:i.id,timestamp:i.timestamp,content:a,contentLength:o})}}catch(t){r.e(t)}finally{r.f()}return n})).apply(this,arguments)}function Gn(t,e){return Zn.apply(this,arguments)}function Zn(){return(Zn=b(function*(t,e){var n=`f_${t}`,r=`${e.type}_${e.id}`,i=Hn(t);if("boolean"==typeof i&&!1===i)return!1;var a=yield M(12,n);if(!a)return!1;var o=JSON.parse(a);return(0===o.length||o.indexOf(r)<0)&&(yield x(12,n,JSON.stringify(o.concat(r))),yield x(13,r,JSON.stringify(e)),!0)})).apply(this,arguments)}function Xn(t,e){return tr.apply(this,arguments)}function tr(){return(tr=b(function*(t,e){var n,r=`${t}_${e}`,i=Nn(yield B(12));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=yield M(12,a);if(o)if(JSON.parse(o).indexOf(r)>-1)return!0}}catch(t){i.e(t)}finally{i.f()}return!1})).apply(this,arguments)}function er(){return(er=b(function*(t,e,n){var r=`f_${t}`,i=`${e}_${n}`,a=Hn(t);if("boolean"==typeof a&&!1===a)return!1;var o=yield M(12,r);if(!o)return!1;var s=JSON.parse(o),u=s.indexOf(i);return u>-1&&s.length>0&&(s.splice(u,1),yield x(12,r,JSON.stringify(s))),!1===(yield Xn(e,n))&&(yield O(13,i)),!0})).apply(this,arguments)}function nr(t,e,n){return rr.apply(this,arguments)}function rr(){return(rr=b(function*(t,e,n){var r=Jd(),i=yield Kt(r),a=yield Jt(r,0),o=yield he(r,!0),s=i[`s_${e}`],u=parseInt(s.goBack),l=a[`l_${s.stopLocationId}`].n,c=o[`r_${n}`],d=c.n,f=c.dep,h=c.des,p={type:"stop",id:e,timestamp:(new Date).getTime(),name:l,direction:u,route:{name:d,endPoints:{departure:f,destination:h},id:n}};return yield Gn(t,p)})).apply(this,arguments)}function ir(t,e){return ar.apply(this,arguments)}function ar(){return(ar=b(function*(t,e){var n=Jd(),r=yield he(n,!0);ft(n),mt(n);var i=`r_${e}`,a={};if(!r.hasOwnProperty(i))return!1;a=r[i];var o={type:"route",id:e,timestamp:(new Date).getTime(),name:a.n,endPoints:{departure:a.dep,destination:a.des}};return yield Gn(t,o)})).apply(this,arguments)}function or(t,e){return sr.apply(this,arguments)}function sr(){return(sr=b(function*(t,e){var n=Jd(),r=yield Jt(n,1);ft(n),mt(n);var i=`ml_${e}`,a={};if(!r.hasOwnProperty(i))return!1;a=r[i];var o={type:"location",id:e,timestamp:(new Date).getTime(),name:a.n};return yield Gn(t,o)})).apply(this,arguments)}function ur(){return(ur=b(function*(t,e,n,r){var i=`f_${t}`,a=`${e}_${n}`,o=Hn(t);if("boolean"==typeof o&&!1===o)return!1;var s=yield M(12,i);if(!s)return!1;var u=JSON.parse(s),l=u.indexOf(a);if(l>-1&&u.length>1){var c=0;switch(r){case"up":c=-1;break;case"down":c=1;break;default:c=0}return u.splice(l,1),u.splice(l+c,0,a),yield x(12,i,JSON.stringify(u)),!0}return!1})).apply(this,arguments)}n(4668);function lr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return cr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function cr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var dr=!1;function fr(){return(fr=b(function*(){if(!dr){var t=Jd(),e=yield Dn(t);ft(t);var n=e.dictionary.split(","),r=e.symbols,i=[],a={},o=0;for(var s in r){i.push(s);var u,l=lr(r[s]);try{for(l.s();!(u=l.n()).done;){var c=`w${u.value}`;a.hasOwnProperty(c)||(a[c]=[]),a[c].push(o)}}catch(t){l.e(t)}finally{l.f()}o++}dr=!0}})).apply(this,arguments)}var hr=!1,pr=Q(H(".k"),".l"),vr=Q(pr,".m");Q(vr,'svg#download-svg path[progress="progress"]');var yr="",mr=H(".o"),gr=H(".p"),br=H(".q");function wr(t){var e=document.createElement("div");return e.classList.add("r"),e.onclick=function(){!function(t){var e;switch(yr){case"editor":e=Q(mr,'.v .w .x[group="folder-icon"] .y .z input');break;case"creator":e=Q(gr,'._ .aa .ba[group="folder-icon"] .ca .da input')}e.value=t,gc("FolderIconSelector"),br.setAttribute("displayed","false")}(t)},e.appendChild(Ne(t)),{element:e,id:""}}function Ar(){return(Ar=b(function*(){var t=Q(br,".s .t");t.innerHTML="";var e=Jd(),n=yield Dn(e);ft(e);var r=new DocumentFragment;for(var i in n.symbols){var a=wr(i);r.appendChild(a.element)}t.append(r)})).apply(this,arguments)}function Sr(t){switch(mc("FolderIconSelector"),t){case"editor":yr="editor",Q(mr,'.v .w .x[group="folder-icon"] .y .z .ea');break;case"creator":yr="creator",Q(gr,'._ .aa .ba[group="folder-icon"] .ca .da .fa')}hr?(br.setAttribute("displayed","true"),function(){Ar.apply(this,arguments)}(yr),function(){fr.apply(this,arguments)}()):jd("download_for_offline","資料還在下載中")}var _r=H(".p"),kr=Q(_r,"._"),Ir=Q(kr,".aa");Q(Ir,'.ba[group="folder-name"] .ca input'),Q(Ir,'.ba[group="folder-icon"] .ca .da input');function Cr(){_r.setAttribute("displayed","false"),wc()}function Er(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Tr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Tr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}Q(Ir,'.p ._ .aa .ba[group="folder-icon"] .ca .da .fa').onclick=function(){Sr("creator")};var $r=H(".o"),xr=Q($r,".ga"),Lr=Q(xr,".ha"),Mr=Q($r,".v"),Pr=Q(Mr,".w"),Or=Q(Pr,'.x[group="folder-name"] .y input'),Dr=Q(Pr,'.x[group="folder-icon"] .y .z input'),Br=Q(Pr,'.x[group="folder-icon"] .y .z .ea'),Nr=Q(Pr,'.x[group="folder-content"] .y');function jr(t,e){var n=Jd(),r=document.createElement("div");r.id=n,r.classList.add("ia"),r.setAttribute("type",e.type);var i="",a="",o="";switch(e.type){case"stop":o="location_on",i=`${e.route?e.route.name:""} - 往${e.route?[e.route.endPoints.destination,e.route.endPoints.departure,""][e.direction?e.direction:0]:""}`,a=e.name;break;case"route":o="route",i=`${e.endPoints.departure} ↔ ${e.endPoints.destination}`,a=e.name;break;case"location":o="location_on",i="地點",a=e.name;break;case"bus":i="",a=e.name;break;case"empty":o="lightbulb",i="提示",a="沒有內容";break;default:o="",i="null",a="null"}var s=document.createElement("div");s.classList.add("ja"),s.appendChild(Ne(o));var u=document.createElement("div");u.classList.add("ka"),u.appendChild(document.createTextNode(i));var l=document.createElement("div");l.classList.add("la"),l.appendChild(document.createTextNode(a));var c=document.createElement("div");c.classList.add("ma");var d=document.createElement("div");d.classList.add("na"),d.appendChild(Ne("keyboard_arrow_down")),d.onclick=function(){zr(n,t.id,e.type,e.id,"up")};var f=document.createElement("div");f.classList.add("oa"),f.appendChild(Ne("keyboard_arrow_down")),f.onclick=function(){zr(n,t.id,e.type,e.id,"down")};var h=document.createElement("div");h.classList.add("pa"),h.appendChild(Ne("delete")),h.onclick=function(){!function(t,e,n,r){var i=Q($r,`.v .w .x[group="folder-content"] .y .ia#${t}`);(function(t,e,n){return er.apply(this,arguments)})(e,n,r).then(function(t){if(t)switch(i.remove(),n){case"stop":jd("delete","已移除站牌");break;case"route":jd("delete","已移除路線");break;case"location":jd("delete","已移除地點")}else jd("error","無法移除")})}(n,t.id,e.type,e.id)};var p=document.createElement("div");p.classList.add("qa");var v=document.createElement("div");return v.classList.add("qa"),c.appendChild(d),c.appendChild(f),c.appendChild(h),c.appendChild(p),c.appendChild(v),r.appendChild(s),r.appendChild(u),r.appendChild(l),r.appendChild(c),{element:r,id:n}}function Rr(t,e){Or.value=t.name,Dr.value=t.icon,Lr.onclick=function(){var e,n,r;e=t.id,n=Or.value,r=Dr.value,Jn(e,n,r).then(function(t){t?(Jr(),jd("check_circle","已儲存變更")):jd("error","無法儲存")})},Nr.innerHTML="";var n,r=new DocumentFragment,i=Er(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=jr(t,a);r.appendChild(o.element)}}catch(t){i.e(t)}finally{i.f()}Nr.append(r)}function Ur(){return(Ur=b(function*(t){Rr(Hn(t),yield qn(t))})).apply(this,arguments)}function Fr(t){mc("FolderEditor"),$r.setAttribute("displayed","true"),function(t){Ur.apply(this,arguments)}(t),bc()}function Jr(){$r.setAttribute("displayed","false"),wc()}function zr(t,e,n,r,i){var a=Q($r,`.v .w .x[group="folder-content"] .y .ia#${t}`);(function(t,e,n,r){return ur.apply(this,arguments)})(e,n,r,i).then(function(t){if(t)switch(i){case"up":var e=a.previousElementSibling;e&&a.parentNode.insertBefore(a,e),jd("arrow_circle_up","已往上移");break;case"down":var n=a.nextElementSibling;n&&a.parentNode.insertBefore(n,a),jd("arrow_circle_down","已往下移")}else jd("error","無法移動")})}function Hr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return qr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}Br.onclick=function(){Sr("editor")};var Qr=H(".ra"),Yr=Q(Qr,".sa"),Wr=Q(Yr,".ta");function Vr(t){var e=document.createElement("div");e.classList.add("ua"),e.onclick=function(){Fr(t.id)};var n=document.createElement("div");n.classList.add("va"),n.appendChild(Ne(t.icon));var r=document.createElement("div");r.classList.add("wa"),r.appendChild(document.createTextNode(t.name));var i=document.createElement("div");i.classList.add("xa"),i.appendChild(document.createTextNode(String(t.contentLength)));var a=document.createElement("div");return a.classList.add("ya"),a.appendChild(Ne("arrow_forward_ios")),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(a),{element:e,id:""}}function Kr(){return(Kr=b(function*(){var t=yield Vn();Wr.innerHTML="";var e,n=new DocumentFragment,r=Hr(t);try{for(r.s();!(e=r.n()).done;){var i=Vr(e.value);n.appendChild(i.element)}}catch(t){r.e(t)}finally{r.f()}Wr.append(n)})).apply(this,arguments)}function Gr(){mc("FolderManager"),Qr.setAttribute("displayed","true"),function(){Kr.apply(this,arguments)}()}var Zr=H(".za"),Xr=Q(Zr,"._a"),ti=Q(Zr,".ab"),ei=Q(ti,".bb"),ni=Q(Xr,".cb"),ri=Q(ni,'.db[group="schedule-name"] .eb input'),ii=Q(ni,'.db[group="schedule-start-time"] .eb input'),ai=Q(ni,'.db[group="schedule-end-time"] .eb input'),oi=Q(ni,'.db[group="schedule-days"] .eb'),si=Y(oi,".fb");function ui(){return(ui=b(function*(t){for(var e=ri.value,n=ii.value,r=ai.value,i=String(n).split(":").map(function(t){return parseInt(t)}),a=(0,G.A)(i,2),o=a[0],s=a[1],u=String(r).split(":").map(function(t){return parseInt(t)}),l=(0,G.A)(u,2),c=l[0],d=l[1],f=[],h=0;h<7;h++){var p=si[h],v=p.getAttribute("highlighted"),y=parseInt(p.getAttribute("day"));"true"===v&&f.push(y)}var m=yield nn(t);m.name=e,m.days=f,m.period.start.hours=o,m.period.start.minutes=s,m.period.end.hours=c,m.period.end.minutes=d,yield an(m),di()})).apply(this,arguments)}function li(){return li=b(function*(t){var e=yield nn(t);ri.value=e.name,ii.value=C(e.period.start),ai.value=C(e.period.end);for(var n=0;n<7;n++){var r=si[n];e.days.indexOf(n)>-1?r.setAttribute("highlighted","true"):r.setAttribute("highlighted","false")}ei.onclick=function(){!function(t){ui.apply(this,arguments)}(t)}}),li.apply(this,arguments)}function ci(t){mc("PersonalScheduleEditor"),Zr.setAttribute("displayed","true"),function(t){li.apply(this,arguments)}(t),bc()}function di(){Zr.setAttribute("displayed","false"),wc()}function fi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return hi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hi(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var pi=H(".gb"),vi=Q(pi,".hb"),yi=Q(vi,".ib");function mi(t){var e=document.createElement("div");e.classList.add("jb"),e.onclick=function(){ci(t.id)};var n=document.createElement("div");n.classList.add("kb"),n.appendChild(document.createTextNode(t.name)),e.appendChild(n);var r=document.createElement("div");r.classList.add("lb");var i=document.createElement("span");return i.appendChild(Ne("arrow_forward_ios")),r.appendChild(i),e.appendChild(r),{element:e,id:""}}function gi(){return(gi=b(function*(){yi.innerHTML="";var t,e=yield sn(),n=new DocumentFragment,r=fi(e);try{for(r.s();!(t=r.n()).done;){var i=mi(t.value);n.appendChild(i.element)}}catch(t){r.e(t)}finally{r.f()}yi.append(n)})).apply(this,arguments)}function bi(){mc("PersonalScheduleManager"),pi.setAttribute("displayed","true"),function(){gi.apply(this,arguments)}()}function wi(t){if(""===$i)return!1;var e=new URL($i);return["cancel","register","schedule","rotate","reschedule"].indexOf(t)>-1&&(e.searchParams.set("method",t),e.toString())}function Ai(t,e,n){var r=(new Date).getTime();return Ud(Ud(`${t}\n${e}\n${(r-r%5e3)/5e3}\n${Ud(`${t}\n${e}\n${Ud(JSON.stringify(n))}`)}`))}function Si(t,e){switch(t){case"cancel":return""!==xi&&""!==Li&&1===e.length&&{client_id:xi,token:Ai(xi,Li,{schedule_id:e[0]}),schedule_id:e[0]};case"register":if(1!==e.length)return!1;var n=new Date;return n.setMilliseconds(0),n.setSeconds(0),{hash:Ud(`${Ud(e[0])}${n.getTime()}`)};case"schedule":return""!==xi&&""!==Li&&9===e.length&&{client_id:xi,token:Ai(xi,Li,{stop_id:e[0],location_name:e[1],route_id:e[2],route_name:e[3],direction:e[4],estimate_time:e[5],time_formatting_mode:e[6],time_offset:e[7],scheduled_time:e[8]}),stop_id:e[0],location_name:e[1],route_id:e[2],route_name:e[3],direction:e[4],estimate_time:e[5],time_formatting_mode:e[6],time_offset:e[7],scheduled_time:e[8]};case"rotate":return""!==xi&&""!==Li&&0===e.length&&{client_id:xi,token:Ai(xi,Li,{})};case"reschedule":return""!==xi&&""!==Li&&3===e.length&&{client_id:xi,token:Ai(xi,Li,{schedule_id:e[0],estimate_time:e[1],scheduled_time:e[2]}),schedule_id:e[0],estimate_time:e[1],scheduled_time:e[2]};default:return!1}}function _i(t,e,n){return ki.apply(this,arguments)}function ki(){return(ki=b(function*(t,e,n){try{if(!1===e||!1===n)return!1;var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"omit"},i=yield fetch(e,r);if(!i.ok){yield i.text();return!1}try{var a=yield i.text(),o=JSON.parse(a);switch(t){case"cancel":case"register":case"schedule":case"rotate":case"reschedule":return o;default:return!1}}catch(t){throw new Error("Invalid JSON response from server")}}catch(t){return!1}})).apply(this,arguments)}function Ii(){return Ii=b(function*(){if(""===xi||""===Li)return!1;var t,e=wi("rotate"),n=Si("rotate",[]),r=yield _i("rotate",e,n);return!1!==r&&(200===r.code&&"rotate"===r.method&&(void 0!==(t=r.secret)&&(Li=String(t)),yield function(){return Di.apply(this,arguments)}(),!0))}),Ii.apply(this,arguments)}function Ci(){return Ci=b(function*(t,e,n,r,i,a,o,s,u){if(""===xi||""===Li||void 0===t||void 0===e||void 0===n||void 0===r||void 0===i||void 0===a||"number"!=typeof o||void 0===u)return!1;var l=new Date;switch(m(u)){case"string":case"number":l=new Date(u);break;default:if(!(u instanceof Date))return!1;l=u}var c=wi("schedule"),d=Si("schedule",[t,e,n,r,i,a,o,s,l.toISOString()]),f=yield _i("schedule",c,d);return!1!==f&&(200===f.code&&"schedule"===f.method&&(Math.random()>.8&&(yield function(){return Ii.apply(this,arguments)}()),yield function(t,e,n,r,i,a,o,s,u,l){return Ni.apply(this,arguments)}(f.schedule_id,t,e,n,r,i,a,o,s,l.getTime()),f.schedule_id))}),Ci.apply(this,arguments)}function Ei(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ti(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ti(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ti(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var $i="",xi="",Li="",Mi=[],Pi={},Oi={};function Di(){return(Di=b(function*(){var t={provider:$i,client_id:xi,secret:Li};yield x(9,"n_client",JSON.stringify(t))})).apply(this,arguments)}function Bi(){return""!==xi&&""!==Li}function Ni(){return(Ni=b(function*(t,e,n,r,i,a,o,s,u,l){var c={schedule_id:t,stop_id:e,location_name:n,route_id:r,route_name:i,direction:a,estimate_time:o,time_formatting_mode:s,time_offset:u,scheduled_time:l},d=`s_${e}`,f=Mi.length;Mi.push(c),Pi[t]=f,Oi.hasOwnProperty(d)||(Oi[d]=[]),Oi[d].push(f),yield x(10,t,JSON.stringify(c))})).apply(this,arguments)}function ji(){return(ji=b(function*(t){if(Pi.hasOwnProperty(t)){var e=Pi[t],n=`s_${Mi[e].stop_id}`;Mi.splice(e,1,null),Oi[n].splice(Oi[n].indexOf(e),1),delete Pi[t],yield O(10,t)}})).apply(this,arguments)}function Ri(t){var e=(new Date).getTime(),n=`s_${t}`;if(Oi.hasOwnProperty(n)){var r,i=Ei(Oi[n]);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=Mi[a];if(null!==o)if(o.scheduled_time>e)return!0}}catch(t){i.e(t)}finally{i.f()}}return!1}function Ui(t){return Fi.apply(this,arguments)}function Fi(){return(Fi=b(function*(t){var e,n=yield he(t,!0),r=function(){var t,e=(new Date).getTime(),n=[],r=Ei(Mi);try{for(r.s();!(t=r.n()).done;){var i=t.value;null!==i&&i.scheduled_time>e&&n.push(i)}}catch(t){r.e(t)}finally{r.f()}return n}(),i=(new Date).getTime(),a=[],o=Ei(r);try{for(o.s();!(e=o.n()).done;){var s=e.value,u={},l=s.location_name;u.name=l;var c=s.stop_id;u.stop_id=c;var d=s.estimate_time;u.estimate_time=d;var f=s.schedule_id;u.schedule_id=f;var h=s.scheduled_time;u.scheduled_time=h;var p=new Date(h),v=p.getDate(),y=p.getHours(),m=p.getMinutes();u.date=String(v).padStart(2,"0"),u.hours=String(y).padStart(2,"0"),u.minutes=String(m).padStart(2,"0"),u.route={};var g=s.route_name;u.route.name=g;var b=s.route_id;u.route.id=b;var w=s.direction;u.route.direction=w;var A=`r_${s.route_id}`;if(n.hasOwnProperty(A)){var S=n[A].pid;u.route.pathAttributeId=S,a.push(u)}}}catch(t){o.e(t)}finally{o.f()}a.sort(function(t,e){return t.scheduled_time-e.scheduled_time});for(var _=[],k=0,I={},C=0,E=a;C<E.length;C++){var T=E[C],$=`g_${T.date}_${T.hours}`;I.hasOwnProperty($)?T.is_first=!1:(I[$]=!0,T.is_first=!0),_.push(T),k+=1}var x={items:_,itemQuantity:k,dataUpdateTime:Math.max(yt(t),i)};return mt(t),ft(t),x})).apply(this,arguments)}var Ji=[{name:"到站前5分鐘",time_offset:-5,icon:"clock_loader_10",index:0},{name:"到站前10分鐘",time_offset:-10,icon:"clock_loader_20",index:1},{name:"到站前15分鐘",time_offset:-15,icon:"clock_loader_40",index:2},{name:"到站前20分鐘",time_offset:-20,icon:"clock_loader_60",index:3},{name:"到站前25分鐘",time_offset:-25,icon:"clock_loader_80",index:4},{name:"到站前30分鐘",time_offset:-30,icon:"clock_loader_90",index:5}];function zi(t,e,n,r){return Hi.apply(this,arguments)}function Hi(){return Hi=b(function*(t,e,n,r){if(Bi()){var i=Dd("time_formatting_mode"),a=Jd(),o=yield Kt(a),s=yield Jt(a,0),u=yield he(a,!0);ft(a),mt(a);var l=`s_${t}`,c={};if(!o.hasOwnProperty(l))return 0;var d=(c=o[l]).stopLocationId,f=c.goBack,h=`l_${d}`;if(!s.hasOwnProperty(h))return 0;var p=s[h].n,v=`r_${e}`,y={};if(!u.hasOwnProperty(v))return 0;var m=(y=u[v]).n,g=y.dep,b=[y.des,g,""][f?parseInt(f):0],w=Ji[r].time_offset,A=(new Date).getTime()+1e3*n+60*w*1e3,S=yield function(t,e,n,r,i,a,o,s,u){return Ci.apply(this,arguments)}(t,p,e,m,b,n,i,w,A);return!1===S?0:1}return 2}),Hi.apply(this,arguments)}var qi=H(".mb"),Qi=Q(qi,".nb"),Yi=Q(Qi,".ob"),Wi=Q(Yi,'.pb[group="provider"] .qb input'),Vi=Q(Yi,'.pb[group="registration-key"] .qb input');function Ki(){Wi.value=String($i),Vi.value=""}function Gi(t,e,n,r){var i=(Gi.canvas||(Gi.canvas=document.createElement("canvas"))).getContext("2d"),a=`${e} ${n} ${r}`;return i.font=a,i.measureText(t).width}function Zi(t,e,n,r,i,a,o){a="number"==typeof a?{tl:a,tr:a,br:a,bl:a}:{tl:a.tl||0,tr:a.tr||0,br:a.br||0,bl:a.bl||0},t.beginPath(),t.moveTo(e+a.tl,n),t.lineTo(e+r-a.tr,n),t.quadraticCurveTo(e+r,n,e+r,n+a.tr),t.lineTo(e+r,n+i-a.br),t.quadraticCurveTo(e+r,n+i,e+r-a.br,n+i),t.lineTo(e+a.bl,n+i),t.quadraticCurveTo(e,n+i,e,n+i-a.bl),t.lineTo(e,n+a.tl),t.quadraticCurveTo(e,n,e+a.tl,n),t.closePath(),t.fillStyle=o,t.fill()}function Xi(t,e,n,r,i,a){var o=i="number"==typeof i?{tl:i,tr:i,br:i,bl:i}:{tl:i.tl||0,tr:i.tr||0,br:i.br||0,bl:i.bl||0},s=o.tl,u=o.tr,l=o.br,c=o.bl,d=[];return a?(0!==s&&d.push(`M${t} ${e+s}`,`Q${t} ${e} ${t+s} ${e}`,`H${t}`,`V${e+s}`),0!==u&&d.push(`M${t+n-u} ${e}`,`Q${t+n} ${e} ${t+n} ${e+u}`,`V${e}`,"H"+(t+n-u)),0!==l&&d.push(`M${t+n} ${e+r-l}`,`Q${t+n} ${e+r} ${t+n-l} ${e+r}`,`H${t+n}`,"V"+(e+r-l)),0!==c&&d.push(`M${t+c} ${e+r}`,`Q${t} ${e+r} ${t} ${e+r-c}`,`V${e+r}`,`H${t+c}`)):d.push(`M${t+s} ${e}`,"H"+(t+n-u),`Q${t+n} ${e} ${t+n} ${e+u}`,"V"+(e+r-l),`Q${t+n} ${e+r} ${t+n-l} ${e+r}`,`H${t+c}`,`Q${t} ${e+r} ${t} ${e+r-c}`,`V${e+s}`,`Q${t} ${e} ${t+s} ${e}`),d}var ta={light:{},dark:{}};function ea(t){var e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(ta[e].hasOwnProperty(t))return ta[e][t];var n=getComputedStyle(document.documentElement).getPropertyValue(t);return ta[e][t]=n,n}function na(t){var e=Math.hypot(t),n=t.length,r=new Float32Array(n);if(e>0){for(var i=1/e,a=n;a>0;a--)r[a]=t[a]*i;return Array.from(r)}return t}var ra={vector:[0,0],id:-1,name:"未知",symbol:"?",icon:"explore"},ia={vector:[0,1],id:0,name:"北",symbol:"↑",icon:"north"},aa={vector:[1,0],id:1,name:"東",symbol:"→",icon:"east"},oa={vector:[0,-1],id:2,name:"南",symbol:"↓",icon:"south"},sa={vector:[-1,0],id:3,name:"西",symbol:"←",icon:"west"},ua={vector:[Math.SQRT1_2,Math.SQRT1_2],id:4,name:"東北",symbol:"↗",icon:"north_east"},la={vector:[Math.SQRT1_2,-Math.SQRT1_2],id:5,name:"東南",symbol:"↘",icon:"south_east"},ca={vector:[-Math.SQRT1_2,-Math.SQRT1_2],id:6,name:"西南",symbol:"↙",icon:"south_west"},da={vector:[-Math.SQRT1_2,Math.SQRT1_2],id:7,name:"西北",symbol:"↖",icon:"north_west"};function fa(t){for(var e=[ra,ia,sa,oa,aa,ua,la,ca,da],n=na(t),r=-1/0,i=e[0],a=0,o=e;a<o.length;a++){var s=o[a],u=s.vector[0]*n[0]+s.vector[1]*n[1];u>r&&(r=u,i=s)}return i}var ha={current:-1,permission:{gained:!1,asked:!1},id:0};function pa(){var t=ha.current;if(-1===t)return{degree:-1,cardinalDirection:ra};var e=t+90;return e>360&&(e-=360),e*=Math.PI/180,{degree:t,cardinalDirection:fa([Math.cos(e),Math.sin(e)])}}function va(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ya(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ya(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ya(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ma(t,e){var n={},r=[];for(var i in t){var a=t[i],o=a.StopID,s=parseInt(a.EstimateTime);s>=0&&e.indexOf(o)>-1&&r.push([o,s])}var u=r.length;r.sort(function(t,e){return t[1]-e[1]});for(var l=1,c=0,d=r;c<d.length;c++){var f=l/u,h=(f-f%.25)/.25;n[`s_${d[c][0]}`]={number:l,text:l.toString(),code:h},l+=1}return n}function ga(){return ga=b(function*(t,e,n,r){ct(r,"getLocation_0",0,!1),ct(r,"getLocation_1",0,!1),ct(r,"getRoute_0",0,!1),ct(r,"getRoute_1",0,!1),ct(r,"getStop_0",0,!1),ct(r,"getStop_1",0,!1),ct(r,"getEstimateTime_0",0,!1),ct(r,"getEstimateTime_1",0,!1),ct(r,"getBusEvent_0",0,!1),ct(r,"getBusEvent_1",0,!1);for(var i=yield Ln(r),o=yield Jt(r,1),s=yield he(r,!0),u=yield Kt(r),l=yield kt(r),d=yield wt(r),p=yield wn(e,n),v=Dd("time_formatting_mode"),m=Dd("location_labels"),g=Dd("display_user_orientation"),b={},w={},A={},S=pa(),_=o[`ml_${t}`],k=_.n,I=_.id,C=_.v,E=[],T=[],$=I.length,x=0;x<$;x++)E=E.concat(_.s[x]),T=T.concat(_.r[x]);var L,M=function(t,e){var n,r={},i=va(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.indexOf(a.StopID)>-1&&(r[`s_${a.StopID}`]=a)}}catch(t){i.e(t)}finally{i.f()}return r}(i,E),P=function(t,e,n,r){var i,a={},o={},s=Zt(e);try{for(s.s();!(i=s.n()).done;){var u=i.value;o[u.BusID]=u}}catch(t){s.e(t)}finally{s.f()}var l,c=Zt(t);try{for(c.s();!(l=c.n()).done;){var d=l.value,f={},h=parseInt(d.StopID),p=parseInt(d.RouteID),v=String(d.BusID);if(!(r.indexOf(h)<0)){f.index=v.charCodeAt(0),f.onThisRoute=!0,f.CarType=d.CarType,f.BusStatus=d.BusStatus,f.BusID=d.BusID,f.CarOnStop=d.CarOnStop;var y={};if(o.hasOwnProperty(v)){y=o[v],f.position={latitude:parseFloat(y.Latitude),longitude:parseFloat(y.Longitude)};var m={},g=!1;for(var b in n){var w=n[b];if(w.pid.indexOf(p)>-1){m=w,g=!0;break}}f.RouteName=g?m.n:"未知路線",f.RouteID=g?m.id:null;var A=`s_${h}`;a.hasOwnProperty(A)||(a[A]=[]),a[A].push(f)}}}}catch(t){c.e(t)}finally{c.f()}return a}(l,d,s,E),O=[],D=va(C);try{for(D.s();!(L=D.n()).done;){var B,N=L.value,j=0,R=0,U=va(N);try{for(U.s();!(B=U.n()).done;){var F=B.value;j+=F[0],R+=F[1]}}catch(t){U.e(t)}finally{U.f()}var J=fa(na([j,R]));O.push(J)}}catch(t){D.e(t)}finally{D.f()}var z=[];switch(m){case"address":z=function(t){var e,n=[],r={},i=h(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;for(var s in o)r.hasOwnProperty(s)||(r[s]=0),o[s].length>0&&(r[s]=r[s]+1)}}catch(t){i.e(t)}finally{i.f()}var u=Object.entries(r).map(function(t){return{key:t[0],value:t[1]}}).filter(function(e){return e.value===t.length}).sort(function(t,e){return t.value-e.value});if(u.length>0){var l,c=h(u);try{for(c.s();!(l=c.n()).done;){var d,p=l.value,v=[],y=-1/0,m=h(t);try{for(m.s();!(d=m.n()).done;){var g=d.value[p.key].join("");v.push(g);var b=g.length;b>y&&(y=b)}}catch(t){m.e(t)}finally{m.f()}a(v)&&n.push({components:v,len:y})}}catch(t){c.e(t)}finally{c.f()}}return n.length>0?(n.sort(function(t,e){return t.len-e.len}),n[0].components):f(t.length)}(_.a);break;case"letters":z=f($);break;case"directions":z=function(t){var e,n=[],r=c(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(`向${i.name}${i.symbol}`)}}catch(t){r.e(t)}finally{r.f()}return n}(O)}for(var H=0;H<$;H++){var q=`g_${H}`;b[q]=[],w[q]=0,A[q]={name:z[H],properties:[{key:"address",icon:"personal_places",value:y(_.a[H])},{key:"exact_position",icon:"location_on",value:`${_.la[H].toFixed(5)}, ${_.lo[H].toFixed(5)}`},{key:"cardinal_direction",icon:O[H].icon,value:`${O[H].name}${g&&-1!==S.cardinalDirection.id&&S.cardinalDirection.id===O[H].id?"（目前指向）":""}`}]};for(var Q=_.s[H],Y=Q.length,W=ma(M,Q),V=0;V<Y;V++){var K={},G=_.s[H][V],Z=`s_${G}`,X={};if(u.hasOwnProperty(Z)){X=u[Z],K.stopId=G;var tt={number:0,text:"--",code:-1};W.hasOwnProperty(Z)&&(tt=W[Z]),K.ranking=tt;var et=_.r[H][V],nt=`r_${et}`,rt={};if(s.hasOwnProperty(nt)){rt=s[nt],K.route_name=rt.n,K.route_direction=`往${[rt.des,rt.dep,""][parseInt(X.goBack)]}`,K.routeId=et;if(M.hasOwnProperty(Z)){var it=te(M[Z].EstimateTime,v);K.status=it;var at=[];P.hasOwnProperty(Z)&&(at=P[Z].map(function(t){return ae(t)})),K.buses=at;var ot=[];p.hasOwnProperty(Z)&&(ot=p[Z]),K.busArrivalTimes=ot,b[q].push(K),w[q]+=1}}}}}for(var st in b)b[st].sort(function(t,e){return t.routeId-e.routeId});var ut={groupedItems:b,groups:A,groupQuantity:$,itemQuantity:w,LocationName:k,hash:t,dataUpdateTime:yt(r)};return ft(r),mt(r),ut}),ga.apply(this,arguments)}function ba(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return wa(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wa(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function wa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Aa=H(".rb"),Sa=Q(Aa,".sb"),_a=Q(Sa,".tb"),ka="已儲存至資料夾",Ia="無法儲存";function Ca(t,e,n){var r=document.createElement("div");r.classList.add("ub");var i=document.createElement("div");i.classList.add("vb");var a=document.createElement("span");a.appendChild(Ne(t.icon)),i.appendChild(a);var o=document.createElement("div");switch(o.classList.add("wb"),o.appendChild(document.createTextNode(t.name)),e){case"stop-on-route":r.onclick=function(){!function(t,e,n,r){var i=H(`.xb .yb .zb ._b .ac .bc#${t}`),a=Q(i,'.cc .dc .ec[type="save-to-folder"]');nr(e,n,r).then(function(t){t?Xn("stop",n).then(function(t){t&&(a.setAttribute("highlighted",Qd(t)),jd("folder",ka),$a())}):jd("warning",Ia)})}(n[0],t.id,n[1],n[2])};break;case"stop-on-location":r.onclick=function(){!function(t,e,n,r){var i=H(`.fc .gc .hc .ic .jc#${t}`),a=Q(i,'.kc .lc .mc[type="save-to-folder"]');nr(e,n,r).then(function(t){t?Xn("stop",n).then(function(t){t&&(a.setAttribute("highlighted",Qd(t)),jd("folder",ka),$a())}):jd("warning",Ia)})}(n[0],t.id,n[1],n[2])};break;case"route":r.onclick=function(){var e,r,i;e=t.id,r=n[0],i=H('.nc .oc .pc .qc[group="actions"] .rc .sc[action="save-to-folder"]'),ir(e,r).then(function(t){t?Xn("route",r).then(function(t){t&&(i.setAttribute("highlighted","true"),jd("folder",ka),$a())}):jd("warning",Ia)})};break;case"route-on-route":r.onclick=function(){var e,r;e=t.id,r=n[0],ir(e,r).then(function(t){t?Xn("route",r).then(function(t){t&&(jd("folder",ka),$a())}):jd("warning",Ia)})};break;case"location":case"location-on-route":r.onclick=function(){var e,r;e=t.id,r=n[0],or(e,r).then(function(t){t?Xn("location",r).then(function(t){t&&(jd("folder",ka),$a())}):jd("warning",Ia)})}}return r.appendChild(i),r.appendChild(o),{element:r,id:""}}function Ea(){return(Ea=b(function*(t,e){var n=yield Vn();_a.innerHTML="";var r,i=new DocumentFragment,a=ba(n);try{for(a.s();!(r=a.n()).done;){var o=Ca(r.value,t,e);i.appendChild(o.element)}}catch(t){a.e(t)}finally{a.f()}_a.append(i)})).apply(this,arguments)}function Ta(t,e){mc("SaveToFolder"),Aa.setAttribute("displayed","true"),function(t,e){Ea.apply(this,arguments)}(t,e)}function $a(){gc("SaveToFolder"),Aa.setAttribute("displayed","false")}function xa(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return La(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?La(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function La(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Ma=H(".tc"),Pa=Q(Ma,".uc"),Oa=Q(Pa,".vc");function Da(t,e,n){var r=document.createElement("div");r.classList.add("wc");var i=document.createElement("div");i.classList.add("xc");var a=document.createElement("span");a.appendChild(Ne(t.icon)),i.appendChild(a);var o=document.createElement("div");switch(o.classList.add("yc"),o.appendChild(document.createTextNode(t.name)),e){case"stop-on-route":r.onclick=function(){!function(t,e,n,r,i){var a=H(`.xb .yb .zb ._b .ac .bc#${t}`),o=Q(a,'.cc .dc .ec[type="schedule-notification"]');jd("manufacturing","處理中"),o.setAttribute("enabled","false"),Na(),zi(e,n,r,i).then(function(t){switch(t){case 0:jd("error","設定失敗"),o.setAttribute("enabled","true");break;case 1:jd("check_circle","設定成功"),o.setAttribute("enabled","true"),o.setAttribute("highlighted","true");break;case 2:jd("warning","在設定中註冊後才可設定到站通知"),o.setAttribute("enabled","true")}})}(n[0],n[1],n[2],n[3],t.index)};break;case"stop-on-location":r.onclick=function(){!function(t,e,n,r,i){var a=H(`.fc .gc .hc .ic .jc#${t}`),o=Q(a,'.kc .lc .mc[type="schedule-notification"]');jd("manufacturing","處理中"),o.setAttribute("enabled","false"),Na(),zi(e,n,r,i).then(function(t){switch(t){case 0:jd("error","設定失敗"),o.setAttribute("enabled","true");break;case 1:jd("check_circle","設定成功"),o.setAttribute("enabled","true"),o.setAttribute("highlighted","true");break;case 2:jd("warning","在設定中註冊後才可設定到站通知"),o.setAttribute("enabled","true")}})}(n[0],n[1],n[2],n[3],t.index)}}return r.appendChild(i),r.appendChild(o),{element:r,id:""}}function Ba(t,e){mc("ScheduleNotification"),Ma.setAttribute("displayed","true"),function(t,e){Oa.innerHTML="";var n,r=new DocumentFragment,i=xa(Ji);try{for(i.s();!(n=i.n()).done;){var a=Da(n.value,t,e);r.appendChild(a.element)}}catch(t){i.e(t)}finally{i.f()}Oa.append(r)}(t,e)}function Na(){gc("ScheduleNotification"),Ma.setAttribute("displayed","false")}function ja(){return ja=b(function*(t,e){var n=yield Jt(e,1);ft(e),mt(e);var r=`ml_${t}`;if(!n.hasOwnProperty(r))return{actions:[],actionsQuantity:0,hash:t};n[r];var i=[{icon:"folder",name:"儲存",key:"save-to-folder",action:function(){Ta("location",[t])}},{icon:"ios_share",name:"分享",key:"permalink",action:function(){!function(t){lu.apply(this,arguments)}(t)}},{icon:"qr_code_2",name:"二維條碼",key:"permalink-qr-code",action:function(){!function(t){cu.apply(this,arguments)}(t)}}];return{actions:i,actionsQuantity:i.length,hash:t}}),ja.apply(this,arguments)}function Ra(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ua(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ua(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ua(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Fa=!1,Ja={};function za(t){return Ha.apply(this,arguments)}function Ha(){return(Ha=b(function*(t){var e=new Worker(new URL(n.p+n.u(93),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function qa(t){return Qa.apply(this,arguments)}function Qa(){return(Qa=b(function*(t){var e=new Worker(new URL(n.p+n.u(897),n.b));return yield new Promise(function(n,r){e.onmessage=function(t){n(t.data),e.terminate()},e.onerror=function(t){r(t.message),e.terminate()},e.postMessage(t)})})).apply(this,arguments)}function Ya(){return Ya=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e,n="",r=Ra([[0,15],[1,15]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=(yield ot(i.url,t,`getSegmentBuffers_${i.e[0]}`,"xml")),vt(t,-1)}}catch(t){r.e(t)}finally{r.f()}return n}),n.apply(this,arguments)}var r="bus_segment_buffers_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e(),o=yield za(a),s=yield qa(o);return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(s)),Fa||(Fa=!0,Ja=s),s}if((new Date).getTime()-parseInt(i)>2592e6){var u=yield e(),l=yield za(u),c=yield qa(l);return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(c)),c}if(!Fa){var d=yield M(0,r);Fa=!0,Ja=JSON.parse(d)}return ct(t,"getSegmentBuffers_0",0,!0),ct(t,"getSegmentBuffers_1",0,!0),vt(t,-1),Ja}),Ya.apply(this,arguments)}var Wa={current:{latitude:0,longitude:0},permission:{gained:!1,asked:!1},id:0};function Va(){return Wa.permission.asked&&Wa.permission.gained?Wa.current:Wa.permission.asked||Wa.permission.gained?Wa.permission.asked&&!Wa.permission.gained?Wa.current:void 0:(!1===Wa.permission.asked&&Dd("display_user_location")&&(Wa.permission.asked=!0,Wa.id=navigator.geolocation.watchPosition(function(t){Wa.permission.gained=!0,Wa.current.latitude=t.coords.latitude,Wa.current.longitude=t.coords.longitude},function(t){},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0})),Wa.current)}function Ka(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ga(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ga(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ga(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Za(){return Za=b(function*(t,e,n,r,i){ct(i,"getRoute_0",0,!1),ct(i,"getRoute_1",0,!1),ct(i,"getStop_0",0,!1),ct(i,"getStop_1",0,!1),ct(i,"getLocation_0",0,!1),ct(i,"getLocation_1",0,!1),ct(i,"getSegmentBuffers_0",0,!1),ct(i,"getSegmentBuffers_1",0,!1),ct(i,"getEstimateTime_0",0,!1),ct(i,"getEstimateTime_1",0,!1),ct(i,"getBusEvent_0",0,!1),ct(i,"getBusEvent_1",0,!1),ct(i,"getBusData_0",0,!1),ct(i,"getBusData_1",0,!1);var a=yield he(i,!0),o=yield Kt(i),u=yield Jt(i,0),l=yield Jt(i,1),c=yield Jt(i,2),d=yield function(t){return Ya.apply(this,arguments)}(i),f=yield Ln(i),h=yield kt(i),p=yield wt(i),v=yield wn(n,r),y=function(t,e,n,r,i){var a,o={},s={},u=Zt(e);try{for(u.s();!(a=u.n()).done;){var l=a.value;s[l.BusID]=l}}catch(t){u.e(t)}finally{u.f()}var c,d=Zt(t);try{for(d.s();!(c=d.n()).done;){var f=c.value,h={};h.CarType=f.CarType,h.BusStatus=f.BusStatus,h.BusID=f.BusID,h.CarOnStop=f.CarOnStop;var p=parseInt(f.RouteID),v=String(f.BusID),y=!1,m=0;p===r||i.indexOf(p)>-1||p===10*r?(y=!0,m=v.charCodeAt(0)*Math.pow(10,-5)):(y=!1,m=v.charCodeAt(0)),h.onThisRoute=y,h.index=m;var g={};if(s.hasOwnProperty(v)){g=s[v],h.position={latitude:parseFloat(g.Latitude),longitude:parseFloat(g.Longitude)};var b={},w=!1;for(var A in n){var S=n[A];if(S.pid.indexOf(p)>-1){b=S,w=!0;break}}h.RouteName=w?b.n:"未知路線",h.RouteID=w?b.id:null;var _=`s_${f.StopID}`;o.hasOwnProperty(_)||(o[_]=[]),o[_].push(h)}}}catch(t){d.e(t)}finally{d.f()}return o}(h,p,a,t,e),m=!1,g={};d.hasOwnProperty(`r_${t}`)&&(m=!0,g=d[`r_${t}`]);var b,w=Dd("time_formatting_mode"),A=[],S=[],_=Ka(f);try{for(_.s();!(b=_.n()).done;){var k=b.value,I={},C=k.RouteID;if([t,10*t].includes(C)||e.includes(C)){I.status=te(null==k?void 0:k.EstimateTime,w);var E=`s_${k.StopID}`,T={};if(!o.hasOwnProperty(E))continue;T=o[E],I.id=k.StopID,I.sequence=T.seqNo,I.goBack=T.goBack;var $=`l_${T.stopLocationId}`,x={};if(!u.hasOwnProperty($))continue;x=u[$],I.name=x.n,I.overlappingRoutes=x.r.filter(function(e){return e!==t}).map(function(t){var e=`r_${t}`;if(a.hasOwnProperty(e)){var n=a[e];return{name:n.n,RouteEndPoints:{RouteDeparture:n.dep,RouteDestination:n.des,text:`${n.dep} ↔ ${n.des}`,html:`<span>${n.dep}</span><span>↔</span><span>${n.des}</span>`},RouteID:n.id,PathAttributeId:n.pid}}return null}).filter(function(t){return null!==t}),I.position={longitude:x.lo,latitude:x.la},S.push({latitude:x.la,longitude:x.lo,id:k.StopID});var L=x.g,M=[];c.hasOwnProperty(L)&&(M=c[L]);var P,O=[],D=Ka(M);try{for(D.s();!(P=D.n()).done;){var B=`ml_${P.value.hash}`;if(l.hasOwnProperty(B)){var N=l[B],j={name:N.n,distance:0|s(N.la[0],N.lo[0],x.la,x.lo),hash:N.hash};O.push(j)}}}catch(t){D.e(t)}finally{D.f()}O.sort(function(t,e){return t.distance-e.distance}),I.nearbyLocations=O;var R,U=[],F=Ka(x.s);try{for(F.s();!(R=F.n()).done;){var J=`s_${R.value}`;y.hasOwnProperty(J)&&U.push(y[J].map(function(t){return ae(t)}))}}catch(t){F.e(t)}finally{F.f()}I.buses=U.flat().sort(function(t,e){return t.index-e.index});var z=[];v.hasOwnProperty(E)&&(z=v[E]),I.busArrivalTimes=z;var H=!1,q=!1,Q=!1,Y=!1;if(m){var W=`g_${I.goBack}`,V=[];g.hasOwnProperty(W)?V=g[W]:"1"===I.goBack&&(Y=!0,V=g.g_0);var K,G=Ka(V);try{for(G.s();!(K=G.n()).done;){var Z=K.value;Z.OriginStopID!==k.StopID&&Z.DestinationStopID!==k.StopID||(H=!0),Y?(Z.OriginStopID===k.StopID&&(Q=!0),Z.DestinationStopID===k.StopID&&(q=!0)):(Z.OriginStopID===k.StopID&&(q=!0),Z.DestinationStopID===k.StopID&&(Q=!0))}}catch(t){G.e(t)}finally{G.f()}}I.segmentBuffer={isSegmentBuffer:H,isStartingPoint:q,isEndingPoint:Q},A.push(I)}}}catch(t){_.e(t)}finally{_.f()}A.sort(function(t,e){return t.sequence-e.sequence});for(var X=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:450,n=Va(),r=1/0,i=-1,a=t.length-1;a>0;a--){var o=t[a],u=s(n.latitude,n.longitude,o.latitude,o.longitude);u<=e&&u<r&&(i=a,r=u)}return i>0?t[i]:null}(S,450),tt=!1,et=!1,nt={},rt=0,it={},at=A.length,ot=0;ot<at;ot++){var st=A[ot],ut=A[ot+1]||st,lt=0;if(st.buses.length>0&&st.buses[0].onThisRoute){var dt=[st.buses[0].position.longitude,st.buses[0].position.latitude],ht=dt[0],pt=dt[1],vt=[st.position.longitude,st.position.latitude],gt=vt[0],bt=vt[1],At=[ut.position.longitude,ut.position.latitude],St=At[0],_t=At[1];if((ht-gt)*(St-ht)+(pt-bt)*(_t-pt)>=0){var It=Math.hypot(ht-gt,pt-bt),Ct=Math.hypot(ht-St,pt-_t);lt=Math.max(0,Math.min(It/(It+Ct),1))}}st.progress=lt,st.segmentBuffer.isStartingPoint&&(tt=!0),st.segmentBuffer.isEndingPoint&&tt&&(et=!0),tt&&!et&&(st.segmentBuffer.isSegmentBuffer=!0),tt&&et&&(tt=!1,et=!1);var Et=!1;null!==X&&X.id===st.id&&(Et=!0),st.nearest=Et;var Tt=`g_${st.goBack}`||"g_0";nt.hasOwnProperty(Tt)||(nt[Tt]=[],it[Tt]=0,rt+=1),nt[Tt].push(st),it[Tt]+=1}var $t=a[`r_${t}`],xt={groupedItems:nt,groupQuantity:rt,itemQuantity:it,RouteName:$t.n,RouteEndPoints:{RouteDeparture:$t.dep,RouteDestination:$t.des},dataUpdateTime:yt(i),RouteID:t,PathAttributeId:e};return ft(i),mt(i),xt}),Za.apply(this,arguments)}function Xa(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return to(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?to(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function to(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var eo=!1,no={};function ro(){return ro=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e,n=[],r=Xa([[0,9],[1,9]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getProvider_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),n.apply(this,arguments)}var r="bus_provider_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(a)),eo||(eo=!0,no=a),a}if((new Date).getTime()-parseInt(i)>5184e6){var o=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(o)),o}if(!eo){var s=yield M(0,r);eo=!0,no=JSON.parse(s)}return ct(t,"getProvider_0",0,!0),ct(t,"getProvider_1",0,!0),vt(t,-1),no}),ro.apply(this,arguments)}function io(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ao(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ao(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var oo=!1,so={};function uo(){return uo=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e,n=[],r=io([[0,12],[1,12]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getSemiTimeTable_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),n.apply(this,arguments)}var r="bus_semi_timetable_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(a)),oo||(oo=!0,so=a),a}if((new Date).getTime()-parseInt(i)>12096e5){var o=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(o)),o}if(!oo){var s=yield M(0,r);oo=!0,so=JSON.parse(s)}return ct(t,"getSemiTimeTable_0",0,!0),ct(t,"getSemiTimeTable_1",0,!0),vt(t,-1),so}),uo.apply(this,arguments)}function lo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return co(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?co(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function co(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var fo=!1,ho={};function po(){return po=b(function*(t){function e(){return n.apply(this,arguments)}function n(){return n=b(function*(){var e,n=[],r=lo([[0,14],[1,14]].map(function(t){return{url:V(t[0],t[1]),e:t}}));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=yield ot(i.url,t,`getTimeTable_${i.e[0]}`,"json");n=n.concat(a.BusInfo),vt(t,a.EssentialInfo.UpdateTime)}}catch(t){r.e(t)}finally{r.f()}return n}),n.apply(this,arguments)}var r="bus_timetable_cache",i=yield M(0,`${r}_timestamp`);if(null===i){var a=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(a)),fo||(fo=!0,ho=a),a}if((new Date).getTime()-parseInt(i)>12096e5){var o=yield e();return yield x(0,`${r}_timestamp`,(new Date).getTime()),yield x(0,r,JSON.stringify(o)),o}if(!fo){var s=yield M(0,r);fo=!0,ho=JSON.parse(s)}return ct(t,"getTimeTable_0",0,!0),ct(t,"getTimeTable_1",0,!0),vt(t,-1),ho}),po.apply(this,arguments)}function vo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return yo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yo(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function yo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function mo(t,e,n,r,i){var a,o,s,u,l,c={calendarDays:{d_0:{name:"日",day:0,code:"d_0"},d_1:{name:"一",day:1,code:"d_1"},d_2:{name:"二",day:2,code:"d_2"},d_3:{name:"三",day:3,code:"d_3"},d_4:{name:"四",day:4,code:"d_4"},d_5:{name:"五",day:5,code:"d_5"},d_6:{name:"六",day:6,code:"d_6"}},calendarDayQuantity:7,calendarEventGroups:{d_0:[],d_1:[],d_2:[],d_3:[],d_4:[],d_5:[],d_6:[]},calendarEventQuantity:{d_0:0,d_1:0,d_2:0,d_3:0,d_4:0,d_5:0,d_6:0}},d=(a=new Date,o=a.getDay(),s=a.getDate()-o,(u=new Date).setDate(s),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),u),f=vo(r);try{for(f.s();!(l=f.n()).done;){var h=l.value;if(e.indexOf(h.PathAttributeId)>-1&&"0"===h.DateType)for(var p=I(h.DateValue),v=w(d,p.day,0,0),y=ee(h.StartTime,0),m=w(v,0,y.hours,y.minutes),g=ee(h.EndTime,0),b=w(v,0,g.hours,g.minutes),S=Math.abs(60*g.hours+g.minutes-(60*y.hours+y.minutes)),_=parseInt(h.LongHeadway),k=parseInt(h.LowHeadway),C=(k+_)/2,E=S/C,T=0;T<E;T++){var $=!1,x=w(v,0,y.hours,y.minutes+k*T);x.getTime()<m.getTime()&&($=!0),x.getTime()>b.getTime()&&($=!0),!1===$&&(c.calendarEventGroups[p.code].push({date:x,dateString:A(x,"hh:mm"),duration:k,deviation:Math.abs(C-k)}),c.calendarEventQuantity[p.code]+=1)}}}catch(t){f.e(t)}finally{f.f()}var L,M=vo(i);try{for(M.s();!(L=M.n()).done;){var P=L.value;if(e.indexOf(P.PathAttributeId)>-1&&"0"===P.DateType){var O=I(P.DateValue),D=w(d,O.day,0,0),B=ee(P.DepartureTime,0),N=w(D,0,B.hours,B.minutes);c.calendarEventGroups[O.code].push({date:N,dateString:A(N,"hh:mm"),duration:15,deviation:0}),c.calendarEventQuantity[O.code]+=1}}}catch(t){M.e(t)}finally{M.f()}for(var j in c.calendarEventGroups)c.calendarEventGroups[j].sort(function(t,e){return t.date.getTime()-e.date.getTime()});return c}function go(){return go=b(function*(t,e,n){var r=function(t,e){var n,r={},i=vo(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.Id===e){r=a;break}}}catch(t){i.e(t)}finally{i.f()}return r}(yield he(n,!1),t),i=yield function(t){return uo.apply(this,arguments)}(n),a=yield function(t){return po.apply(this,arguments)}(n),o=yield function(t){return ro.apply(this,arguments)}(n),s=function(t){var e=ee(t.goFirstBusTime,0),n=ee(t.goLastBusTime,0),r=ee(t.backFirstBusTime,0),i=ee(t.backLastBusTime,0),a=ee(t.holidayGoFirstBusTime,0),o=ee(t.holidayGoLastBusTime,0),s=ee(t.holidayBackFirstBusTime,0),u=ee(t.holidayBackLastBusTime,0),l=ee(t.peakHeadway,1),c=ee(t.offPeakHeadway,1),d=ee(t.holidayPeakHeadway,1),f=ee(t.holidayOffPeakHeadway,1);return{go:{weekday:{first:e,last:n,rushHourWindow:l,offRushHourWindow:c},holiday:{first:a,last:o,rushHourWindow:d,offRushHourWindow:f}},back:{weekday:{first:r,last:i,rushHourWindow:l,offRushHourWindow:c},holiday:{first:s,last:u,rushHourWindow:d,offRushHourWindow:f}},realSequence:t.realSequence}}(r),u=mo(0,e,0,i,a),l=function(t,e){var n,r={},i=vo(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.id===e&&(r=a)}}catch(t){i.e(t)}finally{i.f()}return r}(o,r.providerId),c={timeTableRules:s,calendar:u,properties:[{key:"route_name",icon:"route",value:r.nameZh},{key:"pricing",icon:"attach_money",value:r.ticketPriceDescriptionZh},{key:"provider_name",icon:"corporate_fare",value:l.nameZn},{key:"provider_phone",icon:"call",value:l.phoneInfo},{key:"provider_email",icon:"alternate_email",value:l.email}]};return ft(n),mt(n),c}),go.apply(this,arguments)}function bo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return wo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wo(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function wo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Ao=n(157);function So(t){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#000000",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4,o=[[[-1,0],[0,-1]],[[0,-1],[1,0]],[[1,0],[0,1]],[[0,1],[-1,0]]],s=[[[-1,0],[-1,-1],[0,-1]],[[0,-1],[1,-1],[1,0]],[[1,0],[1,1],[0,1]],[[0,1],[-1,1],[-1,0]]],u=function(t,e){for(var n=Ao.create(t,{errorCorrectionLevel:e}),r=n.modules.size,i=[],a=0;a<r;a++){for(var o=[],s=0;s<r;s++){var u=n.modules.get(s,a);o.push(u)}i.push(o)}return i}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"L"),l=u.length,c=[],d=0;d<l;d++)for(var f=0;f<l;f++)if(1===u[d][f]){for(var h=new Uint8Array(4),p=0;p<4;p++){var v,y=1,m=bo(o[p]);try{for(m.s();!(v=m.n()).done;){var g,b=v.value;1===(null===(g=u[d+b[1]])||void 0===g?void 0:g[f+b[0]])&&(y*=0)}}catch(t){m.e(t)}finally{m.f()}h[p]=y}c=c.concat(Xi((f+r)*a,(d+r)*a,1*a,1*a,{tl:h[0]*e*a,tr:h[1]*e*a,br:h[2]*e*a,bl:h[3]*e*a},!1))}else{for(var w=new Uint8Array(4),A=0;A<4;A++){var S,_=1,k=bo(s[A]);try{for(k.s();!(S=k.n()).done;){var I,C=S.value;null!==(I=u[d+C[1]])&&void 0!==I&&I[f+C[0]]||(_*=0)}}catch(t){k.e(t)}finally{k.f()}w[A]=_}w.some(function(t){return 0!==t})&&(c=c.concat(Xi((f+r)*a,(d+r)*a,1*a,1*a,{tl:w[0]*n*a,tr:w[1]*n*a,br:w[2]*n*a,bl:w[3]*n*a},!0)))}return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${(l+2*r)*a} ${(l+2*r)*a}" shape-rendering="geometricPrecision"><path d="${c.join(" ")}" fill="${i}" stroke="${i}" stroke-width="0.1" stroke-linejoin="round" fill-rule="nonzero" /></svg>`}var _o=H(".zc"),ko=Q(_o,"._c");function Io(t){mc("QRCode"),_o.setAttribute("displayed","true"),function(t){var e=So(t,"M",.5,.3,1,"var(--ad)",4);ko.innerHTML=e}(t)}function Co(){return(Co=b(function*(t){var e=yield me(t);if(!1!==e){var n=Zs(0,{id:t,name:e.n});navigator.share&&navigator.share({title:e.n,url:n}).then(function(){jd("check_circle","已分享路線")}).catch(function(t){jd("cancel","已取消分享")})}})).apply(this,arguments)}function Eo(){return(Eo=b(function*(t){var e=yield me(t);!1!==e&&Io(Zs(0,{id:t,name:e.n}))})).apply(this,arguments)}function To(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$o(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function $o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var xo='"Noto Sans TC", sans-serif',Lo=Ac("route-details-canvas"),Mo=Lo.width,Po=Lo.height,Oo=Math.min(window.devicePixelRatio,1.875)||1,Do={};function Bo(){var t=document.createElement("div");return t.classList.add("bd"),{element:t,id:""}}function No(){var t=document.createElement("div");t.classList.add("cd");var e=document.createElement("canvas");return e.classList.add("dd"),t.appendChild(e),{element:t,id:""}}function jo(t,e,n,r,i,a){t.innerText=e.name,t.setAttribute("day",a.toString()),t.onclick=function(){!function(t){for(var e=Dd("playing_animation"),n=Y(Go,".bd"),r=Y(Zo,".cd"),i=0;i<7;i++){var a,o,s=n[i],u=r[i],l=`d_${i}`,c=null===(a=Do)||void 0===a?void 0:a.calendarEventGroups[l],d=null===(o=Do)||void 0===o?void 0:o.calendarDays[l];if(c&&d){var f=ea("--ed"),h=ea("--fd"),p=ea("--gd"),v=ea("--hd"),y=ea("--id"),m=ea("--jd");jo(s,d,t,!1,e,i),Ro(u,c,t,y,f,h,p,v,m,i)}}}(a)},t.setAttribute("highlighted",n===a?"true":"false"),t.setAttribute("animation",Qd(i)),t.setAttribute("skeleton-screen",Qd(r))}function Ro(t,e,n,r,i,a,o,s,u,l){function c(t,e,n){var r=70*e;t.fillStyle=n,t.fillRect(45,r+5,Mo-45,1.2),t.font=`400 12px ${xo}`,t.textBaseline="top";var i=`${String(e).padStart(2,"0")}:00`,a=t.measureText(i),o=a.width,s=a.actualBoundingBoxDescent;t.fillText(i,(45-o)/2,r+(10-s)/2,o)}function d(t,e,n,r,i,a,o){var s=new Date;s.setDate(1),s.setMonth(0),s.setFullYear(e.date.getFullYear()),s.setMonth(e.date.getMonth()),s.setDate(e.date.getDate()),s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0);var u=(e.date.getTime()-s.getTime())/864e5*24*70,l=Mo-45,c=60*e.duration*1e3/864e5*24*70;Zi(t,45,u,l,c,3,`rgba(${r}, ${i}, ${a}, ${o})`),Zi(t,45,u,3,c,{tl:3,tr:0,bl:3,br:0},n),t.font=`400 14px ${xo}`,t.textBaseline="top",t.fillStyle=n;var d=e.dateString,f=t.measureText(d),h=f.width,p=f.actualBoundingBoxDescent;t.fillText(d,53,u+(c-p)/2,h)}var f=Q(t,".dd"),h=f.getContext("2d");if(function(t,e,n){var r=e===n;t.setAttribute("displayed",Qd(r))}(t,n,l),function(t){Lo=Ac("route-details-canvas"),Mo=Lo.width,Po=Lo.height,Oo=Math.min(window.devicePixelRatio,1.875)||1,t.width=Mo*Oo,t.height=Po*Oo;var e=t.getContext("2d");e.setTransform(1,0,0,1,0,0),e.scale(Oo,Oo)}(f),n===l){h.clearRect(0,0,Mo,Po);for(var p=0;p<24;p++)c(h,p,u);var v,y=To(e);try{for(y.s();!(v=y.n()).done;){d(h,v.value,r,i,a,o,s)}}catch(t){y.e(t)}finally{y.f()}}else h.clearRect(0,0,Mo,Po)}function Uo(t,e,n){var r=(new Date).getDay(),i=ea("--ed"),a=ea("--fd"),o=ea("--gd"),s=ea("--hd"),u=ea("--id"),l=ea("--jd"),c=t.calendarDays,d=t.calendarDayQuantity,f=t.calendarEventGroups,h=(t.calendarEventQuantity,Y(Zo,".cd").length);if(d!==h){var p=h-d;if(p<0){for(var v=new DocumentFragment,y=new DocumentFragment,m=0,g=Math.abs(p);m<g;m++){var b=Bo();v.appendChild(b.element);var w=No();y.appendChild(w.element)}Go.append(v),Zo.append(y)}else for(var A=Y(Go,".bd"),S=Y(Zo,".cd"),_=0,k=Math.abs(p);_<k;_++){var I=h-1-_;A[I].remove(),S[I].remove()}}for(var C=Y(Go,".bd"),E=Y(Zo,".cd"),T=0;T<d;T++){var $=`d_${T}`,x=c[$],L=f[$],M=C[T],P=E[T];jo(M,x,r,e,n,T),Ro(P,L,r,u,i,a,o,s,l,T)}Do=t}var Fo=[],Jo=!1,zo=!1;function Ho(){var t=document.createElement("div");t.classList.add("kd");var e=document.createElement("div");e.classList.add("ld"),e.appendChild(je()),t.appendChild(e);var n=document.createElement("div");return n.classList.add("md"),t.appendChild(n),{element:t,id:""}}function qo(t,e,n){function r(t,r,i){function a(t,e){Re(Q(t,".ld"),e.icon)}function o(t,e){Q(t,".md").innerText=e.value}function s(t,e){t.setAttribute("animation",Qd(e))}function u(t,e){t.setAttribute("skeleton-screen",Qd(e))}null==i?(a(t,r),o(t,r),s(t,n),u(t,e)):(Fd(i,r)||a(t,r),Fd(i,r)||o(t,r),Jo!==n&&s(t,n),zo!==e&&u(t,e))}var i=t.length;e!==zo&&rs.setAttribute("skeleton-screen",Qd(e));var a=Y(is,".kd").length;if(i!==a){var o=a-i;if(o<0){for(var s=new DocumentFragment,u=0,l=Math.abs(o);u<l;u++){var c=Ho();s.appendChild(c.element)}is.append(s)}else for(var d=Y(is,".kd"),f=0,h=Math.abs(o);f<h;f++){d[a-1-f].remove()}}for(var p=Y(is,".kd"),v=0;v<i;v++){var y=p[v],m=t[v];0===Fo.length?r(y,m,null):r(y,m,Fo[v])}Fo=t,Jo=n,zo=e}var Qo=H(".nc"),Yo=Q(Qo,".oc"),Wo=Q(Yo,".pc"),Vo=Q(Wo,'.qc[group="calendar"]'),Ko=Q(Vo,".rc"),Go=Q(Ko,".nd"),Zo=Q(Ko,".od"),Xo=Q(Qo,'.oc .pc .qc[group="actions"]'),ts=Q(Xo,'.rc .sc[action="save-to-folder"]'),es=Q(Xo,'.rc .sc[action="get-permalink"]'),ns=Q(Xo,'.rc .sc[action="show-permalink-qrcode"]'),rs=Q(Wo,'.qc[group="properties"]'),is=Q(rs,".rc");function as(){return as=b(function*(t,e){var n=Dd("playing_animation"),r=yield Xn("route",t);ts.setAttribute("animation",Qd(n)),ts.setAttribute("highlighted",Qd(r)),ts.onclick=function(){Ta("route",[t])},es.setAttribute("animation",Qd(n)),es.onclick=function(){!function(t){Co.apply(this,arguments)}(t)},ns.setAttribute("animation",Qd(n)),ns.onclick=function(){!function(t){Eo.apply(this,arguments)}(t)},function(){for(var t=Dd("playing_animation"),e=[],n=0;n<5;n++)e.push({key:n,icon:"none",value:""});qo(e,!0,t)}(),function(){for(var t=Dd("playing_animation"),e={d_0:47,d_1:47,d_2:47,d_3:47,d_4:47,d_5:47,d_6:47},n={},r={},i=0;i<7;i++){var a=`d_${i}`;n[a]=[],r[a]={day:i,code:"d_{i}",name:""};for(var o=0;o<e[a];o++){var s=new Date;s.setHours(0),s.setMinutes(30*o),s.setSeconds(0),s.setMilliseconds(0),n[a].push({date:s,dateString:"",duration:15})}}Uo({calendarEventGroups:n,calendarDays:r,calendarDayQuantity:7,calendarEventQuantity:e},!0,t)}();var i=Jd(),a=yield function(t,e,n){return go.apply(this,arguments)}(t,e,i);qo(a.properties,!1,n),Uo(a.calendar,!1,n)}),as.apply(this,arguments)}function os(t,e){mc("RouteDetails"),Qo.setAttribute("displayed","true"),function(t,e){as.apply(this,arguments)}(t,e)}function ss(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return us(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?us(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function us(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ls=H(".xb"),cs=Q(ls,".pd"),ds=Q(cs,".qd"),fs=Q(ds,"span"),hs=Q(cs,".rd"),ps=Q(cs,".sd .td"),vs=Q(cs,".ud"),ys=Q(vs,".vd"),ms=Q(cs,".wd"),gs=Q(ms,".xd"),bs=Q(ls,".yb"),ws={},As=!1,Ss=!1,_s=0,ks=0,Is={},Cs=0,Es=!1,Ts=15e3,$s=5e3,xs=15e3,Ls=!0,Ms=0,Ps=0,Os="",Ds=!1,Bs=!1,Ns=!1,js=0,Rs=[];function Us(t,e,n,r){bs.style.setProperty("--yd",t.toString()),gs.style.setProperty("--zd",n.toString()),ys.style.setProperty("--_d",`${e.toString()}px`),ys.style.setProperty("--ae",r.toString())}function Fs(t){var e=t;if(Ds){var n=e.detail.progress-1;ps.style.setProperty("--de",n.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,Fs)}function Js(){var t=Jd(),e=document.createElement("div");e.classList.add("ee"),e.id=t,e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var n=document.createElement("div");n.classList.add("fe");var r=document.createElement("div");r.classList.add("ge"),r.setAttribute("displayed","false"),n.appendChild(r);var i=document.createElement("div");i.classList.add("he");var a=document.createElement("div");a.classList.add("ie"),a.setAttribute("code","0"),a.setAttribute("displayed","false"),i.appendChild(a);var o=document.createElement("div");return o.classList.add("je"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),i.appendChild(o),e.appendChild(n),e.appendChild(i),{element:e,id:t}}function zs(t){var e=Jd(),n=document.createElement("div");n.classList.add("bc"),n.id=e,n.setAttribute("stretched","false"),n.setAttribute("stretching","false"),n.setAttribute("push-direction","0"),n.setAttribute("push-state","0");var r=document.createElement("div");r.classList.add("ke");var i=document.createElement("div");i.classList.add("le"),r.appendChild(i);var a=document.createElement("div");a.classList.add("me");var o=document.createElement("div");o.classList.add("ne");var s=document.createElement("div");s.classList.add("ie"),s.setAttribute("code","0"),s.setAttribute("displayed","false"),o.appendChild(s);var u=document.createElement("div");u.classList.add("je"),u.setAttribute("code","0"),u.setAttribute("displayed","true"),o.appendChild(u),a.appendChild(o);var l=document.createElement("div");l.classList.add("oe"),l.appendChild(Ne("keyboard_arrow_down")),l.onclick=function(){!function(t,e){var n=Q(bs,`.zb ._b .ac .bc#${t}`),r=Q(n,".cc"),i=Q(bs,`.zb ._b .ve .ee#${e}`),a=n.parentElement,o=i.parentElement,s=W(i,"ee"),u=W(n,"bc"),l=u.length,c=a.getBoundingClientRect(),d=n.getBoundingClientRect(),f=o.getBoundingClientRect(),h=i.getBoundingClientRect().top-f.top,p=d.top-c.top,v="true"===n.getAttribute("stretched"),y="true"===n.getAttribute("animation");if(y){var m=v?"2":"1";i.setAttribute("stretching","true"),i.style.setProperty("--ig",`${h}px`),n.setAttribute("stretching","true"),n.style.setProperty("--kg",`${p}px`);for(var g=0;g<l;g++){var b=u[g],w=s[g];w.style.setProperty("--lg",(-1*g-1).toString()),w.setAttribute("push-direction",m),w.setAttribute("push-state","1"),b.setAttribute("push-direction",m),b.setAttribute("push-state","1")}n.addEventListener("transitionend",function(){for(var t=0;t<l;t++){var e=u[t],r=s[t];r.setAttribute("push-direction","0"),r.setAttribute("push-state","0"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0")}i.setAttribute("stretching","false"),n.setAttribute("stretching","false")},{once:!0}),n.addEventListener("transitionstart",function(){for(var t=0;t<l;t++){var e=u[t];s[t].setAttribute("push-state","2"),e.setAttribute("push-state","2")}},{once:!0})}v?(y?r.addEventListener("transitionend",function(){r.setAttribute("displayed","false")},{once:!0}):r.setAttribute("displayed","false"),n.setAttribute("stretched","false"),i.setAttribute("stretched","false")):(r.setAttribute("displayed","true"),n.setAttribute("stretched","true"),i.setAttribute("stretched","true"))}(e,t)},a.appendChild(l);var c=document.createElement("div");c.classList.add("pe"),a.appendChild(c),r.appendChild(a);var d=document.createElement("div");d.classList.add("cc"),d.setAttribute("displayed","false");var f=document.createElement("div");f.classList.add("dc");var h=document.createElement("div");h.classList.add("ec"),h.setAttribute("highlighted","true"),h.setAttribute("type","tab"),h.setAttribute("code","0"),h.onclick=function(){Gs(e,0)};var p=document.createElement("div");p.classList.add("qe"),p.appendChild(Ne("directions_bus")),h.appendChild(p),h.appendChild(document.createTextNode("公車")),f.appendChild(h);var v=document.createElement("div");v.classList.add("ec"),v.setAttribute("highlighted","false"),v.setAttribute("type","tab"),v.setAttribute("code","1"),v.onclick=function(){Gs(e,1)};var y=document.createElement("div");y.classList.add("qe"),y.appendChild(Ne("departure_board")),v.appendChild(y),v.appendChild(document.createTextNode("抵達時間")),f.appendChild(v);var m=document.createElement("div");m.classList.add("ec"),m.setAttribute("highlighted","false"),m.setAttribute("type","tab"),m.setAttribute("code","2"),m.onclick=function(){Gs(e,2)};var g=document.createElement("div");g.classList.add("qe"),g.appendChild(Ne("route")),m.appendChild(g),m.appendChild(document.createTextNode("路線")),f.appendChild(m);var b=document.createElement("div");b.classList.add("ec"),b.setAttribute("highlighted","false"),b.setAttribute("type","tab"),b.setAttribute("code","3"),b.onclick=function(){Gs(e,3)};var w=document.createElement("div");w.classList.add("qe"),w.appendChild(Ne("location_on")),b.appendChild(w),b.appendChild(document.createTextNode("地點")),f.appendChild(b);var A=document.createElement("div");A.classList.add("ec"),A.setAttribute("highlighted","false"),A.setAttribute("type","save-to-folder");var S=document.createElement("div");S.classList.add("qe"),S.appendChild(Ne("folder")),A.appendChild(S),A.appendChild(document.createTextNode("儲存")),f.appendChild(A);var _=document.createElement("div");_.classList.add("ec"),_.setAttribute("highlighted","false"),_.setAttribute("type","schedule-notification"),_.setAttribute("enabled","true");var k=document.createElement("div");k.classList.add("qe"),k.appendChild(Ne("notifications")),_.appendChild(k),_.appendChild(document.createTextNode("通知")),f.appendChild(_),d.appendChild(f);var I=document.createElement("div");I.classList.add("re"),I.setAttribute("displayed","true"),d.appendChild(I);var C=document.createElement("div");C.classList.add("se"),C.setAttribute("displayed","false"),d.appendChild(C);var E=document.createElement("div");E.classList.add("te"),E.setAttribute("displayed","false"),d.appendChild(E);var T=document.createElement("div");return T.classList.add("ue"),T.setAttribute("displayed","false"),d.appendChild(T),n.appendChild(r),n.appendChild(d),{element:n,id:e}}function Hs(){var t=document.createElement("div");t.classList.add("zb");var e=document.createElement("div");e.classList.add("_b");var n=document.createElement("div");n.classList.add("ve");var r=document.createElement("div");r.classList.add("we");var i=document.createElement("div");i.classList.add("ac");var a=document.createElement("div");return a.classList.add("xe"),i.appendChild(a),n.appendChild(r),e.appendChild(n),e.appendChild(i),t.appendChild(e),{element:t,id:""}}function qs(){var t=document.createElement("div");return t.classList.add("ye"),{element:t,id:""}}function Qs(t,e,n){var r,i;function a(e,n,r,i,a,o){function s(t,e,n,r,i){var a=Q(e,".he"),o=Q(a,".je"),s=Q(a,".ie"),u=Q(t,".ne"),l=Q(u,".je"),c=Q(u,".ie");if(s.setAttribute("code",n.status.code.toString()),c.setAttribute("code",n.status.code.toString()),c.innerText=n.status.text,!r&&i){var d=t.getBoundingClientRect(),f=d.top,h=d.left,p=d.bottom,v=d.right,y=window.innerWidth,m=window.innerHeight;if(p>0&&f<m&&v>0&&h<y)return o.addEventListener("animationend",function(){o.setAttribute("code",n.status.code.toString()),o.classList.remove("ze"),s.setAttribute("displayed","false")},{once:!0}),l.addEventListener("animationend",function(){l.setAttribute("code",n.status.code.toString()),l.innerText=n.status.text,l.classList.remove("ze"),c.setAttribute("displayed","false")},{once:!0}),c.setAttribute("displayed","true"),s.setAttribute("displayed","true"),o.classList.add("ze"),void l.classList.add("ze")}o.setAttribute("code",n.status.code.toString()),l.setAttribute("code",n.status.code.toString()),l.innerText=n.status.text}function u(t,e,n){t.setAttribute("segment-buffer",Qd(n.segmentBuffer.isSegmentBuffer)),e.setAttribute("segment-buffer",Qd(n.segmentBuffer.isSegmentBuffer))}function l(t,e){Q(t,".le").innerText=e.name}function c(t,e){Q(t,".re").innerHTML=0===e.buses.length?'<div class="_e">目前沒有公車可顯示</div>':e.buses.map(function(t){return`<div class="af" on-this-route="${t.onThisRoute}"><div class="bf"><div class="cf">${Be("directions_bus")}</div><div class="df">${t.carNumber}</div></div><div class="ef"><div class="ff">路線：${t.RouteName}</div><div class="gf">狀態：${t.status.text}</div><div class="hf">類型：${t.type}</div></div></div>`}).join("")}function d(t,e){Q(t,".se").innerHTML=0===e.overlappingRoutes.length?'<div class="if">目前沒有路線可顯示</div>':e.overlappingRoutes.map(function(t){return`<div class="jf"><div class="kf"><div class="lf">${Be("route")}</div><div class="mf">${t.name}</div></div><div class="nf">${t.RouteEndPoints.html}</div><div class="of"><div class="pf" onclick="bus.route.switchRoute(${t.RouteID}, [${t.PathAttributeId.join(",")}])">查看路線</div><div class="pf" onclick="bus.folder.openSaveToFolder('route-on-route', [${t.RouteID}])">儲存路線</div></div></div>`}).join("")}function f(t,e){Q(t,".te").innerHTML=0===e.busArrivalTimes.length?'<div class="qf">目前沒有抵達時間可顯示</div>':e.busArrivalTimes.map(function(t){return`<div class="rf"><div class="sf"><div class="tf">${Be("calendar_view_day")}</div><div class="uf">${t.personalSchedule.name}</div><div class="vf">週${k(t.day).name} ${C(t.personalSchedule.period.start)} - ${C(t.personalSchedule.period.end)}</div></div><div class="wf">${t.chart}</div></div>`}).join("")}function h(t,e){Q(t,".ue").innerHTML=0===e.nearbyLocations.length?'<div class="xf">目前沒有地點可顯示</div>':e.nearbyLocations.map(function(t){return`<div class="yf"><div class="zf"><div class="_f">${Be("location_on")}</div><div class="ag">${t.name}</div></div><div class="bg">${t.distance}公尺</div><div class="cg"><div class="dg" onclick="bus.location.openLocation('${t.hash}')">查看地點</div><div class="dg" onclick="bus.folder.openSaveToFolder('location-on-route', ['${t.hash}'])">儲存地點</div></div></div>`}).join("")}function p(t,e,n){t.setAttribute("nearest",Qd(n.nearest)),e.setAttribute("nearest",Qd(n.nearest))}function v(t,e,n,r,i){var a=(null==n?void 0:n.progress)||0,o=(null==e?void 0:e.progress)||0,s=Q(t,".fe .ge");if(!r&&i&&0!==a&&0===o&&Math.abs(o-a)>0)return s.style.setProperty("--eg","100%"),void s.addEventListener("transitionend",function(){s.setAttribute("displayed","false"),s.style.setProperty("--eg","-100%")},{once:!0});o>0?(s.setAttribute("displayed","true"),s.style.setProperty("--eg",100*(o-1)+"%")):s.setAttribute("displayed","false")}function y(t,e,n){n&&(Q(t,".cc").setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false"))}function m(t,e,n){t.setAttribute("animation",Qd(n)),e.setAttribute("animation",Qd(n))}function g(t,e,n){t.setAttribute("skeleton-screen",Qd(n)),e.setAttribute("skeleton-screen",Qd(n))}function b(e,n){var r=Q(e,'.cc .dc .ec[type="save-to-folder"]');r.onclick=function(){Ta("stop-on-route",[e.id,n.id,t.RouteID])},Xn("stop",n.id).then(function(t){r.setAttribute("highlighted",Qd(t))})}function w(e,n){var r=Q(e,'.cc .dc .ec[type="schedule-notification"]');r.onclick=function(){Ba("stop-on-route",[e.id,n.id,t.RouteID,n.status.time])};var i=Ri(n.id);r.setAttribute("highlighted",Qd(i))}null===i?(s(e,n,r,a,o),l(e,r),c(e,r),d(e,r),f(e,r),h(e,r),u(e,n,r),p(e,n,r),v(n,r,i,a,o),y(e,n,a),m(e,n,o),g(e,n,a),b(e,r),w(e,r)):(r.status.time!==i.status.time&&(s(e,n,r,a,o),w(e,r)),Fd(i.buses,r.buses)||c(e,r),Fd(i.busArrivalTimes,r.busArrivalTimes)||f(e,r),i.nearest!==r.nearest&&p(e,n,r),i.progress!==r.progress&&v(n,r,i,a,o),i.id!==r.id&&(l(e,r),u(e,n,r),d(e,r),h(e,r),b(e,r),w(e,r)),As!==o&&m(e,n,o),Ss!==a&&(y(e,n,a),g(e,n,a)))}var o=Ac("window"),s=o.width,u=o.height,l=t.groupQuantity,c=t.itemQuantity,d=t.groupedItems;ks=l,Cs=s;for(var f=0,h=[t.RouteEndPoints.RouteDestination,t.RouteEndPoints.RouteDeparture,"未知"].map(function(t){return`往${t}`}),p=0;p<l;p++){var v=`g_${p}`,y=Gi(h[p],500,"17px",'"Noto Sans TC", sans-serif')+20;Is[v]={width:y,offset:f},f+=y}if(Is[`g_${l}`]={width:0,offset:f},!Es){var m=Is[`g_${_s}`],g=-1*m.offset+.5*Cs-.5*m.width,b=m.width-20;Us(ks,g,b,_s)}Ss!==e&&(ds.setAttribute("skeleton-screen",Qd(e)),vs.setAttribute("skeleton-screen",Qd(e)),ms.setAttribute("skeleton-screen",Qd(e))),As!==n&&(ds.setAttribute("animation",Qd(n)),vs.setAttribute("animation",Qd(n)),ms.setAttribute("animation",Qd(n))),(null===(r=ws)||void 0===r?void 0:r.RouteID)!==t.RouteID&&(hs.onclick=function(){os(t.RouteID,t.PathAttributeId)}),(null===(i=ws)||void 0===i?void 0:i.RouteName)!==t.RouteName&&(fs.innerText=t.RouteName);var w=Y(bs,".zb").length;if(l!==w){var A=w-l;if(A<0){for(var S=new DocumentFragment,_=new DocumentFragment,I=0,E=Math.abs(A);I<E;I++){var T=Hs();S.appendChild(T.element);var $=qs();_.appendChild($.element)}bs.append(S),ys.append(_)}else for(var x=Y(bs,".zb"),L=Y(ys,".ye"),M=0,P=Math.abs(A);M<P;M++){var O=w-1-M;x[O].remove(),L[O].remove()}}for(var D=Y(bs,".zb"),B=0;B<l;B++){var N=`g_${B}`,j=D[B],R=Q(j,".ac"),U=Q(j,".ve"),F=Y(R,".bc").length;if(c[N]!==F){var J=F-c[N];if(J<0){for(var z=new DocumentFragment,H=new DocumentFragment,q=0,W=Math.abs(J);q<W;q++){var V=Js(),K=zs(V.id);z.appendChild(K.element),H.appendChild(V.element)}R.append(z),U.append(H)}else for(var G=Y(R,".bc"),Z=Y(U,".ee"),X=0,tt=Math.abs(J);X<tt;X++){var et=F-1-X;G[et].remove(),Z[et].remove()}}}for(var nt=Y(ys,".ye"),rt=0;rt<l;rt++){var it=`g_${rt}`,at=nt[rt];at.innerHTML=[t.RouteEndPoints.RouteDestination,t.RouteEndPoints.RouteDeparture,""].map(function(t){return`<span>往${t}</span>`})[rt],at.style.setProperty("--fg",`${Is[it].width}px`),at.style.setProperty("--gg",rt.toString());var ot=D[rt];e&&(ot.scrollTop=0);for(var st=Q(ot,".ac"),ut=Q(ot,".ve"),lt=Y(st,".bc"),ct=Y(ut,".ee"),dt=0;dt<c[it];dt++){var ft=lt[dt],ht=ct[dt],pt=d[it][dt];if(ws.hasOwnProperty("groupedItems"))if(ws.groupedItems.hasOwnProperty(it))if(ws.groupedItems[it][dt])a(ft,ht,pt,ws.groupedItems[it][dt],e,n);else a(ft,ht,pt,null,e,n);else a(ft,ht,pt,null,e,n);else a(ft,ht,pt,null,e,n)}}ws=t,As=n,Ss=e}function Ys(){return Ws.apply(this,arguments)}function Ws(){return Ws=b(function*(){var t=Dd("playing_animation"),e=Dd("refresh_interval"),n=Ac("route-bus-arrival-time-chart");Ls=e.dynamic,Ts=e.baseInterval,Ds=!0,Os=Jd(),ps.setAttribute("refreshing","true"),ps.classList.remove("ce"),document.addEventListener(Os,Fs);var r=yield function(t,e,n,r,i){return Za.apply(this,arguments)}(js,Rs,n.width,n.height,Os);Qs(r,!1,t);var i=0;Ls&&(i=yield En()),Ms=(new Date).getTime(),Ps=Ls?Math.max(Ms+$s,r.dataUpdateTime+Ts/i):Ms+Ts,xs=Math.max($s,Ps-Ms),Ds=!1,ps.setAttribute("refreshing","false"),ps.style.setProperty("--be",`${xs}ms`),ps.classList.add("ce")}),Ws.apply(this,arguments)}function Vs(){Ys().then(function(){Bs?setTimeout(function(){Vs()},Math.max($s,Ps-(new Date).getTime())):Ns=!1}).catch(function(t){Bs?(jd("error","路線網路連線中斷，將在10秒後重試。"),setTimeout(function(){Vs()},1e4)):Ns=!1})}function Ks(t,e){mc("Route"),Me("route",t),js=t,Rs=e,_s=0,Is={},ls.setAttribute("displayed","true"),bs.scrollLeft=0,bs.focus(),function(t,e){for(var n=Dd("playing_animation"),r=Ac("window"),i=(r.width,r.height),a=Math.floor(i/50)+5,o={},s=0;s<2;s++){var u=`g_${s}`;o[u]=[];for(var l=0;l<a;l++)o[u].push({name:"",goBack:"0",status:{code:8,text:"",time:-6},buses:[],overlappingRoutes:[],busArrivalTimes:[],nearbyLocations:[],sequence:l,position:{longitude:0,latitude:0},nearest:!1,progress:0,segmentBuffer:{isSegmentBuffer:!1,isStartingPoint:!1,isEndingPoint:!1},id:0})}Qs({groupedItems:o,groupQuantity:2,itemQuantity:{g_0:a,g_1:a},RouteName:"載入中",RouteEndPoints:{RouteDeparture:"載入中",RouteDestination:"載入中"},RouteID:t,PathAttributeId:e,dataUpdateTime:0},!0,n)}(t,e),Bs||(Bs=!0,Ns?Ys():(Ns=!0,Vs())),bc()}function Gs(t,e){var n,r=Q(bs,`.bc#${t}`),i=Q(r,".dc"),a=ss(Y(i,'.ec[highlighted="true"][type="tab"]'));try{for(a.s();!(n=a.n()).done;){n.value.setAttribute("highlighted","false")}}catch(t){a.e(t)}finally{a.f()}switch(Q(i,`.ec[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:Q(r,".re").setAttribute("displayed","true"),Q(r,".te").setAttribute("displayed","false"),Q(r,".se").setAttribute("displayed","false"),Q(r,".ue").setAttribute("displayed","false");break;case 1:Q(r,".re").setAttribute("displayed","false"),Q(r,".te").setAttribute("displayed","true"),Q(r,".se").setAttribute("displayed","false"),Q(r,".ue").setAttribute("displayed","false");break;case 2:Q(r,".re").setAttribute("displayed","false"),Q(r,".te").setAttribute("displayed","false"),Q(r,".se").setAttribute("displayed","true"),Q(r,".ue").setAttribute("displayed","false");break;case 3:Q(r,".re").setAttribute("displayed","false"),Q(r,".te").setAttribute("displayed","false"),Q(r,".se").setAttribute("displayed","false"),Q(r,".ue").setAttribute("displayed","true")}}function Zs(t,e){var n=new URL("https://erichsia7.github.io/bus/");switch(t){case 0:n.searchParams.set("permalink",`0@${parseInt(e.id).toString(16)}~${e.name}`);break;case 1:n.searchParams.set("permalink",`1@${e.hash}`)}return decodeURIComponent(n.toString())}var Xs={},tu=!1,eu=!1,nu=H(".mg"),ru=Q(nu,".ng"),iu=Q(ru,".og");function au(){var t=document.createElement("div");t.classList.add("pg");var e=document.createElement("div");e.classList.add("qg"),e.appendChild(je()),t.appendChild(e);var n=document.createElement("div");return n.classList.add("rg"),t.appendChild(n),{element:t,id:""}}function ou(t,e,n){function r(t,r,i){function a(t,e){Re(Q(t,".qg"),e.icon)}function o(t,e){Q(t,".rg").innerText=e.name}function s(t,e){t.onclick=e.action}function u(t,e){t.setAttribute("animation",Qd(e))}function l(t,e){t.setAttribute("skeleton-screen",Qd(e))}null==i?(a(t,r),o(t,r),s(t,r),u(t,n),l(t,e)):(i.key!==r.key&&(a(t,r),o(t,r),s(t,r)),n!==tu&&u(t,n),e!==eu&&l(t,e))}var i=t.actions,a=t.actionsQuantity,o=Y(iu,".pg").length;if(a!==o){var s=o-a;if(s<0){for(var u=new DocumentFragment,l=0,c=Math.abs(s);l<c;l++){var d=au();u.appendChild(d.element)}iu.append(u)}else for(var f=Y(iu,".pg"),h=0,p=Math.abs(s);h<p;h++){f[o-1-h].remove()}}for(var v=Y(iu,".pg"),y=0;y<a;y++){var m=v[y],g=i[y];if(Xs.hasOwnProperty("actions"))if(Xs.actions[y])r(m,g,Xs.actions[y]);else r(m,g,null);else r(m,g,null)}Xs=t,tu=n,eu=e}function su(){return su=b(function*(t){var e=Dd("playing_animation"),n=Jd(),r=yield function(t,e){return ja.apply(this,arguments)}(t,n);ou(r,!1,e)}),su.apply(this,arguments)}function uu(t){mc("LocationDetails"),nu.setAttribute("displayed","true"),function(){for(var t=Dd("playing_animation"),e=[],n=0;n<3;n++)e.push({name:"",icon:"",key:`action-${n}`,action:function(){}});ou({actions:e,actionsQuantity:3,hash:""},!0,t)}(),function(t){su.apply(this,arguments)}(t)}function lu(){return(lu=b(function*(t){var e=Jd(),n=yield Jt(e,1);ft(e),mt(e);var r=`ml_${t}`;if(n.hasOwnProperty(r)){var i=n[r],a=Zs(1,{hash:t});navigator.share&&navigator.share({title:i.n,url:a}).then(function(){jd("check_circle","已分享地點")}).catch(function(t){jd("cancel","已取消分享")})}})).apply(this,arguments)}function cu(){return(cu=b(function*(t){var e=Jd(),n=yield Jt(e,1);ft(e),mt(e);var r=`ml_${t}`;n.hasOwnProperty(r)&&Io(Zs(1,{hash:t}))})).apply(this,arguments)}function du(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return fu(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fu(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function fu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var hu=H(".fc"),pu=Q(hu,".sg"),vu=Q(pu,".tg"),yu=Q(vu,"span"),mu=Q(pu,".ug"),gu=Q(hu,".gc"),bu=Q(pu,".vg"),wu=Q(bu,".wg"),Au=Q(pu,".xg"),Su=Q(Au,".yg"),_u=Q(pu,".zg ._g"),ku={},Iu=!1,Cu=!1,Eu=0,Tu=0,$u={},xu=0,Lu=!1,Mu=15e3,Pu=5e3,Ou=15e3,Du=!0,Bu=0,Nu=0,ju="",Ru=!1,Uu=!1,Fu=!1,Ju="";function zu(t,e,n,r){gu.style.setProperty("--ah",t.toString()),Su.style.setProperty("--bh",n.toString()),wu.style.setProperty("--ch",`${e.toString()}px`),wu.style.setProperty("--dh",r.toString())}function Hu(t){var e=t;if(Ru){var n=e.detail.progress-1;_u.style.setProperty("--gh",n.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,Hu)}function qu(){var t=Jd(),e=document.createElement("div");e.classList.add("jc"),e.id=t,e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var n=document.createElement("div");n.classList.add("hh");var r=document.createElement("div");r.classList.add("ih");var i=document.createElement("div");i.classList.add("jh"),i.setAttribute("code","-1"),i.setAttribute("displayed","false");var a=document.createElement("div");a.classList.add("kh"),a.setAttribute("code","-1"),a.setAttribute("displayed","true"),r.appendChild(i),r.appendChild(a);var o=document.createElement("div");o.classList.add("lh");var s=document.createElement("div");s.classList.add("mh");var u=document.createElement("div");u.classList.add("nh");var l=document.createElement("div");l.classList.add("oh");var c=document.createElement("div");c.classList.add("ie"),c.setAttribute("code","0"),c.setAttribute("displayed","false");var d=document.createElement("div");d.classList.add("je"),d.setAttribute("code","0"),d.setAttribute("displayed","true"),l.appendChild(c),l.appendChild(d);var f=document.createElement("div");f.classList.add("ph"),f.appendChild(Ne("keyboard_arrow_down")),f.onclick=function(){!function(t){var e=Q(gu,`.hc .ic .jc#${t}`),n=Q(e,".kc"),r=e.parentElement,i=W(e,"jc"),a=i.length,o=r.getBoundingClientRect(),s=e.getBoundingClientRect(),u=s.top-o.top,l="true"===e.getAttribute("stretched"),c="true"===e.getAttribute("animation");if(c){var d=l?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--ti",`${u}px`);for(var f=0;f<a;f++){var h=i[f];h.setAttribute("push-direction",d),h.setAttribute("push-state","1")}e.addEventListener("transitionend",function(){for(var t=0;t<a;t++){var n=i[t];n.setAttribute("push-direction","0"),n.setAttribute("push-state","0")}e.setAttribute("stretching","false")},{once:!0}),e.addEventListener("transitionstart",function(){for(var t=0;t<a;t++){i[t].setAttribute("push-state","2")}},{once:!0})}l?(c?n.addEventListener("transitionend",function(){n.setAttribute("displayed","false")},{once:!0}):n.setAttribute("displayed","false"),e.setAttribute("stretched","false")):(n.setAttribute("displayed","true"),e.setAttribute("stretched","true"))}(t)};var h=document.createElement("div");h.classList.add("qh"),u.appendChild(l),u.appendChild(f),u.appendChild(h),n.appendChild(r),n.appendChild(o),n.appendChild(s),n.appendChild(u);var p=document.createElement("div");p.classList.add("kc"),p.setAttribute("displayed","false");var v=document.createElement("div");v.classList.add("lc");var y=document.createElement("div");y.classList.add("mc"),y.setAttribute("highlighted","true"),y.setAttribute("type","tab"),y.setAttribute("code","0");var m=document.createElement("div");m.classList.add("rh"),m.appendChild(Ne("directions_bus")),y.appendChild(m),y.appendChild(document.createTextNode("公車")),y.onclick=function(){tl(t,0)};var g=document.createElement("div");g.classList.add("mc"),g.setAttribute("highlighted","false"),g.setAttribute("type","tab"),g.setAttribute("code","1");var b=document.createElement("div");b.classList.add("rh"),b.appendChild(Ne("departure_board")),g.appendChild(b),g.appendChild(document.createTextNode("抵達時間")),g.onclick=function(){tl(t,1)};var w=document.createElement("div");w.classList.add("mc"),w.setAttribute("highlighted","false"),w.setAttribute("type","save-to-folder");var A=document.createElement("div");A.classList.add("rh"),A.appendChild(Ne("folder")),w.appendChild(A),w.appendChild(document.createTextNode("儲存"));var S=document.createElement("div");S.classList.add("mc"),S.setAttribute("highlighted","false"),S.setAttribute("type","schedule-notification"),S.setAttribute("enabled","true");var _=document.createElement("div");_.classList.add("rh"),_.appendChild(Ne("notifications")),S.appendChild(_),S.appendChild(document.createTextNode("通知")),v.appendChild(y),v.appendChild(g),v.appendChild(w),v.appendChild(S);var k=document.createElement("div");k.classList.add("sh"),k.setAttribute("displayed","true");var I=document.createElement("div");return I.classList.add("th"),I.setAttribute("displayed","false"),p.appendChild(v),p.appendChild(k),p.appendChild(I),e.appendChild(n),e.appendChild(p),{element:e,id:t}}function Qu(){var t=document.createElement("div");t.classList.add("hc");var e=document.createElement("div");e.classList.add("uh");var n=document.createElement("div");n.classList.add("vh"),e.appendChild(n);var r=document.createElement("div");return r.classList.add("ic"),t.appendChild(e),t.appendChild(r),{element:t,id:""}}function Yu(){var t=document.createElement("div");t.classList.add("wh");var e=document.createElement("span");return t.appendChild(e),{element:t,id:""}}function Wu(){var t=document.createElement("div");t.classList.add("xh");var e=document.createElement("div");e.classList.add("yh"),e.appendChild(je());var n=document.createElement("div");return n.classList.add("zh"),t.appendChild(e),t.appendChild(n),{element:t,id:""}}function Vu(t,e,n){var r,i;function a(t,r,i){function a(t,e,n){var r=t.getBoundingClientRect(),i=r.top,a=r.left,o=r.bottom,s=r.right,u=window.innerWidth,l=window.innerHeight,c=Q(t,".hh"),d=Q(c,".oh"),f=Q(d,".ie"),h=Q(d,".je");f.setAttribute("code",e.status.code.toString()),f.innerText=e.status.text,n&&o>0&&i<l&&s>0&&a<u?(h.addEventListener("animationend",function(){h.setAttribute("code",e.status.code.toString()),h.innerText=e.status.text,h.classList.remove("ze"),f.setAttribute("displayed","false")},{once:!0}),f.setAttribute("displayed","true"),h.classList.add("ze")):(h.setAttribute("code",e.status.code.toString()),h.innerText=e.status.text)}function o(t,e,n){var r=t.getBoundingClientRect(),i=r.top,a=r.left,o=r.bottom,s=r.right,u=window.innerWidth,l=window.innerHeight,c=Q(t,".hh"),d=Q(c,".ih"),f=Q(d,".jh"),h=Q(d,".kh");f.setAttribute("code",e.ranking.code.toString()),f.innerText=e.ranking.text,n&&o>0&&i<l&&s>0&&a<u?(h.addEventListener("animationend",function(){h.setAttribute("code",e.ranking.code.toString()),h.innerText=e.ranking.text,h.classList.remove("_h"),f.setAttribute("displayed","false")},{once:!0}),f.setAttribute("displayed","true"),h.classList.add("_h")):(h.setAttribute("code",e.ranking.code.toString()),h.innerText=e.ranking.text)}function s(t,e){var n=Q(t,".hh");Q(n,".lh").innerText=e.route_direction}function u(t,e){var n=Q(t,".hh");Q(n,".mh").innerText=e.route_name}function l(t,e){var n=Q(t,".kc");Q(n,".sh").innerHTML=0===e.buses.length?'<div class="ai">目前沒有公車可顯示</div>':e.buses.map(function(t){return`<div class="bi" on-this-route="${t.onThisRoute}"><div class="ci"><div class="di">${Be("directions_bus")}</div><div class="ei">${t.carNumber}</div></div><div class="fi"><div class="gi">路線：${t.RouteName}</div><div class="hi">狀態：${t.status.text}</div><div class="ii">類型：${t.type}</div></div></div>`}).join("")}function c(t,e){var n=Q(t,".kc");Q(n,".th").innerHTML=0===e.busArrivalTimes.length?'<div class="ji">目前沒有抵達時間可顯示</div>':e.busArrivalTimes.map(function(t){return`<div class="ki"><div class="li"><div class="mi">${Be("calendar_view_day")}</div><div class="ni">${t.personalSchedule.name}</div><div class="oi">週${k(t.day).name} ${C(t.personalSchedule.period.start)} - ${C(t.personalSchedule.period.end)}</div></div><div class="pi">${t.chart}</div></div>`}).join("")}function d(t,e){e&&t.setAttribute("stretched","false")}function f(t,e){t.setAttribute("animation",Qd(e))}function h(t,e){t.setAttribute("skeleton-screen",Qd(e))}function p(t,e){var n=Q(t,".kc"),r=Q(n,".lc"),i=Q(r,'.mc[type="save-to-folder"]');i.onclick=function(){Ta("stop-on-location",[t.id,e.stopId,e.routeId])},Xn("stop",e.stopId).then(function(t){i.setAttribute("highlighted",Qd(t))})}function v(t,e){var n=Q(t,".kc"),r=Q(n,".lc"),i=Q(r,'.mc[type="schedule-notification"]');i.onclick=function(){Ba("stop-on-location",[t.id,e.stopId,e.routeId,e.status.time])};var a=Ri(e.stopId);i.setAttribute("highlighted",Qd(a))}null==i?(a(t,r,n),o(t,r,n),s(t,r),u(t,r),l(t,r),c(t,r),d(t,e),f(t,n),h(t,e),p(t,r),v(t,r)):(r.status.time!==i.status.time&&(a(t,r,n),v(t,r)),i.ranking.number===r.ranking.number&&i.ranking.code===r.ranking.code||o(t,r,n),i.stopId!==r.stopId&&(s(t,r),u(t,r),p(t,r)),Fd(i.buses,r.buses)||l(t,r),Fd(i.busArrivalTimes,r.busArrivalTimes)||c(t,r),n!==Iu&&f(t,n),e!==Cu&&(d(t,e),h(t,e)))}function o(t,r,i){function a(t,e){Re(Q(t,".yh"),e.icon)}function o(t,e){Q(t,".zh").innerHTML=e.value}function s(t,e){t.setAttribute("animation",Qd(e))}function u(t,e){t.setAttribute("skeleton-screen",Qd(e))}null==i?(a(t,r),o(t,r),s(t,n),u(t,e)):(Fd(i.icon,r.icon)||a(t,r),Fd(i.value,r.value)||o(t,r),n!==Iu&&s(t,n),e!==Cu&&u(t,e))}var s=Ac("window"),u=s.width,l=s.height,c=t.groupQuantity,d=t.itemQuantity,f=t.groupedItems,h=t.groups;Tu=c,xu=u;for(var p=0,v=0;v<c;v++){var y=`g_${v}`,m=Gi(h[y].name,500,"17px",'"Noto Sans TC", sans-serif')+20;$u[y]={width:m,offset:p},p+=m}if($u[`g_${c}`]={width:0,offset:p},!Lu){var g=$u[`g_${Eu}`],b=-1*g.offset+.5*xu-.5*g.width,w=g.width-20;zu(Tu,b,w,Eu)}(null===(r=ku)||void 0===r?void 0:r.hash)!==t.hash&&(mu.onclick=function(){uu(t.hash)}),(null===(i=ku)||void 0===i?void 0:i.LocationName)!==t.LocationName&&(yu.innerText=t.LocationName),Iu!==n&&(vu.setAttribute("animation",Qd(n)),bu.setAttribute("animation",Qd(n))),Cu!==e&&(vu.setAttribute("skeleton-screen",Qd(e)),bu.setAttribute("skeleton-screen",Qd(e)),Au.setAttribute("skeleton-screen",Qd(e)));var A=Y(gu,".hc").length;if(c!==A){var S=A-c;if(S<0){for(var _=new DocumentFragment,I=new DocumentFragment,E=0,T=Math.abs(S);E<T;E++){var $=Qu();_.appendChild($.element);var x=Yu();I.appendChild(x.element)}gu.append(_),wu.append(I)}else for(var L=Y(gu,".hc"),M=Y(wu,".wh"),P=0,O=Math.abs(S);P<O;P++){var D=A-1-P;L[D].remove(),M[D].remove()}}for(var B=Y(gu,".hc"),N=0;N<c;N++){var j=`g_${N}`,R=B[N],U=Y(R,".ic .jc").length;if(d[j]!==U){var F=U-d[j];if(F<0)for(var J=Q(R,".ic"),z=0,H=Math.abs(F);z<H;z++){var q=qu();J.appendChild(q.element)}else for(var W=Y(R,".ic .jc"),V=0,K=Math.abs(F);V<K;V++){W[U-1-V].remove()}}var G=Y(Y(gu,".hc")[N],".uh .vh .xh").length,Z=h[j].properties.length;if(Z!==G){var X=G-Z;if(X<0)for(var tt=Q(R,".uh"),et=Q(tt,".vh"),nt=0,rt=Math.abs(X);nt<rt;nt++){var it=Wu();et.appendChild(it.element)}else for(var at=Q(R,".uh"),ot=Y(Q(at,".vh"),".xh"),st=0,ut=Math.abs(X);st<ut;st++){ot[G-1-st].remove()}}}for(var lt=Y(wu,".wh"),ct=Y(gu,".hc"),dt=0;dt<c;dt++){var ft=`g_${dt}`,ht=lt[dt];Q(ht,"span").innerText=h[ft].name,ht.style.setProperty("--qi",`${$u[ft].width}px`),ht.style.setProperty("--ri",dt.toString());for(var pt=ct[dt],vt=Y(pt,".uh .vh .xh"),yt=Y(pt,".ic .jc"),mt=h[ft].properties.length,gt=0;gt<mt;gt++){var bt=h[ft].properties[gt],wt=vt[gt];if(ku.hasOwnProperty("groups"))if(ku.groups.hasOwnProperty(ft))if(ku.groups[ft].properties[gt])o(wt,bt,ku.groups[ft].properties[gt]);else o(wt,bt,null);else o(wt,bt,null);else o(wt,bt,null)}for(var At=0;At<d[ft];At++){var St=yt[At],_t=f[ft][At];if(ku.hasOwnProperty("groupedItems"))if(ku.groupedItems.hasOwnProperty(ft))if(ku.groupedItems[ft][At])a(St,_t,ku.groupedItems[ft][At]);else a(St,_t,null);else a(St,_t,null);else a(St,_t,null)}}ku=t,Iu=n,Cu=e}function Ku(){return Gu.apply(this,arguments)}function Gu(){return Gu=b(function*(){var t=Dd("playing_animation"),e=Dd("refresh_interval"),n=Ac("location-bus-arrival-time-chart");Du=e.dynamic,Mu=e.baseInterval,Ru=!0,ju=Jd(),_u.setAttribute("refreshing","true"),_u.classList.remove("fh"),document.addEventListener(ju,Hu);var r=yield function(t,e,n,r){return ga.apply(this,arguments)}(Ju,n.width,n.height,ju);Vu(r,!1,t);var i=0;Du&&(i=yield En()),Bu=(new Date).getTime(),Nu=Du?Math.max(Bu+Pu,r.dataUpdateTime+Mu/i):Bu+Mu,Ou=Math.max(Pu,Nu-Bu),Ru=!1,_u.setAttribute("refreshing","false"),_u.style.setProperty("--eh",`${Ou}ms`),_u.classList.add("fh")}),Gu.apply(this,arguments)}function Zu(){Ku().then(function(){Uu?setTimeout(function(){Zu()},Math.max(Pu,Nu-(new Date).getTime())):Fu=!1}).catch(function(t){Uu?(jd("error","地點網路連線中斷，將在10秒後重試。"),setTimeout(function(){Zu()},1e4)):Fu=!1})}function Xu(t){mc("Location"),Me("location",t),Ju=t,Eu=0,$u={},hu.setAttribute("displayed","true"),gu.scrollLeft=0,gu.focus(),function(t){for(var e=Dd("playing_animation"),n=Ac("window"),r=(n.width,n.height),i={g_0:Math.floor(r/50)+5,g_1:Math.floor(r/50)+5},a={},o=0;o<2;o++){var s=`g_${o}`;a[s]=[];for(var u=0;u<i[s];u++)a[s].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}Vu({groupedItems:a,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]}},itemQuantity:i,LocationName:"載入中",hash:t,dataUpdateTime:0},!0,e)}(t),Uu||(Uu=!0,Fu?Ku():(Fu=!0,Zu())),bc()}function tl(t,e){var n,r=Q(gu,`.hc .ic .jc#${t}`),i=Q(r,".kc"),a=Q(i,".lc"),o=du(Y(a,'.mc[highlighted="true"][type="tab"]'));try{for(o.s();!(n=o.n()).done;){n.value.setAttribute("highlighted","false")}}catch(t){o.e(t)}finally{o.f()}switch(Q(a,`.mc[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:Q(r,".sh").setAttribute("displayed","true"),Q(r,".th").setAttribute("displayed","false");break;case 1:Q(r,".sh").setAttribute("displayed","false"),Q(r,".th").setAttribute("displayed","true")}}function el(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return nl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nl(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function nl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var rl=[],il=H(".ui"),al=Q(il,".vi"),ol=Q(il,".wi"),sl=Q(al,".xi #search_input"),ul=Q(al,".xi canvas"),ll=Q(al,".yi"),cl=Q(ol,".zi"),dl=Q(ol,"._i"),fl=ul.getContext("2d"),hl=window.devicePixelRatio,pl=15*hl,vl=1.8*hl,yl=.9*hl,ml=4*hl,gl=25*hl,bl=20*hl,wl=[["紅","藍","1","2","3"],["綠","棕","4","5","6"],["橘","小","7","8","9"],["鍵盤","幹線","清空","0","刪除"]],Al=ea("--ad"),Sl=ea("--aj"),_l=ea("--id"),kl=0,Il=0,Cl=0,El=!1,Tl=0,$l=Ac("head-two-button"),xl=$l.width*hl,Ll=$l.height*hl,Ml=!1,Pl=!1;function Ol(){var t=Rl(),e=t.substring(0,t.length-1);sl.value=e,zl(),Ul(-1,-1),Sc()}function Dl(){sl.value="",zl(),Ul(-1,-1),Sc()}function Bl(t){t.preventDefault(),sl.focus(),Sc()}function Nl(){!function(){if(!Pl){Pl=!0;var t,e=new DocumentFragment,n=el(wl);try{for(n.s();!(t=n.n()).done;){var r,i=el(t.value);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=document.createElement("button");o.classList.add("bj");var s=qd()?"touchstart":"mousedown";switch(a){case"刪除":o.addEventListener(s,Ol),o.appendChild(Ne("backspace"));break;case"清空":o.addEventListener(s,Dl),o.appendChild(document.createTextNode(a));break;case"鍵盤":o.addEventListener(s,Bl),o.appendChild(Ne("keyboard"));break;default:o.addEventListener(s,function(t){return function(){var e,n;e=t,n=`${Rl()}${e}`,sl.value=n,zl(),Ul(-1,-1),Sc()}}(a)),o.appendChild(document.createTextNode(a))}e.appendChild(o)}}catch(t){i.e(t)}finally{i.f()}}}catch(t){n.e(t)}finally{n.f()}dl.append(e)}}(),dl.setAttribute("displayed","true"),Ml=!0,Fl(),Ul(-1,-1)}function jl(){return parseInt(ll.getAttribute("type"))}function Rl(){return String(sl.value)}function Ul(t,e){var n=Rl(),r=!1;0===n.length?(n="搜尋路線、地點、公車",r=!0,t=0,e=0):-1===t&&-1===e&&(e=1*(t=n.length)),$l=Ac("head-two-button"),xl=$l.width*hl,Ll=$l.height*hl,Al=ea("--ad"),Sl=ea("--aj"),_l=ea("--id"),fl.font=`400 ${bl}px "Noto Sans TC", sans-serif`,fl.textAlign="center",fl.textBaseline="middle",kl=fl.measureText(n).width,Il=fl.measureText(n.substring(0,t)).width,Cl=fl.measureText(n.substring(t,e)).width,Tl=r?1:Math.max(1,Il),fl.clearRect(0,0,xl,Ll),t===e?(El=!0,fl.globalAlpha=1,fl.fillStyle=r?Sl:Al,fl.fillText(n,kl/2+(Math.min(Tl,xl-pl)-Tl),Ll/2),Zi(fl,Math.min(Tl,xl-pl),(Ll-gl)/2,vl,gl,yl,_l)):(El=!1,fl.globalAlpha=.27,Zi(fl,Math.min(Tl,xl-pl),(Ll-gl)/2,Cl,gl,ml,_l),fl.globalAlpha=1,fl.fillStyle=r?Sl:Al,fl.fillText(n,kl/2+(Math.min(Tl,xl-pl)-Tl),Ll/2),fl.globalAlpha=.08,Zi(fl,Math.min(Tl,xl-pl),(Ll-gl)/2,Cl,gl,ml,_l))}function Fl(){var t=performance.now(),e=1-Math.pow(Math.sin(Math.PI*t/960),4);El&&(fl.globalAlpha=e,fl.clearRect(Math.min(Tl,xl-pl)-1,0,vl+2,Ll),Zi(fl,Math.min(Tl,xl-pl),(Ll-gl)/2,vl,gl,yl,_l)),Ml&&window.requestAnimationFrame(Fl)}function Jl(){var t=document.createElement("div");t.classList.add("cj");var e=document.createElement("div");e.classList.add("dj");var n=document.createElement("div");return n.classList.add("ej"),n.appendChild(je()),t.appendChild(n),t.appendChild(e),{element:t,id:""}}function zl(){var t=["route","location_on","directions_bus"];function e(e,n,r){function i(e,n){Re(Q(n,".ej"),t[e.item.type])}function a(t,e){Q(e,".dj").innerText=t.item.n}function o(t,e){switch(t.item.type){case 0:e.onclick=function(){Ks(t.item.id,t.item.pid)};break;case 1:e.onclick=function(){Xu(t.item.hash)};break;case 2:e.onclick=function(){Ke(t.item.id)}}}r?(n.item.type!==r.item.type&&i(n,e),n.item.id!==r.item.id&&(a(n,e),o(n,e))):(i(n,e),a(n,e),o(n,e))}var n=jl(),r=Rl();if(!/[\u3100-\u312Fˇˋˊ˙]/gm.test(r)){var i=function(t,e,n){if(!Se)return[];var r,i=t.toLowerCase(),a=oe(i,!0),s=oe(i,!1),u=[],l=ve(a);try{for(l.s();!(r=l.n()).done;){var c=`u_${r.value}`;we.hasOwnProperty(c)&&u.push(we[c])}}catch(t){l.e(t)}finally{l.f()}u.sort(function(t,e){return t.length-e.length});var d=u.length-1,f=[];if(0===d&&(f=u[0]),d>0)for(var h=0;h<d;h++){var p=u[h];f=o(0===h?p:f,u[h+1])}var v=[],y=0,m=new Set;if(-1===e||2===e){var g,b=Ae.filter(function(t){return t.n===i&&2===t.type}),w=ve(b);try{for(w.s();!(g=w.n()).done;){var A=g.value;if(v.push({item:A,score:1/0}),m.add(A.id),(y+=1)>=n)break}}catch(t){w.e(t)}finally{w.f()}}if(y<n){var S,_=ve(f);try{for(_.s();!(S=_.n()).done;){var k=S.value,I=Ae[k];if((-1===e||e===I.type)&&!m.has(I.id)){var C=ke(s,oe(I.n,!1));if(!(y<n))break;v.push({item:I,score:C}),y+=1}}}catch(t){_.e(t)}finally{_.f()}}return v.sort(function(t,e){return e.score-t.score}),v}(r,n,30),a=i.length,s=Y(cl,".cj").length;if(a!==s){var u=s-a;if(u<0){for(var l=new DocumentFragment,c=0,d=Math.abs(u);c<d;c++){var f=Jl();l.appendChild(f.element)}cl.appendChild(l)}else for(var h=Y(cl,".cj"),p=0,v=Math.abs(u);p<v;p++){h[s-1-p].remove()}}for(var y=Y(cl,".cj"),m=0;m<a;m++){var g=rl[m],b=i[m],w=y[m];e(w,b,g||null)}rl=i}}function Hl(){hr?(mc("Search"),il.setAttribute("displayed","true"),Nl(),function(){_e.apply(this,arguments)}()):jd("download_for_offline","資料還在下載中")}function ql(){gc("Search"),dl.setAttribute("displayed","false"),Ml=!1,il.setAttribute("displayed","false")}function Ql(){return(Ql=b(function*(){var t=yield Vn(),e=function(){var t=[];for(var e in xd)if($d.indexOf(e)>-1&&xd.hasOwnProperty(e)&&"select"===xd[e].type){var n={key:e,option:xd[e].option};t.push(n)}return t}(),n=yield sn(),r=yield xe(),i={};return i.time=(new Date).toISOString(),i.version=4,i.folders=t,i.settings=e,i.personal_schedules=n,i.recent_views=r,JSON.stringify(i)})).apply(this,arguments)}function Yl(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Wl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wl(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Wl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Vl(t){return Kl.apply(this,arguments)}function Kl(){return(Kl=b(function*(t){var e,n=Yl(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r,a=!1,o=!1,s=`f_${i.id}`;if((yield M(11,s))?a=yield Jn(i.id,i.name,i.icon):o=yield Un(i.name,i.icon),a){var u,l=Yl(r.content);try{for(l.s();!(u=l.n()).done;){var c=u.value;yield Gn(r.id,c)}}catch(t){l.e(t)}finally{l.f()}}if(o){var d,f=Yl(r.content);try{for(f.s();!(d=f.n()).done;){var h=d.value;yield Gn(o,h)}}catch(t){f.e(t)}finally{f.f()}}}}catch(t){n.e(t)}finally{n.f()}})).apply(this,arguments)}function Gl(t){return Zl.apply(this,arguments)}function Zl(){return(Zl=b(function*(t){var e,n=Yl(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=Od(r.key);i&&"select"===i.type&&(yield Md(r.key,r.option))}}catch(t){n.e(t)}finally{n.f()}return!0})).apply(this,arguments)}function Xl(t){return tc.apply(this,arguments)}function tc(){return(tc=b(function*(t){var e,n=Yl(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;(yield nn(r.id))?yield an(r):yield tn(r.name,r.period.start.hours,r.period.start.minutes,r.period.end.hours,r.period.end.minutes,r.days)}}catch(t){n.e(t)}finally{n.f()}return!0})).apply(this,arguments)}function ec(){return(ec=b(function*(t){var e,n=Yl(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;switch(r.type){case"route":(yield Oe("route",r.id))||(yield Me(r.type,r.id));break;case"location":(yield Oe("location",r.hash))||(yield Me(r.type,r.hash));break;case"bus":(yield Oe("bus",r.id))||(yield Me(r.type,r.id))}}}catch(t){n.e(t)}finally{n.f()}return!0})).apply(this,arguments)}function nc(){return nc=b(function*(t){var e=JSON.parse(t);switch(e.version){case 1:return yield Vl(e.folders),!0;case 2:return yield Vl(e.folders),yield Gl(e.settings),!0;case 3:return yield Vl(e.folders),yield Gl(e.settings),yield Xl(e.personal_schedules),!0;case 4:return yield Vl(e.folders),yield Gl(e.settings),yield Xl(e.personal_schedules),yield function(t){return ec.apply(this,arguments)}(e.recent_views),!0;default:return!1}}),nc.apply(this,arguments)}function rc(){return H('head meta[name="version-hash"]').getAttribute("content")}function ic(){return H('head meta[name="version-branch-name"]').getAttribute("content")}function ac(){return`https://github.com/EricHsia7/bus/tree/${H('head meta[name="version-full-hash"]').getAttribute("content")}`}function oc(){return H('head meta[name="version-time-stamp"]').getAttribute("content")}function sc(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return uc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uc(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function uc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var lc=H(".fj"),cc=Q(lc,".gj"),dc=Q(cc,".hj");function fc(t){var e=document.createElement("div");e.classList.add("ij"),e.setAttribute("type",t.type);var n=document.createElement("div");n.classList.add("jj");var r=document.createElement("span");r.appendChild(Ne(t.icon)),n.appendChild(r);var i=document.createElement("div");i.classList.add("kj"),i.appendChild(document.createTextNode(t.name));var a=document.createElement("div");a.classList.add("lj"),a.appendChild(document.createTextNode(t.status));var o=document.createElement("div");o.classList.add("mj");var s=document.createElement("span");return s.appendChild(Ne("arrow_forward_ios")),o.appendChild(s),"function"==typeof t.action?e.onclick=function(){t.action()}:"string"==typeof t.action&&e.setAttribute("onclick",t.action),e.appendChild(n),e.appendChild(i),e.appendChild(a),e.appendChild(o),{element:e,id:""}}function hc(){return hc=b(function*(){var t=yield function(){return Ld.apply(this,arguments)}();dc.innerHTML="";var e,n=new DocumentFragment,r=sc(t);try{for(r.s();!(e=r.n()).done;){var i=fc(e.value);n.appendChild(i.element)}}catch(t){r.e(t)}finally{r.f()}dc.append(n)}),hc.apply(this,arguments)}function pc(){mc("Settings"),lc.setAttribute("displayed","true"),function(){hc.apply(this,arguments)}()}function vc(){return vc=b(function*(){jd("manufacturing","資料匯出中");var t=yield function(){return Ql.apply(this,arguments)}();!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n=arguments.length>2?arguments[2]:void 0,r=new Blob([t],{type:e}),i=new File([r],n,{type:e});navigator.canShare&&navigator.canShare({files:[i]})?navigator.share({files:[i]}).catch(function(t){jd("download","下載資料",{text:"下載",action:function(){Hd(r,n)}})}):Hd(r,n)}(t,"application/json","bus-export.json")}),vc.apply(this,arguments)}H(".oj"),H(".pj"),(new Date).getTime();var yc=["Home"];function mc(t){var e=yc.length;yc[e-1]!==t&&yc.push(t)}function gc(t){if(yc.indexOf(t)>-1){var e=yc.length;yc[e-1]===t&&yc.pop()}}function bc(){var t=yc.length;if(t>1)switch(yc[t-2]){case"Home":case"FolderIconSelector":case"Location":case"LocationDetails":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":case"QRCode":default:break;case"FolderCreator":Cr();break;case"FolderEditor":Jr();break;case"FolderManager":gc("FolderManager"),Qr.setAttribute("displayed","false");break;case"Search":ql();break;case"Settings":gc("Settings"),lc.setAttribute("displayed","false");break;case"PersonalScheduleManager":gc("PersonalScheduleManager"),pi.setAttribute("displayed","false");break;case"PersonalScheduleEditor":di();break;case"Bus":qe.setAttribute("displayed","false"),wc();break;case"RegisterNotification":qi.setAttribute("displayed","false"),wc()}}function wc(){var t=yc.length;if(t>1){var e=yc[t-2];switch(yc.pop(),e){case"Home":case"FolderIconSelector":case"Location":case"LocationDetails":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":case"QRCode":default:break;case"FolderCreator":mc("FolderCreator"),_r.setAttribute("displayed","true"),bc();break;case"FolderEditor":Fr();break;case"FolderManager":Gr();break;case"Search":Hl();break;case"Settings":pc();break;case"PersonalScheduleManager":bi();break;case"PersonalScheduleEditor":ci();break;case"Bus":Ke();break;case"RegisterNotification":mc("RegisterNotification"),qi.setAttribute("displayed","true"),Ki(),bc()}}}function Ac(t){var e=0,n=0,r=window.innerWidth,i=window.innerHeight;switch(t){case"window":e=r,n=i;break;case"head":e=r,n=55;break;case"head-one-button":e=r-55,n=55;break;case"head-two-button":e=r-110,n=55;break;case"route-details-canvas":e=r-20-20,n=1680;break;case"route-bus-arrival-time-chart":e=r-45-15-20,n=75;break;case"location-bus-arrival-time-chart":e=r-30-20,n=75;break;default:e=0,n=0}return{width:e,height:n}}function Sc(){window.scrollTo({top:0,behavior:"instant"})}var _c=H(".tj"),kc=Q(_c,".uj"),Ic=Q(kc,".vj"),Cc=Q(kc,".wj"),Ec=Q(Cc,'.xj[name="total-data-usage"] .yj'),Tc=Q(Cc,'.xj[name="max-data-usage-per-minute"] .yj'),$c=Q(Cc,'.xj[name="min-data-usage-per-minute"] .yj'),xc=Q(Cc,'.xj[name="start-time"] .yj'),Lc=Q(Cc,'.xj[name="end-time"] .yj');function Mc(){return Mc=b(function*(){var t=Ac("window"),e=t.width,n=Math.min(5/18*e,.33*t.height),r=yield function(t,e,n){return z.apply(this,arguments)}(e,n,20);Ec.innerText=u(r.stats.sum),Tc.innerText=u(r.stats.max),$c.innerText=u(r.stats.min),xc.innerText=A(r.period.start,"YYYY-MM-DD"),Lc.innerText=A(r.period.end,"YYYY-MM-DD"),Ic.innerHTML=r.chart}),Mc.apply(this,arguments)}function Pc(){return Pc=b(function*(t){if(""===xi||""===Li||void 0===t)return!1;var e=wi("cancel"),n=Si("cancel",[t]),r=yield _i("cancel",e,n);return!1!==r&&(200===r.code&&"cancel"===r.method&&(yield function(t){return ji.apply(this,arguments)}(t),!0))}),Pc.apply(this,arguments)}var Oc=H(".zj"),Dc=Q(Oc,"._j"),Bc=Q(Dc,".ak"),Nc=Q(Bc,".bk"),jc=Q(Oc,".ck"),Rc=Q(jc,".dk"),Uc={},Fc=!1,Jc=15e3,zc=5e3,Hc=15e3,qc=!0,Qc=0,Yc=0,Wc="",Vc=!1,Kc=!1,Gc=!1;function Zc(t){var e=t;if(Vc){var n=e.detail.progress-1;Nc.style.setProperty("--gk",n.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,Zc)}function Xc(){var t=Jd(),e=document.createElement("div");e.classList.add("hk"),e.id=t;var n=document.createElement("div");n.classList.add("ik"),e.appendChild(n);var r=document.createElement("div");r.classList.add("jk");var i=document.createElement("div");i.classList.add("kk"),r.appendChild(i);var a=document.createElement("div");a.classList.add("lk"),r.appendChild(a);var o=document.createElement("div");o.classList.add("mk"),r.appendChild(o);var s=document.createElement("div");s.classList.add("nk");var u=document.createElement("span");return u.appendChild(Ne("close")),s.appendChild(u),r.appendChild(s),e.appendChild(r),{element:e,id:t}}function td(t,e,n){function r(t,r,i){function a(t,e){Q(t,".ik").innerText=e.hours}function o(t,e){var n=Q(t,".jk");Q(n,".kk").innerText=e.minutes}function s(t,e){var n=Q(t,".jk");Q(n,".mk").innerText=e.name}function u(t,e){var n=Q(t,".jk");Q(n,".lk").innerText=`${e.route.name} - 往${e.route.direction}`}function l(t,e){var n=Q(t,".jk");Q(n,".nk").onclick=function(){!function(t,e){ad.apply(this,arguments)}(t.id,e.schedule_id)}}function c(t,e){t.setAttribute("first",Qd(e.is_first))}function d(t,e){t.setAttribute("animation",Qd(e))}function f(t,e){t.setAttribute("skeleton-screen",Qd(e))}null==i?(a(t,r),o(t,r),s(t,r),u(t,r),l(t,r),c(t,r),d(t,n),f(t,e)):(r.hours!==i.hours&&a(t,r),r.minutes!==i.minutes&&o(t,r),Fd(i.schedule_id,r.schedule_id)||(s(t,r),u(t,r),l(t,r)),i.is_first!==r.is_first&&c(t,r),false!==n&&d(t,n),Fc!==e&&f(t,e))}var i=t.itemQuantity,a=t.items,o=Y(Rc,".hk").length;if(i!==o){var s=o-i;if(s<0){for(var u=new DocumentFragment,l=0,c=Math.abs(s);l<c;l++){var d=Xc();u.appendChild(d.element)}Rc.append(u)}else for(var f=Y(Rc,".hk"),h=0,p=Math.abs(s);h<p;h++){f[o-1-h].remove()}}for(var v=Y(Rc,".hk"),y=0;y<i;y++){var m=v[y],g=a[y];if(Uc.hasOwnProperty("items"))if(Uc.items[y])r(m,g,Uc.items[y]);else r(m,g,null);else r(m,g,null)}Uc=t,Fc=e}function ed(){return nd.apply(this,arguments)}function nd(){return(nd=b(function*(){var t=Dd("playing_animation"),e=Dd("refresh_interval");qc=e.dynamic,Jc=e.baseInterval,Vc=!0,Wc=Jd(),Nc.setAttribute("refreshing","true"),Nc.classList.remove("fk"),document.addEventListener(Wc,Zc);var n=yield Ui(Wc);td(n,!1,t);var r=0;qc&&(r=yield En()),Qc=(new Date).getTime(),Yc=qc?Math.max(Qc+zc,n.dataUpdateTime+Jc/r):Qc+Jc,Hc=Math.max(zc,Yc-Qc),Vc=!1,Nc.setAttribute("refreshing","false"),Nc.style.setProperty("--ek",`${Hc}ms`),Nc.classList.add("fk")})).apply(this,arguments)}function rd(){return id.apply(this,arguments)}function id(){return(id=b(function*(){ed().then(function(){Kc?setTimeout(function(){rd()},Math.max(zc,Yc-(new Date).getTime())):Gc=!1}).catch(function(t){Kc?setTimeout(function(){rd()},1e4):Gc=!1})})).apply(this,arguments)}function ad(){return ad=b(function*(t,e){jd("manufacturing","處理中");var n=yield function(t){return Pc.apply(this,arguments)}(e);if(n){if(Q(Rc,`.hk#${t}`).remove(),jd("check_circle","已取消通知"),!Vc){var r=Dd("playing_animation");td(yield Ui(Wc),!1,r)}}else jd("error","取消失敗")}),ad.apply(this,arguments)}function od(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return sd(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sd(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function sd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ud=H(".ok"),ld=Q(ud,".pk"),cd=Q(ld,".qk"),dd=Q(ld,".rk"),fd=Q(ud,".sk"),hd=Q(fd,".tk");function pd(t,e,n){var r=document.createElement("div");r.classList.add("uk");var i=document.createElement("div");i.classList.add("vk"),i.appendChild(document.createTextNode(e.name));var a=document.createElement("div");a.classList.add("wk");var o=document.createElement("input");return o.type="checkbox",o.checked=t.option===n,o.onclick=function(e){!function(t,e,n){var r,i=od(q('.ok .pk .qk .uk .wk input[type="checkbox"]'));try{for(i.s();!(r=i.n()).done;){r.value.checked=!1}}catch(t){i.e(t)}finally{i.f()}var a=t.target;a.checked=!0,Md(e,n)}(e,t.key,n)},a.appendChild(o),r.appendChild(i),r.appendChild(a),{element:r,id:""}}function vd(t){mc("SettingsOptions"),ud.setAttribute("displayed","true"),function(t){var e=Od(t);hd.innerText=e.name,dd.innerText=e.description,cd.innerHTML="";var n,r=new DocumentFragment,i=0,a=od(e.options);try{for(a.s();!(n=a.n()).done;){var o=pd(e,n.value,i);r.appendChild(o.element),i+=1}}catch(t){a.e(t)}finally{a.f()}cd.append(r)}(t),bc()}function yd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return md(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?md(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function md(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function gd(t){var e=[["快取","cache"],["設定","settings"],["分析","analytics"],["分析","analytics"],["分析","analytics"],["分析","analytics"],["分析","analytics"],["個人化行程","personalSchedule"],["最近檢視","recentViews"],["通知","notification"],["通知","notification"],["資料夾","folders"],["資料夾","folders"],["資料夾","folders"]][t]||["其他","others"],n=(0,G.A)(e,2);return{name:n[0],key:n[1]}}function bd(){return(bd=b(function*(){for(var t=0,e={},n=$.length,r=0;r<n;r++){var i,a=0,o=yd(yield B(r));try{for(o.s();!(i=o.n()).done;){var s=i.value,l=yield M(r,s),c=String(l).length+s.length;t+=c,a+=c}}catch(t){o.e(t)}finally{o.f()}var d=gd(r),f=d.key;e.hasOwnProperty(f)||(e[f]={category:d,size:0}),e[d.key].size+=a}var h=u(t),p={};for(var v in e){var y=e[v].category,m=e[v].size;p[v]={category:y,size:u(m)}}return{totalSize:h,categorizedSizes:p}})).apply(this,arguments)}var wd=[],Ad=!1,Sd=!1,_d=H(".xk"),kd=Q(_d,".yk"),Id=Q(kd,".zk");function Cd(){var t=document.createElement("div");t.classList.add("_k");var e=document.createElement("div");e.classList.add("al");var n=document.createElement("div");return n.classList.add("bl"),t.appendChild(e),t.appendChild(n),{element:t,id:""}}function Ed(t,e,n){function r(t,r,i){function a(t,e){Q(t,".bl").innerText=e.size}function o(t,e){Q(t,".al").innerText=e.category.name}function s(t,e){t.setAttribute("animation",Qd(e))}function u(t,e){t.setAttribute("skeleton-screen",Qd(e))}i?(r.category.key!==i.category.key&&(o(t,r),a(t,r)),r.size!==i.size&&a(t,r),Ad!==n&&s(t,n),Sd!==e&&u(t,e)):(a(t,r),o(t,r),s(t,n),u(t,e))}var i=[];for(var a in t.categorizedSizes){var o=t.categorizedSizes[a];i.push(o)}var s=i.length,u=Y(Id,"._k").length;if(s!==u){var l=u-s;if(l<0){for(var c=new DocumentFragment,d=0,f=Math.abs(l);d<f;d++){var h=Cd();c.appendChild(h.element)}Id.appendChild(c)}else for(var p=Y(Id,"._k"),v=0,y=Math.abs(l);v<y;v++){p[u-1-v].remove()}}for(var m=Y(Id,"._k"),g=0;g<s;g++){var b=wd[g],w=i[g],A=m[g];r(A,w,b||null)}wd=i,Sd=e,Ad=n}function Td(){return Td=b(function*(){var t=Dd("playing_animation");!function(){for(var t=Dd("playing_animation"),e=Ac("window").height,n=Math.min(7,Math.floor(e/55)+2),r={categorizedSizes:{},totalSize:0},i=0;i<n;i++){var a=`store-${i}`;r.categorizedSizes[a]={category:{name:"",key:a},size:`size-${i}`}}Ed(r,!0,t)}();var e=yield function(){return bd.apply(this,arguments)}();Ed(e,!1,t)}),Td.apply(this,arguments)}var $d=["time_formatting_mode","refresh_interval","display_user_location","display_user_orientation","location_labels","proxy","folder","personal_schedule","notification","playing_animation","power_saving","data_usage","storage","persistent_storage","export","import","version","branch","last_update_date","github"],xd={time_formatting_mode:{key:"time_formatting_mode",name:"預估時間格式",icon:"glyphs",status:"",action:function(){vd("time_formatting_mode")},type:"select",default_option:0,option:0,options:[{name:`${_(11,3)}/${_(61,3)}/${_(3661,3)}`,value:{type:1,number:3},resourceIntensive:!1,powerSavingAlternative:-1},{name:`${_(11,2)}/${_(61,2)}/${_(3661,2)}`,value:{type:1,number:2},resourceIntensive:!1,powerSavingAlternative:-1},{name:`${_(11,1)}/${_(61,1)}/${_(3661,1)}`,value:{type:1,number:1},resourceIntensive:!1,powerSavingAlternative:-1},{name:`${_(11,0)}/${_(61,0)}/${_(3661,0)}`,value:{type:1,number:0},resourceIntensive:!1,powerSavingAlternative:-1}],description:"在首頁、路線頁面、地點頁面上的預估公車到站時間的顯示格式。"},refresh_interval:{key:"refresh_interval",name:"預估時間更新頻率",icon:"pace",status:"",action:function(){vd("refresh_interval")},type:"select",default_option:0,option:0,options:[{name:"自動",value:{baseInterval:15e3,dynamic:!0,type:3},resourceIntensive:!0,powerSavingAlternative:2},{name:"10秒",value:{baseInterval:1e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:2},{name:"20秒",value:{baseInterval:2e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:3},{name:"30秒",value:{baseInterval:3e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:4},{name:"40秒",value:{baseInterval:4e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:5},{name:"50秒",value:{baseInterval:5e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:6},{name:"60秒",value:{baseInterval:6e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:6}],description:"在首頁、路線頁面、地點頁面上的預估公車到站時間、公車等即時資料更新的頻率。"},display_user_location:{key:"display_user_location",name:"顯示所在位置",icon:"near_me",status:"",action:function(){vd("display_user_location")},type:"select",default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!0,powerSavingAlternative:1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}],description:"是否在路線頁面上標註目前所在位置。若設為開啟，本應用程式將要求位置存取權限。"},display_user_orientation:{key:"display_user_orientation",name:"顯示裝置指向",icon:"explore",status:"",action:function(){vd("display_user_orientation")},type:"select",default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!0,powerSavingAlternative:1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}],description:"是否在地點頁面上顯示裝置所指方向。若設為開啟，本應用程式將要求動作與方向存取權限。"},location_labels:{key:"location_labels",name:"站牌位置標籤",icon:"tag",status:"",action:function(){vd("location_labels")},type:"select",default_option:0,option:0,options:[{name:"行徑方向",value:{type:0,string:"directions"},resourceIntensive:!1,powerSavingAlternative:-1},{name:"地址特徵",value:{type:0,string:"address"},resourceIntensive:!1,powerSavingAlternative:-1},{name:"英文字母",value:{type:0,string:"letters"},resourceIntensive:!1,powerSavingAlternative:-1}],description:"用於區分位於同個地點的不同站牌。行徑方向表示可搭乘路線從本站到下一站的方向（與車流同向）；地址特徵表示不同站牌的地址差異處；英文字母表示按照順序以字母編號。"},proxy:{key:"proxy",name:"網路代理",icon:"router",status:"",action:function(){vd("proxy")},type:"select",default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!1,powerSavingAlternative:-1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}],description:"使用網路代理來擷取資料。"},folder:{key:"folder",name:"資料夾",icon:"folder",status:"",type:"page",action:Gr,description:""},personal_schedule:{key:"personal_schedule",name:"個人化行程",icon:"calendar_view_day",status:"",action:bi,type:"page",description:""},notification:{key:"notification",name:"通知",icon:"notifications",status:"",action:function(){mc("NotificationScheduleManager"),Oc.setAttribute("displayed","true"),function(){for(var t=Dd("playing_animation"),e=Ac("window"),n=(e.width,e.height),r=Math.floor(n/50)+5,i=[],a=0;a<r;a++)i.push({name:"",stop_id:0,estimate_time:0,schedule_id:"null",scheduled_time:0,route:{name:"",direction:"",id:0,pathAttributeId:[]},is_first:!0,date:"",hours:"",minutes:""});td({items:i,itemQuantity:r,dataUpdateTime:0},!0,t)}(),Kc||(Kc=!0,Gc?ed():(Gc=!0,rd())),bc()},type:"page",description:""},playing_animation:{key:"playing_animation",name:"動畫",icon:"animation",description:"是否在介面中播放動畫。",status:"",type:"select",action:function(){vd("playing_animation")},default_option:0,option:0,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!0,powerSavingAlternative:1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}]},power_saving:{key:"power_saving",name:"省電模式",icon:"battery_low",description:"暫停使用耗電功能來節省電力。",status:"",type:"select",action:function(){vd("power_saving")},default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!1,powerSavingAlternative:-1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}]},data_usage:{key:"data_usage",name:"網路使用量",icon:"bigtop_updates",status:"",type:"page",action:function(){mc("DataUsage"),_c.setAttribute("displayed","true"),function(){Mc.apply(this,arguments)}(),bc()},description:""},storage:{key:"storage",name:"儲存空間",icon:"database",status:"",type:"page",action:function(){_d.setAttribute("displayed","true"),function(){Td.apply(this,arguments)}()},description:""},persistent_storage:{key:"persistent_storage",name:"永久儲存",icon:"storage",status:"",action:function(){(function(){return U.apply(this,arguments)})().then(function(t){switch(t){case"granted":jd("check_circle","已開啟永久儲存");break;case"denied":jd("cancel","永久儲存權限已被拒絕");break;case"unsupported":jd("warning","此瀏覽器不支援永久儲存");break;default:jd("error","發生錯誤")}})},type:"action",description:"開啟此選項以避免瀏覽器自動刪除重要資料。"},export:{key:"export",name:"匯出資料",icon:"upload",status:"",type:"action",action:function(){return vc.apply(this,arguments)},description:""},import:{key:"import",name:"匯入資料",icon:"download",status:"",type:"action",action:function(){var t=Jd(),e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","application/json"),e.setAttribute("name",t),e.id=t,e.classList.add("nj"),e.addEventListener("change",function(e){if(0===e.target.files.length)H(`body #${t}`).remove();else{var n=e.target.files[0],r=new FileReader;r.onload=function(e){(function(t){return nc.apply(this,arguments)})(e.target.result).then(function(e){e?jd("check_circle","已匯入資料"):jd("error","無法匯入資料"),H(`body #${t}`).remove()})},r.readAsText(n)}},{once:!0}),e.addEventListener("cancel",function(){H(`body #${t}`).remove()},{once:!0}),document.body.append(e),H(`body #${t}`).click()},description:""},version:{key:"version",name:"版本",icon:"commit",status:"",type:"info",action:function(){var t=ac();window.open(t)},description:""},branch:{key:"branch",name:"分支",icon:"rebase",status:"",type:"info",action:function(){},description:""},last_update_date:{key:"last_update_date",name:"更新時間",icon:"update",status:"",type:"info",action:function(){},description:""},github:{key:"github",name:"GitHub",icon:"book_2",status:"@EricHsia7/bus",type:"info",action:function(){window.open("https://github.com/EricHsia7/bus")},description:""}};function Ld(){return(Ld=b(function*(){var t=[];for(var e in xd){var n=xd[e];switch(n.type){case"select":n.status=n.options[n.option].name;break;case"page":if("notification"===e)n.status=Bi()?"已註冊":"未註冊";else n.status="";break;case"action":n.status="","persistent_storage"===e&&(n.status=(yield j())?"開啟":"關閉");break;case"info":if("version"===e&&(n.status=rc()),"branch"===e&&(n.status=ic()),"last_update_date"===e){var r=new Date(oc());n.status=S(r)}}t.push(n)}return t})).apply(this,arguments)}function Md(t,e){return Pd.apply(this,arguments)}function Pd(){return(Pd=b(function*(t,e){return!!($d.indexOf(t)>-1&&xd.hasOwnProperty(t)&&"select"===xd[t].type&&void 0!==xd[t].options[e]&&null!==xd[t].options[e])&&(yield x(1,t,e),xd[t].option=e,!0)})).apply(this,arguments)}function Od(t){if($d.indexOf(t)>-1&&xd.hasOwnProperty(t))return xd[t]}function Dd(t){if($d.indexOf(t)>-1&&xd.hasOwnProperty(t)){var e=xd.power_saving,n=e.options[e.option].value.boolean,r=xd[t],i=r.options[r.option];n&&i.resourceIntensive&&(i=r.options[i.powerSavingAlternative]);var a=i.value;switch(a.type){case 0:return a.string;case 1:return a.number;case 2:return a.boolean;case 3:return a;default:return""}}return""}function Bd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Nd(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nd(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Nd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function jd(t,e,n){var r=q(".cl");if(null!==r){var i,a=Bd(r);try{for(a.s();!(i=a.n()).done;){i.value.remove()}}catch(t){a.e(t)}finally{a.f()}}var o=Dd("playing_animation"),s=document.createElement("div");s.classList.add("cl"),s.setAttribute("animation",Qd(o));var u=document.createElement("div");u.classList.add("dl"),u.appendChild(Ne(t)),s.appendChild(u);var l=document.createElement("div");if(l.classList.add("el"),l.innerText=e,s.appendChild(l),"object"===m(n)&&null!=n&&"function"==typeof(null==n?void 0:n.action)){var c=document.createElement("div");c.classList.add("fl"),c.innerText=n.text,c.addEventListener("click",function(){n.action()},{once:!0}),s.appendChild(c)}s.addEventListener("animationend",function(t){null!=t&&t.target&&t.target.remove()},{once:!0}),document.body.appendChild(s)}var Rd=n(3503),Ud=n(4462).sha512;function Fd(t,e){function n(t){return JSON.stringify({e:t})}var r=n(t),i=n(e),a=r.length,o=i.length;if(a===o){if(a>32||o>32){for(var s=Rd(r),u=Rd(i),l=!0,c=0;c<8;c++){if(s.charAt(c)!==u.charAt(c)){l=!1;break}}return l}return r===i}return!1}function Jd(){var t=[[48,10],[97,26],[65,26]],e=Math.floor(268435456*Math.random()),n=Math.floor(268435456*Math.random()),r=new Uint8Array(17);r[0]=95;for(var i=16;i>0;i--){var a=t[n%3],o=a[0]+e%a[1];r[i]=o,e>>>=1,n>>>=1}return String.fromCharCode.apply(null,r)}function zd(t){return((new Date).getTime()/t|0).toString(16)}function Hd(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32e3,r=URL.createObjectURL(t),i=document.createElement("a");return i.href=r,i.download=e,document.body.appendChild(i),i.click(),i.remove(),setTimeout(function(){URL.revokeObjectURL(r)},n),r}function qd(){return!(!("ontouchstart"in window)&&!navigator.maxTouchPoints)}function Qd(t){if("boolean"==typeof t)return t?"true":"false"}self.onmessage=function(t){var e=function(t){var e={};for(var n in t){var r=Rd(String(t[n].n).trim().replaceAll(/[\(（）\)\:：\~～]*/gim,"")),i=`ml_${r}`;e.hasOwnProperty(i)?(e[i].lo.push(t[n].lo),e[i].la.push(t[n].la),e[i].g.indexOf(t[n].g)<0&&e[i].g.push(t[n].g),e[i].r.push(t[n].r),e[i].s.push(t[n].s),e[i].v.push(t[n].v),e[i].a.push(v(t[n].a)),e[i].id.push(t[n].id)):e[i]={n:t[n].n,lo:[t[n].lo],la:[t[n].la],g:[t[n].g],r:[t[n].r],s:[t[n].s],v:[t[n].v],a:[v(t[n].a)],id:[t[n].id],hash:r}}return e}(t.data);self.postMessage(e)}},6886(t,e){let n;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];e.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},e.getSymbolTotalCodewords=function(t){return r[t]},e.getBCHDigit=function(t){let e=0;for(;0!==t;)e++,t>>>=1;return e},e.setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');n=t},e.isKanjiModeEnabled=function(){return void 0!==n},e.toSJIS=function(t){return n(t)}},7044(t,e){const n="[0-9]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+")(?:.|[\r\n]))+";e.KANJI=new RegExp(r,"g"),e.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),e.BYTE=new RegExp(i,"g"),e.NUMERIC=new RegExp(n,"g"),e.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const a=new RegExp("^"+r+"$"),o=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");e.testKanji=function(t){return a.test(t)},e.testNumeric=function(t){return o.test(t)},e.testAlphanumeric=function(t){return s.test(t)}},7206(t){function e(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(e(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&e(t.slice(0,0))}(t)||!!t._isBuffer)}},7518(t,e,n){const r=n(9953),i=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];e.getBlocksCount=function(t,e){switch(e){case r.L:return i[4*(t-1)+0];case r.M:return i[4*(t-1)+1];case r.Q:return i[4*(t-1)+2];case r.H:return i[4*(t-1)+3];default:return}},e.getTotalCodewordsCount=function(t,e){switch(e){case r.L:return a[4*(t-1)+0];case r.M:return a[4*(t-1)+1];case r.Q:return a[4*(t-1)+2];case r.H:return a[4*(t-1)+3];default:return}}},7756(t,e,n){const r=n(6886).getSymbolSize;e.getPositions=function(t){const e=r(t);return[[0,0],[e-7,0],[0,e-7]]}},8820(t){function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}e.prototype.set=function(t,e,n,r){const i=t*this.size+e;this.data[i]=n,r&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,e){return this.data[t*this.size+e]},e.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n},e.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]},t.exports=e},9801(t,e,n){const r=n(208),i=n(4357),a=n(1433),o=n(5822),s=n(4861),u=n(7044),l=n(6886),c=n(6320);function d(t){return unescape(encodeURIComponent(t)).length}function f(t,e,n){const r=[];let i;for(;null!==(i=t.exec(n));)r.push({data:i[0],index:i.index,mode:e,length:i[0].length});return r}function h(t){const e=f(u.NUMERIC,r.NUMERIC,t),n=f(u.ALPHANUMERIC,r.ALPHANUMERIC,t);let i,a;l.isKanjiModeEnabled()?(i=f(u.BYTE,r.BYTE,t),a=f(u.KANJI,r.KANJI,t)):(i=f(u.BYTE_KANJI,r.BYTE,t),a=[]);return e.concat(n,i,a).sort(function(t,e){return t.index-e.index}).map(function(t){return{data:t.data,mode:t.mode,length:t.length}})}function p(t,e){switch(e){case r.NUMERIC:return i.getBitsLength(t);case r.ALPHANUMERIC:return a.getBitsLength(t);case r.KANJI:return s.getBitsLength(t);case r.BYTE:return o.getBitsLength(t)}}function v(t,e){let n;const u=r.getBestModeForData(t);if(n=r.from(e,u),n!==r.BYTE&&n.bit<u.bit)throw new Error('"'+t+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(u));switch(n!==r.KANJI||l.isKanjiModeEnabled()||(n=r.BYTE),n){case r.NUMERIC:return new i(t);case r.ALPHANUMERIC:return new a(t);case r.KANJI:return new s(t);case r.BYTE:return new o(t)}}e.fromArray=function(t){return t.reduce(function(t,e){return"string"==typeof e?t.push(v(e,null)):e.data&&t.push(v(e.data,e.mode)),t},[])},e.fromString=function(t,n){const i=function(t){const e=[];for(let n=0;n<t.length;n++){const i=t[n];switch(i.mode){case r.NUMERIC:e.push([i,{data:i.data,mode:r.ALPHANUMERIC,length:i.length},{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.ALPHANUMERIC:e.push([i,{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.KANJI:e.push([i,{data:i.data,mode:r.BYTE,length:d(i.data)}]);break;case r.BYTE:e.push([{data:i.data,mode:r.BYTE,length:d(i.data)}])}}return e}(h(t,l.isKanjiModeEnabled())),a=function(t,e){const n={},i={start:{}};let a=["start"];for(let o=0;o<t.length;o++){const s=t[o],u=[];for(let t=0;t<s.length;t++){const l=s[t],c=""+o+t;u.push(c),n[c]={node:l,lastCount:0},i[c]={};for(let t=0;t<a.length;t++){const o=a[t];n[o]&&n[o].node.mode===l.mode?(i[o][c]=p(n[o].lastCount+l.length,l.mode)-p(n[o].lastCount,l.mode),n[o].lastCount+=l.length):(n[o]&&(n[o].lastCount=l.length),i[o][c]=p(l.length,l.mode)+4+r.getCharCountIndicator(l.mode,e))}}a=u}for(let t=0;t<a.length;t++)i[a[t]].end=0;return{map:i,table:n}}(i,n),o=c.find_path(a.map,"start","end"),s=[];for(let t=1;t<o.length-1;t++)s.push(a.table[o[t]].node);return e.fromArray(function(t){return t.reduce(function(t,e){const n=t.length-1>=0?t[t.length-1]:null;return n&&n.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)},[])}(s))},e.rawSplit=function(t){return e.fromArray(h(t,l.isKanjiModeEnabled()))}},9899(t){function e(){this.buffer=[],this.length=0}e.prototype={get:function(t){const e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(let n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},t.exports=e},9953(t,e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return n}}}}]);
//# sourceMappingURL=861.17f92bfa076dd41fb18d.js.map