"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[588,8207],{2757(t,r,n){n.d(r,{R:()=>O});var e=n(467),i=n(4256),a=n(574),o=n(2945),u=n(5428),f=n(6483),s=n(6802),l=n(7810),c=n(2063),p=n(8011),y=n(4293),d=n(424),v=n(2303),m=n(6788),h=n(3459),g=n(1238);function _(t,r){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,r){if(t){if("string"==typeof t)return b(t,r);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){n&&(t=n);var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function b(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=Array(r);n<r;n++)e[n]=t[n];return e}function $(t,r){var n={},e=[];for(var i in t){var a=t[i],o=a.StopID,u=parseInt(a.EstimateTime);u>=0&&r.indexOf(o)>-1&&e.push([o,u])}var f=e.length;e.sort(function(t,r){return t[1]-r[1]});for(var s=1,l=0,c=e;l<c.length;l++){var p=s/f,y=(p-p%.25)/.25;n[`s_${c[l][0]}`]={number:s,text:s.toString(),code:y},s+=1}return n}function O(t,r,n,e){return S.apply(this,arguments)}function S(){return(S=(0,e.A)(function*(t,r,n,e){(0,m.Mf)(e,"getLocation_0",0,!1),(0,m.Mf)(e,"getLocation_1",0,!1),(0,m.Mf)(e,"getRoute_0",0,!1),(0,m.Mf)(e,"getRoute_1",0,!1),(0,m.Mf)(e,"getStop_0",0,!1),(0,m.Mf)(e,"getStop_1",0,!1),(0,m.Mf)(e,"getEstimateTime_0",0,!1),(0,m.Mf)(e,"getEstimateTime_1",0,!1),(0,m.Mf)(e,"getBusEvent_0",0,!1),(0,m.Mf)(e,"getBusEvent_1",0,!1);for(var b=yield(0,c.K)(e),O=yield(0,p.g)(e,1),S=yield(0,y.a)(e,!0),w=yield(0,d.T)(e),A=yield(0,l.J)(e),x=yield(0,s.d)(e),I=yield(0,f.Io)(r,n),J=(0,h.Js)("time_formatting_mode"),L=(0,h.Js)("location_labels"),C=(0,h.Js)("display_user_orientation"),N={},k={},P={},T=(0,g.Y)(),D=O[`ml_${t}`],M=D.n,Q=D.id,E=D.v,z=[],j=[],q=Q.length,B=0;B<q;B++)z=z.concat(D.s[B]),j=j.concat(D.r[B]);var F,R=function(t,r){var n,e={},i=_(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.indexOf(a.StopID)>-1&&(e[`s_${a.StopID}`]=a)}}catch(t){i.e(t)}finally{i.f()}return e}(b,z),U=(0,v.AS)(A,x,S,z),K=[],V=_(E);try{for(V.s();!(F=V.n()).done;){var H,W=F.value,X=0,Y=0,Z=_(W);try{for(Z.s();!(H=Z.n()).done;){var G=H.value;X+=G[0],Y+=G[1]}}catch(t){Z.e(t)}finally{Z.f()}var tt=(0,u.hF)([X,Y]),rt=(0,a.DK)(tt);K.push(rt)}}catch(t){V.e(t)}finally{V.f()}var nt=[];switch(L){case"address":nt=(0,i._q)(D.a);break;case"letters":nt=(0,o.V)(q);break;case"directions":nt=(0,o.M)(K)}for(var et=0;et<q;et++){var it=`g_${et}`;N[it]=[],k[it]=0,P[it]={name:nt[et],properties:[{key:"address",icon:"personal_places",value:(0,i.pD)(D.a[et])},{key:"exact_position",icon:"location_on",value:`${D.la[et].toFixed(5)}, ${D.lo[et].toFixed(5)}`},{key:"cardinal_direction",icon:K[et].icon,value:`${K[et].name}${C&&-1!==T.cardinalDirection.id&&T.cardinalDirection.id===K[et].id?"（目前指向）":""}`}]};for(var at=D.s[et],ot=at.length,ut=$(R,at),ft=0;ft<ot;ft++){var st={},lt=D.s[et][ft],ct=`s_${lt}`,pt={};if(w.hasOwnProperty(ct)){pt=w[ct],st.stopId=lt;var yt={number:0,text:"--",code:-1};ut.hasOwnProperty(ct)&&(yt=ut[ct]),st.ranking=yt;var dt=D.r[et][ft],vt=`r_${dt}`,mt={};if(S.hasOwnProperty(vt)){mt=S[vt],st.route_name=mt.n,st.route_direction=`往${[mt.des,mt.dep,""][parseInt(pt.goBack)]}`,st.routeId=dt;var ht={};if(R.hasOwnProperty(ct)){ht=R[ct];var gt=(0,v.$Q)(ht.EstimateTime,J);st.status=gt;var _t=[];U.hasOwnProperty(ct)&&(_t=U[ct].map(function(t){return(0,v.s$)(t)})),st.buses=_t;var bt=[];I.hasOwnProperty(ct)&&(bt=I[ct]),st.busArrivalTimes=bt,N[it].push(st),k[it]+=1}}}}}for(var $t in N)N[$t].sort(function(t,r){return t.routeId-r.routeId});var Ot={groupedItems:N,groups:P,groupQuantity:q,itemQuantity:k,LocationName:M,hash:t,dataUpdateTime:(0,m.Zt)(e)};return(0,m.LQ)(e),(0,m.gC)(e),Ot})).apply(this,arguments)}},9566(t,r,n){n.d(r,{DW:()=>D,Fq:()=>P,L2:()=>g,LH:()=>I,NC:()=>L,Xi:()=>S,aq:()=>N,bq:()=>Q,eD:()=>_,g$:()=>m,vV:()=>d,z$:()=>A});var e=n(467),i=n(8024),a=(n(6483),n(5767),n(2063),n(8011)),o=n(9218),u=n(4293),f=n(424),s=n(6788),l=(n(3459),n(4311));function c(t,r){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,r){if(t){if("string"==typeof t)return p(t,r);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){n&&(t=n);var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function p(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=Array(r);n<r;n++)e[n]=t[n];return e}var y={};function d(t,r){return v.apply(this,arguments)}function v(){return(v=(0,e.A)(function*(t,r){var n=(0,i.zx)(),e=yield(0,o.l)(n);if((0,s.LQ)(n),!e.symbols.hasOwnProperty(r))return!1;var a=(0,i.zx)(),u=`f_${a}`;if(y.hasOwnProperty(u))return!1;if(yield(0,l.Ct)(11,u))return!1;var f={name:t,icon:r,id:a,timestamp:(new Date).getTime()};return y[u]=f,yield(0,l.mL)(11,u,JSON.stringify(f)),yield(0,l.mL)(12,u,JSON.stringify([])),a})).apply(this,arguments)}function m(t,r,n){return h.apply(this,arguments)}function h(){return(h=(0,e.A)(function*(t,r,n){var e=`f_${t}`,a=yield(0,l.Ct)(11,e);if(!a)return!1;var u=JSON.parse(a),f=(0,i.zx)(),c=yield(0,o.l)(f);if((0,s.LQ)(f),!c.symbols.hasOwnProperty(n))return!1;var p={name:r,icon:n,id:t,timestamp:u.timestamp};return y[e]=p,yield(0,l.mL)(11,e,JSON.stringify(p)),!0})).apply(this,arguments)}function g(t){var r=`f_${t}`;return!!y.hasOwnProperty(r)&&{name:y[r].name,icon:y[r].icon,id:y[r].id,timestamp:y[r].timestamp}}function _(t){return b.apply(this,arguments)}function b(){return(b=(0,e.A)(function*(t){var r=[],n=`f_${t}`,e=g(t);if("boolean"==typeof e&&!1===e)return r;var i=yield(0,l.Ct)(12,n);if(!i)return r;var a=JSON.parse(i);if(0===a.length){return r.push({type:"empty",id:0,index:0}),r}var o,u=c(a);try{for(u.s();!(o=u.n()).done;){var f=o.value,s=yield(0,l.Ct)(13,f);if(s){var p=JSON.parse(s);r.push(p)}}}catch(t){u.e(t)}finally{u.f()}return r})).apply(this,arguments)}function $(t){return O.apply(this,arguments)}function O(){return(O=(0,e.A)(function*(t){var r=`f_${t}`,n=yield(0,l.Ct)(12,r);return n?JSON.parse(n).length:0})).apply(this,arguments)}function S(){return w.apply(this,arguments)}function w(){return(w=(0,e.A)(function*(){var t,r=yield function(){var t=[];for(var r in y){var n={name:y[r].name,icon:y[r].icon,id:y[r].id,timestamp:y[r].timestamp};t.push(n)}return t.sort(function(t,r){return t.timestamp-r.timestamp}),t}(),n=[],e=c(r);try{for(e.s();!(t=e.n()).done;){var i=t.value,a=yield _(i.id),o=yield $(i.id);n.push({name:i.name,icon:i.icon,id:i.id,timestamp:i.timestamp,content:a,contentLength:o})}}catch(t){e.e(t)}finally{e.f()}return n})).apply(this,arguments)}function A(t,r){return x.apply(this,arguments)}function x(){return(x=(0,e.A)(function*(t,r){var n=`f_${t}`,e=`${r.type}_${r.id}`,i=g(t);if("boolean"==typeof i&&!1===i)return!1;var a=yield(0,l.Ct)(12,n);if(!a)return!1;var o=JSON.parse(a);return(0===o.length||o.indexOf(e)<0)&&(yield(0,l.mL)(12,n,JSON.stringify(o.concat(e))),yield(0,l.mL)(13,e,JSON.stringify(r)),!0)})).apply(this,arguments)}function I(t,r){return J.apply(this,arguments)}function J(){return(J=(0,e.A)(function*(t,r){var n,e=`${t}_${r}`,i=c(yield(0,l.Su)(12));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=yield(0,l.Ct)(12,a);if(o)if(JSON.parse(o).indexOf(e)>-1)return!0}}catch(t){i.e(t)}finally{i.f()}return!1})).apply(this,arguments)}function L(t,r,n){return C.apply(this,arguments)}function C(){return(C=(0,e.A)(function*(t,r,n){var e=`f_${t}`,i=`${r}_${n}`,a=g(t);if("boolean"==typeof a&&!1===a)return!1;var o=yield(0,l.Ct)(12,e);if(!o)return!1;var u=JSON.parse(o),f=u.indexOf(i);return f>-1&&u.length>0&&(u.splice(f,1),yield(0,l.mL)(12,e,JSON.stringify(u))),!1===(yield I(r,n))&&(yield(0,l.iQ)(13,i)),!0})).apply(this,arguments)}function N(t,r,n){return k.apply(this,arguments)}function k(){return(k=(0,e.A)(function*(t,r,n){var e=(0,i.zx)(),o=yield(0,f.T)(e),s=yield(0,a.g)(e,0),l=yield(0,u.a)(e,!0),c=o[`s_${r}`],p=parseInt(c.goBack),y=s[`l_${c.stopLocationId}`].n,d=l[`r_${n}`],v=d.n,m=d.dep,h=d.des,g={type:"stop",id:r,timestamp:(new Date).getTime(),name:y,direction:p,route:{name:v,endPoints:{departure:m,destination:h},id:n}};return yield A(t,g)})).apply(this,arguments)}function P(t,r){return T.apply(this,arguments)}function T(){return(T=(0,e.A)(function*(t,r){var n=(0,i.zx)(),e=yield(0,u.a)(n,!0);(0,s.LQ)(n),(0,s.gC)(n);var a=`r_${r}`,o={};if(!e.hasOwnProperty(a))return!1;o=e[a];var f={type:"route",id:r,timestamp:(new Date).getTime(),name:o.n,endPoints:{departure:o.dep,destination:o.des}};return yield A(t,f)})).apply(this,arguments)}function D(t,r){return M.apply(this,arguments)}function M(){return(M=(0,e.A)(function*(t,r){var n=(0,i.zx)(),e=yield(0,a.g)(n,1);(0,s.LQ)(n),(0,s.gC)(n);var o=`ml_${r}`,u={};if(!e.hasOwnProperty(o))return!1;u=e[o];var f={type:"location",id:r,timestamp:(new Date).getTime(),name:u.n};return yield A(t,f)})).apply(this,arguments)}function Q(t,r,n,e){return E.apply(this,arguments)}function E(){return(E=(0,e.A)(function*(t,r,n,e){var i=`f_${t}`,a=`${r}_${n}`,o=g(t);if("boolean"==typeof o&&!1===o)return!1;var u=yield(0,l.Ct)(12,i);if(!u)return!1;var f=JSON.parse(u),s=f.indexOf(a);if(s>-1&&f.length>1){var c=0;switch(e){case"up":c=-1;break;case"down":c=1;break;default:c=0}return f.splice(s,1),f.splice(s+c,0,a),yield(0,l.mL)(12,i,JSON.stringify(f)),!0}return!1})).apply(this,arguments)}}}]);
//# sourceMappingURL=39e917ab4337cd2cd4d4.js.map