"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[2767,5266],{2757(t,n,e){e.d(n,{R:()=>S});var r=e(467),i=e(4256),a=e(574),o=e(2945),u=e(5428),l=e(6483),s=e(6802),f=e(7810),c=e(2063),y=e(8011),d=e(4293),p=e(424),v=e(2303),h=e(6788),m=e(3459),g=e(1238);function _(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return b(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?b(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==e.return||e.return()}finally{if(u)throw a}}}}function b(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function $(t,n){var e={},r=[];for(var i in t){var a=t[i],o=a.StopID,u=parseInt(a.EstimateTime);u>=0&&n.indexOf(o)>-1&&r.push([o,u])}var l=r.length;r.sort(function(t,n){return t[1]-n[1]});for(var s=1,f=0,c=r;f<c.length;f++){var y=s/l,d=(y-y%.25)/.25;e[`s_${c[f][0]}`]={number:s,text:s.toString(),code:d},s+=1}return e}function S(t,n,e,r){return A.apply(this,arguments)}function A(){return(A=(0,r.A)(function*(t,n,e,r){(0,h.Mf)(r,"getLocation_0",0,!1),(0,h.Mf)(r,"getLocation_1",0,!1),(0,h.Mf)(r,"getRoute_0",0,!1),(0,h.Mf)(r,"getRoute_1",0,!1),(0,h.Mf)(r,"getStop_0",0,!1),(0,h.Mf)(r,"getStop_1",0,!1),(0,h.Mf)(r,"getEstimateTime_0",0,!1),(0,h.Mf)(r,"getEstimateTime_1",0,!1),(0,h.Mf)(r,"getBusEvent_0",0,!1),(0,h.Mf)(r,"getBusEvent_1",0,!1);for(var b=yield(0,c.K)(r),S=yield(0,y.g)(r,1),A=yield(0,d.a)(r,!0),O=yield(0,p.T)(r),w=yield(0,f.J)(r),k=yield(0,s.d)(r),I=yield(0,l.Io)(n,e),x=(0,m.Js)("time_formatting_mode"),L=(0,m.Js)("location_labels"),J=(0,m.Js)("display_user_orientation"),C={},N={},D={},P=(0,g.Y)(),Q=S[`ml_${t}`],T=Q.n,M=Q.id,z=Q.v,E=[],q=[],j=M.length,F=0;F<j;F++)E=E.concat(Q.s[F]),q=q.concat(Q.r[F]);var B,K=function(t,n){var e,r={},i=_(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;n.indexOf(a.StopID)>-1&&(r[`s_${a.StopID}`]=a)}}catch(t){i.e(t)}finally{i.f()}return r}(b,E),X=(0,v.AS)(w,k,A,E),R=[],U=_(z);try{for(U.s();!(B=U.n()).done;){var V,Z=B.value,G=0,H=0,W=_(Z);try{for(W.s();!(V=W.n()).done;){var Y=V.value;G+=Y[0],H+=Y[1]}}catch(t){W.e(t)}finally{W.f()}var tt=(0,u.hF)([G,H]),nt=(0,a.DK)(tt);R.push(nt)}}catch(t){U.e(t)}finally{U.f()}var et=[];switch(L){case"address":et=(0,i._q)(Q.a);break;case"letters":et=(0,o.V)(j);break;case"directions":et=(0,o.M)(R)}for(var rt=0;rt<j;rt++){var it=`g_${rt}`;C[it]=[],N[it]=0,D[it]={name:et[rt],properties:[{key:"address",icon:"personal_places",value:(0,i.pD)(Q.a[rt])},{key:"exact_position",icon:"location_on",value:`${Q.la[rt].toFixed(5)}, ${Q.lo[rt].toFixed(5)}`},{key:"cardinal_direction",icon:R[rt].icon,value:`${R[rt].name}${J&&-1!==P.cardinalDirection.id&&P.cardinalDirection.id===R[rt].id?"（目前指向）":""}`}]};for(var at=Q.s[rt],ot=at.length,ut=$(K,at),lt=0;lt<ot;lt++){var st={},ft=Q.s[rt][lt],ct=`s_${ft}`,yt={};if(O.hasOwnProperty(ct)){yt=O[ct],st.stopId=ft;var dt={number:0,text:"--",code:-1};ut.hasOwnProperty(ct)&&(dt=ut[ct]),st.ranking=dt;var pt=Q.r[rt][lt],vt=`r_${pt}`,ht={};if(A.hasOwnProperty(vt)){ht=A[vt],st.route_name=ht.n,st.route_direction=`往${[ht.des,ht.dep,""][parseInt(yt.goBack)]}`,st.routeId=pt;var mt={};if(K.hasOwnProperty(ct)){mt=K[ct];var gt=(0,v.$Q)(mt.EstimateTime,x);st.status=gt;var _t=[];X.hasOwnProperty(ct)&&(_t=X[ct].map(function(t){return(0,v.s$)(t)})),st.buses=_t;var bt=[];I.hasOwnProperty(ct)&&(bt=I[ct]),st.busArrivalTimes=bt,C[it].push(st),N[it]+=1}}}}}for(var $t in C)C[$t].sort(function(t,n){return t.routeId-n.routeId});var St={groupedItems:C,groups:D,groupQuantity:j,itemQuantity:N,LocationName:T,hash:t,dataUpdateTime:(0,h.Zt)(r)};return(0,h.LQ)(r),(0,h.gC)(r),St})).apply(this,arguments)}},5427(t,n,e){e.d(n,{Qx:()=>g});var r=e(467),i=e(9566),a=e(5352),o=e(5314),u=e(3459),l=e(4311);function s(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return f(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?f(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==e.return||e.return()}finally{if(u)throw a}}}}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function c(t){return y.apply(this,arguments)}function y(){return(y=(0,r.A)(function*(t){var n,e=s(t);try{for(e.s();!(n=e.n()).done;){var r=n.value,a=r,o=!1,u=!1,f=`f_${a.id}`;if((yield(0,l.Ct)(11,f))?o=yield(0,i.g$)(a.id,a.name,a.icon):u=yield(0,i.vV)(a.name,a.icon),o){var c,y=s(r.content);try{for(y.s();!(c=y.n()).done;){var d=c.value;yield(0,i.z$)(r.id,d)}}catch(t){y.e(t)}finally{y.f()}}if(u){var p,v=s(r.content);try{for(v.s();!(p=v.n()).done;){var h=p.value;yield(0,i.z$)(u,h)}}catch(t){v.e(t)}finally{v.f()}}}}catch(t){e.e(t)}finally{e.f()}})).apply(this,arguments)}function d(t){return p.apply(this,arguments)}function p(){return(p=(0,r.A)(function*(t){var n,e=s(t);try{for(e.s();!(n=e.n()).done;){var r=n.value,i=(0,u.PL)(r.key);i&&"select"===i.type&&(yield(0,u.aN)(r.key,r.option))}}catch(t){e.e(t)}finally{e.f()}return!0})).apply(this,arguments)}function v(t){return h.apply(this,arguments)}function h(){return(h=(0,r.A)(function*(t){var n,e=s(t);try{for(e.s();!(n=e.n()).done;){var r=n.value;(yield(0,a.qZ)(r.id))?yield(0,a.nL)(r):yield(0,a.Qh)(r.name,r.period.start.hours,r.period.start.minutes,r.period.end.hours,r.period.end.minutes,r.days)}}catch(t){e.e(t)}finally{e.f()}return!0})).apply(this,arguments)}function m(){return(m=(0,r.A)(function*(t){var n,e=s(t);try{for(e.s();!(n=e.n()).done;){var r=n.value;switch(r.type){case"route":(yield(0,o.DF)("route",r.id))||(yield(0,o.XK)(r.type,r.id));break;case"location":(yield(0,o.DF)("location",r.hash))||(yield(0,o.XK)(r.type,r.hash));break;case"bus":(yield(0,o.DF)("bus",r.id))||(yield(0,o.XK)(r.type,r.id))}}}catch(t){e.e(t)}finally{e.f()}return!0})).apply(this,arguments)}function g(t){return _.apply(this,arguments)}function _(){return _=(0,r.A)(function*(t){var n=JSON.parse(t);switch(n.version){case 1:return yield c(n.folders),!0;case 2:return yield c(n.folders),yield d(n.settings),!0;case 3:return yield c(n.folders),yield d(n.settings),yield v(n.personal_schedules),!0;case 4:return yield c(n.folders),yield d(n.settings),yield v(n.personal_schedules),yield function(t){return m.apply(this,arguments)}(n.recent_views),!0;default:return!1}}),_.apply(this,arguments)}},5976(t,n,e){e.d(n,{R:()=>l});var r=e(467),i=e(9566),a=e(5352),o=e(5314),u=e(3459);function l(){return s.apply(this,arguments)}function s(){return(s=(0,r.A)(function*(){var t=yield(0,i.Xi)(),n=(0,u.Gn)(),e=yield(0,a.ty)(),r=yield(0,o.Qj)(),l={};return l.time=(new Date).toISOString(),l.version=4,l.folders=t,l.settings=n,l.personal_schedules=e,l.recent_views=r,JSON.stringify(l)})).apply(this,arguments)}},6983(t,n,e){e.d(n,{v:()=>l});var r=e(467),i=e(1351),a=e(3041),o=e(8011),u=e(6788);function l(t,n){return s.apply(this,arguments)}function s(){return(s=(0,r.A)(function*(t,n){var e=yield(0,o.g)(n,1);(0,u.LQ)(n),(0,u.gC)(n);var r=`ml_${t}`;if(!e.hasOwnProperty(r))return{actions:[],actionsQuantity:0,hash:t};e[r];var l=[{icon:"folder",name:"儲存",key:"save-to-folder",action:function(){(0,a.B)("location",[t])}},{icon:"ios_share",name:"分享",key:"permalink",action:function(){(0,i.k9)(t)}},{icon:"qr_code_2",name:"二維條碼",key:"permalink-qr-code",action:function(){(0,i.qp)(t)}}];return{actions:l,actionsQuantity:l.length,hash:t}})).apply(this,arguments)}},9566(t,n,e){e.d(n,{DW:()=>Q,Fq:()=>D,L2:()=>g,LH:()=>I,NC:()=>L,Xi:()=>A,aq:()=>C,bq:()=>M,eD:()=>_,g$:()=>h,vV:()=>p,z$:()=>w});var r=e(467),i=e(8024),a=(e(6483),e(5767),e(2063),e(8011)),o=e(9218),u=e(4293),l=e(424),s=e(6788),f=(e(3459),e(4311));function c(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return y(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?y(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==e.return||e.return()}finally{if(u)throw a}}}}function y(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var d={};function p(t,n){return v.apply(this,arguments)}function v(){return(v=(0,r.A)(function*(t,n){var e=(0,i.zx)(),r=yield(0,o.l)(e);if((0,s.LQ)(e),!r.symbols.hasOwnProperty(n))return!1;var a=(0,i.zx)(),u=`f_${a}`;if(d.hasOwnProperty(u))return!1;if(yield(0,f.Ct)(11,u))return!1;var l={name:t,icon:n,id:a,timestamp:(new Date).getTime()};return d[u]=l,yield(0,f.mL)(11,u,JSON.stringify(l)),yield(0,f.mL)(12,u,JSON.stringify([])),a})).apply(this,arguments)}function h(t,n,e){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(function*(t,n,e){var r=`f_${t}`,a=yield(0,f.Ct)(11,r);if(!a)return!1;var u=JSON.parse(a),l=(0,i.zx)(),c=yield(0,o.l)(l);if((0,s.LQ)(l),!c.symbols.hasOwnProperty(e))return!1;var y={name:n,icon:e,id:t,timestamp:u.timestamp};return d[r]=y,yield(0,f.mL)(11,r,JSON.stringify(y)),!0})).apply(this,arguments)}function g(t){var n=`f_${t}`;return!!d.hasOwnProperty(n)&&{name:d[n].name,icon:d[n].icon,id:d[n].id,timestamp:d[n].timestamp}}function _(t){return b.apply(this,arguments)}function b(){return(b=(0,r.A)(function*(t){var n=[],e=`f_${t}`,r=g(t);if("boolean"==typeof r&&!1===r)return n;var i=yield(0,f.Ct)(12,e);if(!i)return n;var a=JSON.parse(i);if(0===a.length){return n.push({type:"empty",id:0,index:0}),n}var o,u=c(a);try{for(u.s();!(o=u.n()).done;){var l=o.value,s=yield(0,f.Ct)(13,l);if(s){var y=JSON.parse(s);n.push(y)}}}catch(t){u.e(t)}finally{u.f()}return n})).apply(this,arguments)}function $(t){return S.apply(this,arguments)}function S(){return(S=(0,r.A)(function*(t){var n=`f_${t}`,e=yield(0,f.Ct)(12,n);return e?JSON.parse(e).length:0})).apply(this,arguments)}function A(){return O.apply(this,arguments)}function O(){return(O=(0,r.A)(function*(){var t,n=yield function(){var t=[];for(var n in d){var e={name:d[n].name,icon:d[n].icon,id:d[n].id,timestamp:d[n].timestamp};t.push(e)}return t.sort(function(t,n){return t.timestamp-n.timestamp}),t}(),e=[],r=c(n);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=yield _(i.id),o=yield $(i.id);e.push({name:i.name,icon:i.icon,id:i.id,timestamp:i.timestamp,content:a,contentLength:o})}}catch(t){r.e(t)}finally{r.f()}return e})).apply(this,arguments)}function w(t,n){return k.apply(this,arguments)}function k(){return(k=(0,r.A)(function*(t,n){var e=`f_${t}`,r=`${n.type}_${n.id}`,i=g(t);if("boolean"==typeof i&&!1===i)return!1;var a=yield(0,f.Ct)(12,e);if(!a)return!1;var o=JSON.parse(a);return(0===o.length||o.indexOf(r)<0)&&(yield(0,f.mL)(12,e,JSON.stringify(o.concat(r))),yield(0,f.mL)(13,r,JSON.stringify(n)),!0)})).apply(this,arguments)}function I(t,n){return x.apply(this,arguments)}function x(){return(x=(0,r.A)(function*(t,n){var e,r=`${t}_${n}`,i=c(yield(0,f.Su)(12));try{for(i.s();!(e=i.n()).done;){var a=e.value,o=yield(0,f.Ct)(12,a);if(o)if(JSON.parse(o).indexOf(r)>-1)return!0}}catch(t){i.e(t)}finally{i.f()}return!1})).apply(this,arguments)}function L(t,n,e){return J.apply(this,arguments)}function J(){return(J=(0,r.A)(function*(t,n,e){var r=`f_${t}`,i=`${n}_${e}`,a=g(t);if("boolean"==typeof a&&!1===a)return!1;var o=yield(0,f.Ct)(12,r);if(!o)return!1;var u=JSON.parse(o),l=u.indexOf(i);return l>-1&&u.length>0&&(u.splice(l,1),yield(0,f.mL)(12,r,JSON.stringify(u))),!1===(yield I(n,e))&&(yield(0,f.iQ)(13,i)),!0})).apply(this,arguments)}function C(t,n,e){return N.apply(this,arguments)}function N(){return(N=(0,r.A)(function*(t,n,e){var r=(0,i.zx)(),o=yield(0,l.T)(r),s=yield(0,a.g)(r,0),f=yield(0,u.a)(r,!0),c=o[`s_${n}`],y=parseInt(c.goBack),d=s[`l_${c.stopLocationId}`].n,p=f[`r_${e}`],v=p.n,h=p.dep,m=p.des,g={type:"stop",id:n,timestamp:(new Date).getTime(),name:d,direction:y,route:{name:v,endPoints:{departure:h,destination:m},id:e}};return yield w(t,g)})).apply(this,arguments)}function D(t,n){return P.apply(this,arguments)}function P(){return(P=(0,r.A)(function*(t,n){var e=(0,i.zx)(),r=yield(0,u.a)(e,!0);(0,s.LQ)(e),(0,s.gC)(e);var a=`r_${n}`,o={};if(!r.hasOwnProperty(a))return!1;o=r[a];var l={type:"route",id:n,timestamp:(new Date).getTime(),name:o.n,endPoints:{departure:o.dep,destination:o.des}};return yield w(t,l)})).apply(this,arguments)}function Q(t,n){return T.apply(this,arguments)}function T(){return(T=(0,r.A)(function*(t,n){var e=(0,i.zx)(),r=yield(0,a.g)(e,1);(0,s.LQ)(e),(0,s.gC)(e);var o=`ml_${n}`,u={};if(!r.hasOwnProperty(o))return!1;u=r[o];var l={type:"location",id:n,timestamp:(new Date).getTime(),name:u.n};return yield w(t,l)})).apply(this,arguments)}function M(t,n,e,r){return z.apply(this,arguments)}function z(){return(z=(0,r.A)(function*(t,n,e,r){var i=`f_${t}`,a=`${n}_${e}`,o=g(t);if("boolean"==typeof o&&!1===o)return!1;var u=yield(0,f.Ct)(12,i);if(!u)return!1;var l=JSON.parse(u),s=l.indexOf(a);if(s>-1&&l.length>1){var c=0;switch(r){case"up":c=-1;break;case"down":c=1;break;default:c=0}return l.splice(s,1),l.splice(s+c,0,a),yield(0,f.mL)(12,i,JSON.stringify(l)),!0}return!1})).apply(this,arguments)}}}]);
//# sourceMappingURL=a60dd6362b801069c29b.js.map