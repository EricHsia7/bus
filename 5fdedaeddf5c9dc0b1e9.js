"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[794],{540:(e,t,n)=>{n.d(t,{F:()=>S,a:()=>q});var a=n(5767),i=n(9566),r=n(3459),s=n(8024),o=n(3648),c=n(4537),d=n(904),u=n(3030),l=n(9119),m=n(4690);function p(e,t,n,a,i,r,s){try{var o=e[r](s),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){p(r,a,i,s,o,"next",e)}function o(e){p(r,a,i,s,o,"throw",e)}s(void 0)}))}}var v=(0,o.bv)(".hj"),h=(0,o.aI)(v,".mj"),k=(0,o.aI)(v,".uj"),b=(0,o.aI)(k,".gk"),y=(0,o.aI)(h,".qj .rj"),g={},w=!1,L=!1,I=15e3,x=5e3,j=15e3,C=!0,E=0,M=0,T="",A=!1,_=!1,P=!1;function Z(){var e=document.createElement("div");e.classList.add("mk"),e.setAttribute("type","stop");var t=document.createElement("div");t.classList.add("nk"),t.innerHTML=(0,c.Z)("location_on");var n=document.createElement("div");n.classList.add("ok");var a=document.createElement("div");a.classList.add("pk");var i=document.createElement("div");i.classList.add("qk");var r=document.createElement("div");r.classList.add("tk");var s=document.createElement("div");s.classList.add("_a"),s.setAttribute("code","0"),s.setAttribute("displayed","false");var o=document.createElement("div");o.classList.add("ab"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),r.appendChild(s),r.appendChild(o);var d=document.createElement("div");d.classList.add("rk"),d.innerHTML=(0,c.Z)("keyboard_arrow_right");var u=document.createElement("div");return u.classList.add("sk"),i.appendChild(r),i.appendChild(d),i.appendChild(u),e.appendChild(t),e.appendChild(n),e.appendChild(a),e.appendChild(i),{element:e,id:""}}function D(){var e=document.createElement("div");e.classList.add("hk");var t=document.createElement("div");t.classList.add("ik");var n=document.createElement("div");n.classList.add("jk");var a=document.createElement("div");a.classList.add("kk"),t.appendChild(n),t.appendChild(a);var i=document.createElement("div");return i.classList.add("lk"),e.appendChild(t),e.appendChild(i),{element:e,id:""}}function $(e){var t=e;if(A){var n=t.detail.progress-1;y.style.setProperty("--kj",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,$)}function S(){for(var e=(0,r.Js)("playing_animation"),t=(0,d.gO)("window"),n=(t.width,t.height),a=Math.floor(n/50/3)+2,i=[],s=0;s<3;s++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:a},c=0;c<a;c++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}R({folders:i,dataUpdateTime:0},!0,e)}function R(e,t,n){function a(e,a,i){function r(e,t){e.setAttribute("type",t.type)}function d(e,t){var n=(0,o.aI)(e,".nk"),a="";switch(t.type){case"stop":case"location":a="location_on";break;case"route":a="route";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb";break;default:a=""}n.innerHTML=(0,c.Z)(a)}function l(e,t,n){if("stop"===t.type){var a=e.getBoundingClientRect(),i=a.top,r=a.left,s=a.bottom,c=a.right,d=window.innerWidth,u=window.innerHeight,l=(0,o.aI)(e,".qk .tk"),m=(0,o.aI)(l,"._a"),p=(0,o.aI)(l,".ab");m.setAttribute("code",t.status.code.toString()),m.innerText=t.status.text,n&&s>0&&i<u&&c>0&&r<d?(p.addEventListener("animationend",(function(){p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,p.classList.remove("kb"),m.setAttribute("displayed","false")}),{once:!0}),m.setAttribute("displayed","true"),p.classList.add("kb")):(p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text)}}function p(e,t){var n="";switch(t.type){case"stop":case"route":case"location":n=t.name;break;case"bus":n=t.busID;break;case"empty":n="沒有內容";break;default:n="null"}(0,o.aI)(e,".pk").innerText=n}function f(e,t){var n="";switch(t.type){case"stop":n=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":n=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":n=t.labels;break;case"bus":break;case"empty":n="提示";break;default:n="null"}(0,o.aI)(e,".ok").innerText=n}function v(e,t){var n=(0,o.aI)(e,".qk .rk");switch(t.type){case"stop":n.onclick=function(){(0,m.SR)(t.route.id,t.route.pathAttributeId)};break;case"route":n.onclick=function(){(0,m.SR)(t.id,t.pathAttributeId)};break;case"location":n.onclick=function(){(0,u.so)(t.id)}}}function h(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function k(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null===i)r(e,a),d(e,a),l(e,a,n),p(e,a),f(e,a),v(e,a),h(e,n),k(e,t);else if(a.type!==i.type)r(e,a),d(e,a),l(e,a,n),p(e,a),f(e,a),v(e,a),h(e,n),k(e,t);else{switch(a.type){case"stop":(0,s.hw)(i.route,a.route)||(f(e,a),v(e,a)),(0,s.hw)(i.name,a.name)||p(e,a),a.status.code===i.status.code&&(0,s.hw)(i.status.text,a.status.text)||l(e,a,n);break;case"route":(0,s.hw)(i.id,a.id)||v(e,a),(0,s.hw)(i.endPoints,a.endPoints)||f(e,a),(0,s.hw)(i.name,a.name)||p(e,a);break;case"location":(0,s.hw)(i.id,a.id)||v(e,a),(0,s.hw)(i.name,a.name)||p(e,a);break;case"bus":(0,s.hw)(i.currentRoute,a.currentRoute)||f(e,a),(0,s.hw)(i.busID,a.busID)||p(e,a);break;case"empty":a.type!==i.type&&(f(e,a),p(e,a))}t!==L&&k(e,t),n!==w&&h(e,n)}}function i(e,a,i){function r(e,t){var n=(0,o.aI)(e,".ik");(0,o.aI)(n,".kk").innerText=t.name}function d(e,t){var n=(0,o.aI)(e,".ik");(0,o.aI)(n,".jk").innerHTML=(0,c.Z)(t.icon)}function u(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}null===i?(r(e,a),d(e,a),u(e,n),l(e,t)):(a.name!==i.name&&r(e,a),a.icon!==i.icon&&d(e,a),n!==w&&u(e,n),t!==L&&l(e,t))}var r=e.folders,d=r.length,l=(0,o.jg)(b,".hk").length;if(d!==l){var p=l-d;if(p<0){for(var f=new DocumentFragment,v=0;v<Math.abs(p);v++){var h=D();f.appendChild(h.element)}b.append(f)}else for(var k=(0,o.jg)(b,".hk"),y=0;y<Math.abs(p);y++){k[l-1-y].remove()}}for(var I=(0,o.jg)(b,".hk"),x=0;x<d;x++){var j=r[x].content.length,C=I[x],E=(0,o.aI)(C,".lk"),M=(0,o.jg)(E,".mk").length;if(j!==M){var T=M-j;if(T<0)for(var A=0;A<Math.abs(T);A++){var _=Z();E.appendChild(_.element)}else for(var P=(0,o.jg)(E,".mk"),$=0;$<Math.abs(T);$++){P[M-1-$].remove()}}}for(var S=(0,o.jg)(b,".hk"),R=0;R<d;R++){var H=r[R],J=H.content,z=J.length,O=S[R],q=(0,o.aI)(O,".lk");if(g.hasOwnProperty("folders"))if(g.folders[R])i(O,H,g.folders[R]);else i(O,H,null);else i(O,H,null);for(var Q=(0,o.jg)(q,".mk"),U=0;U<z;U++){var F=Q[U],B=J[U];if(g.hasOwnProperty("folders"))if(g.folders[R])if(g.folders[R].content[U])a(F,B,g.folders[R].content[U]);else a(F,B,null);else a(F,B,null);else a(F,B,null)}}g=e,w=n,L=t}function H(){return J.apply(this,arguments)}function J(){return(J=f((function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");C=t.dynamic,I=t.baseInterval,A=!0,T=(0,s.zx)(),y.setAttribute("refreshing","true"),y.classList.remove("tj"),document.addEventListener(T,$);var n=yield(0,i.R_)(T);R(n,!1,e);var o=0;C&&(o=yield(0,a.wz)()),E=(new Date).getTime(),M=C?Math.max(E+x,n.dataUpdateTime+I/o):E+I,j=Math.max(x,M-E),A=!1,y.setAttribute("refreshing","false"),y.style.setProperty("--lj",`${j}ms`),y.classList.add("tj")}))).apply(this,arguments)}function z(){return O.apply(this,arguments)}function O(){return(O=f((function*(){H().then((function(){_?setTimeout((function(){z()}),Math.max(x,M-(new Date).getTime())):P=!1})).catch((function(e){_?((0,l.a)("資料夾網路連線中斷，將在10秒後重試。","error"),setTimeout((function(){z()}),1e4)):P=!1}))}))).apply(this,arguments)}function q(){S(),_||(_=!0,P?H():(P=!0,z()))}},4537:(e,t,n)=>{function a(e){return`<span class="ya">${e}</span>`}n.d(t,{Z:()=>a})},6082:(e,t,n)=>{n.d(t,{X:()=>k,m:()=>l});var a=n(9734),i=n(8011),r=n(9930),s=n(4293),o=n(6788),c=n(3648);function d(e,t,n,a,i,r,s){try{var o=e[r](s),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(a,i)}var u="downloadData",l=!1,m=(0,c.bv)(".hj"),p=(0,c.aI)(m,".mj"),f=(0,c.aI)(p,".pj"),v=(0,c.aI)(f,'svg#download-svg path[progress="progress"]');function h(e){var t=e,n=189*(1-(0,o._M)(u));v.style.setProperty("--ij",`${n}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,h),v.addEventListener("transitionend",(function(){f.setAttribute("complete","true")}),{once:!0}),v.style.setProperty("--ij","0px"),l=!0)}function k(){return b.apply(this,arguments)}function b(){var e;return e=function*(){(0,o.Mf)(u,"getLocation_0",0,!1),(0,o.Mf)(u,"getLocation_1",0,!1),(0,o.Mf)(u,"getCarInfo_0",0,!1),(0,o.Mf)(u,"getCarInfo_1",0,!1),(0,o.Mf)(u,"getMaterialSymbols",0,!1),document.addEventListener(u,h),yield(0,s.a)(u,!0),yield(0,i.g)(u,1),yield(0,a.j)(u,!0),yield(0,r.z)(u),(0,o.LQ)(u),(0,o.gC)(u)},b=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){d(r,a,i,s,o,"next",e)}function o(e){d(r,a,i,s,o,"throw",e)}s(void 0)}))},b.apply(this,arguments)}},6091:(e,t,n)=>{n.d(t,{Q:()=>P,u:()=>R});var a=n(5767),i=n(5314),r=n(3459),s=n(8024),o=n(3648),c=n(4927),d=n(4537),u=n(904),l=n(3030),m=n(4690);function p(e,t,n,a,i,r,s){try{var o=e[r](s),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){p(r,a,i,s,o,"next",e)}function o(e){p(r,a,i,s,o,"throw",e)}s(void 0)}))}}var v=(0,o.bv)(".hj"),h=(0,o.aI)(v,".uj"),k=(0,o.aI)(h,".vj"),b=(0,o.aI)(k,"._j"),y={},g=!1,w=!1,L=15e3,I=5e3,x=!0,j=!1,C=0,E=0,M="",T=!1;function A(){var e=document.createElement("div");e.classList.add("ak");var t=document.createElement("div");t.classList.add("bk");var n=document.createElement("div");n.classList.add("ck");var a=document.createElement("div");a.classList.add("dk");var i=document.createElement("div");i.classList.add("ek"),t.appendChild(n),t.appendChild(a),t.appendChild(i);var r=document.createElement("div");return r.classList.add("fk"),e.appendChild(t),e.appendChild(r),{element:e,id:""}}function _(e,t,n){function a(e,a,i){function r(e,t){var n=(0,o.aI)(e,".bk .ck"),a="";switch(t.type){case"route":a="route";break;case"location":a="location_on";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb"}n.innerHTML=(0,d.Z)(a)}function u(e,t){var n=(0,o.aI)(e,".bk .dk"),a="";switch(t.type){case"route":a="路線";break;case"location":a="地點";break;case"bus":a="公車";break;case"empty":a="提示"}n.innerText=a}function p(e,t){(0,o.aI)(e,".bk .ek").innerText=t.time.relative}function f(e,t){(0,o.aI)(e,".fk").innerText=t.name}function v(e,t){switch(t.type){case"route":e.onclick=function(){(0,m.SR)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,l.so)(t.hash)};break;case"bus":e.onclick=function(){(0,c.$)(t.id)};break;case"empty":e.onclick=null}}function h(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function k(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null===i)r(e,a),u(e,a),p(e,a),f(e,a),v(e,a),h(e,n),k(e,t);else if(a.type!==i.type)r(e,a),u(e,a),p(e,a),f(e,a),v(e,a),h(e,n),k(e,t);else{switch(a.type){case"location":(0,s.hw)(i.name,a.name)||f(e,a),i.time!==a.time&&p(e,a),(0,s.hw)(i.hash,a.hash)||v(e,a);break;case"route":(0,s.hw)(i.name,a.name)||f(e,a),i.time!==a.time&&p(e,a),(0,s.hw)(i.id,a.id)&&(0,s.hw)(i.pid,a.pid)||v(e,a);break;case"bus":(0,s.hw)(i.name,a.name)||f(e,a),i.time!==a.time&&p(e,a),(0,s.hw)(i.id,a.id)||v(e,a);break;case"empty":i.time!==a.time&&p(e,a)}n!==g&&h(e,n),t!==w&&k(e,t)}}var i=e.itemQuantity,r=(0,o.jg)(b,".ak").length;if(i!==r){var u=r-i;if(u<0){for(var p=new DocumentFragment,f=0;f<Math.abs(u);f++){var v=A();p.appendChild(v.element)}b.append(p)}else for(var h=(0,o.jg)(b,".ak"),k=0;k<Math.abs(u);k++){h[r-1-k].remove()}}for(var L=(0,o.jg)(b,".ak"),I=0;I<i;I++){var x=L[I],j=e.items[I];if(y.hasOwnProperty("items"))if(y.items[I])a(x,j,y.items[I]);else a(x,j,null);else a(x,j,null)}y=e,g=n,w=t}function P(){for(var e=(0,r.Js)("playing_animation"),t=(0,u.gO)("window"),n=Math.floor(t.height/70/3)+2,a=[],i=0;i<n;i++)a.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_({items:a,itemQuantity:a.length,dataUpdateTime:0},!0,e)}function Z(){return D.apply(this,arguments)}function D(){return(D=f((function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");x=t.dynamic,L=t.baseInterval,M=(0,s.zx)();var n=yield(0,i.$i)(M);_(n,!1,e);var o=0;x&&(o=yield(0,a.wz)()),C=(new Date).getTime(),E=x?Math.max(C+I,n.dataUpdateTime+L/o):C+L,Math.max(I,E-C)}))).apply(this,arguments)}function $(){return S.apply(this,arguments)}function S(){return(S=f((function*(){Z().then((function(){j?setTimeout((function(){$()}),Math.max(I,E-(new Date).getTime())):T=!1})).catch((function(e){j?setTimeout((function(){$()}),1e4):T=!1}))}))).apply(this,arguments)}function R(){P(),j||(j=!0,T?Z():(T=!0,$()))}}}]);
//# sourceMappingURL=5fdedaeddf5c9dc0b1e9.js.map