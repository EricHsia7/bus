"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[6823],{540(e,t,n){n.d(t,{F:()=>z,a:()=>q});var a=n(467),i=n(5767),r=n(9566),s=n(3459),o=n(8024),d=n(8179),c=n(4537),l=n(904),u=n(3030),p=n(9119),m=n(4690),f=(0,d.bv)(".w"),v=(0,d.aI)(f,".x"),h=(0,d.aI)(f,".jn"),b=(0,d.aI)(h,".wn"),y=(0,d.aI)(v,".fn .gn"),g={},w=!1,k=!1,x=15e3,I=5e3,C=15e3,L=!0,A=0,E=0,M="",T=!1,_=!1,P=!1;function j(){var e=document.createElement("div");e.classList.add("bo"),e.setAttribute("type","stop");var t=document.createElement("div");t.classList.add("co"),t.appendChild((0,c.YC)("location_on"));var n=document.createElement("div");n.classList.add("do");var a=document.createElement("div");a.classList.add("eo");var i=document.createElement("div");i.classList.add("fo");var r=document.createElement("div");r.classList.add("io");var s=document.createElement("div");s.classList.add("uc"),s.setAttribute("code","0"),s.setAttribute("displayed","false");var o=document.createElement("div");o.classList.add("vc"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),r.appendChild(s),r.appendChild(o);var d=document.createElement("div");d.classList.add("go"),d.appendChild((0,c.YC)("keyboard_arrow_right"));var l=document.createElement("div");return l.classList.add("ho"),i.appendChild(r),i.appendChild(d),i.appendChild(l),e.appendChild(t),e.appendChild(n),e.appendChild(a),e.appendChild(i),{element:e,id:""}}function D(){var e=document.createElement("div");e.classList.add("xn");var t=document.createElement("div");t.classList.add("yn");var n=document.createElement("div");n.classList.add("zn"),n.appendChild((0,c.oC)());var a=document.createElement("div");a.classList.add("_n"),t.appendChild(n),t.appendChild(a);var i=document.createElement("div");return i.classList.add("ao"),e.appendChild(t),e.appendChild(i),{element:e,id:""}}function S(e){var t=e;if(T){var n=t.detail.progress-1;y.style.setProperty("--an",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,S)}function z(){for(var e=(0,s.Js)("playing_animation"),t=(0,l.gO)("window"),n=(t.width,t.height),a=Math.floor(n/50/3)+2,i=[],r=0;r<3;r++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:a},d=0;d<a;d++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}$({folders:i,dataUpdateTime:0},!0,e)}function $(e,t,n){function a(e,a,i){function r(e,t){e.setAttribute("type",t.type)}function s(e,t){var n=(0,d.aI)(e,".co"),a="";switch(t.type){case"stop":case"location":a="location_on";break;case"route":a="route";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb";break;default:a=""}(0,c.yD)(n,a)}function l(e,t,n){if("stop"===t.type){var a=e.getBoundingClientRect(),i=a.top,r=a.left,s=a.bottom,o=a.right,c=window.innerWidth,l=window.innerHeight,u=(0,d.aI)(e,".fo .io"),p=(0,d.aI)(u,".uc"),m=(0,d.aI)(u,".vc");p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,n&&s>0&&i<l&&o>0&&r<c?(m.addEventListener("animationend",function(){m.setAttribute("code",t.status.code.toString()),m.innerText=t.status.text,m.classList.remove("ld"),p.setAttribute("displayed","false")},{once:!0}),p.setAttribute("displayed","true"),m.classList.add("ld")):(m.setAttribute("code",t.status.code.toString()),m.innerText=t.status.text)}}function p(e,t){var n="";switch(t.type){case"stop":case"route":case"location":n=t.name;break;case"bus":n=t.busID;break;case"empty":n="沒有內容";break;default:n="null"}(0,d.aI)(e,".eo").innerText=n}function f(e,t){var n="";switch(t.type){case"stop":n=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":n=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":n="地點";break;case"bus":break;case"empty":n="提示";break;default:n="null"}(0,d.aI)(e,".do").innerText=n}function v(e,t){var n=(0,d.aI)(e,".fo .go");switch(t.type){case"stop":n.onclick=function(){(0,m.SR)(t.route.id,t.route.pathAttributeId)};break;case"route":n.onclick=function(){(0,m.SR)(t.id,t.pathAttributeId)};break;case"location":n.onclick=function(){(0,u.so)(t.id)}}}function h(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function b(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}if(null==i)r(e,a),s(e,a),l(e,a,n),p(e,a),f(e,a),v(e,a),h(e,n),b(e,t);else if(a.type!==i.type)r(e,a),s(e,a),l(e,a,n),p(e,a),f(e,a),v(e,a),h(e,n),b(e,t);else{switch(a.type){case"stop":(0,o.hw)(i.route,a.route)||(f(e,a),v(e,a)),i.name!==a.name&&p(e,a),i.status.time!==a.status.time&&l(e,a,n);break;case"route":i.id!==a.id&&v(e,a),(0,o.hw)(i.endPoints,a.endPoints)||f(e,a),i.name!==a.name&&p(e,a);break;case"location":i.id!==a.id&&v(e,a),i.name!==a.name&&p(e,a);break;case"bus":default:break;case"empty":a.type!==i.type&&(f(e,a),p(e,a))}t!==k&&b(e,t),n!==w&&h(e,n)}}function i(e,a,i){function r(e,t){var n=(0,d.aI)(e,".yn");(0,d.aI)(n,"._n").innerText=t.name}function s(e,t){var n=(0,d.aI)(e,".yn"),a=(0,d.aI)(n,".zn");(0,c.yD)(a,t.icon)}function l(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function u(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}null==i?(r(e,a),s(e,a),l(e,n),u(e,t)):(a.name!==i.name&&r(e,a),a.icon!==i.icon&&s(e,a),n!==w&&l(e,n),t!==k&&u(e,t))}var r=e.folders,s=r.length,l=(0,d.jg)(b,".xn").length;if(s!==l){var p=l-s;if(p<0){for(var f=new DocumentFragment,v=0,h=Math.abs(p);v<h;v++){var y=D();f.appendChild(y.element)}b.append(f)}else for(var x=(0,d.jg)(b,".xn"),I=0,C=Math.abs(p);I<C;I++){x[l-1-I].remove()}}for(var L=(0,d.jg)(b,".xn"),A=0;A<s;A++){var E=r[A].content.length,M=L[A],T=(0,d.aI)(M,".ao"),_=(0,d.jg)(T,".bo").length;if(E!==_){var P=_-E;if(P<0)for(var S=0,z=Math.abs(P);S<z;S++){var $=j();T.appendChild($.element)}else for(var J=(0,d.jg)(T,".bo"),Z=0,O=Math.abs(P);Z<O;Z++){J[_-1-Z].remove()}}}for(var R=(0,d.jg)(b,".xn"),q=0;q<s;q++){var Q=r[q],U=Q.content,F=U.length,Y=R[q],B=(0,d.aI)(Y,".ao");if(g.hasOwnProperty("folders"))if(g.folders[q])i(Y,Q,g.folders[q]);else i(Y,Q,null);else i(Y,Q,null);for(var H=(0,d.jg)(B,".bo"),W=0;W<F;W++){var X=H[W],G=U[W];if(g.hasOwnProperty("folders"))if(g.folders[q])if(g.folders[q].content[W])a(X,G,g.folders[q].content[W]);else a(X,G,null);else a(X,G,null);else a(X,G,null)}}g=e,w=n,k=t}function J(){return Z.apply(this,arguments)}function Z(){return(Z=(0,a.A)(function*(){var e=(0,s.Js)("playing_animation"),t=(0,s.Js)("refresh_interval");L=t.dynamic,x=t.baseInterval,T=!0,M=(0,o.zx)(),y.setAttribute("refreshing","true"),y.classList.remove("in"),document.addEventListener(M,S);var n=yield(0,r.R_)(M);$(n,!1,e);var a=0;L&&(a=yield(0,i.wz)()),A=(new Date).getTime(),E=L?Math.max(A+I,n.dataUpdateTime+x/a):A+x,C=Math.max(I,E-A),T=!1,y.setAttribute("refreshing","false"),y.style.setProperty("--bn",`${C}ms`),y.classList.add("in")})).apply(this,arguments)}function O(){return R.apply(this,arguments)}function R(){return(R=(0,a.A)(function*(){J().then(function(){_?setTimeout(function(){O()},Math.max(I,E-(new Date).getTime())):P=!1}).catch(function(e){_?((0,p.a)("error","資料夾網路連線中斷，將在10秒後重試。"),setTimeout(function(){O()},1e4)):P=!1})})).apply(this,arguments)}function q(){z(),_||(_=!0,P?J():(P=!0,O()))}},6082(e,t,n){n.d(t,{X:()=>b,m:()=>u});var a=n(467),i=n(9734),r=n(8011),s=n(9218),o=n(4293),d=n(6788),c=n(8179),l="downloadData",u=!1,p=(0,c.bv)(".w"),m=(0,c.aI)(p,".x"),f=(0,c.aI)(m,".y"),v=(0,c.aI)(f,'svg#download-svg path[progress="progress"]');function h(e){var t=e,n=189*(1-(0,d._M)(l));v.style.setProperty("--z",`${n}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,h),v.addEventListener("transitionend",function(){f.setAttribute("complete","true")},{once:!0}),v.style.setProperty("--z","0px"),u=!0)}function b(){return y.apply(this,arguments)}function y(){return(y=(0,a.A)(function*(){(0,d.Mf)(l,"getLocation_0",0,!1),(0,d.Mf)(l,"getLocation_1",0,!1),(0,d.Mf)(l,"getCarInfo_0",0,!1),(0,d.Mf)(l,"getCarInfo_1",0,!1),(0,d.Mf)(l,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(l,h),yield(0,o.a)(l,!0),yield(0,r.g)(l,1),yield(0,i.j)(l,!0),yield(0,s.l)(l),(0,d.LQ)(l),(0,d.gC)(l)})).apply(this,arguments)}},6091(e,t,n){n.d(t,{Q:()=>P,u:()=>$});var a=n(467),i=n(5767),r=n(5314),s=n(3459),o=n(8024),d=n(8179),c=n(4884),l=n(4537),u=n(904),p=n(3030),m=n(4690),f=(0,d.bv)(".w"),v=(0,d.aI)(f,".jn"),h=(0,d.aI)(v,".kn"),b=(0,d.aI)(h,".pn"),y={},g=!1,w=!1,k=15e3,x=5e3,I=!0,C=!1,L=0,A=0,E="",M=!1;function T(){var e=document.createElement("div");e.classList.add("qn");var t=document.createElement("div");t.classList.add("rn");var n=document.createElement("div");n.classList.add("sn"),n.appendChild((0,l.oC)());var a=document.createElement("div");a.classList.add("tn");var i=document.createElement("div");i.classList.add("un"),t.appendChild(n),t.appendChild(a),t.appendChild(i);var r=document.createElement("div");return r.classList.add("vn"),e.appendChild(t),e.appendChild(r),{element:e,id:""}}function _(e,t,n){function a(e,a,i){function r(e,t){var n=(0,d.aI)(e,".rn"),a=(0,d.aI)(n,".sn"),i="";switch(t.type){case"route":i="route";break;case"location":i="location_on";break;case"bus":i="directions_bus";break;case"empty":i="lightbulb"}(0,l.yD)(a,i)}function s(e,t){var n=(0,d.aI)(e,".rn .tn"),a="";switch(t.type){case"route":a="路線";break;case"location":a="地點";break;case"bus":a="公車";break;case"empty":a="提示"}n.innerText=a}function u(e,t){(0,d.aI)(e,".rn .un").innerText=t.time.relative}function f(e,t){(0,d.aI)(e,".vn").innerText=t.name}function v(e,t){switch(t.type){case"route":e.onclick=function(){(0,m.SR)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,p.so)(t.hash)};break;case"bus":e.onclick=function(){(0,c.$l)(t.id)};break;case"empty":e.onclick=null}}function h(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function b(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}if(null==i)r(e,a),s(e,a),u(e,a),f(e,a),v(e,a),h(e,n),b(e,t);else if(a.type!==i.type)r(e,a),s(e,a),u(e,a),f(e,a),v(e,a),h(e,n),b(e,t);else{switch(a.type){case"location":(0,o.hw)(i.name,a.name)||f(e,a),i.time!==a.time&&u(e,a),(0,o.hw)(i.hash,a.hash)||v(e,a);break;case"route":(0,o.hw)(i.name,a.name)||f(e,a),i.time!==a.time&&u(e,a),(0,o.hw)(i.id,a.id)&&(0,o.hw)(i.pid,a.pid)||v(e,a);break;case"bus":(0,o.hw)(i.name,a.name)||f(e,a),i.time!==a.time&&u(e,a),(0,o.hw)(i.id,a.id)||v(e,a);break;case"empty":i.time!==a.time&&u(e,a)}n!==g&&h(e,n),t!==w&&b(e,t)}}var i=e.itemQuantity,r=(0,d.jg)(b,".qn").length;if(i!==r){var s=r-i;if(s<0){for(var u=new DocumentFragment,f=0,v=Math.abs(s);f<v;f++){var h=T();u.appendChild(h.element)}b.append(u)}else for(var k=(0,d.jg)(b,".qn"),x=0,I=Math.abs(s);x<I;x++){k[r-1-x].remove()}}for(var C=(0,d.jg)(b,".qn"),L=0;L<i;L++){var A=C[L],E=e.items[L];if(y.hasOwnProperty("items"))if(y.items[L])a(A,E,y.items[L]);else a(A,E,null);else a(A,E,null)}y=e,g=n,w=t}function P(){for(var e=(0,s.Js)("playing_animation"),t=(0,u.gO)("window"),n=Math.floor(t.height/70/3)+2,a=[],i=0;i<n;i++)a.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_({items:a,itemQuantity:a.length,dataUpdateTime:0},!0,e)}function j(){return D.apply(this,arguments)}function D(){return(D=(0,a.A)(function*(){var e=(0,s.Js)("playing_animation"),t=(0,s.Js)("refresh_interval");I=t.dynamic,k=t.baseInterval,E=(0,o.zx)();var n=yield(0,r.$i)(E);_(n,!1,e);var a=0;I&&(a=yield(0,i.wz)()),L=(new Date).getTime(),A=I?Math.max(L+x,n.dataUpdateTime+k/a):L+k,Math.max(x,A-L)})).apply(this,arguments)}function S(){return z.apply(this,arguments)}function z(){return(z=(0,a.A)(function*(){j().then(function(){C?setTimeout(function(){S()},Math.max(x,A-(new Date).getTime())):M=!1}).catch(function(e){C?setTimeout(function(){S()},1e4):M=!1})})).apply(this,arguments)}function $(){P(),C||(C=!0,M?j():(M=!0,S()))}}}]);
//# sourceMappingURL=6823.c827c6149e960ce96aa6.js.map