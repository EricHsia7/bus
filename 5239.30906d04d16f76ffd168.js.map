{"version":3,"file":"5239.30906d04d16f76ffd168.js","mappings":"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","sources":["webpack://bus/./src/interface/location/details/index.ts","webpack://bus/./src/interface/notification-schedule-manager/index.ts","webpack://bus/./src/interface/location/index.ts","webpack://bus/./src/interface/personal-schedule-editor/index.ts","webpack://bus/./src/interface/qrcode/index.ts"],"sourcesContent":["import { getLocation, MergedLocation, MergedLocationItem } from '../../../data/apis/getLocation/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../../../data/apis/loader';\nimport { IntegratedLocationDetails, IntegratedLocationDetailsAction, integrateLocationDetails } from '../../../data/location/details';\nimport { getSettingOptionValue } from '../../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { booleanToString, generateIdentifier } from '../../../tools/index';\nimport { getPermalink } from '../../../tools/permalink';\nimport { getBlankIconElement, setIcon } from '../../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../../index';\nimport { promptMessage } from '../../prompt/index';\nimport { openQRCode } from '../../qrcode/index';\n\nlet previousIntegration = {} as IntegratedLocationDetails;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nconst LocationDetailsField = document.querySelector('.css_location_details_field');\nconst LocationDetailsBodyElement = elementQuerySelector(LocationDetailsField, '.css_location_details_body');\nconst LocationDetailsActionsElement = elementQuerySelector(LocationDetailsBodyElement, '.css_location_details_actions');\n\nfunction generateElementOfItem(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_details_action');\n\n  // Icon\n  const icon = document.createElement('div');\n  icon.classList.add('css_location_details_action_icon');\n  icon.appendChild(getBlankIconElement());\n  element.appendChild(icon);\n\n  // Name\n  const name = document.createElement('div');\n  name.classList.add('css_location_details_action_name');\n  element.appendChild(name);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction updateLocationDetailsField(integration: IntegratedLocationDetails, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction, previousItem: IntegratedLocationDetailsAction | null): void {\n    function updateIcon(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_action_icon');\n      setIcon(thisIconElement, thisItem.icon);\n    }\n\n    function updateName(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      const nameElement = elementQuerySelector(thisElement, '.css_location_details_action_name');\n      nameElement.innerText = thisItem.name;\n    }\n\n    function updateOnclick(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      thisElement.onclick = thisItem.action;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateIcon(thisElement, thisItem);\n      updateName(thisElement, thisItem);\n      updateOnclick(thisElement, thisItem);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (previousItem.key !== thisItem.key) {\n        updateIcon(thisElement, thisItem);\n        updateName(thisElement, thisItem);\n        updateOnclick(thisElement, thisItem);\n      }\n\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const actions = integration.actions;\n  const actionsQuantity = integration.actionsQuantity;\n\n  const currentActionsCapacity = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action').length;\n  if (actionsQuantity !== currentActionsCapacity) {\n    const difference = currentActionsCapacity - actionsQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newItemElement = generateElementOfItem();\n        fragment.appendChild(newItemElement.element);\n      }\n      LocationDetailsActionsElement.append(fragment);\n    } else {\n      const LocationActionElements = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const itemIndex = currentActionsCapacity - 1 - o;\n        LocationActionElements[itemIndex].remove();\n      }\n    }\n  }\n\n  const LocationActionElements = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action');\n\n  for (let i = 0; i < actionsQuantity; i++) {\n    const thisElement = LocationActionElements[i];\n    const thisItem = actions[i];\n    if (previousIntegration.hasOwnProperty('actions')) {\n      if (previousIntegration.actions[i]) {\n        const previousItem = previousIntegration.actions[i];\n        updateItem(thisElement, thisItem, previousItem);\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    } else {\n      updateItem(thisElement, thisItem, null);\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nfunction setUpLocationDetailsFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const actions: IntegratedLocationDetailsAction[] = [];\n  /*\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  */\n  const defaultActionsQuantity = 3;\n  for (let i = 0; i < defaultActionsQuantity; i++) {\n    actions.push({\n      name: '',\n      icon: '',\n      key: `action-${i}`,\n      action: function () {}\n    });\n  }\n\n  updateLocationDetailsField(\n    {\n      actions: actions,\n      actionsQuantity: defaultActionsQuantity,\n      hash: ''\n    },\n    true,\n    playing_animation\n  );\n}\n\nasync function initializeLocationDetailsField(hash: string) {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const requestID = generateIdentifier();\n  const integration = await integrateLocationDetails(hash, requestID);\n  updateLocationDetailsField(integration, false, playing_animation);\n}\n\nexport function openLocationDetails(hash: string): void {\n  pushPageHistory('LocationDetails');\n  LocationDetailsField.setAttribute('displayed', 'true');\n  setUpLocationDetailsFieldSkeletonScreen();\n  initializeLocationDetailsField(hash);\n}\n\nexport function closeLocationDetails(): void {\n  revokePageHistory('LocationDetails');\n  LocationDetailsField.setAttribute('displayed', 'false');\n}\n\nexport async function shareLocationPermalink(hash: string) {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  if (Location.hasOwnProperty(thisLocationKey)) {\n    const thisLocation = Location[thisLocationKey] as MergedLocationItem;\n    const link = getPermalink(1, {\n      hash: hash\n    });\n    if (navigator.share) {\n      navigator\n        .share({\n          title: thisLocation.n,\n          url: link\n        })\n        .then(() => {\n          promptMessage('check_circle', '已分享地點');\n        })\n        .catch((e) => {\n          promptMessage('cancel', '已取消分享');\n          console.error(e);\n        });\n    }\n  }\n}\n\nexport async function showLocationPermalinkQRCode(hash: string) {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  if (Location.hasOwnProperty(thisLocationKey)) {\n    const link = getPermalink(1, {\n      hash: hash\n    });\n    openQRCode(link);\n  }\n}\n","import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { cancelNotification } from '../../data/notification/apis/cancelNotification/index';\nimport { IntegratedNotificationScheduleItem, IntegratedNotificationSchedules, integrateNotifcationSchedules, NotificationSchedule } from '../../data/notification/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { booleanToString, compareThings, generateIdentifier } from '../../tools/index';\nimport { getIconElement } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, openPreviousPage, pushPageHistory, querySize } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst NotificationScheduleManagerField = document.querySelector('.css_notification_schedule_manager_field');\nconst NotificationScheduleManagerHeadElement = elementQuerySelector(NotificationScheduleManagerField, '.css_notification_schedule_manager_head');\nconst NotificationScheduleManagerUpdateTimerBoxElement = elementQuerySelector(NotificationScheduleManagerHeadElement, '.css_notification_schedule_manager_update_timer_box');\nconst NotificationScheduleManagerUpdateTimerElement = elementQuerySelector(NotificationScheduleManagerUpdateTimerBoxElement, '.css_notification_schedule_manager_update_timer');\nconst NotificationScheduleManagerBody = elementQuerySelector(NotificationScheduleManagerField, '.css_notification_schedule_manager_body');\nconst NotificationScheduleList = elementQuerySelector(NotificationScheduleManagerBody, '.css_notification_schedule_manager_notification_schedule_list');\n\nlet previousIntegration = {} as IntegratedNotificationSchedules;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet notifcationScheduleManagerRefreshTimer_retryInterval: number = 10 * 1000;\nlet notifcationScheduleManagerRefreshTimer_baseInterval: number = 15 * 1000;\nlet notifcationScheduleManagerRefreshTimer_minInterval: number = 5 * 1000;\nlet notifcationScheduleManagerRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet notifcationScheduleManagerRefreshTimer_dynamic: boolean = true;\nlet notifcationScheduleManagerRefreshTimer_lastUpdate: number = 0;\nlet notifcationScheduleManagerRefreshTimer_nextUpdate: number = 0;\nlet notifcationScheduleManagerRefreshTimer_currentRequestID: string = '';\nlet notifcationScheduleManagerRefreshTimer_refreshing: boolean = false;\nlet notifcationScheduleManagerRefreshTimer_streaming: boolean = false;\nlet notifcationScheduleManagerRefreshTimer_streamStarted: boolean = false;\n\nfunction animateUpdateTimer(): void {\n  NotificationScheduleManagerUpdateTimerElement.style.setProperty('--b-cssvar-notification-schedule-manager-update-timer-interval', `${notifcationScheduleManagerRefreshTimer_dynamicInterval}ms`);\n  NotificationScheduleManagerUpdateTimerElement.classList.add('css_notification_schedule_manager_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (notifcationScheduleManagerRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    NotificationScheduleManagerUpdateTimerElement.style.setProperty('--b-cssvar-notification-schedule-manager-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfItem(): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main item element\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_notification_schedule_manager_item');\n  itemElement.id = identifier;\n\n  // Hours element\n  const hoursElement = document.createElement('div');\n  hoursElement.classList.add('css_notification_schedule_manager_item_hours');\n  itemElement.appendChild(hoursElement);\n\n  // Notification schedule container\n  const notificationScheduleElement = document.createElement('div');\n  notificationScheduleElement.classList.add('css_notification_schedule_manager_item_notification_schedule');\n\n  // Minutes element\n  const minutesElement = document.createElement('div');\n  minutesElement.classList.add('css_notification_schedule_manager_item_notification_schedule_minutes');\n  notificationScheduleElement.appendChild(minutesElement);\n\n  // Context element\n  const contextElement = document.createElement('div');\n  contextElement.classList.add('css_notification_schedule_manager_item_notification_schedule_context');\n  notificationScheduleElement.appendChild(contextElement);\n\n  // Main element\n  const mainElement = document.createElement('div');\n  mainElement.classList.add('css_notification_schedule_manager_item_notification_schedule_main');\n  notificationScheduleElement.appendChild(mainElement);\n\n  // Cancel button element\n  const cancelElement = document.createElement('div');\n  cancelElement.classList.add('css_notification_schedule_manager_item_notification_schedule_cancel');\n  const iconElement = document.createElement('span');\n  iconElement.appendChild(getIconElement('close'));\n  cancelElement.appendChild(iconElement);\n\n  notificationScheduleElement.appendChild(cancelElement);\n\n  // Assemble\n  itemElement.appendChild(notificationScheduleElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction updateNotificationScheduleManagerField(integration: IntegratedNotificationSchedules, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem, previousItem: IntegratedNotificationScheduleItem | null): void {\n    function updateHours(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemHoursElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_hours');\n      thisItemHoursElement.innerText = thisItem.hours;\n    }\n\n    function updateMinutes(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemMinutesElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_minutes');\n      thisItemMinutesElement.innerText = thisItem.minutes;\n    }\n\n    function updateMain(thisItemElement: HTMLElementm, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemMainElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_main');\n      thisItemMainElement.innerText = thisItem.name;\n    }\n\n    function updateContext(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemContextElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_context');\n      thisItemContextElement.innerText = `${thisItem.route.name} - 往${thisItem.route.direction}`;\n    }\n\n    function updateCancel(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemCancelElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_cancel');\n      thisItemCancelElement.onclick = function () {\n        cancelNotificationOnNotificationScheduleManager(thisItemElement.id, thisItem.schedule_id);\n      };\n    }\n\n    function updateFirst(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      thisItemElement.setAttribute('first', booleanToString(thisItem.is_first));\n    }\n\n    function updateAnimation(thisItemElement: HTMLElement, animation: boolean): void {\n      thisItemElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisItemElement: HTMLElement, skeletonScreen: boolean): void {\n      thisItemElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateHours(thisItemElement, thisItem);\n      updateMinutes(thisItemElement, thisItem);\n      updateMain(thisItemElement, thisItem);\n      updateContext(thisItemElement, thisItem);\n      updateCancel(thisItemElement, thisItem);\n      updateFirst(thisItemElement, thisItem);\n      updateAnimation(thisItemElement, animation);\n      updateSkeletonScreen(thisItemElement, skeletonScreen);\n    } else {\n      if (thisItem.hours !== previousItem.hours) {\n        updateHours(thisItemElement, thisItem);\n      }\n      if (thisItem.minutes !== previousItem.minutes) {\n        updateMinutes(thisItemElement, thisItem);\n      }\n      if (!compareThings(previousItem.schedule_id, thisItem.schedule_id)) {\n        updateMain(thisItemElement, thisItem);\n        updateContext(thisItemElement, thisItem);\n        updateCancel(thisItemElement, thisItem);\n      }\n      if (previousItem.is_first !== thisItem.is_first) {\n        updateFirst(thisItemElement, thisItem);\n      }\n      if (previousAnimation !== animation) {\n        updateAnimation(thisItemElement, animation);\n      }\n      if (previousSkeletonScreen !== skeletonScreen) {\n        updateSkeletonScreen(thisItemElement, skeletonScreen);\n      }\n    }\n  }\n\n  const itemQuantity = integration.itemQuantity;\n  const items = integration.items;\n\n  const currentItemCapacity = elementQuerySelectorAll(NotificationScheduleList, '.css_notification_schedule_manager_item').length;\n  if (itemQuantity !== currentItemCapacity) {\n    const difference = currentItemCapacity - itemQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newItemElement = generateElementOfItem();\n        fragment.appendChild(newItemElement.element);\n      }\n      NotificationScheduleList.append(fragment);\n    } else {\n      const NotificationScheduleItemElements = elementQuerySelectorAll(NotificationScheduleList, '.css_notification_schedule_manager_item');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const itemIndex = currentItemCapacity - 1 - o;\n        NotificationScheduleItemElements[itemIndex].remove();\n      }\n    }\n  }\n\n  const NotificationScheduleItemElements = elementQuerySelectorAll(NotificationScheduleList, '.css_notification_schedule_manager_item');\n  for (let j = 0; j < itemQuantity; j++) {\n    const thisItemElement = NotificationScheduleItemElements[j];\n    const thisItem = items[j];\n    if (previousIntegration.hasOwnProperty('items')) {\n      if (previousIntegration.items[j]) {\n        const previousItem = previousIntegration.items[j];\n        updateItem(thisItemElement, thisItem, previousItem);\n      } else {\n        updateItem(thisItemElement, thisItem, null);\n      }\n    } else {\n      updateItem(thisItemElement, thisItem, null);\n    }\n  }\n\n  previousIntegration = integration;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nfunction setUpNotificationScheduleManagerFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const defaultItemQuantity: IntegratedNotificationSchedules['itemQuantity'] = Math.floor(FieldHeight / 50) + 5;\n  let items: IntegratedNotificationSchedules['items'] = [];\n  for (let i = 0; i < defaultItemQuantity; i++) {\n    items.push({\n      name: '',\n      stop_id: 0,\n      estimate_time: 0,\n      schedule_id: 'null',\n      scheduled_time: 0,\n      route: {\n        name: '',\n        direction: '',\n        id: 0,\n        pathAttributeId: []\n      },\n      is_first: true,\n      date: '',\n      hours: '',\n      minutes: ''\n    });\n  }\n  updateNotificationScheduleManagerField(\n    {\n      items: items,\n      itemQuantity: defaultItemQuantity,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nasync function refreshNotificationScheduleManager() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  notifcationScheduleManagerRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  notifcationScheduleManagerRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  notifcationScheduleManagerRefreshTimer_refreshing = true;\n  notifcationScheduleManagerRefreshTimer_currentRequestID = generateIdentifier();\n  NotificationScheduleManagerUpdateTimerElement.setAttribute('refreshing', 'true');\n  NotificationScheduleManagerUpdateTimerElement.classList.remove('css_notification_schedule_manager_update_timer_slide_rtl');\n  document.addEventListener(notifcationScheduleManagerRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateNotifcationSchedules(notifcationScheduleManagerRefreshTimer_currentRequestID);\n  updateNotificationScheduleManagerField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (notifcationScheduleManagerRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  notifcationScheduleManagerRefreshTimer_lastUpdate = new Date().getTime();\n  if (notifcationScheduleManagerRefreshTimer_dynamic) {\n    notifcationScheduleManagerRefreshTimer_nextUpdate = Math.max(notifcationScheduleManagerRefreshTimer_lastUpdate + notifcationScheduleManagerRefreshTimer_minInterval, integration.dataUpdateTime + notifcationScheduleManagerRefreshTimer_baseInterval / updateRate);\n  } else {\n    notifcationScheduleManagerRefreshTimer_nextUpdate = notifcationScheduleManagerRefreshTimer_lastUpdate + notifcationScheduleManagerRefreshTimer_baseInterval;\n  }\n  notifcationScheduleManagerRefreshTimer_dynamicInterval = Math.max(notifcationScheduleManagerRefreshTimer_minInterval, notifcationScheduleManagerRefreshTimer_nextUpdate - notifcationScheduleManagerRefreshTimer_lastUpdate);\n  notifcationScheduleManagerRefreshTimer_refreshing = false;\n  NotificationScheduleManagerUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nasync function streamNotificationScheduleManager() {\n  refreshNotificationScheduleManager()\n    .then(function () {\n      if (notifcationScheduleManagerRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamNotificationScheduleManager();\n          },\n          Math.max(notifcationScheduleManagerRefreshTimer_minInterval, notifcationScheduleManagerRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        notifcationScheduleManagerRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (notifcationScheduleManagerRefreshTimer_streaming) {\n        setTimeout(function () {\n          streamNotificationScheduleManager();\n        }, notifcationScheduleManagerRefreshTimer_retryInterval);\n      } else {\n        notifcationScheduleManagerRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openNotificationScheduleManager(): void {\n  pushPageHistory('NotificationScheduleManager');\n  NotificationScheduleManagerField.setAttribute('displayed', 'true');\n  setUpNotificationScheduleManagerFieldSkeletonScreen();\n  if (!notifcationScheduleManagerRefreshTimer_streaming) {\n    notifcationScheduleManagerRefreshTimer_streaming = true;\n    if (!notifcationScheduleManagerRefreshTimer_streamStarted) {\n      notifcationScheduleManagerRefreshTimer_streamStarted = true;\n      streamNotificationScheduleManager();\n    } else {\n      refreshNotificationScheduleManager();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeNotificationScheduleManager(): void {\n  // revokePageHistory('NotificationScheduleManager');\n  NotificationScheduleManagerField.setAttribute('displayed', 'false');\n  notifcationScheduleManagerRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport async function cancelNotificationOnNotificationScheduleManager(identifier: string, schedule_id: NotificationSchedule['schedule_id']) {\n  promptMessage('manufacturing', '處理中');\n  const cancellation = await cancelNotification(schedule_id);\n  if (cancellation) {\n    const itemElement = elementQuerySelector(NotificationScheduleList, `.css_notification_schedule_manager_item#${identifier}`);\n    itemElement.remove();\n    promptMessage('check_circle', '已取消通知');\n    if (!notifcationScheduleManagerRefreshTimer_refreshing) {\n      const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n      const integration = await integrateNotifcationSchedules(notifcationScheduleManagerRefreshTimer_currentRequestID);\n      updateNotificationScheduleManagerField(integration, false, playing_animation);\n    }\n  } else {\n    promptMessage('error', '取消失敗');\n  }\n}\n","import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { isFolderContentSaved } from '../../data/folder/index';\nimport { IntegratedLocation, IntegratedLocationItem, integrateLocation, LocationGroupProperty } from '../../data/location/index';\nimport { stopHasNotifcationSchedules } from '../../data/notification/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll, getElementsBelow } from '../../tools/elements';\nimport { getTextWidth } from '../../tools/graphic';\nimport { booleanToString, compareThings, generateIdentifier } from '../../tools/index';\nimport { indexToDay, timeObjectToString } from '../../tools/time';\nimport { getBlankIconElement, getIconElement, getIconHTML, setIcon } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, GroupStyles, openPreviousPage, pushPageHistory, querySize } from '../index';\nimport { promptMessage } from '../prompt/index';\nimport { openSaveToFolder } from '../save-to-folder/index';\nimport { openScheduleNotification } from '../schedule-notification/index';\nimport { openLocationDetails } from './details/index';\n\nconst LocationField = document.querySelector('.css_location_field');\nconst LocationHeadElement = elementQuerySelector(LocationField, '.css_location_head');\nconst LocationNameElement = elementQuerySelector(LocationHeadElement, '.css_location_name');\nconst LocationNameSpanElement = elementQuerySelector(LocationNameElement, 'span');\nconst LocationButtonRightElement = elementQuerySelector(LocationHeadElement, '.css_location_button_right');\nconst LocationGroupsElement = elementQuerySelector(LocationField, '.css_location_groups');\nconst LocationGroupTabsElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tabs');\nconst LocationGroupTabsTrayElement = elementQuerySelector(LocationGroupTabsElement, '.css_location_group_tabs_tray');\nconst LocationGroupTabLineTrackElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tab_line_track');\nconst LocationGroupTabLineElement = elementQuerySelector(LocationGroupTabLineTrackElement, '.css_location_group_tab_line');\nconst LocationUpdateTimerElement = elementQuerySelector(LocationHeadElement, '.css_location_update_timer_box .css_location_update_timer');\n\nlet previousIntegration = {} as IntegratedLocation;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet locationSliding_initialIndex: number = 0;\nlet locationSliding_targetIndex: number = 0;\nlet locationSliding_groupQuantity: number = 0;\nlet locationSliding_groupStyles: GroupStyles = {};\nlet locationSliding_fieldWidth: number = 0;\nlet locationSliding_fieldHeight: number = 0;\nlet locationSliding_sliding: boolean = false;\n\nlet locationRefreshTimer_retryInterval: number = 10 * 1000;\nlet locationRefreshTimer_baseInterval: number = 15 * 1000;\nlet locationRefreshTimer_minInterval: number = 5 * 1000;\nlet locationRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet locationRefreshTimer_dynamic: boolean = true;\nlet locationRefreshTimer_lastUpdate: number = 0;\nlet locationRefreshTimer_nextUpdate: number = 0;\nlet locationRefreshTimer_currentRequestID: string = '';\nlet locationRefreshTimer_refreshing: boolean = false;\nlet locationRefreshTimer_streaming: boolean = false;\nlet locationRefreshTimer_streamStarted: boolean = false;\n\nlet currentHashSet_hash: string = '';\n\nlet tabPadding: number = 20;\n\nexport function initializeLocationSliding(): void {\n  LocationGroupsElement.addEventListener(\n    'touchstart',\n    function () {\n      locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / locationSliding_fieldWidth);\n    },\n    { passive: true }\n  );\n\n  LocationGroupsElement.addEventListener(\n    'scroll',\n    function (event: Event) {\n      locationSliding_sliding = true;\n      const target = event.target as HTMLElement;\n      const currentIndex = target.scrollLeft / locationSliding_fieldWidth;\n      if (currentIndex > locationSliding_initialIndex) {\n        locationSliding_targetIndex = locationSliding_initialIndex + 1;\n      } else {\n        locationSliding_targetIndex = locationSliding_initialIndex - 1;\n      }\n      const indexDifference = currentIndex - locationSliding_initialIndex;\n      let delta = Math.abs(indexDifference);\n      if (delta > 1) {\n        if (indexDifference > 0) {\n          locationSliding_initialIndex = Math.floor(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex + 1;\n        } else {\n          locationSliding_initialIndex = Math.ceil(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex - 1;\n        }\n        delta = Math.abs(currentIndex - locationSliding_initialIndex);\n      }\n      const initialSize = locationSliding_groupStyles[`g_${locationSliding_initialIndex}`] || { width: 0, offset: 0 };\n      const targetSize = locationSliding_groupStyles[`g_${locationSliding_targetIndex}`] || { width: 0, offset: 0 };\n      const tabWidth = initialSize.width + (targetSize.width - initialSize.width) * delta;\n      const offset = (initialSize.offset + (targetSize.offset - initialSize.offset) * delta) * -1 + locationSliding_fieldWidth * 0.5 - tabWidth * 0.5;\n      updateLocationCSS(locationSliding_groupQuantity, offset, tabWidth - tabPadding, currentIndex);\n      if (currentIndex === locationSliding_targetIndex) {\n        locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / locationSliding_fieldWidth);\n        locationSliding_sliding = false;\n      }\n    },\n    { passive: true }\n  );\n}\n\nexport function updateLocationCSS(groupQuantity: number, offset: number, tabLineWidth: number, percentage: number): void {\n  LocationGroupsElement.style.setProperty('--b-cssvar-location-group-quantity', groupQuantity.toString());\n  LocationGroupTabLineElement.style.setProperty('--b-cssvar-location-tab-line-width-scale', tabLineWidth.toString());\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-tabs-tray-offset', `${offset.toString()}px`);\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-percentage', percentage.toString());\n}\n\nfunction animateUpdateTimer(): void {\n  LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-interval', `${locationRefreshTimer_dynamicInterval}ms`);\n  LocationUpdateTimerElement.classList.add('css_location_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (locationRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfItem(): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main container\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_location_group_item');\n  itemElement.id = identifier;\n  itemElement.setAttribute('stretched', 'false');\n  itemElement.setAttribute('stretching', 'false');\n  itemElement.setAttribute('push-direction', '0');\n  itemElement.setAttribute('push-state', '0');\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_location_group_item_head');\n\n  // Rank\n  const rankElement = document.createElement('div');\n  rankElement.classList.add('css_location_group_item_rank');\n  const rankNextSlideElement = document.createElement('div');\n  rankNextSlideElement.classList.add('css_location_group_item_rank_next_slide');\n  rankNextSlideElement.setAttribute('code', '-1');\n  rankNextSlideElement.setAttribute('displayed', 'false');\n  const rankCurrentSlideElement = document.createElement('div');\n  rankCurrentSlideElement.classList.add('css_location_group_item_rank_current_slide');\n  rankCurrentSlideElement.setAttribute('code', '-1');\n  rankCurrentSlideElement.setAttribute('displayed', 'true');\n  rankElement.appendChild(rankNextSlideElement);\n  rankElement.appendChild(rankCurrentSlideElement);\n\n  // Route direction\n  const routeDirectionElement = document.createElement('div');\n  routeDirectionElement.classList.add('css_location_group_item_route_direction');\n\n  // Route name\n  const routeNameElement = document.createElement('div');\n  routeNameElement.classList.add('css_location_group_item_route_name');\n\n  // Capsule\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_location_group_item_capsule');\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_location_group_item_status');\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n  statusElement.appendChild(nextSlideElement);\n  statusElement.appendChild(currentSlideElement);\n\n  // Stretch button\n  const stretchElement = document.createElement('div');\n  stretchElement.classList.add('css_location_group_item_stretch');\n  stretchElement.appendChild(getIconElement('keyboard_arrow_down'));\n  stretchElement.onclick = () => {\n    stretchLocationItem(identifier);\n  };\n\n  // Capsule separator\n  const capsuleSeparatorElement = document.createElement('div');\n  capsuleSeparatorElement.classList.add('css_location_group_item_capsule_separator');\n\n  // Assemble capsule\n  capsuleElement.appendChild(statusElement);\n  capsuleElement.appendChild(stretchElement);\n  capsuleElement.appendChild(capsuleSeparatorElement);\n\n  // Assemble head\n  headElement.appendChild(rankElement);\n  headElement.appendChild(routeDirectionElement);\n  headElement.appendChild(routeNameElement);\n  headElement.appendChild(capsuleElement);\n\n  // Body\n  const bodyElement = document.createElement('div');\n  bodyElement.classList.add('css_location_group_item_body');\n  bodyElement.setAttribute('displayed', 'false');\n\n  // Buttons\n  const buttonsElement = document.createElement('div');\n  buttonsElement.classList.add('css_location_group_item_buttons');\n\n  // Tab: 公車\n  const busTabButtonElement = document.createElement('div');\n  busTabButtonElement.classList.add('css_location_group_item_button');\n  busTabButtonElement.setAttribute('highlighted', 'true');\n  busTabButtonElement.setAttribute('type', 'tab');\n  busTabButtonElement.setAttribute('code', '0');\n  const busTabIconElement = document.createElement('div');\n  busTabIconElement.classList.add('css_location_group_item_button_icon');\n  busTabIconElement.appendChild(getIconElement('directions_bus'));\n  busTabButtonElement.appendChild(busTabIconElement);\n  busTabButtonElement.appendChild(document.createTextNode('公車'));\n  busTabButtonElement.onclick = () => {\n    switchLocationBodyTab(identifier, 0);\n  };\n\n  // Tab: 抵達時間\n  const arrivalTabButtonElement = document.createElement('div');\n  arrivalTabButtonElement.classList.add('css_location_group_item_button');\n  arrivalTabButtonElement.setAttribute('highlighted', 'false');\n  arrivalTabButtonElement.setAttribute('type', 'tab');\n  arrivalTabButtonElement.setAttribute('code', '1');\n  const arrivalTabIconElement = document.createElement('div');\n  arrivalTabIconElement.classList.add('css_location_group_item_button_icon');\n  arrivalTabIconElement.appendChild(getIconElement('departure_board'));\n  arrivalTabButtonElement.appendChild(arrivalTabIconElement);\n  arrivalTabButtonElement.appendChild(document.createTextNode('抵達時間'));\n  arrivalTabButtonElement.onclick = () => {\n    switchLocationBodyTab(identifier, 1);\n  };\n\n  // Button: 儲存\n  const saveButtonElement = document.createElement('div');\n  saveButtonElement.classList.add('css_location_group_item_button');\n  saveButtonElement.setAttribute('highlighted', 'false');\n  saveButtonElement.setAttribute('type', 'save-to-folder');\n  const saveButtonIconElement = document.createElement('div');\n  saveButtonIconElement.classList.add('css_location_group_item_button_icon');\n  saveButtonIconElement.appendChild(getIconElement('folder'));\n  saveButtonElement.appendChild(saveButtonIconElement);\n  saveButtonElement.appendChild(document.createTextNode('儲存'));\n  /*\n  saveButtonElement.onclick = () => {\n    openSaveToFolder('stop-on-location', [identifier, null, null]);\n  };\n  */\n\n  // Button: 通知\n  const notifyButtonElement = document.createElement('div');\n  notifyButtonElement.classList.add('css_location_group_item_button');\n  notifyButtonElement.setAttribute('highlighted', 'false');\n  notifyButtonElement.setAttribute('type', 'schedule-notification');\n  notifyButtonElement.setAttribute('enabled', 'true');\n  const notifyButtonIconElement = document.createElement('div');\n  notifyButtonIconElement.classList.add('css_location_group_item_button_icon');\n  notifyButtonIconElement.appendChild(getIconElement('notifications'));\n  notifyButtonElement.appendChild(notifyButtonIconElement);\n  notifyButtonElement.appendChild(document.createTextNode('通知'));\n  /*\n  notifyButtonElement.onclick = () => {\n    openScheduleNotification('stop-on-location', [identifier, null, null, null]);\n  };\n  */\n\n  // Assemble buttons\n  buttonsElement.appendChild(busTabButtonElement);\n  buttonsElement.appendChild(arrivalTabButtonElement);\n  buttonsElement.appendChild(saveButtonElement);\n  buttonsElement.appendChild(notifyButtonElement);\n\n  // Buses\n  const busesElement = document.createElement('div');\n  busesElement.classList.add('css_location_group_item_buses');\n  busesElement.setAttribute('displayed', 'true');\n\n  // Bus arrival times\n  const busArrivalTimesElement = document.createElement('div');\n  busArrivalTimesElement.classList.add('css_location_group_item_bus_arrival_times');\n  busArrivalTimesElement.setAttribute('displayed', 'false');\n\n  // Assemble body\n  bodyElement.appendChild(buttonsElement);\n  bodyElement.appendChild(busesElement);\n  bodyElement.appendChild(busArrivalTimesElement);\n\n  // Assemble item\n  itemElement.appendChild(headElement);\n  itemElement.appendChild(bodyElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction generateElementOfGroup(): GeneratedElement {\n  // Main container\n  const groupElement = document.createElement('div');\n  groupElement.classList.add('css_location_group');\n\n  // Details\n  const detailsElement = document.createElement('div');\n  detailsElement.classList.add('css_location_group_details');\n\n  // Details body\n  const detailsBodyElement = document.createElement('div');\n  detailsBodyElement.classList.add('css_location_group_details_body');\n  detailsElement.appendChild(detailsBodyElement);\n\n  // Items\n  const itemsElement = document.createElement('div');\n  itemsElement.classList.add('css_location_group_items');\n\n  // Assemble group\n  groupElement.appendChild(detailsElement);\n  groupElement.appendChild(itemsElement);\n\n  return {\n    element: groupElement,\n    id: ''\n  };\n}\n\nfunction generateElementOfTab(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_group_tab');\n\n  const span = document.createElement('span');\n  element.appendChild(span);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction generateElementOfGroupDetailsProperty(): GeneratedElement {\n  // Main container\n  const propertyElement = document.createElement('div');\n  propertyElement.classList.add('css_location_group_details_property');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_location_details_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  // Value\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_location_details_property_value');\n\n  // Assemble\n  propertyElement.appendChild(iconElement);\n  propertyElement.appendChild(valueElement);\n\n  return {\n    element: propertyElement,\n    id: ''\n  };\n}\n\nfunction setUpLocationFieldSkeletonScreen(hash: IntegratedLocation['hash']): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const defaultItemQuantity: IntegratedLocation['itemQuantity'] = { g_0: Math.floor(FieldHeight / 50) + 5, g_1: Math.floor(FieldHeight / 50) + 5 };\n  const defaultGroupQuantity = 2;\n  let groupedItems: IntegratedLocation['groupedItems'] = {};\n  for (let i = 0; i < defaultGroupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    groupedItems[groupKey] = [];\n    for (let j = 0; j < defaultItemQuantity[groupKey]; j++) {\n      groupedItems[groupKey].push({\n        route_name: '',\n        route_direction: '',\n        routeId: 0,\n        stopId: 0,\n        status: {\n          code: 8,\n          text: '',\n          time: -6\n        },\n        ranking: {\n          number: 0,\n          text: '--',\n          code: -1\n        },\n        buses: [],\n        busArrivalTimes: []\n      });\n    }\n  }\n  updateLocationField(\n    {\n      groupedItems: groupedItems,\n      groupQuantity: defaultGroupQuantity,\n      groups: {\n        g_0: {\n          name: '載入中',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        },\n        g_1: {\n          name: '載入中',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        }\n      },\n      itemQuantity: defaultItemQuantity,\n      LocationName: '載入中',\n      hash: hash,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateLocationField(integration: IntegratedLocation, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationItem, previousItem: IntegratedLocationItem | null): void {\n    function updateStatus(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisItemStatusElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_status');\n      const nextSlideElement = elementQuerySelector(thisItemStatusElement, '.css_next_slide');\n      const currentSlideElement = elementQuerySelector(thisItemStatusElement, '.css_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.status.code.toString());\n      nextSlideElement.innerText = thisItem.status.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n            currentSlideElement.innerText = thisItem.status.text;\n            currentSlideElement.classList.remove('css_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n        currentSlideElement.innerText = thisItem.status.text;\n      }\n    }\n\n    function updateRank(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRankElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_rank');\n      const nextSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_next_slide');\n      const currentSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n      nextSlideElement.innerText = thisItem.ranking.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n            currentSlideElement.innerText = thisItem.ranking.text;\n            currentSlideElement.classList.remove('css_location_group_item_rank_current_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_location_group_item_rank_current_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n        currentSlideElement.innerText = thisItem.ranking.text;\n      }\n    }\n\n    function updateRouteDirection(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteDirectionElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_direction');\n      thisRouteDirectionElement.innerText = thisItem.route_direction;\n    }\n\n    function updateRouteName(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteNameElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_name');\n      thisRouteNameElement.innerText = thisItem.route_name;\n    }\n\n    function updateBuses(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buses');\n      thisBusesElement.innerHTML = thisItem.buses.length === 0 ? '<div class=\"css_location_group_item_buses_message\">目前沒有公車可顯示</div>' : thisItem.buses.map((bus) => `<div class=\"css_location_group_item_bus\" on-this-route=\"${bus.onThisRoute}\"><div class=\"css_location_group_item_bus_title\"><div class=\"css_location_group_item_bus_icon\">${getIconHTML('directions_bus')}</div><div class=\"css_location_group_item_bus_car_number\">${bus.carNumber}</div></div><div class=\"css_location_group_item_bus_attributes\"><div class=\"css_location_group_item_bus_route\">路線：${bus.RouteName}</div><div class=\"css_location_group_item_bus_car_status\">狀態：${bus.status.text}</div><div class=\"css_location_group_item_bus_car_type\">類型：${bus.type}</div></div></div>`).join('');\n    }\n\n    function updateBusArrivalTimes(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusArrivalTimesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_bus_arrival_times');\n      thisBusArrivalTimesElement.innerHTML = thisItem.busArrivalTimes.length === 0 ? '<div class=\"css_location_group_item_bus_arrival_message\">目前沒有抵達時間可顯示</div>' : thisItem.busArrivalTimes.map((busArrivalTime) => `<div class=\"css_location_group_item_bus_arrival_time\"><div class=\"css_location_group_item_bus_arrival_time_title\"><div class=\"css_location_group_item_bus_arrival_time_icon\">${getIconHTML('calendar_view_day')}</div><div class=\"css_location_group_item_bus_arrival_time_personal_schedule_name\">${busArrivalTime.personalSchedule.name}</div><div class=\"css_location_group_item_bus_arrival_time_personal_schedule_time\">週${indexToDay(busArrivalTime.day).name} ${timeObjectToString(busArrivalTime.personalSchedule.period.start)} - ${timeObjectToString(busArrivalTime.personalSchedule.period.end)}</div></div><div class=\"css_location_group_item_bus_arrival_time_chart\">${busArrivalTime.chart}</div></div>`).join('');\n    }\n\n    function updateStretch(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      if (skeletonScreen) {\n        thisElement.setAttribute('stretched', 'false');\n      }\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    function updateSaveToFolderButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const saveToFolderButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"save-to-folder\"]');\n      saveToFolderButtonElement.onclick = function () {\n        openSaveToFolder('stop-on-location', [thisItemElement.id, thisItem.stopId, thisItem.routeId]);\n      };\n      isFolderContentSaved('stop', thisItem.stopId).then((e) => {\n        saveToFolderButtonElement.setAttribute('highlighted', booleanToString(e));\n      });\n    }\n\n    function updateScheduleNotificationButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const scheduleNotificationButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"schedule-notification\"]');\n      scheduleNotificationButtonElement.onclick = function () {\n        openScheduleNotification('stop-on-location', [thisItemElement.id, thisItem.stopId, thisItem.routeId, thisItem.status.time]);\n      };\n      const havingNotifcationSchedules = stopHasNotifcationSchedules(thisItem.stopId);\n      scheduleNotificationButtonElement.setAttribute('highlighted', booleanToString(havingNotifcationSchedules));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateStatus(thisElement, thisItem, animation);\n      updateRank(thisElement, thisItem, animation);\n      updateRouteDirection(thisElement, thisItem);\n      updateRouteName(thisElement, thisItem);\n      updateBuses(thisElement, thisItem);\n      updateBusArrivalTimes(thisElement, thisItem);\n      updateStretch(thisElement, skeletonScreen);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n      updateSaveToFolderButton(thisElement, thisItem);\n      updateScheduleNotificationButton(thisElement, thisItem);\n    } else {\n      if (thisItem.status.time !== previousItem.status.time) {\n        updateStatus(thisElement, thisItem, animation);\n        updateScheduleNotificationButton(thisElement, thisItem);\n      }\n      if (previousItem.ranking.number !== thisItem.ranking.number || previousItem.ranking.code !== thisItem.ranking.code) {\n        updateRank(thisElement, thisItem, animation);\n      }\n      if (previousItem.stopId !== thisItem.stopId) {\n        updateRouteDirection(thisElement, thisItem);\n        updateRouteName(thisElement, thisItem);\n        updateSaveToFolderButton(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.buses, thisItem.buses)) {\n        updateBuses(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.busArrivalTimes, thisItem.busArrivalTimes)) {\n        updateBusArrivalTimes(thisElement, thisItem);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateStretch(thisElement, skeletonScreen);\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  function updateProperty(thisElement: HTMLElement, thisProperty: LocationGroupProperty, previousProperty: LocationGroupProperty | null): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_property_icon');\n      setIcon(thisIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      elementQuerySelector(thisElement, '.css_location_details_property_value').innerHTML = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (!compareThings(previousProperty.icon, thisProperty.icon)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty.value, thisProperty.value)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n\n  const groupQuantity = integration.groupQuantity;\n  const itemQuantity = integration.itemQuantity;\n  const groupedItems = integration.groupedItems;\n  const groups = integration.groups;\n\n  locationSliding_groupQuantity = groupQuantity;\n  locationSliding_fieldWidth = FieldWidth;\n  locationSliding_fieldHeight = FieldHeight;\n\n  let cumulativeOffset = 0;\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const width = getTextWidth(groups[groupKey].name, 500, '17px', `\"Noto Sans TC\", sans-serif`) + tabPadding;\n    locationSliding_groupStyles[groupKey] = {\n      width: width,\n      offset: cumulativeOffset\n    };\n    cumulativeOffset += width;\n  }\n  locationSliding_groupStyles[`g_${groupQuantity}`] = {\n    width: 0,\n    offset: cumulativeOffset\n  };\n\n  if (!locationSliding_sliding) {\n    const initialGroupKey = `g_${locationSliding_initialIndex}`;\n    const initialGroupStyle = locationSliding_groupStyles[initialGroupKey];\n    const offset = initialGroupStyle.offset * -1 + locationSliding_fieldWidth * 0.5 - initialGroupStyle.width * 0.5;\n    const tabLineWidth = initialGroupStyle.width - tabPadding;\n    updateLocationCSS(locationSliding_groupQuantity, offset, tabLineWidth, locationSliding_initialIndex);\n  }\n\n  if (previousIntegration?.hash !== integration.hash) {\n    LocationButtonRightElement.onclick = function () {\n      openLocationDetails(integration.hash);\n    };\n  }\n\n  if (previousIntegration?.LocationName !== integration.LocationName) {\n    LocationNameSpanElement.innerText = integration.LocationName;\n  }\n\n  if (previousAnimation !== animation) {\n    LocationNameElement.setAttribute('animation', booleanToString(animation));\n    LocationGroupTabsElement.setAttribute('animation', booleanToString(animation));\n  }\n\n  if (previousSkeletonScreen !== skeletonScreen) {\n    LocationNameElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabsElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabLineTrackElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  // TODO: updateTab\n  const currentGroupCapacity = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group').length;\n  if (groupQuantity !== currentGroupCapacity) {\n    const difference = currentGroupCapacity - groupQuantity;\n    if (difference < 0) {\n      const groupsFragment = new DocumentFragment();\n      const tabsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newGroupElement = generateElementOfGroup();\n        groupsFragment.appendChild(newGroupElement.element);\n        const newTabElement = generateElementOfTab();\n        tabsFragment.appendChild(newTabElement.element);\n      }\n      LocationGroupsElement.append(groupsFragment);\n      LocationGroupTabsTrayElement.append(tabsFragment);\n    } else {\n      const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n      const LocationGroupTabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const groupIndex = currentGroupCapacity - 1 - o;\n        LocationGroupElements[groupIndex].remove();\n        LocationGroupTabElements[groupIndex].remove();\n      }\n    }\n  }\n\n  const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisLocationGroupElement = LocationGroupElements[i];\n    const currentItemCapacity = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item').length;\n    if (itemQuantity[groupKey] !== currentItemCapacity) {\n      const difference = currentItemCapacity - itemQuantity[groupKey];\n      if (difference < 0) {\n        const LocationGroupItemsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_items');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newItemElement = generateElementOfItem();\n          LocationGroupItemsElement.appendChild(newItemElement.element);\n        }\n      } else {\n        const LocationGroupItemElements = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          LocationGroupItemElements[itemIndex].remove();\n        }\n      }\n    }\n\n    const currentGroupPropertyCapacity = elementQuerySelectorAll(elementQuerySelectorAll(LocationGroupsElement, '.css_location_group')[i], '.css_location_group_details .css_location_group_details_body .css_location_group_details_property').length;\n    const groupPropertyQuantity = groups[groupKey].properties.length;\n    if (groupPropertyQuantity !== currentGroupPropertyCapacity) {\n      const difference = currentGroupPropertyCapacity - groupPropertyQuantity;\n      if (difference < 0) {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          // var propertyIndex = currentGroupPropertyCapacity + o;\n          const newPropertyElement = generateElementOfGroupDetailsProperty();\n          thisLocationGroupDetailsBodyElement.appendChild(newPropertyElement.element);\n        }\n      } else {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        const propertyElements = elementQuerySelectorAll(thisLocationGroupDetailsBodyElement, '.css_location_group_details_property');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const propertyIndex = currentGroupPropertyCapacity - 1 - o;\n          propertyElements[propertyIndex].remove();\n        }\n      }\n    }\n  }\n\n  const tabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n  const groupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisTabElement = tabElements[i];\n    const thisTabSpanElement = elementQuerySelector(thisTabElement, 'span');\n    thisTabSpanElement.innerText = groups[groupKey].name;\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-width', `${locationSliding_groupStyles[groupKey].width}px`);\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-index', i.toString());\n    const thisGroupElement = groupElements[i];\n    const propertyElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_details .css_location_group_details_body .css_location_group_details_property`);\n    const itemElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_items .css_location_group_item`);\n\n    const groupPropertyQuantity = groups[groupKey].properties.length; // TODO: propertyQuantity\n    for (let k = 0; k < groupPropertyQuantity; k++) {\n      const thisProperty = groups[groupKey].properties[k];\n      const thisElement = propertyElements[k];\n      if (previousIntegration.hasOwnProperty('groups')) {\n        if (previousIntegration.groups.hasOwnProperty(groupKey)) {\n          if (previousIntegration.groups[groupKey].properties[k]) {\n            const previousProperty = previousIntegration.groups[groupKey].properties[k];\n            updateProperty(thisElement, thisProperty, previousProperty);\n          } else {\n            updateProperty(thisElement, thisProperty, null);\n          }\n        } else {\n          updateProperty(thisElement, thisProperty, null);\n        }\n      } else {\n        updateProperty(thisElement, thisProperty, null);\n      }\n    }\n\n    for (let j = 0; j < itemQuantity[groupKey]; j++) {\n      const thisElement = itemElements[j];\n      const thisItem = groupedItems[groupKey][j];\n      if (previousIntegration.hasOwnProperty('groupedItems')) {\n        if (previousIntegration.groupedItems.hasOwnProperty(groupKey)) {\n          if (previousIntegration.groupedItems[groupKey][j]) {\n            const previousItem = previousIntegration.groupedItems[groupKey][j];\n            updateItem(thisElement, thisItem, previousItem);\n          } else {\n            updateItem(thisElement, thisItem, null);\n          }\n        } else {\n          updateItem(thisElement, thisItem, null);\n        }\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nasync function refreshLocation() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  const busArrivalTimeChartSize = querySize('location-bus-arrival-time-chart');\n  locationRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  locationRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  locationRefreshTimer_refreshing = true;\n  locationRefreshTimer_currentRequestID = generateIdentifier();\n  LocationUpdateTimerElement.setAttribute('refreshing', 'true');\n  LocationUpdateTimerElement.classList.remove('css_location_update_timer_slide_rtl');\n  document.addEventListener(locationRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateLocation(currentHashSet_hash, busArrivalTimeChartSize.width, busArrivalTimeChartSize.height, locationRefreshTimer_currentRequestID);\n  updateLocationField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (locationRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  locationRefreshTimer_lastUpdate = new Date().getTime();\n  if (locationRefreshTimer_dynamic) {\n    locationRefreshTimer_nextUpdate = Math.max(locationRefreshTimer_lastUpdate + locationRefreshTimer_minInterval, integration.dataUpdateTime + locationRefreshTimer_baseInterval / updateRate);\n  } else {\n    locationRefreshTimer_nextUpdate = locationRefreshTimer_lastUpdate + locationRefreshTimer_baseInterval;\n  }\n  locationRefreshTimer_dynamicInterval = Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - locationRefreshTimer_lastUpdate);\n  locationRefreshTimer_refreshing = false;\n  LocationUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nexport function streamLocation(): void {\n  refreshLocation()\n    .then(function () {\n      if (locationRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamLocation();\n          },\n          Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (locationRefreshTimer_streaming) {\n        promptMessage('error', `地點網路連線中斷，將在${locationRefreshTimer_retryInterval / 1000}秒後重試。`);\n        setTimeout(function () {\n          streamLocation();\n        }, locationRefreshTimer_retryInterval);\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openLocation(hash: IntegratedLocation['hash']): void {\n  pushPageHistory('Location');\n  logRecentView('location', hash);\n  currentHashSet_hash = hash;\n  locationSliding_initialIndex = 0;\n  locationSliding_groupStyles = {};\n  LocationField.setAttribute('displayed', 'true');\n  LocationGroupsElement.scrollLeft = 0;\n  LocationGroupsElement.focus();\n  setUpLocationFieldSkeletonScreen(hash);\n  if (!locationRefreshTimer_streaming) {\n    locationRefreshTimer_streaming = true;\n    if (!locationRefreshTimer_streamStarted) {\n      locationRefreshTimer_streamStarted = true;\n      streamLocation();\n    } else {\n      refreshLocation();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeLocation(): void {\n  // revokePageHistory('Location');\n  LocationField.setAttribute('displayed', 'false');\n  locationRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport function stretchLocationItem(itemElementID: string): void {\n  const itemElement = elementQuerySelector(LocationGroupsElement, `.css_location_group .css_location_group_items .css_location_group_item#${itemElementID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n\n  const itemsElement = itemElement.parentElement as HTMLElement;\n\n  const elementsBelowItemElement = getElementsBelow(itemElement, 'css_location_group_item');\n  const elementsBelowLength = elementsBelowItemElement.length;\n\n  const itemsElementRect = itemsElement.getBoundingClientRect();\n  const itemElementRect = itemElement.getBoundingClientRect();\n\n  // const itemElementX = itemElementRect.left - itemsElementRect.left;\n  const itemElementY = itemElementRect.top - itemsElementRect.top;\n\n  const stretched = itemElement.getAttribute('stretched') === 'true' ? true : false;\n  const animation = itemElement.getAttribute('animation') === 'true' ? true : false;\n\n  if (animation) {\n    const pushDirection = stretched ? '2' : '1';\n\n    // Separate the elements from the document flow while keeping its position\n    itemElement.setAttribute('stretching', 'true');\n    // itemElement.style.setProperty('--b-cssvar-css-location-group-item-x', `${itemElementX}px`);\n    itemElement.style.setProperty('--b-cssvar-css-location-group-item-y', `${itemElementY}px`);\n\n    // Set push direction and push state\n    for (let i = 0; i < elementsBelowLength; i++) {\n      const thisItemElement = elementsBelowItemElement[i];\n      thisItemElement.setAttribute('push-direction', pushDirection);\n      thisItemElement.setAttribute('push-state', '1');\n    }\n\n    itemElement.addEventListener(\n      'transitionend',\n      function () {\n        // Reset the push direction and push state\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-direction', '0');\n          thisItemElement.setAttribute('push-state', '0');\n        }\n        // Deposit the element\n        itemElement.setAttribute('stretching', 'false');\n      },\n      { once: true }\n    );\n\n    itemElement.addEventListener(\n      'transitionstart',\n      function () {\n        // Transition the elements below\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-state', '2');\n        }\n      },\n      { once: true }\n    );\n  }\n\n  if (stretched) {\n    if (animation) {\n      itemBodyElement.addEventListener(\n        'transitionend',\n        function () {\n          itemBodyElement.setAttribute('displayed', 'false');\n        },\n        { once: true }\n      );\n    } else {\n      itemBodyElement.setAttribute('displayed', 'false');\n    }\n    itemElement.setAttribute('stretched', 'false');\n  } else {\n    itemBodyElement.setAttribute('displayed', 'true');\n    itemElement.setAttribute('stretched', 'true');\n  }\n}\n\nexport function switchLocationBodyTab(itemID: string, tabCode: number): void {\n  const itemElement = elementQuerySelector(LocationGroupsElement, `.css_location_group .css_location_group_items .css_location_group_item#${itemID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n  const buttonsElement = elementQuerySelector(itemBodyElement, '.css_location_group_item_buttons');\n  const buttonElements = elementQuerySelectorAll(buttonsElement, '.css_location_group_item_button[highlighted=\"true\"][type=\"tab\"]');\n  for (const t of buttonElements) {\n    t.setAttribute('highlighted', 'false');\n  }\n  elementQuerySelector(buttonsElement, `.css_location_group_item_button[code=\"${tabCode}\"]`).setAttribute('highlighted', 'true');\n  switch (tabCode) {\n    case 0:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      break;\n    case 1:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'true');\n      break;\n    default:\n      break;\n  }\n}\n","import { getPersonalSchedule, updatePersonalSchedule } from '../../data/personal-schedule/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { timeObjectToString, WeekDayIndex } from '../../tools/time';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\n\nconst PersonalScheduleEditorField = document.querySelector('.css_personal_schedule_editor_field');\nconst PersonalScheduleEditorBodyElement = elementQuerySelector(PersonalScheduleEditorField, '.css_personal_schedule_editor_body');\nconst PersonalScheduleEditorHeadElement = elementQuerySelector(PersonalScheduleEditorField, '.css_personal_schedule_editor_head');\nconst leftButtonElement = elementQuerySelector(PersonalScheduleEditorHeadElement, '.css_personal_schedule_editor_button_left');\nconst PersonalScheduleEditorGroups = elementQuerySelector(PersonalScheduleEditorBodyElement, '.css_personal_schedule_editor_groups');\nconst nameInputElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-name\"] .css_personal_schedule_editor_group_body input');\nconst startTimeInputElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-start-time\"] .css_personal_schedule_editor_group_body input');\nconst endTimeInputElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-end-time\"] .css_personal_schedule_editor_group_body input');\nconst dayGroupBodyElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-days\"] .css_personal_schedule_editor_group_body');\nconst dayElements = elementQuerySelectorAll(dayGroupBodyElement, '.css_personal_schedule_editor_day');\n\nexport async function saveEditedPersonalSchedule(personalScheduleID: string) {\n  const name = nameInputElement.value;\n  const startTime = startTimeInputElement.value;\n  const endTime = endTimeInputElement.value;\n\n  const [startHours, startMinutes] = String(startTime)\n    .split(':')\n    .map((e) => parseInt(e));\n  const [endHours, endMinutes] = String(endTime)\n    .split(':')\n    .map((e) => parseInt(e));\n\n  let days = [];\n  for (let i = 0; i < 7; i++) {\n    const thisDayElement = dayElements[i];\n    const highlighted = thisDayElement.getAttribute('highlighted');\n    const day = parseInt(thisDayElement.getAttribute('day'));\n    if (highlighted === 'true') {\n      days.push(day);\n    }\n  }\n\n  let personalSchedule = await getPersonalSchedule(personalScheduleID);\n  personalSchedule.name = name;\n  personalSchedule.days = days;\n  personalSchedule.period.start.hours = startHours;\n  personalSchedule.period.start.minutes = startMinutes;\n  personalSchedule.period.end.hours = endHours;\n  personalSchedule.period.end.minutes = endMinutes;\n\n  await updatePersonalSchedule(personalSchedule);\n  closePersonalScheduleEditor();\n}\n\nasync function initializePersonalScheduleEditorField(personalScheduleID: string) {\n  const personalSchedule = await getPersonalSchedule(personalScheduleID);\n  nameInputElement.value = personalSchedule.name;\n  startTimeInputElement.value = timeObjectToString(personalSchedule.period.start);\n  endTimeInputElement.value = timeObjectToString(personalSchedule.period.end);\n\n  for (let i = 0; i < 7; i++) {\n    const thisDayElement = dayElements[i];\n    if (personalSchedule.days.indexOf(i) > -1) {\n      thisDayElement.setAttribute('highlighted', 'true');\n    } else {\n      thisDayElement.setAttribute('highlighted', 'false');\n    }\n  }\n  leftButtonElement.onclick = function () {\n    saveEditedPersonalSchedule(personalScheduleID);\n  };\n}\n\nexport function openPersonalScheduleEditor(personalScheduleID: string): void {\n  pushPageHistory('PersonalScheduleEditor');\n  PersonalScheduleEditorField.setAttribute('displayed', 'true');\n  initializePersonalScheduleEditorField(personalScheduleID);\n  closePreviousPage();\n}\n\nexport function closePersonalScheduleEditor(): void {\n  // revokePageHistory('PersonalScheduleEditor');\n  PersonalScheduleEditorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport function switchPersonalScheduleEditorDay(day: WeekDayIndex): void {\n  const thisDayElement = elementQuerySelector(dayGroupBodyElement, `.css_personal_schedule_editor_day[day=\"${day}\"]`);\n  const highlighted = thisDayElement.getAttribute('highlighted');\n  if (highlighted === 'true') {\n    thisDayElement.setAttribute('highlighted', 'false');\n  } else {\n    thisDayElement.setAttribute('highlighted', 'true');\n  }\n}\n","import { elementQuerySelector } from '../../tools/elements';\nimport { generateRoundedQRCodeSVG } from '../../tools/qrcode';\nimport { pushPageHistory, revokePageHistory } from '../index';\n\nconst QRCodeField = document.querySelector('.css_qrcode_field');\nconst QRCodeBodyElement = elementQuerySelector(QRCodeField, '.css_qrcode_body');\n\nexport function initializeQRCodeField(text: string): void {\n  const svg = generateRoundedQRCodeSVG(text, 'M', 0.5, 0.3, 1, 'var(--b-cssvar-333333)', 4);\n  QRCodeBodyElement.innerHTML = svg;\n}\n\nexport function openQRCode(text: string): void {\n  pushPageHistory('QRCode');\n  QRCodeField.setAttribute('displayed', 'true');\n  initializeQRCodeField(text);\n  // closePreviousPage();\n}\n\nexport function closeQRCode(): void {\n  revokePageHistory('QRCode');\n  QRCodeField.setAttribute('displayed', 'false');\n  // openPreviousPage();\n}\n"],"names":["previousIntegration","previousAnimation","previousSkeletonScreen","LocationDetailsField","document","querySelector","LocationDetailsBodyElement","elementQuerySelector","LocationDetailsActionsElement","generateElementOfItem","element","createElement","classList","add","icon","appendChild","getBlankIconElement","name","id","updateLocationDetailsField","integration","skeletonScreen","animation","updateItem","thisElement","thisItem","previousItem","updateIcon","thisIconElement","setIcon","updateName","innerText","updateOnclick","onclick","action","updateAnimation","setAttribute","booleanToString","updateSkeletonScreen","key","actions","actionsQuantity","currentActionsCapacity","elementQuerySelectorAll","length","difference","fragment","DocumentFragment","o","d","Math","abs","newItemElement","append","LocationActionElements","remove","i","hasOwnProperty","_initializeLocationDetailsField","_asyncToGenerator","hash","playing_animation","getSettingOptionValue","requestID","generateIdentifier","integrateLocationDetails","apply","arguments","openLocationDetails","pushPageHistory","push","setUpLocationDetailsFieldSkeletonScreen","_x","initializeLocationDetailsField","shareLocationPermalink","_x2","_shareLocationPermalink","Location","getLocation","deleteDataReceivingProgress","deleteDataUpdateTime","thisLocationKey","thisLocation","link","getPermalink","navigator","share","title","n","url","then","promptMessage","e","showLocationPermalinkQRCode","_x3","_showLocationPermalinkQRCode","openQRCode","NotificationScheduleManagerField","NotificationScheduleManagerHeadElement","NotificationScheduleManagerUpdateTimerBoxElement","NotificationScheduleManagerUpdateTimerElement","NotificationScheduleManagerBody","NotificationScheduleList","notifcationScheduleManagerRefreshTimer_baseInterval","notifcationScheduleManagerRefreshTimer_minInterval","notifcationScheduleManagerRefreshTimer_dynamicInterval","notifcationScheduleManagerRefreshTimer_dynamic","notifcationScheduleManagerRefreshTimer_lastUpdate","notifcationScheduleManagerRefreshTimer_nextUpdate","notifcationScheduleManagerRefreshTimer_currentRequestID","notifcationScheduleManagerRefreshTimer_refreshing","notifcationScheduleManagerRefreshTimer_streaming","notifcationScheduleManagerRefreshTimer_streamStarted","handleDataReceivingProgressUpdates","event","CustomEvent","offsetRatio","detail","progress","style","setProperty","toString","stage","removeEventListener","target","identifier","itemElement","hoursElement","notificationScheduleElement","minutesElement","contextElement","mainElement","cancelElement","iconElement","getIconElement","updateNotificationScheduleManagerField","thisItemElement","updateHours","hours","updateMinutes","thisItemNotificationScheduleElement","minutes","updateMain","updateContext","route","direction","updateCancel","_cancelNotificationOnNotificationScheduleManager","cancelNotificationOnNotificationScheduleManager","schedule_id","updateFirst","is_first","compareThings","itemQuantity","items","currentItemCapacity","NotificationScheduleItemElements","j","refreshNotificationScheduleManager","_refreshNotificationScheduleManager","refresh_interval_setting","dynamic","baseInterval","addEventListener","integrateNotifcationSchedules","updateRate","getUpdateRate","Date","getTime","max","dataUpdateTime","streamNotificationScheduleManager","_streamNotificationScheduleManager","setTimeout","err","openNotificationScheduleManager","WindowSize","querySize","FieldHeight","width","height","defaultItemQuantity","floor","stop_id","estimate_time","scheduled_time","pathAttributeId","date","setUpNotificationScheduleManagerFieldSkeletonScreen","closePreviousPage","cancelNotification","LocationField","LocationHeadElement","LocationNameElement","LocationNameSpanElement","LocationButtonRightElement","LocationGroupsElement","LocationGroupTabsElement","LocationGroupTabsTrayElement","LocationGroupTabLineTrackElement","LocationGroupTabLineElement","LocationUpdateTimerElement","locationSliding_initialIndex","locationSliding_groupQuantity","locationSliding_groupStyles","locationSliding_fieldWidth","locationSliding_sliding","locationRefreshTimer_baseInterval","locationRefreshTimer_minInterval","locationRefreshTimer_dynamicInterval","locationRefreshTimer_dynamic","locationRefreshTimer_lastUpdate","locationRefreshTimer_nextUpdate","locationRefreshTimer_currentRequestID","locationRefreshTimer_refreshing","locationRefreshTimer_streaming","locationRefreshTimer_streamStarted","currentHashSet_hash","updateLocationCSS","groupQuantity","offset","tabLineWidth","percentage","headElement","rankElement","rankNextSlideElement","rankCurrentSlideElement","routeDirectionElement","routeNameElement","capsuleElement","statusElement","nextSlideElement","currentSlideElement","stretchElement","itemElementID","itemBodyElement","itemsElement","parentElement","elementsBelowItemElement","getElementsBelow","elementsBelowLength","itemsElementRect","getBoundingClientRect","itemElementRect","itemElementY","top","stretched","getAttribute","pushDirection","once","stretchLocationItem","capsuleSeparatorElement","bodyElement","buttonsElement","busTabButtonElement","busTabIconElement","createTextNode","switchLocationBodyTab","arrivalTabButtonElement","arrivalTabIconElement","saveButtonElement","saveButtonIconElement","notifyButtonElement","notifyButtonIconElement","busesElement","busArrivalTimesElement","generateElementOfGroup","groupElement","detailsElement","detailsBodyElement","generateElementOfTab","span","generateElementOfGroupDetailsProperty","propertyElement","valueElement","updateLocationField","_previousIntegration","_previousIntegration2","updateStatus","thisElementRect","left","bottom","right","windowWidth","window","innerWidth","windowHeight","innerHeight","thisHeadElement","thisItemStatusElement","status","code","text","updateRank","thisRankElement","ranking","updateRouteDirection","route_direction","updateRouteName","route_name","updateBuses","thisItemBodyElement","innerHTML","buses","map","bus","onThisRoute","getIconHTML","carNumber","RouteName","type","join","updateBusArrivalTimes","busArrivalTimes","busArrivalTime","personalSchedule","indexToDay","day","timeObjectToString","period","start","end","chart","updateStretch","updateSaveToFolderButton","thisItemButtonsElement","saveToFolderButtonElement","openSaveToFolder","stopId","routeId","isFolderContentSaved","updateScheduleNotificationButton","scheduleNotificationButtonElement","openScheduleNotification","time","havingNotifcationSchedules","stopHasNotifcationSchedules","number","updateProperty","thisProperty","previousProperty","updateValue","value","FieldWidth","groupedItems","groups","cumulativeOffset","groupKey","getTextWidth","initialGroupStyle","LocationName","currentGroupCapacity","groupsFragment","tabsFragment","newGroupElement","newTabElement","LocationGroupElements","LocationGroupTabElements","groupIndex","thisLocationGroupElement","LocationGroupItemsElement","LocationGroupItemElements","currentGroupPropertyCapacity","groupPropertyQuantity","properties","thisLocationGroupDetailsElement","thisLocationGroupDetailsBodyElement","newPropertyElement","propertyElements","tabElements","groupElements","thisTabElement","thisGroupElement","itemElements","k","refreshLocation","_refreshLocation","busArrivalTimeChartSize","integrateLocation","streamLocation","openLocation","logRecentView","scrollLeft","focus","g_0","g_1","setUpLocationFieldSkeletonScreen","itemID","tabCode","_step","_iterator","_createForOfIteratorHelper","s","done","f","PersonalScheduleEditorField","PersonalScheduleEditorBodyElement","PersonalScheduleEditorHeadElement","leftButtonElement","PersonalScheduleEditorGroups","nameInputElement","startTimeInputElement","endTimeInputElement","dayGroupBodyElement","dayElements","_saveEditedPersonalSchedule","personalScheduleID","startTime","endTime","_String$split$map","String","split","parseInt","_String$split$map2","_slicedToArray","startHours","startMinutes","_String$split$map3","_String$split$map4","endHours","endMinutes","days","thisDayElement","highlighted","getPersonalSchedule","updatePersonalSchedule","closePersonalScheduleEditor","_initializePersonalScheduleEditorField","indexOf","saveEditedPersonalSchedule","openPersonalScheduleEditor","initializePersonalScheduleEditorField","openPreviousPage","QRCodeField","QRCodeBodyElement","svg","generateRoundedQRCodeSVG","initializeQRCodeField"],"ignoreList":[],"sourceRoot":""}