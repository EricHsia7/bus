"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[36],{904:(e,t,n)=>{n.d(t,{AE:()=>k,BM:()=>I,WR:()=>y,Z_:()=>A,f1:()=>C,gO:()=>x,kr:()=>w,l$:()=>L,p9:()=>E});var a=n(8024),i=n(3648),r=n(4927),o=n(6052),s=n(9333),d=n(8379),c=n(5693),u=n(7891),l=n(7908),f=n(5009),v=n(6104),p=(0,i.bv)(".og"),h=(0,i.bv)(".pg"),m=100,g=(new Date).getTime(),b=["Home"];function y(e){var t=b.length;b[t-1]!==e&&b.push(e)}function w(e){if(b.indexOf(e)>-1){var t=b.length;b[t-1]===e&&b.pop()}}function A(){var e=b.length;if(e>1)switch(b[e-2]){case"Home":case"FolderIconSelector":case"Location":case"LocationDetails":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":case"QRCode":default:break;case"FolderCreator":(0,o.z1)();break;case"FolderEditor":(0,s.I6)();break;case"FolderManager":(0,d.m)();break;case"Search":(0,f.Bb)();break;case"Settings":(0,v.os)();break;case"PersonalScheduleManager":(0,u.Z)();break;case"PersonalScheduleEditor":(0,c.Xy)();break;case"Bus":(0,r.F)();break;case"RegisterNotification":(0,l.hy)()}}function L(){var e=b.length;if(e>1){var t=b[e-2];switch(b.pop(),t){case"Home":case"FolderIconSelector":case"Location":case"LocationDetails":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":case"QRCode":default:break;case"FolderCreator":(0,o.pd)();break;case"FolderEditor":(0,s.uy)();break;case"FolderManager":(0,d.g)();break;case"Search":(0,f.rf)();break;case"Settings":(0,v.Ow)();break;case"PersonalScheduleManager":(0,u.z)();break;case"PersonalScheduleEditor":(0,c.bF)();break;case"Bus":(0,r.$)();break;case"RegisterNotification":(0,l.XG)()}}}function I(){var e=0;(0,a.t9)()&&(e=-1*(window.outerHeight-window.innerHeight)/2),(0,i.bv)(".og svg.qg").style.setProperty("--rg",`${e}px`)}function k(e){function t(){p.classList.add("sg"),p.addEventListener("animationend",(function(){p.setAttribute("displayed","false"),p.classList.remove("sg"),"function"==typeof e&&e()}),{once:!0})}var n=(new Date).getTime();n-g<m?setTimeout(t,Math.max(1,n-g)):t()}function C(){h.setAttribute("displayed","true")}function x(e){var t=0,n=0,a=window.innerWidth,i=window.innerHeight;switch(e){case"window":t=a,n=i;break;case"head":t=a,n=55;break;case"head-one-button":t=a-55,n=55;break;case"head-two-button":t=a-110,n=55;break;case"route-details-canvas":t=a-20-20,n=1680;break;case"route-bus-arrival-time-chart":t=a-45-15-20,n=75;break;case"location-bus-arrival-time-chart":t=a-30-20,n=75;break;default:t=0,n=0}return{width:t,height:n}}function E(){window.scrollTo({top:0,behavior:"instant"})}},1351:(e,t,n)=>{n.d(t,{ID:()=>C,co:()=>x,k9:()=>E,qp:()=>_});var a=n(8011),i=n(6788),r=n(6983),o=n(3459),s=n(8024),d=n(9469),c=n(3648),u=n(4537),l=n(904),f=n(9119),v=n(8279);function p(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){p(r,a,i,o,s,"next",e)}function s(e){p(r,a,i,o,s,"throw",e)}o(void 0)}))}}var m={},g=!0,b=!1,y=(0,c.bv)(".tg"),w=(0,c.aI)(y,".ug"),A=(0,c.aI)(w,".vg");function L(){var e=document.createElement("div");e.classList.add("wg");var t=document.createElement("div");t.classList.add("xg"),e.appendChild(t);var n=document.createElement("div");return n.classList.add("yg"),e.appendChild(n),{element:e,id:""}}function I(e,t,n){function a(e,a,i){function r(e,t){(0,c.aI)(e,".xg").innerHTML=(0,u.Z)(t.icon)}function o(e,t){(0,c.aI)(e,".yg").innerText=t.name}function d(e,t){e.onclick=t.action}function l(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function f(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}null===i?(r(e,a),o(e,a),d(e,a),l(e,n),f(e,t)):(i.key!==a.key&&(r(e,a),o(e,a),d(e,a)),n!==g&&l(e,n),t!==b&&f(e,t))}var i=e.actions,r=e.actionsQuantity,o=(0,c.jg)(A,".wg").length;if(r!==o){var d=o-r;if(d<0){for(var l=new DocumentFragment,f=0;f<Math.abs(d);f++){var v=L();l.appendChild(v.element)}A.append(l)}else for(var p=(0,c.jg)(A,".wg"),h=0;h<Math.abs(d);h++){p[o-1-h].remove()}}for(var y=(0,c.jg)(A,".wg"),w=0;w<r;w++){var I=y[w],k=i[w];if(m.hasOwnProperty("actions"))if(m.actions[w])a(I,k,m.actions[w]);else a(I,k,null);else a(I,k,null)}m=e,g=n,b=t}function k(){return(k=h((function*(e){var t=(0,o.Js)("playing_animation"),n=(0,s.zx)();I(yield(0,r.v)(e,n),!1,t)}))).apply(this,arguments)}function C(e){(0,l.WR)("LocationDetails"),y.setAttribute("displayed","true"),function(){for(var e=(0,o.Js)("playing_animation"),t=[],n=0;n<3;n++)t.push({name:"",icon:"",key:`action-${n}`,action:function(){}});I({actions:t,actionsQuantity:3,hash:""},!0,e)}(),function(e){k.apply(this,arguments)}(e)}function x(){(0,l.kr)("LocationDetails"),y.setAttribute("displayed","false")}function E(e){return T.apply(this,arguments)}function T(){return(T=h((function*(e){var t=(0,s.zx)(),n=yield(0,a.g)(t,1);(0,i.LQ)(t),(0,i.gC)(t);var r=`ml_${e}`;if(n.hasOwnProperty(r)){var o=n[r],c=(0,d.i)(1,{hash:e});navigator.share&&navigator.share({title:o.n,url:c}).then((function(){(0,f.a)("已分享地點連結","link")})).catch((function(e){(0,f.a)("已取消分享連結","cancel")}))}}))).apply(this,arguments)}function _(e){return S.apply(this,arguments)}function S(){return(S=h((function*(e){var t=(0,s.zx)(),n=yield(0,a.g)(t,1);(0,i.LQ)(t),(0,i.gC)(t);var r=`ml_${e}`;if(n.hasOwnProperty(r)){var o=(0,d.i)(1,{hash:e});(0,v.X8)(o)}}))).apply(this,arguments)}},3030:(e,t,n)=>{n.d(t,{eS:()=>fe,s_:()=>ee,so:()=>le});var a=n(5767),i=n(9566),r=n(2757),o=n(77),s=n(5314),d=n(3459),c=n(7968),u=n(8024),l=n(3648),f=n(5579),v=n(4537),p=n(904),h=n(9119),m=n(3041),g=n(752),b=n(1351);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function A(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}var L=(0,l.bv)(".zg"),I=(0,l.aI)(L,"._g"),k=(0,l.aI)(I,".ah"),C=(0,l.aI)(I,".bh"),x=(0,l.aI)(L,".ch"),E=(0,l.aI)(I,".dh"),T=(0,l.aI)(E,".eh"),_=(0,l.aI)(I,".fh"),S=(0,l.aI)(_,".gh"),M=(0,l.aI)(I,".hh .ih"),$={},j=!0,P=!1,Z=0,H=0,F=0,D={},N=0,R=!1,z=1e4,O=15e3,q=5e3,B=15e3,Q=!0,W=0,U=0,J="",X=!1,G=!1,K=!1,V="",Y=20;function ee(){x.addEventListener("touchstart",(function(){Z=Math.round(x.scrollLeft/N)}),{passive:!0}),x.addEventListener("scroll",(function(e){R=!0;var t=e.target.scrollLeft/N;H=t>Z?Z+1:Z-1;var n=D[`g_${Z}`]||{width:0,offset:0},a=D[`g_${H}`]||{width:0,offset:0},i=n.width+(a.width-n.width)*Math.abs(t-Z),r=-1*(n.offset+(a.offset-n.offset)*Math.abs(t-Z))+.5*N-.5*i;te(F,r,i-Y,t),t===H&&(Z=Math.round(x.scrollLeft/N),R=!1)}),{passive:!0})}function te(e,t,n,a){x.style.setProperty("--jh",e.toString()),S.style.setProperty("--kh",n.toString()),T.style.setProperty("--lh",`${t.toFixed(5)}px`),T.style.setProperty("--mh",a.toFixed(5))}function ne(e){var t=e;if(X){var n=t.detail.progress-1;M.style.setProperty("--ph",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,ne)}function ae(){var e=(0,u.zx)(),t=document.createElement("div");t.classList.add("qh"),t.id=e,t.setAttribute("stretched","false"),t.setAttribute("stretching","false"),t.setAttribute("push-direction","0"),t.setAttribute("push-state","0");var n=document.createElement("div");n.classList.add("rh");var a=document.createElement("div");a.classList.add("sh");var i=document.createElement("div");i.classList.add("th"),i.setAttribute("code","-1"),i.setAttribute("displayed","false");var r=document.createElement("div");r.classList.add("uh"),r.setAttribute("code","-1"),r.setAttribute("displayed","true"),a.appendChild(i),a.appendChild(r);var o=document.createElement("div");o.classList.add("vh");var s=document.createElement("div");s.classList.add("wh");var d=document.createElement("div");d.classList.add("xh");var c=document.createElement("div");c.classList.add("yh");var f=document.createElement("div");f.classList.add("_a"),f.setAttribute("code","0"),f.setAttribute("displayed","false");var p=document.createElement("div");p.classList.add("ab"),p.setAttribute("code","0"),p.setAttribute("displayed","true"),c.appendChild(f),c.appendChild(p);var h=document.createElement("div");h.classList.add("zh"),h.innerHTML=(0,v.Z)("keyboard_arrow_down"),h.onclick=function(){!function(e){var t=(0,l.aI)(x,`.gi .ji .qh#${e}`),n=(0,l.aI)(t,".ai"),a=t.parentElement,i=(0,l.ji)(t,"qh"),r=i.length,o=a.getBoundingClientRect(),s=t.getBoundingClientRect(),d=s.top-o.top,c="true"===t.getAttribute("stretched"),u="true"===t.getAttribute("animation");if(u){var f=c?"2":"1";t.setAttribute("stretching","true"),t.style.setProperty("--hj",`${d}px`);for(var v=0;v<r;v++){var p=i[v];p.setAttribute("push-direction",f),p.setAttribute("push-state","1")}t.addEventListener("transitionend",(function(){for(var e=0;e<r;e++){var n=i[e];n.setAttribute("push-direction","0"),n.setAttribute("push-state","0")}t.setAttribute("stretching","false")}),{once:!0}),t.addEventListener("transitionstart",(function(){for(var e=0;e<r;e++){i[e].setAttribute("push-state","2")}}),{once:!0})}c?(u?n.addEventListener("transitionend",(function(){n.setAttribute("displayed","false")}),{once:!0}):n.setAttribute("displayed","false"),t.setAttribute("stretched","false")):(n.setAttribute("displayed","true"),t.setAttribute("stretched","true"))}(e)};var m=document.createElement("div");m.classList.add("_h"),d.appendChild(c),d.appendChild(h),d.appendChild(m),n.appendChild(a),n.appendChild(o),n.appendChild(s),n.appendChild(d);var g=document.createElement("div");g.classList.add("ai"),g.setAttribute("displayed","false");var b=document.createElement("div");b.classList.add("bi");var y=document.createElement("div");y.classList.add("ci"),y.setAttribute("highlighted","true"),y.setAttribute("type","tab"),y.setAttribute("code","0");var w=document.createElement("div");w.classList.add("di"),w.innerHTML=(0,v.Z)("directions_bus"),y.appendChild(w),y.appendChild(document.createTextNode("公車")),y.onclick=function(){ve(e,0)};var A=document.createElement("div");A.classList.add("ci"),A.setAttribute("highlighted","false"),A.setAttribute("type","tab"),A.setAttribute("code","1");var L=document.createElement("div");L.classList.add("di"),L.innerHTML=(0,v.Z)("departure_board"),A.appendChild(L),A.appendChild(document.createTextNode("抵達時間")),A.onclick=function(){ve(e,1)};var I=document.createElement("div");I.classList.add("ci"),I.setAttribute("highlighted","false"),I.setAttribute("type","save-to-folder");var k=document.createElement("div");k.classList.add("di"),k.innerHTML=(0,v.Z)("folder"),I.appendChild(k),I.appendChild(document.createTextNode("儲存"));var C=document.createElement("div");C.classList.add("ci"),C.setAttribute("highlighted","false"),C.setAttribute("type","schedule-notification"),C.setAttribute("enabled","true");var E=document.createElement("div");E.classList.add("di"),E.innerHTML=(0,v.Z)("notifications"),C.appendChild(E),C.appendChild(document.createTextNode("到站通知")),b.appendChild(y),b.appendChild(A),b.appendChild(I),b.appendChild(C);var T=document.createElement("div");T.classList.add("ei"),T.setAttribute("displayed","true");var _=document.createElement("div");return _.classList.add("fi"),_.setAttribute("displayed","false"),g.appendChild(b),g.appendChild(T),g.appendChild(_),t.appendChild(n),t.appendChild(g),{element:t,id:e}}function ie(){var e=document.createElement("div");e.classList.add("gi");var t=document.createElement("div");t.classList.add("hi");var n=document.createElement("div");n.classList.add("ii"),t.appendChild(n);var a=document.createElement("div");return a.classList.add("ji"),e.appendChild(t),e.appendChild(a),{element:e,id:""}}function re(){var e=document.createElement("div");e.classList.add("ki");var t=document.createElement("span");return e.appendChild(t),{element:e,id:""}}function oe(){var e=document.createElement("div");e.classList.add("li");var t=document.createElement("div");t.classList.add("mi");var n=document.createElement("div");return n.classList.add("ni"),e.appendChild(t),e.appendChild(n),{element:e,id:""}}function se(e,t,n){function a(e,a,r){function s(e,t,n){var a=e.getBoundingClientRect(),i=a.top,r=a.left,o=a.bottom,s=a.right,d=window.innerWidth,c=window.innerHeight,u=(0,l.aI)(e,".yh"),f=(0,l.aI)(u,"._a"),v=(0,l.aI)(u,".ab");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,n&&o>0&&i<c&&s>0&&r<d?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,v.classList.remove("kb"),f.setAttribute("displayed","false")}),{once:!0}),f.setAttribute("displayed","true"),v.classList.add("kb")):(v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text)}function d(e,t,n){var a=e.getBoundingClientRect(),i=a.top,r=a.left,o=a.bottom,s=a.right,d=window.innerWidth,c=window.innerHeight,u=(0,l.aI)(e,".sh"),f=(0,l.aI)(u,".th"),v=(0,l.aI)(u,".uh");f.setAttribute("code",t.ranking.code.toString()),f.innerText=t.ranking.text,n&&o>0&&i<c&&s>0&&r<d?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text,v.classList.remove("oi"),f.setAttribute("displayed","false")}),{once:!0}),f.setAttribute("displayed","true"),v.classList.add("oi")):(v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text)}function c(e,t){(0,l.aI)(e,".vh").innerText=t.route_direction}function p(e,t){(0,l.aI)(e,".wh").innerText=t.route_name}function h(e,t){(0,l.aI)(e,".ei").innerHTML=0===t.buses.length?'<div class="pi">目前沒有公車可顯示</div>':t.buses.map((function(e){return`<div class="qi" on-this-route="${e.onThisRoute}"><div class="ri"><div class="si">${(0,v.Z)("directions_bus")}</div><div class="ti">${e.carNumber}</div></div><div class="ui"><div class="vi">路線：${e.RouteName}</div><div class="wi">狀態：${e.status.text}</div><div class="xi">類型：${e.type}</div></div></div>`})).join("")}function b(e,t){(0,l.aI)(e,".fi").innerHTML=0===t.busArrivalTimes.length?'<div class="yi">目前沒有抵達時間可顯示</div>':t.busArrivalTimes.map((function(e){return`<div class="zi"><div class="_i"><div class="aj">${(0,v.Z)("calendar_view_day")}</div><div class="bj">${e.personalSchedule.name}</div><div class="cj">週${(0,f.kd)(e.day).name} ${(0,f.pn)(e.personalSchedule.period.start)} - ${(0,f.pn)(e.personalSchedule.period.end)}</div></div><div class="dj">${e.chart}</div></div>`})).join("")}function y(e,t){t&&e.setAttribute("stretched","false")}function w(e,t){e.setAttribute("animation",(0,u.xZ)(t))}function A(e,t){e.setAttribute("skeleton-screen",(0,u.xZ)(t))}function L(e,t){var n=(0,l.aI)(e,".ai"),a=(0,l.aI)(n,".bi"),r=(0,l.aI)(a,'.ci[type="save-to-folder"]');r.onclick=function(){(0,m.B)("stop-on-location",[e.id,t.stopId,t.routeId])},(0,i.LH)("stop",t.stopId).then((function(e){r.setAttribute("highlighted",(0,u.xZ)(e))}))}function I(e,t){var n=(0,l.aI)(e,".ai"),a=(0,l.aI)(n,".bi"),i=(0,l.aI)(a,'.ci[type="schedule-notification"]');i.onclick=function(){(0,g.Ho)("stop-on-location",[e.id,t.stopId,t.routeId,t.status.time])};var r=(0,o.Zc)(t.stopId);i.setAttribute("highlighted",(0,u.xZ)(r))}null===r?(s(e,a,n),d(e,a,n),c(e,a),p(e,a),h(e,a),b(e,a),y(e,t),w(e,n),A(e,t),L(e,a),I(e,a)):(a.status.time!==r.status.time&&(s(e,a,n),I(e,a)),r.ranking.number===a.ranking.number&&r.ranking.code===a.ranking.code||d(e,a,n),r.stopId!==a.stopId&&(c(e,a),p(e,a),L(e,a)),(0,u.hw)(r.buses,a.buses)||h(e,a),(0,u.hw)(r.busArrivalTimes,a.busArrivalTimes)||b(e,a),n!==j&&w(e,n),t!==P&&(y(e,t),A(e,t)))}function r(e,a,i){function r(e,t){(0,l.aI)(e,".mi").innerHTML=(0,v.Z)(t.icon)}function o(e,t){(0,l.aI)(e,".ni").innerHTML=t.value}function s(e,t){e.setAttribute("animation",(0,u.xZ)(t))}function d(e,t){e.setAttribute("skeleton-screen",(0,u.xZ)(t))}null===i?(r(e,a),o(e,a),s(e,n),d(e,t)):((0,u.hw)(i.icon,a.icon)||r(e,a),(0,u.hw)(i.value,a.value)||o(e,a),n!==j&&s(e,n),t!==P&&d(e,t))}var s=(0,p.gO)("window"),d=s.width,h=s.height,y=e.groupQuantity,w=e.itemQuantity,A=e.groupedItems,L=e.groups;F=y,N=d;for(var I=0,S=0;S<y;S++){var M=(0,c.q_)(L[`g_${S}`].name,500,"17px",'"Noto Sans TC", sans-serif')+Y;D[`g_${S}`]={width:M,offset:I},I+=M}var H=-1*D[`g_${Z}`].offset+.5*N-.5*D[`g_${Z}`].width;R||te(F,H,D[`g_${Z}`].width-Y,Z),k.innerHTML=`<span>${e.LocationName}</span>`,k.setAttribute("animation",(0,u.xZ)(n)),k.setAttribute("skeleton-screen",(0,u.xZ)(t)),C.onclick=function(){(0,b.ID)(e.hash)},E.setAttribute("animation",(0,u.xZ)(n)),E.setAttribute("skeleton-screen",(0,u.xZ)(t)),_.setAttribute("skeleton-screen",(0,u.xZ)(t));var z=(0,l.jg)(x,".gi").length;if(y!==z){var O=z-y;if(O<0){for(var q=new DocumentFragment,B=new DocumentFragment,Q=0;Q<Math.abs(O);Q++){var W=ie();q.appendChild(W.element);var U=re();B.appendChild(U.element)}x.append(q),T.append(B)}else for(var J=(0,l.jg)(x,".gi"),X=(0,l.jg)(T,".ki"),G=0;G<Math.abs(O);G++){var K=z-1-G;J[K].remove(),X[K].remove()}}for(var V=(0,l.jg)(x,".gi"),ee=0;ee<y;ee++){var ne=`g_${ee}`,se=V[ee],de=(0,l.jg)(se,".ji .qh").length;if(w[ne]!==de){var ce=de-w[ne];if(ce<0)for(var ue=(0,l.aI)(se,".ji"),le=0;le<Math.abs(ce);le++){var fe=ae();ue.appendChild(fe.element)}else for(var ve=(0,l.jg)(se,".ji .qh"),pe=0;pe<Math.abs(ce);pe++){ve[de-1-pe].remove()}}var he=(0,l.jg)((0,l.jg)(x,".gi")[ee],".hi .ii .li").length,me=L[ne].properties.length;if(me!==he){var ge=he-me;if(ge<0)for(var be=(0,l.aI)(se,".hi"),ye=(0,l.aI)(be,".ii"),we=0;we<Math.abs(ge);we++){var Ae=oe();ye.appendChild(Ae.element)}else for(var Le=(0,l.aI)(se,".hi"),Ie=(0,l.aI)(Le,".ii"),ke=(0,l.jg)(Ie,".li"),Ce=0;Ce<Math.abs(ge);Ce++){ke[he-1-Ce].remove()}}}for(var xe=(0,l.jg)(T,".ki"),Ee=(0,l.jg)(x,".gi"),Te=0;Te<y;Te++){var _e=`g_${Te}`,Se=xe[Te];(0,l.aI)(Se,"span").innerText=L[_e].name,Se.style.setProperty("--ej",`${D[_e].width}px`),Se.style.setProperty("--fj",Te.toString());for(var Me=Ee[Te],$e=(0,l.jg)(Me,".hi .ii .li"),je=(0,l.jg)(Me,".ji .qh"),Pe=L[_e].properties.length,Ze=0;Ze<Pe;Ze++){var He=L[_e].properties[Ze],Fe=$e[Ze];if($.hasOwnProperty("groups"))if($.groups.hasOwnProperty(_e))if($.groups[_e].properties[Ze])r(Fe,He,$.groups[_e].properties[Ze]);else r(Fe,He,null);else r(Fe,He,null);else r(Fe,He,null)}for(var De=0;De<w[_e];De++){var Ne=je[De],Re=A[_e][De];if($.hasOwnProperty("groupedItems"))if($.groupedItems.hasOwnProperty(_e))if($.groupedItems[_e][De])a(Ne,Re,$.groupedItems[_e][De]);else a(Ne,Re,null);else a(Ne,Re,null);else a(Ne,Re,null)}}$=e,j=n,P=t}function de(){return ce.apply(this,arguments)}function ce(){var e;return e=function*(){var e=(0,d.Js)("playing_animation"),t=(0,d.Js)("refresh_interval"),n=(0,p.gO)("location-bus-arrival-time-chart");Q=t.dynamic,O=t.baseInterval,X=!0,J=(0,u.zx)(),M.setAttribute("refreshing","true"),M.classList.remove("oh"),document.addEventListener(J,ne);var i=yield(0,r.R)(V,n.width,n.height,J);se(i,!1,e);var o=0;Q&&(o=yield(0,a.wz)()),W=(new Date).getTime(),U=Q?Math.max(W+q,i.dataUpdateTime+O/o):W+O,B=Math.max(q,U-W),X=!1,M.setAttribute("refreshing","false"),M.style.setProperty("--nh",`${B}ms`),M.classList.add("oh")},ce=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){A(r,a,i,o,s,"next",e)}function s(e){A(r,a,i,o,s,"throw",e)}o(void 0)}))},ce.apply(this,arguments)}function ue(){de().then((function(){G?setTimeout((function(){ue()}),Math.max(q,U-(new Date).getTime())):K=!1})).catch((function(e){G?((0,h.a)(`地點網路連線中斷，將在${z/1e3}秒後重試。`,"error"),setTimeout((function(){ue()}),z)):K=!1}))}function le(e){(0,p.WR)("Location"),(0,s.XK)("location",e),V=e,Z=0,L.setAttribute("displayed","true"),x.scrollLeft=0,function(){for(var e=(0,d.Js)("playing_animation"),t=(0,p.gO)("window"),n=(t.width,t.height),a={g_0:Math.floor(n/50)+5,g_1:Math.floor(n/50)+5},i={},r=0;r<2;r++){var o=`g_${r}`;i[o]=[];for(var s=0;s<a[o];s++)i[o].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}se({groupedItems:i,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]}},itemQuantity:a,LocationName:"載入中",hash:"",dataUpdateTime:0},!0,e)}(),G||(G=!0,K?de():(K=!0,ue())),(0,p.Z_)()}function fe(){L.setAttribute("displayed","false"),G=!1,(0,p.l$)()}function ve(e,t){var n,a=(0,l.aI)(x,`.gi .ji .qh#${e}`),i=(0,l.aI)(a,".ai"),r=(0,l.aI)(i,".bi"),o=y((0,l.jg)(r,'.ci[highlighted="true"][type="tab"]'));try{for(o.s();!(n=o.n()).done;){n.value.setAttribute("highlighted","false")}}catch(e){o.e(e)}finally{o.f()}switch((0,l.aI)(r,`.ci[code="${t}"]`).setAttribute("highlighted","true"),t){case 0:(0,l.aI)(a,".ei").setAttribute("displayed","true"),(0,l.aI)(a,".fi").setAttribute("displayed","false");break;case 1:(0,l.aI)(a,".ei").setAttribute("displayed","false"),(0,l.aI)(a,".fi").setAttribute("displayed","true")}}},6052:(e,t,n)=>{n.d(t,{c6:()=>v,pd:()=>p,z1:()=>h});var a=n(9566),i=n(3648),r=n(6189),o=n(904),s=n(9119),d=(0,i.bv)(".sf"),c=(0,i.aI)(d,".xf"),u=(0,i.aI)(c,".yf"),l=(0,i.aI)(u,'.zf[group="folder-name"] .cg input'),f=(0,i.aI)(u,'.zf[group="folder-icon"] .cg .dg input');function v(){var e=l.value,t=f.value;(0,a.vV)(e,t).then((function(e){e?(h(),(0,s.a)("已建立資料夾","folder")):(0,s.a)("無法建立資料夾","error")}))}function p(){(0,o.WR)("FolderCreator"),d.setAttribute("displayed","true"),(0,o.Z_)()}function h(){d.setAttribute("displayed","false"),(0,o.l$)()}(0,i.aI)(u,'.sf .xf .yf .zf[group="folder-icon"] .cg .dg .eg').onclick=function(){(0,r.r7)("creator")}},6189:(e,t,n)=>{n.d(t,{Pk:()=>L,jW:()=>k,r7:()=>I});var a=n(9930),i=n(6788),r=n(972),o=n(8024),s=n(3648),d=n(4781),c=n(6082),u=n(4537),l=n(904),f=n(9119);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function h(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}var m="",g=(0,s.bv)(".we"),b=(0,s.bv)(".sf"),y=(0,s.bv)(".i");function w(e){var t=document.createElement("div");return t.classList.add("jg"),t.onclick=function(){!function(e){var t;switch(m){case"editor":t=(0,s.aI)(g,'._e .af .bf[group="folder-icon"] .ff .hf input');break;case"creator":t=(0,s.aI)(b,'.xf .yf .zf[group="folder-icon"] .cg .dg input')}t.value=e,k()}(e)},t.innerHTML=(0,u.Z)(e),{element:t,id:""}}function A(){var e;return e=function*(){var e=(0,s.aI)(y,".gg .hg");e.innerHTML="";var t=(0,o.zx)(),n=yield(0,a.z)(t);(0,i.LQ)(t);var r,d=new DocumentFragment,c=v(n);try{for(c.s();!(r=c.n()).done;){var u=w(r.value);d.appendChild(u.element)}}catch(e){c.e(e)}finally{c.f()}e.append(d)},A=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){h(r,a,i,o,s,"next",e)}function s(e){h(r,a,i,o,s,"throw",e)}o(void 0)}))},A.apply(this,arguments)}function L(e){var t=(0,s.aI)(y,".gg .ig"),n=(0,s.aI)(y,".gg .hg");if(!(0,d.iO)(e)){var a,i=(0,r.U)(e,100),o=new DocumentFragment,c=v(i);try{for(c.s();!(a=c.n()).done;){var u=w(a.value.item);o.appendChild(u.element)}}catch(e){c.e(e)}finally{c.f()}t.innerHTML="",t.append(o),t.setAttribute("displayed",i.length>0?"true":"false"),n.setAttribute("displayed",i.length>0?"false":"true")}}function I(e){switch((0,l.WR)("FolderIconSelector"),e){case"editor":m="editor",(0,s.aI)(g,'._e .af .bf[group="folder-icon"] .ff .hf .if');break;case"creator":m="creator",(0,s.aI)(b,'.xf .yf .zf[group="folder-icon"] .cg .dg .eg')}c.m?(y.setAttribute("displayed","true"),function(){A.apply(this,arguments)}(m),(0,r.L)()):(0,f.a)("資料還在下載中","download_for_offline")}function k(){(0,l.kr)("FolderIconSelector"),y.setAttribute("displayed","false")}},8379:(e,t,n)=>{n.d(t,{g:()=>m,m:()=>g});var a=n(9566),i=n(3648),r=n(9333),o=n(4537),s=n(904);function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function u(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}var l=(0,i.bv)(".ke"),f=(0,i.aI)(l,".pe"),v=(0,i.aI)(f,".qe");function p(e){var t=document.createElement("div");t.classList.add("re"),t.onclick=function(){(0,r.uy)(e.id)};var n=document.createElement("div");n.classList.add("se"),n.innerHTML=(0,o.Z)(e.icon);var a=document.createElement("div");a.classList.add("te"),a.appendChild(document.createTextNode(e.name));var i=document.createElement("div");i.classList.add("ue"),i.appendChild(document.createTextNode(String(e.contentLength)));var s=document.createElement("div");return s.classList.add("ve"),s.innerHTML=(0,o.Z)("arrow_forward_ios"),t.appendChild(n),t.appendChild(a),t.appendChild(i),t.appendChild(s),{element:t,id:""}}function h(){var e;return e=function*(){var e=yield(0,a.Xi)();v.innerHTML="";var t,n=new DocumentFragment,i=d(e);try{for(i.s();!(t=i.n()).done;){var r=p(t.value);n.appendChild(r.element)}}catch(e){i.e(e)}finally{i.f()}v.append(n)},h=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){u(r,a,i,o,s,"next",e)}function s(e){u(r,a,i,o,s,"throw",e)}o(void 0)}))},h.apply(this,arguments)}function m(){(0,s.WR)("FolderManager"),l.setAttribute("displayed","true"),function(){h.apply(this,arguments)}()}function g(){(0,s.kr)("FolderManager"),l.setAttribute("displayed","false")}},9333:(e,t,n)=>{n.d(t,{Bo:()=>E,I6:()=>C,uy:()=>k});var a=n(9566),i=n(8024),r=n(3648),o=n(6189),s=n(4537),d=n(904),c=n(9119);function u(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var v=(0,r.bv)(".we"),p=(0,r.aI)(v,".xe"),h=(0,r.aI)(p,".ye"),m=(0,r.aI)(v,"._e"),g=(0,r.aI)(m,".af"),b=(0,r.aI)(g,'.bf[group="folder-name"] .ff input'),y=(0,r.aI)(g,'.bf[group="folder-icon"] .ff .hf input'),w=(0,r.aI)(g,'.bf[group="folder-icon"] .ff .hf .if'),A=(0,r.aI)(g,'.bf[group="folder-content"] .ff');function L(e,t){var n=(0,i.zx)(),o=document.createElement("div");o.id=n,o.classList.add("jf"),o.setAttribute("type",t.type);var d="",u="",l="";switch(t.type){case"stop":l="location_on",d=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`,u=t.name;break;case"route":l="route",d=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`,u=t.name;break;case"location":l="location_on",d="地點",u=t.name;break;case"bus":d="",u=t.name;break;case"empty":l="lightbulb",d="提示",u="沒有內容";break;default:l="",d="null",u="null"}var f=document.createElement("div");f.classList.add("kf"),f.innerHTML=(0,s.Z)(l);var p=document.createElement("div");p.classList.add("lf"),p.appendChild(document.createTextNode(d));var h=document.createElement("div");h.classList.add("mf"),h.appendChild(document.createTextNode(u));var m=document.createElement("div");m.classList.add("nf");var g=document.createElement("div");g.classList.add("of"),g.innerHTML=(0,s.Z)("keyboard_arrow_down"),g.onclick=function(){x(n,e.id,t.type,t.id,"up")};var b=document.createElement("div");b.classList.add("pf"),b.innerHTML=(0,s.Z)("keyboard_arrow_down"),b.onclick=function(){x(n,e.id,t.type,t.id,"down")};var y=document.createElement("div");y.classList.add("qf"),y.innerHTML=(0,s.Z)("delete"),y.onclick=function(){!function(e,t,n,i){var o=(0,r.aI)(v,`._e .af .bf[group="folder-content"] .ff .jf#${e}`);(0,a.NC)(t,n,i).then((function(e){if(e)switch(o.remove(),n){case"stop":(0,c.a)("已移除站牌","delete");break;case"route":(0,c.a)("已移除路線","delete");break;case"location":(0,c.a)("已移除地點","delete")}else(0,c.a)("無法移除","error")}))}(n,e.id,t.type,t.id)};var w=document.createElement("div");w.classList.add("rf");var A=document.createElement("div");return A.classList.add("rf"),m.appendChild(g),m.appendChild(b),m.appendChild(y),m.appendChild(w),m.appendChild(A),o.appendChild(f),o.appendChild(p),o.appendChild(h),o.appendChild(m),{element:o,id:n}}function I(){var e;return e=function*(e){!function(e,t){b.value=e.name,y.value=e.icon,h.onclick=function(){E(e.id)},A.innerHTML="";var n,a=new DocumentFragment,i=l(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=L(e,r);a.appendChild(o.element)}}catch(e){i.e(e)}finally{i.f()}A.append(a)}(yield(0,a.L2)(e),yield(0,a.eD)(e))},I=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){u(r,a,i,o,s,"next",e)}function s(e){u(r,a,i,o,s,"throw",e)}o(void 0)}))},I.apply(this,arguments)}function k(e){(0,d.WR)("FolderEditor"),v.setAttribute("displayed","true"),function(e){I.apply(this,arguments)}(e),(0,d.Z_)()}function C(){v.setAttribute("displayed","false"),(0,d.l$)()}function x(e,t,n,i,o){var s=(0,r.aI)(v,`._e .af .bf[group="folder-content"] .ff .jf#${e}`);(0,a.bq)(t,n,i,o).then((function(e){if(e)switch(o){case"up":var t=s.previousElementSibling;t&&s.parentNode.insertBefore(s,t),(0,c.a)("已往上移","arrow_circle_up");break;case"down":var n=s.nextElementSibling;n&&s.parentNode.insertBefore(n,s),(0,c.a)("已往下移","arrow_circle_down")}else(0,c.a)("無法移動","error")}))}function E(e){var t=b.value,n=y.value;(0,a.g$)(e,t,n),C()}w.onclick=function(){(0,o.r7)("editor")}}}]);
//# sourceMappingURL=dd753805b609b66b84c8.js.map