{"version":3,"file":"main.65ef6d9fe3df7889a7fc.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,MAAO,GAAIH,GACQ,iBAAZC,QACdA,QAAa,IAAID,IAEjBD,EAAU,IAAIC,GACf,CATD,CASGK,KAAM,I,uBCTLC,E,wECaG,SAASC,EAAWC,EAAcC,EAAcC,EAAeC,GACpE,IAAMC,EAAmB,IAAIC,KAW7B,OAVAD,EAAiBE,QAAQ,GACzBF,EAAiBG,SAAS,GAC1BH,EAAiBI,SAASN,GAC1BE,EAAiBK,WAAWN,GAC5BC,EAAiBM,WAAW,GAC5BN,EAAiBO,gBAAgB,GACjCP,EAAiBQ,YAAYZ,EAAOa,eACpCT,EAAiBG,SAASP,EAAOc,YACjCV,EAAiBE,QAAQN,EAAOe,WAChCX,EAAiBE,QAAQF,EAAiBW,UAAYd,GAC/CG,CACT,CA0BO,SAASY,EAAaf,GAQ3B,OARuDgB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,uBAEvDG,WAAW,UAAWnB,EAAKY,eAC3BO,WAAW,UAAWC,OAAOpB,EAAKa,WAAa,GAAGQ,SAAS,EAAG,MAC9DF,WAAW,UAAWC,OAAOpB,EAAKc,WAAWO,SAAS,EAAG,MACzDF,WAAW,UAAWC,OAAOpB,EAAKsB,YAAYD,SAAS,EAAG,MAC1DF,WAAW,UAAWC,OAAOpB,EAAKuB,cAAcF,SAAS,EAAG,MAC5DF,WAAW,UAAWC,OAAOpB,EAAKwB,cAAcH,SAAS,EAAG,KAEjE,CAEO,SAASI,EAAmBzB,GACjC,IAAM0B,EAAO1B,EAAK2B,UACZC,EAAUC,KAAKC,QAAO,IAAI1B,MAAOuB,UAAYD,GAAQ,KACvDK,EAAWF,KAAKC,MAAMF,EAAU,SACpC,OAAIG,GAAY,EACP,GAAGA,OAEZA,EAAWF,KAAKC,MAAMF,EAAU,UAChB,EACP,GAAGG,QAEZA,EAAWF,KAAKC,MAAMF,EAAU,SAChB,EACP,GAAGG,OAEZA,EAAWF,KAAKC,MAAMF,EAAU,QAChB,EACP,GAAGG,QAEZA,EAAWF,KAAKC,MAAMF,EAAU,MAChB,EACP,GAAGG,OAERH,EAAU,EACL,GAAGA,MAEL,IACT,CAEO,SAASI,EAAWN,EAAcO,GACvC,IAAMC,EAAqB,EAAPR,EACpB,OAAQO,GACN,KAAK,EACH,MAAO,GAAGC,KAGZ,KAAK,EAGH,MAAO,CAFSd,QAAQc,EAAeA,EAAc,IAAO,IAC5Cd,OAAOc,EAAc,KACXC,IAAI,SAACC,GAAC,OAAKA,EAAEf,SAAS,EAAG,IAAI,GAAEgB,KAAK,KAGhE,KAAK,EAEH,MAAO,GADUH,EAAc,GAAM,KAIvC,KAAK,EACH,GAAIA,GAAe,KAEjB,MAAO,GADOI,YAAYJ,EAAc,MAAWK,QAAQ,OAG7D,GAAI,IAAML,GAAeA,EAAc,KAErC,MAAO,GADUA,EAAc,GAAM,KAGvC,GAAIA,EAAc,GAChB,MAAO,GAAGA,KAEZ,MAEF,QACE,MAAO,KAIb,CAeO,SAASM,EAAWC,GAsCzB,MArCa,CACX,CACEC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER,CACEF,KAAM,IACNC,IAAK,EACLC,KAAM,OAER,CACEF,KAAM,IACNC,IAAK,EACLC,KAAM,OAER,CACEF,KAAM,IACNC,IAAK,EACLC,KAAM,OAER,CACEF,KAAM,IACNC,IAAK,EACLC,KAAM,OAER,CACEF,KAAM,IACNC,IAAK,EACLC,KAAM,OAER,CACEF,KAAM,IACNC,IAAK,EACLC,KAAM,QAGEH,EACd,CAEO,SAASI,EAAqBC,GAGnC,OAAON,EAFKO,SAASD,GACD,EAEtB,CAiBO,SAASE,EAAmBC,GACjC,MAAO,GAAG7B,OAAO6B,EAAWhD,OAAOoB,SAAS,EAAG,QAAQD,OAAO6B,EAAW/C,SAASmB,SAAS,EAAG,MAChG,CAEO,SAAS6B,EAAyBC,EAAcC,EAAepD,GACpE,IAAMqD,EAAa,IAAIjD,KAUvB,OATAiD,EAAWhD,QAAQ,GACnBgD,EAAW/C,SAAS,GACpB+C,EAAW1C,YAAYwC,GACvBE,EAAW/C,SAAS8C,EAAQ,GAC5BC,EAAWhD,QAAQL,GACnBqD,EAAW9C,SAAS,GACpB8C,EAAW7C,WAAW,GACtB6C,EAAW5C,WAAW,GACtB4C,EAAW3C,gBAAgB,GACpB2C,CACT,CC9NA,IAAMC,EAAcC,EAAQ,MAExBC,EAAU,CACZC,YAAY,EACZC,eAAe,EACfC,qBAAqB,EACrBC,qBAAqB,EACrBC,kCAAkC,EAClCC,sCAAsC,EACtCC,yBAAyB,EACzBC,uBAAuB,EACvBC,kBAAkB,EAClBC,mBAAmB,EACnBC,2BAA2B,EAC3BC,iBAAiB,EACjBC,yBAAyB,EACzBC,oBAAoB,GAGhBC,EAAS,CAAC,aAAc,gBAAiB,sBAAuB,sBAAuB,mCAAoC,uCAAwC,0BAA2B,wBAAyB,mBAAoB,oBAAqB,4BAA6B,kBAAmB,0BAA2B,sBAa1U,SAAeC,EAASC,EAAAC,EAAAC,GAAA,OAAAC,EAAAC,MAAC,KAAD7D,UAAA,CAe9B,SAAA4D,IAAA,OAAAA,GAAAE,EAAAA,EAAAA,GAfM,UAAyBC,EAAeC,EAAaC,GAC1D,IACE,IAAMC,EAAWX,EAAOQ,GAOxB,OAN0B,IAAtBvB,EAAQ0B,KACV1B,EAAQ0B,SAAkB5B,EAAY6B,eAAe,CACnDzC,KAAMwC,WAGc1B,EAAQ0B,GAAUE,QAAQJ,EAAKC,EAEzD,CAAE,MAAOI,GAGP,OAAO,IACT,CACF,IAACR,MAAA,KAAA7D,UAAA,CAEM,SAAesE,EAASC,EAAAC,GAAA,OAAAC,EAAAZ,MAAC,KAAD7D,UAAA,CAe9B,SAAAyE,IAAA,OAAAA,GAAAX,EAAAA,EAAAA,GAfM,UAAyBC,EAAeC,GAC7C,IACE,IAAME,EAAWX,EAAOQ,GAOxB,OAN0B,IAAtBvB,EAAQ0B,KACV1B,EAAQ0B,SAAkB5B,EAAY6B,eAAe,CACnDzC,KAAMwC,WAGc1B,EAAQ0B,GAAUQ,QAAQV,EAEpD,CAAE,MAAOK,GAGP,OAAO,IACT,CACF,IAACR,MAAA,KAAA7D,UAAA,CAEM,SAAe2E,EAAYC,EAAAC,GAAA,OAAAC,EAAAjB,MAAC,KAAD7D,UAAA,CAejC,SAAA8E,IAAA,OAAAA,GAAAhB,EAAAA,EAAAA,GAfM,UAA4BC,EAAeC,GAChD,IACE,IAAME,EAAWX,EAAOQ,GAOxB,OAN0B,IAAtBvB,EAAQ0B,KACV1B,EAAQ0B,SAAkB5B,EAAY6B,eAAe,CACnDzC,KAAMwC,WAGc1B,EAAQ0B,GAAUa,WAAWf,EAEvD,CAAE,MAAOK,GAGP,OAAO,IACT,CACF,IAACR,MAAA,KAAA7D,UAAA,CAEM,SAAegF,EAAcC,GAAA,OAAAC,EAAArB,MAAC,KAAD7D,UAAA,CAcnC,SAAAkF,IAAA,OAAAA,GAAApB,EAAAA,EAAAA,GAdM,UAA8BC,GACnC,IACE,IAAMG,EAAWX,EAAOQ,GAOxB,OAN0B,IAAtBvB,EAAQ0B,KACV1B,EAAQ0B,SAAkB5B,EAAY6B,eAAe,CACnDzC,KAAMwC,WAGS1B,EAAQ0B,GAAUiB,MAEvC,CAAE,MAAOd,GAEP,MAAO,EACT,CACF,IAACR,MAAA,KAAA7D,UAAA,CAyBM,SAAeoF,IAAmB,OAAAC,EAAAxB,MAAC,KAAD7D,UAAA,CASxC,SAAAqF,IAAA,OAAAA,GAAAvB,EAAAA,EAAAA,GATM,YAEL,GAAIwB,UAAU9C,SACR8C,UAAU9C,QAAQ+C,QAEpB,aAD0BD,UAAU9C,QAAQgD,YAIhD,OAAO,CACT,IAAC3B,MAAA,KAAA7D,UAAA,CAWA,SAAAyF,IAAA,OAAAA,GAAA3B,EAAAA,EAAAA,GATM,YAEL,GAAIwB,UAAU9C,SACR8C,UAAU9C,QAAQ+C,QAEpB,aAD0BD,UAAU9C,QAAQ+C,WACvB,UAAY,SAGrC,MAAO,aACT,IAAC1B,MAAA,KAAA7D,UAAA,C,q/BCpFA,SAAA0F,IAAA,OAAAA,GAAA5B,EAAAA,EAAAA,GA/BM,UAA+B6B,EAAuB3G,GAC3D,IAAMgF,EAAM,KAAKjE,EAAaf,EAAM,gBAG9ByC,EAAgB,GAFRzC,EAAKsB,WACHtB,EAAKuB,aAEfqF,QAAwCtB,EAAU,EAAGN,GAC3D,GAAI4B,EAAiC,CACnC,IAAMC,EAAoCC,KAAKC,MAAMH,GACrDC,EAAkCG,MAAMC,KAAON,EAC/CE,EAAkCK,KAAKzE,IAAUkE,EACjD,IAAMQ,EAAcN,EAAkCK,KAAKzE,GACvD0E,EAAcN,EAAkCG,MAAMI,MACxDP,EAAkCG,MAAMI,IAAMD,GAE5CA,EAAcN,EAAkCG,MAAMK,MACxDR,EAAkCG,MAAMK,IAAMF,SAE1C3C,EAAU,EAAGQ,EAAK8B,KAAKQ,UAAUT,GACzC,KAAO,CACL,IAAMU,EAAyB,CAAC,EAC1BL,EAAO,IAAIM,YAAY,MAC7BN,EAAKzE,IAAUkE,EACfY,EAAuBL,KAAOO,MAAMC,KAAKR,GACzCK,EAAuBP,MAAQ,CAC7BC,IAAKN,EACLS,IAAKT,EACLU,IAAK,GAEPE,EAAuBvH,KAAO,CAACA,EAAKY,cAAeZ,EAAKa,WAAa,EAAGb,EAAKc,iBACvE0D,EAAU,EAAGQ,EAAK8B,KAAKQ,UAAUC,GACzC,CACF,IAAC1C,MAAA,KAAA7D,UAAA,CA+BA,SAAA2G,IAAA,OAAAA,GAAA7C,EAAAA,EAAAA,GA7BM,YACL,IAAM8C,EAAU,IAAIxH,KACpBwH,EAAQrH,SAAS,GACjBqH,EAAQpH,WAAW,GACnBoH,EAAQnH,WAAW,GACnBmH,EAAQlH,gBAAgB,GAGxB,IAFA,IAAMmH,EAAY/H,EAAW8H,GAAS,EAAsB,EAAG,GACzDE,EAAmC,GAChCC,EAAI,EAAGA,GA3Ca,EA2CSA,IAAK,CACzC,IAAM/H,EAAOF,EAAW+H,EAAWE,EAAG,EAAG,GACnC/C,EAAM,KAAKjE,EAAaf,EAAM,gBAC9B4G,QAAwCtB,EAAU,EAAGN,GAC3D,GAAI4B,EAAiC,CACnC,IAAMC,EAAoCC,KAAKC,MAAMH,GACrDkB,EAAOE,KAAKnB,EACd,KAAO,CACL,IAAMoB,EAA2B,CAAC,EAC5Bf,EAAO,IAAIM,YAAY,MAC7BS,EAAyBf,KAAOO,MAAMC,KAAKR,GAC3Ce,EAAyBjB,MAAQ,CAC/BC,IAAK,EACLG,IAAK,EACLC,IAAK,GAEPY,EAAyBjI,KAAO,CAACA,EAAKY,cAAeZ,EAAKa,WAAa,EAAGb,EAAKc,WAC/EgH,EAAOE,KAAKC,EACd,CACF,CACA,OAAOH,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAeA,SAAAkH,IAAA,OAAAA,GAAApD,EAAAA,EAAAA,GAbM,YACL,IAIsBqD,EAFhBC,GAAM,IAAIhI,MAAOuB,UACc0G,EAAAC,QAAlBtC,EAAe,IACZ,IAAtB,IAAAqC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAbzD,EAAGmD,EAAAlD,MACNyD,QAAapD,EAAU,EAAGN,GAC1B2D,EAAS7B,KAAKC,MAAM2B,GAEtBN,EADSlF,EAAyByF,EAAO3I,KAAK,GAAI2I,EAAO3I,KAAK,GAAI2I,EAAO3I,KAAK,IACnE2B,UAPQiH,eAQfjD,EAAa,EAAGX,GAE1B,CAAC,OAAAK,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAkBA,SAAA+H,IAAA,OAAAA,GAAAjE,EAAAA,EAAAA,GAhBM,UAAiCkE,EAAeC,EAAgBC,GACrE,IAAMC,EAAS,IAAIC,OAAO,IAAIC,IAAuD,mBAC/EC,QAhDD,WAAuC,OAAA3B,EAAA9C,MAAC,KAAD7D,UAAA,CAgDTuI,GAanC,aAXqB,IAAIC,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EACAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EACAT,EAAOY,YAAY,CAACT,EAAsBN,EAAOC,EAAQC,GAC3D,EAEF,GAACH,EAAAlE,MAAA,KAAA7D,UAAA,CC1HM,SAASgJ,EAA2BC,EAAcC,EAAcC,EAAcC,GACnF,IACMC,EAAQF,EAAOtI,KAAKyI,GAAM,IAAOL,EAAOpI,KAAKyI,GAAM,IACnDC,EAAQH,EAAOvI,KAAKyI,GAAM,IAAOJ,EAAOrI,KAAKyI,GAAM,IACnDE,EAAI3I,KAAK4I,IAAIJ,EAAO,GAAKxI,KAAK4I,IAAIJ,EAAO,GAAKxI,KAAK6I,IAAKT,EAAOpI,KAAKyI,GAAM,KAAOzI,KAAK6I,IAAKP,EAAOtI,KAAKyI,GAAM,KAAOzI,KAAK4I,IAAIF,EAAO,GAAK1I,KAAK4I,IAAIF,EAAO,GAG/J,OAAW,KAND,UAIA,EAAI1I,KAAK8I,MAAM9I,KAAK+I,KAAKJ,GAAI3I,KAAK+I,KAAK,EAAIJ,KAGvD,CAEO,SAASK,EAAalE,GAI3B,IAHA,IAAMmE,EAAQ,CAAC,QAAS,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC9D/C,EAAI,EAEDpB,GAAiB,KAAQoB,EAAI+C,EAAM7J,OAAS,GACjD0F,GAAiB,IACjBoB,IAGF,MAAO,GAAGlG,KAAKC,MAAsB,IAAhB6E,GAAuB,OAAOmE,EAAM/C,IAC3D,CAEO,SAASgD,EAAuBC,GAErC,IADA,IAAIlD,EAAS,GACNkD,EAAS,GAAG,CACjB,IAAIC,GAAaD,EAAS,GAAK,GAE/BlD,EADa1G,OAAO8J,aAAaD,EAAY,IAC3BnD,EAClBkD,EAASnJ,KAAKC,OAAOkJ,EAAS,GAAK,GACrC,CACA,OAAOlD,CACT,CC/BO,SAASqD,EAAsBC,GACpC,OAAOC,SAASC,cAAcF,EAChC,CAEO,SAASG,EAAyBH,GACvC,OAAOC,SAASG,iBAAiBJ,EACnC,CAEO,SAASK,EAAqBC,EAAsBN,GACzD,OAAOM,EAAQJ,cAAcF,EAC/B,CAEO,SAASO,EAAwBD,EAAsBN,GAC5D,OAAOM,EAAQF,iBAAiBJ,EAClC,CAEO,SAASQ,EAAiBC,EAA+BC,GAI9D,IAHA,IAAMC,EAAW,GACbC,EAAUH,EAAiBI,mBAExBD,GACDA,EAAQE,UAAUC,SAASL,IAC7BC,EAAS/D,KAAKgE,GAEhBA,EAAUA,EAAQC,mBAGpB,OAAOF,CACT,CChBO,SAASK,EAAUC,EAAcC,GAA6E,IAAhEC,EAAoBvL,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAUe,EAAgBf,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,IAC9FwL,EAAS,CAAC,UAAW,WAGrBC,EAAU,CAAC,UAAW,WAAY,UAAW,aAAc,eAAgB,QAAS,YAAa,mBAAoB,aAAc,WAAY,QAAS,OAAQ,gBAAiB,eAAgB,YAAa,oBAC9MC,EAAQC,GAAsB,SACpC,OAAIJ,EACK,0DAA0DC,EAAOH,SAAYI,EAAQH,WAAaM,GAAoB7K,KAEzH2K,EACK,sFAAsFF,EAAOH,SAAYI,EAAQH,WAAaM,GAAoB7K,KAElJ,0CAA0CyK,EAAOH,SAAYI,EAAQH,WAAaM,GAAoB7K,IAGnH,CCzBA,IACI8K,EADAC,EAA6B,CAAC,EAIlC,GAA4B,oBAAjBC,aAA8B,CACvC,IAAMC,EAA0B,IAAID,aAAa,IAAI1D,IAAiD,oBACtGwD,EAAOG,EAAwBH,MAC1BI,OACP,KAAO,CACL,IAAMC,EAAoB,IAAI9D,OAAO,IAAIC,IAAiD,mBAC1FwD,EAAOK,CACT,CA8BC,SAAAC,IAAA,OAAAA,GAAArI,EAAAA,EAAAA,GAdM,UAA2BsI,GAChC,IAAMC,EAASC,KAYf,aAVqB,IAAI9D,QAAQ,SAACC,EAASC,GACzCoD,EAA2BO,GAAU5D,EAErCoD,EAAKhD,QAAU,SAAUhB,GACvBa,EAAOb,EAAEiB,QACX,EAEA+C,EAAK9C,YAAY,CAACqD,EAAQC,GAC5B,EAGF,IAACxI,MAAA,KAAA7D,UAAA,C,q/BA3BD6L,EAAKlD,UAAY,SAAUd,GACzB,IAAA0E,GAAAC,EAAAA,EAAAA,GAAyB3E,EAAE3B,KAAI,GAAxBY,EAAMyF,EAAA,GAAEF,EAAME,EAAA,GACjBT,EAA2BO,KAC7BP,EAA2BO,GAAQvF,UAC5BgF,EAA2BO,GAEtC,EAGAR,EAAKhD,QAAU,SAAUhB,GAEzB,ECXA,IAAM4E,EAAoB,CAAC,EAGrBC,EAAa,IAAIC,MAAM,cAEtB,SAAeC,EAASC,EAAApJ,EAAAC,EAAAC,GAAA,OAAAmJ,EAAAjJ,MAAC,KAAD7D,UAAA,CAgH9B,SAAA8M,IAAA,OAAAA,GAAAhJ,EAAAA,EAAAA,GAhHM,UAAyBiJ,EAAaC,EAAmBC,EAAaC,GAE3E,GAAIT,EAAMU,eAAeJ,GAAM,CAC7B,GAAIN,EAAMM,GAAKK,WACb,aAAa,IAAI5E,QAAQ,SAACC,EAASC,GACjC+D,EAAMM,GAAKM,SAASrG,KAAK,CAACyB,EAASC,EAAQsE,EAAWC,GACxD,GACK,GAA0B,OAAtBR,EAAMM,GAAKjG,SAAmB,IAAI1H,MAAOuB,WAAa8L,EAAMM,GAAKO,UAE1E,OADAC,GAAyBP,EAAWC,EAAK,GAAG,GACrCR,EAAMM,GAAKjG,MAEtB,MACE2F,EAAMM,GAAO,CACXK,YAAY,EACZC,SAAU,GACVG,QAAQ,EACRF,WAAY,EACZxG,OAAQ,MAKZ,IAAM2G,QAAiBC,MAAMX,GAC7B,IAAKU,EAASE,GAEZ,MADAJ,GAAyBP,EAAWC,EAAK,GAAG,GACtC,IAAIN,MAAM,uBAAuBc,EAASG,UAQlD,IAJA,IAAMjI,EAAgB5D,SAAS3B,OAAOqN,EAASI,QAAQC,IAAI,oBACrDC,EAASN,EAASO,KAAKC,YACvBC,EAAS,GACXC,EAAiB,IACR,CACX,IAAAC,QAA8BL,EAAOM,OAA7B5G,EAAI2G,EAAJ3G,KAAMxD,EAAKmK,EAALnK,MACd,GAAIwD,EACF,MAEFyG,EAAOlH,KAAK/C,GAEZ,IAAMqK,GADNH,GAAkBlK,EAAMhE,QACU0F,EAElC,GADA4H,GAAyBP,EAAWC,EAAKqB,GAAU,GAC/C7B,EAAMU,eAAeJ,GAAM,KACY5F,EADZE,EAAAC,EACPmF,EAAMM,GAAKM,UAAQ,IAAzC,IAAAhG,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAA2C,KAAhC8G,EAAOpH,EAAAlD,MAChBsJ,GAAyBgB,EAAQ,GAAIA,EAAQ,GAAID,GAAU,EAC7D,CAAC,OAAAjK,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,CACF,CAKA,IAFA,IAAM0G,EAAa,IAAIC,WAAWN,GAC9BO,EAAW,EACfC,EAAA,EAAAC,EAAoBV,EAAMS,EAAAC,EAAA3O,OAAA0O,IAAE,CAAvB,IAAME,EAAKD,EAAAD,GACdH,EAAWM,IAAID,EAAOH,GACtBA,GAAYG,EAAM5O,MACpB,CAGA,IAII6G,EAJEiI,EAAO,IAAIC,KAAK,CAACR,GAAa,CAAES,KAAM,qBACtCC,QAAoBH,EAAKG,cACzBC,QDpDD,SAA0BtC,GAAA,OAAAV,EAAAtI,MAAC,KAAD7D,UAAA,CCoDJoP,CAAYF,GAGvC,OAAQhC,GACN,IAAK,OAEDpG,EADE,mBAAmBuI,KAAKF,SACXvC,EAAUG,EAAIuC,QAAQ,0CAA2C,4DAA6DtC,EAAWC,EAAKC,GAEpJpH,KAAKC,MAAMoJ,GAEtB,MACF,IAAK,MACHrI,EAASqI,EAOb,IAAM/H,EAAM,IAAIhI,KAGhB,SL5EK,SAA8ByN,EAAApJ,GAAA,OAAAiC,EAAA7B,MAAC,KAAD7D,UAAA,CK0E7BuP,CAAgB5J,EAAeyB,GAEjCN,EAAQ,CAEV,GAAI2F,EAAMU,eAAeJ,GAAM,CAG7B,IAFA,IAAMuB,EAAWH,EAAiBxI,EAC9B4I,EAAU9B,EAAMM,GAAKM,SAASmC,QAC3BjB,GACLA,EAAQ,GAAGzH,GACXyG,GAAyBgB,EAAQ,GAAIA,EAAQ,GAAID,GAAU,GAC3DC,EAAU9B,EAAMM,GAAKM,SAASmC,QAEhC/C,EAAMM,GAAKjG,OAASA,EACpB2F,EAAMM,GAAKO,UAAYlG,EAAIzG,UAhGrB,IAiGN8L,EAAMM,GAAKK,YAAa,CAC1B,CAEA,OADAqC,KACO3I,CACT,CAEE,GAAI2F,EAAMU,eAAeJ,GAAM,CAE7B,IADA,IAAIwB,EAAU9B,EAAMM,GAAKM,SAASmC,QAC3BjB,GACLA,EAAQ,GAAG7B,GACXa,GAAyBgB,EAAQ,GAAIA,EAAQ,GAAI,GAAG,GACpDA,EAAU9B,EAAMM,GAAKM,SAASmC,QAEhC/C,EAAMM,GAAKS,QAAS,CACtB,CAEA,MADAiC,KACM/C,CAEV,GAACI,EAAAjJ,MAAA,KAAA7D,UAAA,CAED,SAASyP,KACP,IAAMrI,GAAM,IAAIhI,MAAOuB,UACvB,IAAK,IAAMoM,KAAON,EAChB,GAAIA,EAAMU,eAAeJ,GAAM,CAC7B,IAAKN,EAAMM,GAAKK,YACVhG,EAAMqF,EAAMM,GAAKO,UAAW,QACvBb,EAAMM,GACb,QACF,CAEF,GAAIN,EAAMM,GAAKS,OAAQ,QACdf,EAAMM,GACb,QACF,CACF,CAEJ,CAYA,IAAM2C,GAA+C,CAAC,EAE/C,SAASnC,GAAyBP,EAAmBC,EAAaqB,EAAkBqB,GACpFD,GAAsBvC,eAAeH,KACxC0C,GAAsB1C,GAAa,CAAC,GAElC0C,GAAsB1C,GAAWG,eAAeF,IAC9C0C,EACFD,GAAsB1C,GAAWC,GAAK0C,OAAQ,GAE9CD,GAAsB1C,GAAWC,GAAK0C,OAAQ,EAC9CD,GAAsB1C,GAAWC,GAAKqB,SAAWA,GAEnDsB,GAA+B5C,EAAW,SAE1C0C,GAAsB1C,GAAWC,GAAO,CAAE0C,OAAO,EAAOrB,SAAUA,EAAUuB,MAAO,GACnFD,GAA+B5C,EAAW,SAE9C,CAEO,SAAS8C,GAAyB9C,GACvC,GAAI0C,GAAsBvC,eAAeH,IACS,YAA5C+C,EAAAA,EAAAA,GAAOL,GAAsB1C,IAAyB,CACxD,IAAI6C,EAAgB,EAChBG,EAAmB,EACvB,IAAK,IAAMhM,KAAO0L,GAAsB1C,GACjC0C,GAAsB1C,GAAWhJ,GAAK2L,QACzCE,GAASH,GAAsB1C,GAAWhJ,GAAK6L,MAC/CG,GAAYN,GAAsB1C,GAAWhJ,GAAKsK,UAGtD,IAAMA,EAAWzN,KAAKwF,IAAIxF,KAAKuF,IAAI4J,EAAWH,EAAO,GAAI,GACzD,OAAOvB,IAAa2B,KAAYC,MAAM5B,GAAY,EAAIA,CACxD,CAEF,OAAO,CACT,CAEO,SAAS6B,GAA4BnD,GACtC0C,GAAsBvC,eAAeH,YAChC0C,GAAsB1C,GAC7B4C,GAA+B5C,EAAW,OAE9C,CAUO,SAAS4C,GAA+B5C,EAAmBoD,GAChE,IAAMC,EAA4C,CAChDC,OAAQtD,EACRoD,MAAOA,EACP9B,SAAUwB,GAAyB9C,IAE/BuD,EAAQ,IAAIC,YAAYxD,EAAW,CAAEyD,OAAQJ,IACnDhG,SAASqG,cAAcH,EACzB,CAIO,IAAMI,GAAiC,CAAC,EAExC,SAASC,GAAkB5D,EAAmBM,GAC9CqD,GAAexD,eAAeH,KACjC2D,GAAe3D,GAAa,GAE9B,IAAI6D,EAAa,EACQ,iBAAdvD,IACTuD,EPhNG,SAA2BC,GAChC,IACMC,EAAQD,EAAOC,MADP,cAEd,GAAIA,EAAO,CACT,IAAM5O,EAAOJ,SAASgP,EAAM,IACtB3O,EAAQL,SAASgP,EAAM,IACvB/R,EAAO+C,SAASgP,EAAM,IACtB9R,EAAQ8C,SAASgP,EAAM,IACvB7R,EAAU6C,SAASgP,EAAM,IACzBnQ,EAAUmB,SAASgP,EAAM,KACzBC,EAAc,IAAI5R,KASxB,OARA4R,EAAY3R,QAAQ,GACpB2R,EAAY1R,SAAS,GACrB0R,EAAYrR,YAAYwC,GACxB6O,EAAY1R,SAAS8C,EAAQ,GAC7B4O,EAAY3R,QAAQL,GACpBgS,EAAYzR,SAASN,GACrB+R,EAAYxR,WAAWN,GACvB8R,EAAYvR,WAAWmB,GAChBoQ,EAAYrQ,SACrB,CACA,OAAO,CACT,CO0LiBsQ,CAAkB3D,IAE7BuD,EAAaF,GAAe3D,KAC9B2D,GAAe3D,GAAa6D,EAEhC,CAEO,SAASK,GAAkBlE,GAChC,OAAI2D,GAAexD,eAAeH,GACG,EAA5B2D,GAAe3D,GAEf,CAEX,CAEO,SAASmE,GAAqBnE,GAC/B2D,GAAexD,eAAeH,WACzB2D,GAAe3D,EAE1B,C,y/BCzOO,SAAeoE,GAAUvE,GAAA,OAAAwE,GAAAxN,MAAC,KAAD7D,UAAA,CAY/B,SAAAqR,KAAA,OAAAA,IAAAvN,EAAAA,EAAAA,GAZM,UAA0BkJ,GAC/B,IAKsB7F,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,GACJ,CAAC,EAAG,IACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,cAAc1B,EAAIzD,EAAE,KAAM,QAC3Ef,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,C,y/BCdM,SAAe0R,GAAW7E,GAAA,OAAA8E,GAAA9N,MAAC,KAAD7D,UAAA,CAYhC,SAAA2R,KAAA,OAAAA,IAAA7N,EAAAA,EAAAA,GAZM,UAA2BkJ,GAChC,IAKsB7F,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,GACJ,CAAC,EAAG,IACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,eAAe1B,EAAIzD,EAAE,KAAM,QAC5Ef,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,C,y/BCLD,IAAM4R,GAA0B,CAC9BC,IAAK,CACH3L,KAAM,GACN4L,WAAW,GAEbC,WAAY,CACV7L,KAAM,CAAC,EACP4L,WAAW,IAEb,SAEaE,GAAenF,GAAA,OAAAoF,GAAApO,MAAC,KAAD7D,UAAA,UAAAiS,KAmB7B,OAnB6BA,IAAAnO,EAAAA,EAAAA,GAA9B,UAA+BoO,GAC7B,IAAM/J,EAAS,IAAIC,OAAO,IAAIC,IAAqD,mBAiBnF,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAYmJ,EACrB,EAGF,IAACrO,MAAA,KAAA7D,UAAA,CAEM,SAAemS,GAAU1O,GAAA,OAAA2O,GAAAvO,MAAC,KAAD7D,UAAA,CA0D/B,SAAAoS,KAAA,OAAAA,IAAAtO,EAAAA,EAAAA,GA1DM,UAA0BkJ,GAAsF,IAAnE+E,EAAmB/R,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAQ,SAC9DqS,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,GACJ,CAAC,EAAG,IACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,cAAc1B,EAAIzD,EAAE,KAAM,QAC3Ef,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IAAMuS,EAAYR,EAAa,aAAe,MACxCS,EAAW,OAAOD,mBAElBE,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IACIC,EADE5L,QAAeuL,IAarB,OAVEK,EADEX,QACkBC,GAAgBlL,GAEtBA,QAEVtD,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUoM,IACvCd,GAAwBW,GAAWT,YACtCF,GAAwBW,GAAWT,WAAY,EAC/CF,GAAwBW,GAAWrM,KAAOwM,GAErCA,CACT,CACE,IAAI,IAAItT,MAAOuB,UAAYoB,SAAS0Q,GAlBd,OAkBiD,CACrE,IACIC,EADE5L,QAAeuL,IASrB,OANEK,EADEX,QACkBC,GAAgBlL,GAEtBA,QAEVtD,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUoM,IACrCA,CACT,CACE,IAAKd,GAAwBW,GAAWT,UAAW,CACjD,IAAMa,QAAcrO,EAAU,EAAGkO,GACjCZ,GAAwBW,GAAWT,WAAY,EAC/CF,GAAwBW,GAAWrM,KAAOJ,KAAKC,MAAM4M,EACvD,CAIA,OAHApF,GAAyBP,EAAW,eAAgB,GAAG,GACvDO,GAAyBP,EAAW,eAAgB,GAAG,GACvD4D,GAAkB5D,GAAY,GACvB4E,GAAwBW,GAAWrM,IAGhD,GAACkM,GAAAvO,MAAA,KAAA7D,UAAA,C,y/BCxDD,IAAM4S,GAA2B,CAC/Bb,WAAY,CACVD,WAAW,EACX5L,KAAM,CAAC,GAET2M,OAAQ,CACNf,WAAW,EACX5L,KAAM,CAAC,GAET4M,QAAS,CACPhB,WAAW,EACX5L,KAAM,CAAC,IAET,SAEa6M,GAAgBlG,GAAA,OAAAmG,GAAAnP,MAAC,KAAD7D,UAAA,UAAAgT,KAmB9B,OAnB8BA,IAAAlP,EAAAA,EAAAA,GAA/B,UAAgCmP,GAC9B,IAAM9K,EAAS,IAAIC,OAAO,IAAIC,IAAsD,mBAiBpF,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAYkK,EACrB,EAGF,IAACpP,MAAA,KAAA7D,UAAA,UAEckT,GAAmBzP,GAAA,OAAA0P,GAAAtP,MAAC,KAAD7D,UAAA,UAAAmT,KAmBjC,OAnBiCA,IAAArP,EAAAA,EAAAA,GAAlC,UAAmC6D,GACjC,IAAMQ,EAAS,IAAIC,OAAO,IAAIC,IAAyD,mBAiBvF,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAYpB,EACrB,EAGF,IAAC9D,MAAA,KAAA7D,UAAA,UAEcoT,GAAsB1P,GAAA,OAAA2P,GAAAxP,MAAC,KAAD7D,UAAA,CAqBrC,SAAAqT,KAFC,OAEDA,IAAAvP,EAAAA,EAAAA,GArBA,UAAsC6D,GACpC,IAAMQ,EAAS,IAAIC,OAAO,IAAIC,IAA4D,mBAiB1F,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAYpB,EACrB,EAGF,IAAC9D,MAAA,KAAA7D,UAAA,CASM,SAAesT,GAAW3P,EAAAY,GAAA,OAAAgP,GAAA1P,MAAC,KAAD7D,UAAA,CAgGhC,SAAAuT,KAAA,OAAAA,IAAAzP,EAAAA,EAAAA,GAhGM,UAA2BkJ,EAAmBiC,GAAiF,SACrHoD,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,IACJ,CAAC,EAAG,KACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,eAAe1B,EAAIzD,EAAE,KAAM,QAC5Ef,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMuS,EAAY,CAAC,aAAc,SAAU,WAAWtD,GAChDuD,EAAW,OAAOD,mBAClBE,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAIC,EACJ,OAAQzD,GACN,KAAK,EACH,IAAMnI,QAAeuL,IAErBK,QADgCK,GAAiBjM,GAEjD,MAEF,KAAK,EACH,IAAM0M,QAA0BF,GAAYtG,EAAW,GAEvD0F,QAD4BQ,GAAoBM,GAEhD,MAEF,KAAK,EACH,IAAMC,QAAsBH,GAAYtG,EAAW,GAEnD0F,QAD6BU,GAAuBK,GAcxD,aANMjQ,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUoM,IACvCE,GAAyBL,GAAWT,YACvCc,GAAyBL,GAAWT,WAAY,EAChDc,GAAyBL,GAAWrM,KAAOwM,GAEtCA,CACT,CACE,IAAI,IAAItT,MAAOuB,UAAYoB,SAAS0Q,GArCd,OAqCiD,CACrE,IAAIC,EACJ,OAAQzD,GACN,KAAK,EACH,IAAMnI,QAAeuL,IAErBK,QADgCK,GAAiBjM,GAEjD,MAEF,KAAK,EACH,IAAM0M,QAA0BF,GAAYtG,EAAW,GAEvD0F,QAD4BQ,GAAoBM,GAEhD,MAEF,KAAK,EACH,IAAMC,QAAsBH,GAAYtG,EAAW,GAEnD0F,QAD6BU,GAAuBK,GAcxD,aANMjQ,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUoM,IACvCE,GAAyBL,GAAWT,YACvCc,GAAyBL,GAAWT,WAAY,EAChDc,GAAyBL,GAAWrM,KAAOwM,GAEtCA,CACT,CACE,IAAKE,GAAyBL,GAAWT,UAAW,CAClD,IAAMa,QAAcrO,EAAU,EAAGkO,GACjCI,GAAyBL,GAAWT,WAAY,EAChDc,GAAyBL,GAAWrM,KAAOJ,KAAKC,MAAM4M,EACxD,CAIA,OAHApF,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,gBAAiB,GAAG,GACxD4D,GAAkB5D,GAAY,GACvB4F,GAAyBL,GAAWrM,IAGjD,GAACqN,GAAA1P,MAAA,KAAA7D,UAAA,C,y/BCnND,IAAI0T,IAA0C,EAC1CC,GAA4C,CAAC,EAAE,SAEpCC,GAAY/G,GAAA,OAAAgH,GAAAhQ,MAAC,KAAD7D,UAAA,UAAA6T,KAmB1B,OAnB0BA,IAAA/P,EAAAA,EAAAA,GAA3B,UAA4BgQ,GAC1B,IAAM3L,EAAS,IAAIC,OAAO,IAAIC,IAAkD,mBAiBhF,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAY+K,EACrB,EAGF,IAACjQ,MAAA,KAAA7D,UAAA,CAEM,SAAe+T,GAAOtQ,GAAA,OAAAuQ,GAAAnQ,MAAC,KAAD7D,UAAA,CA+C5B,SAAAgU,KAAA,OAAAA,IAAAlQ,EAAAA,EAAAA,GA/CM,UAAuBkJ,GAA4C,SACzDqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,IACJ,CAAC,EAAG,KACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,WAAW1B,EAAIzD,EAAE,KAAM,QACxEf,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMwS,EAAW,iBACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IACfmB,QAA0BI,GAAa9M,GAO7C,aANMtD,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUkN,IACvCE,KACHA,IAAiC,EACjCC,GAA4BH,GAEvBA,CACT,CACE,IAAI,IAAIpU,MAAOuB,UAAYoB,SAAS0Q,GAdd,OAciD,CACrE,IAAM3L,QAAeuL,IACfmB,QAA0BI,GAAa9M,GAG7C,aAFMtD,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUkN,IACrCA,CACT,CACE,IAAKE,GAAgC,CACnC,IAAMf,QAAcrO,EAAU,EAAGkO,GACjCkB,IAAiC,EACjCC,GAA4B7N,KAAKC,MAAM4M,EACzC,CAIA,OAHApF,GAAyBP,EAAW,YAAa,GAAG,GACpDO,GAAyBP,EAAW,YAAa,GAAG,GACpD4D,GAAkB5D,GAAY,GACvB2G,EAGb,GAACK,GAAAnQ,MAAA,KAAA7D,UAAA,C,y/BC3FM,SAASiU,GAAkBC,EAAsBjT,GACtD,GAA4B,iBAAjBiT,EAA2B,CACpC,IAAMxT,EAAOqB,SAASmS,GACtB,IAAc,IAAVxT,EACF,MAAO,CAAEkB,KAAM,EAAGuS,KAAM,OAAQzT,KAAAA,GAElC,IAAc,IAAVA,EACF,MAAO,CAAEkB,KAAM,EAAGuS,KAAM,OAAQzT,KAAAA,GAElC,IAAc,IAAVA,EACF,MAAO,CAAEkB,KAAM,EAAGuS,KAAM,OAAQzT,KAAAA,GAElC,IAAc,IAAVA,EACF,MAAO,CAAEkB,KAAM,EAAGuS,KAAM,MAAOzT,KAAAA,GAEjC,GAAI,GAAKA,GAAQA,GAAQ,GACvB,MAAO,CAAEkB,KAAM,EAAGuS,KAAM,MAAOzT,KAAAA,GAEjC,GAAI,GAAKA,GAAQA,GAAQ,IACvB,MAAO,CAAEkB,KAAM,EAAGuS,KAAMnT,EAAWN,EAAMO,GAAOP,KAAAA,GAElD,GAAI,IAAMA,GAAQA,GAAQ,IACxB,MAAO,CAAEkB,KAAM,GAAKuS,KAAMnT,EAAWN,EAAMO,GAAOP,KAAAA,GAEpD,GAAI,IAAMA,EACR,MAAO,CAAEkB,KAAM,EAAGuS,KAAMnT,EAAWN,EAAMO,GAAOP,KAAAA,EAEpD,CACA,MAAO,CAAEkB,KAAM,EAAGuS,KAAM,OAAQzT,MAAO,EACzC,CAqBO,SAAS0T,GAAcxS,EAAcX,GAC1C,IAAMoT,EAAazS,EAAK3B,OACxB,GAAa,IAATgB,EAAY,CACd,IAAIhC,EAAQ,EACRC,EAAU,EAQd,OAPmB,IAAfmV,IACFpV,EAAQ8C,SAASH,EAAK0S,UAAU,EAAG,IACnCpV,EAAU6C,SAASH,EAAK0S,UAAU,EAAG,KAEpB,IAAfD,IACFnV,EAAU6C,SAASH,IAEd,CACLqN,KAAM,SACNhQ,MAAOA,EACPC,QAASA,EAEb,CACA,GAAa,IAAT+B,EAAY,CACd,IAAIoF,EAAM,EACND,EAAM,EACV,GAAmB,IAAfiO,EAAkB,CACpB,IAAME,EAAUxS,SAASH,EAAK0S,UAAU,EAAG,IACrCE,EAAUzS,SAASH,EAAK0S,UAAU,EAAG,IAC3CjO,EAAMxF,KAAKwF,IAAIkO,EAASC,GACxBpO,EAAMvF,KAAKuF,IAAImO,EAASC,EAC1B,CACA,GAAmB,IAAfH,EAAkB,CACpB,IAAMrK,EAASjI,SAASH,GACxByE,EAAM2D,EACN5D,EAAM4D,CACR,CACA,MAAO,CACLiF,KAAM,QACN5I,IAAKA,EACLD,IAAKA,EAET,CACF,CA0KO,SAASqO,GAAaC,GAC3B,IAAIzF,EAAO,GACX,OAAQyF,GACN,IAAK,IACHzF,EAAO,KACP,MACF,IAAK,IACHA,EAAO,MACP,MACF,IAAK,IACHA,EAAO,QACP,MACF,IAAK,IACHA,EAAO,SACP,MACF,QACEA,EAAO,OAEX,OAAOA,CACT,CAEO,SAAS0F,GAAeC,GAC7B,IAAIC,EAAS,GACb,OAAQD,GACN,IAAK,IACHC,EAAS,KACT,MACF,IAAK,IACHA,EAAS,KACT,MACF,QACEA,EAAS,OAEb,OAAOA,CACT,CAEO,SAASC,GAAeC,GAC7B,IAAIC,EAAY,GAChB,OAAQD,GACN,IAAK,IACHC,EAAY,KACZ,MACF,IAAK,IACHA,EAAY,KACZ,MACF,IAAK,IACHA,EAAY,KACZ,MACF,IAAK,IACHA,EAAY,KACZ,MACF,IAAK,IACHA,EAAY,OACZ,MACF,IAAK,IACHA,EAAY,KACZ,MACF,IAAK,KACHA,EAAY,QACZ,MACF,QACEA,EAAY,OAEhB,OAAOA,CACT,CAYO,SAASC,GAAUC,GACxB,IAAMpO,EAAS,CAAC,EAGVmI,EAAOwF,GADGS,EAAcR,SAE9B5N,EAAOmI,KAAOA,EAEd,IACM4F,EAASF,GADGO,EAAcN,WAI1BI,EAAYF,GADAI,EAAcH,WAahC,OAVAjO,EAAOqO,UAAYD,EAAcE,MACjCtO,EAAO8G,OAAS,CACdiH,OAAQA,EACRG,UAAWA,EACXb,KAAM,GAAGU,OAAYG,KAEvBlO,EAAOuO,UAAYH,EAAcG,UACjCvO,EAAOwO,YAAcJ,EAAcI,YACnCxO,EAAOrF,MAAQyT,EAAczT,MAC7BqF,EAAO4H,SAAWwG,EAAcxG,SACzB5H,CACT,C,y/BClVO,SAASyO,GAAkBC,GAChC,IAAK,IAAIzO,EAAI,EAAGA,EAAIyO,EAAIvV,OAAQ8G,IAC9B,IAAK,IAAI0O,EAAI1O,EAAI,EAAG0O,EAAID,EAAIvV,OAAQwV,IAClC,GAAID,EAAIzO,KAAOyO,EAAIC,GACjB,OAAO,EAIb,OAAO,CACT,CASO,SAASC,GAAgBC,EAAeC,GAC7C,IAAI9O,EAAS,GACb,GAAI6O,EAAO1V,QAAU2V,EAAO3V,OAAQ,KACTkH,EADSE,EAAAC,GACfqO,GAAM,IAAzB,IAAAtO,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAA2B,KAAhBoO,EAAI1O,EAAAlD,MACT2R,EAAOE,QAAQD,IAAS,GAC1B/O,EAAOE,KAAK6O,EAEhB,CAAC,OAAAxR,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,KAAO,KACoBiO,EADpBC,EAAA1O,GACcsO,GAAM,IAAzB,IAAAI,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAA2B,KAAhBoO,EAAIE,EAAA9R,MACT0R,EAAOG,QAAQD,IAAS,GAC1B/O,EAAOE,KAAK6O,EAEhB,CAAC,OAAAxR,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACH,CACA,OAAOhB,CACT,CC/DO,SAASmP,GAAYnF,GAAuD,IAAvCoF,IAAelW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACrD8G,EAAS,GACb,GAAsB,iBAAXgK,EAET,IADA,IAAMqF,EAAerF,EAAO7Q,OACnB8G,EAAI,EAAGA,EAAIoP,EAAcpP,IAAK,CACrC,IAAMqP,EAAUtF,EAAOuF,WAAWtP,IAC9BD,EAAOgP,QAAQM,GAAW,IAAMF,IAClCpP,EAAOE,KAAKoP,EAEhB,CAEF,OAAOtP,CACT,CAEO,SAASwP,GAAuBxF,GAErC,QADc,wBACJzB,KAAKyB,EAKjB,C,y/BCsCA,IAAIyF,IAA2C,EAC3CC,GAAqC,CAAC,EAAE,SAE7BC,GAAa5J,GAAA,OAAA6J,GAAA7S,MAAC,KAAD7D,UAAA,UAAA0W,KAmB3B,OAnB2BA,IAAA5S,EAAAA,EAAAA,GAA5B,UAA6B6S,GAC3B,IAAMxO,EAAS,IAAIC,OAAO,IAAIC,IAAmD,kBAiBjF,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAY4N,EACrB,EAGF,IAAC9S,MAAA,KAAA7D,UAAA,CAEM,SAAe4W,GAAQnT,GAAA,OAAAoT,GAAAhT,MAAC,KAAD7D,UAAA,CAqD7B,SAAA6W,KAAA,OAAAA,IAAA/S,EAAAA,EAAAA,GArDM,UAAwBkJ,GAA2C,SACzDqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,IACJ,CAAC,EAAG,KACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,YAAY1B,EAAIzD,EAAE,KAAM,QACzEf,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CACD,IAAiB,OAdgDA,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,IAe/D,aAAaqS,IAEf,IACMG,EAAW,kBACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IACfmB,QAA0BiD,GAAc3P,GAO9C,aANMtD,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUkN,IACvC+C,KACHA,IAAkC,EAClCC,GAA6BhD,GAExBA,CACT,CACE,IAAI,IAAIpU,MAAOuB,UAAYoB,SAAS0Q,GAdd,MAciD,CACrE,IAAM3L,QAAeuL,IACfmB,QAA0BiD,GAAc3P,GAO9C,aANMtD,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUkN,IACvC+C,KACHA,IAAkC,EAClCC,GAA6BhD,GAExBA,CACT,CACE,IAAK+C,GAAiC,CACpC,IAAM5D,QAAcrO,EAAU,EAAGkO,GACjC+D,IAAkC,EAClCC,GAA6B1Q,KAAKC,MAAM4M,EAC1C,CAIA,OAHApF,GAAyBP,EAAW,aAAc,GAAG,GACrDO,GAAyBP,EAAW,aAAc,GAAG,GACrD4D,GAAkB5D,GAAY,GACvBwJ,EAGb,GAACK,GAAAhT,MAAA,KAAA7D,UAAA,C,y/BCrHA,SAAA8W,KAAA,OAAAA,IAAAhT,EAAAA,EAAAA,GAbM,UAAiCiT,GACtC,IAAM/J,EAAYV,KACZqK,QAAeC,GAAS5J,GAAW,GACrClG,EAAqC,GACzC,IAAK,IAAM9C,KAAO2S,EAAO,CACvB,IAAMK,EAAYL,EAAM3S,GACpB5D,OAAO4W,EAAUxP,GAAGsO,QAAQiB,IAAU,GACxCjQ,EAAOE,KAAKgQ,EAEhB,CAGA,OAFA7G,GAA4BnD,GAC5BmE,GAAqBnE,GACdlG,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAEM,SAAeiX,GAAoBxT,GAAA,OAAAyT,GAAArT,MAAC,KAAD7D,UAAA,CAYzC,SAAAkX,KAAA,OAAAA,IAAApT,EAAAA,EAAAA,GAZM,UAAoCqT,GACzC,IAEIrQ,EAFEkG,EAAYV,KACZqK,QAAeC,GAAS5J,GAAW,GAEnCoK,EAAW,KAAKD,IACtB,QAAKR,EAAMxJ,eAAeiK,KAG1BtQ,EAAS6P,EAAMS,GACfjH,GAA4BnD,GAC5BmE,GAAqBnE,GACdlG,EACT,IAACjD,MAAA,KAAA7D,UAAA,CAeA,SAAAqX,KAAA,OAAAA,IAAAvT,EAAAA,EAAAA,GAbM,UAA4CwT,GACjD,IAAMtK,EAAYV,KACZqK,QAAeC,GAAS5J,GAAW,GACrClG,EAAqC,GACzC,IAAK,IAAM9C,KAAO2S,EAAO,CACvB,IAAMK,EAAYL,EAAM3S,GACpB5D,OAAO4W,EAAUO,KAAKzB,QAAQwB,IAAoB,GACpDxQ,EAAOE,KAAKgQ,EAEhB,CAGA,OAFA7G,GAA4BnD,GAC5BmE,GAAqBnE,GACdlG,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAuBD,IAAIwX,GAA2B,CAAC,EAC5BC,GAAgC,GAChCC,IAAyB,EAkG5B,SAAAC,KAAA,OAAAA,IAAA7T,EAAAA,EAAAA,GAhGM,YACL,IAAI4T,GAAJ,CAIA,IAAM1K,EAAYV,KACZqK,QAAeC,GAAS5J,GAAW,GACnC4K,QAAwBtE,GAAYtG,EAAW,GAC/CkF,QAAiBC,GAAWnF,GAAW,GAC7CmD,GAA4BnD,GAC5BmE,GAAqBnE,GAErB,IAAIvL,EAAqB,CAAC,EACtBoW,EAA0B,GAC1B9Q,EAAY,EAChB,IAAK,IAAM/C,KAAO2S,EAAO,CACvB,IAAMK,EAAYL,EAAM3S,GAClB8T,EAAW,CACfC,GAAIf,EAAUe,GACdR,IAAKP,EAAUO,IACfS,IAAKhB,EAAUgB,IACfC,IAAKjB,EAAUiB,IACfzQ,EAAGwP,EAAUxP,EACb0Q,KAAM,GACNC,GAAI,GACJC,GAAI,GACJC,EAAG,GACH9Q,EAAG,GACH0H,KAAM,GAER4I,EAAK7Q,KAAK8Q,GACV,IAC8BQ,EAD8FC,EAAAjR,GAA3G2O,GAAY,GAAG6B,EAAStQ,EAAEgR,gBAAgBV,EAASE,IAAIQ,gBAAgBV,EAASG,IAAIO,iBAAiB,IACxF,IAA9B,IAAAD,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAAgC,KACxBzD,EAAM,KADIsU,EAAArU,QAEXxC,EAAM0L,eAAenJ,KACxBvC,EAAMuC,GAAO,IAEfvC,EAAMuC,GAAKgD,KAAKD,EAClB,CAAC,OAAA1C,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CACDf,GAAK,CACP,CACA,IAAK,IAAM/C,KAAO4T,EAAgB,CAChC,IAAMa,EAAeb,EAAe5T,GAC9B8T,EAAW,CACfC,GAAIU,EAAaV,GACjBvQ,EAAGiR,EAAajR,EAChB2Q,GAAIM,EAAaN,GACjBC,GAAIK,EAAaL,GACjBC,EAAGI,EAAaJ,EAChB9Q,EAAGkR,EAAalR,EAChB2Q,KAAMO,EAAaP,KACnBF,IAAK,GACLC,IAAK,GACLV,IAAK,GACLtI,KAAM,GAER4I,EAAK7Q,KAAK8Q,GACV,IAC8BY,EAD+BC,EAAArR,GAA5C2O,GAAY6B,EAAStQ,EAAEgR,eAAe,IACzB,IAA9B,IAAAG,EAAApR,MAAAmR,EAAAC,EAAAnR,KAAAC,MAAgC,KACxBzD,EAAM,KADI0U,EAAAzU,QAEXxC,EAAM0L,eAAenJ,KACxBvC,EAAMuC,GAAO,IAEfvC,EAAMuC,GAAKgD,KAAKD,EAClB,CAAC,OAAA1C,GAAAsU,EAAA9Q,EAAAxD,EAAA,SAAAsU,EAAA7Q,GAAA,CACDf,GAAK,CACP,CACA,IAAK,IAAM/C,KAAOkO,EAAS,CACzB,IAAM0G,EAAc1G,EAAQlO,GACtB8T,EAAW,CACfC,GAAIa,EAAYC,MAChBtB,IAAK,GACLS,IAAK,GACLC,IAAK,GACLzQ,EAAGoR,EAAYE,OACfZ,KAAM,GACNC,GAAI,GACJC,GAAI,GACJC,EAAG,GACH9Q,EAAG,GACH0H,KAAM,GAER4I,EAAK7Q,KAAK8Q,GACV,IAC8BiB,EAD+BC,EAAA1R,GAA5C2O,GAAY6B,EAAStQ,EAAEgR,eAAe,IACzB,IAA9B,IAAAQ,EAAAzR,MAAAwR,EAAAC,EAAAxR,KAAAC,MAAgC,KACxBzD,EAAM,KADI+U,EAAA9U,QAEXxC,EAAM0L,eAAenJ,KACxBvC,EAAMuC,GAAO,IAEfvC,EAAMuC,GAAKgD,KAAKD,EAClB,CAAC,OAAA1C,GAAA2U,EAAAnR,EAAAxD,EAAA,SAAA2U,EAAAlR,GAAA,CACDf,GAAK,CACP,CACAyQ,GAAc/V,EACdgW,GAAaI,EACbH,IAAgB,CA5FhB,CA6FF,IAAC7T,MAAA,KAAA7D,UAAA,CAED,SAASiZ,GAA2BC,EAA8BC,GAIhE,IAEoChS,EAFhCiS,EAAQ,EACRrS,EAAI,EAAEM,EAAAC,GACY6R,GAAc,IAApC,IAAA9R,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAsC,KAA3B2O,EAAOjP,EAAAlD,MAEhBmV,GADuBF,EAAcpD,QAAQM,EAASrP,GAC5BA,EAC1BA,GAAK,CACP,CAAC,OAAA1C,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAID,OAHIoR,IAAkBC,IACpBC,EAA0B,GAAlBvY,KAAKwY,IAAID,IAEZA,CACT,C,y/BCtDC,SAAAE,KAAA,OAAAA,IAAAxV,EAAAA,EAAAA,GApHM,UAA4BiU,EAA0B/K,GAC3D,IAAMuM,EAAS,KAAKxB,IACd7F,QAAgBC,GAAWnF,GAAW,GACtCwM,QAAgBpI,GAAWpE,GAC3ByM,QAAiB/H,GAAY1E,GAC7B0M,QAAa3F,GAAQ/G,GACrBiG,QAAkBK,GAAYtG,EAAW,GAE3ClG,EAAwB,CAC1B6S,WAAY,GACZC,aAAc,IAIZC,EAAU,CAAC,EACf,IAAI3H,EAAQ/E,eAAeoM,GAGzB,OAAOzS,EAGT,IAAMgT,GALJD,EAAU3H,EAAQqH,IAKUT,OAC9BhS,EAAO6S,WAAW3S,KAAK,CACrBhD,IAAK,aACL+V,KAAM,MACN9V,MAAO6V,IAGT,IACM7K,EAAOwF,GADOoF,EAAQnF,SAE5B5N,EAAO6S,WAAW3S,KAAK,CACrBhD,IAAK,WACL+V,KAAM,iBACN9V,MAAOgL,IAIT,IACiC9H,EAD7B6S,EAAkB,CAAC,EAAE3S,EAAAC,GACCkS,GAAO,IAAjC,IAAAnS,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAmC,KAAxBwS,EAAW9S,EAAAlD,MAEpB,GAD6BgW,EAAY7E,QACZ0E,EAAe,CAC1CE,EAAkBC,EAClB,KACF,CACF,CAAC,OAAA5V,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,IAQmCiO,EAR7BmE,EAAiCnY,SAASiY,EAAgB7C,SAG1DnC,EAAYF,GADekF,EAAgBjF,WAE3CoF,EAAwBpY,SAASiY,EAAgBI,QAGnDC,EAAmB,CAAC,EAAErE,EAAA1O,GACCmS,GAAQ,IAAnC,IAAAzD,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAqC,KAA1B6S,EAAYvE,EAAA9R,MAErB,GAD8BqW,EAAalF,QACb0E,EAAe,CAC3CO,EAAmBC,EACnB,KACF,CACF,CAAC,OAAAjW,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CAED,IACM+M,EAASF,GADmB0F,EAAiBzF,WAEnD9N,EAAO6S,WAAW3S,KAAK,CACrBhD,IAAK,SACL+V,KAAM,cACN9V,MAAO,GAAG4Q,OAAYG,MAExB,IAAMuF,EAAyBF,EAAiBG,OAG1CC,QDtDD,SAA2C/W,GAAA,OAAA2T,GAAAxT,MAAC,KAAD7D,UAAA,CCsDnB0a,CAA6BR,GACtDS,EAAgB,CAAC,EACrB,KAAIF,EAAexa,OAAS,GAG1B,OAAO6G,EAET,IAAM8T,GAJJD,EAAgBF,EAAe,IAIC1C,GAC5B8C,EAA+BF,EAAcpD,IAC7CuD,EAAgBH,EAAcnT,EAC9BuT,EAAqBJ,EAAc3C,IAEnCgD,EAAqB,CADEL,EAAc1C,IACO8C,EAAoB,IAAIZ,GAAgD,GAC1HrT,EAAO6S,WAAW3S,KAAK,CACrBhD,IAAK,QACL+V,KAAM,QACN9V,MAAO,GAAG6W,QAAoBE,MAGhClU,EAAOqQ,QAAUyD,EACjB9T,EAAOmU,oBAAsBJ,EAG7B,IAAMK,EAAU,KAAKX,IAErB,IAAIb,EAAKvM,eAAe+N,GAGtB,OAAOpU,EAET,IAKMqU,EADmBlI,EADL,KAPHyG,EAAKwB,GAI0BE,kBAKF5T,EAS9C,OARAV,EAAO6S,WAAW3S,KAAK,CACrBhD,IAAK,gBACL+V,KAAM,cACN9V,MAAOkX,IAGThL,GAA4BnD,GAC5BmE,GAAqBnE,GACdlG,CACT,GAACwS,GAAAzV,MAAA,KAAA7D,UAAA,C,y/BChGM,SAAeqb,KAAe,OAAAC,GAAAzX,MAAC,KAAD7D,UAAA,CAqBpC,SAAAsb,KAAA,OAAAA,IAAAxX,EAAAA,EAAAA,GArBM,YACL,IAGsBqD,EAHhBL,EAAS,GACTM,GAAM,IAAIhI,MAAOuB,UACc0G,EAAAC,SAAlBtC,EAAe,IACZ,IAAtB,IAAAqC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAbzD,EAAGmD,EAAAlD,MACN4R,QAAavR,EAAU,EAAGN,GAC1BuX,EAAazV,KAAKC,MAAM8P,GAE1BzO,EADmB,IAAIhI,KAAKmc,EAAW7a,MAAMC,WACrB,SAC1BmG,EAAOE,KAAKuU,EAEhB,CAAC,OAAAlX,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CASD,OARsB,IAAlBhB,EAAO7G,QACT6G,EAAOE,KAAK,CACViI,KAAM,QACNvO,MAAM,IAAItB,MAAOoc,cACjB9Z,KAAM,OACNqW,GAAI,IAGDjR,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAaA,SAAAyb,KAAA,OAAAA,IAAA3X,EAAAA,EAAAA,GAXM,YACL,IAEsBiS,EAFhB3O,GAAM,IAAIhI,MAAOuB,UACcqV,EAAA1O,SAAlBtC,EAAe,IACZ,IAAtB,IAAAgR,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAwB,KAAbzD,EAAG+R,EAAA9R,MACN4R,QAAavR,EAAU,EAAGN,GAC1BuX,EAAazV,KAAKC,MAAM8P,GAE1BzO,EADmB,IAAIhI,KAAKmc,EAAW7a,MAAMC,UACtB,gBACnBgE,EAAa,EAAGX,GAE1B,CAAC,OAAAK,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAEM,SAAe0b,GAAa7O,EAAApJ,GAAA,OAAAkY,GAAA9X,MAAC,KAAD7D,UAAA,CA+DlC,SAAA2b,KAAA,OAAAA,IAAA7X,EAAAA,EAAAA,GA/DM,UAA6BmL,EAA0B2M,GAC5D,IAAM5O,EAAYV,KACZtI,EAAM,GAAGiL,KAAQ2M,IACjBlb,GAAO,IAAItB,MAAOoc,cAClBK,QAAqBvX,EAAU,EAAGN,GACxC,GAAI6X,EAAc,CAChB,IAAMC,EAA2BhW,KAAKC,MAAM8V,GAC5CC,EAAyBpb,KAAOA,QAC1B8C,EAAU,EAAGQ,EAAK8B,KAAKQ,UAAUwV,GACzC,MACE,OAAQ7M,GACN,IAAK,QACH,IAAM0H,QAAcC,GAAS5J,GAAW,GAClCoK,EAAW,KAAKwE,IACtB,GAAIjF,EAAMxJ,eAAeiK,GAAW,CAClC,IAEM2E,EAAyC,CAC7C9M,KAAM,QACNvO,KAAMA,EACNgB,KALgBiV,EAAMS,GACD5P,EAKrBuQ,GAAI6D,SAEApY,EAAU,EAAGQ,EAAK8B,KAAKQ,UAAUyV,GACzC,CACA,MAEF,IAAK,WACH,IAAM9I,QAAkBK,GAAYtG,EAAW,GACzCgP,EAAc,MAAMJ,IAC1B,GAAI3I,EAAS9F,eAAe6O,GAAc,CACxC,IAEMC,EAA+C,CACnDhN,KAAM,WACNvO,KAAMA,EACNgB,KALmBuR,EAAS+I,GACJxU,EAKxB0Q,KAAM0D,SAEFpY,EAAU,EAAGQ,EAAK8B,KAAKQ,UAAU2V,GACzC,CACA,MAEF,IAAK,MACH,IAAM/J,QAAgBC,GAAWnF,GAAW,GACtCkP,EAAS,KAAKN,IACpB,GAAI1J,EAAQ/E,eAAe+O,GAAS,CAClC,IAEMC,EAAqC,CACzClN,KAAM,MACNvO,KAAMA,EACNgB,KALcwQ,EAAQgK,GACHpD,OAKnBf,GAAI6D,SAEApY,EAAU,EAAGQ,EAAK8B,KAAKQ,UAAU6V,GACzC,EAOR,IAACtY,MAAA,KAAA7D,UAAA,CAEM,SAAeoc,GAAa1Y,EAAAC,GAAA,OAAA0Y,GAAAxY,MAAC,KAAD7D,UAAA,CAQlC,SAAAqc,KAAA,OAAAA,IAAAvY,EAAAA,EAAAA,GARM,UAA6BmL,EAA0B2M,GAC5D,IAAM5X,EAAM,GAAGiL,KAAQ2M,IACjBU,QAAgChY,EAAU,EAAGN,GACnD,QAAIsY,GACKxW,KAAKC,MAAMuW,EAItB,IAACzY,MAAA,KAAA7D,UAAA,CAqIA,SAAAuc,KAAA,OAAAA,IAAAzY,EAAAA,EAAAA,GAzFM,UAAoCkJ,GACzC,IAIuCwP,EAJjCC,QAAuBpB,KACvB1E,QAAcC,GAAS5J,GAAW,GACpC0P,EAAqC,GACrCC,EAAuB,EAAEC,EAAAtV,GACJmV,GAAc,IAAvC,IAAAG,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAyC,KAA9BoV,EAAUL,EAAAvY,MACb6Y,EAAiBD,EAAW5N,KAC5B8N,EAAiB,IAAI3d,KAAKyd,EAAWnc,MAC3C,OAAQoc,GACN,IAAK,QACH,IAAIE,EAAuD,CAC3DA,KAAiC,SAC3BlC,EAAgB+B,EAAWnb,KACjCsb,EAA0Btb,KAAOoZ,EACjC,IAAMF,EAAciC,EAAW9E,GAC/BiF,EAA0BjF,GAAK6C,EAC/B,IAEMqC,EADYtG,EADG,KAAKiE,KAEiBrD,IAC3CyF,EAA0BzF,IAAM0F,EAChCD,EAA0Btc,KAAO,CAC/Bwc,SAAUH,EAAepc,UACzBwc,SAAU1c,EAAmBsc,IAE/BL,EAAM1V,KAAKgW,GACXL,GAAgB,EAChB,MAEF,IAAK,WACH,IAAIS,EAA6D,CACjEA,KAAoC,YAC9BC,EAAmBR,EAAW3E,KACpCkF,EAA6BlF,KAAOmF,EACpC,IAAMC,EAAmBT,EAAWnb,KACpC0b,EAA6B1b,KAAO4b,EACpCF,EAA6B1c,KAAO,CAClCwc,SAAUH,EAAepc,UACzBwc,SAAU1c,EAAmBsc,IAE/BL,EAAM1V,KAAKoW,GACXT,GAAgB,EAChB,MAEF,IAAK,MACH,IAAIY,EAAmD,CACvDA,KAA+B,OACzBC,EAAYX,EAAW9E,GAC7BwF,EAAwBxF,GAAKyF,EAC7B,IAAMC,EAAcZ,EAAWnb,KAC/B6b,EAAwB7b,KAAO+b,EAC/BF,EAAwB7c,KAAO,CAC7Bwc,SAAUH,EAAepc,UACzBwc,SAAU1c,EAAmBsc,IAE/BL,EAAM1V,KAAKuW,GACXZ,GAAgB,EAChB,MAEF,IAAK,QACH,IAAIe,EAAuD,CAC3DA,KAAiC,SAC3BC,EAAcd,EAAW9E,GAC/B2F,EAA0B3F,GAAK4F,EAC/B,IAAMC,EAAgBf,EAAWnb,KACjCgc,EAA0Bhc,KAAOkc,EACjCF,EAA0Bhd,KAAO,CAC/Bwc,SAAUH,EAAepc,UACzBwc,SAAU1c,EAAmBsc,IAE/BL,EAAM1V,KAAK0W,GACXf,EAAe,EAMrB,CAAC,OAAAtY,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACD4U,EAAMmB,KAAK,SAAUrU,EAAGsU,GACtB,OAAOA,EAAEpd,KAAKwc,SAAW1T,EAAE9I,KAAKwc,QAClC,GAEA,IAAMpW,EAAgC,CACpC4V,MAAOA,EACPC,aAAcA,EACdhM,gBAAgB,IAAIvR,MAAOuB,WAI7B,OAFAwP,GAA4BnD,GAC5BmE,GAAqBnE,GACdlG,CACT,IAACjD,MAAA,KAAA7D,UAAA,CCvRM,SAAS+d,GAAYC,GAC1B,MAAgB,oBAA8CA,UAChE,CAEO,SAASC,GAAeD,GAC7B,IAAME,EAAc7T,SAAS8T,cAAc,QAG3C,OAFAD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYG,UAAYL,EACjBE,CACT,CAEO,SAASI,KACd,IAAMJ,EAAc7T,SAAS8T,cAAc,QAE3C,OADAD,EAAYhT,UAAUkT,IAAI,MACnBF,CACT,CAEO,SAASK,GAAQC,EAA4BR,GAC1BvT,EAAqB+T,EAAe,WAC5CH,UAAYL,CAC9B,CCfA,IAAIS,GAAqB,GACrBC,IAAkC,EAClCC,IAA6B,EAEjC,SAASC,KACP,IAAMlU,EAAUL,SAAS8T,cAAc,OACvCzT,EAAQQ,UAAUkT,IAAI,MAEtB,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYP,MAExB,IAAMQ,EAAezU,SAAS8T,cAAc,OAM5C,OALAW,EAAa5T,UAAUkT,IAAI,MAE3B1T,EAAQmU,YAAYX,GACpBxT,EAAQmU,YAAYC,GAEb,CACLpU,QAASA,EACTqN,GAAI,GAER,CAgBO,SAASgH,GAAyBpF,EAAyCqF,EAAyBC,GACzG,SAASC,EAAeC,EAA0BC,EAAsBC,GACtE,SAASC,EAAWH,EAA0BC,GAE5Cb,GADgC9T,EAAqB0U,EAAa,OACjCC,EAAarF,KAChD,CAEA,SAASwF,EAAYJ,EAA0BC,GAC7C3U,EAAqB0U,EAAa,OAA2Bd,UAAYe,EAAanb,KACxF,CAEA,SAASub,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAaR,EACxC,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmBT,EAC9C,CAEIK,SACFC,EAAWH,EAAaC,GACxBG,EAAYJ,EAAaC,GACzBM,EAAqBP,EAAaH,GAClCQ,EAAgBL,EAAaF,KAExBU,GAAcN,EAAkBD,IACnCE,EAAWH,EAAaC,GAErBO,GAAcN,EAAkBD,IACnCG,EAAYJ,EAAaC,GAEvBJ,IAAmBN,IACrBgB,EAAqBP,EAAaH,GAEhCC,IAAcN,IAChBa,EAAgBL,EAAaF,GAGnC,CAEA,IAAMW,EAAmBjG,EAAW1Z,OAI9B4f,EAA0BlV,EAAwBmV,GAA+B,OAAqB7f,OAC5G,GAAI2f,IAAqBC,EAAyB,CAChD,IAAME,EAAaF,EAA0BD,EAC7C,GAAIG,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpD,IAAME,EAAqBxB,KAC3BoB,EAASnB,YAAYuB,EAAmB1V,QAC1C,CACAoV,GAA8BO,OAAOL,EACvC,MAEE,IADA,IAAMM,EAAmB3V,EAAwBmV,GAA+B,OACvEI,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDI,EADsBT,EAA0B,EAAIK,GACpBK,QAClC,CAEJ,CAGA,IADA,IAAMD,EAAmB3V,EAAwBmV,GAA+B,OACvE/Y,EAAI,EAAGA,EAAI6Y,EAAkB7Y,IAAK,CACzC,IAAMyZ,EAAsBF,EAAiBvZ,GACvCqY,EAAezF,EAAW5S,GACE,IAA9B0X,GAAmBxe,OACrBif,EAAesB,EAAqBpB,EAAc,MAElDF,EAAesB,EAAqBpB,EAAcX,GAAmB1X,GAEzE,CAEA0X,GAAqB9E,EACrBgF,GAAoBM,EACpBP,GAAyBM,CAC3B,CCpHO,IAAMyB,GAAWtW,EAAsB,OAEjCuW,IADiBjW,EAAqBgW,GAAU,OAC/BhW,EAAqBgW,GAAU,QAChDE,GAAmBlW,EAAqBiW,GAAgB,OACxDE,GAA4BnW,EAAqBkW,GAAkB,2BACnEb,GAAgCrV,EAAqBmW,GAA2B,OACtDnW,EAAqBkW,GAAkB,yBAEvE,SAASE,GAAQ9I,GACtB+I,GAAgB,OAChBpF,GAAc,MAAO3D,GACrB0I,GAAShB,aAAa,YAAa,QASpC,SAE+B5S,GAAAkU,GAAAld,MAAC,KAAD7D,UAAA,CAV9BghB,CAAkBjJ,GAClBkJ,IACF,CAEO,SAASC,KAEdT,GAAShB,aAAa,YAAa,SACnC0B,IACF,CAEgC,SAAAJ,KAM/B,OAN+BA,IAAAjd,EAAAA,EAAAA,GAAhC,UAAiCiU,IDE1B,WAIL,IAHA,IAAMqJ,EAAoBzV,GAAsB,qBAE5CgO,EAAa,GACR5S,EAAI,EAAGA,EAFgB,EAEaA,IAC3C4S,EAAW3S,KAAK,CACdhD,IAAK+C,EACLgT,KAAM,GACN9V,MAAO,KAGX8a,GAAyBpF,GAAY,EAAMyH,EAC7C,CCbEC,GACA,IAAMD,EAAoBzV,GAAsB,qBAC1CqB,EAAYV,KACZgV,QJdD,SAA2BzU,EAAApJ,GAAA,OAAA6V,GAAAzV,MAAC,KAAD7D,UAAA,CIcNuhB,CAAaxJ,EAAI/K,GAC3C+R,GAAyBuC,EAAY3H,YAAY,EAAOyH,EAC1D,GAACL,GAAAld,MAAA,KAAA7D,UAAA,CCkBM,SAASwhB,GAAuBC,EAAuBC,EAAqBC,EAA0BC,EAAuBC,EAAqBC,GACvJ,IAAMC,EAAmBJ,EAAmBG,EAEtCE,GAAiBL,EAAmBF,EAAgBK,EAAmBF,GAAiBG,EAExFE,GAAkBN,GAAoB9gB,KAAKqhB,IAAIR,EAAa,GAAK7gB,KAAKqhB,IAAIT,EAAe,IAAMK,GAAoBjhB,KAAKqhB,IAAIL,EAAa,GAAKhhB,KAAKqhB,IAAIN,EAAe,KAAOG,EAAmBlhB,KAAKqhB,IAAIF,EAAe,GAG9N,OADoBnhB,KAAK+I,KAAKqY,EAEhC,CAqBO,SAASE,GAAgBC,GAC9B,IAAMniB,EAASY,KAAKwhB,MAAMD,GACpBE,EAAoBF,EAAOniB,OAC3BsiB,EAAY,IAAIC,aAAaF,GACnC,GAAIriB,EAAS,EAAG,CAEd,IADA,IAAMwiB,EAAQ,EAAIxiB,EACT8G,EAAIub,EAAmBvb,EAAI,EAAGA,IACrCwb,EAAUxb,GAAKqb,EAAOrb,GAAK0b,EAE7B,OAAOhc,MAAMC,KAAK6b,EACpB,CACE,OAAOH,CAEX,CAoEO,SAASM,GAAkB5O,GAChC,IAAM6O,EAAc7O,EAAM7T,OAC1B,GAAoB,IAAhB0iB,EACF,MAAO,CAAC,EAAG,GAMb,IAHA,IAAItc,EAAM4J,IACN7J,GAAO6J,IAEFlJ,EAAI4b,EAAc,EAAG5b,GAAK,EAAGA,IAAK,CACzC,IAAM8O,EAAO/B,EAAM/M,GACf8O,EAAOzP,IACTA,EAAMyP,GAEJA,EAAOxP,IACTA,EAAMwP,EAEV,CACA,MAAO,CAACxP,EAAKD,EACf,C,y/BCtJA,IACIwc,GAA6C,GAC7CC,GAA0C,GAC1CC,IAAiD,EACjDC,GAAyD,EAEzDC,GAAuE,CACzE9c,KAAM,CAAC,EACPoH,UAAW,EACXyK,GAAI,IAEAkL,GAAoD,GACpDC,GAAwD,CAAC,EAE/D,SAASC,GAAuBjd,GAC9B,IAKuBiB,EALnBic,EAAkB,EAClBC,EAAyB,EACzBC,EAAe,EACfC,EAAsB,EACtBC,EAAa,EAAEnc,EAAAC,GACApB,GAAI,IAAvB,IAAAmB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAyB,KAAdoO,EAAI1O,EAAAlD,MACPwf,EAAe5N,EAAK,GACpBvI,EAAYuI,EAAK,GACvB2N,GAAc,EACdJ,GAAmBK,EACnBH,GAAgBhW,EAChB+V,GAA0BxiB,KAAKqhB,IAAIuB,EAAc,GACjDF,GAAuB1iB,KAAKqhB,IAAI5U,EAAW,EAC7C,CAAC,OAAAjJ,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAED,IAUwBiO,EAVlB2N,EAAsBN,EAAkBI,EACxCG,EAAmBL,EAAeE,EAElCI,EAAuBP,EAAyBG,EAAa3iB,KAAKqhB,IAAIwB,EAAqB,GAC3FG,EAAoBN,EAAsBC,EAAa3iB,KAAKqhB,IAAIyB,EAAkB,GAElFG,EAAoBjjB,KAAK+I,KAAKga,GAC9BG,EAAiBljB,KAAK+I,KAAKia,GAE7BG,EAAa,EAAEhO,EAAA1O,GACCpB,GAAI,IAAxB,IAAA8P,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAA0B,KAAfwc,EAAKlO,EAAA9R,MAGd+f,IAFqBC,EAAM,GAEGP,IADZO,EAAM,GAC0CN,EACpE,CAAC,OAAAtf,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CAiBD,MAZyC,CACvCoc,cAAe,CACbC,QAAST,EACTU,MAAON,GAETxW,UAAW,CACT6W,QAASR,EACTS,MAAOL,GAET9jB,OAAQujB,EACRa,aAdFL,GAAcR,IAEoBM,EAAoBC,GAexD,CAEA,SAASO,GAAyBC,EAAuCC,GACvE,IAAMzC,EAAmBwC,EAAYtkB,OAASukB,EAAYvkB,OAEpDwkB,GAA6BF,EAAYL,cAAcC,QAAUI,EAAYtkB,OAASukB,EAAYN,cAAcC,QAAUK,EAAYvkB,QAAU8hB,EAChJ2C,GAA0BH,EAAYjX,UAAU6W,QAAUI,EAAYtkB,OAASukB,EAAYlX,UAAU6W,QAAUK,EAAYvkB,QAAU8hB,EAErI4C,EAA0BnD,GAAuB+C,EAAYL,cAAcC,QAASI,EAAYL,cAAcE,MAAOG,EAAYtkB,OAAQukB,EAAYN,cAAcC,QAASK,EAAYN,cAAcE,MAAOI,EAAYvkB,QACzN2kB,EAAuBpD,GAAuB+C,EAAYjX,UAAU6W,QAASI,EAAYjX,UAAU8W,MAAOG,EAAYtkB,OAAQukB,EAAYlX,UAAU6W,QAASK,EAAYlX,UAAU8W,MAAOI,EAAYvkB,QAEtM4kB,ED1CD,SAAiCC,EAAwBC,EAAwBC,EAAsBC,EAAsBtD,EAA0BuD,EAA2BC,EAAwBC,EAAwBC,EAAsBC,EAAsBxD,EAA0ByD,GAC7S,IAAMxD,EAAmBJ,EAAmBG,EAS5C,OAD2BH,GAAoBqD,EAAeC,EAAeC,EAAoBJ,EAAiBC,GAAkBjD,GAAoBuD,EAAeC,EAAeC,EAAoBJ,EAAiBC,GAAkBrD,IANrNJ,EAAmBmD,EAAiBhD,EAAmBqD,GAAkBpD,KACzEJ,EAAmBoD,EAAiBjD,EAAmBsD,GAAkBrD,KAKmMA,EAH/QP,GAAuBsD,EAAgBE,EAAcrD,EAAkBwD,EAAgBE,EAAcvD,GACrGN,GAAuBuD,EAAgBE,EAActD,EAAkByD,EAAgBE,EAAcxD,GAI5H,CC+B4B0D,CAAwBjB,EAAYL,cAAcC,QAASI,EAAYjX,UAAU6W,QAASI,EAAYL,cAAcE,MAAOG,EAAYjX,UAAU8W,MAAOG,EAAYtkB,OAAQskB,EAAYF,YAAaG,EAAYN,cAAcC,QAASK,EAAYlX,UAAU6W,QAASK,EAAYN,cAAcE,MAAOI,EAAYlX,UAAU8W,MAAOI,EAAYvkB,OAAQukB,EAAYH,aAc/X,MAZyC,CACvCH,cAAe,CACbC,QAASM,EACTL,MAAOO,GAETrX,UAAW,CACT6W,QAASO,EACTN,MAAOQ,GAET3kB,OAAQ8hB,EACRsC,YAAaQ,EAGjB,CA2EC,SAAAY,KAAA,OAAAA,IAAA3hB,EAAAA,EAAAA,GAzEM,UAAqCoQ,GAC1C,IACMwR,GADM,IAAItmB,MACqBuB,UACjCglB,GAAc,EAElB,IAAK7C,GAAuC,CAC1CA,IAAwC,EACxCF,GAA8B,GAC9BC,GAAkCvW,KAClC0W,GAAqC,CACnC9c,KAAM,CAAC,EACPoH,UAAWoY,EACX3N,GAAI8K,IAENE,GAAiD,EAEjD,IADA,IAAM6C,EAA8B1R,EAAajU,OAAS,EACjD8G,EAAI,EAAGA,EA1G0B,GA0GSA,IAAK,CACtD,IACM8e,EAAa3R,EADSrT,KAAKC,MAAMD,KAAKilB,SAAWF,IAEvDhD,GAA4B5b,KAAK6e,EAAWrL,OAC9C,CACF,CAEA,IAC+BgC,EAD/BI,EAAAtV,GACmB4M,GAAY,IAA/B,IAAA0I,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAiC,KAAtBoO,EAAI2G,EAAAvY,MACP8hB,EAASlQ,EAAK2E,OACdwL,EAAU,KAAKD,IACjBnD,GAA4B9M,QAAQiQ,IAAW,IAC5C/C,GAAmC9c,KAAKiH,eAAe6Y,KAC1DhD,GAAmC9c,KAAK8f,GAAW,IAErDhD,GAAmC9c,KAAK8f,GAAShf,KAAK,CAACjF,SAAS8T,EAAK3B,cAAerT,KAAKC,OAAO4kB,EAAmB1C,GAAmC1V,WAAa,OAEvK,CAAC,OAAAjJ,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CAWD,IATAib,IAAkD,GAxHO,KA0HvD4C,GAAc,GAGZ5C,GAAiD,GAAM,UACnDvf,EAAU,EAAGqf,GAAiC/c,KAAKQ,UAAU0c,MAGjE2C,EAAa,KACiCM,EADjCC,EAAA5e,GACMsb,IAA2B,IAAhD,IAAAsD,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAkD,KAAvCse,EAAME,EAAAhiB,MACT+hB,EAAU,KAAKD,IACf7f,EAAO8c,GAAmC9c,KAAK8f,GAC/CG,EAAY,CAAC,EACbC,QAAqB9hB,EAAU,EAAG0hB,GACxC,GAAII,EAAc,CAChB,IAAMC,EAAqBvgB,KAAKC,MAAMqgB,GACtCD,EAAUngB,MAAQse,GAAyB+B,EAAmBrgB,MAAOmd,GAAuBjd,IAC5FigB,EAAU7Y,UAAY+Y,EAAmB/Y,UACzC6Y,EAAUpO,GAAKgO,CACjB,MACEI,EAAUngB,MAAQmd,GAAuBjd,GACzCigB,EAAU7Y,UAAYoY,EACtBS,EAAUpO,GAAKgO,EAGjB,SADMviB,EAAU,EAAGwiB,EAASlgB,KAAKQ,UAAU6f,IACvCjD,GAA2B/V,eAAe6Y,GAAU,CACtD,IAAMM,EAAgBpD,GAA2B8C,GACjD/C,GAAsBsD,OAAOD,EAAe,EAAGH,EACjD,MACElD,GAAsB+C,GAAW/C,GAAsBhjB,OACvDgjB,GAAsBjc,KAAKmf,SAEvBxhB,EAAa,EAAGke,GACxB,CAAC,OAAAxe,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CAEDgb,IAAwC,CAC1C,CACF,IAACjf,MAAA,KAAA7D,UAAA,CAwCA,SAAAwmB,KAAA,OAAAA,IAAA1iB,EAAAA,EAAAA,GAtCM,YACL,IAGsBwU,EAFhBmO,GADM,IAAIrnB,MAAOuB,UACE,MACY4X,EAAAjR,SAAlBtC,EAAe,IACZ,IAAtB,IAAAuT,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAAwB,KAAbzD,EAAGsU,EAAArU,MACNyD,QAAapD,EAAU,EAAGN,GAChC,GAAI0D,EAAM,CACR,IAAMC,EAAS7B,KAAKC,MAAM2B,GACpBgf,EAAgB/e,EAAO2F,UACvBqZ,EAAShf,EAAOoQ,GACtB,GAAI2O,EAAgBD,EAClB,IAAK,IAAMT,KAAWre,EAAOzB,KAAM,CACjC,IAAM0gB,EAAejf,EAAOzB,KAAK8f,GAC3BG,EAAY,CAAC,EACbC,QAAqB9hB,EAAU,EAAG0hB,GACxC,GAAII,EAAc,CAChB,IAAMC,EAAqBvgB,KAAKC,MAAMqgB,GACtCD,EAAUngB,MAAQse,GAAyB+B,EAAmBrgB,MAAOmd,GAAuByD,IAC5FT,EAAU7Y,UAAY+Y,EAAmB/Y,UACzC6Y,EAAUpO,GAAKsO,EAAmBtO,EACpC,MACEoO,EAAUngB,MAAQmd,GAAuByD,GACzCT,EAAU7Y,UAAYoZ,EACtBP,EAAUpO,GAAKhW,SAASikB,EAAQa,MAAM,KAAK,IAG7C,SADMrjB,EAAU,EAAGwiB,EAASlgB,KAAKQ,UAAU6f,IACvCjD,GAA2B/V,eAAe6Y,GAAU,CACtD,IAAMM,EAAgBpD,GAA2B8C,GACjD/C,GAAsBsD,OAAOD,EAAe,EAAGH,EACjD,MACElD,GAAsB+C,GAAW/C,GAAsBhjB,OACvDgjB,GAAsBjc,KAAKmf,EAE/B,OAEIxhB,EAAa,EAAGgiB,EACxB,CACF,CAAC,OAAAtiB,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAmBA,SAAA8mB,KAAA,OAAAA,IAAAhjB,EAAAA,EAAAA,GAjBM,YACL,IAIsB4U,EAHhB+N,GADM,IAAIrnB,MAAOuB,UACE,MAErBc,EAAgB,EAAEkX,EAAArR,SADHtC,EAAe,IAEZ,IAAtB,IAAA2T,EAAApR,MAAAmR,EAAAC,EAAAnR,KAAAC,MAAwB,KAAbzD,EAAG0U,EAAAzU,MACNyD,QAAapD,EAAU,EAAGN,GAChC,GAAI0D,EAAM,CACR,IAAMC,EAAS7B,KAAKC,MAAM2B,GACJC,EAAO2F,UACTmZ,IAClBxD,GAAsBjc,KAAKW,GAC3Bub,GAA2Blf,GAAOvC,EAClCA,GAAS,EAEb,CACF,CAAC,OAAA4C,GAAAsU,EAAA9Q,EAAAxD,EAAA,SAAAsU,EAAA7Q,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAQM,SAAe+mB,KAAkC,OAAAC,GAAAnjB,MAAC,KAAD7D,UAAA,CAYvD,SAAAgnB,KAAA,OAAAA,IAAAljB,EAAAA,EAAAA,GAZM,YACL,IAGsBiV,EAFhB0N,GADM,IAAIrnB,MAAOuB,UACE,MACYqY,EAAA1R,SAAlBtC,EAAe,IACZ,IAAtB,IAAAgU,EAAAzR,MAAAwR,EAAAC,EAAAxR,KAAAC,MAAwB,KAAbzD,EAAG+U,EAAA9U,MACNyD,QAAapD,EAAU,EAAGN,GACjB8B,KAAKC,MAAM2B,GACG4F,WACRmZ,UACb9hB,EAAa,EAAGX,GAE1B,CAAC,OAAAK,GAAA2U,EAAAnR,EAAAxD,EAAA,SAAA2U,EAAAlR,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAED,IACI6L,GADEob,GAA+B,CAAC,EAItC,GAA4B,oBAAjBlb,aAA8B,CACvC,IAAMmb,GAA4B,IAAInb,aAAa,IAAI1D,IAAmD,oBAC1GwD,GAAOqb,GAA0Brb,MAC5BI,OACP,KAAO,CACL,IAAMkb,GAAsB,IAAI/e,OAAO,IAAIC,IAAmD,mBAC9FwD,GAAOsb,EACT,CAgBO,SAAeC,KAAa,OAAAC,GAAAxjB,MAAC,KAAD7D,UAAA,CAelC,SAAAqnB,KAAA,OAAAA,IAAAvjB,EAAAA,EAAAA,GAfM,YACL,IA9CM2iB,EA8CAa,QA9CAb,GADM,IAAIrnB,MAAOuB,UACE,MAClBsiB,GAAsBsE,OAAO,SAAC1R,GAAI,OAAKA,EAAKvI,UAAYmZ,CAAU,IA8CnEpa,EAASC,KAYf,aAVqB,IAAI9D,QAAQ,SAACC,EAASC,GACzCue,GAA6B5a,GAAU5D,EAEvCoD,GAAKhD,QAAU,SAAUhB,GACvBa,EAAOb,EAAEiB,QACX,EAEA+C,GAAK9C,YAAY,CAACue,EAAYjb,GAChC,EAGF,IAACxI,MAAA,KAAA7D,UAAA,C,y/BCpTM,SAAewnB,GAAe3a,GAAA,OAAA4a,GAAA5jB,MAAC,KAAD7D,UAAA,CAYpC,SAAAynB,KAAA,OAAAA,IAAA3jB,EAAAA,EAAAA,GAZM,UAA+BkJ,GACpC,IAKsB7F,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,GACJ,CAAC,EAAG,IACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,mBAAmB1B,EAAIzD,EAAE,KAAM,QAChFf,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,CD4QD6L,GAAKlD,UAAY,SAAUd,GACzB,IAAA0E,GAAAC,EAAAA,EAAAA,GAAyB3E,EAAE3B,KAAI,GAAxBY,EAAMyF,EAAA,GAAEF,EAAME,EAAA,GACjB0a,GAA6B5a,KAC/B4a,GAA6B5a,GAAQvF,UAC9BmgB,GAA6B5a,GAExC,EAGAR,GAAKhD,QAAU,SAAUhB,GAEzB,EE1SA,IAAI6f,IAAqD,EACrDC,GAAsD,GAOnD,SAAeC,GAA6B/a,GAAA,OAAAgb,GAAAhkB,MAAC,KAAD7D,UAAA,CAuClD,SAAA6nB,KAAA,OAAAA,IAAA/jB,EAAAA,EAAAA,GAvCM,UAA6CkJ,GAAwD,SAC3FqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAIrB,OAJqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAAMgkB,ErBcH,WACL,MAAO,uEAAuElc,GADvB5L,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,MAE5D,CqBhBmB+nB,GAEf,aADmBnb,EAAUkb,EAAQ9a,EAAW,gCAAiC,OAEnF,GAACsF,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMwS,EAAW,0CACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IAOrB,aANM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACvC4gB,KACHA,IAA4C,EAC5CC,GAAuC7gB,GAElCA,CACT,CACE,IAAI,IAAI1H,MAAOuB,UAAYoB,SAAS0Q,GAbd,OAaiD,CACrE,IAAM3L,QAAeuL,IAOrB,aANM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACvC4gB,KACHA,IAA4C,EAC5CC,GAAuC7gB,GAElCA,CACT,CACE,IAAK4gB,GAA2C,CAC9C,IAAM/U,QAAcrO,EAAU,EAAGkO,GACjCkV,IAA4C,EAC5CC,GAAuC7hB,KAAKC,MAAM4M,EACpD,CAEA,OADApF,GAAyBP,EAAW,gCAAiC,GAAG,GACjE2a,EAGb,GAACE,GAAAhkB,MAAA,KAAA7D,UAAA,C,y/BC+BD,IAAMgoB,GAAwC,CAAC,EAa9C,SAAAC,KAAA,OAAAA,IAAAnkB,EAAAA,EAAAA,GAXM,YACL,IACkCqD,EADUE,EAAAC,SAAnBtC,EAAe,KACN,IAAlC,IAAAqC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAoC,KAAzBygB,EAAS/gB,EAAAlD,MACZkkB,QAAuB7jB,EAAU,GAAI4jB,GAC3C,GAAIC,EAAgB,CAClB,IAAMC,EAAmBtiB,KAAKC,MAAMoiB,GAC/BH,GAAW7a,eAAe+a,KAC7BF,GAAWE,GAAaE,EAE5B,CACF,CAAC,OAAA/jB,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAEM,SAAeqoB,GAAYxb,EAAApJ,GAAA,OAAA6kB,GAAAzkB,MAAC,KAAD7D,UAAA,CAgCjC,SAAAsoB,KAAA,OAAAA,IAAAxkB,EAAAA,EAAAA,GAhCM,UAA4BpC,EAAsBqY,GAEvD,IAAM/M,EAAYV,KACZic,QAAmCX,GAA8B5a,GAEvE,GADAmD,GAA4BnD,IACvBub,EAA2BC,QAAQrb,eAAe4M,GAAO,OAAO,EAGrE,IAAM0O,EAAWnc,KACX4b,EAAY,KAAKO,IACvB,GAAIT,GAAW7a,eAAe+a,GAC5B,OAAO,EAGT,SAD6B5jB,EAAU,GAAI4jB,GAEzC,OAAO,EAIT,IACIQ,EAAoB,CACtBhnB,KAAMA,EACNqY,KAAMA,EACNhC,GAAI0Q,EACJnb,WALc,IAAIlO,MAAOuB,WAY3B,OAHAqnB,GAAWE,GAAaQ,QAClBllB,EAAU,GAAI0kB,EAAWpiB,KAAKQ,UAAUoiB,UACxCllB,EAAU,GAAI0kB,EAAWpiB,KAAKQ,UAAU,KACvCmiB,CACT,IAAC5kB,MAAA,KAAA7D,UAAA,CAEM,SAAe2oB,GAAYjlB,EAAAC,EAAAY,GAAA,OAAAqkB,GAAA/kB,MAAC,KAAD7D,UAAA,CA4BjC,SAAA4oB,KAAA,OAAAA,IAAA9kB,EAAAA,EAAAA,GA5BM,UAA4B2kB,EAAwB/mB,EAAsBqY,GAC/E,IAAMmO,EAAoB,KAAKO,IAGzBI,QAA2BvkB,EAAU,GAAI4jB,GAC/C,IAAKW,EACH,OAAO,EAET,IAAMC,EAAuBhjB,KAAKC,MAAM8iB,GAGlC7b,EAAYV,KACZic,QAAmCX,GAA8B5a,GAEvE,GADAmD,GAA4BnD,IACvBub,EAA2BC,QAAQrb,eAAe4M,GAAO,OAAO,EAGrE,IAAMgP,EAAyB,CAC7BrnB,KAAMA,EACNqY,KAAMA,EACNhC,GAAI0Q,EACJnb,UAAWwb,EAAqBxb,WAMlC,OAFA0a,GAAWE,GAAaa,QAClBvlB,EAAU,GAAI0kB,EAAWpiB,KAAKQ,UAAUyiB,KACvC,CACT,IAACllB,MAAA,KAAA7D,UAAA,CAEM,SAASgpB,GAAUP,GACxB,IAAMP,EAAoB,KAAKO,IAC/B,QAAKT,GAAW7a,eAAe+a,IAGF,CAC3BxmB,KAAMsmB,GAAWE,GAAWxmB,KAC5BqY,KAAMiO,GAAWE,GAAWnO,KAC5BhC,GAAIiQ,GAAWE,GAAWnQ,GAC1BzK,UAAW0a,GAAWE,GAAW5a,UAIrC,CAmBO,SAAe2b,GAAiBzkB,GAAA,OAAA0kB,GAAArlB,MAAC,KAAD7D,UAAA,CAgCtC,SAAAkpB,KAAA,OAAAA,IAAAplB,EAAAA,EAAAA,GAhCM,UAAiC2kB,GACtC,IAAM3hB,EAA+B,GAE/BohB,EAAoB,KAAKO,IACzBU,EAAaH,GAAUP,GAC7B,GAA0B,kBAAfU,IAA2C,IAAfA,EACrC,OAAOriB,EAGT,IAAMsiB,QAAmC9kB,EAAU,GAAI4jB,GACvD,IAAKkB,EACH,OAAOtiB,EAET,IAAMuiB,EAA8BvjB,KAAKC,MAAMqjB,GAC/C,GAA2C,IAAvCC,EAA4BppB,OAAc,CAO5C,OADA6G,EAAOE,KAL+B,CACpCiI,KAAM,QACN8I,GAAI,EACJtW,MAAO,IAGFqF,CACT,CAAC,IAE6DiP,EAF7DC,EAAA1O,GAEkC+hB,GAA2B,IAA9D,IAAArT,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAgE,KAArD6hB,EAAoBvT,EAAA9R,MACvBslB,QAAwBjlB,EAAU,GAAIglB,GAC5C,GAAIC,EAAiB,CACnB,IAAMC,EAAoB1jB,KAAKC,MAAMwjB,GACrCziB,EAAOE,KAAKwiB,EACd,CACF,CAAC,OAAAnlB,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,UAEcypB,GAAsB7kB,GAAA,OAAA8kB,GAAA7lB,MAAC,KAAD7D,UAAA,UAAA0pB,KAQpC,OARoCA,IAAA5lB,EAAAA,EAAAA,GAArC,UAAsC2kB,GACpC,IAAMP,EAAoB,KAAKO,IACzBW,QAAmC9kB,EAAU,GAAI4jB,GACvD,OAAKkB,EAG+BtjB,KAAKC,MAAMqjB,GACZnpB,OAH1B,CAIX,IAAC4D,MAAA,KAAA7D,UAAA,CAEM,SAAe2pB,KAAsB,OAAAC,GAAA/lB,MAAC,KAAD7D,UAAA,CAgB3C,SAAA4pB,KAAA,OAAAA,IAAA9lB,EAAAA,EAAAA,GAhBM,YACL,IAE4B0Y,EAFtBqN,QA9DD,WACL,IAAM/iB,EAAS,GACf,IAAK,IAAMohB,KAAaF,GAAY,CAClC,IAAM8B,EAAuB,CAC3BpoB,KAAMsmB,GAAWE,GAAWxmB,KAC5BqY,KAAMiO,GAAWE,GAAWnO,KAC5BhC,GAAIiQ,GAAWE,GAAWnQ,GAC1BzK,UAAW0a,GAAWE,GAAW5a,WAEnCxG,EAAOE,KAAK8iB,EACd,CAIA,OAHAhjB,EAAO+W,KAAK,SAAUrU,EAAGsU,GACvB,OAAOtU,EAAE8D,UAAYwQ,EAAExQ,SACzB,GACOxG,CACT,CA+CwBijB,GAChBjjB,EAAiC,GAAG8V,EAAAtV,GACrBuiB,GAAO,IAA5B,IAAAjN,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAA8B,KAAnBuiB,EAAMxN,EAAAvY,MACTgmB,QAAsBhB,GAAkBe,EAAOjS,IAC/CmS,QAA4BT,GAAuBO,EAAOjS,IAChEjR,EAAOE,KAAK,CACVtF,KAAMsoB,EAAOtoB,KACbqY,KAAMiQ,EAAOjQ,KACbhC,GAAIiS,EAAOjS,GACXzK,UAAW0c,EAAO1c,UAClB6c,QAASF,EACTtkB,cAAeukB,GAEnB,CAAC,OAAA7lB,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAuBA,SAAAoqB,KAAA,OAAAA,IAAAtmB,EAAAA,EAAAA,GArBM,UAAoCumB,GACzC,IAAIC,GAAqB,EACJ,YAAjBva,EAAAA,EAAAA,GAAOsa,IAAuB5jB,MAAM8jB,QAAQF,KAC9CC,GAAY,GAEd,IAEsBrE,EAFlBnf,EAA+B,GACGof,EAAA5e,SAAnBtC,EAAe,KACZ,IAAtB,IAAAkhB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAwB,KAAbzD,EAAGiiB,EAAAhiB,MACNyD,QAAapD,EAAU,GAAIN,GACjC,GAAI0D,EAAM,CACR,IAAMC,EAAS7B,KAAKC,MAAM2B,GACtB4iB,EACED,EAAMvU,QAAQnO,EAAOsH,OAAS,GAChCnI,EAAOE,KAAKW,GAGdb,EAAOE,KAAKW,EAEhB,CACF,CAAC,OAAAtD,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,CA6KA,SAAAwqB,KAAA,OAAAA,IAAA1mB,EAAAA,EAAAA,GA1IM,UAAgCkJ,GACrCO,GAAyBP,EAAW,oBAAqB,GAAG,GAC5DO,GAAyBP,EAAW,oBAAqB,GAAG,GAC5DO,GAAyBP,EAAW,aAAc,GAAG,GACrDO,GAAyBP,EAAW,aAAc,GAAG,GAErD,IAYmDsL,EAZ7CpE,QAAqBsT,GAAgBxa,GACrC2J,QAAeC,GAAS5J,GAAW,GAGnCyd,QAA2Bd,KAE3Be,EAAuB/e,GAAsB,wBAE7Cgf,EAAehf,GAAsB,gBACrCif,EAA2Bjf,GAAsB,oBAEnDkf,EAAU,GAAoBtS,EAAAjR,GACDmjB,GAAkB,IAAnD,IAAAlS,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAAqD,KAA1CqjB,EAAkBxS,EAAArU,MAC3B4mB,EAAUA,EAAQvZ,OAChBwZ,EAAmBX,QAChB5C,OAAO,SAACwD,GACP,MAAkB,SAAXA,EAAE9b,IACX,GACC9N,IAAI,SAAC0G,GAAC,OAAKA,EAAEkQ,EAAE,GAEtB,CAAC,OAAA1T,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CAED,IAC2C4Q,EADvCsS,EAA8D,CAAC,EAAErS,EAAArR,GACtC4M,GAAY,IAA3C,IAAAyE,EAAApR,MAAAmR,EAAAC,EAAAnR,KAAAC,MAA6C,KAAlCwjB,EAAgBvS,EAAAzU,MACzB,GAAI4mB,EAAQ/U,QAAQmV,EAAiBzQ,SAAW,EAE9CwQ,EAD4B,KAAKC,EAAiBzQ,UACZyQ,CAE1C,CAAC,OAAA5mB,GAAAsU,EAAA9Q,EAAAxD,EAAA,SAAAsU,EAAA7Q,GAAA,CAED,IAEmDiR,EAF/C8Q,EAAwC,GAAG7Q,EAAA1R,GAEdmjB,GAAkB,IAAnD,IAAAzR,EAAAzR,MAAAwR,EAAAC,EAAAxR,KAAAC,MAAqD,KAWRyjB,EAXlCC,EAAkBpS,EAAA9U,MAErBmnB,EAAqC,CACzC1pB,KAAMypB,EAAmBzpB,KACzBqY,KAAMoR,EAAmBpR,KACzBhC,GAAIoT,EAAmBpT,GACvBzK,UAAW6d,EAAmB7d,UAC9B6c,QAAS,GACTxkB,cAAewlB,EAAmBxlB,eAClC0lB,EAAA/jB,GAEe6jB,EAAmBhB,SAAO,IAA3C,IAAAkB,EAAA9jB,MAAA2jB,EAAAG,EAAA7jB,KAAAC,MAA6C,KACvC6jB,EADOJ,EAAAjnB,MAEX,OAAQqnB,EAAerc,MACrB,IAAK,OACH,IAAMsc,EAAc,KAAKD,EAAevT,KACpCyT,EAAmB,CAAC,EACxB,IAAIR,EAAuB7d,eAAeoe,GAGxC,MAFAC,EAAmBR,EAAuBO,GAI5CD,EAAe1d,OAASqG,GAAkBuX,EAAiBtX,aAAcwW,GACzE,IACM1T,EAAYL,EADG,KAAK2U,EAAeG,MAAM1T,MAE/CuT,EAAeG,MAAMC,gBAAkB1U,EAAUO,IACjD,MAEF,IAAK,QACH,IACMP,EAAYL,EADG,KAAK2U,EAAevT,MAEzCuT,EAAeI,gBAAkB1U,EAAUO,IAgD/C6T,EAAiBjB,QAAQnjB,KAAKskB,EAChC,CAAC,OAAAjnB,GAAAgnB,EAAAxjB,EAAAxD,EAAA,SAAAgnB,EAAAvjB,GAAA,CACD+hB,EAAQ7iB,KAAKokB,EACf,CAAC,OAAA/mB,GAAA2U,EAAAnR,EAAAxD,EAAA,SAAA2U,EAAAlR,GAAA,CAED,IAAMhB,EAA4B,CAChC+iB,QAASA,EACTlZ,eAAgBO,GAAkBlE,IAapC,OAVAmD,GAA4BnD,GAC5BmE,GAAqBnE,GAEhB2d,IACCC,EAAyBe,gBH/T1B,SAAoC9e,GAAA,OAAA4Y,GAAA5hB,MAAC,KAAD7D,UAAA,CGgU/B4rB,CAAsB1X,UCxV3B,SAAwCzQ,GAAA,OAAAooB,GAAAhoB,MAAC,KAAD7D,UAAA,CD0VrC8rB,CAA0B5X,IAG3BpN,CACT,GAAC0jB,GAAA3mB,MAAA,KAAA7D,UAAA,CAEM,SAAe+rB,GAAYC,EAAAC,GAAA,OAAAC,GAAAroB,MAAC,KAAD7D,UAAA,CAsBjC,SAAAksB,KAAA,OAAAA,IAAApoB,EAAAA,EAAAA,GAtBM,UAA4B2kB,EAAwB0B,GACzD,IAAMjC,EAAY,KAAKO,IACjB0D,EAAa,GAAGhC,EAAQlb,QAAQkb,EAAQpS,KACxCoR,EAAaH,GAAUP,GAE7B,GAA0B,kBAAfU,IAA2C,IAAfA,EACrC,OAAO,EAGT,IAAMC,QAAoC9kB,EAAU,GAAI4jB,GACxD,IAAKkB,EACH,OAAO,EAGT,IAAMC,EAA8BvjB,KAAKC,MAAMqjB,GAC/C,OAA2C,IAAvCC,EAA4BppB,QAAgBopB,EAA4BvT,QAAQqW,GAAc,WAC1F3oB,EAAU,GAAI0kB,EAAWpiB,KAAKQ,UAAU+iB,EAA4B/X,OAAO6a,WAC3E3oB,EAAU,GAAI2oB,EAAYrmB,KAAKQ,UAAU6jB,KACxC,EAIX,IAACtmB,MAAA,KAAA7D,UAAA,CAEM,SAAeosB,GAAoBC,EAAAC,GAAA,OAAAC,GAAA1oB,MAAC,KAAD7D,UAAA,CAezC,SAAAusB,KAAA,OAAAA,IAAAzoB,EAAAA,EAAAA,GAfM,UAAoCmL,EAA6B8I,GACtE,IAGsByU,EAHhBC,EAA0B,GAAGxd,KAAQ8I,IAEL2U,EAAAplB,SAAnBtC,EAAe,KACZ,IAAtB,IAAA0nB,EAAAnlB,MAAAilB,EAAAE,EAAAllB,KAAAC,MAAwB,KAAbzD,EAAGwoB,EAAAvoB,MACNmlB,QAAoC9kB,EAAU,GAAIN,GACxD,GAAKolB,EAIL,GADoCtjB,KAAKC,MAAMqjB,GACftT,QAAQ2W,IAA4B,EAClE,OAAO,CAEX,CAAC,OAAApoB,GAAAqoB,EAAA7kB,EAAAxD,EAAA,SAAAqoB,EAAA5kB,GAAA,CACD,OAAO,CACT,IAACjE,MAAA,KAAA7D,UAAA,CA8BA,SAAA2sB,KAAA,OAAAA,IAAA7oB,EAAAA,EAAAA,GA5BM,UAAgC2kB,EAAwBxZ,EAA6B8I,GAC1F,IAAMmQ,EAAY,KAAKO,IACjBa,EAAuB,GAAGra,KAAQ8I,IAGlCoR,EAAaH,GAAUP,GAC7B,GAA0B,kBAAfU,IAA2C,IAAfA,EACrC,OAAO,EAIT,IAAMC,QAAoC9kB,EAAU,GAAI4jB,GACxD,IAAKkB,EACH,OAAO,EAET,IAAMC,EAA8BvjB,KAAKC,MAAMqjB,GACzC3nB,EAAQ4nB,EAA4BvT,QAAQwT,GAWlD,OAVI7nB,GAAS,GAAK4nB,EAA4BppB,OAAS,IACrDopB,EAA4B9C,OAAO9kB,EAAO,SACpC+B,EAAU,GAAI0kB,EAAWpiB,KAAKQ,UAAU+iB,MAKhC,WADM+C,GAAqBnd,EAAM8I,YAEzCpT,EAAa,GAAI2kB,KAElB,CACT,IAACzlB,MAAA,KAAA7D,UAAA,CAEM,SAAe4sB,GAAQC,EAAAC,EAAAC,GAAA,OAAAC,GAAAnpB,MAAC,KAAD7D,UAAA,CAiC7B,SAAAgtB,KAAA,OAAAA,IAAAlpB,EAAAA,EAAAA,GAjCM,UAAwB2kB,EAAwBjO,EAAgBrD,GACrE,IAAMnK,EAAYV,KACZoN,QAAc3F,GAAQ/G,GACtBiG,QAAkBK,GAAYtG,EAAW,GACzC2J,QAAeC,GAAS5J,GAAW,GAEnCigB,EAAWvT,EAAK,KAAKc,KACrB0S,EAA4BnrB,SAASkrB,EAASE,QAE9CC,EADena,EAAS,KAAKga,EAAS7R,kBACF5T,EAEpCwP,EAAYL,EAAM,KAAKQ,KACvB2D,EAAwB9D,EAAUxP,EAClCuT,EAA6B/D,EAAUgB,IACvCqV,EAA+BrW,EAAUiB,IAEzCqV,EAAgC,CACpCre,KAAM,OACN8I,GAAIyC,EACJlN,WAAW,IAAIlO,MAAOuB,UACtBe,KAAM0rB,EACNG,UAAWL,EACXzB,MAAO,CACL/pB,KAAMoZ,EACN0S,UAAW,CACTC,UAAW1S,EACX2S,YAAaL,GAEftV,GAAIZ,IAIR,aADmB4U,GAAatD,EAAU6E,EAE5C,IAACzpB,MAAA,KAAA7D,UAAA,CAEM,SAAe2tB,GAASC,EAAAC,GAAA,OAAAC,GAAAjqB,MAAC,KAAD7D,UAAA,CAyB9B,SAAA8tB,KAAA,OAAAA,IAAAhqB,EAAAA,EAAAA,GAzBM,UAAyB2kB,EAAwBtR,GACtD,IAAMnK,EAAYV,KACZqK,QAAeC,GAAS5J,GAAW,GACzCmD,GAA4BnD,GAC5BmE,GAAqBnE,GACrB,IAAM+gB,EAAe,KAAK5W,IACtBH,EAAY,CAAC,EACjB,IAAIL,EAAMxJ,eAAe4gB,GAGvB,OAAO,EAFP/W,EAAYL,EAAMoX,GAKpB,IAAMT,EAAiC,CACrCre,KAAM,QACN8I,GAAIZ,EACJ7J,WAAW,IAAIlO,MAAOuB,UACtBe,KAAMsV,EAAUxP,EAChBgmB,UAAW,CACTC,UAAWzW,EAAUgB,IACrB0V,YAAa1W,EAAUiB,MAI3B,aADmB8T,GAAatD,EAAU6E,EAE5C,IAACzpB,MAAA,KAAA7D,UAAA,CAEM,SAAeguB,GAAYC,EAAAC,GAAA,OAAAC,GAAAtqB,MAAC,KAAD7D,UAAA,CAuBlC,SAAAmuB,KAFC,OAEDA,IAAArqB,EAAAA,EAAAA,GAvBO,UAA4B2kB,EAAwBvQ,GACzD,IAAMlL,EAAYV,KACZ2G,QAAkBK,GAAYtG,EAAW,GAC/CmD,GAA4BnD,GAC5BmE,GAAqBnE,GACrB,IAAMohB,EAAkB,MAAMlW,IAC1BO,EAAe,CAAC,EACpB,IAAIxF,EAAS9F,eAAeihB,GAG1B,OAAO,EAFP3V,EAAexF,EAASmb,GAK1B,IAAMd,EAAoC,CACxCre,KAAM,WACN8I,GAAIG,EACJ5K,WAAW,IAAIlO,MAAOuB,UACtBe,KAAM+W,EAAajR,GAGrB,aADmBukB,GAAatD,EAAU6E,EAE5C,IAACzpB,MAAA,KAAA7D,UAAA,CAuCA,SAAAquB,KAAA,OAAAA,IAAAvqB,EAAAA,EAAAA,GAnCM,UAAwC2kB,EAAwBxZ,EAA6B8I,EAAyBwV,GAC3H,IAAMrF,EAAY,KAAKO,IACjBa,EAAuB,GAAGra,KAAQ8I,IAClCoR,EAAaH,GAAUP,GAC7B,GAA0B,kBAAfU,IAA2C,IAAfA,EACrC,OAAO,EAGT,IAAMC,QAAoC9kB,EAAU,GAAI4jB,GACxD,IAAKkB,EACH,OAAO,EAET,IAAMC,EAA8BvjB,KAAKC,MAAMqjB,GAEzC3nB,EAAQ4nB,EAA4BvT,QAAQwT,GAClD,GAAI7nB,GAAS,GAAK4nB,EAA4BppB,OAAS,EAAG,CACxD,IAAIquB,EAAiB,EACrB,OAAQf,GACN,IAAK,KACHe,GAAU,EACV,MACF,IAAK,OACHA,EAAS,EACT,MACF,QACEA,EAAS,EAMb,OAHAjF,EAA4B9C,OAAO9kB,EAAO,GAC1C4nB,EAA4B9C,OAAO9kB,EAAQ6sB,EAAQ,EAAGhF,SAChD9lB,EAAU,GAAI0kB,EAAWpiB,KAAKQ,UAAU+iB,KACvC,CACT,CACE,OAAO,CAEX,IAACxlB,MAAA,KAAA7D,UAAA,CEroBM,IAAMuuB,GAAchsB,EAAQ,M,y/BCOnC,IAAIisB,GAAkB,CAAC,EACnB9W,IAAgB,EA+BnB,SAAA+W,KAAA,OAAAA,IAAA3qB,EAAAA,EAAAA,GA7BM,YACL,IAAI4T,GAAJ,CAEA,IAAM1K,EAAYV,KACZic,QAAmCX,GAA8B5a,GACvEmD,GAA4BnD,GAE5B,IAAM0hB,EAAanG,EAA2BmG,WAAW7H,MAAM,KACzD2B,EAAUD,EAA2BC,QACrCmG,EAAQ,GACRC,EAA2D,CAAC,EAE9DC,EAAY,EAChB,IAAK,IAAMC,KAAUtG,EAAS,CAE5BmG,EAAM3nB,KAAK8nB,GACX,IACuC3nB,EADvCE,EAAAC,GACwBkhB,EAAQsG,IAAO,IAAvC,IAAAznB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAyC,KACjCsnB,EAAe,IADH5nB,EAAAlD,QAEb2qB,EAAczhB,eAAe4hB,KAChCH,EAAcG,GAAgB,IAEhCH,EAAcG,GAAc/nB,KAAK6nB,EACnC,CAAC,OAAAxqB,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD+mB,GACF,CAEAL,GAAkB,CAAEE,WAAAA,EAAYC,MAAAA,EAAOC,cAAAA,GACvClX,IAAgB,CA3BS,CA4B3B,IAAC7T,MAAA,KAAA7D,UAAA,CChCD,IAAMgvB,GAAwB,eACnBC,IAAwB,EAG7BC,GAAkBzkB,EADNN,EAAsB,OACgB,OAClDglB,GAAyB1kB,EAAqBykB,GAAiB,OAC/DE,GAAkB3kB,EAAqB0kB,GAAwB,8CAErE,SAASE,GAAmC9e,GAC1C,IAAMC,EAAcD,EACd+e,EAAiE,KAAvD,EAAIxf,GAAyBkf,KAC7CI,GAAgBG,MAAMC,YAAY,OAAgC,GAAGF,OACpC,QAA7B9e,EAAYC,OAAOL,QACrB/F,SAASolB,oBAAoBjf,EAAYC,OAAOH,OAAQ+e,IACxDD,GAAgBM,iBACd,gBACA,WACEP,GAAuB1P,aAAa,WAAY,OAClD,EACA,CAAEkQ,MAAM,IAEVP,GAAgBG,MAAMC,YAAY,OAAgC,OAClEP,IAAwB,EAE5B,CAoBC,SAAAW,KAAA,OAAAA,IAAA9rB,EAAAA,EAAAA,GAlBM,YAMLyJ,GAAyByhB,GAAuB,gBAAiB,GAAG,GACpEzhB,GAAyByhB,GAAuB,gBAAiB,GAAG,GACpEzhB,GAAyByhB,GAAuB,eAAgB,GAAG,GACnEzhB,GAAyByhB,GAAuB,eAAgB,GAAG,GACnEzhB,GAAyByhB,GAAuB,gCAAiC,GAAG,GACpF3kB,SAASqlB,iBAAiBV,GAAuBK,UAC3CzY,GAASoY,IAAuB,SAChC1b,GAAY0b,GAAuB,SACnC7c,GAAW6c,IAAuB,SAClCpH,GAA8BoH,IACpC7e,GAA4B6e,IAC5B7d,GAAqB6d,GACvB,IAACnrB,MAAA,KAAA7D,UAAA,C,y/BCtCD,IAAI6vB,GAAwB,GAEtBC,GAAoB3lB,EAAsB,OAC1C4lB,GAAqB5lB,EAAsB,OAC3C6lB,GAA0B7lB,EAAsB,OAEtD,SAAS8lB,GAAwBnB,GAC/B,IAAMpkB,EAAUL,SAAS8T,cAAc,OAMvC,OALAzT,EAAQQ,UAAUkT,IAAI,MACtB1T,EAAQwlB,QAAU,YAyCb,SAA0BpB,GAC/B,IAAIqB,EACJ,OAAQN,IACN,IAAK,SACHM,EAAmB1lB,EAAqBqlB,GAAmB,kDAC3D,MACF,IAAK,UACHK,EAAmB1lB,EAAqBslB,GAAoB,kDAKhEI,EAAiBlsB,MAAQ6qB,EACzBsB,IACF,CAtDIC,CAAiBvB,EACnB,EACApkB,EAAQmU,YAAYZ,GAAe6Q,IAC5B,CACLpkB,QAASA,EACTqN,GAAI,GAER,CAEgD,SAAAuY,KAY/C,OAZ+CA,IAAAxsB,EAAAA,EAAAA,GAAhD,YACE,IAAMysB,EAAyB9lB,EAAqBulB,GAAyB,WAC7EO,EAAuBC,UAAY,GACnC,IAAMxjB,EAAYV,KACZmkB,QAAwB7I,GAA8B5a,GAC5DmD,GAA4BnD,GAC5B,IAAMgT,EAAW,IAAIC,iBACrB,IAAK,IAAM6O,KAAU2B,EAAgBjI,QAAS,CAC5C,IAAMkI,EAAgBT,GAAwBnB,GAC9C9O,EAASnB,YAAY6R,EAAchmB,QACrC,CACA6lB,EAAuBlQ,OAAOL,EAChC,IAACnc,MAAA,KAAA7D,UAAA,CAEM,SAAS2wB,GAAkC5Z,GAChD,IAAM6Z,EAAsCnmB,EAAqBulB,GAAyB,WACpFO,EAAyB9lB,EAAqBulB,GAAyB,WAC7E,IAAK1Z,GAAuBS,GAAQ,CAClC,IAEkC5P,EAF5B0pB,EFTH,SAAkC9Z,GAAsJ,IAAvI+Z,EAAkB9wB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EAAG+wB,IAAuB/wB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GAASgxB,EAAsBhxB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GACvI,IAAK0X,GAAe,MAAO,GAoB3B,IAlBA,IAAAuZ,EAA6CzC,GAArCE,EAAUuC,EAAVvC,WAAYC,EAAKsC,EAALtC,MAAOC,EAAaqC,EAAbrC,cACrBsC,EAAcrwB,KAAKswB,MAAMxC,EAAM1uB,OAAS+wB,GAGxCI,EAAa3qB,MAAMC,KACvB,IAAI2qB,IACFta,EACGua,OACA9Y,cACAqO,MAAM,aAGP0K,EAAmBH,EAAWnxB,OAG9BuxB,EAAe,IAAI/iB,WAAW8iB,GAC9BE,EAAqB,IAAIC,WAAWH,GAAkBI,MAAM,GAEzDlc,EAAIqb,EAAYrb,EAAI8b,EAAkB9b,IAAK,CAClD+b,EAAa/b,GAAK2b,EAAW3b,GAAGxV,OAChC,IAAK,IAAI8G,EAAI,EAAG6qB,EAAIlD,EAAWzuB,OAAQ8G,EAAI6qB,EAAG7qB,IAAK,CACjD,IAAM8qB,EAAWtD,GAAY6C,EAAW3b,GAAIiZ,EAAW3nB,IACnD8qB,GAAYL,EAAa/b,KAC3B+b,EAAa/b,GAAKoc,EAClBJ,EAAmBhc,GAAK1O,EAE5B,CACF,CAIA,IADA,IAAI+qB,EAAc,GACT/qB,EAAIwqB,EAAmB,EAAGxqB,GAAK,EAAGA,IACzC,KAAI0qB,EAAmB1qB,GAAK,GAA5B,CACA,IAAMyO,EAAMoZ,EAAc,IAAI6C,EAAmB1qB,OAAS,GACtDgqB,GAAkBvb,EAAIvV,OAASixB,GACnCY,EAAY9qB,KAAKwO,EAHsB,CAMzC,IAAMuc,EAAoBD,EAAY7xB,OAEtC,GAA0B,IAAtB8xB,EAAyB,MAAO,GAGpCD,EAAYjU,KAAK,SAACrU,EAAGsU,GAAC,OAAKtU,EAAEvJ,OAAS6d,EAAE7d,MAAM,GAI9C,IADA,IAAI+xB,EAAaF,EAAY,GACpB/qB,EAAI,EAAGA,EAAIgrB,EAAmBhrB,IACrCirB,EAAatc,GAAgBsc,EAAYF,EAAY/qB,IAKvD,IADA,IAAMkrB,EAAS,GACNlrB,EAAI,EAAG6qB,EAAII,EAAW/xB,OAAQ8G,EAAI6qB,EAAG7qB,IAAK,CAEjD,IADA,IAAIqS,EAAQ,EACH3D,EAAI8b,EAAmB,EAAG9b,GAAK,EAAGA,IACrCgc,EAAmBhc,GAAK,IACFmZ,EAAc,IAAI6C,EAAmBhc,OAAS,IAClDK,QAAQkc,EAAWjrB,KAAO,IAC9CqS,GAAS3D,GAGbwc,EAAOjrB,KAAK,CACV6O,KAAM8Y,EAAMqD,EAAWjrB,IACvBqS,MAAOA,GAEX,CAGA,OADA6Y,EAAOpU,KAAK,SAACrU,EAAGsU,GAAC,OAAKA,EAAE1E,MAAQ5P,EAAE4P,KAAK,GAChC6Y,CACT,CEhE0BC,CAAyBnb,GACzCiJ,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACnBupB,GAAa,IAAlC,IAAAxpB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAoC,KAC5BipB,EAAgBT,GADP9oB,EAAAlD,MACsC4R,MACrDmK,EAASnB,YAAY6R,EAAchmB,QACrC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD8oB,EAAoCJ,UAAY,GAChDI,EAAoCvQ,OAAOL,GAC3C4Q,EAAoCnR,aAAa,YAAaoR,EAAc5wB,OAAS,EAAI,OAAS,SAClGswB,EAAuB9Q,aAAa,YAAaoR,EAAc5wB,OAAS,EAAI,QAAU,OACxF,CACF,CAkBO,SAASkyB,GAAuB7hB,GAGrC,OAFAwQ,GAAgB,sBAERxQ,GACN,IAAK,SACHuf,GAAgB,SACgBplB,EAAqBqlB,GAAmB,gDACxE,MACF,IAAK,UACHD,GAAgB,UACgBplB,EAAqBslB,GAAoB,gDAKzEd,IACFe,GAAwBvQ,aAAa,YAAa,QAjErD,WAE+C6Q,GAAAzsB,MAAC,KAAD7D,UAAA,CAgE5CoyB,CAAkCvC,IFtF/B,WAA8CpB,GAAA5qB,MAAC,KAAD7D,UAAA,CEuFjDqyB,IAEAC,GAAc,uBAAwB,UAE1C,CAEO,SAASlC,KACdmC,GAAkB,sBAClBvC,GAAwBvQ,aAAa,YAAa,QACpD,CCpGA,IAAM+S,GAAqBroB,EAAsB,OAC3CsoB,GAA2BhoB,EAAqB+nB,GAAoB,OACpEE,GAA6BjoB,EAAqBgoB,GAA0B,OAC5EE,GAAmBloB,EAAqBioB,GAA4B,sCACpEE,GAAmBnoB,EAAqBioB,GAA4B,0CAoBnE,SAASG,KACd/R,GAAgB,iBAChB0R,GAAmB/S,aAAa,YAAa,QAC7CwB,IACF,CAEO,SAAS6R,KAEdN,GAAmB/S,aAAa,YAAa,SAC7C0B,IACF,C,y/BA7BsC1W,EAAqBioB,GAA4B,oDAEzDxC,QAAU,WACtCiC,GAAuB,UACzB,ECNA,IAAMY,GAAoB5oB,EAAsB,OAC1C6oB,GAA0BvoB,EAAqBsoB,GAAmB,OAClEE,GAAoBxoB,EAAqBuoB,GAAyB,OAClEE,GAA0BzoB,EAAqBsoB,GAAmB,OAClEI,GAA4B1oB,EAAqByoB,GAAyB,OAC1EP,GAAmBloB,EAAqB0oB,GAA2B,sCACnEP,GAAmBnoB,EAAqB0oB,GAA2B,0CACnEC,GAAgC3oB,EAAqB0oB,GAA2B,wCAChFE,GAAuB5oB,EAAqB0oB,GAA2B,mCAM7E,SAASG,GAAsBtJ,EAAgBnU,GAC7C,IAAMmI,EAAa1R,KAGbinB,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYxb,GAAKiG,EACjBuV,EAAYroB,UAAUkT,IAAI,MAC1BmV,EAAY9T,aAAa,OAAQ5J,EAAK5G,MAGtC,IAAIukB,EAAU,GACVC,EAAO,GACP1Z,EAAwB,GAC5B,OAAQlE,EAAK5G,MACX,IAAK,OACH8K,EAAO,cACPyZ,EAAU,GAAG3d,EAAK4V,MAAQ5V,EAAK4V,MAAM/pB,KAAO,SAASmU,EAAK4V,MAAQ,CAAC5V,EAAK4V,MAAM+B,UAAUE,YAAa7X,EAAK4V,MAAM+B,UAAUC,UAAW,IAAI5X,EAAK0X,UAAY1X,EAAK0X,UAAY,GAAK,KAChLkG,EAAO5d,EAAKnU,KACZ,MACF,IAAK,QACHqY,EAAO,QACPyZ,EAAU,GAAG3d,EAAK2X,UAAUC,eAAoB5X,EAAK2X,UAAUE,cAC/D+F,EAAO5d,EAAKnU,KACZ,MACF,IAAK,WACHqY,EAAO,cACPyZ,EAAU,KACVC,EAAO5d,EAAKnU,KACZ,MACF,IAAK,MACH8xB,EAAU,GACVC,EAAO5d,EAAKnU,KACZ,MACF,IAAK,QACHqY,EAAO,YACPyZ,EAAU,KACVC,EAAO,OACP,MACF,QACE1Z,EAAO,GACPyZ,EAAU,OACVC,EAAO,OAKX,IAAMvV,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYZ,GAAelE,IAGvC,IAAM2Z,EAAiBrpB,SAAS8T,cAAc,OAC9CuV,EAAexoB,UAAUkT,IAAI,MAC7BsV,EAAe7U,YAAYxU,SAASspB,eAAeH,IAGnD,IAAMI,EAAcvpB,SAAS8T,cAAc,OAC3CyV,EAAY1oB,UAAUkT,IAAI,MAC1BwV,EAAY/U,YAAYxU,SAASspB,eAAeF,IAGhD,IAAMI,EAAiBxpB,SAAS8T,cAAc,OAC9C0V,EAAe3oB,UAAUkT,IAAI,MAG7B,IAAM0V,EAAgBzpB,SAAS8T,cAAc,OAC7C2V,EAAc5oB,UAAUkT,IAAI,MAC5B0V,EAAcjV,YAAYZ,GAAe,wBACzC6V,EAAc5D,QAAU,WACtB6D,GAAuB/V,EAAYgM,EAAOjS,GAAIlC,EAAK5G,KAAM4G,EAAKkC,GAAI,KACpE,EAGA,IAAMic,EAAkB3pB,SAAS8T,cAAc,OAC/C6V,EAAgB9oB,UAAUkT,IAAI,MAC9B4V,EAAgBnV,YAAYZ,GAAe,wBAC3C+V,EAAgB9D,QAAU,WACxB6D,GAAuB/V,EAAYgM,EAAOjS,GAAIlC,EAAK5G,KAAM4G,EAAKkC,GAAI,OACpE,EAGA,IAAMkc,EAAgB5pB,SAAS8T,cAAc,OAC7C8V,EAAc/oB,UAAUkT,IAAI,MAC5B6V,EAAcpV,YAAYZ,GAAe,WACzCgW,EAAc/D,QAAU,YAkEnB,SAAkCgE,EAAgBzL,EAAwBxZ,EAA6B8I,GAC5G,IAAMwb,EAAc9oB,EAAqBsoB,GAAmB,+CAAmKmB,MP+T1N,SAA+BC,EAAAC,EAAAC,GAAA,OAAA1H,GAAA9oB,MAAC,KAAD7D,UAAA,EO9TpCs0B,CAAiB7L,EAAUxZ,EAAM8I,GAAIwc,KAAK,SAAC1sB,GACzC,GAAIA,EAEF,OADA0rB,EAAYhT,SACJtR,GACN,IAAK,OACHqjB,GAAc,SAAU,SACxB,MACF,IAAK,QACHA,GAAc,SAAU,SACxB,MACF,IAAK,WACHA,GAAc,SAAU,cAM5BA,GAAc,QAAS,OAE3B,EACF,CAvFIkC,CAAyBxW,EAAYgM,EAAOjS,GAAIlC,EAAK5G,KAAM4G,EAAKkC,GAClE,EAGA,IAAM0c,EAAoBpqB,SAAS8T,cAAc,OACjDsW,EAAkBvpB,UAAUkT,IAAI,MAChC,IAAMsW,EAAoBrqB,SAAS8T,cAAc,OAgBjD,OAfAuW,EAAkBxpB,UAAUkT,IAAI,MAGhCyV,EAAehV,YAAYiV,GAC3BD,EAAehV,YAAYmV,GAC3BH,EAAehV,YAAYoV,GAC3BJ,EAAehV,YAAY4V,GAC3BZ,EAAehV,YAAY6V,GAG3BnB,EAAY1U,YAAYX,GACxBqV,EAAY1U,YAAY6U,GACxBH,EAAY1U,YAAY+U,GACxBL,EAAY1U,YAAYgV,GAEjB,CACLnpB,QAAS6oB,EACTxb,GAAIiG,EAER,CAEA,SAAS2W,GAAwB3K,EAAgBG,GAC/CwI,GAAiB1uB,MAAQ+lB,EAAOtoB,KAChCkxB,GAAiB3uB,MAAQ+lB,EAAOjQ,KAEhCkZ,GAAkB/C,QAAU,WAqFvB,IAA0BzH,EACzB/mB,EACAqY,EAFyB0O,EApFZuB,EAAOjS,GAqFpBrW,EAAOixB,GAAiB1uB,MACxB8V,EAAO6Y,GAAiB3uB,MAC9B0kB,GAAaF,EAAU/mB,EAAMqY,GAAMwa,KAAK,SAAU1sB,GAC5CA,GACF+sB,KACAtC,GAAc,eAAgB,UAE9BA,GAAc,QAAS,OAE3B,EA7FA,EAEAe,GAAqB7C,UAAY,GACjC,IAC0BrpB,EADpB6Y,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACrB6iB,GAAO,IAA1B,IAAA9iB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAA4B,KAAjBoO,EAAI1O,EAAAlD,MACP4wB,EAAkBvB,GAAsBtJ,EAAQnU,GACtDmK,EAASnB,YAAYgW,EAAgBnqB,QACvC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDurB,GAAqBhT,OAAOL,EAC9B,CAE0C,SAAA8U,KAKzC,OALyCA,IAAAhxB,EAAAA,EAAAA,GAA1C,UAA2C2kB,GAIzCkM,GAFe3L,GAAUP,SACHQ,GAAkBR,GAE1C,IAAC5kB,MAAA,KAAA7D,UAAA,CAEM,SAAS+0B,GAAiBtM,GAC/B3H,GAAgB,gBAChBiS,GAAkBtT,aAAa,YAAa,QAX7C,SAEyC5S,GAAAioB,GAAAjxB,MAAC,KAAD7D,UAAA,CAUxCg1B,CAA4BvM,GAC5BxH,IACF,CAEO,SAAS2T,KAEd7B,GAAkBtT,aAAa,YAAa,SAC5C0B,IACF,CA0BO,SAAS4S,GAAuBG,EAAgBzL,EAAwBxZ,EAA6B8I,EAAyBwV,GACnI,IAAMgG,EAAc9oB,EAAqBsoB,GAAmB,+CAAmKmB,MP4Z1N,SAAuCe,EAAAC,EAAAC,EAAAC,GAAA,OAAA/G,GAAAxqB,MAAC,KAAD7D,UAAA,EO3Z5Cq1B,CAAyB5M,EAAUxZ,EAAM8I,EAAIwV,GAAWgH,KAAK,SAAC1sB,GAC5D,GAAIA,EACF,OAAQ0lB,GACN,IAAK,KACH,IAAM+H,EAAkB/B,EAAYgC,uBAChCD,GACF/B,EAAYiC,WAAWC,aAAalC,EAAa+B,GAEnDhD,GAAc,kBAAmB,QACjC,MACF,IAAK,OACH,IAAMoD,EAAcnC,EAAYtoB,mBAC5ByqB,GACFnC,EAAYiC,WAAWC,aAAaC,EAAanC,GAEnDjB,GAAc,oBAAqB,aAMvCA,GAAc,QAAS,OAE3B,EACF,C,y/BA5MAc,GAA8BlD,QAAU,WACtCiC,GAAuB,SACzB,ECfA,IAAMwD,GAAqBxrB,EAAsB,OAC3CyrB,GAA2BnrB,EAAqBkrB,GAAoB,OACpEE,GAAiCprB,EAAqBmrB,GAA0B,OAEtF,SAAStC,GAAsBzd,GAE7B,IAAMigB,EAAoBzrB,SAAS8T,cAAc,OACjD2X,EAAkB5qB,UAAUkT,IAAI,MAChC0X,EAAkB5F,QAAU,WAC1B6E,GAAiBlf,EAAKkC,GACxB,EAGA,IAAMmG,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYZ,GAAepI,EAAKkE,OAG5C,IAAMgc,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAC1B2X,EAAYlX,YAAYxU,SAASspB,eAAe9d,EAAKnU,OAGrD,IAAMs0B,EAAgB3rB,SAAS8T,cAAc,OAC7C6X,EAAc9qB,UAAUkT,IAAI,MAC5B4X,EAAcnX,YAAYxU,SAASspB,eAAevzB,OAAOyV,EAAKlQ,iBAG9D,IAAMswB,EAAe5rB,SAAS8T,cAAc,OAU5C,OATA8X,EAAa/qB,UAAUkT,IAAI,MAC3B6X,EAAapX,YAAYZ,GAAe,sBAGxC6X,EAAkBjX,YAAYX,GAC9B4X,EAAkBjX,YAAYkX,GAC9BD,EAAkBjX,YAAYmX,GAC9BF,EAAkBjX,YAAYoX,GAEvB,CACLvrB,QAASorB,EACT/d,GAAI,GAER,CAE2C,SAAAme,KAS1C,OAT0CA,IAAApyB,EAAAA,EAAAA,GAA3C,YACE,IAAM2mB,QAA2Bd,KACjCkM,GAA+BrF,UAAY,GAC3C,IACqCrpB,EAD/B6Y,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACrBmjB,GAAkB,IAArC,IAAApjB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAuC,KAC/B0uB,EAAiB7C,GADVnsB,EAAAlD,OAEb+b,EAASnB,YAAYsX,EAAezrB,QACtC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD+tB,GAA+BxV,OAAOL,EACxC,IAACnc,MAAA,KAAA7D,UAAA,CAEM,SAASo2B,KACdtV,GAAgB,iBAChB6U,GAAmBlW,aAAa,YAAa,QAf9C,WAE0CyW,GAAAryB,MAAC,KAAD7D,UAAA,CAczCq2B,EAEF,CAEO,SAASC,KACd/D,GAAkB,iBAClBoD,GAAmBlW,aAAa,YAAa,QAE/C,C,y/BCzDO,SAAe8W,GAAsB1pB,EAAApJ,EAAAC,EAAAC,EAAAY,EAAAC,GAAA,OAAAgyB,GAAA3yB,MAAC,KAAD7D,UAAA,CAoC3C,SAAAw2B,KAAA,OAAAA,IAAA1yB,EAAAA,EAAAA,GApCM,UAAsCpC,EAAc+0B,EAAoBC,EAAsBC,EAAkBC,EAAoBC,GACzI,IAAM7Y,EAAa1R,KACnB,GAAImqB,EAAa,GAAKA,EAAa,IAAMC,EAAe,GAAKA,EAAe,IAAMC,EAAW,GAAKA,EAAW,IAAMC,EAAa,GAAKA,EAAa,GAChJ,OAAO,EAET,KAAKE,OAAOC,UAAUN,IAAgBK,OAAOC,UAAUL,IAAkBI,OAAOC,UAAUJ,IAAcG,OAAOC,UAAUH,IACvH,OAAO,EAET,GAAIC,EAAK52B,OAAS,EAChB,OAAO,EACR,IACqBkH,EADrBE,EAAAC,GACiBuvB,GAAI,IAAtB,IAAAxvB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb9F,EAAGwF,EAAAlD,MACZ,GAAmB,iBAARtC,IACLA,EAAM,GAAKA,EAAM,IAAMm1B,OAAOC,UAAUp1B,IAC1C,OAAO,CAGb,CAAC,OAAA0C,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAED,IAAMH,EAA2B,CAC/BjG,KAAMA,EACNs1B,OAAQ,CACN/qB,MAAO,CACLhN,MAAOw3B,EACPv3B,QAASw3B,GAEXO,IAAK,CACHh4B,MAAO03B,EACPz3B,QAAS03B,IAGbC,KAAMA,EACN9e,GAAIiG,GAGN,aADMxa,EAAU,EAAGwa,EAAYlY,KAAKQ,UAAUqB,KACvC,CACT,IAAC9D,MAAA,KAAA7D,UAAA,CAEM,SAAek3B,GAAmBtyB,GAAA,OAAAuyB,GAAAtzB,MAAC,KAAD7D,UAAA,CAMxC,SAAAm3B,KAAA,OAAAA,IAAArzB,EAAAA,EAAAA,GANM,UAAmCszB,GACxC,IAAMC,QAAiC/yB,EAAU,EAAG8yB,GACpD,GAAIC,EAEF,OADevxB,KAAKC,MAAMsxB,EAG9B,IAACxzB,MAAA,KAAA7D,UAAA,CAEM,SAAes3B,GAAsBzyB,GAAA,OAAA0yB,GAAA1zB,MAAC,KAAD7D,UAAA,CAK3C,SAAAu3B,KAAA,OAAAA,IAAAzzB,EAAAA,EAAAA,GALM,UAAsC0zB,UACRN,GAAoBM,EAAiBzf,aAEhEvU,EAAU,EAAGg0B,EAAiBzf,GAAIjS,KAAKQ,UAAUkxB,IAE3D,IAAC3zB,MAAA,KAAA7D,UAAA,CAEM,SAAey3B,KAAqB,OAAAC,GAAA7zB,MAAC,KAAD7D,UAAA,CAoB1C,SAAA03B,KAAA,OAAAA,IAAA5zB,EAAAA,EAAAA,GApBM,YACL,IAEsBiS,EAFhBjP,EAAgC,GACDkP,EAAA1O,SAAlBtC,EAAe,IACZ,IAAtB,IAAAgR,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAwB,KAAbzD,EAAG+R,EAAA9R,MACNozB,QAAiC/yB,EAAU,EAAGN,GACpD,GAAIqzB,EAA0B,CAC5B,IAAMM,EAAiC7xB,KAAKC,MAAMsxB,GAClDvwB,EAAOE,KAAK2wB,EACd,CACF,CAAC,OAAAtzB,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CAUD,OARAhB,EAAO+W,KAAK,SAAUrU,EAAGsU,GACvB,OAA4B,GAArBtU,EAAEwtB,OAAOC,IAAIh4B,MAAauK,EAAEwtB,OAAOC,IAAI/3B,SAAgC,GAArB4e,EAAEkZ,OAAOC,IAAIh4B,MAAa6e,EAAEkZ,OAAOC,IAAI/3B,QAClG,GAEA4H,EAAO+W,KAAK,SAAUrU,EAAGsU,GACvB,OAA8B,GAAvBtU,EAAEwtB,OAAO/qB,MAAMhN,MAAauK,EAAEwtB,OAAO/qB,MAAM/M,SAAkC,GAAvB4e,EAAEkZ,OAAO/qB,MAAMhN,MAAa6e,EAAEkZ,OAAO/qB,MAAM/M,QAC1G,GAEO4H,CACT,IAACjD,MAAA,KAAA7D,UAAA,CA4CA,SAAA43B,KAAA,OAAAA,IAAA9zB,EAAAA,EAAAA,GA1CM,YACL,IAIgD0Y,EAF1C1V,EAAyC,CAAC,EAAE8V,EAAAtV,SAFlBmwB,MAIgB,IAAhD,IAAA7a,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAkD,KACTwe,EAD9BuR,EAAgBhb,EAAAvY,MAAAiiB,EAAA5e,GACPkwB,EAAiBX,MAAI,IAAvC,IAAA3Q,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAyC,KACjCowB,EAAS,KADH5R,EAAAhiB,QAEP6C,EAAOqG,eAAe0qB,KACzB/wB,EAAO+wB,GAAU,IAEnB,IAAMlwB,EAAS,CACbsE,MAAOurB,EAAiBR,OAAO/qB,MAC/BgrB,IAAKO,EAAiBR,OAAOC,KAE/BnwB,EAAO+wB,GAAQ7wB,KAAKW,EACtB,CAAC,OAAAtD,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACH,CAAC,OAAAzD,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CAED,IAAK,IAAM+vB,KAAU/wB,EAAQ,CAI3B,IAHA,IAAMgxB,EAA6BhxB,EAAO+wB,GACpCE,EAAmCD,EAA2B73B,OAC9D+3B,EAAmC,GAChCjxB,EAAI,EAAGA,EAAIgxB,EAAkChxB,IAAK,CACzD,IAAMkxB,EAAoCH,EAA2B/wB,EAAI,IAAM+wB,EAA2B/wB,GACpGmxB,EAAmCJ,EAA2B/wB,GACpB,IAA5CixB,EAAiC/3B,OACnC+3B,EAAiChxB,KAAKkxB,GAGa,GAA/CA,EAAiCjsB,MAAMhN,MAAai5B,EAAiCjsB,MAAM/M,SAA2D,GAAhD+4B,EAAkChsB,MAAMhN,MAAag5B,EAAkChsB,MAAM/M,SAA0D,GAA/Cg5B,EAAiCjsB,MAAMhN,MAAai5B,EAAiCjsB,MAAM/M,SAAyD,GAA9C+4B,EAAkChB,IAAIh4B,MAAag5B,EAAkChB,IAAI/3B,SAC/Y84B,EAAiCA,EAAiC/3B,OAAS,GAAGg3B,IAAIh4B,MAAQi5B,EAAiCjB,IAAIh4B,MAC/H+4B,EAAiCA,EAAiC/3B,OAAS,GAAGg3B,IAAI/3B,QAAUg5B,EAAiCjB,IAAI/3B,SAEjI84B,EAAiChxB,KAAKkxB,EAG5C,CACApxB,EAAO+wB,GAAUG,CACnB,CAEA,OAAOlxB,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAkBA,SAAAm4B,KAAA,OAAAA,IAAAr0B,EAAAA,EAAAA,GAhBM,UAAoC9E,GACzC,IAAMo5B,QA7CD,WAAgD,OAAAR,GAAA/zB,MAAC,KAAD7D,UAAA,CA6C9Bq4B,GAEjBR,EAAS,KADH74B,EAAKs5B,WAEXr5B,EAAQD,EAAKsB,WACbpB,EAAUF,EAAKuB,aAErB,GAAI63B,EAASjrB,eAAe0qB,GAAS,CACnC,IACgEvf,EADbC,EAAAjR,GAAjB8wB,EAASP,IACqB,IAAhE,IAAAtf,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAAkE,KAAvD8wB,EAAwBjgB,EAAArU,MACjC,GAAY,GAARhF,EAAaC,GAAkD,GAAvCq5B,EAAyBtsB,MAAMhN,MAAas5B,EAAyBtsB,MAAM/M,SAAmB,GAARD,EAAaC,GAAgD,GAArCq5B,EAAyBtB,IAAIh4B,MAAas5B,EAAyBtB,IAAI/3B,QAC/M,OAAO,CAEX,CAAC,OAAAmF,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CACH,CACA,OAAO,CACT,GAACqwB,GAAAt0B,MAAA,KAAA7D,UAAA,CCjJD,IAAMw4B,GAA8BruB,EAAsB,OACpDsuB,GAAoChuB,EAAqB+tB,GAA6B,OACtFE,GAAoCjuB,EAAqB+tB,GAA6B,OACtFG,GAAoBluB,EAAqBiuB,GAAmC,OAC5EE,GAA+BnuB,EAAqBguB,GAAmC,OACvFI,GAAmBpuB,EAAqBmuB,GAA8B,wCACtEE,GAAwBruB,EAAqBmuB,GAA8B,8CAC3EG,GAAsBtuB,EAAqBmuB,GAA8B,4CACzEI,GAAsBvuB,EAAqBmuB,GAA8B,kCACzEK,GAActuB,EAAwBquB,GAAqB,OAE1D,SAAeE,GAA0BrsB,GAAA,OAAAssB,GAAAt1B,MAAC,KAAD7D,UAAA,CAgC/C,SAAAm5B,KAAA,OAAAA,IAAAr1B,EAAAA,EAAAA,GAhCM,UAA0CszB,GAa/C,IAZA,IAAM11B,EAAOm3B,GAAiB50B,MACxBm1B,EAAYN,GAAsB70B,MAClCo1B,EAAUN,GAAoB90B,MAEpCq1B,EAAmCl5B,OAAOg5B,GACvCvS,MAAM,KACN1lB,IAAI,SAAC0G,GAAC,OAAK9F,SAAS8F,EAAE,GAAC0xB,GAAA/sB,EAAAA,EAAAA,GAAA8sB,EAAA,GAFnB7C,EAAU8C,EAAA,GAAE7C,EAAY6C,EAAA,GAG/BC,EAA+Bp5B,OAAOi5B,GACnCxS,MAAM,KACN1lB,IAAI,SAAC0G,GAAC,OAAK9F,SAAS8F,EAAE,GAAC4xB,GAAAjtB,EAAAA,EAAAA,GAAAgtB,EAAA,GAFnB7C,EAAQ8C,EAAA,GAAE7C,EAAU6C,EAAA,GAIvB5C,EAAO,GACF9vB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAM2yB,EAAiBT,GAAYlyB,GAC7B4yB,EAAcD,EAAeE,aAAa,eAC1Cj4B,EAAMI,SAAS23B,EAAeE,aAAa,QAC7B,SAAhBD,GACF9C,EAAK7vB,KAAKrF,EAEd,CAEA,IAAI61B,QAAyBN,GAAoBE,GACjDI,EAAiB91B,KAAOA,EACxB81B,EAAiBX,KAAOA,EACxBW,EAAiBR,OAAO/qB,MAAMhN,MAAQw3B,EACtCe,EAAiBR,OAAO/qB,MAAM/M,QAAUw3B,EACxCc,EAAiBR,OAAOC,IAAIh4B,MAAQ03B,EACpCa,EAAiBR,OAAOC,IAAI/3B,QAAU03B,QAEhCU,GAAuBE,GAC7BqC,IACF,IAACh2B,MAAA,KAAA7D,UAAA,CAEmD,SAAA85B,KAiBnD,OAjBmDA,IAAAh2B,EAAAA,EAAAA,GAApD,UAAqDszB,GACnD,IAAMI,QAAyBN,GAAoBE,GACnDyB,GAAiB50B,MAAQuzB,EAAiB91B,KAC1Co3B,GAAsB70B,MAAQjC,EAAmBw1B,EAAiBR,OAAO/qB,OACzE8sB,GAAoB90B,MAAQjC,EAAmBw1B,EAAiBR,OAAOC,KAEvE,IAAK,IAAIlwB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAM2yB,EAAiBT,GAAYlyB,GAC/BywB,EAAiBX,KAAK/gB,QAAQ/O,IAAM,EACtC2yB,EAAeja,aAAa,cAAe,QAE3Cia,EAAeja,aAAa,cAAe,QAE/C,CACAkZ,GAAkBzI,QAAU,WAC1BgJ,GAA2B9B,EAC7B,CACF,IAACvzB,MAAA,KAAA7D,UAAA,CAEM,SAAS+5B,GAA2B3C,GACzCtW,GAAgB,0BAChB0X,GAA4B/Y,aAAa,YAAa,QAvBvD,SAEmDhc,GAAAq2B,GAAAj2B,MAAC,KAAD7D,UAAA,CAsBlDg6B,CAAsC5C,GACtCnW,IACF,CAEO,SAAS4Y,KAEdrB,GAA4B/Y,aAAa,YAAa,SACtD0B,IACF,C,y/BC1EA,IAAM8Y,GAA+B9vB,EAAsB,OACrD+vB,GAAqCzvB,EAAqBwvB,GAA8B,OACxFE,GAAc1vB,EAAqByvB,GAAoC,OAE7E,SAAS5G,GAAsBzd,GAI7B,IAAM0d,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAE1BmV,EAAYrD,QAAU,WACpB6J,GAA2BlkB,EAAKkC,GAClC,EAGA,IAAMge,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAC1B2X,EAAYlX,YAAYxU,SAASspB,eAAe9d,EAAKnU,OACrD6xB,EAAY1U,YAAYkX,GAGxB,IAAME,EAAe5rB,SAAS8T,cAAc,OAC5C8X,EAAa/qB,UAAUkT,IAAI,MAC3B,IAAMF,EAAc7T,SAAS8T,cAAc,QAK3C,OAJAD,EAAYW,YAAYZ,GAAe,sBACvCgY,EAAapX,YAAYX,GACzBqV,EAAY1U,YAAYoX,GAEjB,CACLvrB,QAAS6oB,EACTxb,GAAI,GAER,CACqD,SAAAqiB,KASpD,OAToDA,IAAAt2B,EAAAA,EAAAA,GAArD,YACEq2B,GAAY3J,UAAY,GACxB,IAEoCrpB,EAF9BkzB,QAA0B5C,KAC1BzX,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACrB+yB,GAAiB,IAApC,IAAAhzB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAsC,KAC9B0X,EAAcmU,GADPnsB,EAAAlD,OAEb+b,EAASnB,YAAYM,EAAYzU,QACnC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDqyB,GAAY9Z,OAAOL,EACrB,IAACnc,MAAA,KAAA7D,UAAA,CAEM,SAASs6B,KACdxZ,GAAgB,2BAChBmZ,GAA6Bxa,aAAa,YAAa,QAdxD,WACoD2a,GAAAv2B,MAAC,KAAD7D,UAAA,CAcnDu6B,EACF,CAEO,SAASC,KACdjI,GAAkB,2BAClB0H,GAA6Bxa,aAAa,YAAa,QACzD,CC1DO,SAASgb,GAAsBC,GACpC,GAA6B,KAAzBC,GACF,OAAO,EAET,IAAM5tB,EAAM,IAAI1E,IAAIsyB,IACpB,MAAI,CAAC,SAAU,WAAY,WAAY,SAAU,cAAc7kB,QAAQ4kB,IAAW,IAChF3tB,EAAI6tB,aAAa9rB,IAAI,SAAU4rB,GACxB3tB,EAAI8tB,WAIf,CCVO,SAASC,GAAqBC,EAA4CC,EAAsCC,GACrH,IAAM7zB,GAAM,IAAIhI,MAAOuB,UAIvB,OADeu6B,GAAOA,GAAO,GAAGH,MAAcC,OADnC5zB,EAAOA,EADH,aAEgD8zB,GAAO,GAAGH,MAAcC,MAAWE,GAAOp1B,KAAKQ,UAAU20B,UAE1H,CCLO,SAASE,GAA2BT,EAAwCU,GACjF,OAAQV,GACN,IAAK,SACH,MAA6B,KAAzBW,IAAsD,KAAvBC,IAAmD,IAAtBF,EAAWn7B,QAGlE,CACL86B,UAAWM,GACXE,MAAOT,GAAqBO,GAAsBC,GAAoB,CAAEE,YAAaJ,EAAW,KAChGI,YAAaJ,EAAW,IAI9B,IAAK,WACH,GAA0B,IAAtBA,EAAWn7B,OACb,OAAO,EAEP,IAAMw7B,EAAc,IAAIr8B,KAGxB,OAFAq8B,EAAY/7B,gBAAgB,GAC5B+7B,EAAYh8B,WAAW,GAChB,CACLyY,KAAMgjB,GAAO,GAAGA,GAAOE,EAAW,MAAMK,EAAY96B,cAI1D,IAAK,WACH,MAA6B,KAAzB06B,IAAsD,KAAvBC,IAAmD,IAAtBF,EAAWn7B,QAGlE,CACL86B,UAAWM,GACXE,MAAOT,GAAqBO,GAAsBC,GAAoB,CAAEI,QAASN,EAAW,GAAIO,cAAeP,EAAW,GAAIQ,SAAUR,EAAW,GAAIS,WAAYT,EAAW,GAAI7N,UAAW6N,EAAW,GAAIlX,cAAekX,EAAW,GAAI1Q,qBAAsB0Q,EAAW,GAAIU,YAAaV,EAAW,GAAIW,eAAgBX,EAAW,KACtUM,QAASN,EAAW,GACpBO,cAAeP,EAAW,GAC1BQ,SAAUR,EAAW,GACrBS,WAAYT,EAAW,GACvB7N,UAAW6N,EAAW,GACtBlX,cAAekX,EAAW,GAC1B1Q,qBAAsB0Q,EAAW,GACjCU,YAAaV,EAAW,GACxBW,eAAgBX,EAAW,IAIjC,IAAK,SACH,MAA6B,KAAzBC,IAAsD,KAAvBC,IAAmD,IAAtBF,EAAWn7B,QAGlE,CACL86B,UAAWM,GACXE,MAAOT,GAAqBO,GAAsBC,GAAoB,CAAC,IAI7E,IAAK,aACH,MAA6B,KAAzBD,IAAsD,KAAvBC,IAAmD,IAAtBF,EAAWn7B,QAGlE,CACL86B,UAAWM,GACXE,MAAOT,GAAqBO,GAAsBC,GAAoB,CAAEE,YAAaJ,EAAW,GAAIlX,cAAekX,EAAW,GAAIW,eAAgBX,EAAW,KAC7JI,YAAaJ,EAAW,GACxBlX,cAAekX,EAAW,GAC1BW,eAAgBX,EAAW,IAIjC,QACE,OAAO,EAGb,CCrCO,SAAeY,GAAuBnvB,EAAApJ,EAAAC,GAAA,OAAAu4B,GAAAp4B,MAAC,KAAD7D,UAAA,CA8D5C,SAAAi8B,KAAA,OAAAA,IAAAn4B,EAAAA,EAAAA,GA9DM,UAAuC42B,EAAwC3tB,EAAqBiB,GACzG,IACE,IAAY,IAARjB,IAA0B,IAATiB,EACnB,OAAO,EAGT,IAAMkuB,EAAiB,CACrBxB,OAAQ,OACR7sB,QAAS,CACP,eAAgB,oBAElBG,KAAMlI,KAAKQ,UAAU0H,GACrBmuB,YAAa,QAIT1uB,QAAiBC,MAAMX,EAAKmvB,GAElC,IAAKzuB,EAASE,GAAI,OAEQF,EAAS0G,OAMjC,OAAO,CACT,CAGA,IACE,IAAMA,QAAa1G,EAAS0G,OACtBzM,EAAO5B,KAAKC,MAAMoO,GACxB,OAAQumB,GACN,IAAK,SAGL,IAAK,WAGL,IAAK,WAGL,IAAK,SAGL,IAAK,aACH,OAAOhzB,EAET,QACE,OAAO,EAGb,CAAE,MAAO00B,GAEP,MAAM,IAAIzvB,MAAM,oCAClB,CACF,CAAE,MAAO0vB,GAGP,OAAO,CACT,CACF,IAACx4B,MAAA,KAAA7D,UAAA,CC7EA,SAAAs8B,KAAA,OAAAA,IAAAx4B,EAAAA,EAAAA,GAlBM,YACL,GAA6B,KAAzBu3B,IAAsD,KAAvBC,GACjC,OAAO,EAET,IAAMvuB,EAAM0tB,GAAsB,UAC5B8B,EAAcpB,GAA2B,SAAU,IACnD1tB,QAAiBuuB,GAAwB,SAAUjvB,EAAKwvB,GAC9D,OAAiB,IAAb9uB,IAGoB,MAAlBA,EAAS7L,MAAoC,WAApB6L,EAASitB,SACpC8B,GAAsB/uB,EAASutB,cACzByB,MACC,GAKb,IAAC54B,MAAA,KAAA7D,UAAA,CCmBA,SAAA08B,KAAA,OAAAA,IAAA54B,EAAAA,EAAAA,GApCM,UAAoC43B,EAA0CC,EAAsDC,EAA4CC,EAAgDtO,EAA8CrJ,EAAsDwG,EAAoEoR,EAAkDC,GAC/b,GAA6B,KAAzBV,IAAsD,KAAvBC,SAAyCp7B,IAAZw7B,QAA2Cx7B,IAAlBy7B,QAA4Cz7B,IAAb07B,QAAyC17B,IAAf27B,QAA0C37B,IAAdqtB,QAA6CrtB,IAAlBgkB,GAA+D,iBAAzBwG,QAAwDxqB,IAAnB67B,EAClR,OAAO,EAET,IAAIY,EAA0B,IAAIv9B,KAClC,QAAA2Q,EAAAA,EAAAA,GAAegsB,IACb,IAAK,SAGL,IAAK,SACHY,EAA0B,IAAIv9B,KAAK28B,GACnC,MACF,QACE,KAAIA,aAA0B38B,MAG5B,OAAO,EAFPu9B,EAA0BZ,EAMhC,IAAMhvB,EAAM0tB,GAAsB,YAC5B8B,EAAcpB,GAA2B,WAAY,CAACO,EAASC,EAAeC,EAAUC,EAAYtO,EAAWrJ,EAAewG,EAAsBoR,EAAaa,EAAwBnhB,gBACzL/N,QAAiBuuB,GAAwB,WAAYjvB,EAAKwvB,GAChE,OAAiB,IAAb9uB,IAGoB,MAAlBA,EAAS7L,MAAoC,aAApB6L,EAASitB,SAChC75B,KAAKilB,SAAW,WD5BnB,WAAuC,OAAAwW,GAAAz4B,MAAC,KAAD7D,UAAA,CC6BhC48B,UCkFP,SAAuC/vB,EAAApJ,EAAAC,EAAAC,EAAAY,EAAAC,EAAAI,EAAAC,EAAAI,EAAA+mB,GAAA,OAAA6Q,GAAAh5B,MAAC,KAAD7D,UAAA,CDhFlC88B,CAAyBrvB,EAAS+tB,YAAaE,EAASC,EAAeC,EAAUC,EAAYtO,EAAWrJ,EAAewG,EAAsBoR,EAAaa,EAAwBh8B,WACjL8M,EAAS+tB,aAKtB,GAACkB,GAAA74B,MAAA,KAAA7D,UAAA,C,y/BCbM,IAAI26B,GAAuD,GACvDU,GAAwD,GACxDC,GAAmD,GAExDyB,GAAoD,GACpDC,GAEF,CAAC,EACCC,GAEF,CAAC,EAEE,SAAeR,KAAsB,OAAAS,GAAAr5B,MAAC,KAAD7D,UAAA,CAO3C,SAAAk9B,KAAA,OAAAA,IAAAp5B,EAAAA,EAAAA,GAPM,YACL,IAAMq5B,EAAoC,CACxCC,SAAUzC,GACVI,UAAWM,GACXL,OAAQM,UAEJ93B,EAAU,EAAG,WAAYsC,KAAKQ,UAAU62B,GAChD,IAACt5B,MAAA,KAAA7D,UAAA,CAUA,SAAAq9B,KAAA,OAAAA,IAAAv5B,EAAAA,EAAAA,GARM,YACL,IAAMw5B,QAAuBh5B,EAAU,EAAG,YAC1C,GAAIg5B,EAAgB,CAClB,IAAMC,EAAuBz3B,KAAKC,MAAMu3B,GACxC3C,GAAuB4C,EAAqBH,SAC5C/B,GAAuBkC,EAAqBxC,UAC5CO,GAAqBiC,EAAqBvC,MAC5C,CACF,IAACn3B,MAAA,KAAA7D,UAAA,CAEM,SAASw9B,KACd,MAA6B,KAAzBnC,IAAsD,KAAvBC,EAKrC,CAqBO,SAASkB,GAAsBxB,QACrB96B,IAAX86B,IACFM,GAAqBl7B,OAAO46B,GAEhC,CAuBC,SAAAyC,KAAA,OAAAA,IAAA35B,EAAAA,EAAAA,GArBM,aACO,IAAI1E,MAAOuB,UAAvB,IAGsBslB,EADlBxkB,EAAgB,EAAEykB,EAAA5e,SADHtC,EAAe,KAEZ,IAAtB,IAAAkhB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAwB,KAAbzD,EAAGiiB,EAAAhiB,MACNy5B,QAAyBp5B,EAAU,GAAIN,GACvC25B,EAAe73B,KAAKC,MAAM23B,GAG1BE,EAAiBD,EAAanC,YAE9BqC,EAAsB,KADDF,EAAajC,UAExCqB,GAAqB/1B,KAAK22B,GAC1BX,GAA0BY,GAAkBn8B,EACvCw7B,GAAgC9vB,eAAe0wB,KAClDZ,GAAgCY,GAAuB,IAEzDZ,GAAgCY,GAAqB72B,KAAKvF,GAC1DA,GAAS,CAEX,CAAC,OAAA4C,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAwBA,SAAA68B,KAAA,OAAAA,IAAA/4B,EAAAA,EAAAA,GAtBM,UAAwC03B,EAAkDE,EAA0CC,EAAsDC,EAA4CC,EAAgDtO,EAA8CrJ,EAAsDwG,EAAoEoR,EAAkDC,GACrf,IAAM+B,EAAiD,CACrDtC,YAAaA,EACbE,QAASA,EACTC,cAAeA,EACfC,SAAUA,EACVC,WAAYA,EACZtO,UAAWA,EACXrJ,cAAeA,EACfwG,qBAAsBA,EACtBoR,YAAaA,EACbC,eAAgBA,GAEZgC,EAAkC,KAAKrC,IACvCsC,EAAgCjB,GAAqB98B,OAC3D88B,GAAqB/1B,KAAK82B,GAC1Bd,GAA0BxB,GAAewC,EACpCf,GAAgC9vB,eAAe4wB,KAClDd,GAAgCc,GAAmC,IAErEd,GAAgCc,GAAiC/2B,KAAKg3B,SAChEx6B,EAAU,GAAIg4B,EAAa11B,KAAKQ,UAAUw3B,GAClD,IAACj6B,MAAA,KAAA7D,UAAA,CA0CA,SAAAi+B,KAAA,OAAAA,IAAAn6B,EAAAA,EAAAA,GAXM,UAA0C03B,GAC/C,GAAIwB,GAA0B7vB,eAAequB,GAAc,CACzD,IAAM0C,EAAwBlB,GAA0BxB,GAGlDqC,EAAsB,KAFHd,GAAqBmB,GACFxC,UAE5CqB,GAAqBxW,OAAO2X,EAAuB,EAAG,MACtDjB,GAAgCY,GAAqBtX,OAAO0W,GAAgCY,GAAqB/nB,QAAQooB,GAAwB,UAC1IlB,GAA0BxB,SAC3B72B,EAAa,GAAI62B,EACzB,CACF,IAAC33B,MAAA,KAAA7D,UAAA,CAmCM,SAASm+B,GAA4B3jB,GAC1C,IAAMpT,GAAM,IAAIhI,MAAOuB,UACjB4qB,EAAc,KAAK/Q,IACzB,GAAIyiB,GAAgC9vB,eAAeoe,GAAc,CAC/D,IAC2B/O,EADkCI,EAAAtV,GAA7C21B,GAAgC1R,IACrB,IAA3B,IAAA3O,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAA6B,KAAlBhG,EAAK+a,EAAAvY,MACR05B,EAAeZ,GAAqBt7B,GAC1C,GAAqB,OAAjBk8B,EAEF,GAD0BA,EAAa5B,eACf30B,EACtB,OAAO,CAGb,CAAC,OAAA/C,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACH,CACA,OAAO,CACT,CAiBC,SAAAs2B,KAAA,OAAAA,IAAAt6B,EAAAA,EAAAA,GAfM,YACL,IAAMsD,GAAM,IAAIhI,MAAOuB,UACvB,IAAK,IAAM66B,KAAewB,GAA2B,CACnD,IAAMkB,EAAwBlB,GAA0BxB,GAClD6C,EAAmBtB,GAAqBmB,GAE9C,GAD0BG,EAAiBtC,gBAClB30B,EAAK,CAC5B,IACMy2B,EAAsB,KADDQ,EAAiB3C,UAE5CqB,GAAqBxW,OAAO2X,EAAuB,EAAG,MACtDjB,GAAgCY,GAAqBtX,OAAO0W,GAAgCY,GAAqB/nB,QAAQooB,GAAwB,UAC1IlB,GAA0BxB,SAC3B72B,EAAa,GAAI62B,EACzB,CACF,CACF,IAAC33B,MAAA,KAAA7D,UAAA,CA0BM,SAAes+B,GAA6BlK,GAAA,OAAAmK,GAAA16B,MAAC,KAAD7D,UAAA,CAoFlD,SAAAu+B,KAAA,OAAAA,IAAAz6B,EAAAA,EAAAA,GApFM,UAA6CkJ,GAClD,IAMwCsL,EANlC3B,QAAeC,GAAS5J,GAAW,GACnCwxB,EA9FD,WACL,IAE+Cr3B,EAFzCC,GAAM,IAAIhI,MAAOuB,UACjBmG,EAAsC,GAAGO,EAAAC,GACpBy1B,IAAoB,IAA/C,IAAA11B,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAiD,KAAtCk2B,EAAYx2B,EAAAlD,MACA,OAAjB05B,GACwBA,EAAa5B,eACf30B,GACtBN,EAAOE,KAAK22B,EAGlB,CAAC,OAAAt5B,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,CAkFgC23B,GACxBr3B,GAAM,IAAIhI,MAAOuB,UAEjB+b,EAAmD,GAAGnE,EAAAjR,GAEzCk3B,GAAqB,IAAxC,IAAAjmB,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAA0C,KAA/BoO,EAAIyC,EAAArU,MACPqnB,EAAiB,CAAC,EAClBoT,EAAe7oB,EAAK8lB,cAC1BrQ,EAAe5pB,KAAOg9B,EAEtB,IAAMC,EAAiB9oB,EAAK6lB,QAC5BpQ,EAAeoQ,QAAUiD,EAEzB,IAAMC,EAAuB/oB,EAAKqO,cAClCoH,EAAepH,cAAgB0a,EAE/B,IAAMC,EAAqBhpB,EAAK2lB,YAChClQ,EAAekQ,YAAcqD,EAE7B,IAAMC,EAAwBjpB,EAAKkmB,eACnCzQ,EAAeyQ,eAAiB+C,EAEhC,IAAMC,EAAoC,IAAI3/B,KAAK0/B,GAC7CE,EAAeD,EAAkCj/B,UACjDm/B,EAAgBF,EAAkCz+B,WAClD4+B,EAAkBH,EAAkCx+B,aAC1D+qB,EAAetsB,KAAOoB,OAAO4+B,GAAc3+B,SAAS,EAAG,KACvDirB,EAAersB,MAAQmB,OAAO6+B,GAAe5+B,SAAS,EAAG,KACzDirB,EAAepsB,QAAUkB,OAAO8+B,GAAiB7+B,SAAS,EAAG,KAE7DirB,EAAeG,MAAQ,CAAC,EACxB,IAAM3Q,EAAgBjF,EAAKgmB,WAC3BvQ,EAAeG,MAAM/pB,KAAOoZ,EAE5B,IAAMF,EAAc/E,EAAK+lB,SACzBtQ,EAAeG,MAAM1T,GAAK6C,EAE1B,IAAMI,EAAqBnF,EAAK0X,UAChCjC,EAAeG,MAAM8B,UAAYvS,EAGjC,IACMmkB,EAAmC,KADDtpB,EAAK+lB,WAG7C,GAAIjlB,EAAMxJ,eAAegyB,GAAzB,CAKA,IAAMC,EAJ4BzoB,EAAMwoB,GAI2C5nB,IACnF+T,EAAeG,MAAMC,gBAAkB0T,EAEvC1iB,EAAM1V,KAAKskB,EAJX,CAKF,CAAC,OAAAjnB,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CAED4U,EAAMmB,KAAK,SAAUrU,EAAGsU,GACtB,OAAOtU,EAAEuyB,eAAiBje,EAAEie,cAC9B,GAKA,IAHA,IAAMsD,EAAoD,GACtD1iB,EAAgE,EAC9D2iB,EAAkC,CAAC,EACzC3wB,EAAA,EAAA4wB,EAAmB7iB,EAAK/N,EAAA4wB,EAAAt/B,OAAA0O,IAAE,CAArB,IAAMkH,EAAI0pB,EAAA5wB,GACP6wB,EAAW,KAAK3pB,EAAK7W,QAAQ6W,EAAK5W,QACnCqgC,EAAOnyB,eAAeqyB,GAIzB3pB,EAAK4pB,UAAW,GAHhBH,EAAOE,IAAY,EACnB3pB,EAAK4pB,UAAW,GAIlBJ,EAAOr4B,KAAK6O,GACZ8G,GAAgB,CAClB,CAEA,IAAM7V,EAA0C,CAC9C4V,MAAO2iB,EACP1iB,aAAcA,EACdhM,eAAgB9P,KAAKuF,IAAI8K,GAAkBlE,GAAY5F,IAIzD,OAFA+J,GAAqBnE,GACrBmD,GAA4BnD,GACrBlG,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAWM,IAAM0/B,GAA2D,CACtE,CACEh+B,KAAM,SACNo6B,aAAc,EACd/hB,KAAM,kBACNtY,MAAO,GAET,CACEC,KAAM,UACNo6B,aAAc,GACd/hB,KAAM,kBACNtY,MAAO,GAET,CACEC,KAAM,UACNo6B,aAAc,GACd/hB,KAAM,kBACNtY,MAAO,GAET,CACEC,KAAM,UACNo6B,aAAc,GACd/hB,KAAM,kBACNtY,MAAO,GAET,CACEC,KAAM,UACNo6B,aAAc,GACd/hB,KAAM,kBACNtY,MAAO,GAET,CACEC,KAAM,UACNo6B,aAAc,GACd/hB,KAAM,kBACNtY,MAAO,IAIJ,SAAek+B,GAA2BtL,EAAAxH,EAAAC,EAAAC,GAAA,OAAA6S,GAAA/7B,MAAC,KAAD7D,UAAA,CA8DhD,SAAA4/B,KAAA,OAAAA,IAAA97B,EAAAA,EAAAA,GA9DM,UAA2C0W,EAAgBrD,EAAiBjD,EAAsBzS,GACvG,GAAI+7B,KAA+B,CACjC,IAAM9S,EAAuB/e,GAAsB,wBAC7CqB,EAAYV,KACZoN,QAAc3F,GAAQ/G,GACtBiG,QAAkBK,GAAYtG,EAAW,GACzC2J,QAAeC,GAAS5J,GAAW,GAEzCmD,GAA4BnD,GAC5BmE,GAAqBnE,GAGrB,IAAMkO,EAAU,KAAKV,IACjByS,EAAW,CAAC,EAChB,IAAIvT,EAAKvM,eAAe+N,GAGtB,OAAO,EAET,IAAM2kB,GAJJ5S,EAAWvT,EAAKwB,IAIkBE,eAC9B0kB,EAAiB7S,EAASE,OAG1BiB,EAAkB,KAAKyR,IAE7B,IAAI5sB,EAAS9F,eAAeihB,GAG1B,OAAO,EAET,IAAM9Q,EAJWrK,EAASmb,GAIY5mB,EAGhCu4B,EAAW,KAAK5oB,IAClBH,EAAY,CAAC,EACjB,IAAIL,EAAMxJ,eAAe4yB,GAGvB,OAAO,EAGT,IAAMjlB,GALJ9D,EAAYL,EAAMopB,IAKYv4B,EAC1BuT,EAAqB/D,EAAUgB,IAE/BgD,EAAqB,CADEhE,EAAUiB,IACW8C,EAAoB,IAAI+kB,EAAiB/9B,SAAS+9B,GAAkB,GAIhHE,EADaN,GAA4Bj+B,GACjBq6B,YAGxBC,GADM,IAAI38B,MAAOuB,UACqB,IAAfuT,EAAmC,GAAb8rB,EAAkB,IAE/DC,QDvcH,SAAmCpzB,EAAApJ,EAAAC,EAAAC,EAAAY,EAAAC,EAAAI,EAAAC,EAAAI,GAAA,OAAAy3B,GAAA74B,MAAC,KAAD7D,UAAA,CCucbkgC,CAAqB1lB,EAAQ8C,EAAkBnG,EAAS2D,EAAeE,EAAoB9G,EAAcwW,EAAsBsV,EAAYjE,GACpK,OAAmB,IAAfkE,EACK,EAEA,CAEX,CACE,OAAO,CAEX,GAACL,GAAA/7B,MAAA,KAAA7D,UAAA,CC9bA,SAAAmgC,KAAA,OAAAA,IAAAr8B,EAAAA,EAAAA,GAnBM,UAA0Cs8B,GAC/C,IAAKA,EACH,OAAO,EAET,IDwEsCrF,ECxEhChuB,EAAM0tB,GAAsB,YAC5B8B,EAAcpB,GAA2B,WAAY,CAACiF,IACtD3yB,QAAiBuuB,GAAwB,WAAYjvB,EAAKwvB,GAChE,OAAiB,IAAb9uB,IAGoB,MAAlBA,EAAS7L,MAAoC,aAApB6L,EAASitB,cDmEtBx6B,KADoB66B,ECjEVttB,EAASstB,aDmEnCM,GAAuBj7B,OAAO26B,IClE5ByB,GAAsB/uB,EAASutB,cACzByB,MACC,GAKb,IAAC54B,MAAA,KAAA7D,UAAA,CCjBD,IAAMqgC,GAA4Bl2B,EAAsB,OAClDm2B,GAAkC71B,EAAqB41B,GAA2B,OAClFE,GAAoC91B,EAAqB61B,GAAiC,OAE1FE,GAAuB/1B,EAAqB81B,GAAmC,mCAC/EE,GAA6Bh2B,EAAqB81B,GAAmC,2CAE3F,SAASG,KACPF,GAAqBv8B,MF+Dd7D,OAAOu6B,IE9Dd8F,GAA2Bx8B,MAAQ,EACrC,CAEO,SAAS08B,KACd7f,GAAgB,wBAChBuf,GAA0B5gB,aAAa,YAAa,QACpDihB,KACAzf,IACF,CAEO,SAAS2f,KAEdP,GAA0B5gB,aAAa,YAAa,SACpD0B,IACF,CAoBC,SAAA0f,KAAA,OAAAA,IAAA/8B,EAAAA,EAAAA,GAlBM,YACLwuB,GAAc,gBAAiB,OAC/B,IAAM8K,EAAWoD,GAAqBv8B,MAChCm8B,EAAkBK,GAA2Bx8B,MACnD,GAAK68B,GAAW1D,GAAhB,EFgCK,SAAiCA,GACtC,IAAI0D,GAAW1D,GAIb,MAAM,IAAIzwB,MAAM,8BAHhB,IAAMI,EAAM,IAAI1E,IAAI+0B,GACpBzC,GAAuB,GAAG5tB,EAAIg0B,aAAah0B,EAAIi0B,UAInD,CElCEC,CAAwB7D,GACxB,IAAM8D,QDrCD,SAAyCr0B,GAAA,OAAAszB,GAAAt8B,MAAC,KAAD7D,UAAA,CCqCpBmhC,CAA2Bf,GACrD,OAAIc,OACF5O,GAAc,eAAgB,aAG9BA,GAAc,QAAS,OARzB,CAFEA,GAAc,QAAS,SAa3B,GAACuO,GAAAh9B,MAAA,KAAA7D,UAAA,CClDM,SAASohC,GAAajtB,EAAcktB,EAAgBC,EAAcC,GACvE,IACM/N,GAD4B4N,GAAaI,SAAWJ,GAAaI,OAASn3B,SAAS8T,cAAc,YAChFsjB,WAAW,MAC5BC,EAAe,GAAGL,KAAUC,KAAQC,IAE1C,OADA/N,EAAQkO,KAAOA,EACRlO,EAAQmO,YAAYxtB,GAAMnM,KACnC,CAkBO,SAAS45B,GAAgBC,EAA+BC,EAAWC,EAAW/5B,EAAeC,EAAgB+5B,EAA+BrQ,GAG/IqQ,EADoB,iBAAXA,EACA,CAAEC,GAAID,EAAQE,GAAIF,EAAQG,GAAIH,EAAQI,GAAIJ,GAG1C,CACPC,GAAID,EAAOC,IAAM,EACjBC,GAAIF,EAAOE,IAAM,EACjBC,GAAIH,EAAOG,IAAM,EACjBC,GAAIJ,EAAOI,IAAM,GAKrBP,EAAIQ,YAEJR,EAAIS,OAAOR,EAAIE,EAAOC,GAAIF,GAE1BF,EAAIU,OAAOT,EAAI95B,EAAQg6B,EAAOE,GAAIH,GAClCF,EAAIW,iBAAiBV,EAAI95B,EAAO+5B,EAAGD,EAAI95B,EAAO+5B,EAAIC,EAAOE,IAEzDL,EAAIU,OAAOT,EAAI95B,EAAO+5B,EAAI95B,EAAS+5B,EAAOG,IAC1CN,EAAIW,iBAAiBV,EAAI95B,EAAO+5B,EAAI95B,EAAQ65B,EAAI95B,EAAQg6B,EAAOG,GAAIJ,EAAI95B,GAEvE45B,EAAIU,OAAOT,EAAIE,EAAOI,GAAIL,EAAI95B,GAC9B45B,EAAIW,iBAAiBV,EAAGC,EAAI95B,EAAQ65B,EAAGC,EAAI95B,EAAS+5B,EAAOI,IAE3DP,EAAIU,OAAOT,EAAGC,EAAIC,EAAOC,IACzBJ,EAAIW,iBAAiBV,EAAGC,EAAGD,EAAIE,EAAOC,GAAIF,GAE1CF,EAAIY,YAEJZ,EAAIa,UAAY/Q,EAChBkQ,EAAIlQ,MACN,CAEO,SAASgR,GAAwBb,EAAWC,EAAW/5B,EAAeC,EAAgB+5B,EAA+BY,GAY1H,IAAAC,EATEb,EADoB,iBAAXA,EACA,CAAEC,GAAID,EAAQE,GAAIF,EAAQG,GAAIH,EAAQI,GAAIJ,GAE1C,CACPC,GAAID,EAAOC,IAAM,EACjBC,GAAIF,EAAOE,IAAM,EACjBC,GAAIH,EAAOG,IAAM,EACjBC,GAAIJ,EAAOI,IAAM,GAGbH,EAAEY,EAAFZ,GAAIC,EAAEW,EAAFX,GAAIC,EAAEU,EAAFV,GAAIC,EAAES,EAAFT,GACdU,EAAU,GAiBhB,OAhBIF,GACS,IAAPX,GACFa,EAAQ97B,KAAK,IAAI86B,KAAKC,EAAIE,IAAM,IAAIH,KAAKC,KAAKD,EAAIG,KAAMF,IAAK,IAAID,IAAK,IAAIC,EAAIE,KAErE,IAAPC,GACFY,EAAQ97B,KAAK,IAAI86B,EAAI95B,EAAQk6B,KAAMH,IAAK,IAAID,EAAI95B,KAAS+5B,KAAKD,EAAI95B,KAAS+5B,EAAIG,IAAM,IAAIH,IAAK,KAAID,EAAI95B,EAAQk6B,IAErG,IAAPC,GACFW,EAAQ97B,KAAK,IAAI86B,EAAI95B,KAAS+5B,EAAI95B,EAASk6B,IAAM,IAAIL,EAAI95B,KAAS+5B,EAAI95B,KAAU65B,EAAI95B,EAAQm6B,KAAMJ,EAAI95B,IAAU,IAAI65B,EAAI95B,IAAS,KAAI+5B,EAAI95B,EAASk6B,IAEzI,IAAPC,GACFU,EAAQ97B,KAAK,IAAI86B,EAAIM,KAAML,EAAI95B,IAAU,IAAI65B,KAAKC,EAAI95B,KAAU65B,KAAKC,EAAI95B,EAASm6B,IAAM,IAAIL,EAAI95B,IAAU,IAAI65B,EAAIM,MAGpHU,EAAQ97B,KAAK,IAAI86B,EAAIG,KAAMF,IAAK,KAAID,EAAI95B,EAAQk6B,GAAM,IAAIJ,EAAI95B,KAAS+5B,KAAKD,EAAI95B,KAAS+5B,EAAIG,IAAM,KAAIH,EAAI95B,EAASk6B,GAAM,IAAIL,EAAI95B,KAAS+5B,EAAI95B,KAAU65B,EAAI95B,EAAQm6B,KAAMJ,EAAI95B,IAAU,IAAI65B,EAAIM,IAAM,IAAIN,KAAKC,EAAI95B,KAAU65B,KAAKC,EAAI95B,EAASm6B,IAAM,IAAIL,EAAIE,IAAM,IAAIH,KAAKC,KAAKD,EAAIG,KAAMF,KAEvRe,CACT,CCjFA,IAAMC,GAAwB,CAC5BC,MAAO,CAAC,EACRC,KAAM,CAAC,GAGF,SAASC,GAAoBC,GAClC,IAAMC,EAdaC,OAAOC,WAAW,gCACtBC,QACN,OAEA,QAWT,GAAIR,GAAsBK,GAAoBj2B,eAAeg2B,GAC3D,OAAOJ,GAAsBK,GAAoBD,GAEnD,IAAMl/B,EAAQu/B,iBAAiBn5B,SAASo5B,iBAAiBC,iBAAiBP,GAE1E,OADAJ,GAAsBK,GAAoBD,GAAYl/B,EAC/CA,CACT,C,y/BCrBO,SAAS0/B,GAAqBC,GAEnC,IADA,IAAI98B,EAAwB,GACnBC,EAAI,EAAGA,EAAI68B,EAAU78B,IAC5BD,EAAOE,KAAK,KAAK+C,EAAuBhD,EAAI,MAE9C,OAAOD,CACT,C,y/BC8QO,SAAS+8B,GAAgBC,GAC9B,MAAO,GAAGA,EAAQz4B,KAAKhK,KAAK,MAAMyiC,EAAQC,SAAS1iC,KAAK,MAAMyiC,EAAQE,KAAK3iC,KAAK,OAC9EyiC,EAAQG,aAAapmB,KAAK,SAAUrU,EAAGsU,GACrC,OAAOtU,EAAIsU,CACb,GAAG7d,OAAS,EACR6jC,EAAQG,aAAa5iC,KAAK,KAAO,IACjC,KAEJyiC,EAAQI,MAAMjkC,OAAS,EACnB6jC,EAAQI,MACLrmB,KAAK,SAAUrU,EAAGsU,GACjB,OAAOtU,EAAIsU,CACb,GACCzc,KAAK,KAAO,IACf,KAEJyiC,EAAQK,aAAalkC,OAAS,EAC1B6jC,EAAQK,aACLtmB,KAAK,SAAUrU,EAAGsU,GACjB,OAAOtU,EAAIsU,CACb,GACCzc,KAAK,KAAO,IACf,KAEJyiC,EAAQM,UAAUnkC,OAAS,EACvB6jC,EAAQM,UACLvmB,KAAK,SAAUrU,EAAGsU,GACjB,OAAOtU,EAAIsU,CACb,GACCzc,KAAK,KAAO,IACf,KACHyiC,EAAQO,YAAYpkC,OAAS,EAAI6jC,EAAQO,YAAYhjC,KAAK,KAAO,IAAM,KAAKyiC,EAAQvW,UAAUttB,OAAS,EAAI,KAAO6jC,EAAQvW,UAAUlsB,KAAK,KAAO,IAAM,IAC3J,CC1SO,IAAMijC,GAA8C,CACzDliB,OAAQ,CAAC,EAAG,GACZrK,IAAK,EACLrW,KAAM,KACNotB,OAAQ,IACR/U,KAAM,WAIKwqB,GAA4C,CACvDniB,OAAQ,CAAC,EAAG,GACZrK,GAAI,EACJrW,KAAM,IACNotB,OAAQ,IACR/U,KAAM,SAGKyqB,GAA2C,CACtDpiB,OAAQ,CAAC,EAAG,GACZrK,GAAI,EACJrW,KAAM,IACNotB,OAAQ,IACR/U,KAAM,QAGK0qB,GAA4C,CACvDriB,OAAQ,CAAC,GAAI,GACbrK,GAAI,EACJrW,KAAM,IACNotB,OAAQ,IACR/U,KAAM,SAGK2qB,GAA2C,CACtDtiB,OAAQ,EAAE,EAAG,GACbrK,GAAI,EACJrW,KAAM,IACNotB,OAAQ,IACR/U,KAAM,QAIF4qB,GAAgD,CACpDviB,OAAQ,CAACvhB,KAAK+jC,QAAS/jC,KAAK+jC,SAC5B7sB,GAAI,EACJrW,KAAM,KACNotB,OAAQ,IACR/U,KAAM,cAGF8qB,GAAgD,CACpDziB,OAAQ,CAACvhB,KAAK+jC,SAAU/jC,KAAK+jC,SAC7B7sB,GAAI,EACJrW,KAAM,KACNotB,OAAQ,IACR/U,KAAM,cAGK+qB,GAAgD,CAC3D1iB,OAAQ,EAAEvhB,KAAK+jC,SAAU/jC,KAAK+jC,SAC9B7sB,GAAI,EACJrW,KAAM,KACNotB,OAAQ,IACR/U,KAAM,cAGKgrB,GAAgD,CAC3D3iB,OAAQ,EAAEvhB,KAAK+jC,QAAS/jC,KAAK+jC,SAC7B7sB,GAAI,EACJrW,KAAM,KACNotB,OAAQ,IACR/U,KAAM,cAGD,SAASirB,GAA+B5iB,GAK7C,IAJA,IAAM6iB,EAAuC,CAACX,GAA0BC,GAAwBG,GAAuBD,GAAwBD,GAAuBG,GAA4BE,GAA4BC,GAA4BC,IACpPG,EAAa/iB,GAAgBC,GAC/B+iB,GAAiBl1B,IACjBm1B,EAA+BH,EAAW,GAC9Ct2B,EAAA,EAAA02B,EAAwBJ,EAAUt2B,EAAA02B,EAAAplC,OAAA0O,IAAE,CAA/B,IAAM4e,EAAS8X,EAAA12B,GACZ22B,EAAa/X,EAAUnL,OAAO,GAAK8iB,EAAW,GAAK3X,EAAUnL,OAAO,GAAK8iB,EAAW,GACtFI,EAAaH,IACfA,EAAgBG,EAChBF,EAAY7X,EAEhB,CACA,OAAO6X,CACT,CC5FA,IAAMG,GAAkB,CACtBC,SAAU,EACVC,WAAY,CACVC,QAAQ,EACRC,OAAO,GAET5tB,GAAI,GAuCC,SAAS6tB,KACd,IAAMC,EAAQN,GAAgBC,QAC9B,IAAe,IAAXK,EACF,MAAO,CACLC,QAAS,EACTC,kBAAmBzB,IAGrB,IAAI0B,EAAgBH,EAAQ,GAO5B,OANIG,EAAQ,MACVA,GAAS,KAEXA,GAASnlC,KAAKyI,GAAK,IAGZ,CACLw8B,OAAQD,EACRE,kBAHwBf,GADX,CAACnkC,KAAK6I,IAAIs8B,GAAQnlC,KAAK4I,IAAIu8B,KAO9C,C,y/BCnCA,SAASC,GAA2Bjb,EAAgDkb,GAElF,IAAMp/B,EAAwC,CAAC,EACzCq/B,EAAwC,GAC9C,IAAK,IAAM5a,KAAeP,EAAwB,CAChD,IAAMob,EAAiCpb,EAAuBO,GACxD8a,EAAaD,EAA+B5rB,OAC5CgR,EAAmBzpB,SAASqkC,EAA+BlyB,cAC7DsX,GAAoB,GAAK0a,EAAWpwB,QAAQuwB,IAAe,GAC7DF,EAAan/B,KAAK,CAACq/B,EAAY7a,GAEnC,CACA,IAAM8a,EAAqBH,EAAalmC,OACxCkmC,EAAatoB,KAAK,SAAUrU,EAAGsU,GAC7B,OAAOtU,EAAE,GAAKsU,EAAE,EAClB,GAEA,IADA,IAAIrc,EAAQ,EACZkN,EAAA,EAAA43B,EAA0BJ,EAAYx3B,EAAA43B,EAAAtmC,OAAA0O,IAAE,CAAnC,IAEG63B,EAAe/kC,EAAQ6kC,EACvBG,GAAeD,EAAgBA,EAAe,KAAS,IAG7D1/B,EADoB,KALAy/B,EAAA53B,GAIW,MAET,CACpB3E,OAAQvI,EACR0S,KAAM1S,EAAMo5B,WACZj5B,KAAM6kC,GAERhlC,GAAS,CACX,CACA,OAAOqF,CACT,CAuPC,SAAA4/B,KAAA,OAAAA,IAAA5iC,EAAAA,EAAAA,GAzMM,UAAiCoU,EAAcyuB,EAAoBC,EAAqB55B,GAC7FO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,aAAc,GAAG,GACrDO,GAAyBP,EAAW,aAAc,GAAG,GACrDO,GAAyBP,EAAW,YAAa,GAAG,GACpDO,GAAyBP,EAAW,YAAa,GAAG,GACpDO,GAAyBP,EAAW,oBAAqB,GAAG,GAC5DO,GAAyBP,EAAW,oBAAqB,GAAG,GAC5DO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,gBAAiB,GAAG,GA6BxD,IA5BA,IAAMkH,QAAqBsT,GAAgBxa,GACrCiG,QAAkBK,GAAYtG,EAAW,GACzC2J,QAAeC,GAAS5J,GAAW,GACnC0M,QAAa3F,GAAQ/G,GACrByM,QAAiB/H,GAAY1E,GAC7BwM,QAAgBpI,GAAWpE,GAC3B65B,QAAwBC,GAAmBH,EAAYC,GAEvDlc,EAAuB/e,GAAsB,wBAC7Co7B,EAAkBp7B,GAAsB,mBACxCq7B,EAA2Br7B,GAAsB,4BAEjDs7B,EAAe,CAAC,EAChBtqB,EAAe,CAAC,EAChB2iB,EAAS,CAAC,EAEViG,EAAkBK,KAGlBntB,EAAexF,EADG,MAAMiF,KAExBoF,EAAmB7E,EAAajR,EAChC0/B,EAAkBzuB,EAAaV,GAC/BovB,EAAgB1uB,EAAa2uB,EAE/Bvc,EAAU,GACVwc,EAAW,GACTC,EAAuBJ,EAAgBjnC,OAEpC8G,EAAI,EAAGA,EAAIugC,EAAsBvgC,IACxC8jB,EAAUA,EAAQvZ,OAAOmH,EAAalR,EAAER,IACxCsgC,EAAWA,EAAS/1B,OAAOmH,EAAaJ,EAAEtR,IAG5C,IAIqCgP,EAJ/BiV,EAxIR,SAA+B9W,EAA4BgyB,GACzD,IAC+B/+B,EADzBL,EAAS,CAAC,EAAEO,EAAAC,GACC4M,GAAY,IAA/B,IAAA7M,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAiC,KAAtBoO,EAAI1O,EAAAlD,MACTiiC,EAAWpwB,QAAQD,EAAK2E,SAAW,IAErC1T,EAD4B,KAAK+O,EAAK2E,UAChB3E,EAE1B,CAAC,OAAAxR,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,CA+HiCygC,CAAsBrzB,EAAc2W,GAC7D2c,EzC+BD,SAAmC/tB,EAAoBD,EAAkB7C,EAAwBuvB,GACtG,IAIiC1pB,EAJ3B1V,EAAS,CAAC,EACV2gC,EAEF,CAAC,EAAE7qB,EAAAtV,GACmBkS,GAAO,IAAjC,IAAAoD,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAmC,KAAxBwS,EAAWuC,EAAAvY,MAEpBwjC,EADkBxtB,EAAY7E,OACN6E,CAC1B,CAAC,OAAA5V,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,KAEkCme,EAFlCC,EAAA5e,GAE0BmS,GAAQ,IAAnC,IAAAyM,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAqC,KAA1B6S,EAAY2L,EAAAhiB,MACfyjC,EAAgB,CAAC,EAEjBrB,EAAatkC,SAASuY,EAAaE,QACnCI,EAAc7Y,SAASuY,EAAanD,SACpCqG,EAAYpd,OAAOka,EAAalF,OAGtC,KAAI8wB,EAAWpwB,QAAQuwB,GAAc,GAArC,CAIAqB,EAAcjmC,MAAQ+b,EAAUnH,WAAW,GAC3CqxB,EAAcpyB,aAAc,EAG5BoyB,EAAchzB,QAAU4F,EAAa5F,QACrCgzB,EAAc3yB,UAAYuF,EAAavF,UACvC2yB,EAActyB,MAAQkF,EAAalF,MACnCsyB,EAAc9yB,UAAY0F,EAAa1F,UAGvC,IAAI+yB,EAAc,CAAC,EACnB,GAAIF,EAAWt6B,eAAeqQ,GAA9B,CACEmqB,EAAcF,EAAWjqB,GAI3BkqB,EAAch5B,SAAW,CACvBk5B,SAAUtmC,WAAWqmC,EAAYE,UACjCC,UAAWxmC,WAAWqmC,EAAYI,YAIpC,IAAIptB,EAAgB,CAAC,EACjBqtB,GAAkB,EACtB,IAAK,IAAMhkC,KAAO2S,EAAO,CACvB,IAAMsxB,EAAgBtxB,EAAM3S,GAE5B,GADYikC,EAAc1wB,IAClBzB,QAAQ8E,IAAgB,EAAG,CACjCD,EAAgBstB,EAChBD,GAAkB,EAClB,KACF,CACF,CACAN,EAAcryB,UAAY2yB,EAAkBrtB,EAAcnT,EAAI,OAC9DkgC,EAAcvwB,QAAU6wB,EAAkBrtB,EAAc5C,GAAK,KAE7D,IAAMmD,EAAU,KAAKmrB,IAChBv/B,EAAOqG,eAAe+N,KACzBpU,EAAOoU,GAAW,IAEpBpU,EAAOoU,GAASlU,KAAK0gC,EAzBrB,CAjBA,CA2CF,CAAC,OAAArjC,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACD,OAAOhB,CACT,CyChG0BohC,CAA0BzuB,EAAUD,EAAS7C,EAAOkU,GAEtEsd,EAA+C,GAAGnyB,EAAA1O,GAChC6/B,GAAa,IAArC,IAAAnxB,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAuC,KAGP+U,EAHrB4rB,EAASryB,EAAA9R,MACd69B,EAAY,EACZC,EAAY,EAAEnlB,EAAAtV,GACG8gC,GAAS,IAA9B,IAAAxrB,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAgC,KAArB2a,EAAM5F,EAAAvY,MACf69B,GAAK1f,EAAO,GACZ2f,GAAK3f,EAAO,EACd,CAAC,OAAA/d,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACD,IACMi+B,EAAoBf,GADP7iB,GAAgB,CAAC2f,EAAGC,KAEvCoG,EAAmBnhC,KAAK++B,EAC1B,CAAC,OAAA1hC,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CAED,IAAIugC,EAAwB,GAC5B,OAAQtB,GACN,IAAK,UACHsB,EHmMC,SAAoCC,GACzC,IAE+BriB,EAFzBnf,EAAS,GACTyhC,EAAmB,CAAC,EAAEriB,EAAA5e,GACNghC,GAAS,IAA/B,IAAApiB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAiC,KAAtBq8B,EAAO7d,EAAAhiB,MAChB,IAAK,IAAMD,KAAO8/B,EACXyE,EAAiBp7B,eAAenJ,KACnCukC,EAAiBvkC,GAAO,GAEtB8/B,EAAQ9/B,GAAK/D,OAAS,IACxBsoC,EAAiBvkC,GAAOukC,EAAiBvkC,GAAO,EAGtD,CAAC,OAAAK,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACD,IAAI0gC,EAAmBC,OAAOC,QAAQH,GACnCpnC,IAAI,SAACgiC,GACJ,MAAO,CAAEn/B,IAAKm/B,EAAS,GAAIl/B,MAAOk/B,EAAS,GAC7C,GACC5b,OAAO,SAAC1f,GACP,OAAOA,EAAE5D,QAAUqkC,EAAUroC,MAC/B,GACC4d,KAAK,SAAUrU,EAAGsU,GACjB,OAAOtU,EAAEvF,MAAQ6Z,EAAE7Z,KACrB,GACF,GAAIukC,EAAiBvoC,OAAS,EAAG,KACcqY,EADdC,EAAAjR,GACFkhC,GAAgB,IAA7C,IAAAjwB,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAA+C,KAGdiR,EAHtBiwB,EAAcrwB,EAAArU,MACnB2kC,EAAa,GACbC,GAAM,IAAUlwB,EAAArR,GACEghC,GAAS,IAA/B,IAAA3vB,EAAApR,MAAAmR,EAAAC,EAAAnR,KAAAC,MAAiC,KACzBqhC,EADUpwB,EAAAzU,MACU0kC,EAAe3kC,KAAK3C,KAAK,IACnDunC,EAAW5hC,KAAK8hC,GAChB,IAAMC,EAAeD,EAAU7oC,OAC3B8oC,EAAeF,IACjBA,EAAME,EAEV,CAAC,OAAA1kC,GAAAsU,EAAA9Q,EAAAxD,EAAA,SAAAsU,EAAA7Q,GAAA,CACGyN,GAAkBqzB,IACpB9hC,EAAOE,KAAK,CAAE4hC,WAAYA,EAAYC,IAAKA,GAE/C,CAAC,OAAAxkC,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CACH,CAEA,OAAIhB,EAAO7G,OAAS,GAClB6G,EAAO+W,KAAK,SAAUrU,EAAGsU,GACvB,OAAOtU,EAAEq/B,IAAM/qB,EAAE+qB,GACnB,GACO/hC,EAAO,GAAG8hC,YAGVjF,GADiB2E,EAAUroC,OAGtC,CGrPe+oC,CAA2BvwB,EAAajP,GACjD,MACF,IAAK,UACH6+B,EAAS1E,GAAqB2D,GAC9B,MACF,IAAK,aACHe,EJ7KC,SAAiCF,GACtC,IACkDhhC,EAD5CL,EAAwB,GAAGO,EAAAC,GACD6gC,GAAkB,IAAlD,IAAA9gC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAoD,KAAzCs+B,EAAiB5+B,EAAAlD,MAC1B6C,EAAOE,KAAK,IAAI++B,EAAkBrkC,OAAOqkC,EAAkBjX,SAC7D,CAAC,OAAAzqB,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,CIuKemiC,CAAwBd,GAMrC,IAAK,IAAIphC,EAAI,EAAGA,EAAIugC,EAAsBvgC,IAAK,CAC7C,IAAMy4B,EAAW,KAAKz4B,IACtBkgC,EAAazH,GAAY,GACzB7iB,EAAa6iB,GAAY,EACzBF,EAAOE,GAAY,CACjB99B,KAAM2mC,EAAOthC,GACb4S,WAAY,CACV,CACE3V,IAAK,UACL+V,KAAM,kBACN9V,MAAO4/B,GAAgBprB,EAAajP,EAAEzC,KAExC,CACE/C,IAAK,iBACL+V,KAAM,cACN9V,MAAO,GAAGwU,EAAaL,GAAGrR,GAAGxF,QAAQ,OAAOkX,EAAaN,GAAGpR,GAAGxF,QAAQ,MAEzE,CACEyC,IAAK,qBACL+V,KAAMouB,EAAmBphC,GAAGgT,KAC5B9V,MAAO,GAAGkkC,EAAmBphC,GAAGrF,OAAOslC,IAAsE,IAA1CzB,EAAgBQ,kBAAkBhuB,IAAawtB,EAAgBQ,kBAAkBhuB,KAAOowB,EAAmBphC,GAAGgR,GAAK,SAAW,QASvM,IAJA,IAAMmxB,EAAiBzwB,EAAalR,EAAER,GAChCoiC,EAAeD,EAAejpC,OAC9BmpC,EAAmBnD,GAA2Bjb,EAAwBke,GAEnEhpB,EAAI,EAAGA,EAAIipB,EAAcjpB,IAAK,CACrC,IAAMoL,EAAiB,CAAC,EAElB+a,EAAa5tB,EAAalR,EAAER,GAAGmZ,GAC/BqL,EAAc,KAAK8a,IACrBpZ,EAA+B,CAAC,EACpC,GAAIvT,EAAKvM,eAAeoe,GAAxB,CACE0B,EAAWvT,EAAK6R,GAIlBD,EAAe+d,OAAShD,EAGxB,IAAIiD,EAAkB,CAAEt/B,OAAQ,EAAGmK,KAAM,KAAMvS,MAAO,GAClDwnC,EAAiBj8B,eAAeoe,KAClC+d,EAAkBF,EAAiB7d,IAErCD,EAAeie,QAAUD,EAGzB,IAAM1uB,EAAsBnC,EAAaJ,EAAEtR,GAAGmZ,GACxC6N,EAAe,KAAKnT,IACtB5D,EAAiC,CAAC,EACtC,GAAIL,EAAMxJ,eAAe4gB,GAAzB,CACE/W,EAAYL,EAAMoX,GAIpBzC,EAAeuQ,WAAa7kB,EAAUxP,EACtC8jB,EAAeke,gBAAkB,IAAI,CAACxyB,EAAUiB,IAAKjB,EAAUgB,IAAK,IAAIjW,SAASkrB,EAASE,WAC1F7B,EAAeme,QAAU7uB,EAIzB,GAAIoQ,EAAuB7d,eAAeoe,GAA1C,CAKA,IAAMme,EAAqBz1B,GAJN+W,EAAuBO,GAIkBrX,aAAcwW,GAC5EY,EAAe1d,OAAS87B,EAGxB,IAAIC,GAAQ,GACRnC,EAAgBr6B,eAAeoe,KACjCoe,GAAQnC,EAAgBjc,GAAapqB,IAAI,SAAC0G,GAAC,OAAKoN,GAAUpN,EAAE,IAE9DyjB,EAAeqe,MAAQA,GAGvB,IAAIC,GAAsB,GACtB/C,EAAgB15B,eAAeoe,KACjCqe,GAAsB/C,EAAgBtb,IAExCD,EAAeue,gBAAkBD,GAEjC3C,EAAazH,GAAUx4B,KAAKskB,GAC5B3O,EAAa6iB,IAAa,CAnB1B,CAXA,CAlBA,CAiDF,CACF,CAEA,IAAK,IAAMx7B,MAAOijC,EAChBA,EAAajjC,IAAK6Z,KAAK,SAAUrU,EAAGsU,GAClC,OAAOtU,EAAEigC,QAAU3rB,EAAE2rB,OACvB,GAmBF,IAAM3iC,GAA6B,CACjCmgC,aAAcA,EACd3H,OAAQA,EACRwK,cAAexC,EACf3qB,aAAcA,EACd/C,aAAc0D,EACdpF,KAAMA,EACNvH,eAAgBO,GAAkBlE,IAKpC,OAHAmD,GAA4BnD,GAC5BmE,GAAqBnE,GAEdlG,EACT,GAAC4/B,GAAA7iC,MAAA,KAAA7D,UAAA,C,y/BCnTD,IAAM+pC,GAAoB5/B,EAAsB,OAC1C6/B,GAA0Bv/B,EAAqBs/B,GAAmB,OAClEE,GAA0Bx/B,EAAqBu/B,GAAyB,OAExEE,GAAwB,UACxBC,GAAoB,OAE1B,SAAS7W,GAAsBzd,EAAyB5G,EAAwBmsB,GAC9E,IAAM7H,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAG1B,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1B,IAAMgsB,EAAkB//B,SAAS8T,cAAc,QAC/CisB,EAAgBvrB,YAAYZ,GAAepI,EAAKkE,OAChDmE,EAAYW,YAAYurB,GAGxB,IAAMrU,EAAc1rB,SAAS8T,cAAc,OAK3C,OAJA4X,EAAY7qB,UAAUkT,IAAI,MAC1B2X,EAAYlX,YAAYxU,SAASspB,eAAe9d,EAAKnU,OAG7CuN,GACN,IAAK,gBACHskB,EAAYrD,QAAU,YAmE5B,SAA6Bma,EAAuB5hB,EAAkBjO,EAAgBrD,GACpF,IAAMoc,EAAcppB,EAAsB,2BAAkIkgC,KACtKC,EAA4B7/B,EAAqB8oB,EAAa,sCACpE3G,GAASnE,EAAUjO,EAAQrD,GAASod,KAAK,SAAC1sB,GACpCA,EACFukB,GAAqB,OAAQ5R,GAAQ+Z,KAAK,SAACgW,GACrCA,IACFD,EAA0B7qB,aAAa,cAAe+qB,GAAgBD,IACtEjY,GAAc,SAAU4X,IACxBO,KAEJ,GAEAnY,GAAc,UAAW6X,GAE7B,EACF,CAlFQO,CAAoBtP,EAAW,GAAIvlB,EAAKkC,GAAIqjB,EAAW,GAAIA,EAAW,GACxE,EACA,MACF,IAAK,mBACH7H,EAAYrD,QAAU,YAgF5B,SAAgCma,EAAuB5hB,EAAkBjO,EAAgBrD,GACvF,IAAMoc,EAAcppB,EAAsB,uBAAmHkgC,KACvJC,EAA4B7/B,EAAqB8oB,EAAa,sCACpE3G,GAASnE,EAAUjO,EAAQrD,GAASod,KAAK,SAAC1sB,GACpCA,EACFukB,GAAqB,OAAQ5R,GAAQ+Z,KAAK,SAACgW,GACrCA,IACFD,EAA0B7qB,aAAa,cAAe+qB,GAAgBD,IACtEjY,GAAc,SAAU4X,IACxBO,KAEJ,GAEAnY,GAAc,UAAW6X,GAE7B,EACF,CA/FQQ,CAAuBvP,EAAW,GAAIvlB,EAAKkC,GAAIqjB,EAAW,GAAIA,EAAW,GAC3E,EACA,MACF,IAAK,QACH7H,EAAYrD,QAAU,WA6F5B,IAAgCzH,EAAkBtR,EAC1CyzB,EADwBniB,EA5FD5S,EAAKkC,GA4FcZ,EA5FVikB,EAAW,GA6F3CwP,EAAsBzgC,EAAsB,qEAClDwjB,GAAUlF,EAAUtR,GAASod,KAAK,SAAC1sB,GAC7BA,EACFukB,GAAqB,QAASjV,GAASod,KAAK,SAACgW,GACvCA,IACFK,EAAoBnrB,aAAa,cAAe,QAChD6S,GAAc,SAAU4X,IACxBO,KAEJ,GAEAnY,GAAc,UAAW6X,GAE7B,EAzGI,EACA,MACF,IAAK,iBACH5W,EAAYrD,QAAU,WAyG5B,IAA0BzH,EAAkBtR,EAAlBsR,EAxGD5S,EAAKkC,GAwGcZ,EAxGVikB,EAAW,GAyG3CzN,GAAUlF,EAAUtR,GAASod,KAAK,SAAC1sB,GAC7BA,EACFukB,GAAqB,QAASjV,GAASod,KAAK,SAACgW,GACvCA,IACFjY,GAAc,SAAU4X,IACxBO,KAEJ,GAEAnY,GAAc,UAAW6X,GAE7B,EAnHI,EACA,MACF,IAAK,WAKL,IAAK,oBACH5W,EAAYrD,QAAU,WA6H5B,IAA6BzH,EAAkBvQ,EAAlBuQ,EA5HD5S,EAAKkC,GA4HcG,EA5HVkjB,EAAW,GA6H9CpN,GAAavF,EAAUvQ,GAAMqc,KAAK,SAAC1sB,GAC7BA,EACFukB,GAAqB,WAAYlU,GAAMqc,KAAK,SAACgW,GACvCA,IACFjY,GAAc,SAAU4X,IACxBO,KAEJ,GAEAnY,GAAc,UAAW6X,GAE7B,EAvII,EAYJ,OAHA5W,EAAY1U,YAAYX,GACxBqV,EAAY1U,YAAYkX,GAEjB,CACLrrB,QAAS6oB,EACTxb,GAAI,GAER,CAE0C,SAAA8yB,KASzC,OATyCA,IAAA/mC,EAAAA,EAAAA,GAA1C,UAA2CmL,EAAwBmsB,GACjE,IAAM3Q,QAA2Bd,KACjCsgB,GAAwBzZ,UAAY,GACpC,IACqCrpB,EAD/B6Y,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACrBmjB,GAAkB,IAArC,IAAApjB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAuC,KAC/B0uB,EAAiB7C,GADVnsB,EAAAlD,MACsCgL,EAAMmsB,GACzDpb,EAASnB,YAAYsX,EAAezrB,QACtC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDmiC,GAAwB5pB,OAAOL,EACjC,IAACnc,MAAA,KAAA7D,UAAA,CAEM,SAAS8qC,GAAiB77B,EAAwBmsB,GACvDta,GAAgB,gBAChBipB,GAAkBtqB,aAAa,YAAa,QAf7C,SAEyC5S,EAAApJ,GAAAonC,GAAAhnC,MAAC,KAAD7D,UAAA,CAcxC+qC,CAA4B97B,EAAMmsB,EACpC,CAEO,SAASqP,KACdlY,GAAkB,gBAClBwX,GAAkBtqB,aAAa,YAAa,QAC9C,C,y/BC9FA,IAAMurB,GAA4B7gC,EAAsB,OAClD8gC,GAAkCxgC,EAAqBugC,GAA2B,OAClFE,GAAkCzgC,EAAqBwgC,GAAiC,OAI9F,SAAS3X,GAAsBzd,EAAkC5G,EAAgCmsB,GAC/F,IAAM7H,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAG1B,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1B,IAAMgsB,EAAkB//B,SAAS8T,cAAc,QAC/CisB,EAAgBvrB,YAAYZ,GAAepI,EAAKkE,OAChDmE,EAAYW,YAAYurB,GAGxB,IAAMrU,EAAc1rB,SAAS8T,cAAc,OAK3C,OAJA4X,EAAY7qB,UAAUkT,IAAI,MAC1B2X,EAAYlX,YAAYxU,SAASspB,eAAe9d,EAAKnU,OAG7CuN,GACN,IAAK,gBACHskB,EAAYrD,QAAU,YA2CrB,SAAgDma,EAAuB7vB,EAAgBrD,EAAiBjD,EAAsBzS,GACnI,IAAM8xB,EAAcppB,EAAsB,2BAAkIkgC,KACtKc,EAAoC1gC,EAAqB8oB,EAAa,6CAC5EjB,GAAc,gBAAiB,OAC/B6Y,EAAkC1rB,aAAa,UAAW,SAC1D2rB,KACAzL,GAA4BnlB,EAAQrD,EAASjD,EAAczS,GAAO8yB,KAAK,SAACztB,GACtE,OAAQA,GACN,KAAK,EACHwrB,GAAc,QAAS,QACvB6Y,EAAkC1rB,aAAa,UAAW,QAC1D,MACF,KAAK,EACH6S,GAAc,eAAgB,QAC9B6Y,EAAkC1rB,aAAa,UAAW,QAC1D0rB,EAAkC1rB,aAAa,cAAe,QAC9D,MACF,KAAK,EACH6S,GAAc,UAAW,mBACzB6Y,EAAkC1rB,aAAa,UAAW,QAKhE,EACF,CAnEQ4rB,CAAuCjQ,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIvlB,EAAKpU,MAC1G,EACA,MACF,IAAK,mBACH8xB,EAAYrD,QAAU,YAiErB,SAAmDma,EAAuB7vB,EAAgBrD,EAAiBjD,EAAsBzS,GACtI,IAAM8xB,EAAcppB,EAAsB,uBAAmHkgC,KACvJc,EAAoC1gC,EAAqB8oB,EAAa,6CAC5EjB,GAAc,gBAAiB,OAC/B6Y,EAAkC1rB,aAAa,UAAW,SAC1D2rB,KACAzL,GAA4BnlB,EAAQrD,EAASjD,EAAczS,GAAO8yB,KAAK,SAACztB,GACtE,OAAQA,GACN,KAAK,EACHwrB,GAAc,QAAS,QACvB6Y,EAAkC1rB,aAAa,UAAW,QAC1D,MACF,KAAK,EACH6S,GAAc,eAAgB,QAC9B6Y,EAAkC1rB,aAAa,UAAW,QAC1D0rB,EAAkC1rB,aAAa,cAAe,QAC9D,MACF,KAAK,EACH6S,GAAc,UAAW,mBACzB6Y,EAAkC1rB,aAAa,UAAW,QAKhE,EACF,CAzFQ6rB,CAA0ClQ,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIvlB,EAAKpU,MAC7G,EASJ,OAHA8xB,EAAY1U,YAAYX,GACxBqV,EAAY1U,YAAYkX,GAEjB,CACLrrB,QAAS6oB,EACTxb,GAAI,GAER,CAYO,SAASwzB,GAAyBt8B,EAAgCmsB,GACvEta,GAAgB,wBAChBkqB,GAA0BvrB,aAAa,YAAa,QAZtD,SAA6CxQ,EAAgCmsB,GAC3E8P,GAAgC1a,UAAY,GAC5C,IAC8CrpB,EADxC6Y,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACrBo4B,IAA2B,IAA9C,IAAAr4B,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAgD,KACxC+jC,EAAalY,GADNnsB,EAAAlD,MACkCgL,EAAMmsB,GACrDpb,EAASnB,YAAY2sB,EAAW9gC,QAClC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDojC,GAAgC7qB,OAAOL,EACzC,CAKEyrB,CAAoCx8B,EAAMmsB,EAC5C,CAEO,SAASgQ,KACd7Y,GAAkB,wBAClByY,GAA0BvrB,aAAa,YAAa,QACtD,CCJC,SAAAisB,KAAA,OAAAA,IAAA5nC,EAAAA,EAAAA,GA/CM,UAAwCoU,EAAclL,GAC3D,IAAMiG,QAAkBK,GAAYtG,EAAW,GAC/CmD,GAA4BnD,GAC5BmE,GAAqBnE,GACrB,IAAMohB,EAAkB,MAAMlW,IAE9B,IAAIjF,EAAS9F,eAAeihB,GAG1B,MAAO,CACLud,QAAS,GACTC,gBAAiB,EACjB1zB,KAAMA,GALOjF,EAASmb,GAQ1B,IAAMud,EAAgD,CACpD,CACE5xB,KAAM,SACNrY,KAAM,KACNsC,IAAK,iBACL6nC,OAAQ,WACNf,GAAiB,WAAY,CAAC5yB,GAChC,GAEF,CACE6B,KAAM,YACNrY,KAAM,KACNsC,IAAK,YACL6nC,OAAQ,YCmIP,SAAqCpoC,GAAAqoC,GAAAjoC,MAAC,KAAD7D,UAAA,CDlIpC+rC,CAAuB7zB,EACzB,GAEF,CACE6B,KAAM,YACNrY,KAAM,OACNsC,IAAK,oBACL6nC,OAAQ,YCuJP,SAA0CnoC,GAAAsoC,GAAAnoC,MAAC,KAAD7D,UAAA,CDtJzCisC,CAA4B/zB,EAC9B,IAQJ,MAL0C,CACxCyzB,QAASA,EACTC,gBAAiBD,EAAQ1rC,OACzBiY,KAAMA,EAGV,GAACwzB,GAAA7nC,MAAA,KAAA7D,UAAA,C,y/BE7CD,IAAIksC,IAAoD,EACpDC,GAA8C,CAAC,EAAE,SAEtCC,GAAqBv/B,GAAA,OAAAw/B,GAAAxoC,MAAC,KAAD7D,UAAA,UAAAqsC,KAmBnC,OAnBmCA,IAAAvoC,EAAAA,EAAAA,GAApC,UAAqCwoC,GACnC,IAAMnkC,EAAS,IAAIC,OAAO,IAAIC,IAA2D,kBAiBzF,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAYujC,EACrB,EAGF,IAACzoC,MAAA,KAAA7D,UAAA,UAEcusC,GAAsB9oC,GAAA,OAAA+oC,GAAA3oC,MAAC,KAAD7D,UAAA,UAAAwsC,KAmBpC,OAnBoCA,IAAA1oC,EAAAA,EAAAA,GAArC,UAAsCgQ,GACpC,IAAM3L,EAAS,IAAIC,OAAO,IAAIC,IAA4D,mBAiB1F,aAdqB,IAAIG,QAAQ,SAACC,EAASC,GACzCP,EAAOQ,UAAY,SAAUd,GAC3BY,EAAQZ,EAAE3B,MACViC,EAAOS,WACT,EAEAT,EAAOU,QAAU,SAAUhB,GACzBa,EAAOb,EAAEiB,SACTX,EAAOS,WACT,EAEAT,EAAOY,YAAY+K,EACrB,EAGF,IAACjQ,MAAA,KAAA7D,UAAA,CAmDA,SAAAysC,KAAA,OAAAA,IAAA3oC,EAAAA,EAAAA,GAjDM,UAAiCkJ,GAAqD,SAC5EqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,IACJ,CAAC,EAAG,KACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MAEZ6C,UADmB8F,EAAUtB,EAAIyB,IAAKC,EAAW,qBAAqB1B,EAAIzD,EAAE,KAAM,QAElF+I,GAAkB5D,GAAY,EAChC,CAAC,OAAA3I,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMwS,EAAW,4BACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IACfq6B,QAAwBN,GAAsBtlC,GAC9C6lC,QAAyBJ,GAAuBG,GAOtD,aANMlpC,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUqmC,IACvCT,KACHA,IAA2C,EAC3CC,GAAsCQ,GAEjCA,CACT,CACE,IAAI,IAAIvtC,MAAOuB,UAAYoB,SAAS0Q,GAfd,OAeiD,CACrE,IAAM3L,QAAeuL,IACfq6B,QAAwBN,GAAsBtlC,GAC9C6lC,QAAyBJ,GAAuBG,GAGtD,aAFMlpC,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUqmC,IACrCA,CACT,CACE,IAAKT,GAA0C,CAC7C,IAAMv5B,QAAcrO,EAAU,EAAGkO,GACjC05B,IAA2C,EAC3CC,GAAsCrmC,KAAKC,MAAM4M,EACnD,CAIA,OAHApF,GAAyBP,EAAW,sBAAuB,GAAG,GAC9DO,GAAyBP,EAAW,sBAAuB,GAAG,GAC9D4D,GAAkB5D,GAAY,GACvBm/B,EAGb,GAACM,GAAA5oC,MAAA,KAAA7D,UAAA,CC7GD,IAAM4sC,GAAe,CACnBpH,QAAS,CACPoC,SAAU,EACVE,UAAW,GAEbrC,WAAY,CACVC,QAAQ,EACRC,OAAO,GAET5tB,GAAI,GAGC,SAAS80B,MA4BwB,IAAlCD,GAAanH,WAAWE,OAAmBh6B,GAAsB,2BACnEihC,GAAanH,WAAWE,OAAQ,EAChCiH,GAAa70B,GAAKzS,UAAUwnC,YAAYC,cA7B1C,SAAwBr+B,GACtBk+B,GAAanH,WAAWC,QAAS,EACjCkH,GAAapH,QAAQoC,SAAWl5B,EAASs+B,OAAOpF,SAChDgF,GAAapH,QAAQsC,UAAYp5B,EAASs+B,OAAOlF,SACnD,EACA,SAAsBzL,GACpB,EAuBoF,CAClF4Q,oBAAoB,EACpBC,QAAS,IACTC,WAAY,IAGlB,CAEO,SAASC,KACd,OAAIR,GAAanH,WAAWE,OAASiH,GAAanH,WAAWC,OACpDkH,GAAapH,QAEjBoH,GAAanH,WAAWE,OAAUiH,GAAanH,WAAWC,OAI3DkH,GAAanH,WAAWE,QAAUiH,GAAanH,WAAWC,OACrDkH,GAAapH,aADtB,GAHEqH,KACOD,GAAapH,QAKxB,C,y/BC4SC,SAAA6H,KAAA,OAAAA,IAAAvpC,EAAAA,EAAAA,GAxSM,UAA8BqT,EAAiBG,EAAgCqvB,EAAoBC,EAAqB55B,GAC7HO,GAAyBP,EAAW,aAAc,GAAG,GACrDO,GAAyBP,EAAW,aAAc,GAAG,GACrDO,GAAyBP,EAAW,YAAa,GAAG,GACpDO,GAAyBP,EAAW,YAAa,GAAG,GACpDO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,sBAAuB,GAAG,GAC9DO,GAAyBP,EAAW,sBAAuB,GAAG,GAC9DO,GAAyBP,EAAW,oBAAqB,GAAG,GAC5DO,GAAyBP,EAAW,oBAAqB,GAAG,GAC5DO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,eAAgB,GAAG,GACvDO,GAAyBP,EAAW,eAAgB,GAAG,GACvD,IAAM2J,QAAeC,GAAS5J,GAAW,GACnC0M,QAAa3F,GAAQ/G,GACrBsgC,QAA4Bh6B,GAAYtG,EAAW,GACnDugC,QAAwBj6B,GAAYtG,EAAW,GAC/CwgC,QAAyBl6B,GAAYtG,EAAW,GAChDygC,QFzBD,SAAgC/pC,GAAA,OAAA+oC,GAAA5oC,MAAC,KAAD7D,UAAA,CEyBR0tC,CAAkB1gC,GACzCkH,QAAqBsT,GAAgBxa,GACrCyM,QAAiB/H,GAAY1E,GAC7BwM,QAAgBpI,GAAWpE,GAC3B65B,QAAwBC,GAAmBH,EAAYC,GAEvDY,EhDqBD,SAAgC/tB,EAAoBD,EAAkB7C,EAAwBQ,EAAiBG,GACpH,IAIiCnQ,EAJ3BL,EAAS,CAAC,EACV2gC,EAEF,CAAC,EAAEpgC,EAAAC,GACmBkS,GAAO,IAAjC,IAAAnS,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAmC,KAAxBwS,EAAW9S,EAAAlD,MAEpBwjC,EADkBxtB,EAAY7E,OACN6E,CAC1B,CAAC,OAAA5V,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,KAEkCiO,EAFlCC,EAAA1O,GAE0BmS,GAAQ,IAAnC,IAAAzD,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAqC,KAA1B6S,EAAYvE,EAAA9R,MACfyjC,EAAgB,CAAC,EAGvBA,EAAchzB,QAAU4F,EAAa5F,QACrCgzB,EAAc3yB,UAAYuF,EAAavF,UACvC2yB,EAActyB,MAAQkF,EAAalF,MACnCsyB,EAAc9yB,UAAY0F,EAAa1F,UAGvC,IAAMgG,EAAc7Y,SAASuY,EAAanD,SACpCqG,EAAYpd,OAAOka,EAAalF,OAClCu4B,GAAyB,EACzBlsC,EAAgB,EAChBmZ,IAAgBzD,GAAWG,EAAgBxB,QAAQ8E,IAAgB,GAAKA,IAA0B,GAAVzD,GAC1Fw2B,GAAgB,EAChBlsC,EAAQ+b,EAAUnH,WAAW,GAAKxV,KAAKqhB,IAAI,IAAK,KAEhDyrB,GAAgB,EAChBlsC,EAAQ+b,EAAUnH,WAAW,IAE/BqxB,EAAcpyB,YAAcq4B,EAC5BjG,EAAcjmC,MAAQA,EAGtB,IAAIkmC,EAAc,CAAC,EACnB,GAAIF,EAAWt6B,eAAeqQ,GAA9B,CACEmqB,EAAcF,EAAWjqB,GAI3BkqB,EAAch5B,SAAW,CACvBk5B,SAAUtmC,WAAWqmC,EAAYE,UACjCC,UAAWxmC,WAAWqmC,EAAYI,YAIpC,IAAIptB,EAAgB,CAAC,EACjBqtB,GAAkB,EACtB,IAAK,IAAMhkC,KAAO2S,EAAO,CACvB,IAAMsxB,EAAgBtxB,EAAM3S,GAE5B,GADYikC,EAAc1wB,IAClBzB,QAAQ8E,IAAgB,EAAG,CACjCD,EAAgBstB,EAChBD,GAAkB,EAClB,KACF,CACF,CACAN,EAAcryB,UAAY2yB,EAAkBrtB,EAAcnT,EAAI,OAC9DkgC,EAAcvwB,QAAU6wB,EAAkBrtB,EAAc5C,GAAK,KAE7D,IAAMmD,EAAU,KAAKZ,EAAaE,SAC7B1T,EAAOqG,eAAe+N,KACzBpU,EAAOoU,GAAW,IAEpBpU,EAAOoU,GAASlU,KAAK0gC,EAzBrB,CA2BF,CAAC,OAAArjC,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACD,OAAOhB,CACT,CgD1F0B8mC,CAAuBn0B,EAAUD,EAAS7C,EAAOQ,EAASG,GAE9Eu2B,GAA6B,EAC7BC,EAAkD,CAAC,EACnDL,EAAetgC,eAAe,KAAKgK,OACrC02B,GAAoB,EACpBC,EAAqBL,EAAe,KAAKt2B,MAG3C,IAK+BhQ,EALzBujB,EAAuB/e,GAAsB,wBAE/C7E,EAAS,GACTinC,EAAY,GAAG1mC,EAAAC,GAEA4M,GAAY,IAA/B,IAAA7M,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAiC,KAAtBoO,EAAI1O,EAAAlD,MACT+pC,EAAqB,CAAC,EAEpBpzB,EAAc/E,EAAKsB,QAGzB,GAAI,CAACA,EAAmB,GAAVA,GAAc82B,SAASrzB,IAAgBtD,EAAgB22B,SAASrzB,GAAc,CAE1FozB,EAAmBpgC,OAASqG,GAAkB4B,aAAI,EAAJA,EAAM3B,aAAcwW,GAGlE,IAAMa,EAAc,KAAK1V,EAAK2E,SAC1ByS,EAAW,CAAC,EAChB,IAAIvT,EAAKvM,eAAeoe,GAGtB,SAFA0B,EAAWvT,EAAK6R,GAIlByiB,EAAmBj2B,GAAKlC,EAAK2E,OAC7BwzB,EAAmBE,SAAWjhB,EAASkhB,MACvCH,EAAmB7gB,OAASF,EAASE,OAGrC,IAAMiB,EAAkB,KAAKnB,EAAS7R,iBAClCgzB,EAAyB,CAAC,EAC9B,IAAId,EAAmBngC,eAAeihB,GAGpC,SAFAggB,EAAyBd,EAAmBlf,GAI9C4f,EAAmBtsC,KAAO0sC,EAAuB5mC,EACjDwmC,EAAmBK,kBAAoBD,EAAuB/1B,EAC3DkP,OAAO,SAACxP,GAAU,OAAKA,IAAOZ,CAAO,GACrChW,IAAI,SAAC4W,GACJ,IAAMu2B,EAAsB,KAAKv2B,IACjC,GAAIpB,EAAMxJ,eAAemhC,GAAsB,CAC7C,IAAMC,EAAmB53B,EAAM23B,GAY/B,MAXkC,CAChC5sC,KAAM6sC,EAAiB/mC,EACvBgnC,eAAgB,CACdC,eAAgBF,EAAiBv2B,IACjC02B,iBAAkBH,EAAiBt2B,IACnC9D,KAAM,GAAGo6B,EAAiBv2B,SAAcu2B,EAAiBt2B,MACzD02B,KAAM,SAASJ,EAAiBv2B,iCAAsCu2B,EAAiBt2B,cAEzFd,QAASo3B,EAAiBx2B,GAC1BT,gBAAiBi3B,EAAiBh3B,IAGtC,CACE,OAAO,IAEX,GACCgQ,OAAO,SAAC1f,GACP,OAAa,OAANA,CACT,GACFmmC,EAAmBt/B,SAAW,CAC5Bo5B,UAAWsG,EAAuBj2B,GAClCyvB,SAAUwG,EAAuBh2B,IAEnC21B,EAAU/mC,KAAK,CACb4gC,SAAUwG,EAAuBh2B,GACjC0vB,UAAWsG,EAAuBj2B,GAClCJ,GAAIlC,EAAK2E,SAIX,IAAMo0B,EAAgCR,EAAuBS,EACzDC,EAAsD,GACtDtB,EAAgBrgC,eAAeyhC,KACjCE,EAA0BtB,EAAgBoB,IAE5C,IAC0C74B,EADtCg5B,EAA+D,GAAG/4B,EAAA1O,GACnDwnC,GAAuB,IAA1C,IAAA94B,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAA4C,KACpCunC,EAAoB,MADbj5B,EAAA9R,MACwBiU,OACrC,GAAIq1B,EAAepgC,eAAe6hC,GAAoB,CACpD,IAAMC,EAAqB1B,EAAeyB,GACpCE,EAA2D,CAC/DxtC,KAAMutC,EAAmBznC,EACzBqqB,SAAiJ,EAAvI7oB,EAA2BimC,EAAmB72B,GAAG,GAAI62B,EAAmB92B,GAAG,GAAIi2B,EAAuBh2B,GAAIg2B,EAAuBj2B,IAC3ID,KAAM+2B,EAAmB/2B,MAE3B62B,EAAgB/nC,KAAKkoC,EACvB,CACF,CAAC,OAAA7qC,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACDinC,EAAgBlxB,KAAK,SAAUrU,EAAGsU,GAChC,OAAOtU,EAAEqoB,SAAW/T,EAAE+T,QACxB,GACAmc,EAAmBe,gBAAkBA,EAGrC,IACwDvyB,EADpDmtB,EAAQ,GAAI/sB,EAAAtV,GACgB8mC,EAAuB7mC,GAAC,IAAxD,IAAAqV,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAA0D,KAClD0nC,EAAqB,KADD3yB,EAAAvY,QAEtBujC,EAAgBr6B,eAAegiC,IACjCxF,EAAM3iC,KAAKwgC,EAAgB2H,GAAoBhuC,IAAI,SAAC0G,GAAC,OAAKoN,GAAUpN,EAAE,GAE1E,CAAC,OAAAxD,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACDkmC,EAAmBrE,MAAQA,EAAMyF,OAAOvxB,KAAK,SAAUrU,EAAGsU,GACxD,OAAOtU,EAAE/H,MAAQqc,EAAErc,KACrB,GAGA,IAAImoC,EAAsB,GACtB/C,EAAgB15B,eAAeoe,KACjCqe,EAAsB/C,EAAgBtb,IAExCyiB,EAAmBnE,gBAAkBD,EAGrC,IAAIyF,GAA2B,EAC3BC,GAA2B,EAC3BC,GAAyB,EACzBC,GAAuB,EAC3B,GAAI3B,EAAmB,CACrB,IAAMrO,EAAW,KAAKwO,EAAmB7gB,SACrCsiB,EAAqB,GAErB3B,EAAmB3gC,eAAeqyB,GACpCiQ,EAAqB3B,EAAmBtO,GAEN,MAA9BwO,EAAmB7gB,SACrBqiB,GAAc,EACdC,EAAqB3B,EAAwB,KAEhD,IAE8C7nB,EAF9CC,EAAA5e,GAE4BmoC,GAAkB,IAA/C,IAAAvpB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAiD,KAAtCioC,EAAczpB,EAAAhiB,MACnByrC,EAAeC,eAAiB95B,EAAK2E,QAAUk1B,EAAeE,oBAAsB/5B,EAAK2E,SAC3F60B,GAAkB,GAEhBG,GACEE,EAAeC,eAAiB95B,EAAK2E,SACvC+0B,GAAgB,GAEdG,EAAeE,oBAAsB/5B,EAAK2E,SAC5C80B,GAAkB,KAGhBI,EAAeC,eAAiB95B,EAAK2E,SACvC80B,GAAkB,GAEhBI,EAAeE,oBAAsB/5B,EAAK2E,SAC5C+0B,GAAgB,GAGtB,CAAC,OAAAlrC,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACH,CACAkmC,EAAmB6B,cAAgB,CACjCR,gBAAAA,EACAC,gBAAAA,EACAC,cAAAA,GAGFzoC,EAAOE,KAAKgnC,EACd,CACF,CAAC,OAAA3pC,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAEDhB,EAAO+W,KAAK,SAAUrU,EAAGsU,GACvB,OAAOtU,EAAE0kC,SAAWpwB,EAAEowB,QACxB,GAaA,IAXA,IAAM4B,EDlMD,SAA4B/B,GAIjC,IAJoG,IAAvC/L,EAAchiC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,IACxE+vC,EAAsB3C,KACxB4C,EAAmB//B,IACnBggC,GAAgB,EACXlpC,EAAIgnC,EAAU9tC,OAAS,EAAG8G,EAAI,EAAGA,IAAK,CAC7C,IAAM2H,EAAWq/B,EAAUhnC,GACrB8qB,EAAW7oB,EAA2B+mC,EAAoBnI,SAAUmI,EAAoBjI,UAAWp5B,EAASk5B,SAAUl5B,EAASo5B,WACjIjW,GAAYmQ,GACVnQ,EAAWme,IACbC,EAAelpC,EACfipC,EAAmBne,EAGzB,CAEA,OAAIoe,EAAe,EACVlC,EAAUkC,GAEV,IAEX,CC8K0BC,CAAmBnC,EAAW,KAElDoC,IAA8B,EAC9BC,IAA8B,EAE9BnJ,GAA6D,CAAC,EAC9D6C,GAAwB,EACxBntB,GAA0C,CAAC,EAEzC0zB,GAAevpC,EAAO7G,OAEnBwB,GAAQ,EAAGA,GAAQ4uC,GAAc5uC,KAAS,CACjD,IAAIoU,GAAO/O,EAAOrF,IACZ6uC,GAAWxpC,EAAOrF,GAAQ,IAAMoU,GAClCvH,GAAW,EAEf,GAAIuH,GAAK8zB,MAAM1pC,OAAS,GAClB4V,GAAK8zB,MAAM,GAAGr0B,YAAa,CAC7B,IAAAi7B,GAAe,CAAC16B,GAAK8zB,MAAM,GAAGj7B,SAASo5B,UAAWjyB,GAAK8zB,MAAM,GAAGj7B,SAASk5B,UAAlE9F,GAACyO,GAAA,GAAExO,GAACwO,GAAA,GACXC,GAAiB,CAAC36B,GAAKnH,SAASo5B,UAAWjyB,GAAKnH,SAASk5B,UAAlD6I,GAAED,GAAA,GAAEE,GAAEF,GAAA,GACbG,GAAiB,CAACL,GAAS5hC,SAASo5B,UAAWwI,GAAS5hC,SAASk5B,UAA1DgJ,GAAED,GAAA,GAAEE,GAAEF,GAAA,GAEb,IADoB7O,GAAI2O,KAAOG,GAAK9O,KAAMC,GAAI2O,KAAOG,GAAK9O,KACxC,EAAG,CAEnB,IAAM+O,GAAYjwC,KAAKwhB,MAAMyf,GAAI2O,GAAI1O,GAAI2O,IACnCK,GAAYlwC,KAAKwhB,MAAMyf,GAAI8O,GAAI7O,GAAI8O,IACzCviC,GAAWzN,KAAKuF,IAAI,EAAGvF,KAAKwF,IAAIyqC,IAAaA,GAAYC,IAAY,GACvE,CACF,CAEFl7B,GAAKvH,SAAWA,GAEZuH,GAAKg6B,cAAcP,kBACrBa,IAAqB,GAGnBt6B,GAAKg6B,cAAcN,eACjBY,KACFC,IAAqB,GAIrBD,KAAuBC,KACzBv6B,GAAKg6B,cAAcR,iBAAkB,GAGnCc,IAAsBC,KACxBD,IAAqB,EACrBC,IAAqB,GAGvB,IAAIY,IAAY,EACQ,OAApBlB,GACEA,EAAgB/3B,KAAOlC,GAAKkC,KAC9Bi5B,IAAY,GAGhBn7B,GAAKo7B,QAAUD,GAEf,IAAMxR,GAAW,KAAK3pB,GAAKsX,UAAY,MAElC8Z,GAAa95B,eAAeqyB,MAC/ByH,GAAazH,IAAY,GACzB7iB,GAAa6iB,IAAY,EACzBsK,IAAiB,GAGnB7C,GAAazH,IAAUx4B,KAAK6O,IAC5B8G,GAAa6iB,KAAa,CAC5B,CAEA,IAAMxoB,GAAYL,EAAM,KAAKQ,KAKvB+5B,GAA2B,CAC/BjK,aAAcA,GACd6C,cAAeA,GACfntB,aAAcA,GACdtH,UARoB2B,GAAUxP,EAS9BgnC,eAAgB,CACdC,eATuBz3B,GAAUgB,IAUjC02B,iBATyB13B,GAAUiB,KAWrCtH,eAAgBO,GAAkBlE,GAClCmK,QAAAA,EACAG,gBAAAA,GAMF,OAHAnH,GAA4BnD,GAC5BmE,GAAqBnE,GAEdkkC,EACT,GAAC7D,GAAAxpC,MAAA,KAAA7D,UAAA,C,y/BC/VD,IAAImxC,IAA8C,EAC9CC,GAAwC,CAAC,EA+C5C,SAAAC,KAAA,OAAAA,IAAAvtC,EAAAA,EAAAA,GA7CM,UAA2BkJ,GAAsC,SACvDqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,GACJ,CAAC,EAAG,IACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,eAAe1B,EAAIzD,EAAE,KAAM,QAC5Ef,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMwS,EAAW,qBACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IAOrB,aANM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACvCqqC,KACHA,IAAqC,EACrCC,GAAgCtqC,GAE3BA,CACT,CACE,IAAI,IAAI1H,MAAOuB,UAAYoB,SAAS0Q,GAbd,OAaiD,CACrE,IAAM3L,QAAeuL,IAGrB,aAFM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACrCA,CACT,CACE,IAAKqqC,GAAoC,CACvC,IAAMx+B,QAAcrO,EAAU,EAAGkO,GACjC2+B,IAAqC,EACrCC,GAAgCtrC,KAAKC,MAAM4M,EAC7C,CAIA,OAHApF,GAAyBP,EAAW,gBAAiB,GAAG,GACxDO,GAAyBP,EAAW,gBAAiB,GAAG,GACxD4D,GAAkB5D,GAAY,GACvBokC,EAGb,GAACC,GAAAxtC,MAAA,KAAA7D,UAAA,C,y/BC9DD,IAAIsxC,IAAmD,EACnDC,GAA6C,CAAC,EA+CjD,SAAAC,KAAA,OAAAA,IAAA1tC,EAAAA,EAAAA,GA7CM,UAAgCkJ,GAAoC,SAC1DqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,IACJ,CAAC,EAAG,KACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,oBAAoB1B,EAAIzD,EAAE,KAAM,QACjFf,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMwS,EAAW,2BACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IAOrB,aANM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACvCwqC,KACHA,IAA0C,EAC1CC,GAAqCzqC,GAEhCA,CACT,CACE,IAAI,IAAI1H,MAAOuB,UAAYoB,SAAS0Q,GAbd,QAaiD,CACrE,IAAM3L,QAAeuL,IAGrB,aAFM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACrCA,CACT,CACE,IAAKwqC,GAAyC,CAC5C,IAAM3+B,QAAcrO,EAAU,EAAGkO,GACjC8+B,IAA0C,EAC1CC,GAAqCzrC,KAAKC,MAAM4M,EAClD,CAIA,OAHApF,GAAyBP,EAAW,qBAAsB,GAAG,GAC7DO,GAAyBP,EAAW,qBAAsB,GAAG,GAC7D4D,GAAkB5D,GAAY,GACvBukC,EAGb,GAACC,GAAA3tC,MAAA,KAAA7D,UAAA,C,y/BChDD,IAAIyxC,IAA+C,EAC/CC,GAAyC,CAAC,EA+C7C,SAAAC,KAAA,OAAAA,IAAA7tC,EAAAA,EAAAA,GA7CM,UAA4BkJ,GAAoC,SACtDqF,IAAO,OAAAC,EAAAzO,MAAC,KAAD7D,UAAA,UAAAsS,IAYrB,OAZqBA,GAAAxO,EAAAA,EAAAA,GAAtB,YACE,IAKsBqD,EADlBL,EAAS,GAAGO,EAAAC,GAJH,CACX,CAAC,EAAG,IACJ,CAAC,EAAG,KACJnG,IAAI,SAAC0G,GAAC,MAAM,CAAEkF,IAAK3B,EAAUvD,EAAE,GAAIA,EAAE,IAAKA,EAAM,IAE5B,IAAtB,IAAAR,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,KAAb6D,EAAGnE,EAAAlD,MACNiC,QAAa0G,EAAUtB,EAAIyB,IAAKC,EAAW,gBAAgB1B,EAAIzD,EAAE,KAAM,QAC7Ef,EAASA,EAAOwK,OAAOpL,EAAKqL,SAC5BX,GAAkB5D,EAAW9G,EAAKsL,cAAcC,WAClD,CAAC,OAAApN,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOhB,CACT,GAACwL,EAAAzO,MAAA,KAAA7D,UAAA,CAED,IACMwS,EAAW,sBACXC,QAAuBnO,EAAU,EAAG,GAAGkO,eAC7C,GAAuB,OAAnBC,EAAyB,CAC3B,IAAM3L,QAAeuL,IAOrB,aANM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACvC2qC,KACHA,IAAsC,EACtCC,GAAiC5qC,GAE5BA,CACT,CACE,IAAI,IAAI1H,MAAOuB,UAAYoB,SAAS0Q,GAbd,QAaiD,CACrE,IAAM3L,QAAeuL,IAGrB,aAFM7O,EAAU,EAAG,GAAGgP,eAAsB,IAAIpT,MAAOuB,iBACjD6C,EAAU,EAAGgP,EAAU1M,KAAKQ,UAAUQ,IACrCA,CACT,CACE,IAAK2qC,GAAqC,CACxC,IAAM9+B,QAAcrO,EAAU,EAAGkO,GACjCi/B,IAAsC,EACtCC,GAAiC5rC,KAAKC,MAAM4M,EAC9C,CAIA,OAHApF,GAAyBP,EAAW,iBAAkB,GAAG,GACzDO,GAAyBP,EAAW,iBAAkB,GAAG,GACzD4D,GAAkB5D,GAAY,GACvB0kC,EAGb,GAACC,GAAA9tC,MAAA,KAAA7D,UAAA,C,y/BCMD,SAAS4xC,GAA+Bz6B,EAAiBG,EAAgCu6B,EAAwBC,EAAmBC,GAClI,IjE1DMC,EACAC,EACAC,EACAnzC,EiEkH0Byd,EA3D5B21B,EAAqB,CACvBC,aAAc,CACZC,IAAK,CACH3wC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER0wC,IAAK,CACH5wC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER2wC,IAAK,CACH7wC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER4wC,IAAK,CACH9wC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER6wC,IAAK,CACH/wC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER8wC,IAAK,CACHhxC,KAAM,IACNC,IAAK,EACLC,KAAM,OAER+wC,IAAK,CACHjxC,KAAM,IACNC,IAAK,EACLC,KAAM,QAGVgxC,oBAAqB,EACrBC,oBAAqB,CACnBR,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,IAEPG,sBAAuB,CACrBT,IAAK,EACLC,IAAK,EACLC,IAAK,EACLC,IAAK,EACLC,IAAK,EACLC,IAAK,EACLC,IAAK,IAGHI,GjEpHAf,EAAc,IAAI5yC,KAClB6yC,EAAqBD,EAAM1Z,SAC3B4Z,EAAqBF,EAAMlyC,UAAYmyC,GACvClzC,EAAe,IAAIK,MAClBC,QAAQ6yC,GACfnzC,EAAOQ,SAAS,GAChBR,EAAOS,WAAW,GAClBT,EAAOU,WAAW,GAClBV,EAAOW,gBAAgB,GAChBX,GiE2GoC6d,EAAAtV,GACxBwqC,GAAa,IAAhC,IAAAl1B,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAkC,KAAvBoO,EAAI2G,EAAAvY,MACb,GAAIqT,EAAgBxB,QAAQD,EAAKyB,kBAAoB,GAC7B,MAAlBzB,EAAKm9B,SAcP,IAbA,IAAMC,EAAYpxC,EAAqBgU,EAAKq9B,WACtCC,EAAgBr0C,EAAWi0C,EAAgBE,EAAUtxC,IAAK,EAAG,GAC7DyxC,EAAsBh/B,GAAcyB,EAAKw9B,UAAW,GACpDC,EAAgCx0C,EAAWq0C,EAAe,EAAGC,EAAoBn0C,MAAOm0C,EAAoBl0C,SAC5Gq0C,EAAoBn/B,GAAcyB,EAAK29B,QAAS,GAChDC,EAA8B30C,EAAWq0C,EAAe,EAAGI,EAAkBt0C,MAAOs0C,EAAkBr0C,SACtGw0C,EAA8B7yC,KAAKwY,IAA8B,GAA1Bk6B,EAAkBt0C,MAAas0C,EAAkBr0C,SAAuC,GAA5Bk0C,EAAoBn0C,MAAam0C,EAAoBl0C,UAExJy0C,EAAY5xC,SAAS8T,EAAK+9B,aAC1BC,EAAY9xC,SAAS8T,EAAKi+B,YAC1BC,GAAiBF,EAAYF,GAAa,EAC1CK,EAAkBN,EAA8BK,EAE7ChtC,EAAI,EAAGA,EAAIitC,EAAiBjtC,IAAK,CACxC,IAAIktC,GAAe,EACbC,EAAkBp1C,EAAWq0C,EAAe,EAAGC,EAAoBn0C,MAAOm0C,EAAoBl0C,QAAU20C,EAAY9sC,GACtHmtC,EAAgBvzC,UAAY2yC,EAA8B3yC,YAC5DszC,GAAe,GAEbC,EAAgBvzC,UAAY8yC,EAA4B9yC,YAC1DszC,GAAe,IAGI,IAAjBA,IACF9B,EAASU,oBAAoBI,EAAUrxC,MAAMoF,KAAK,CAChDhI,KAAMk1C,EACNC,WAAYp0C,EAAam0C,EAAiB,SAC1CE,SAAUP,EACVQ,UAAWxzC,KAAKwY,IAAI06B,EAAgBF,KAEtC1B,EAASW,sBAAsBG,EAAUrxC,OAAS,EAEtD,CAGN,CAAC,OAAAyC,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,KAC2Bme,EAD3BC,EAAA5e,GACkByqC,GAAS,IAA5B,IAAA7rB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAA8B,KAAnBoO,EAAIoQ,EAAAhiB,MACb,GAAIqT,EAAgBxB,QAAQD,EAAKyB,kBAAoB,GAC7B,MAAlBzB,EAAKm9B,SAAkB,CACzB,IACMC,EAAYpxC,EAAqBgU,EAAKq9B,WACtCC,EAAgBr0C,EAAWi0C,EAAgBE,EAAUtxC,IAAK,EAAG,GAC7D2yC,EAAoBlgC,GAAcyB,EAAK0+B,cAAe,GACtDL,EAAkBp1C,EAAWq0C,EAAe,EAAGmB,EAAkBr1C,MAAOq1C,EAAkBp1C,SAG9FizC,EAASU,oBAAoBI,EAAUrxC,MAAMoF,KAAK,CAChDhI,KAAMk1C,EACNC,WAAYp0C,EAAam0C,EAAiB,SAC1CE,SAAU,GACVC,UAAW,IAEblC,EAASW,sBAAsBG,EAAUrxC,OAAS,CAEtD,CAEJ,CAAC,OAAAyC,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACD,IAAK,IAAMlG,KAAQuwC,EAASU,oBAC1BV,EAASU,oBAAoBjxC,GAAMic,KAAK,SAAUrU,EAAGsU,GACnD,OAAOtU,EAAExK,KAAK2B,UAAYmd,EAAE9e,KAAK2B,SACnC,GAEF,OAAOwxC,CACT,CAoJC,SAAAqC,KAAA,OAAAA,IAAA1wC,EAAAA,EAAAA,GA9CM,UAAqCqT,EAAiBG,EAAgCtK,GAC3F,IACMgK,EAvRR,SAAmBL,EAAcQ,GAC/B,IACwBhQ,EADpB6P,EAAY,CAAC,EAAe3P,EAAAC,GACbqP,GAAK,IAAxB,IAAAtP,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAA0B,KAAfoO,EAAI1O,EAAAlD,MACb,GAAI4R,EAAK4+B,KAAOt9B,EAAS,CACvBH,EAAYnB,EACZ,KACF,CACF,CAAC,OAAAxR,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAOkP,CACT,CA8QoB09B,OADG99B,GAAS5J,GAAW,GACNmK,GAE7B26B,QF3RD,SAA+BjlC,GAAA,OAAA2kC,GAAA3tC,MAAC,KAAD7D,UAAA,CE2RR20C,CAAiB3nC,GACvC+kC,QD5RD,SAA2BllC,GAAA,OAAA8kC,GAAA9tC,MAAC,KAAD7D,UAAA,CC4RR40C,CAAa5nC,GAC/B6nC,QH/QD,SAA0BhoC,GAAA,OAAAwkC,GAAAxtC,MAAC,KAAD7D,UAAA,CG+QR80C,CAAY9nC,GAC7B6kC,EA3ER,SAA2B76B,GACzB,IAAM+9B,EAA0B3gC,GAAc4C,EAAUg+B,eAAgB,GAClEC,EAAyB7gC,GAAc4C,EAAUk+B,cAAe,GAEhEC,EAA4B/gC,GAAc4C,EAAUo+B,iBAAkB,GACtEC,EAA2BjhC,GAAc4C,EAAUs+B,gBAAiB,GAEpEC,EAAmCnhC,GAAc4C,EAAUw+B,sBAAuB,GAClFC,EAAkCrhC,GAAc4C,EAAU0+B,qBAAsB,GAEhFC,EAAqCvhC,GAAc4C,EAAU4+B,wBAAyB,GACtFC,EAAoCzhC,GAAc4C,EAAU8+B,uBAAwB,GAEpFC,EAAiB3hC,GAAc4C,EAAUg/B,YAAa,GACtDC,EAAoB7hC,GAAc4C,EAAUk/B,eAAgB,GAE5DC,EAA0B/hC,GAAc4C,EAAUo/B,mBAAoB,GACtEC,EAA6BjiC,GAAc4C,EAAUs/B,sBAAuB,GAIlF,MAAO,CACLC,GAAI,CACFC,QAAS,CACPC,MAAO1B,EACP2B,KAAMzB,EACNc,eAAgBA,EAChBE,kBAAmBA,GAErBU,QAAS,CACPF,MAAOlB,EACPmB,KAAMjB,EACNM,eAAgBI,EAChBF,kBAAmBI,IAGvBO,KAAM,CACJJ,QAAS,CACPC,MAAOtB,EACPuB,KAAMrB,EACNU,eAAgBA,EAChBE,kBAAmBA,GAErBU,QAAS,CACPF,MAAOd,EACPe,KAAMb,EACNE,eAAgBI,EAChBF,kBAAmBI,IAGvBQ,aA9BmB7/B,EAAU6/B,aAgCjC,CAuByBC,CAAkB9/B,GACnCm7B,EAAWP,GAA+Bz6B,EAASG,EAAiBu6B,EAAgBC,EAAeC,GAEnGgF,EApRR,SAAsBlC,EAAoBmC,GACxC,IAC2BjhC,EADvBghC,EAAe,CAAC,EAAkB/gC,EAAA1O,GACnButC,GAAQ,IAA3B,IAAA7+B,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAA6B,KAAlBoO,EAAIE,EAAA9R,MACT4R,EAAKkC,KAAOi/B,IACdD,EAAelhC,EAEnB,CAAC,OAAAxR,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACD,OAAOivC,CACT,CA4QuBE,CAAapC,EADX79B,EAAUggC,YAG3BlwC,EAAiC,CACrC+qC,eAAgBA,EAChBM,SAAUA,EACVx4B,WAAY,CACV,CACE3V,IAAK,aACL+V,KAAM,QACN9V,MAAO+S,EAAUkgC,QAEnB,CACElzC,IAAK,UACL+V,KAAM,eACN9V,MAAO+S,EAAUmgC,0BAEnB,CACEnzC,IAAK,gBACL+V,KAAM,iBACN9V,MAAO8yC,EAAaK,QAEtB,CACEpzC,IAAK,iBACL+V,KAAM,OACN9V,MAAO8yC,EAAaM,WAEtB,CACErzC,IAAK,iBACL+V,KAAM,kBACN9V,MAAO8yC,EAAaO,SAM1B,OAFAnnC,GAA4BnD,GAC5BmE,GAAqBnE,GACdlG,CACT,GAAC0tC,GAAA3wC,MAAA,KAAA7D,UAAA,C,y/BC1UD,IAAMu3C,GAASh1C,EAAQ,KA+BhB,SAASi1C,GAAyBrjC,GAkDvC,IAlD6O,IAAhIsjC,EAAmBz3C,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GAAK03C,EAAmB13C,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GAAKkI,EAAelI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EAAG2xB,EAAY3xB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,UAAWyiB,EAAaziB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EAC5N23C,EAAqB,CACzB,CACE,EAAE,EAAG,GACL,CAAC,GAAI,IAEP,CACE,CAAC,GAAI,GACL,CAAC,EAAG,IAEN,CACE,CAAC,EAAG,GACJ,CAAC,EAAG,IAEN,CACE,CAAC,EAAG,GACJ,EAAE,EAAG,KAIHC,EAAoB,CACxB,CACE,EAAE,EAAG,GACL,EAAE,GAAI,GACN,CAAC,GAAI,IAEP,CACE,CAAC,GAAI,GACL,CAAC,GAAI,GACL,CAAC,EAAG,IAEN,CACE,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,IAEN,CACE,CAAC,EAAG,GACJ,EAAE,EAAG,GACL,EAAE,EAAG,KAMH1xC,EAjED,SAA8BiO,EAAc0jC,GAQjD,IAPA,IAAMC,EAASP,GAAOQ,OAAO5jC,EAAM,CACjC0jC,qBAAsBA,IAGlBvW,EAAOwW,EAAOE,QAAQ1W,KACtB2W,EAAS,GAENlW,EAAI,EAAGA,EAAIT,EAAMS,IAAK,CAE7B,IADA,IAAMmW,EAAM,GACHpW,EAAI,EAAGA,EAAIR,EAAMQ,IAAK,CAC7B,IAAMqW,EAAML,EAAOE,QAAQlqC,IAAIg0B,EAAGC,GAClCmW,EAAIlxC,KAAKmxC,EACX,CACAF,EAAOjxC,KAAKkxC,EACd,CAEA,OAAOD,CACT,CA+CeG,CAAqBjkC,EA7CmEnU,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KA8ClGshC,EAAOp7B,EAAKjG,OAEdo4C,EAA0B,GAErBtW,EAAI,EAAGA,EAAIT,EAAMS,IACxB,IAAK,IAAID,EAAI,EAAGA,EAAIR,EAAMQ,IACxB,GAAmB,IAAf57B,EAAK67B,GAAGD,GAAU,CAGpB,IADA,IAAMwW,EAAe,IAAI7pC,WAAW,GAC3B87B,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAEgCpjC,EAD5BoxC,EAAY,EAAElxC,EAAAC,GADAqwC,EAAmBpN,IAEL,IAAhC,IAAAljC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAkC,KAAA+wC,EAAvBC,EAAQtxC,EAAAlD,MACgC,KAAxB,QAArBu0C,EAAAtyC,EAAK67B,EAAI0W,EAAS,WAAG,IAAAD,OAAA,EAArBA,EAAwB1W,EAAI2W,EAAS,OACvCF,GAAa,EAEjB,CAAC,OAAAl0C,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDwwC,EAAa/N,GAAKgO,CACpB,CACAF,EAAWA,EAAS/mC,OAClBqxB,IACGb,EAAI55B,GAAWua,GACfsf,EAAI75B,GAAWua,EAChB,EAAIA,EACJ,EAAIA,EACJ,CACEwf,GAAIqW,EAAa,GAAKb,EAAch1B,EACpCyf,GAAIoW,EAAa,GAAKb,EAAch1B,EACpC0f,GAAImW,EAAa,GAAKb,EAAch1B,EACpC2f,GAAIkW,EAAa,GAAKb,EAAch1B,IAEtC,GAGN,KAAO,CAGL,IADA,IAAM61B,EAAe,IAAI7pC,WAAW,GAC3B87B,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAEgCx0B,EAD5BwiC,EAAY,EAAEviC,EAAA1O,GADAswC,EAAkBrN,IAEJ,IAAhC,IAAAv0B,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAkC,KAAAixC,EAAvBD,EAAQ1iC,EAAA9R,MACS,QAAtBy0C,EAACxyC,EAAK67B,EAAI0W,EAAS,WAAG,IAAAC,GAArBA,EAAwB5W,EAAI2W,EAAS,MACxCF,GAAa,EAEjB,CAAC,OAAAl0C,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACDwwC,EAAa/N,GAAKgO,CACpB,CACID,EAAaK,KAAK,SAACtgC,GAAC,OAAW,IAANA,CAAO,KAClCggC,EAAWA,EAAS/mC,OAClBqxB,IACGb,EAAI55B,GAAWua,GACfsf,EAAI75B,GAAWua,EAChB,EAAIA,EACJ,EAAIA,EACJ,CACEwf,GAAIqW,EAAa,GAAKZ,EAAcj1B,EACpCyf,GAAIoW,EAAa,GAAKZ,EAAcj1B,EACpC0f,GAAImW,EAAa,GAAKZ,EAAcj1B,EACpC2f,GAAIkW,EAAa,GAAKZ,EAAcj1B,IAEtC,IAIR,CAIJ,MAAO,yDAAyD6e,EAAiB,EAAVp5B,GAAeua,MAAU6e,EAAiB,EAAVp5B,GAAeua,oDAAwD41B,EAASh3C,KAAK,eAAeswB,cAAiBA,4EAC9N,CChJA,IAAMinB,GAAczuC,EAAsB,OACpC0uC,GAAoBpuC,EAAqBmuC,GAAa,OAOrD,SAASE,GAAW3kC,GACzB2M,GAAgB,UAChB83B,GAAYn5B,aAAa,YAAa,QAPjC,SAA+BtL,GACpC,IAAM4kC,EAAMvB,GAAyBrjC,EAAM,IAAK,GAAK,GAAK,EAAG,YAA0B,GACvF0kC,GAAkBroB,UAAYuoB,CAChC,CAKEC,CAAsB7kC,EAExB,CCUC,SAAA8kC,KAAA,OAAAA,IAAAn1C,EAAAA,EAAAA,GAtBM,UAAmCqT,GACxC,IAAMH,QAAkBC,GAAqBE,GAC7C,IAAkB,IAAdH,EAAqB,CACvB,IAAMkiC,EAAOC,GAAa,EAAG,CAC3BphC,GAAIZ,EACJzV,KAAMsV,EAAUxP,IAEdlC,UAAU8zC,OACZ9zC,UACG8zC,MAAM,CACLC,MAAOriC,EAAUxP,EACjBuF,IAAKmsC,IAEN3kB,KAAK,WACJjC,GAAc,eAAgB,QAChC,GAAE,MACK,SAACzqB,GACNyqB,GAAc,SAAU,QAE1B,EAEN,CACF,IAACzuB,MAAA,KAAA7D,UAAA,CAWA,SAAAs5C,KAAA,OAAAA,IAAAx1C,EAAAA,EAAAA,GATM,UAAwCqT,GAC7C,IAAMH,QAAkBC,GAAqBE,IAC3B,IAAdH,GAKF8hC,GAJaK,GAAa,EAAG,CAC3BphC,GAAIZ,EACJzV,KAAMsV,EAAUxP,IAItB,IAAC3D,MAAA,KAAA7D,UAAA,C,y/BC7BD,IAKMuhC,GAAqB,6BAEvBgY,GAAaC,GAAU,wBACvBC,GAAcF,GAAWvxC,MACzB0xC,GAAeH,GAAWtxC,OAC1B0xC,GAAc94C,KAAKwF,IAAIg9B,OAAOuW,iBATf,QASgD,EAE/DC,GAAmB,CAAC,EAoBxB,SAASC,KACP,IAAMpvC,EAAUL,SAAS8T,cAAc,OAGvC,OAFAzT,EAAQQ,UAAUkT,IAAI,MAEf,CACL1T,QAASA,EACTqN,GAAI,GAER,CAEA,SAASgiC,KAEP,IAAMC,EAAoB3vC,SAAS8T,cAAc,OACjD67B,EAAkB9uC,UAAUkT,IAAI,MAGhC,IAAM67B,EAAgB5vC,SAAS8T,cAAc,UAI7C,OAHA87B,EAAc/uC,UAAUkT,IAAI,MAC5B47B,EAAkBn7B,YAAYo7B,GAEvB,CACLvvC,QAASsvC,EACTjiC,GAAI,GAER,CAiDA,SAASmiC,GAAUxgB,EAA6BygB,EAAsBC,EAAoBp7B,EAAyBC,EAAoBxd,GACrIi4B,EAAerb,UAAY87B,EAAQz4C,KACnCg4B,EAAeja,aAAa,MAAOhe,EAAMo5B,YACzCnB,EAAexJ,QAAU,YAoKpB,SAA2BvuB,GAIhC,IAHA,IAAMyf,EAAoBzV,GAAsB,qBAC1C0uC,EAAsB1vC,EAAwB2vC,GAAqB,OACnEC,EAA6B5vC,EAAwB6vC,GAA4B,OAC9EzzC,EAAI,EAAGA,EAAI,EAAGA,IAAK,KAAA0zC,EAAAC,EACpBC,EAAyBN,EAAoBtzC,GAE7C6zC,EAAwBL,EAA2BxzC,GAMnD8zC,EAAgB,KAAK9zC,IACrB+zC,EAAqC,QAAnBL,EAAGZ,UAAgB,IAAAY,OAAA,EAAhBA,EAAkB5H,oBAAoBgI,GAC3DE,EAA8B,QAAnBL,EAAGb,UAAgB,IAAAa,OAAA,EAAhBA,EAAkBtI,aAAayI,GACnD,GAAIC,GAAsBC,EAAa,CAErC,IAAMC,EAAa9X,GAAoB,OACjC+X,EAAa/X,GAAoB,OACjCgY,EAAahY,GAAoB,OACjCiY,EAAajY,GAAoB,OACjCkY,EAAYlY,GAAoB,OAChCmY,EAAYnY,GAAoB,QAGtCgX,GAAUS,EAAwBI,EAAap5C,GAAK,EAAOyf,EAAmBra,GAC9Eu0C,GAAiBV,EAAuBE,EAAoBn5C,EAAKy5C,EAAWJ,EAAYC,EAAYC,EAAYC,EAAYE,EAAWt0C,EACzI,CAUF,CACF,CA1MIw0C,CAAkB95C,EACpB,EACAi4B,EAAeja,aAAa,cAAe26B,IAAe34C,EAAQ,OAAS,SAC3Ei4B,EAAeja,aAAa,YAAa+qB,GAAgBvrB,IACzDya,EAAeja,aAAa,kBAAmB+qB,GAAgBxrB,GACjE,CAEA,SAASs8B,GAAiBE,EAA4CC,EAA4CrB,EAAoBgB,EAAmBJ,EAAoBC,EAAoBC,EAAoBC,EAAoBE,EAAmB55C,GAC1P,SAASi6C,EAAaC,EAAuC18C,EAAeo8C,GAC1E,IACMO,EAvHY,GAuHL38C,EAGb08C,EAAYjZ,UAAY2Y,EAGxBM,EAAYE,SAASC,GAAgCF,EAAO,EAAGnC,GAzHnC,GADV,KA6HlBkC,EAAYja,KAAO,YAAeH,KAClCoa,EAAYI,aAAe,MAC3B,IAAMC,EAAY,GAAG57C,OAAOnB,GAAOoB,SAAS,EAAG,UACzC47C,EAAmBN,EAAYha,YAAYqa,GAC3CE,EAAaD,EAAiBj0C,MAC9Bm0C,EAAcF,EAAiBG,yBACrCT,EAAYU,SAASL,GAlIO,GAkI+BE,GAAc,EAAGN,GApItD,GAoIkFO,GAAe,EAAGD,EAC5H,CAEA,SAASI,EAAUX,EAAuCY,EAAkCnB,EAAmBJ,EAAoBC,EAAoBC,EAAoBC,GAEzK,IAAMqB,EAAe,IAAIp9C,KACzBo9C,EAAan9C,QAAQ,GACrBm9C,EAAal9C,SAAS,GACtBk9C,EAAa78C,YAAY48C,EAAkBv9C,KAAKY,eAChD48C,EAAal9C,SAASi9C,EAAkBv9C,KAAKa,YAC7C28C,EAAan9C,QAAQk9C,EAAkBv9C,KAAKc,WAC5C08C,EAAaj9C,SAAS,GACtBi9C,EAAah9C,WAAW,GACxBg9C,EAAa/8C,WAAW,GACxB+8C,EAAa98C,gBAAgB,GAE7B,IACMk8C,GAASW,EAAkBv9C,KAAK2B,UAAY67C,EAAa77C,WAAa,MAAyB,GAvJnF,GAwJZ87C,EAAWhD,GApJW,GAqJtBiD,EAA2C,GAA7BH,EAAkBnI,SAAgB,IAAI,MAA6B,GAzJrE,GA4JlBxS,GAAgB+Z,EAxJY,GAwJOC,EAAMa,EAAUC,EAAW,EAAG,QAAQ1B,MAAeC,MAAeC,MAAeC,MAGtHvZ,GAAgB+Z,EA3JY,GA2JOC,EAAM,EAAGc,EAAW,CAAEza,GAAI,EAAGC,GAAI,EAAGE,GAAI,EAAGD,GAAI,GAAKiZ,GAGvFO,EAAYja,KAAO,YAAeH,KAClCoa,EAAYI,aAAe,MAC3BJ,EAAYjZ,UAAY0Y,EACxB,IAAMjnC,EAAOooC,EAAkBpI,WACzBwI,EAAkBhB,EAAYha,YAAYxtB,GAC1CyoC,EAAYD,EAAgB30C,MAC5B60C,EAAaF,EAAgBP,yBACnCT,EAAYU,SAASloC,EAAM2nC,GAAUF,GAAQc,EAAYG,GAAc,EAAGD,EAC5E,CASA,IAAME,EAA+BryC,EAAqB+wC,EAA+B,OACnFuB,EAAsCD,EAA6Brb,WAAW,MASpF,GAjBA,SAAyB+Z,EAA4CpB,EAAoB34C,GAEvF,IAAMu7C,EAAc5C,IAAe34C,EACnC+5C,EAA8B/7B,aAAa,YAAa+qB,GAAgBwS,GAC1E,CAOAC,CAAgBzB,EAA+BpB,EAAY34C,GAvK7D,SAA0C+/B,GACxC+X,GAAaC,GAAU,wBACvBC,GAAcF,GAAWvxC,MACzB0xC,GAAeH,GAAWtxC,OAC1B0xC,GAAc94C,KAAKwF,IAAIg9B,OAAOuW,iBAnBb,QAmB8C,EAG/DpY,EAAOx5B,MAAQyxC,GAAcE,GAC7BnY,EAAOv5B,OAASyxC,GAAeC,GAG/B,IAAMnmB,EAAUgO,EAAOC,WAAW,MAClCjO,EAAQ0pB,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GACpC1pB,EAAQ/Q,MAAMk3B,GAAaA,GAC7B,CA4JEwD,CAAiCL,GAEb1C,IAAe34C,EAClB,CAEfs7C,EAAoCK,UAAU,EAAG,EAAG3D,GAAaC,IAGjE,IAAK,IAAIz6C,EAAQ,EAAGA,EAAQ,GAAIA,IAC9By8C,EAAaqB,EAAqC99C,EAAOo8C,GAG3D,IACsDl0C,EADtDE,EAAAC,GACgCm0C,GAAsB,IAAtD,IAAAp0C,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwD,CACtD60C,EAAUS,EADgB51C,EAAAlD,MACwCm3C,EAAWJ,EAAYC,EAAYC,EAAYC,EACnH,CAAC,OAAA92C,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,MAEEi1C,EAAoCK,UAAU,EAAG,EAAG3D,GAAaC,GAErE,CAEO,SAAS2D,GAAoBlL,EAAoBnzB,EAAyBC,GAE/E,IAAMm7B,GAAa,IAAIh7C,MAAOk5B,SAGxB0iB,EAAa9X,GAAoB,OACjC+X,EAAa/X,GAAoB,OACjCgY,EAAahY,GAAoB,OACjCiY,EAAajY,GAAoB,OACjCkY,EAAYlY,GAAoB,OAChCmY,EAAYnY,GAAoB,QAEhCoa,EAAcnL,EAASC,aACvBmL,EAAqBpL,EAASS,oBAC9BC,EAAsBV,EAASU,oBAG/B2K,GAFgBrL,EAASW,sBAEGnoC,EAAwB6vC,GAA4B,OAA2Cv6C,QACjI,GAAIs9C,IAAuBC,EAA2B,CACpD,IAAMz9B,EAAay9B,EAA4BD,EAC/C,GAAIx9B,EAAa,EAAG,CAIlB,IAFA,IAAM09B,EAAuB,IAAIx9B,iBAC3By9B,EAA8B,IAAIz9B,iBAC/BC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMy9B,EAAgB7D,KACtB2D,EAAqB5+B,YAAY8+B,EAAcjzC,SAC/C,IAAMkzC,EAAuB7D,KAC7B2D,EAA4B7+B,YAAY++B,EAAqBlzC,QAC/D,CACA4vC,GAAoBj6B,OAAOo9B,GAC3BjD,GAA2Bn6B,OAAOq9B,EACpC,MAIE,IAFA,IAAMG,EAAsBlzC,EAAwB2vC,GAAqB,OACnEC,EAA6B5vC,EAAwB6vC,GAA4B,OAC9Et6B,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAM49B,EAAkBN,EAA4B,EAAIt9B,EACxD29B,EAAoBC,GAAiBv9B,SACrCg6B,EAA2BuD,GAAiBv9B,QAC9C,CAEJ,CAKA,IAFA,IAAMs9B,EAAsBlzC,EAAwB2vC,GAAqB,OACnEC,EAA6B5vC,EAAwB6vC,GAA4B,OAC9EzzC,EAAI,EAAGA,EAAIw2C,EAAoBx2C,IAAK,CAC3C,IAAM8zC,EAAgB,KAAK9zC,IACrBozC,EAAUmD,EAAYzC,GACtBkD,EAAiBlL,EAAoBgI,GAErCnhB,EAAiBmkB,EAAoB92C,GACrC6zC,EAAwBL,EAA2BxzC,GAEzDmzC,GAAUxgB,EAAgBygB,EAASC,EAAYp7B,EAAgBC,EAAWlY,GAC1Eu0C,GAAiBV,EAAuBmD,EAAgB3D,EAAYgB,EAAWJ,EAAYC,EAAYC,EAAYC,EAAYE,EAAWt0C,EAC5I,CAEA8yC,GAAmB1H,CAGrB,CChRA,IAAI1zB,GAAqB,GACrBE,IAA6B,EAC7BD,IAAkC,EAEtC,SAASs/B,KACP,IAAMC,EAAkB5zC,SAAS8T,cAAc,OAC/C8/B,EAAgB/yC,UAAUkT,IAAI,MAE9B,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYP,MACxB2/B,EAAgBp/B,YAAYX,GAE5B,IAAMY,EAAezU,SAAS8T,cAAc,OAI5C,OAHAW,EAAa5T,UAAUkT,IAAI,MAC3B6/B,EAAgBp/B,YAAYC,GAErB,CACLpU,QAASuzC,EACTlmC,GAAI,GAER,CAgBO,SAASmmC,GAAsBvkC,EAAmBqF,EAAyBC,GAChF,SAASC,EAAeC,EAA0BC,EAAsBC,GACtE,SAASC,EAAWH,EAA0BC,GAE5Cb,GADwB9T,EAAqB0U,EAAa,OACjCC,EAAarF,KACxC,CAEA,SAASwF,EAAYJ,EAA0BC,GAC7C3U,EAAqB0U,EAAa,OAAqCd,UAAYe,EAAanb,KAClG,CAEA,SAASub,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEIK,SACFC,EAAWH,EAAaC,GACxBG,EAAYJ,EAAaC,GACzBI,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,KAE7BW,GAAcN,EAAkBD,IACnCE,EAAWH,EAAaC,GAErBO,GAAcN,EAAkBD,IACnCG,EAAYJ,EAAaC,GAEvBT,KAAsBM,GACxBO,EAAgBL,EAAaF,GAE3BP,KAA2BM,GAC7BU,EAAqBP,EAAaH,GAGxC,CAEA,IAAMY,EAAmBjG,EAAW1Z,OAEhC+e,IAAmBN,IACrBy/B,GAAuB1+B,aAAa,kBAAmB+qB,GAAgBxrB,IAGzE,IAAMa,EAA0BlV,EAAwByzC,GAA4B,OAA+Bn+C,OACnH,GAAI2f,IAAqBC,EAAyB,CAChD,IAAME,EAAaF,EAA0BD,EAC7C,GAAIG,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpD,IAAME,EAAqB49B,KAC3Bh+B,EAASnB,YAAYuB,EAAmB1V,QAC1C,CACA0zC,GAA2B/9B,OAAOL,EACpC,MAEE,IADA,IAAMM,EAAmB3V,EAAwByzC,GAA4B,OACpEl+B,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDI,EADsBT,EAA0B,EAAIK,GACpBK,QAClC,CAEJ,CAGA,IADA,IAAMD,EAAmB3V,EAAwByzC,GAA4B,OACpEr3C,EAAI,EAAGA,EAAI6Y,EAAkB7Y,IAAK,CACzC,IAAMyZ,EAAsBF,EAAiBvZ,GACvCqY,EAAezF,EAAW5S,GACE,IAA9B0X,GAAmBxe,OACrBif,EAAesB,EAAqBpB,EAAc,MAElDF,EAAesB,EAAqBpB,EAAcX,GAAmB1X,GAEzE,CAEA0X,GAAqB9E,EACrBgF,GAAoBM,EACpBP,GAAyBM,CAC3B,C,y/BCjHO,IAAMq/B,GAAoBl0C,EAAsB,OAC1Cm0C,GAA0B7zC,EAAqB4zC,GAAmB,OAClEE,GAA4B9zC,EAAqB6zC,GAAyB,OAE1EE,GAAuB/zC,EAAqB8zC,GAA2B,yBACvEE,GAA2Bh0C,EAAqB+zC,GAAsB,OACtElE,GAAsB7vC,EAAqBg0C,GAA0B,OACrEjE,GAA6B/vC,EAAqBg0C,GAA0B,OAE5EC,GAAsBj0C,EAAqB4zC,GAAmB,gCAC9DM,GAAkCl0C,EAAqBi0C,GAAqB,oCAC5EE,GAA2Bn0C,EAAqBi0C,GAAqB,mCACrEG,GAAkCp0C,EAAqBi0C,GAAqB,2CAE5EP,GAAyB1zC,EAAqB8zC,GAA2B,2BACzEH,GAA6B3zC,EAAqB0zC,GAAwB,OAE7C,SAAAW,KAsBzC,OAtByCA,IAAAh7C,EAAAA,EAAAA,GAA1C,UAA2CqT,EAAiBG,GAC1D,IAAM8J,EAAoBzV,GAAsB,qBAC1CozC,QAAkB3yB,GAAqB,QAASjV,GACtDwnC,GAAgCl/B,aAAa,YAAa+qB,GAAgBppB,IAC1Eu9B,GAAgCl/B,aAAa,cAAe+qB,GAAgBuU,IAC5EJ,GAAgCzuB,QAAU,WACxC4a,GAAiB,QAAS,CAAC3zB,GAC7B,EACAynC,GAAyBn/B,aAAa,YAAa+qB,GAAgBppB,IACnEw9B,GAAyB1uB,QAAU,YHhC9B,SAAkCrjB,GAAAosC,GAAAp1C,MAAC,KAAD7D,UAAA,CGiCrCg/C,CAAoB7nC,EACtB,EACA0nC,GAAgCp/B,aAAa,YAAa+qB,GAAgBppB,IAC1Ey9B,GAAgC3uB,QAAU,YHZrC,SAAuCzsB,GAAA61C,GAAAz1C,MAAC,KAAD7D,UAAA,CGa1Ci/C,CAAyB9nC,EAC3B,EDbK,WAIL,IAHA,IAAMiK,EAAoBzV,GAAsB,qBAE1CgO,EAAa,GACV5S,EAAI,EAAGA,EAFgB,EAEaA,IAC3C4S,EAAW3S,KAAK,CACdhD,IAAK+C,EACLgT,KAAM,OACN9V,MAAO,KAGXi6C,GAAsBvkC,GAAY,EAAMyH,EAC1C,CCEE89B,GFuBK,WAcL,IAbA,IAAM99B,EAAoBzV,GAAsB,qBAC1CwzC,EAAuB,CAC3B9M,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,IAAK,IAGHE,EAAsB,CAAC,EACvBT,EAAe,CAAC,EACXrrC,EAAI,EAAGA,EAHW,EAGaA,IAAK,CAC3C,IAAM8zC,EAAgB,KAAK9zC,IAC3B8rC,EAAoBgI,GAAiB,GACrCzI,EAAayI,GAAiB,CAC5Bl5C,IAAKoF,EACLnF,KAAM,QACNF,KAAM,IAER,IAAK,IAAI+T,EAAI,EAAGA,EAAI0pC,EAAqBtE,GAAgBplC,IAAK,CAC5D,IAAMzW,EAAO,IAAII,KACjBJ,EAAKO,SAAS,GACdP,EAAKQ,WAAe,GAAJiW,GAChBzW,EAAKS,WAAW,GAChBT,EAAKU,gBAAgB,GACrBmzC,EAAoBgI,GAAe7zC,KAAK,CACtChI,KAAMA,EACNm1C,WAAY,GACZC,SAAU,IAEd,CACF,CACAiJ,GACE,CACExK,oBAAqBA,EACrBT,aAAcA,EACdQ,oBA5BuB,EA6BvBE,sBAAuBqM,IAEzB,EACA/9B,EAEJ,CEnEEg+B,GACA,IAAMpyC,EAAYV,KACZgV,QN+OD,SAAoCzU,EAAApJ,EAAAC,GAAA,OAAA8wC,GAAA3wC,MAAC,KAAD7D,UAAA,CM/Ofq/C,CAAsBloC,EAASG,EAAiBtK,GAC1EkxC,GAAsB58B,EAAY3H,YAAY,EAAOyH,GACrDi8B,GAAoB/7B,EAAY6wB,UAAU,EAAO/wB,EACnD,GAAC09B,GAAAj7C,MAAA,KAAA7D,UAAA,CAEM,SAASs/C,GAAiBnoC,EAAiBG,GAChDwJ,GAAgB,gBAChBu9B,GAAkB5+B,aAAa,YAAa,QA5B0E,SAE9E5S,EAAApJ,GAAAq7C,GAAAj7C,MAAC,KAAD7D,UAAA,CA2BxCu/C,CAA4BpoC,EAASG,EACvC,C,y/BCtCA,IAAMkoC,GAAar1C,EAAsB,OACnCs1C,GAAmBh1C,EAAqB+0C,GAAY,OACpDE,GAAmBj1C,EAAqBg1C,GAAkB,OAC1DE,GAAuBl1C,EAAqBi1C,GAAkB,QAC9DE,GAA0Bn1C,EAAqBg1C,GAAkB,OACjEI,GAA0Bp1C,EAAqBg1C,GAAkB,WACjEK,GAAwBr1C,EAAqBg1C,GAAkB,OAC/DM,GAA4Bt1C,EAAqBq1C,GAAuB,OACxEE,GAAgCv1C,EAAqBg1C,GAAkB,OACvEQ,GAA2Bx1C,EAAqBu1C,GAA+B,OAC/EE,GAAqBz1C,EAAqB+0C,GAAY,OAExDW,GAAsB,CAAC,EACvBxhC,IAA6B,EAC7BD,IAAkC,EAElC0hC,GAAoC,EACpCC,GAAmC,EACnCC,GAAqC,EACrCC,GAAwC,CAAC,EACzCC,GAAkC,EAElCC,IAAgC,EAGhCC,GAAyC,KACzCC,GAAwC,IACxCC,GAA4C,KAC5CC,IAAqC,EACrCC,GAAuC,EACvCC,GAAuC,EACvCC,GAA6C,GAC7CC,IAAwC,EACxCC,IAAuC,EACvCC,IAA2C,EAE3CC,GAAoC,EACpCC,GAAmD,GAkDhD,SAASC,GAAexX,EAAuBxb,EAAgBizB,EAAsBC,GAC1FtB,GAAmB3wB,MAAMC,YAAY,OAAmCsa,EAAcjP,YACtFolB,GAAyB1wB,MAAMC,YAAY,OAAyC+xB,EAAa1mB,YACjGklB,GAA0BxwB,MAAMC,YAAY,OAAqC,GAAGlB,EAAOuM,gBAC3FklB,GAA0BxwB,MAAMC,YAAY,OAA+BgyB,EAAW3mB,WACxF,CAOA,SAASxL,GAAmC9e,GAC1C,IAAMC,EAAcD,EACpB,GAAI0wC,GAA8B,CAChC,IAAMQ,EAAcjxC,EAAYC,OAAOnC,SAAW,EAClDuxC,GAAwBtwB,MAAMC,YAAY,OAA8CiyB,EAAY5mB,WACtG,CACiC,QAA7BrqB,EAAYC,OAAOL,OACrB/F,SAASolB,oBAAoBjf,EAAYC,OAAOH,OAAQ+e,GAE5D,CAEA,SAASqyB,KACP,IAAM1jC,EAAa1R,KAGbq1C,EAAmBt3C,SAAS8T,cAAc,OAChDwjC,EAAiBz2C,UAAUkT,IAAI,MAC/BujC,EAAiB5pC,GAAKiG,EACtB2jC,EAAiBliC,aAAa,YAAa,SAC3CkiC,EAAiBliC,aAAa,aAAc,SAC5CkiC,EAAiBliC,aAAa,iBAAkB,KAChDkiC,EAAiBliC,aAAa,aAAc,KAG5C,IAAMmiC,EAAgBv3C,SAAS8T,cAAc,OAC7CyjC,EAAc12C,UAAUkT,IAAI,MAG5B,IAAMyjC,EAAwBx3C,SAAS8T,cAAc,OACrD0jC,EAAsB32C,UAAUkT,IAAI,MACpCyjC,EAAsBpiC,aAAa,YAAa,SAChDmiC,EAAc/iC,YAAYgjC,GAG1B,IAAMC,EAAsBz3C,SAAS8T,cAAc,OACnD2jC,EAAoB52C,UAAUkT,IAAI,MAGlC,IAAM2jC,EAAmB13C,SAAS8T,cAAc,OAChD4jC,EAAiB72C,UAAUkT,IAAI,MAC/B2jC,EAAiBtiC,aAAa,OAAQ,KACtCsiC,EAAiBtiC,aAAa,YAAa,SAC3CqiC,EAAoBjjC,YAAYkjC,GAGhC,IAAMC,EAAsB33C,SAAS8T,cAAc,OAUnD,OATA6jC,EAAoB92C,UAAUkT,IAAI,MAClC4jC,EAAoBviC,aAAa,OAAQ,KACzCuiC,EAAoBviC,aAAa,YAAa,QAC9CqiC,EAAoBjjC,YAAYmjC,GAGhCL,EAAiB9iC,YAAY+iC,GAC7BD,EAAiB9iC,YAAYijC,GAEtB,CACLp3C,QAASi3C,EACT5pC,GAAIiG,EAER,CAEA,SAASsV,GAAsB2uB,GAC7B,IAAMjkC,EAAa1R,KAGbinB,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAC1BmV,EAAYxb,GAAKiG,EACjBuV,EAAY9T,aAAa,YAAa,SACtC8T,EAAY9T,aAAa,aAAc,SACvC8T,EAAY9T,aAAa,iBAAkB,KAC3C8T,EAAY9T,aAAa,aAAc,KAGvC,IAAMyiC,EAAc73C,SAAS8T,cAAc,OAC3C+jC,EAAYh3C,UAAUkT,IAAI,MAG1B,IAAM2X,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAC1B8jC,EAAYrjC,YAAYkX,GAGxB,IAAMlC,EAAiBxpB,SAAS8T,cAAc,OAC9C0V,EAAe3oB,UAAUkT,IAAI,MAG7B,IAAM4X,EAAgB3rB,SAAS8T,cAAc,OAC7C6X,EAAc9qB,UAAUkT,IAAI,MAE5B,IAAM2jC,EAAmB13C,SAAS8T,cAAc,OAChD4jC,EAAiB72C,UAAUkT,IAAI,MAC/B2jC,EAAiBtiC,aAAa,OAAQ,KACtCsiC,EAAiBtiC,aAAa,YAAa,SAC3CuW,EAAcnX,YAAYkjC,GAE1B,IAAMC,EAAsB33C,SAAS8T,cAAc,OACnD6jC,EAAoB92C,UAAUkT,IAAI,MAClC4jC,EAAoBviC,aAAa,OAAQ,KACzCuiC,EAAoBviC,aAAa,YAAa,QAC9CuW,EAAcnX,YAAYmjC,GAE1BnuB,EAAehV,YAAYmX,GAG3B,IAAMmsB,EAAiB93C,SAAS8T,cAAc,OAC9CgkC,EAAej3C,UAAUkT,IAAI,MAC7B+jC,EAAetjC,YAAYZ,GAAe,wBAC1CkkC,EAAejyB,QAAU,YAssBpB,SAA0Bma,EAAuB+X,GACtD,IAAM7uB,EAAc9oB,EAAqBy1C,GAAoB,mBAA+F7V,KACtJgY,EAAkB53C,EAAqB8oB,EAAa,OACpDouB,EAAmBl3C,EAAqBy1C,GAAoB,mBAAuGkC,KAEnKE,EAAoB/uB,EAAY/U,cAChC+jC,EAAqBZ,EAAiBnjC,cAEtCgkC,EAAgC53C,EAAiB+2C,EAAkB,MACnEc,EAA2B73C,EAAiB2oB,EAAa,MAEzDmvB,EAAsBD,EAAyBxiD,OAE/C0iD,EAAwBL,EAAkBM,wBAC1CC,EAAkBtvB,EAAYqvB,wBAC9BE,EAAyBP,EAAmBK,wBAI5CG,EAHuBpB,EAAiBiB,wBAGCI,IAAMF,EAAuBE,IAGtEC,EAAeJ,EAAgBG,IAAML,EAAsBK,IAE3DE,EAAsD,SAA1C3vB,EAAYqG,aAAa,aACrC3a,EAAsD,SAA1CsU,EAAYqG,aAAa,aAE3C,GAAI3a,EAAW,CACb,IAAMkkC,EAAgBD,EAAY,IAAM,IAGxCvB,EAAiBliC,aAAa,aAAc,QAE5CkiC,EAAiBpyB,MAAMC,YAAY,OAA2C,GAAGuzB,OAEjFxvB,EAAY9T,aAAa,aAAc,QAEvC8T,EAAYhE,MAAMC,YAAY,OAAqC,GAAGyzB,OAGtE,IAAK,IAAIl8C,EAAI,EAAGA,EAAI27C,EAAqB37C,IAAK,CAC5C,IAAM8tB,EAAkB4tB,EAAyB17C,GAC3Cq8C,EAAuBZ,EAA8Bz7C,GAE3Dq8C,EAAqB7zB,MAAMC,YAAY,SAA+C,EAAIzoB,EAAI,GAAG8zB,YACjGuoB,EAAqB3jC,aAAa,iBAAkB0jC,GACpDC,EAAqB3jC,aAAa,aAAc,KAChDoV,EAAgBpV,aAAa,iBAAkB0jC,GAC/CtuB,EAAgBpV,aAAa,aAAc,IAC7C,CAEA8T,EAAY7D,iBACV,gBACA,WAEE,IAAK,IAAI3oB,EAAI,EAAGA,EAAI27C,EAAqB37C,IAAK,CAC5C,IAAM8tB,EAAkB4tB,EAAyB17C,GAC3Cq8C,EAAuBZ,EAA8Bz7C,GAC3Dq8C,EAAqB3jC,aAAa,iBAAkB,KACpD2jC,EAAqB3jC,aAAa,aAAc,KAChDoV,EAAgBpV,aAAa,iBAAkB,KAC/CoV,EAAgBpV,aAAa,aAAc,IAC7C,CAEAkiC,EAAiBliC,aAAa,aAAc,SAC5C8T,EAAY9T,aAAa,aAAc,QACzC,EACA,CAAEkQ,MAAM,IAGV4D,EAAY7D,iBACV,kBACA,WAEE,IAAK,IAAI3oB,EAAI,EAAGA,EAAI27C,EAAqB37C,IAAK,CAC5C,IAAM8tB,EAAkB4tB,EAAyB17C,GACpBy7C,EAA8Bz7C,GACtC0Y,aAAa,aAAc,KAChDoV,EAAgBpV,aAAa,aAAc,IAC7C,CACF,EACA,CAAEkQ,MAAM,GAEZ,CAGIuzB,GACEjkC,EACFojC,EAAgB3yB,iBACd,gBACA,WACE2yB,EAAgB5iC,aAAa,YAAa,QAC5C,EACA,CAAEkQ,MAAM,IAGV0yB,EAAgB5iC,aAAa,YAAa,SAE5C8T,EAAY9T,aAAa,YAAa,SACtCkiC,EAAiBliC,aAAa,YAAa,WAE3C4iC,EAAgB5iC,aAAa,YAAa,QAC1C8T,EAAY9T,aAAa,YAAa,QACtCkiC,EAAiBliC,aAAa,YAAa,QAE/C,CA9yBI4jC,CAAiBrlC,EAAYikC,EAC/B,EACApuB,EAAehV,YAAYsjC,GAG3B,IAAMmB,EAA0Bj5C,SAAS8T,cAAc,OACvDmlC,EAAwBp4C,UAAUkT,IAAI,MACtCyV,EAAehV,YAAYykC,GAE3BpB,EAAYrjC,YAAYgV,GAGxB,IAAM0vB,EAAcl5C,SAAS8T,cAAc,OAC3ColC,EAAYr4C,UAAUkT,IAAI,MAC1BmlC,EAAY9jC,aAAa,YAAa,SAGtC,IAAM+jC,EAAiBn5C,SAAS8T,cAAc,OAC9CqlC,EAAet4C,UAAUkT,IAAI,MAG7B,IAAMqlC,EAAgBp5C,SAAS8T,cAAc,OAC7CslC,EAAcv4C,UAAUkT,IAAI,MAC5BqlC,EAAchkC,aAAa,cAAe,QAC1CgkC,EAAchkC,aAAa,OAAQ,OACnCgkC,EAAchkC,aAAa,OAAQ,KACnCgkC,EAAcvzB,QAAU,WACtBwzB,GAAmB1lC,EAAY,EACjC,EAEA,IAAM2lC,EAAoBt5C,SAAS8T,cAAc,OACjDwlC,EAAkBz4C,UAAUkT,IAAI,MAChCulC,EAAkB9kC,YAAYZ,GAAe,mBAC7CwlC,EAAc5kC,YAAY8kC,GAC1BF,EAAc5kC,YAAYxU,SAASspB,eAAe,OAClD6vB,EAAe3kC,YAAY4kC,GAG3B,IAAMG,EAAoBv5C,SAAS8T,cAAc,OACjDylC,EAAkB14C,UAAUkT,IAAI,MAChCwlC,EAAkBnkC,aAAa,cAAe,SAC9CmkC,EAAkBnkC,aAAa,OAAQ,OACvCmkC,EAAkBnkC,aAAa,OAAQ,KACvCmkC,EAAkB1zB,QAAU,WAC1BwzB,GAAmB1lC,EAAY,EACjC,EAEA,IAAM6lC,EAAwBx5C,SAAS8T,cAAc,OACrD0lC,EAAsB34C,UAAUkT,IAAI,MACpCylC,EAAsBhlC,YAAYZ,GAAe,oBACjD2lC,EAAkB/kC,YAAYglC,GAC9BD,EAAkB/kC,YAAYxU,SAASspB,eAAe,SACtD6vB,EAAe3kC,YAAY+kC,GAG3B,IAAME,EAAkBz5C,SAAS8T,cAAc,OAC/C2lC,EAAgB54C,UAAUkT,IAAI,MAC9B0lC,EAAgBrkC,aAAa,cAAe,SAC5CqkC,EAAgBrkC,aAAa,OAAQ,OACrCqkC,EAAgBrkC,aAAa,OAAQ,KACrCqkC,EAAgB5zB,QAAU,WACxBwzB,GAAmB1lC,EAAY,EACjC,EAEA,IAAM+lC,EAAsB15C,SAAS8T,cAAc,OACnD4lC,EAAoB74C,UAAUkT,IAAI,MAClC2lC,EAAoBllC,YAAYZ,GAAe,UAC/C6lC,EAAgBjlC,YAAYklC,GAC5BD,EAAgBjlC,YAAYxU,SAASspB,eAAe,OACpD6vB,EAAe3kC,YAAYilC,GAG3B,IAAME,EAAqB35C,SAAS8T,cAAc,OAClD6lC,EAAmB94C,UAAUkT,IAAI,MACjC4lC,EAAmBvkC,aAAa,cAAe,SAC/CukC,EAAmBvkC,aAAa,OAAQ,OACxCukC,EAAmBvkC,aAAa,OAAQ,KACxCukC,EAAmB9zB,QAAU,WAC3BwzB,GAAmB1lC,EAAY,EACjC,EAEA,IAAMimC,EAAyB55C,SAAS8T,cAAc,OACtD8lC,EAAuB/4C,UAAUkT,IAAI,MACrC6lC,EAAuBplC,YAAYZ,GAAe,gBAClD+lC,EAAmBnlC,YAAYolC,GAC/BD,EAAmBnlC,YAAYxU,SAASspB,eAAe,OACvD6vB,EAAe3kC,YAAYmlC,GAG3B,IAAME,EAAsB75C,SAAS8T,cAAc,OACnD+lC,EAAoBh5C,UAAUkT,IAAI,MAClC8lC,EAAoBzkC,aAAa,cAAe,SAChDykC,EAAoBzkC,aAAa,OAAQ,kBAOzC,IAAM0kC,EAA0B95C,SAAS8T,cAAc,OACvDgmC,EAAwBj5C,UAAUkT,IAAI,MACtC+lC,EAAwBtlC,YAAYZ,GAAe,WACnDimC,EAAoBrlC,YAAYslC,GAChCD,EAAoBrlC,YAAYxU,SAASspB,eAAe,OACxD6vB,EAAe3kC,YAAYqlC,GAG3B,IAAME,EAA8B/5C,SAAS8T,cAAc,OAC3DimC,EAA4Bl5C,UAAUkT,IAAI,MAC1CgmC,EAA4B3kC,aAAa,cAAe,SACxD2kC,EAA4B3kC,aAAa,OAAQ,yBACjD2kC,EAA4B3kC,aAAa,UAAW,QAEpD,IAAM4kC,EAAkCh6C,SAAS8T,cAAc,OAC/DkmC,EAAgCn5C,UAAUkT,IAAI,MAC9CimC,EAAgCxlC,YAAYZ,GAAe,kBAC3DmmC,EAA4BvlC,YAAYwlC,GACxCD,EAA4BvlC,YAAYxU,SAASspB,eAAe,OAChE6vB,EAAe3kC,YAAYulC,GAE3Bb,EAAY1kC,YAAY2kC,GAGxB,IAAMc,EAAej6C,SAAS8T,cAAc,OAC5CmmC,EAAap5C,UAAUkT,IAAI,MAC3BkmC,EAAa7kC,aAAa,YAAa,QACvC8jC,EAAY1kC,YAAYylC,GAGxB,IAAMC,EAA2Bl6C,SAAS8T,cAAc,OACxDomC,EAAyBr5C,UAAUkT,IAAI,MACvCmmC,EAAyB9kC,aAAa,YAAa,SACnD8jC,EAAY1kC,YAAY0lC,GAGxB,IAAMC,EAAyBn6C,SAAS8T,cAAc,OACtDqmC,EAAuBt5C,UAAUkT,IAAI,MACrComC,EAAuB/kC,aAAa,YAAa,SACjD8jC,EAAY1kC,YAAY2lC,GAGxB,IAAMC,EAAyBp6C,SAAS8T,cAAc,OAStD,OARAsmC,EAAuBv5C,UAAUkT,IAAI,MACrCqmC,EAAuBhlC,aAAa,YAAa,SACjD8jC,EAAY1kC,YAAY4lC,GAGxBlxB,EAAY1U,YAAYqjC,GACxB3uB,EAAY1U,YAAY0kC,GAEjB,CACL74C,QAAS6oB,EACTxb,GAAIiG,EAER,CAEA,SAAS0mC,KACP,IAAMh6C,EAAUL,SAAS8T,cAAc,OACvCzT,EAAQQ,UAAUkT,IAAI,MAEtB,IAAMumC,EAAgBt6C,SAAS8T,cAAc,OAC7CwmC,EAAcz5C,UAAUkT,IAAI,MAE5B,IAAMmkC,EAAqBl4C,SAAS8T,cAAc,OAClDokC,EAAmBr3C,UAAUkT,IAAI,MAEjC,IAAMwmC,EAAiBv6C,SAAS8T,cAAc,OAC9CymC,EAAe15C,UAAUkT,IAAI,MAE7B,IAAMkkC,EAAoBj4C,SAAS8T,cAAc,OACjDmkC,EAAkBp3C,UAAUkT,IAAI,MAEhC,IAAMymC,EAAmBx6C,SAAS8T,cAAc,OAQhD,OAPA0mC,EAAiB35C,UAAUkT,IAAI,MAE/BkkC,EAAkBzjC,YAAYgmC,GAC9BtC,EAAmB1jC,YAAY+lC,GAC/BD,EAAc9lC,YAAY0jC,GAC1BoC,EAAc9lC,YAAYyjC,GAC1B53C,EAAQmU,YAAY8lC,GACb,CACLj6C,QAASA,EACTqN,GAAI,GAER,CAEA,SAAS+sC,KACP,IAAMp6C,EAAUL,SAAS8T,cAAc,OAEvC,OADAzT,EAAQQ,UAAUkT,IAAI,MACf,CACL1T,QAASA,EACTqN,GAAI,GAER,CA4DA,SAASgtC,GAAiBzjC,EAA8BtC,EAAyBC,GAA0B,IAAA+lC,EAAAC,EACzG,SAASC,EAAWrwB,EAA8BuuB,EAAmCtrC,EAA8BqtC,EAAyCnmC,EAAyBC,GACnL,SAASmmC,EAAavwB,EAA8BuuB,EAAmCtrC,EAA8BkH,EAAyBC,GAC5I,IAAMomC,EAA0B56C,EAAqB24C,EAAsB,OACrEkC,EAA4B76C,EAAqB46C,EAAyB,OAC1EE,EAAyB96C,EAAqB46C,EAAyB,OAEvEG,EAAwB/6C,EAAqBoqB,EAAiB,OAC9D4wB,EAA0Bh7C,EAAqB+6C,EAAuB,OACtEE,EAAuBj7C,EAAqB+6C,EAAuB,OAOzE,GALAD,EAAuB9lC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAEjE6qB,EAAqBjmC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC/D6qB,EAAqBrnC,UAAYvG,EAASlK,OAAOuG,MAE5C6K,GACCC,EAAW,CACb,IAAM0mC,EAAsB9wB,EAAgB+tB,wBACtCI,EAAM2C,EAAoB3C,IAC1B4C,EAAOD,EAAoBC,KAC3BC,EAASF,EAAoBE,OAC7BC,EAAQH,EAAoBG,MAC5BC,EAAc1iB,OAAO2iB,WACrBC,EAAe5iB,OAAO6iB,YAC5B,GAAIL,EAAS,GAAK7C,EAAMiD,GAAgBH,EAAQ,GAAKF,EAAOG,EAwB1D,OAvBAT,EAA0B51B,iBACxB,eACA,WACE41B,EAA0B7lC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YACpEyqB,EAA0Bp6C,UAAUqV,OAAO,MAC3CglC,EAAuB9lC,aAAa,YAAa,QACnD,EACA,CAAEkQ,MAAM,IAEV81B,EAAwB/1B,iBACtB,eACA,WACE+1B,EAAwBhmC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAClE4qB,EAAwBpnC,UAAYvG,EAASlK,OAAOuG,KACpDsxC,EAAwBv6C,UAAUqV,OAAO,MACzCmlC,EAAqBjmC,aAAa,YAAa,QACjD,EACA,CAAEkQ,MAAM,IAEV+1B,EAAqBjmC,aAAa,YAAa,QAC/C8lC,EAAuB9lC,aAAa,YAAa,QACjD6lC,EAA0Bp6C,UAAUkT,IAAI,WACxCqnC,EAAwBv6C,UAAUkT,IAAI,KAG1C,CAGFknC,EAA0B7lC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YACpE4qB,EAAwBhmC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAClE4qB,EAAwBpnC,UAAYvG,EAASlK,OAAOuG,IACtD,CAEA,SAASgyC,EAAoBtxB,EAA8BuuB,EAAmCtrC,GAC5F+c,EAAgBpV,aAAa,iBAAkB+qB,GAAgB1yB,EAAS+3B,cAAcR,kBACtF+T,EAAqB3jC,aAAa,iBAAkB+qB,GAAgB1yB,EAAS+3B,cAAcR,iBAC7F,CAEA,SAAS+W,EAAWvxB,EAA8B/c,GAChDrN,EAAqBoqB,EAAiB,OAA8BxW,UAAYvG,EAASpW,IAC3F,CAEA,SAAS2kD,EAAYxxB,EAA8B/c,GACjDrN,EAAqBoqB,EAAiB,OAA+BrE,UAAsC,IAA1B1Y,EAAS6xB,MAAM1pC,OAAe,kCAAoE6X,EAAS6xB,MAAMxoC,IAAI,SAACmlD,GAAG,MAAK,kCAAwDA,EAAIhxC,gDAAuGyI,GAAY,0CAA2EuoC,EAAInxC,2DAAwHmxC,EAAIjxC,qCAAsEixC,EAAI14C,OAAOuG,gCAA+DmyC,EAAIr3C,wBAAwB,GAAE5N,KAAK,GAC9vB,CAEA,SAASklD,EAAwB1xB,EAA8B/c,GAC7DrN,EAAqBoqB,EAAiB,OAA4CrE,UAAkD,IAAtC1Y,EAASu2B,kBAAkBpuC,OAAe,kCAAgF6X,EAASu2B,kBAAkBltC,IAAI,SAACsqB,GAAK,MAAK,mDAA0K1N,GAAY,iCAA0E0N,EAAM/pB,mCAAiF+pB,EAAM+iB,eAAeG,4EAA0KljB,EAAMtU,aAAasU,EAAMnU,gBAAgBjW,KAAK,6FAA+IoqB,EAAMtU,mCAAmC,GAAE9V,KAAK,GACvgC,CAEA,SAASmlD,EAAsB3xB,EAA8B/c,GAC3DrN,EAAqBoqB,EAAiB,OAA2CrE,UAAgD,IAApC1Y,EAAS+xB,gBAAgB5pC,OAAe,oCAA4E6X,EAAS+xB,gBAAgB1oC,IAAI,SAACslD,GAAc,MAAK,mDAAuK1oC,GAAY,6CAAuG0oC,EAAejvB,iBAAiB91B,8BAAwFF,EAAWilD,EAAe9kD,KAAKD,QAAQM,EAAmBykD,EAAejvB,iBAAiBR,OAAO/qB,YAAYjK,EAAmBykD,EAAejvB,iBAAiBR,OAAOC,mCAA4EwvB,EAAeC,mBAAmB,GAAErlD,KAAK,GACl7B,CAEA,SAASslD,EAAsB9xB,EAA8B/c,GAC3DrN,EAAqBoqB,EAAiB,OAA0CrE,UAAgD,IAApC1Y,EAASi3B,gBAAgB9uC,OAAe,kCAA+E6X,EAASi3B,gBAAgB5tC,IAAI,SAACylD,GAAc,MAAK,mDAAoK7oC,GAAY,uCAA8E6oC,EAAellD,mCAA8EklD,EAAe/0B,uFAAiL+0B,EAAe1uC,iGAAiJ0uC,EAAe1uC,iCAAiC,GAAE7W,KAAK,GACx/B,CAEA,SAASwlD,EAAchyB,EAA8BuuB,EAAmCtrC,GACtF+c,EAAgBpV,aAAa,UAAW+qB,GAAgB1yB,EAASm5B,UACjEmS,EAAqB3jC,aAAa,UAAW+qB,GAAgB1yB,EAASm5B,SACxE,CAEA,SAAS6V,EAAa1D,EAAmCtrC,EAA8BqtC,EAAyCnmC,EAAyBC,GACvJ,IAAM8nC,GAAmB5B,aAAY,EAAZA,EAAc72C,WAAY,EAC7C04C,GAAelvC,aAAQ,EAARA,EAAUxJ,WAAY,EACrC24C,EAA4Bx8C,EAAqB24C,EAAsB,WAC7E,IAAKpkC,GACCC,GACuB,IAArB8nC,GAA2C,IAAjBC,GAAsBnmD,KAAKwY,IAAI2tC,EAAeD,GAAoB,EAU9F,OATAE,EAA0B13B,MAAMC,YAAY,OAA0C,aACtFy3B,EAA0Bv3B,iBACxB,gBACA,WACEu3B,EAA0BxnC,aAAa,YAAa,SACpDwnC,EAA0B13B,MAAMC,YAAY,OAA0C,QACxF,EACA,CAAEG,MAAM,IAMZq3B,EAAe,GACjBC,EAA0BxnC,aAAa,YAAa,QACpDwnC,EAA0B13B,MAAMC,YAAY,OAAkE,KAApBw3B,EAAe,GAAnB,MAEtFC,EAA0BxnC,aAAa,YAAa,QAExD,CAEA,SAASynC,EAAcryB,EAA8BuuB,EAAmCpkC,GAClFA,IAC0BvU,EAAqBoqB,EAAiB,OAC9CpV,aAAa,YAAa,SAC9CoV,EAAgBpV,aAAa,YAAa,SAC1C2jC,EAAqB3jC,aAAa,YAAa,SAEnD,CAEA,SAASD,EAAgBqV,EAA8BuuB,EAAmCnkC,GACxF4V,EAAgBpV,aAAa,YAAa+qB,GAAgBvrB,IAC1DmkC,EAAqB3jC,aAAa,YAAa+qB,GAAgBvrB,GACjE,CAEA,SAASS,EAAqBmV,EAA8BuuB,EAAmCpkC,GAC7F6V,EAAgBpV,aAAa,kBAAmB+qB,GAAgBxrB,IAChEokC,EAAqB3jC,aAAa,kBAAmB+qB,GAAgBxrB,GACvE,CAEA,SAASmoC,EAAyBtyB,EAA8B/c,GAC9D,IAAMwyB,EAA4B7/B,EAAqBoqB,EAAiB,sCACxEyV,EAA0Bpa,QAAU,WAClC4a,GAAiB,gBAAiB,CAACjW,EAAgB9c,GAAID,EAASC,GAAIuJ,EAAYnK,SAClF,EACAiV,GAAqB,OAAQtU,EAASC,IAAIwc,KAAK,SAAC1sB,GAC9CyiC,EAA0B7qB,aAAa,cAAe+qB,GAAgB3iC,GACxE,EACF,CAEA,SAASu/C,EAAiCvyB,EAA8B/c,GACtE,IAAMqzB,EAAoC1gC,EAAqBoqB,EAAiB,6CAChFsW,EAAkCjb,QAAU,WAC1Cqb,GAAyB,gBAAiB,CAAC1W,EAAgB9c,GAAID,EAASC,GAAIuJ,EAAYnK,QAASW,EAASlK,OAAOlN,MACnH,EACA,IAAM2mD,EAA6BlpB,GAA4BrmB,EAASC,IACxEozB,EAAkC1rB,aAAa,cAAe+qB,GAAgB6c,GAChF,CAEqB,OAAjBlC,GACFC,EAAavwB,EAAiBuuB,EAAsBtrC,EAAUkH,EAAgBC,GAC9EmnC,EAAWvxB,EAAiB/c,GAC5BuuC,EAAYxxB,EAAiB/c,GAC7ByuC,EAAwB1xB,EAAiB/c,GACzC0uC,EAAsB3xB,EAAiB/c,GACvC6uC,EAAsB9xB,EAAiB/c,GACvCquC,EAAoBtxB,EAAiBuuB,EAAsBtrC,GAC3D+uC,EAAchyB,EAAiBuuB,EAAsBtrC,GACrDgvC,EAAa1D,EAAsBtrC,EAAUqtC,EAAcnmC,EAAgBC,GAC3EioC,EAAcryB,EAAiBuuB,EAAsBpkC,GACrDQ,EAAgBqV,EAAiBuuB,EAAsBnkC,GACvDS,EAAqBmV,EAAiBuuB,EAAsBpkC,GAC5DmoC,EAAyBtyB,EAAiB/c,GAC1CsvC,EAAiCvyB,EAAiB/c,KAE9CA,EAASlK,OAAOlN,OAASykD,EAAav3C,OAAOlN,OAC/C0kD,EAAavwB,EAAiBuuB,EAAsBtrC,EAAUkH,EAAgBC,GAC9EmoC,EAAiCvyB,EAAiB/c,IAE/C6H,GAAcwlC,EAAaxb,MAAO7xB,EAAS6xB,QAC9C0c,EAAYxxB,EAAiB/c,GAE1B6H,GAAcwlC,EAAatb,gBAAiB/xB,EAAS+xB,kBACxD2c,EAAsB3xB,EAAiB/c,GAErCqtC,EAAalU,UAAYn5B,EAASm5B,SACpC4V,EAAchyB,EAAiBuuB,EAAsBtrC,GAEnDqtC,EAAa72C,WAAawJ,EAASxJ,UACrCw4C,EAAa1D,EAAsBtrC,EAAUqtC,EAAcnmC,EAAgBC,GAEzEkmC,EAAaptC,KAAOD,EAASC,KAC/BquC,EAAWvxB,EAAiB/c,GAC5BquC,EAAoBtxB,EAAiBuuB,EAAsBtrC,GAC3DyuC,EAAwB1xB,EAAiB/c,GACzC6uC,EAAsB9xB,EAAiB/c,GACvCqvC,EAAyBtyB,EAAiB/c,GAC1CsvC,EAAiCvyB,EAAiB/c,IAEhD6G,KAAsBM,GACxBO,EAAgBqV,EAAiBuuB,EAAsBnkC,GAErDP,KAA2BM,IAC7BkoC,EAAcryB,EAAiBuuB,EAAsBpkC,GACrDU,EAAqBmV,EAAiBuuB,EAAsBpkC,IAGlE,CAEA,IAAMsoC,EAAa9N,GAAU,UACvB+N,EAAaD,EAAWt/C,MACxBw/C,EAAcF,EAAWr/C,OAEzB6hC,EAAgBxoB,EAAYwoB,cAC5BntB,EAAe2E,EAAY3E,aAC3BsqB,EAAe3lB,EAAY2lB,aAEjCqZ,GAA6BxW,EAC7B0W,GAA0B+G,EAK1B,IAFA,IAAIE,EAAmB,EACjBC,EAAa,CAACpmC,EAAYktB,eAAeE,iBAAkBptB,EAAYktB,eAAeC,eAAgB,MAAMttC,IAAI,SAAC0G,GAAC,MAAK,IAAIA,GAAG,GAC3Hd,EAAI,EAAGA,EAAI+iC,EAAe/iC,IAAK,CACtC,IAAMy4B,EAAW,KAAKz4B,IAChBiB,EAAQo5B,GAAasmB,EAAW3gD,GAAI,IAAK,OAAQ,8BAnoBlC,GAooBrBw5C,GAAyB/gB,GAAY,CACnCx3B,MAAOA,EACPsmB,OAAQm5B,GAEVA,GAAoBz/C,CACtB,CAMA,GALAu4C,GAAyB,KAAKzW,KAAmB,CAC/C9hC,MAAO,EACPsmB,OAAQm5B,IAGLhH,GAAsB,CACzB,IACMkH,EAAoBpH,GADF,KAAKH,MAEvB9xB,GAAqC,EAA5Bq5B,EAAkBr5B,OAAwC,GAA1BkyB,GAA0D,GAA1BmH,EAAkB3/C,MAC3Fu5C,EAAeoG,EAAkB3/C,MAnpBlB,GAopBrBs5C,GAAehB,GAA4BhyB,EAAQizB,EAAcnB,GACnE,CAEI1hC,KAA2BM,IAC7B0gC,GAAiBjgC,aAAa,kBAAmB+qB,GAAgBxrB,IACjE8gC,GAAsBrgC,aAAa,kBAAmB+qB,GAAgBxrB,IACtEghC,GAA8BvgC,aAAa,kBAAmB+qB,GAAgBxrB,KAG5EL,KAAsBM,IACxBygC,GAAiBjgC,aAAa,YAAa+qB,GAAgBvrB,IAC3D6gC,GAAsBrgC,aAAa,YAAa+qB,GAAgBvrB,IAChE+gC,GAA8BvgC,aAAa,YAAa+qB,GAAgBvrB,MAGnD,QAAnB+lC,EAAA7E,UAAmB,IAAA6E,OAAA,EAAnBA,EAAqB7tC,WAAYmK,EAAYnK,UAC/CyoC,GAAwB1vB,QAAU,WAChCovB,GAAiBh+B,EAAYnK,QAASmK,EAAYhK,gBACpD,IAGqB,QAAnB2tC,EAAA9E,UAAmB,IAAA8E,OAAA,EAAnBA,EAAqB5vC,aAAciM,EAAYjM,YACjDsqC,GAAqBthC,UAAYiD,EAAYjM,WAG/C,IAAMuyC,EAAuBj9C,EAAwBu1C,GAAoB,OAAoBjgD,OAC7F,GAAI6pC,IAAkB8d,EAAsB,CAC1C,IAAM7nC,EAAa6nC,EAAuB9d,EAC1C,GAAI/pB,EAAa,EAAG,CAGlB,IAFA,IAAM8nC,EAAoB,IAAI5nC,iBACxB6nC,EAAkB,IAAI7nC,iBACnBC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAM6nC,EAAkBrD,KACxBmD,EAAkBhpC,YAAYkpC,EAAgBr9C,SAC9C,IAAMs9C,EAAgBlD,KACtBgD,EAAgBjpC,YAAYmpC,EAAct9C,QAC5C,CACAw1C,GAAmB7/B,OAAOwnC,GAC1B9H,GAA0B1/B,OAAOynC,EACnC,MAGE,IAFA,IAAMG,EAAgBt9C,EAAwBu1C,GAAoB,OAC5DgI,EAAcv9C,EAAwBo1C,GAA2B,OAC9D7/B,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMioC,EAAaP,EAAuB,EAAI1nC,EAC9C+nC,EAAcE,GAAY5nC,SAC1B2nC,EAAYC,GAAY5nC,QAC1B,CAEJ,CAIA,IAFA,IAAM6nC,EAAqBz9C,EAAwBu1C,GAAoB,OAE9Dn5C,EAAI,EAAGA,EAAI+iC,EAAe/iC,IAAK,CACtC,IAAMy4B,EAAW,KAAKz4B,IAChBshD,EAAmBD,EAAmBrhD,GACtCuhD,EAA6B79C,EAAqB49C,EAAkB,OACpEE,EAA+B99C,EAAqB49C,EAAkB,OACtEG,EAAsB79C,EAAwB29C,EAA4B,OAAyBroD,OACzG,GAAI0c,EAAa6iB,KAAcgpB,EAAqB,CAClD,IAAMzoC,EAAayoC,EAAsB7rC,EAAa6iB,GACtD,GAAIzf,EAAa,EAAG,CAGlB,IAFA,IAAM0oC,EAAmB,IAAIxoC,iBACvByoC,EAAqB,IAAIzoC,iBACtBC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMyoC,EAAsBjH,KACtBvrB,EAAiB7C,GAAsBq1B,EAAoB5wC,IACjE0wC,EAAiB5pC,YAAYsX,EAAezrB,SAC5Cg+C,EAAmB7pC,YAAY8pC,EAAoBj+C,QACrD,CACA49C,EAA2BjoC,OAAOooC,GAClCF,EAA6BloC,OAAOqoC,EACtC,MAGE,IAFA,IAAME,EAAwBj+C,EAAwB29C,EAA4B,OAC5EO,EAA0Bl+C,EAAwB49C,EAA8B,OAC7EroC,EAAI,EAAGC,GAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,GAAGD,IAAK,CACpD,IAAM4oC,GAAYN,EAAsB,EAAItoC,EAC5C0oC,EAAsBE,IAAWvoC,SACjCsoC,EAAwBC,IAAWvoC,QACrC,CAEJ,CACF,CAGA,IADA,IAAM2nC,GAAcv9C,EAAwBo1C,GAA2B,OAC9Dh5C,GAAI,EAAGA,GAAI+iC,EAAe/iC,KAAK,CACtC,IAAMy4B,GAAW,KAAKz4B,KAEhBgiD,GAAiBb,GAAYnhD,IACnCgiD,GAAev4B,UAAY,CAAClP,EAAYktB,eAAeE,iBAAkBptB,EAAYktB,eAAeC,eAAgB,IAAIttC,IAAI,SAAC0G,GAAC,MAAK,UAAUA,UAAU,GAAEd,IACzJgiD,GAAex5B,MAAMC,YAAY,OAA8B,GAAG+wB,GAAyB/gB,IAAUx3B,WACrG+gD,GAAex5B,MAAMC,YAAY,OAA8BzoB,GAAE8zB,YAEjE,IAAMwtB,GAAmBD,EAAmBrhD,IACxCiY,IACFqpC,GAAiBW,UAAY,GAO/B,IAJA,IAAMV,GAA6B79C,EAAqB49C,GAAkB,OACpEE,GAA+B99C,EAAqB49C,GAAkB,OACtEO,GAAwBj+C,EAAwB29C,GAA4B,OAC5EO,GAA0Bl+C,EAAwB49C,GAA8B,OAC7E9yC,GAAI,EAAGA,GAAIkH,EAAa6iB,IAAW/pB,KAAK,CAC/C,IAAMof,GAAkB+zB,GAAsBnzC,IACxC2tC,GAAuByF,GAAwBpzC,IAC/CqC,GAAWmvB,EAAazH,IAAU/pB,IACxC,GAAI0qC,GAAoBhzC,eAAe,gBACrC,GAAIgzC,GAAoBlZ,aAAa95B,eAAeqyB,IAClD,GAAI2gB,GAAoBlZ,aAAazH,IAAU/pB,IAE7CyvC,EAAWrwB,GAAiBuuB,GAAsBtrC,GAD7BqoC,GAAoBlZ,aAAazH,IAAU/pB,IACUuJ,EAAgBC,QAE1FimC,EAAWrwB,GAAiBuuB,GAAsBtrC,GAAU,KAAMkH,EAAgBC,QAGpFimC,EAAWrwB,GAAiBuuB,GAAsBtrC,GAAU,KAAMkH,EAAgBC,QAGpFimC,EAAWrwB,GAAiBuuB,GAAsBtrC,GAAU,KAAMkH,EAAgBC,EAEtF,CACF,CAEAkhC,GAAsB7+B,EACtB3C,GAAoBM,EACpBP,GAAyBM,CAC3B,CAAC,SAEciqC,KAAY,OAAAC,GAAArlD,MAAC,KAAD7D,UAAA,UAAAkpD,KA2B1B,OA3B0BA,IAAAplD,EAAAA,EAAAA,GAA3B,YACE,IAAMsd,EAAoBzV,GAAsB,qBAC1Cif,EAA2Bjf,GAAsB,oBACjDw9C,EAA0B3P,GAAU,gCAC1CqH,GAA4Bj2B,EAAyBe,QACrD+0B,GAAiC91B,EAAyBw+B,aAC1DnI,IAA+B,EAC/BD,GAAqC10C,KACrCuzC,GAAwBpgC,aAAa,aAAc,QACnDogC,GAAwB30C,UAAUqV,OAAO,MACzClW,SAASqlB,iBAAiBsxB,GAAoC3xB,IAC9D,IAAM/N,QX9wBD,SAA6BzU,EAAApJ,EAAAC,EAAAC,EAAAY,GAAA,OAAA8oC,GAAAxpC,MAAC,KAAD7D,UAAA,CW8wBRqpD,CAAejI,GAA2BC,GAAmC8H,EAAwBnhD,MAAOmhD,EAAwBlhD,OAAQ+4C,IACtK+D,GAAiBzjC,GAAa,EAAOF,GACrC,IAAIkoC,EAAa,EACbzI,KACFyI,QAAmBliC,MAErB05B,IAA+B,IAAI1hD,MAAOuB,UAExCogD,GADEF,GAC6BhgD,KAAKuF,IAAI06C,GAA+BH,GAA+Br/B,EAAY3Q,eAAiB+vC,GAAiC4I,GAErIxI,GAA+BJ,GAEhEE,GAAoC//C,KAAKuF,IAAIu6C,GAA+BI,GAA+BD,IAC3GG,IAA+B,EAC/BpB,GAAwBpgC,aAAa,aAAc,SApvBnDogC,GAAwBtwB,MAAMC,YAAY,OAA0C,GAAGoxB,QACvFf,GAAwB30C,UAAUkT,IAAI,KAqvBxC,GAAC8qC,GAAArlD,MAAA,KAAA7D,UAAA,CAEM,SAASupD,KACdN,KACG10B,KAAK,WACA2sB,GACFsI,WACE,WACED,IACF,EACA1oD,KAAKuF,IAAIu6C,GAA+BI,IAA+B,IAAI3hD,MAAOuB,YAGpFwgD,IAAkC,CAEtC,GAAE,MACK,SAAC98C,GAEF68C,IACF5uB,GAAc,QAAS,sBACvBk3B,WAAW,WACTD,IACF,EAn1BsC,MAq1BtCpI,IAAkC,CAEtC,EACJ,CAEO,SAASsI,GAAUtyC,EAAqCG,GAC7DwJ,GAAgB,SAChBpF,GAAc,QAASvE,GACvBiqC,GAA4BjqC,EAC5BkqC,GAAoC/pC,EACpC8oC,GAA4B,EAC5BG,GAA2B,CAAC,EAC5Bf,GAAW//B,aAAa,YAAa,QACrCygC,GAAmBwJ,WAAa,EAChCxJ,GAAmByJ,QAxerB,SAAuCxyC,EAAqCG,GAQ1E,IAPA,IAAM8J,EAAoBzV,GAAsB,qBAC1C27C,EAAa9N,GAAU,UAEvBgO,GADaF,EAAWt/C,MACVs/C,EAAWr/C,QACzB2hD,EAA8B/oD,KAAKC,MAAM0mD,EAAc,IAAM,EAE/DvgB,EAAgD,CAAC,EAC5ClgC,EAAI,EAAGA,EAFa,EAEaA,IAAK,CAC7C,IAAMy4B,EAAmB,KAAKz4B,IAC9BkgC,EAAazH,GAAY,GACzB,IAAK,IAAI/pB,EAAI,EAAGA,EAAIm0C,EAAqBn0C,IACvCwxB,EAAazH,GAAUx4B,KAAK,CAC1BtF,KAAM,GACNyrB,OAAQ,IACRvf,OAAQ,CAAEhM,KAAM,EAAGuS,KAAM,GAAIzT,MAAO,GACpCipC,MAAO,GACP0E,kBAAmB,GACnBxE,gBAAiB,GACjBkF,gBAAiB,GACjBb,SAAUz4B,EACV/G,SAAU,CACRo5B,UAAW,EACXF,SAAU,GAEZqJ,SAAS,EACT3iC,SAAU,EACVuhC,cAAe,CACbR,iBAAiB,EACjBC,iBAAiB,EACjBC,eAAe,GAEjBx3B,GAAI,GAGV,CACAgtC,GACE,CACE9d,aAAcA,EACd6C,cAjCyB,EAkCzBntB,aAAc,CACZktC,IAAKD,EACLE,IAAKF,GAEPv0C,UAAW,MACXm5B,eAAgB,CACdC,eAAgB,MAChBC,iBAAkB,OAEpBv3B,QAASA,EACTG,gBAAiBA,EACjB3G,eAAgB,IAElB,EACAyQ,EAEJ,CAibE2oC,CAA8B5yC,EAASG,GAClC4pC,KACHA,IAA8B,EACzBC,GAIH8H,MAHA9H,IAAkC,EAClCoI,OAKJtoC,IACF,CAyHO,SAASyiC,GAAmBxvB,EAAgB81B,GACjD,IAGsB7iD,EAHhBosB,EAAc9oB,EAAqBy1C,GAAoB,OAAyBhsB,KAChF+1B,EAAUx/C,EAAqB8oB,EAAa,OAC8DlsB,EAAAC,GAAjGqD,EAAwBs/C,EAAS,wCAC1B,IAAtB,IAAA5iD,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAwB,CAAZN,EAAAlD,MACRwb,aAAa,cAAe,QAChC,CAAC,OAAApb,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAED,OADA2C,EAAqBw/C,EAAS,aAAsCD,OAAavqC,aAAa,cAAe,QACrGuqC,GACN,KAAK,EACHv/C,EAAqB8oB,EAAa,OAA+B9T,aAAa,YAAa,QAC3FhV,EAAqB8oB,EAAa,OAA2C9T,aAAa,YAAa,SACvGhV,EAAqB8oB,EAAa,OAA4C9T,aAAa,YAAa,SACxGhV,EAAqB8oB,EAAa,OAA0C9T,aAAa,YAAa,SACtG,MACF,KAAK,EACHhV,EAAqB8oB,EAAa,OAA+B9T,aAAa,YAAa,SAC3FhV,EAAqB8oB,EAAa,OAA2C9T,aAAa,YAAa,QACvGhV,EAAqB8oB,EAAa,OAA4C9T,aAAa,YAAa,SACxGhV,EAAqB8oB,EAAa,OAA0C9T,aAAa,YAAa,SACtG,MACF,KAAK,EACHhV,EAAqB8oB,EAAa,OAA+B9T,aAAa,YAAa,SAC3FhV,EAAqB8oB,EAAa,OAA2C9T,aAAa,YAAa,SACvGhV,EAAqB8oB,EAAa,OAA4C9T,aAAa,YAAa,QACxGhV,EAAqB8oB,EAAa,OAA0C9T,aAAa,YAAa,SACtG,MACF,KAAK,EACHhV,EAAqB8oB,EAAa,OAA+B9T,aAAa,YAAa,SAC3FhV,EAAqB8oB,EAAa,OAA2C9T,aAAa,YAAa,SACvGhV,EAAqB8oB,EAAa,OAA4C9T,aAAa,YAAa,SACxGhV,EAAqB8oB,EAAa,OAA0C9T,aAAa,YAAa,QAK5G,CCljCO,SAASyqC,KACd,IACMC,EADc,IAAI9hD,IAAI+hD,SAASC,MACFzvB,aAAa9sB,IAAI,aACpD,GAAuB,OAAnBq8C,EAAyB,CAC3B,IAAMG,EAAkBlqD,OAAO+pD,GAC/B,GAAI,0BAA0B96C,KAAKi7C,GAAkB,CACnD,IAAMC,EAASD,EAAgBzjC,MAAM,UAGrC,OAFa9kB,SAASwoD,EAAO,KAG3B,KAAK,EACHtzC,GAAqBlV,SAASwoD,EAAO,GAAI,KAAKh2B,KAAK,SAACztB,IACnC,IAAXA,EACF2iD,GAAU3iD,EAAOiR,GAAIjR,EAAOyQ,KxDTnC,SAAgC1K,GAAA,OAAAiK,GAAAjT,MAAC,KAAD7D,UAAA,CwDWzBwqD,CAAkBD,EAAO,IAAIh2B,KAAK,SAAC2c,GAC7BA,EAAQjxC,OAAS,GACnBwpD,GAAUvY,EAAQ,GAAGn5B,GAAIm5B,EAAQ,GAAG35B,IAExC,EAEJ,GACA,MACF,KAAK,EACHkzC,GAAaF,EAAO,IAK1B,CACF,CACF,CAEO,SAASpR,GAAalqC,EAAcy7C,GACzC,IAAMxR,EAAO,IAAI7wC,IAAI,oCACrB,OAAQ4G,GACN,KAAK,EACHiqC,EAAKte,aAAa9rB,IAAI,YAAa,KAAK/M,SAAS2oD,EAAS3yC,IAAI8iB,SAAS,OAAO6vB,EAAShpD,QACvF,MACF,KAAK,EACHw3C,EAAKte,aAAa9rB,IAAI,YAAa,KAAK47C,EAASxyC,QAKrD,OAAOyyC,mBAAmBzR,EAAKre,WACjC,CftCA,IAAIslB,GAAsB,CAAC,EACvBxhC,IAA6B,EAC7BD,IAAkC,EAEhCksC,GAAuBzgD,EAAsB,OAC7C0gD,GAA6BpgD,EAAqBmgD,GAAsB,OACxEE,GAAgCrgD,EAAqBogD,GAA4B,OAEvF,SAASv3B,KACP,IAAM5oB,EAAUL,SAAS8T,cAAc,OACvCzT,EAAQQ,UAAUkT,IAAI,MAGtB,IAAMrE,EAAO1P,SAAS8T,cAAc,OACpCpE,EAAK7O,UAAUkT,IAAI,MACnBrE,EAAK8E,YAAYP,MACjB5T,EAAQmU,YAAY9E,GAGpB,IAAMrY,EAAO2I,SAAS8T,cAAc,OAIpC,OAHAzc,EAAKwJ,UAAUkT,IAAI,MACnB1T,EAAQmU,YAAYnd,GAEb,CACLgJ,QAASA,EACTqN,GAAI,GAER,CAEA,SAASgzC,GAA2BzpC,EAAwCtC,EAAyBC,GACnG,SAASimC,EAAW/lC,EAA0BrH,EAA2CqtC,GACvF,SAAS7lC,EAAWH,EAA0BrH,GAE5CyG,GADwB9T,EAAqB0U,EAAa,OACjCrH,EAASiC,KACpC,CAEA,SAASqsC,EAAWjnC,EAA0BrH,GACxBrN,EAAqB0U,EAAa,OAC1Cd,UAAYvG,EAASpW,IACnC,CAEA,SAASspD,EAAc7rC,EAA0BrH,GAC/CqH,EAAY+Q,QAAUpY,EAAS+zB,MACjC,CAEA,SAASrsB,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEImmC,SACF7lC,EAAWH,EAAarH,GACxBsuC,EAAWjnC,EAAarH,GACxBkzC,EAAc7rC,EAAarH,GAC3B0H,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,KAE9BmmC,EAAanhD,MAAQ8T,EAAS9T,MAChCsb,EAAWH,EAAarH,GACxBsuC,EAAWjnC,EAAarH,GACxBkzC,EAAc7rC,EAAarH,IAGzBmH,IAAcN,IAChBa,EAAgBL,EAAaF,GAG3BD,IAAmBN,IACrBgB,EAAqBP,EAAaH,GAGxC,CAEA,IAAM2sB,EAAUrqB,EAAYqqB,QACtBC,EAAkBtqB,EAAYsqB,gBAE9Bqf,EAAyBtgD,EAAwBmgD,GAA+B,OAAgC7qD,OACtH,GAAI2rC,IAAoBqf,EAAwB,CAC9C,IAAMlrC,EAAakrC,EAAyBrf,EAC5C,GAAI7rB,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMiW,EAAiB7C,KACvBtT,EAASnB,YAAYsX,EAAezrB,QACtC,CACAogD,GAA8BzqC,OAAOL,EACvC,MAEE,IADA,IAAMkrC,EAAyBvgD,EAAwBmgD,GAA+B,OAC7E5qC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDgrC,EADkBD,EAAyB,EAAI/qC,GACbK,QACpC,CAEJ,CAIA,IAFA,IAAM2qC,EAAyBvgD,EAAwBmgD,GAA+B,OAE7E/jD,EAAI,EAAGA,EAAI6kC,EAAiB7kC,IAAK,CACxC,IAAMoY,EAAc+rC,EAAuBnkD,GACrC+Q,EAAW6zB,EAAQ5kC,GACzB,GAAIo5C,GAAoBhzC,eAAe,WACrC,GAAIgzC,GAAoBxU,QAAQ5kC,GAE9Bm+C,EAAW/lC,EAAarH,EADHqoC,GAAoBxU,QAAQ5kC,SAGjDm+C,EAAW/lC,EAAarH,EAAU,WAGpCotC,EAAW/lC,EAAarH,EAAU,KAEtC,CAEAqoC,GAAsB7+B,EACtB3C,GAAoBM,EACpBP,GAAyBM,CAC3B,CA+B6C,SAAAmsC,KAK5C,OAL4CA,IAAArnD,EAAAA,EAAAA,GAA7C,UAA8CoU,GAC5C,IAAMkJ,EAAoBzV,GAAsB,qBAC1CqB,EAAYV,KACZgV,QD/ID,SAAuCzU,EAAApJ,GAAA,OAAAioC,GAAA7nC,MAAC,KAAD7D,UAAA,CC+IlBorD,CAAyBlzC,EAAMlL,GACzD+9C,GAA2BzpC,GAAa,EAAOF,EACjD,GAAC+pC,GAAAtnD,MAAA,KAAA7D,UAAA,CAEM,SAASqrD,GAAoBnzC,GAClC4I,GAAgB,mBAChB8pC,GAAqBnrC,aAAa,YAAa,QAtCjD,WASE,IARA,IAAM2B,EAAoBzV,GAAsB,qBAC1CggC,EAA6C,GAO1C5kC,EAAI,EAAGA,EADe,EACaA,IAC1C4kC,EAAQ3kC,KAAK,CACXtF,KAAM,GACNqY,KAAM,GACN/V,IAAK,UAAU+C,IACf8kC,OAAQ,WAAa,IAIzBkf,GACE,CACEpf,QAASA,EACTC,gBAb2B,EAc3B1zB,KAAM,KAER,EACAkJ,EAEJ,CAYEkqC,GAZD,SAE4Cz+C,GAAAs+C,GAAAtnD,MAAC,KAAD7D,UAAA,CAW3CurD,CAA+BrzC,EACjC,CAiCC,SAAA4zB,KAAA,OAAAA,IAAAhoC,EAAAA,EAAAA,GA1BM,UAAsCoU,GAC3C,IAAMlL,EAAYV,KACZ2G,QAAkBK,GAAYtG,EAAW,GAC/CmD,GAA4BnD,GAC5BmE,GAAqBnE,GACrB,IAAMohB,EAAkB,MAAMlW,IAC9B,GAAIjF,EAAS9F,eAAeihB,GAAkB,CAC5C,IAAM3V,EAAexF,EAASmb,GACxB8qB,EAAOC,GAAa,EAAG,CAC3BjhC,KAAMA,IAEJ5S,UAAU8zC,OACZ9zC,UACG8zC,MAAM,CACLC,MAAO5gC,EAAajR,EACpBuF,IAAKmsC,IAEN3kB,KAAK,WACJjC,GAAc,eAAgB,QAChC,GAAE,MACK,SAACzqB,GACNyqB,GAAc,SAAU,QAE1B,EAEN,CACF,IAACzuB,MAAA,KAAA7D,UAAA,CAcA,SAAAgsC,KAAA,OAAAA,IAAAloC,EAAAA,EAAAA,GAZM,UAA2CoU,GAChD,IAAMlL,EAAYV,KACZ2G,QAAkBK,GAAYtG,EAAW,GAC/CmD,GAA4BnD,GAC5BmE,GAAqBnE,GACrB,IAAMohB,EAAkB,MAAMlW,IAC1BjF,EAAS9F,eAAeihB,IAI1B0qB,GAHaK,GAAa,EAAG,CAC3BjhC,KAAMA,IAIZ,IAACrU,MAAA,KAAA7D,UAAA,C,y/BgB1MD,IAAMwrD,GAAgBrhD,EAAsB,OACtCshD,GAAsBhhD,EAAqB+gD,GAAe,OAC1DE,GAAsBjhD,EAAqBghD,GAAqB,OAChEE,GAA0BlhD,EAAqBihD,GAAqB,QACpEE,GAA6BnhD,EAAqBghD,GAAqB,OACvEI,GAAwBphD,EAAqB+gD,GAAe,OAC5DM,GAA2BrhD,EAAqBghD,GAAqB,OACrEM,GAA+BthD,EAAqBqhD,GAA0B,OAC9EE,GAAmCvhD,EAAqBghD,GAAqB,OAC7EQ,GAA8BxhD,EAAqBuhD,GAAkC,OACrFE,GAA6BzhD,EAAqBghD,GAAqB,WAEzEtL,GAAsB,CAAC,EACvBxhC,IAA6B,EAC7BD,IAAkC,EAElCytC,GAAuC,EACvCC,GAAsC,EACtCC,GAAwC,EACxCC,GAA2C,CAAC,EAC5CC,GAAqC,EAErCC,IAAmC,EAGnCC,GAA4C,KAC5CC,GAA2C,IAC3CC,GAA+C,KAC/CC,IAAwC,EACxCC,GAA0C,EAC1CC,GAA0C,EAC1CC,GAAgD,GAChDC,IAA2C,EAC3CC,IAA0C,EAC1CC,IAA8C,EAE9CC,GAA8B,GAkD3B,SAASC,GAAkBtjB,EAAuBxb,EAAgBizB,EAAsBC,GAC7FqK,GAAsBt8B,MAAMC,YAAY,OAAsCsa,EAAcjP,YAC5FoxB,GAA4B18B,MAAMC,YAAY,OAA4C+xB,EAAa1mB,YACvGkxB,GAA6Bx8B,MAAMC,YAAY,OAAwC,GAAGlB,EAAOuM,gBACjGkxB,GAA6Bx8B,MAAMC,YAAY,OAAkCgyB,EAAW3mB,WAC9F,CAOA,SAASxL,GAAmC9e,GAC1C,IAAMC,EAAcD,EACpB,GAAIy8C,GAAiC,CACnC,IAAMvL,EAAcjxC,EAAYC,OAAOnC,SAAW,EAClD49C,GAA2B38B,MAAMC,YAAY,OAAiDiyB,EAAY5mB,WAC5G,CACiC,QAA7BrqB,EAAYC,OAAOL,OACrB/F,SAASolB,oBAAoBjf,EAAYC,OAAOH,OAAQ+e,GAE5D,CAEA,SAASiE,KACP,IAAMtV,EAAa1R,KAGbinB,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAC1BmV,EAAYxb,GAAKiG,EACjBuV,EAAY9T,aAAa,YAAa,SACtC8T,EAAY9T,aAAa,aAAc,SACvC8T,EAAY9T,aAAa,iBAAkB,KAC3C8T,EAAY9T,aAAa,aAAc,KAGvC,IAAMyiC,EAAc73C,SAAS8T,cAAc,OAC3C+jC,EAAYh3C,UAAUkT,IAAI,MAG1B,IAAMivC,EAAchjD,SAAS8T,cAAc,OAC3CkvC,EAAYniD,UAAUkT,IAAI,MAC1B,IAAMkvC,EAAuBjjD,SAAS8T,cAAc,OACpDmvC,EAAqBpiD,UAAUkT,IAAI,MACnCkvC,EAAqB7tC,aAAa,OAAQ,MAC1C6tC,EAAqB7tC,aAAa,YAAa,SAC/C,IAAM8tC,EAA0BljD,SAAS8T,cAAc,OACvDovC,EAAwBriD,UAAUkT,IAAI,MACtCmvC,EAAwB9tC,aAAa,OAAQ,MAC7C8tC,EAAwB9tC,aAAa,YAAa,QAClD4tC,EAAYxuC,YAAYyuC,GACxBD,EAAYxuC,YAAY0uC,GAGxB,IAAMC,EAAwBnjD,SAAS8T,cAAc,OACrDqvC,EAAsBtiD,UAAUkT,IAAI,MAGpC,IAAMqvC,EAAmBpjD,SAAS8T,cAAc,OAChDsvC,EAAiBviD,UAAUkT,IAAI,MAG/B,IAAMyV,EAAiBxpB,SAAS8T,cAAc,OAC9C0V,EAAe3oB,UAAUkT,IAAI,MAG7B,IAAM4X,EAAgB3rB,SAAS8T,cAAc,OAC7C6X,EAAc9qB,UAAUkT,IAAI,MAC5B,IAAM2jC,EAAmB13C,SAAS8T,cAAc,OAChD4jC,EAAiB72C,UAAUkT,IAAI,MAC/B2jC,EAAiBtiC,aAAa,OAAQ,KACtCsiC,EAAiBtiC,aAAa,YAAa,SAC3C,IAAMuiC,EAAsB33C,SAAS8T,cAAc,OACnD6jC,EAAoB92C,UAAUkT,IAAI,MAClC4jC,EAAoBviC,aAAa,OAAQ,KACzCuiC,EAAoBviC,aAAa,YAAa,QAC9CuW,EAAcnX,YAAYkjC,GAC1B/rB,EAAcnX,YAAYmjC,GAG1B,IAAMG,EAAiB93C,SAAS8T,cAAc,OAC9CgkC,EAAej3C,UAAUkT,IAAI,MAC7B+jC,EAAetjC,YAAYZ,GAAe,wBAC1CkkC,EAAejyB,QAAU,YA0vBpB,SAA6Bma,GAClC,IAAM9W,EAAc9oB,EAAqBohD,GAAuB,eAA0ExhB,KACpIgY,EAAkB53C,EAAqB8oB,EAAa,OAEpDm6B,EAAen6B,EAAY/U,cAE3BikC,EAA2B73C,EAAiB2oB,EAAa,MACzDmvB,EAAsBD,EAAyBxiD,OAE/C0tD,EAAmBD,EAAa9K,wBAChCC,EAAkBtvB,EAAYqvB,wBAG9BK,EAAeJ,EAAgBG,IAAM2K,EAAiB3K,IAEtDE,EAAsD,SAA1C3vB,EAAYqG,aAAa,aACrC3a,EAAsD,SAA1CsU,EAAYqG,aAAa,aAE3C,GAAI3a,EAAW,CACb,IAAMkkC,EAAgBD,EAAY,IAAM,IAGxC3vB,EAAY9T,aAAa,aAAc,QAEvC8T,EAAYhE,MAAMC,YAAY,OAAwC,GAAGyzB,OAGzE,IAAK,IAAIl8C,EAAI,EAAGA,EAAI27C,EAAqB37C,IAAK,CAC5C,IAAM8tB,EAAkB4tB,EAAyB17C,GACjD8tB,EAAgBpV,aAAa,iBAAkB0jC,GAC/CtuB,EAAgBpV,aAAa,aAAc,IAC7C,CAEA8T,EAAY7D,iBACV,gBACA,WAEE,IAAK,IAAI3oB,EAAI,EAAGA,EAAI27C,EAAqB37C,IAAK,CAC5C,IAAM8tB,EAAkB4tB,EAAyB17C,GACjD8tB,EAAgBpV,aAAa,iBAAkB,KAC/CoV,EAAgBpV,aAAa,aAAc,IAC7C,CAEA8T,EAAY9T,aAAa,aAAc,QACzC,EACA,CAAEkQ,MAAM,IAGV4D,EAAY7D,iBACV,kBACA,WAEE,IAAK,IAAI3oB,EAAI,EAAGA,EAAI27C,EAAqB37C,IAAK,CACpB07C,EAAyB17C,GACjC0Y,aAAa,aAAc,IAC7C,CACF,EACA,CAAEkQ,MAAM,GAEZ,CAEIuzB,GACEjkC,EACFojC,EAAgB3yB,iBACd,gBACA,WACE2yB,EAAgB5iC,aAAa,YAAa,QAC5C,EACA,CAAEkQ,MAAM,IAGV0yB,EAAgB5iC,aAAa,YAAa,SAE5C8T,EAAY9T,aAAa,YAAa,WAEtC4iC,EAAgB5iC,aAAa,YAAa,QAC1C8T,EAAY9T,aAAa,YAAa,QAE1C,CAv0BImuC,CAAoB5vC,EACtB,EAGA,IAAMslC,EAA0Bj5C,SAAS8T,cAAc,OACvDmlC,EAAwBp4C,UAAUkT,IAAI,MAGtCyV,EAAehV,YAAYmX,GAC3BnC,EAAehV,YAAYsjC,GAC3BtuB,EAAehV,YAAYykC,GAG3BpB,EAAYrjC,YAAYwuC,GACxBnL,EAAYrjC,YAAY2uC,GACxBtL,EAAYrjC,YAAY4uC,GACxBvL,EAAYrjC,YAAYgV,GAGxB,IAAM0vB,EAAcl5C,SAAS8T,cAAc,OAC3ColC,EAAYr4C,UAAUkT,IAAI,MAC1BmlC,EAAY9jC,aAAa,YAAa,SAGtC,IAAM+jC,EAAiBn5C,SAAS8T,cAAc,OAC9CqlC,EAAet4C,UAAUkT,IAAI,MAG7B,IAAMyvC,EAAsBxjD,SAAS8T,cAAc,OACnD0vC,EAAoB3iD,UAAUkT,IAAI,MAClCyvC,EAAoBpuC,aAAa,cAAe,QAChDouC,EAAoBpuC,aAAa,OAAQ,OACzCouC,EAAoBpuC,aAAa,OAAQ,KACzC,IAAMquC,EAAoBzjD,SAAS8T,cAAc,OACjD2vC,EAAkB5iD,UAAUkT,IAAI,MAChC0vC,EAAkBjvC,YAAYZ,GAAe,mBAC7C4vC,EAAoBhvC,YAAYivC,GAChCD,EAAoBhvC,YAAYxU,SAASspB,eAAe,OACxDk6B,EAAoB39B,QAAU,WAC5B69B,GAAsB/vC,EAAY,EACpC,EAGA,IAAMgwC,EAA0B3jD,SAAS8T,cAAc,OACvD6vC,EAAwB9iD,UAAUkT,IAAI,MACtC4vC,EAAwBvuC,aAAa,cAAe,SACpDuuC,EAAwBvuC,aAAa,OAAQ,OAC7CuuC,EAAwBvuC,aAAa,OAAQ,KAC7C,IAAMwuC,EAAwB5jD,SAAS8T,cAAc,OACrD8vC,EAAsB/iD,UAAUkT,IAAI,MACpC6vC,EAAsBpvC,YAAYZ,GAAe,oBACjD+vC,EAAwBnvC,YAAYovC,GACpCD,EAAwBnvC,YAAYxU,SAASspB,eAAe,SAC5Dq6B,EAAwB99B,QAAU,WAChC69B,GAAsB/vC,EAAY,EACpC,EAGA,IAAMkwC,EAAoB7jD,SAAS8T,cAAc,OACjD+vC,EAAkBhjD,UAAUkT,IAAI,MAChC8vC,EAAkBzuC,aAAa,cAAe,SAC9CyuC,EAAkBzuC,aAAa,OAAQ,kBACvC,IAAM0uC,EAAwB9jD,SAAS8T,cAAc,OACrDgwC,EAAsBjjD,UAAUkT,IAAI,MACpC+vC,EAAsBtvC,YAAYZ,GAAe,WACjDiwC,EAAkBrvC,YAAYsvC,GAC9BD,EAAkBrvC,YAAYxU,SAASspB,eAAe,OAQtD,IAAMy6B,EAAsB/jD,SAAS8T,cAAc,OACnDiwC,EAAoBljD,UAAUkT,IAAI,MAClCgwC,EAAoB3uC,aAAa,cAAe,SAChD2uC,EAAoB3uC,aAAa,OAAQ,yBACzC2uC,EAAoB3uC,aAAa,UAAW,QAC5C,IAAM4uC,EAA0BhkD,SAAS8T,cAAc,OACvDkwC,EAAwBnjD,UAAUkT,IAAI,MACtCiwC,EAAwBxvC,YAAYZ,GAAe,kBACnDmwC,EAAoBvvC,YAAYwvC,GAChCD,EAAoBvvC,YAAYxU,SAASspB,eAAe,OAQxD6vB,EAAe3kC,YAAYgvC,GAC3BrK,EAAe3kC,YAAYmvC,GAC3BxK,EAAe3kC,YAAYqvC,GAC3B1K,EAAe3kC,YAAYuvC,GAG3B,IAAM9J,EAAej6C,SAAS8T,cAAc,OAC5CmmC,EAAap5C,UAAUkT,IAAI,MAC3BkmC,EAAa7kC,aAAa,YAAa,QAGvC,IAAM+kC,EAAyBn6C,SAAS8T,cAAc,OAatD,OAZAqmC,EAAuBt5C,UAAUkT,IAAI,MACrComC,EAAuB/kC,aAAa,YAAa,SAGjD8jC,EAAY1kC,YAAY2kC,GACxBD,EAAY1kC,YAAYylC,GACxBf,EAAY1kC,YAAY2lC,GAGxBjxB,EAAY1U,YAAYqjC,GACxB3uB,EAAY1U,YAAY0kC,GAEjB,CACL74C,QAAS6oB,EACTxb,GAAIiG,EAER,CAEA,SAAS0mC,KAEP,IAAM4J,EAAejkD,SAAS8T,cAAc,OAC5CmwC,EAAapjD,UAAUkT,IAAI,MAG3B,IAAMmwC,EAAiBlkD,SAAS8T,cAAc,OAC9CowC,EAAerjD,UAAUkT,IAAI,MAG7B,IAAMowC,EAAqBnkD,SAAS8T,cAAc,OAClDqwC,EAAmBtjD,UAAUkT,IAAI,MACjCmwC,EAAe1vC,YAAY2vC,GAG3B,IAAMd,EAAerjD,SAAS8T,cAAc,OAO5C,OANAuvC,EAAaxiD,UAAUkT,IAAI,MAG3BkwC,EAAazvC,YAAY0vC,GACzBD,EAAazvC,YAAY6uC,GAElB,CACLhjD,QAAS4jD,EACTv2C,GAAI,GAER,CAEA,SAAS+sC,KACP,IAAMp6C,EAAUL,SAAS8T,cAAc,OACvCzT,EAAQQ,UAAUkT,IAAI,MAEtB,IAAMqwC,EAAOpkD,SAAS8T,cAAc,QAGpC,OAFAzT,EAAQmU,YAAY4vC,GAEb,CACL/jD,QAASA,EACTqN,GAAI,GAER,CAEA,SAAS22C,KAEP,IAAMzQ,EAAkB5zC,SAAS8T,cAAc,OAC/C8/B,EAAgB/yC,UAAUkT,IAAI,MAG9B,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYP,MAGxB,IAAMQ,EAAezU,SAAS8T,cAAc,OAO5C,OANAW,EAAa5T,UAAUkT,IAAI,MAG3B6/B,EAAgBp/B,YAAYX,GAC5B+/B,EAAgBp/B,YAAYC,GAErB,CACLpU,QAASuzC,EACTlmC,GAAI,GAER,CA0FA,SAAS42C,GAAoBrtC,EAAiCtC,EAAyBC,GAA0B,IAAA+lC,EAAAC,EAC/G,SAASC,EAAW/lC,EAA0BrH,EAAkCqtC,GAC9E,SAASC,EAAajmC,EAA0BrH,EAAkCmH,GAChF,IAAM2vC,EAAkBzvC,EAAYyjC,wBAC9BI,EAAM4L,EAAgB5L,IACtB4C,EAAOgJ,EAAgBhJ,KACvBC,EAAS+I,EAAgB/I,OACzBC,EAAQ8I,EAAgB9I,MACxBC,EAAc1iB,OAAO2iB,WACrBC,EAAe5iB,OAAO6iB,YAEtB2I,EAAkBpkD,EAAqB0U,EAAa,OACpDqmC,EAAwB/6C,EAAqBokD,EAAiB,OAC9D9M,EAAmBt3C,EAAqB+6C,EAAuB,OAC/DxD,EAAsBv3C,EAAqB+6C,EAAuB,OAExEzD,EAAiBtiC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC3DknB,EAAiB1jC,UAAYvG,EAASlK,OAAOuG,KAEzC8K,GAAa4mC,EAAS,GAAK7C,EAAMiD,GAAgBH,EAAQ,GAAKF,EAAOG,GACvE/D,EAAoBtyB,iBAClB,eACA,WACEsyB,EAAoBviC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC9DmnB,EAAoB3jC,UAAYvG,EAASlK,OAAOuG,KAChD6tC,EAAoB92C,UAAUqV,OAAO,MACrCwhC,EAAiBtiC,aAAa,YAAa,QAC7C,EACA,CAAEkQ,MAAM,IAEVoyB,EAAiBtiC,aAAa,YAAa,QAC3CuiC,EAAoB92C,UAAUkT,IAAI,QAElC4jC,EAAoBviC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC9DmnB,EAAoB3jC,UAAYvG,EAASlK,OAAOuG,KAEpD,CAEA,SAAS26C,EAAW3vC,EAA0BrH,EAAkCmH,GAC9E,IAAM2vC,EAAkBzvC,EAAYyjC,wBAC9BI,EAAM4L,EAAgB5L,IACtB4C,EAAOgJ,EAAgBhJ,KACvBC,EAAS+I,EAAgB/I,OACzBC,EAAQ8I,EAAgB9I,MACxBC,EAAc1iB,OAAO2iB,WACrBC,EAAe5iB,OAAO6iB,YAEtB2I,EAAkBpkD,EAAqB0U,EAAa,OACpD4vC,EAAkBtkD,EAAqBokD,EAAiB,OACxD9M,EAAmBt3C,EAAqBskD,EAAiB,OACzD/M,EAAsBv3C,EAAqBskD,EAAiB,OAElEhN,EAAiBtiC,aAAa,OAAQ3H,EAASyxB,QAAQ3nC,KAAKi5B,YAC5DknB,EAAiB1jC,UAAYvG,EAASyxB,QAAQp1B,KAE1C8K,GAAa4mC,EAAS,GAAK7C,EAAMiD,GAAgBH,EAAQ,GAAKF,EAAOG,GACvE/D,EAAoBtyB,iBAClB,eACA,WACEsyB,EAAoBviC,aAAa,OAAQ3H,EAASyxB,QAAQ3nC,KAAKi5B,YAC/DmnB,EAAoB3jC,UAAYvG,EAASyxB,QAAQp1B,KACjD6tC,EAAoB92C,UAAUqV,OAAO,MACrCwhC,EAAiBtiC,aAAa,YAAa,QAC7C,EACA,CAAEkQ,MAAM,IAEVoyB,EAAiBtiC,aAAa,YAAa,QAC3CuiC,EAAoB92C,UAAUkT,IAAI,QAElC4jC,EAAoBviC,aAAa,OAAQ3H,EAASyxB,QAAQ3nC,KAAKi5B,YAC/DmnB,EAAoB3jC,UAAYvG,EAASyxB,QAAQp1B,KAErD,CAEA,SAAS66C,EAAqB7vC,EAA0BrH,GACtD,IAAM+2C,EAAkBpkD,EAAqB0U,EAAa,OACxB1U,EAAqBokD,EAAiB,OAC9CxwC,UAAYvG,EAAS0xB,eACjD,CAEA,SAASylB,EAAgB9vC,EAA0BrH,GACjD,IAAM+2C,EAAkBpkD,EAAqB0U,EAAa,OAC7B1U,EAAqBokD,EAAiB,OAC9CxwC,UAAYvG,EAAS+jB,UAC5C,CAEA,SAASwqB,EAAYlnC,EAA0BrH,GAC7C,IAAMo3C,EAAsBzkD,EAAqB0U,EAAa,OACrC1U,EAAqBykD,EAAqB,OAClD1+B,UAAsC,IAA1B1Y,EAAS6xB,MAAM1pC,OAAe,kCAAuE6X,EAAS6xB,MAAMxoC,IAAI,SAACmlD,GAAG,MAAK,kCAA2DA,EAAIhxC,gDAA6GyI,GAAY,0CAA8EuoC,EAAInxC,2DAA8HmxC,EAAIjxC,qCAAyEixC,EAAI14C,OAAOuG,gCAAkEmyC,EAAIr3C,wBAAwB,GAAE5N,KAAK,GACruB,CAEA,SAASmlD,EAAsBrnC,EAA0BrH,GACvD,IAAMo3C,EAAsBzkD,EAAqB0U,EAAa,OAC3B1U,EAAqBykD,EAAqB,OAClD1+B,UAAgD,IAApC1Y,EAAS+xB,gBAAgB5pC,OAAe,oCAA+E6X,EAAS+xB,gBAAgB1oC,IAAI,SAACslD,GAAc,MAAK,mDAAgL1oC,GAAY,6CAA0G0oC,EAAejvB,iBAAiB91B,8BAA2FF,EAAWilD,EAAe9kD,KAAKD,QAAQM,EAAmBykD,EAAejvB,iBAAiBR,OAAO/qB,YAAYjK,EAAmBykD,EAAejvB,iBAAiBR,OAAOC,mCAA+EwvB,EAAeC,mBAAmB,GAAErlD,KAAK,GACj5B,CAEA,SAAS6lD,EAAc/nC,EAA0BH,GAC3CA,GACFG,EAAYM,aAAa,YAAa,QAE1C,CAEA,SAASD,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEA,SAASmoC,EAAyBtyB,EAA8B/c,GAC9D,IAAMo3C,EAAsBzkD,EAAqBoqB,EAAiB,OAC5Ds6B,EAAyB1kD,EAAqBykD,EAAqB,OACnE5kB,EAA4B7/B,EAAqB0kD,EAAwB,8BAC/E7kB,EAA0Bpa,QAAU,WAClC4a,GAAiB,mBAAoB,CAACjW,EAAgB9c,GAAID,EAASuxB,OAAQvxB,EAAS2xB,SACtF,EACArd,GAAqB,OAAQtU,EAASuxB,QAAQ9U,KAAK,SAAC1sB,GAClDyiC,EAA0B7qB,aAAa,cAAe+qB,GAAgB3iC,GACxE,EACF,CAEA,SAASu/C,EAAiCvyB,EAA8B/c,GACtE,IAAMo3C,EAAsBzkD,EAAqBoqB,EAAiB,OAC5Ds6B,EAAyB1kD,EAAqBykD,EAAqB,OACnE/jB,EAAoC1gC,EAAqB0kD,EAAwB,qCACvFhkB,EAAkCjb,QAAU,WAC1Cqb,GAAyB,mBAAoB,CAAC1W,EAAgB9c,GAAID,EAASuxB,OAAQvxB,EAAS2xB,QAAS3xB,EAASlK,OAAOlN,MACvH,EACA,IAAM2mD,EAA6BlpB,GAA4BrmB,EAASuxB,QACxE8B,EAAkC1rB,aAAa,cAAe+qB,GAAgB6c,GAChF,CAEIlC,SACFC,EAAajmC,EAAarH,EAAUmH,GACpC6vC,EAAW3vC,EAAarH,EAAUmH,GAClC+vC,EAAqB7vC,EAAarH,GAClCm3C,EAAgB9vC,EAAarH,GAC7BuuC,EAAYlnC,EAAarH,GACzB0uC,EAAsBrnC,EAAarH,GACnCovC,EAAc/nC,EAAaH,GAC3BQ,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,GAClCmoC,EAAyBhoC,EAAarH,GACtCsvC,EAAiCjoC,EAAarH,KAE1CA,EAASlK,OAAOlN,OAASykD,EAAav3C,OAAOlN,OAC/C0kD,EAAajmC,EAAarH,EAAUmH,GACpCmoC,EAAiCjoC,EAAarH,IAE5CqtC,EAAa5b,QAAQv/B,SAAW8N,EAASyxB,QAAQv/B,QAAUm7C,EAAa5b,QAAQ3nC,OAASkW,EAASyxB,QAAQ3nC,MAC5GktD,EAAW3vC,EAAarH,EAAUmH,GAEhCkmC,EAAa9b,SAAWvxB,EAASuxB,SACnC2lB,EAAqB7vC,EAAarH,GAClCm3C,EAAgB9vC,EAAarH,GAC7BqvC,EAAyBhoC,EAAarH,IAEnC6H,GAAcwlC,EAAaxb,MAAO7xB,EAAS6xB,QAC9C0c,EAAYlnC,EAAarH,GAEtB6H,GAAcwlC,EAAatb,gBAAiB/xB,EAAS+xB,kBACxD2c,EAAsBrnC,EAAarH,GAEjCmH,IAAcN,IAChBa,EAAgBL,EAAaF,GAE3BD,IAAmBN,KACrBwoC,EAAc/nC,EAAaH,GAC3BU,EAAqBP,EAAaH,IAGxC,CAEA,SAASE,EAAeC,EAA0BC,EAAqCC,GACrF,SAASC,EAAWH,EAA0BC,GAE5Cb,GADwB9T,EAAqB0U,EAAa,OACjCC,EAAarF,KACxC,CAEA,SAASwF,EAAYJ,EAA0BC,GAC7C3U,EAAqB0U,EAAa,OAAwCqR,UAAYpR,EAAanb,KACrG,CAEA,SAASub,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEIK,SACFC,EAAWH,EAAaC,GACxBG,EAAYJ,EAAaC,GACzBI,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,KAE7BW,GAAcN,EAAiBtF,KAAMqF,EAAarF,OACrDuF,EAAWH,EAAaC,GAErBO,GAAcN,EAAiBpb,MAAOmb,EAAanb,QACtDsb,EAAYJ,EAAaC,GAEvBH,IAAcN,IAChBa,EAAgBL,EAAaF,GAE3BD,IAAmBN,IACrBgB,EAAqBP,EAAaH,GAGxC,CAEA,IAAMsoC,EAAa9N,GAAU,UACvB+N,EAAaD,EAAWt/C,MACxBw/C,EAAcF,EAAWr/C,OAEzB6hC,EAAgBxoB,EAAYwoB,cAC5BntB,EAAe2E,EAAY3E,aAC3BsqB,EAAe3lB,EAAY2lB,aAC3B3H,EAAShe,EAAYge,OAE3B+sB,GAAgCviB,EAChCyiB,GAA6BhF,EAI7B,IADA,IAAIE,EAAmB,EACd1gD,EAAI,EAAGA,EAAI+iC,EAAe/iC,IAAK,CACtC,IAAMy4B,EAAW,KAAKz4B,IAChBiB,EAAQo5B,GAAa9B,EAAOE,GAAU99B,KAAM,IAAK,OAAQ,8BA7nB1C,GA8nBrB4qD,GAA4B9sB,GAAY,CACtCx3B,MAAOA,EACPsmB,OAAQm5B,GAEVA,GAAoBz/C,CACtB,CAMA,GALAskD,GAA4B,KAAKxiB,KAAmB,CAClD9hC,MAAO,EACPsmB,OAAQm5B,IAGL+E,GAAyB,CAC5B,IACM7E,EAAoB2E,GADF,KAAKH,MAEvB79B,GAAqC,EAA5Bq5B,EAAkBr5B,OAA2C,GAA7Bi+B,GAA6D,GAA1B5E,EAAkB3/C,MAC9Fu5C,EAAeoG,EAAkB3/C,MA7oBlB,GA8oBrBolD,GAAkBf,GAA+B/9B,EAAQizB,EAAc4K,GACzE,EAEuB,QAAnBnH,EAAA7E,UAAmB,IAAA6E,OAAA,EAAnBA,EAAqB9sC,QAASoJ,EAAYpJ,OAC5C0zC,GAA2B17B,QAAU,WACnCm7B,GAAoB/pC,EAAYpJ,KAClC,IAGqB,QAAnB+sC,EAAA9E,UAAmB,IAAA8E,OAAA,EAAnBA,EAAqBrrC,gBAAiB0H,EAAY1H,eACpD+xC,GAAwBttC,UAAYiD,EAAY1H,cAG9C+E,KAAsBM,IACxBysC,GAAoBjsC,aAAa,YAAa+qB,GAAgBvrB,IAC9D6sC,GAAyBrsC,aAAa,YAAa+qB,GAAgBvrB,KAGjEP,KAA2BM,IAC7B0sC,GAAoBjsC,aAAa,kBAAmB+qB,GAAgBxrB,IACpE8sC,GAAyBrsC,aAAa,kBAAmB+qB,GAAgBxrB,IACzEgtC,GAAiCvsC,aAAa,kBAAmB+qB,GAAgBxrB,KAInF,IAAM4oC,EAAuBj9C,EAAwBkhD,GAAuB,OAAuB5rD,OACnG,GAAI6pC,IAAkB8d,EAAsB,CAC1C,IAAM7nC,EAAa6nC,EAAuB9d,EAC1C,GAAI/pB,EAAa,EAAG,CAGlB,IAFA,IAAMqvC,EAAiB,IAAInvC,iBACrBovC,EAAe,IAAIpvC,iBAChBC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAM6nC,EAAkBrD,KACxB0K,EAAevwC,YAAYkpC,EAAgBr9C,SAC3C,IAAMs9C,EAAgBlD,KACtBuK,EAAaxwC,YAAYmpC,EAAct9C,QACzC,CACAmhD,GAAsBxrC,OAAO+uC,GAC7BrD,GAA6B1rC,OAAOgvC,EACtC,MAGE,IAFA,IAAMC,EAAwB3kD,EAAwBkhD,GAAuB,OACvE0D,EAA2B5kD,EAAwBohD,GAA8B,OAC9E7rC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMioC,EAAaP,EAAuB,EAAI1nC,EAC9CovC,EAAsBnH,GAAY5nC,SAClCgvC,EAAyBpH,GAAY5nC,QACvC,CAEJ,CAGA,IADA,IAAM+uC,EAAwB3kD,EAAwBkhD,GAAuB,OACpE9kD,EAAI,EAAGA,EAAI+iC,EAAe/iC,IAAK,CACtC,IAAMy4B,EAAW,KAAKz4B,IAChByoD,EAA2BF,EAAsBvoD,GACjDyhD,EAAsB79C,EAAwB6kD,EAA0B,WAAsDvvD,OACpI,GAAI0c,EAAa6iB,KAAcgpB,EAAqB,CAClD,IAAMzoC,EAAayoC,EAAsB7rC,EAAa6iB,GACtD,GAAIzf,EAAa,EAEf,IADA,IAAM0vC,EAA4BhlD,EAAqB+kD,EAA0B,OACxEtvC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMiW,EAAiB7C,KACvBm8B,EAA0B5wC,YAAYsX,EAAezrB,QACvD,MAGA,IADA,IAAMglD,EAA4B/kD,EAAwB6kD,EAA0B,WAC3EtvC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDwvC,EADkBlH,EAAsB,EAAItoC,GACPK,QACvC,CAEJ,CAEA,IAAMovC,EAA+BhlD,EAAwBA,EAAwBkhD,GAAuB,OAAuB9kD,GAAI,eAAqG9G,OACtO2vD,EAAwBtwB,EAAOE,GAAU7lB,WAAW1Z,OAC1D,GAAI2vD,IAA0BD,EAA8B,CAC1D,IAAM5vC,EAAa4vC,EAA+BC,EAClD,GAAI7vC,EAAa,EAGf,IAFA,IAAM8vC,GAAkCplD,EAAqB+kD,EAA0B,OACjFM,GAAsCrlD,EAAqBolD,GAAiC,OACzF3vC,GAAI,EAAGC,GAAItf,KAAKwY,IAAI0G,GAAaG,GAAIC,GAAGD,KAAK,CAEpD,IAAME,GAAqBsuC,KAC3BoB,GAAoCjxC,YAAYuB,GAAmB1V,QACrE,MAKA,IAHA,IAAMmlD,GAAkCplD,EAAqB+kD,EAA0B,OAEjFlvC,GAAmB3V,EADmBF,EAAqBolD,GAAiC,OACZ,OAC7E3vC,GAAI,EAAGC,GAAItf,KAAKwY,IAAI0G,GAAaG,GAAIC,GAAGD,KAAK,CAEpDI,GADsBqvC,EAA+B,EAAIzvC,IACzBK,QAClC,CAEJ,CACF,CAIA,IAFA,IAAMwvC,GAAcplD,EAAwBohD,GAA8B,OACpEiE,GAAgBrlD,EAAwBkhD,GAAuB,OAC5D9kD,GAAI,EAAGA,GAAI+iC,EAAe/iC,KAAK,CACtC,IAAMy4B,GAAW,KAAKz4B,KAChBgiD,GAAiBgH,GAAYhpD,IACR0D,EAAqBs+C,GAAgB,QAC7C1qC,UAAYihB,EAAOE,IAAU99B,KAChDqnD,GAAex5B,MAAMC,YAAY,OAAiC,GAAG88B,GAA4B9sB,IAAUx3B,WAC3G+gD,GAAex5B,MAAMC,YAAY,OAAiCzoB,GAAE8zB,YAMpE,IALA,IAAMwtB,GAAmB2H,GAAcjpD,IACjCuZ,GAAmB3V,EAAwB09C,GAAkB,eAC7D4H,GAAetlD,EAAwB09C,GAAkB,WAEzDuH,GAAwBtwB,EAAOE,IAAU7lB,WAAW1Z,OACjDsqC,GAAI,EAAGA,GAAIqlB,GAAuBrlB,KAAK,CAC9C,IAAMnrB,GAAekgB,EAAOE,IAAU7lB,WAAW4wB,IAC3CprB,GAAcmB,GAAiBiqB,IACrC,GAAI4V,GAAoBhzC,eAAe,UACrC,GAAIgzC,GAAoB7gB,OAAOnyB,eAAeqyB,IAC5C,GAAI2gB,GAAoB7gB,OAAOE,IAAU7lB,WAAW4wB,IAElDrrB,EAAeC,GAAaC,GADH+gC,GAAoB7gB,OAAOE,IAAU7lB,WAAW4wB,UAGzErrB,EAAeC,GAAaC,GAAc,WAG5CF,EAAeC,GAAaC,GAAc,WAG5CF,EAAeC,GAAaC,GAAc,KAE9C,CAEA,IAAK,IAAI3J,GAAI,EAAGA,GAAIkH,EAAa6iB,IAAW/pB,KAAK,CAC/C,IAAM0J,GAAc8wC,GAAax6C,IAC3BqC,GAAWmvB,EAAazH,IAAU/pB,IACxC,GAAI0qC,GAAoBhzC,eAAe,gBACrC,GAAIgzC,GAAoBlZ,aAAa95B,eAAeqyB,IAClD,GAAI2gB,GAAoBlZ,aAAazH,IAAU/pB,IAE7CyvC,EAAW/lC,GAAarH,GADHqoC,GAAoBlZ,aAAazH,IAAU/pB,UAGhEyvC,EAAW/lC,GAAarH,GAAU,WAGpCotC,EAAW/lC,GAAarH,GAAU,WAGpCotC,EAAW/lC,GAAarH,GAAU,KAEtC,CACF,CAEAqoC,GAAsB7+B,EACtB3C,GAAoBM,EACpBP,GAAyBM,CAC3B,CAAC,SAEckxC,KAAe,OAAAC,GAAAtsD,MAAC,KAAD7D,UAAA,UAAAmwD,KA2B7B,OA3B6BA,IAAArsD,EAAAA,EAAAA,GAA9B,YACE,IAAMsd,EAAoBzV,GAAsB,qBAC1Cif,EAA2Bjf,GAAsB,oBACjDw9C,EAA0B3P,GAAU,mCAC1CoT,GAA+BhiC,EAAyBe,QACxD8gC,GAAoC7hC,EAAyBw+B,aAC7D4D,IAAkC,EAClCD,GAAwCzgD,KACxC4/C,GAA2BzsC,aAAa,aAAc,QACtDysC,GAA2BhhD,UAAUqV,OAAO,MAC5ClW,SAASqlB,iBAAiBq9B,GAAuC19B,IACjE,IAAM/N,QpBxvBD,SAAgCzU,EAAApJ,EAAAC,EAAAC,GAAA,OAAA+iC,GAAA7iC,MAAC,KAAD7D,UAAA,CoBwvBXowD,CAAkBjD,GAAqBhE,EAAwBnhD,MAAOmhD,EAAwBlhD,OAAQ8kD,IAChI4B,GAAoBrtC,GAAa,EAAOF,GACxC,IAAIkoC,EAAa,EACbsD,KACFtD,QAAmBliC,MAErBylC,IAAkC,IAAIztD,MAAOuB,UAE3CmsD,GADEF,GACgC/rD,KAAKuF,IAAIymD,GAAkCH,GAAkCprC,EAAY3Q,eAAiB87C,GAAoCnD,GAE9IuD,GAAkCJ,GAEtEE,GAAuC9rD,KAAKuF,IAAIsmD,GAAkCI,GAAkCD,IACpHG,IAAkC,EAClCd,GAA2BzsC,aAAa,aAAc,SAzwBtDysC,GAA2B38B,MAAMC,YAAY,OAA6C,GAAGm9B,QAC7FT,GAA2BhhD,UAAUkT,IAAI,KA0wB3C,GAAC+xC,GAAAtsD,MAAA,KAAA7D,UAAA,CAEM,SAASqwD,KACdH,KACG37B,KAAK,WACA04B,GACFzD,WACE,WACE6G,IACF,EACAxvD,KAAKuF,IAAIsmD,GAAkCI,IAAkC,IAAI1tD,MAAOuB,YAG1FusD,IAAqC,CAEzC,GAAE,MACK,SAAC7oD,GAEF4oD,IACF36B,GAAc,QAAS,sBACvBk3B,WAAW,WACT6G,IACF,EAv2ByC,MAy2BzCnD,IAAqC,CAEzC,EACJ,CAEO,SAASzC,GAAavyC,GAC3B4I,GAAgB,YAChBpF,GAAc,WAAYxD,GAC1Bi1C,GAAsBj1C,EACtBi0C,GAA+B,EAC/BG,GAA8B,CAAC,EAC/Bd,GAAc/rC,aAAa,YAAa,QACxCosC,GAAsBnC,WAAa,EACnCmC,GAAsBlC,QA1iBxB,SAA0CzxC,GAQxC,IAPA,IAAMkJ,EAAoBzV,GAAsB,qBAC1C27C,EAAa9N,GAAU,UAEvBgO,GADaF,EAAWt/C,MACVs/C,EAAWr/C,QACzB2hD,EAA0D,CAAEC,IAAKhpD,KAAKC,MAAM0mD,EAAc,IAAM,EAAGsC,IAAKjpD,KAAKC,MAAM0mD,EAAc,IAAM,GAEzIvgB,EAAmD,CAAC,EAC/ClgC,EAAI,EAAGA,EAFa,EAEaA,IAAK,CAC7C,IAAMy4B,EAAW,KAAKz4B,IACtBkgC,EAAazH,GAAY,GACzB,IAAK,IAAI/pB,EAAI,EAAGA,EAAIm0C,EAAoBpqB,GAAW/pB,IACjDwxB,EAAazH,GAAUx4B,KAAK,CAC1B60B,WAAY,GACZ2N,gBAAiB,GACjBC,QAAS,EACTJ,OAAQ,EACRz7B,OAAQ,CACNhM,KAAM,EACNuS,KAAM,GACNzT,MAAO,GAET6oC,QAAS,CACPv/B,OAAQ,EACRmK,KAAM,KACNvS,MAAO,GAET+nC,MAAO,GACPE,gBAAiB,IAGvB,CACA8kB,GACE,CACE1nB,aAAcA,EACd6C,cA7ByB,EA8BzBxK,OAAQ,CACNuqB,IAAK,CACHnoD,KAAM,MACNiY,WAAY,CACV,CACE3V,IAAK,IACL+V,KAAM,GACN9V,MAAO,IAET,CACED,IAAK,IACL+V,KAAM,GACN9V,MAAO,IAET,CACED,IAAK,IACL+V,KAAM,GACN9V,MAAO,MAIb6lD,IAAK,CACHpoD,KAAM,MACNiY,WAAY,CACV,CACE3V,IAAK,IACL+V,KAAM,GACN9V,MAAO,IAET,CACED,IAAK,IACL+V,KAAM,GACN9V,MAAO,IAET,CACED,IAAK,IACL+V,KAAM,GACN9V,MAAO,OAKf0Y,aAAcitC,EACdhwC,aAAc,MACd1B,KAAMA,EACNvH,eAAgB,IAElB,EACAyQ,EAEJ,CAqdEkvC,CAAiCp4C,GAC5B+0C,KACHA,IAAiC,EAC5BC,GAIHgD,MAHAhD,IAAqC,EACrCmD,OAKJpvC,IACF,CAyFO,SAAS8sC,GAAsB75B,EAAgB81B,GACpD,IAI8B7iD,EAJxBosB,EAAc9oB,EAAqBohD,GAAuB,eAA0E33B,KACpImuB,EAAkB53C,EAAqB8oB,EAAa,OACpDiwB,EAAiB/4C,EAAqB43C,EAAiB,OACqEh7C,EAAAC,GAA3GqD,EAAwB64C,EAAgB,wCACjC,IAA9B,IAAAn8C,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAgC,CAApBN,EAAAlD,MACRwb,aAAa,cAAe,QAChC,CAAC,OAAApb,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAED,OADA2C,EAAqB+4C,EAAgB,aAAyCwG,OAAavqC,aAAa,cAAe,QAC/GuqC,GACN,KAAK,EACHv/C,EAAqB8oB,EAAa,OAAkC9T,aAAa,YAAa,QAC9FhV,EAAqB8oB,EAAa,OAA8C9T,aAAa,YAAa,SAC1G,MACF,KAAK,EACHhV,EAAqB8oB,EAAa,OAAkC9T,aAAa,YAAa,SAC9FhV,EAAqB8oB,EAAa,OAA8C9T,aAAa,YAAa,QAKhH,C,y/BC3gCA,IAAI8wC,GAA6C,GAE3CC,GAAcrmD,EAAsB,OACpCsmD,GAAoBhmD,EAAqB+lD,GAAa,OACtDE,GAAoBjmD,EAAqB+lD,GAAa,OACtDG,GAAqBlmD,EAAqBgmD,GAAmB,qBAC7DG,GAA2BnmD,EAAqBgmD,GAAmB,cACnEI,GAAgCpmD,EAAqBgmD,GAAmB,OACxEK,GAAuBrmD,EAAqBimD,GAAmB,OAC/DK,GAAwBtmD,EAAqBimD,GAAmB,OAEhEM,GAA2BJ,GAAyBnvB,WAAW,MAE/DwvB,GAAyB5tB,OAAOuW,iBAEhC1xC,GAAkB,GAAK+oD,GACvBC,GAAsB,IAAMD,GAC5BE,GAA6B,GAAMF,GACnCG,GAAyC,EAAIH,GAC7CI,GAAqB,GAAKJ,GAE1BK,GAAmB,GAAKL,GAGxBM,GAAgE,CACpE,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,KAAM,KAAM,KAAM,IAAK,OAGtBC,GAAoBtuB,GAAoB,QACxCuuB,GAA+BvuB,GAAoB,QACnDwuB,GAAsBxuB,GAAoB,OAC1C0Z,GAAoB,EACpB+U,GAAiC,EACjCC,GAA4B,EAC5BC,IAAqB,EACrBC,GAAuB,EACvBxwB,GAAOkY,GAAU,mBACjBxxC,GAAQs5B,GAAKt5B,MAAQipD,GACrBhpD,GAASq5B,GAAKr5B,OAASgpD,GACvBc,IAAkC,EAClCC,IAAsB,EAWnB,SAASC,KACd,IAAMC,EAAeC,KACfC,EAAWF,EAAa59C,UAAU,EAAG49C,EAAajyD,OAAS,GACjE0wD,GAAmB1sD,MAAQmuD,EAC3BC,KACAC,IAAmB,GAAI,GACvBC,IACF,CAEO,SAASC,KACd7B,GAAmB1sD,MAAQ,GAC3BouD,KACAC,IAAmB,GAAI,GACvBC,IACF,CAEO,SAASE,GAAmBliD,GACjCA,EAAMmiD,iBACN/B,GAAmBhH,QACnB4I,IACF,CA6CO,SAASI,MA3ChB,WACE,IAAKX,GAAqB,CACxBA,IAAsB,EACtB,IAC8B7qD,EADxB6Y,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACtBiqD,IAAY,IAA9B,IAAAlqD,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAgC,KACRsO,EADVC,EAAA1O,GAAAH,EAAAlD,OACU,IAAtB,IAAA+R,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAwB,KAAboO,EAAIE,EAAA9R,MACP2uD,EAAmBvoD,SAAS8T,cAAc,UAChDy0C,EAAiB1nD,UAAUkT,IAAI,MAC/B,IAAMy0C,EAAYC,KAAiB,aAAe,YAClD,OAAQj9C,GACN,IAAK,KACH+8C,EAAiBljC,iBAAiBmjC,EAAWZ,IAC7CW,EAAiB/zC,YAAYZ,GAAe,cAC5C,MACF,IAAK,KACH20C,EAAiBljC,iBAAiBmjC,EAAWL,IAC7CI,EAAiB/zC,YAAYxU,SAASspB,eAAe9d,IACrD,MACF,IAAK,KACH+8C,EAAiBljC,iBAAiBmjC,EAAWJ,IAC7CG,EAAiB/zC,YAAYZ,GAAe,aAC5C,MACF,QAEE20C,EAAiBljC,iBACfmjC,EACC,SAAUE,GACT,OAAO,WA1DhB,IAA2B9uD,EAE1BmuD,EAF0BnuD,EA2DE8uD,EAzD5BX,EAAW,GADID,OACcluD,IACnC0sD,GAAmB1sD,MAAQmuD,EAC3BC,KACAC,IAAmB,GAAI,GACvBC,IAsDc,CACF,CAJC,CAIE18C,IAEL+8C,EAAiB/zC,YAAYxU,SAASspB,eAAe9d,IAIzDmK,EAASnB,YAAY+zC,EACvB,CAAC,OAAAvuD,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACH,CAAC,OAAAzD,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDipD,GAAsB1wC,OAAOL,EAC/B,CACF,CAGEgzC,GACAjC,GAAsBtxC,aAAa,YAAa,QAChDsyC,IAAyB,EACzBkB,KACAX,IAAmB,GAAI,EACzB,CAOO,SAASY,KACd,OAAOnxD,SAAS8uD,GAA8Bj3B,aAAa,QAC7D,CAEO,SAASu4B,KACd,OAAO/xD,OAAOuwD,GAAmB1sD,MACnC,CAEO,SAASquD,GAAkBa,EAAqBC,GACrD,IAAInvD,EAAQkuD,KACRkB,GAAQ,EACS,IAAjBpvD,EAAMhE,QACRgE,EApI2B,aAqI3BovD,GAAQ,EACRF,EAAc,EACdC,EAAY,IAES,IAAjBD,IAAqC,IAAfC,IAExBA,EAA0B,GAD1BD,EAAclvD,EAAMhE,SAKxBqhC,GAAOkY,GAAU,mBACjBxxC,GAAQs5B,GAAKt5B,MAAQipD,GACrBhpD,GAASq5B,GAAKr5B,OAASgpD,GACvBO,GAAYtuB,GAAoB,QAChCuuB,GAAuBvuB,GAAoB,QAC3CwuB,GAAcxuB,GAAoB,OAElC8tB,GAAyBtvB,KAAO,OAAiB4vB,kCACjDN,GAAyBsC,UAAY,SACrCtC,GAAyBjV,aAAe,SAExCa,GAAYoU,GAAyBrvB,YAAY19B,GAAO+D,MACxD2pD,GAAyBX,GAAyBrvB,YAAY19B,EAAMqQ,UAAU,EAAG6+C,IAAcnrD,MAC/F4pD,GAAoBZ,GAAyBrvB,YAAY19B,EAAMqQ,UAAU6+C,EAAaC,IAAYprD,MAClG8pD,GAAeuB,EAAQ,EAAIxyD,KAAKuF,IAAI,EAAGurD,IAEvCX,GAAyB5T,UAAU,EAAG,EAAGp1C,GAAOC,IAE5CkrD,IAAgBC,GAClBvB,IAAY,EACZb,GAAyBuC,YAAc,EACvCvC,GAAyBtuB,UAAY2wB,EAAQ5B,GAAuBD,GACpER,GAAyB3U,SAASp4C,EAAO24C,GAAY,GAAK/7C,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,IAAW4pD,IAAe7pD,GAAS,GAC5H25B,GAAgBovB,GAA0BnwD,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,KAAWD,GAASopD,IAAc,EAAGH,GAAaG,GAAYF,GAAoBO,MAE3JG,IAAY,EACZb,GAAyBuC,YAAc,IACvC3xB,GAAgBovB,GAA0BnwD,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,KAAWD,GAASopD,IAAc,EAAGO,GAAmBP,GAAYD,GAAgCM,IAC7KV,GAAyBuC,YAAc,EACvCvC,GAAyBtuB,UAAY2wB,EAAQ5B,GAAuBD,GACpER,GAAyB3U,SAASp4C,EAAO24C,GAAY,GAAK/7C,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,IAAW4pD,IAAe7pD,GAAS,GAC5H+oD,GAAyBuC,YAAc,IACvC3xB,GAAgBovB,GAA0BnwD,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,KAAWD,GAASopD,IAAc,EAAGO,GAAmBP,GAAYD,GAAgCM,IAEjL,CAEO,SAAS8B,KACdlyB,GAAOkY,GAAU,mBACjBxxC,GAAQs5B,GAAKt5B,MACbC,GAASq5B,GAAKr5B,OACd2oD,GAAyB5oD,MAAQA,GAAQipD,GACzCL,GAAyB3oD,OAASA,GAASgpD,GAC3CqB,IAAmB,GAAI,EACzB,CAEA,SAASW,KACP,IAAMnxB,EAAI2xB,YAAYrsD,MAChBy+B,EAAQ,EAAIhlC,KAAKqhB,IAAIrhB,KAAK4I,IAAK5I,KAAKyI,GAAKw4B,EAAK,KAAM,GACtD+vB,KACFb,GAAyBuC,YAAc1tB,EACvCmrB,GAAyB5T,UAAUv8C,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,IAAW,EAAG,EAAGgpD,GAAc,EAAGjpD,IACpG25B,GAAgBovB,GAA0BnwD,KAAKwF,IAAIyrD,GAAc9pD,GAAQE,KAAWD,GAASopD,IAAc,EAAGH,GAAaG,GAAYF,GAAoBO,KAEzJK,IACF1uB,OAAOqwB,sBAAsBT,GAEjC,CAEA,SAASU,KACP,IAAMC,EAA0BvpD,SAAS8T,cAAc,OACvDy1C,EAAwB1oD,UAAUkT,IAAI,MAEtC,IAAM2X,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAE1B,IAAMy1C,EAAcxpD,SAAS8T,cAAc,OAM3C,OALA01C,EAAY3oD,UAAUkT,IAAI,MAC1By1C,EAAYh1C,YAAYP,MAExBs1C,EAAwB/0C,YAAYg1C,GACpCD,EAAwB/0C,YAAYkX,GAC7B,CACLrrB,QAASkpD,EACT77C,GAAI,GAER,CAEO,SAASs6C,KACd,IAAMyB,EAAqC,CAAC,QAAS,cAAe,kBAEpE,SAAS5O,EAAWx6C,EAAsBqoD,EAA2B5N,GACnE,SAAS4O,EAAel+C,EAAoBnL,GAE1C6T,GADoC9T,EAAqBC,EAAS,OAC7BopD,EAAWj+C,EAAKA,KAAK5G,MAC5D,CAEA,SAASm3C,EAAWvwC,EAAoBnL,GAClBD,EAAqBC,EAAS,OACtC2T,UAAYxI,EAAKA,KAAKrO,CACpC,CAEA,SAASwsD,EAAmBn+C,EAAoBnL,GAC9C,OAAQmL,EAAKA,KAAK5G,MAChB,KAAK,EACHvE,EAAQwlB,QAAU,WAChBu5B,GAAU5zC,EAAKA,KAAKkC,GAAclC,EAAKA,KAAK0B,IAC9C,EACA,MACF,KAAK,EACH7M,EAAQwlB,QAAU,WAChBu6B,GAAa50C,EAAKA,KAAKqC,KACzB,EACA,MACF,KAAK,EACHxN,EAAQwlB,QAAU,WAChBrP,GAAQhL,EAAKA,KAAKkC,GACpB,EAKN,CAEIotC,GACE4N,EAAYl9C,KAAK5G,OAASk2C,EAAatvC,KAAK5G,MAC9C8kD,EAAehB,EAAaroD,GAE1BqoD,EAAYl9C,KAAKkC,KAAOotC,EAAatvC,KAAKkC,KAC5CquC,EAAW2M,EAAaroD,GACxBspD,EAAmBjB,EAAaroD,MAKlCqpD,EAAehB,EAAaroD,GAC5B07C,EAAW2M,EAAaroD,GACxBspD,EAAmBjB,EAAaroD,GAEpC,CAEA,IAAMupD,EAAcf,KACdhB,EAAeC,KACrB,IAAK77C,GAAuB47C,GAAe,CACzC,IAAMrhC,E1D/GH,SAAmB9Z,EAAe9H,EAA+BilD,GACtE,IAAKx8C,GACH,MAAO,GAGT,IAKmC3B,EAL7Bo+C,EAAiBp9C,EAAMyB,cACvBU,EAAgBjD,GAAYk+C,GAAgB,GAC5CC,EAAoBn+C,GAAYk+C,GAAgB,GAClDE,EAAgB,GAAGr+C,EAAA1O,GAED4R,GAAa,IAAnC,IAAAlD,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAqC,KAC7BzD,EAAM,KADI+R,EAAA9R,QAEZuT,GAAYrK,eAAenJ,IAC7BqwD,EAAcrtD,KAAKwQ,GAAYxT,GAEnC,CAAC,OAAAK,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CAEDusD,EAAcx2C,KAAK,SAAUrU,EAAGsU,GAC9B,OAAOtU,EAAEvJ,OAAS6d,EAAE7d,MACtB,GAEA,IAAMq0D,EAAuBD,EAAcp0D,OAAS,EAChDs0D,EAAe,GAMnB,GAJ6B,IAAzBD,IACFC,EAAeF,EAAc,IAG3BC,EAAuB,EACzB,IAAK,IAAIvtD,EAAI,EAAGA,EAAIutD,EAAsBvtD,IAAK,CAC7C,IAAMytD,EAAeH,EAActtD,GAGjCwtD,EAAe7+C,GADP,IAAN3O,EAC6BytD,EAEAD,EAJfF,EAActtD,EAAI,GAMtC,CAGF,IAAID,EAA8B,GAC9B88B,EAAmB,EAEjB6wB,EAAgB,IAAIpjC,IAC1B,IAAc,IAAVpiB,GAAwB,IAATA,EAAY,CAE7B,IAC+BuN,EADzBk4C,EAAej9C,GAAW8P,OAAO,SAAC1R,GAAI,OAAKA,EAAKrO,IAAM2sD,GAAgC,IAAdt+C,EAAK5G,IAAU,GAAE2N,EAAAtV,GAC5EotD,GAAY,IAA/B,IAAA93C,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAiC,KAAtBoO,EAAI2G,EAAAvY,MAOb,GANA6C,EAAOE,KAAK,CACV6O,KAAMA,EACNuD,MAAOnJ,MAETwkD,EAAcr2C,IAAIvI,EAAKkC,KACvB6rB,GAAY,IACIswB,EACd,KAEJ,CAAC,OAAA7vD,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACH,CAEA,GAAI87B,EAAWswB,EAAO,KACQjuC,EADRC,EAAA5e,GACJitD,GAAY,IAA5B,IAAAruC,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAA8B,KAAnBgO,EAACwQ,EAAAhiB,MACN6T,EAAWL,GAAWhC,GAG1B,KAAc,IAAVxG,GAAeA,IAAS6I,EAAS7I,QAKjCwlD,EAAcE,IAAI78C,EAASC,IAA/B,CAIA,IAAMqB,EAAQH,GAA2Bm7C,EAAmBn+C,GAAY6B,EAAStQ,GAAG,IACpF,KAAIo8B,EAAWswB,GAMb,MALAptD,EAAOE,KAAK,CACV6O,KAAMiC,EACNsB,MAAOA,IAKXwqB,GAAY,CAXZ,CAYF,CAAC,OAAAv/B,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACH,CAMA,OAJAhB,EAAO+W,KAAK,SAAUrU,EAAGsU,GACvB,OAAOA,EAAE1E,MAAQ5P,EAAE4P,KACrB,GAEOtS,CACT,C0DmB0B8tD,CAAU1C,EAAc+B,EAAa,IACrDY,EAAqBhkC,EAAc5wB,OACnCuoD,EAAsB79C,EAAwBmmD,GAAsB,OAA6B7wD,OACvG,GAAI40D,IAAuBrM,EAAqB,CAC9C,IAAMzoC,EAAayoC,EAAsBqM,EACzC,GAAI90C,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMsrB,EAAamoB,KACnB3zC,EAASnB,YAAY2sB,EAAW9gC,QAClC,CACAomD,GAAqBjyC,YAAYmB,EACnC,MAEE,IADA,IAAM80C,EAAwBnqD,EAAwBmmD,GAAsB,OACnE5wC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpD40C,EADkBtM,EAAsB,EAAItoC,GACXK,QACnC,CAEJ,CAGA,IADA,IAAMw0C,EAAuBpqD,EAAwBmmD,GAAsB,OAClE/pD,EAAI,EAAGA,EAAI8tD,EAAoB9tD,IAAK,CAC3C,IAAMo+C,EAAeoL,GAAsBxpD,GACrCgsD,EAAcliC,EAAc9pB,GAC5B8tB,EAAkBkgC,EAAqBhuD,GAE3Cm+C,EAAWrwB,EAAiBk+B,EAD1B5N,GAGuC,KAE7C,CACAoL,GAAwB1/B,CAC1B,CACF,CAgBO,SAASmkC,KACV/lC,IACFnO,GAAgB,UAChB0vC,GAAY/wC,aAAa,YAAa,QACtCkzC,K1DxRG,WAA+Bh7C,GAAA9T,MAAC,KAAD7D,UAAA,C0DyRlCi1D,IAEA3iC,GAAc,uBAAwB,UAE1C,CAEO,SAAS4iC,KACd3iC,GAAkB,UA9NlBw+B,GAAsBtxC,aAAa,YAAa,SAChDsyC,IAAyB,EA+NzBvB,GAAY/wC,aAAa,YAAa,QACxC,CC9TC,SAAA01C,KAAA,OAAAA,IAAArxD,EAAAA,EAAAA,GAbM,YACL,IAAM2mB,QAA2Bd,KAC3ByrC,ECwkBD,WACL,IAAItuD,EAAmC,GACvC,IAAK,IAAM9C,KAAOqxD,GAChB,GAAIC,GAAYx/C,QAAQ9R,IAAQ,GAC1BqxD,GAASloD,eAAenJ,IACC,WAAvBqxD,GAASrxD,GAAKiL,KAAmB,CACnC,IAAM4G,EAA0B,CAC9B7R,IAAKA,EACLuxD,OAAQF,GAASrxD,GAAKuxD,QAExBzuD,EAAOE,KAAK6O,EACd,CAIN,OAAO/O,CACT,CDxlBmB0uD,GACXn7B,QAA0B5C,KAC1Bg+B,QAAoBp6C,KACtBvU,EAA+B,CAAC,EAOpC,OANAA,EAAOpG,MAAO,IAAItB,MAAOoc,cACzB1U,EAAO4uD,QAAU,EACjB5uD,EAAO+iB,QAAUY,EACjB3jB,EAAOsuD,SAAWA,EAClBtuD,EAAO6uD,mBAAqBt7B,EAC5BvzB,EAAO8uD,aAAeH,EACf3vD,KAAKQ,UAAUQ,EACxB,IAACjD,MAAA,KAAA7D,UAAA,C,y/BE3CM,SAAe61D,GAAahpD,GAAA,OAAAipD,GAAAjyD,MAAC,KAAD7D,UAAA,CAuBlC,SAAA81D,KAAA,OAAAA,IAAAhyD,EAAAA,EAAAA,GAvBM,UAA6BoC,GAAgD,IAC9CiB,EAD8CE,EAAAC,GAClDpB,GAAI,IAApC,IAAAmB,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAsC,KAA3BsuD,EAAiB5uD,EAAAlD,MACpB+lB,EAAS+rC,EACXC,GAAS,EACTC,GAAW,EACT/tC,EAAoB,KAAK8B,EAAOjS,KAOtC,UANqCzT,EAAU,GAAI4jB,IAEjD8tC,QAAertC,GAAaqB,EAAOjS,GAAIiS,EAAOtoB,KAAMsoB,EAAOjQ,MAE3Dk8C,QAAiB5tC,GAAa2B,EAAOtoB,KAAMsoB,EAAOjQ,MAEhDi8C,EAAQ,KACqCjgD,EADrCC,EAAA1O,GACYyuD,EAAkB5rC,SAAO,IAA/C,IAAAnU,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAiD,KAAtC0iB,EAAOpU,EAAA9R,YACV8nB,GAAagqC,EAAkBh+C,GAAIoS,EAC3C,CAAC,OAAA9lB,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACH,CACA,GAAImuD,EAAU,KACmCz5C,EADnCI,EAAAtV,GACUyuD,EAAkB5rC,SAAO,IAA/C,IAAAvN,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAiD,KAAtC0iB,EAAO3N,EAAAvY,YACV8nB,GAAakqC,EAAU9rC,EAC/B,CAAC,OAAA9lB,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACH,CACF,CAAC,OAAAzD,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAEM,SAAek2D,GAAczyD,GAAA,OAAA0yD,GAAAtyD,MAAC,KAAD7D,UAAA,CAUnC,SAAAm2D,KAAA,OAAAA,IAAAryD,EAAAA,EAAAA,GAVM,UAA8BoC,GAAkD,IACjD+f,EADiDC,EAAA5e,GACrDpB,GAAI,IAApC,IAAAggB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAsC,KAA3B2uD,EAAiBnwC,EAAAhiB,MACpBoyD,EAAkBC,GAAWF,EAAkBpyD,KACjDqyD,GAC2B,WAAzBA,EAAgBpnD,aACZsnD,GAAoBH,EAAkBpyD,IAAKoyD,EAAkBb,QAGzE,CAAC,OAAAlxD,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACD,OAAO,CACT,IAACjE,MAAA,KAAA7D,UAAA,CAEM,SAAew2D,GAAuB9yD,GAAA,OAAA+yD,GAAA5yD,MAAC,KAAD7D,UAAA,CAU5C,SAAAy2D,KAAA,OAAAA,IAAA3yD,EAAAA,EAAAA,GAVM,UAAuCoC,GAA+C,IACxDoS,EADwDC,EAAAjR,GAC5DpB,GAAI,IAAnC,IAAAqS,EAAAhR,MAAA+Q,EAAAC,EAAA/Q,KAAAC,MAAqC,KAA1BivD,EAAgBp+C,EAAArU,aACcizB,GAAoBw/B,EAAiB3+C,WAEpEuf,GAAuBo/B,SAEvBngC,GAAuBmgC,EAAiBh1D,KAAMg1D,EAAiB1/B,OAAO/qB,MAAMhN,MAAOy3D,EAAiB1/B,OAAO/qB,MAAM/M,QAASw3D,EAAiB1/B,OAAOC,IAAIh4B,MAAOy3D,EAAiB1/B,OAAOC,IAAI/3B,QAASw3D,EAAiB7/B,KAE7N,CAAC,OAAAxyB,GAAAkU,EAAA1Q,EAAAxD,EAAA,SAAAkU,EAAAzQ,GAAA,CACD,OAAO,CACT,IAACjE,MAAA,KAAA7D,UAAA,CA4BA,SAAA22D,KAAA,OAAAA,IAAA7yD,EAAAA,EAAAA,GA1BM,UAAiCoC,GAAyC,IAClDwS,EADkDC,EAAArR,GACtDpB,GAAI,IAA7B,IAAAyS,EAAApR,MAAAmR,EAAAC,EAAAnR,KAAAC,MAA+B,KAApBmvD,EAAUl+C,EAAAzU,MACnB,OAAQ2yD,EAAW3nD,MACjB,IAAK,eACmCmN,GAAc,QAASw6C,EAAW7+C,aAEhE2D,GAAck7C,EAAW3nD,KAAM2nD,EAAW7+C,KAElD,MACF,IAAK,kBACsCqE,GAAc,WAAYw6C,EAAW1+C,eAEtEwD,GAAck7C,EAAW3nD,KAAM2nD,EAAW1+C,OAElD,MACF,IAAK,aACiCkE,GAAc,MAAOw6C,EAAW7+C,aAE5D2D,GAAck7C,EAAW3nD,KAAM2nD,EAAW7+C,KAMxD,CAAC,OAAA1T,GAAAsU,EAAA9Q,EAAAxD,EAAA,SAAAsU,EAAA7Q,GAAA,CACD,OAAO,CACT,IAACjE,MAAA,KAAA7D,UAAA,CA+BA,SAAA62D,KAAA,OAAAA,IAAA/yD,EAAAA,EAAAA,GA7BM,UAA0BoC,GAC/B,IAAM4wD,EAA2BhxD,KAAKC,MAAMG,GAC5C,OAAQ4wD,EAAWpB,SACjB,KAAK,EAEH,aADMG,GAAciB,EAAWjtC,UACxB,EAET,KAAK,EAGH,aAFMgsC,GAAciB,EAAWjtC,eACzBqsC,GAAeY,EAAW1B,WACzB,EAET,KAAK,EAIH,aAHMS,GAAciB,EAAWjtC,eACzBqsC,GAAeY,EAAW1B,gBAC1BoB,GAAwBM,EAAWnB,qBAClC,EAET,KAAK,EAKH,aAJME,GAAciB,EAAWjtC,eACzBqsC,GAAeY,EAAW1B,gBAC1BoB,GAAwBM,EAAWnB,0BAjDxC,SAAgChyD,GAAA,OAAAgzD,GAAA9yD,MAAC,KAAD7D,UAAA,CAkD3B+2D,CAAkBD,EAAWlB,eAC5B,EAET,QACE,OAAO,EAGb,GAACiB,GAAAhzD,MAAA,KAAA7D,UAAA,CC/GD,SAASg3D,GAAyBj/C,GAA4C,IAAhCk/C,EAAgBj3D,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAEtD46B,EAAe,IAAIs8B,gBAAgB7zB,OAAO+mB,SAAS+M,QAEzDv8B,EAAa9rB,IAAI,IAAKiJ,GAEtB,IAAMq/C,EAAS/zB,OAAO+mB,SAASiN,SAAW,IAAMz8B,EAAaC,WACzDo8B,EAEF5zB,OAAO+mB,SAAS96C,QAAQ8nD,GAExBE,QAAQC,aAAa,KAAM,GAAIH,EAEnC,CAU4B,SAAAI,KAa3B,OAb2BA,IAAA1zD,EAAAA,EAAAA,GAA5B,YACE,IACE,IAAM2J,QAAiBC,MAAM,qBAAoB,IAAItO,MAAOuB,YAAa,CACvEgS,MAAO,aAET,IAAKlF,EAASE,GACZ,MAAM,IAAIhB,MAAM,+BAElB,OAAOc,EAAS/F,MAClB,CAAE,MAAO20B,GAEP,OAAO,CACT,CACF,IAACx4B,MAAA,KAAA7D,UAAA,CAEM,SAASy3D,KACd,OAAOttD,EAAsB,kCAAkCyvB,aAAa,UAC9E,CAMO,SAAS89B,KACd,OAAOvtD,EAAsB,yCAAyCyvB,aAAa,UACrF,CAEO,SAAS+9B,KAEd,MAAO,yCATAxtD,EAAsB,uCAAuCyvB,aAAa,YAUnF,CAEO,SAASg+B,KACd,OAAOztD,EAAsB,wCAAwCyvB,aAAa,UACpF,CAqBC,SAAAi+B,KAAA,OAAAA,IAAA/zD,EAAAA,EAAAA,GAjBM,YACL,IAAMg0D,QAjDP,WAU2B,OAAAN,GAAA3zD,MAAC,KAAD7D,UAAA,CAuCD+3D,GACzB,MAA0B,kBAAfD,GACU,IAAfA,EACK,aAEA,eAGLL,OAAyBK,EAAW5/C,MACtC8+C,GAAyBc,EAAW5/C,MAAM,GACnC,eAEP8+C,GAAyBc,EAAW5/C,MAAM,GACnC,KAGb,GAAC2/C,GAAAh0D,MAAA,KAAA7D,UAAA,C,y/BCrED,IAAMg4D,GAAgB7tD,EAAsB,OACtC8tD,GAAsBxtD,EAAqButD,GAAe,OAC1DE,GAAkBztD,EAAqBwtD,GAAqB,OAElE,SAAS3kC,GAAsBzd,GAC7B,IAAMsiD,EAAiB9tD,SAAS8T,cAAc,OAC9Cg6C,EAAejtD,UAAUkT,IAAI,MAC7B+5C,EAAe14C,aAAa,OAAQ5J,EAAK5G,MAGzC,IAAMiP,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1B,IAAMgsB,EAAkB//B,SAAS8T,cAAc,QAC/CisB,EAAgBvrB,YAAYZ,GAAepI,EAAKkE,OAChDmE,EAAYW,YAAYurB,GAGxB,IAAMrU,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAC1B2X,EAAYlX,YAAYxU,SAASspB,eAAe9d,EAAKnU,OAGrD,IAAMs0B,EAAgB3rB,SAAS8T,cAAc,OAC7C6X,EAAc9qB,UAAUkT,IAAI,MAC5B4X,EAAcnX,YAAYxU,SAASspB,eAAe9d,EAAKjI,SAGvD,IAAMqoB,EAAe5rB,SAAS8T,cAAc,OAC5C8X,EAAa/qB,UAAUkT,IAAI,MAC3B,IAAMg6C,EAAmB/tD,SAAS8T,cAAc,QAmBhD,OAlBAi6C,EAAiBv5C,YAAYZ,GAAe,sBAC5CgY,EAAapX,YAAYu5C,GAGE,mBAAhBviD,EAAKg2B,OACdssB,EAAejoC,QAAU,WACvBra,EAAKg2B,QACP,EACgC,iBAAhBh2B,EAAKg2B,QACrBssB,EAAe14C,aAAa,UAAW5J,EAAKg2B,QAI9CssB,EAAet5C,YAAYX,GAC3Bi6C,EAAet5C,YAAYkX,GAC3BoiC,EAAet5C,YAAYmX,GAC3BmiC,EAAet5C,YAAYoX,GAEpB,CACLvrB,QAASytD,EACTpgD,GAAI,GAER,CAEsC,SAAAsgD,KASrC,OATqCA,IAAAv0D,EAAAA,EAAAA,GAAtC,YACE,IAAM+T,QHigBD,WAA2B,OAAAygD,GAAAz0D,MAAC,KAAD7D,UAAA,CGjgBbu4D,GACnBL,GAAgB1nC,UAAY,GAC5B,IACuBrpB,EADjB6Y,EAAW,IAAIC,iBAAmB5Y,EAAAC,GACrBuQ,GAAI,IAAvB,IAAAxQ,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAyB,KACjB0X,EAAcmU,GADPnsB,EAAAlD,OAEb+b,EAASnB,YAAYM,EAAYzU,QACnC,CAAC,OAAArG,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACDowD,GAAgB73C,OAAOL,EACzB,GAACq4C,GAAAx0D,MAAA,KAAA7D,UAAA,CAEM,SAASw4D,KACd13C,GAAgB,YAChBk3C,GAAcv4C,aAAa,YAAa,QAfzC,WAEqC44C,GAAAx0D,MAAC,KAAD7D,UAAA,CAcpCy4D,EACF,CAEO,SAASC,KACdnmC,GAAkB,YAClBylC,GAAcv4C,aAAa,YAAa,QAC1C,CAMC,SAAAk5C,KAAA,OAAAA,IAAA70D,EAAAA,EAAAA,GAJM,YACLwuB,GAAc,gBAAiB,SAC/B,IAAMnI,QJpDD,WAAyB,OAAAgrC,GAAAtxD,MAAC,KAAD7D,UAAA,CIoDR44D,ICDjB,SAAqBzuC,GAA4E,IAA3Dlb,EAAYjP,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,mBAAoB64D,EAAgB74D,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACxF6O,EAAO,IAAIC,KAAK,CAACmb,GAAU,CAAElb,KAAMA,IACnC6pD,EAAU,IAAIC,KAAK,CAAChqD,GAAO8pD,EAAU,CAAE5pD,KAAMA,IAC/C3J,UAAU0zD,UAAY1zD,UAAU0zD,SAAS,CAAEC,MAAO,CAACH,KACrDxzD,UACG8zC,MAAM,CACL6f,MAAO,CAACH,KACR,MACK,SAACz8B,GACN/J,GAAc,WAAY,OAAQ,CAChCne,KAAM,KACN03B,OAAQ,WACNqtB,GAAiBnqD,EAAM8pD,EACzB,GAEJ,GAEFK,GAAiBnqD,EAAM8pD,EAE3B,CDjBEM,CAAYhvC,EAAS,mBAAoB,kBAC3C,GAACwuC,GAAA90D,MAAA,KAAA7D,UAAA,CE/ED,IAAMo5D,GAAsBjvD,EAAsB,OAC5CkvD,GAAsBlvD,EAAsB,OAG5CmvD,IAA6B,IAAIl6D,MAAOuB,UAI1C44D,GAA2B,CAAC,QAEzB,SAASz4C,GAAgB04C,GAC9B,IAAMC,EAAoBF,GAAYt5D,OACrBs5D,GAAYE,EAAoB,KAChCD,GACfD,GAAYvyD,KAAKwyD,EAErB,CAEO,SAASjnC,GAAkBinC,GAChC,GAAID,GAAYzjD,QAAQ0jD,IAAS,EAAG,CAClC,IAAMC,EAAoBF,GAAYt5D,OAClCs5D,GAAYE,EAAoB,KAAOD,GACzCD,GAAYG,KAEhB,CACF,CAEO,SAASz4C,KACd,IAAMw4C,EAAoBF,GAAYt5D,OACtC,GAAIw5D,EAAoB,EAEtB,OADqBF,GAAYE,EAAoB,IAEnD,IAAK,OAQL,IAAK,qBAKL,IAAK,WAEL,IAAK,kBAEL,IAAK,QAEL,IAAK,eAEL,IAAK,eAQL,IAAK,kBAEL,IAAK,YAKL,IAAK,0BAWL,IAAK,uBAEL,IAAK,8BAEL,IAAK,SAEL,QACE,MApDF,IAAK,gBACH3mC,KACA,MACF,IAAK,eACH8B,KACA,MAGF,IAAK,gBACH0B,KACA,MAWF,IAAK,SACH4+B,KACA,MACF,IAAK,WACHwD,KACA,MAKF,IAAK,0BACHl+B,KACA,MAGF,IAAK,yBACHX,KACA,MACF,IAAK,MACH3Y,KACA,MACF,IAAK,uBACH0f,KAYR,CAEO,SAASzf,KACd,IAAMs4C,EAAoBF,GAAYt5D,OACtC,GAAIw5D,EAAoB,EAAG,CACzB,IAAME,EAAeJ,GAAYE,EAAoB,GAErD,OADAF,GAAYG,MACJC,GACN,IAAK,OAQL,IAAK,qBAKL,IAAK,WAEL,IAAK,kBAEL,IAAK,QAEL,IAAK,eAEL,IAAK,eAQL,IAAK,kBAEL,IAAK,YAKL,IAAK,0BAWL,IAAK,uBAEL,IAAK,8BAEL,IAAK,SAEL,QACE,MApDF,IAAK,gBACH9mC,KACA,MACF,IAAK,eACHkC,KACA,MAGF,IAAK,gBACHqB,KACA,MAWF,IAAK,SACH4+B,KACA,MACF,IAAK,WACHwD,KACA,MAKF,IAAK,0BACHl+B,KACA,MAGF,IAAK,yBACHP,KACA,MACF,IAAK,MACHlZ,KACA,MACF,IAAK,uBACH8f,KAWN,CACF,CAEO,SAASi5B,KACd,IAAItrC,EAAS,ED3DN+U,OAAOC,WAAW,8BAA8BC,UC6DrDjV,GAAW,GAAK+U,OAAOw2B,YAAcx2B,OAAO6iB,aAAgB,GAE9D/7C,EAAsB,cAAiDolB,MAAMC,YAAY,OAA0C,GAAGlB,MACxI,CAEO,SAASwrC,GAAoBC,GAClC,SAASC,IACPZ,GAAoBluD,UAAUkT,IAAI,MAClCg7C,GAAoB1pC,iBAClB,eACA,WACE0pC,GAAoB35C,aAAa,YAAa,SAC9C25C,GAAoBluD,UAAUqV,OAAO,MACb,mBAAbw5C,GACTA,GAEJ,EACA,CAAEpqC,MAAM,GAEZ,CACA,IAAMsqC,GAAc,IAAI76D,MAAOuB,UAC3Bs5D,EAAcX,GAjLqB,IAkLrC9P,WAAWwQ,EAASn5D,KAAKuF,IAAI,EAAG6zD,EAAcX,KAE9CU,GAEJ,CAEO,SAASE,KACdb,GAAoB55C,aAAa,YAAa,OAChD,CAqBO,SAAS+5B,GAAUvqC,GACxB,IAAIjH,EAAgB,EAChBC,EAAiB,EACf89C,EAAc1iB,OAAO2iB,WACrBC,EAAe5iB,OAAO6iB,YAC5B,OAAQj3C,GACN,IAAK,SACHjH,EAAQ+9C,EACR99C,EAASg+C,EACT,MACF,IAAK,OACHj+C,EAAQ+9C,EACR99C,EAAS,GACT,MACF,IAAK,kBACHD,EAAQ+9C,EAAc,GACtB99C,EAAS,GACT,MACF,IAAK,kBACHD,EAAQ+9C,EAAc,IACtB99C,EAAS,GACT,MACF,IAAK,uBACHD,EAAQ+9C,EAAc,GAAS,GAC/B99C,EAAS,KACT,MACF,IAAK,+BACHD,EAAQ+9C,EAAc,GAAK,GAAK,GAChC99C,EAAS,GACT,MACF,IAAK,kCACHD,EAAQ+9C,EAAc,GAAK,GAC3B99C,EAAS,GACT,MACF,QACED,EAAQ,EACRC,EAAS,EAGb,MAAO,CACLD,MAAAA,EACAC,OAAAA,EAEJ,CAEO,SAASsqD,KACdlvB,OAAO82B,SAAS,CACdnX,IAAK,EACLoX,SAAU,WAEd,CC1QA,IAAMC,GAAiBlwD,EAAsB,OACvCmwD,GAAuB7vD,EAAqB4vD,GAAgB,OAC5DE,GAAe9vD,EAAqB6vD,GAAsB,OAC1DE,GAAoB/vD,EAAqB6vD,GAAsB,OAC/DG,GAAwBhwD,EAAqB+vD,GAAmB,oCAChEE,GAA+BjwD,EAAqB+vD,GAAmB,6CACvEG,GAA+BlwD,EAAqB+vD,GAAmB,6CACvEI,GAAmBnwD,EAAqB+vD,GAAmB,8BAC3DK,GAAiBpwD,EAAqB+vD,GAAmB,4BAE7B,SAAAM,KAWjC,OAXiCA,IAAAh3D,EAAAA,EAAAA,GAAlC,YACE,IAAMwjD,EAAa9N,GAAU,UACvBuhB,EAAazT,EAAWt/C,MACxBgzD,EAAcn6D,KAAKwF,IAAK,EAAI,GAAM00D,EAAgC,IAApBzT,EAAWr/C,QACzDjC,QjFsFD,SAAgCtC,EAAAC,EAAAY,GAAA,OAAAwD,EAAAlE,MAAC,KAAD7D,UAAA,CiFtFjBi7D,CAAkBF,EAAYC,EAAa,IAC/DP,GAAsBp8C,UAAYxU,EAAa7D,EAAMA,MAAMC,KAC3Dy0D,GAA6Br8C,UAAYxU,EAAa7D,EAAMA,MAAMI,KAClEu0D,GAA6Bt8C,UAAYxU,EAAa7D,EAAMA,MAAMK,KAClEu0D,GAAiBv8C,UAAYte,EAAaiG,EAAMgxB,OAAO/qB,MAAO,cAC9D4uD,GAAex8C,UAAYte,EAAaiG,EAAMgxB,OAAOC,IAAK,cAC1DsjC,GAAa/pC,UAAYxqB,EAAM0gD,KACjC,GAACoU,GAAAj3D,MAAA,KAAA7D,UAAA,CCLA,SAAAk7D,KAAA,OAAAA,IAAAp3D,EAAAA,EAAAA,GAjBM,UAAkC03B,GACvC,GAA6B,KAAzBH,IAAsD,KAAvBC,SAA6Cp7B,IAAhBs7B,EAC9D,OAAO,EAET,IAAMzuB,EAAM0tB,GAAsB,UAC5B8B,EAAcpB,GAA2B,SAAU,CAACK,IACpD/tB,QAAiBuuB,GAAwB,SAAUjvB,EAAKwvB,GAC9D,OAAiB,IAAb9uB,IAGoB,MAAlBA,EAAS7L,MAAoC,WAApB6L,EAASitB,evC0JnC,SAAyCvG,GAAA,OAAA8J,GAAAp6B,MAAC,KAAD7D,UAAA,CuCzJpCm7D,CAA2B3/B,IAC1B,GAKb,GAAC0/B,GAAAr3D,MAAA,KAAA7D,UAAA,CCXD,IAAMo7D,GAAmCjxD,EAAsB,OACzDkxD,GAAyC5wD,EAAqB2wD,GAAkC,OAChGE,GAAmD7wD,EAAqB4wD,GAAwC,OAChHE,GAAgD9wD,EAAqB6wD,GAAkD,OACvHE,GAAkC/wD,EAAqB2wD,GAAkC,OACzFK,GAA2BhxD,EAAqB+wD,GAAiC,OAEnFrb,GAAsB,CAAC,EAEvBzhC,IAAkC,EAGlCg9C,GAA8D,KAC9DC,GAA6D,IAC7DC,GAAiE,KACjEC,IAA0D,EAC1DC,GAA4D,EAC5DC,GAA4D,EAC5DC,GAAkE,GAClEC,IAA6D,EAC7DC,IAA4D,EAC5DC,IAAgE,EAOpE,SAAS9sC,GAAmC9e,GAC1C,IAAMC,EAAcD,EACpB,GAAI0rD,GAAmD,CACrD,IAAMxa,EAAcjxC,EAAYC,OAAOnC,SAAW,EAClDitD,GAA8ChsC,MAAMC,YAAY,OAAsEiyB,EAAY5mB,WACpJ,CACiC,QAA7BrqB,EAAYC,OAAOL,OACrB/F,SAASolB,oBAAoBjf,EAAYC,OAAOH,OAAQ+e,GAE5D,CAEA,SAASiE,KACP,IAAMtV,EAAa1R,KAGbinB,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAC1BmV,EAAYxb,GAAKiG,EAGjB,IAAMo+C,EAAe/xD,SAAS8T,cAAc,OAC5Ci+C,EAAalxD,UAAUkT,IAAI,MAC3BmV,EAAY1U,YAAYu9C,GAGxB,IAAMC,EAA8BhyD,SAAS8T,cAAc,OAC3Dk+C,EAA4BnxD,UAAUkT,IAAI,MAG1C,IAAMk+C,EAAiBjyD,SAAS8T,cAAc,OAC9Cm+C,EAAepxD,UAAUkT,IAAI,MAC7Bi+C,EAA4Bx9C,YAAYy9C,GAGxC,IAAM5oC,EAAiBrpB,SAAS8T,cAAc,OAC9CuV,EAAexoB,UAAUkT,IAAI,MAC7Bi+C,EAA4Bx9C,YAAY6U,GAGxC,IAAME,EAAcvpB,SAAS8T,cAAc,OAC3CyV,EAAY1oB,UAAUkT,IAAI,MAC1Bi+C,EAA4Bx9C,YAAY+U,GAGxC,IAAM2oC,EAAgBlyD,SAAS8T,cAAc,OAC7Co+C,EAAcrxD,UAAUkT,IAAI,MAC5B,IAAMF,EAAc7T,SAAS8T,cAAc,QAS3C,OARAD,EAAYW,YAAYZ,GAAe,UACvCs+C,EAAc19C,YAAYX,GAE1Bm+C,EAA4Bx9C,YAAY09C,GAGxChpC,EAAY1U,YAAYw9C,GAEjB,CACL3xD,QAAS6oB,EACTxb,GAAIiG,EAER,CAEA,SAASw+C,GAAuCl7C,EAA8CtC,EAAyBC,GACrH,SAASimC,EAAWrwB,EAA8B/c,EAA8CqtC,GAC9F,SAASsX,EAAY5nC,EAA8B/c,GACpBrN,EAAqBoqB,EAAiB,OAC9CxW,UAAYvG,EAAS7Y,KAC5C,CAEA,SAASy9D,EAAc7nC,EAA8B/c,GACnD,IAAM6kD,EAAsClyD,EAAqBoqB,EAAiB,OACnDpqB,EAAqBkyD,EAAqC,OAClEt+C,UAAYvG,EAAS5Y,OAC9C,CAEA,SAAS09D,EAAW/nC,EAA+B/c,GACjD,IAAM6kD,EAAsClyD,EAAqBoqB,EAAiB,OACtDpqB,EAAqBkyD,EAAqC,OAClEt+C,UAAYvG,EAASpW,IAC3C,CAEA,SAASm7D,EAAchoC,EAA8B/c,GACnD,IAAM6kD,EAAsClyD,EAAqBoqB,EAAiB,OACnDpqB,EAAqBkyD,EAAqC,OAClEt+C,UAAY,GAAGvG,EAAS2T,MAAM/pB,WAAWoW,EAAS2T,MAAM8B,WACjF,CAEA,SAASuvC,EAAajoC,EAA8B/c,GAClD,IAAM6kD,EAAsClyD,EAAqBoqB,EAAiB,OACpDpqB,EAAqBkyD,EAAqC,OAClEzsC,QAAU,YA8M/B,SAA8DrjB,EAAApJ,GAAAs5D,GAAAl5D,MAAC,KAAD7D,UAAA,CA7M7Dg9D,CAAgDnoC,EAAgB9c,GAAID,EAAS0jB,YAC/E,CACF,CAEA,SAASyhC,EAAYpoC,EAA8B/c,GACjD+c,EAAgBpV,aAAa,QAAS+qB,GAAgB1yB,EAAS2nB,UACjE,CAEA,SAASjgB,EAAgBqV,EAA8B5V,GACrD4V,EAAgBpV,aAAa,YAAa+qB,GAAgBvrB,GAC5D,CAEA,SAASS,EAAqBmV,EAA8B7V,GAC1D6V,EAAgBpV,aAAa,kBAAmB+qB,GAAgBxrB,GAClE,CAEImmC,SACFsX,EAAY5nC,EAAiB/c,GAC7B4kD,EAAc7nC,EAAiB/c,GAC/B8kD,EAAW/nC,EAAiB/c,GAC5B+kD,EAAchoC,EAAiB/c,GAC/BglD,EAAajoC,EAAiB/c,GAC9BmlD,EAAYpoC,EAAiB/c,GAC7B0H,EAAgBqV,EAAiB5V,GACjCS,EAAqBmV,EAAiB7V,KAElClH,EAAS7Y,QAAUkmD,EAAalmD,OAClCw9D,EAAY5nC,EAAiB/c,GAE3BA,EAAS5Y,UAAYimD,EAAajmD,SACpCw9D,EAAc7nC,EAAiB/c,GAE5B6H,GAAcwlC,EAAa3pB,YAAa1jB,EAAS0jB,eACpDohC,EAAW/nC,EAAiB/c,GAC5B+kD,EAAchoC,EAAiB/c,GAC/BglD,EAAajoC,EAAiB/c,IAE5BqtC,EAAa1lB,WAAa3nB,EAAS2nB,UACrCw9B,EAAYpoC,EAAiB/c,GApJJ,QAsJDmH,GACxBO,EAAgBqV,EAAiB5V,GAE/BP,KAA2BM,GAC7BU,EAAqBmV,EAAiB7V,GAG5C,CAEA,IAAMrC,EAAe2E,EAAY3E,aAC3BD,EAAQ4E,EAAY5E,MAEpB8rC,EAAsB79C,EAAwB8wD,GAA0B,OAA2Cx7D,OACzH,GAAI0c,IAAiB6rC,EAAqB,CACxC,IAAMzoC,EAAayoC,EAAsB7rC,EACzC,GAAIoD,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMiW,EAAiB7C,KACvBtT,EAASnB,YAAYsX,EAAezrB,QACtC,CACA+wD,GAAyBp7C,OAAOL,EAClC,MAEE,IADA,IAAMk9C,EAAmCvyD,EAAwB8wD,GAA0B,OAClFv7C,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDg9C,EADkB1U,EAAsB,EAAItoC,GACAK,QAC9C,CAEJ,CAGA,IADA,IAAM28C,EAAmCvyD,EAAwB8wD,GAA0B,OAClFhmD,EAAI,EAAGA,EAAIkH,EAAclH,IAAK,CACrC,IAAMof,EAAkBqoC,EAAiCznD,GACnDqC,EAAW4E,EAAMjH,GACvB,GAAI0qC,GAAoBhzC,eAAe,SACrC,GAAIgzC,GAAoBzjC,MAAMjH,GAE5ByvC,EAAWrwB,EAAiB/c,EADPqoC,GAAoBzjC,MAAMjH,SAG/CyvC,EAAWrwB,EAAiB/c,EAAU,WAGxCotC,EAAWrwB,EAAiB/c,EAAU,KAE1C,CAEAqoC,GAAsB7+B,EACtB5C,GAAyBM,CAC3B,CAqCC,SAEcm+C,KAAkC,OAAAC,GAAAv5D,MAAC,KAAD7D,UAAA,UAAAo9D,KA0BhD,OA1BgDA,IAAAt5D,EAAAA,EAAAA,GAAjD,YACE,IAAMsd,EAAoBzV,GAAsB,qBAC1Cif,EAA2Bjf,GAAsB,oBACvDkwD,GAAiDjxC,EAAyBe,QAC1E+vC,GAAsD9wC,EAAyBw+B,aAC/E6S,IAAoD,EACpDD,GAA0D1vD,KAC1DivD,GAA8C97C,aAAa,aAAc,QACzE87C,GAA8CrwD,UAAUqV,OAAO,MAC/DlW,SAASqlB,iBAAiBssC,GAAyD3sC,IACnF,IAAM/N,QAAoBgd,GAA8B09B,IACxDQ,GAAuCl7C,GAAa,EAAOF,GAC3D,IAAIkoC,EAAa,EACbuS,KACFvS,QAAmBliC,MAErB00C,IAAoD,IAAI18D,MAAOuB,UAE7Do7D,GADEF,GACkDh7D,KAAKuF,IAAI01D,GAAoDH,GAAoDr6C,EAAY3Q,eAAiB+qD,GAAsDpS,GAEpMwS,GAAoDJ,GAE1GE,GAAyD/6D,KAAKuF,IAAIu1D,GAAoDI,GAAoDD,IAC1KG,IAAoD,EACpDV,GAA8C97C,aAAa,aAAc,SAtPzE87C,GAA8ChsC,MAAMC,YAAY,OAAkE,GAAGosC,QACrIL,GAA8CrwD,UAAUkT,IAAI,KAuP9D,IAACva,MAAA,KAAA7D,UAAA,UAEcq9D,KAAiC,OAAAC,GAAAz5D,MAAC,KAAD7D,UAAA,UAAAs9D,KAwB/C,OAxB+CA,IAAAx5D,EAAAA,EAAAA,GAAhD,YACEq5D,KACG5oC,KAAK,WACA2nC,GACF1S,WACE,WACE6T,IACF,EACAx8D,KAAKuF,IAAIu1D,GAAoDI,IAAoD,IAAI38D,MAAOuB,YAG9Hw7D,IAAuD,CAE3D,GAAE,MACK,SAAC93D,GAEF63D,GACF1S,WAAW,WACT6T,IACF,EA1R2D,KA4R3DlB,IAAuD,CAE3D,EACJ,IAACt4D,MAAA,KAAA7D,UAAA,CAEM,SAASu9D,KACdz8C,GAAgB,+BAChBs6C,GAAiC37C,aAAa,YAAa,QA7F7D,WAOE,IANA,IAAM2B,EAAoBzV,GAAsB,qBAC1C27C,EAAa9N,GAAU,UAEvBgO,GADaF,EAAWt/C,MACVs/C,EAAWr/C,QACzB2hD,EAAuE/oD,KAAKC,MAAM0mD,EAAc,IAAM,EACxG9qC,EAAkD,GAC7C3V,EAAI,EAAGA,EAAI6iD,EAAqB7iD,IACvC2V,EAAM1V,KAAK,CACTtF,KAAM,GACNg6B,QAAS,EACTxX,cAAe,EACfsX,YAAa,OACbO,eAAgB,EAChBtQ,MAAO,CACL/pB,KAAM,GACN6rB,UAAW,GACXxV,GAAI,EACJ2T,gBAAiB,IAEnB+T,UAAU,EACVzgC,KAAM,GACNC,MAAO,GACPC,QAAS,KAGbs9D,GACE,CACE9/C,MAAOA,EACPC,aAAcitC,EACdj5C,eAAgB,IAElB,EACAyQ,EAEJ,CA2DEo8C,GACKtB,KACHA,IAAmD,EAC9CC,GAIHgB,MAHAhB,IAAuD,EACvDkB,OAKJp8C,IACF,CAwBC,SAAA87C,KAAA,OAAAA,IAAAj5D,EAAAA,EAAAA,GAfM,UAA+Dka,EAAoBwd,GACxFlJ,GAAc,gBAAiB,OAC/B,IAAMmrC,QD3UD,SAAiC5wD,GAAA,OAAAquD,GAAAr3D,MAAC,KAAD7D,UAAA,CC2UX09D,CAAmBliC,GAC9C,GAAIiiC,GAIF,GAHoBhzD,EAAqBgxD,GAA0B,OAA2Cz9C,KAClGuC,SACZ+R,GAAc,eAAgB,UACzB2pC,GAAmD,CACtD,IAAM76C,EAAoBzV,GAAsB,qBAEhD6wD,SAD0Bl+B,GAA8B09B,KACJ,EAAO56C,EAC7D,OAEAkR,GAAc,QAAS,OAE3B,GAACyqC,GAAAl5D,MAAA,KAAA7D,UAAA,C,y/BCzVD,IAAM29D,GAAuBxzD,EAAsB,OAC7CyzD,GAA6BnzD,EAAqBkzD,GAAsB,OACxEE,GAAgCpzD,EAAqBmzD,GAA4B,OACjFE,GAAoCrzD,EAAqBmzD,GAA4B,OACrFG,GAA6BtzD,EAAqBkzD,GAAsB,OACxEK,GAA8BvzD,EAAqBszD,GAA4B,OAErF,SAASzqC,GAAsB2qC,EAAwBpoD,EAA2BpU,GAChF,IAAMy8D,EAAgB7zD,SAAS8T,cAAc,OAC7C+/C,EAAchzD,UAAUkT,IAAI,MAE5B,IAAM2X,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAC1B2X,EAAYlX,YAAYxU,SAASspB,eAAe9d,EAAKnU,OAErD,IAAMy8D,EAA2B9zD,SAAS8T,cAAc,OACxDggD,EAAyBjzD,UAAUkT,IAAI,MAEvC,IAAMggD,EAAkB/zD,SAAS8T,cAAc,SAW/C,OAVAigD,EAAgBnvD,KAAO,WACvBmvD,EAAgBC,QAAUJ,EAAQ1I,SAAW9zD,EAC7C28D,EAAgBluC,QAAU,SAAC3f,IA0CtB,SAAgCA,EAAc+tD,EAAoB78D,GACvE,IACiCsU,EADmLC,EAAA1O,GAAjMiD,EAAyB,+CACX,IAAjC,IAAAyL,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAmC,CAAhBsO,EAAA9R,MACRo6D,SAAU,CACrB,CAAC,OAAAh6D,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACD,IAAMwI,EAASC,EAAMD,OACrBA,EAAO+tD,SAAU,EACjB9H,GAAoB+H,EAAY78D,EAClC,CAjDI88D,CAAuBhuD,EAAO0tD,EAAQj6D,IAAKvC,EAC7C,EAEA08D,EAAyBt/C,YAAYu/C,GACrCF,EAAcr/C,YAAYkX,GAC1BmoC,EAAcr/C,YAAYs/C,GAEnB,CACLzzD,QAASwzD,EACTnmD,GAAI,GAER,CAiBO,SAASymD,GAAoBF,GAClCx9C,GAAgB,mBAChB68C,GAAqBl+C,aAAa,YAAa,QAjBjD,SAAwC6+C,GACtC,IAAML,EAAU3H,GAAWgI,GAC3BN,GAA4B3/C,UAAY4/C,EAAQv8D,KAChDo8D,GAAkCz/C,UAAY4/C,EAAQQ,YACtDZ,GAA8BrtC,UAAY,GAC1C,IAEkCrpB,EAF5B6Y,EAAW,IAAIC,iBACjBxe,EAAgB,EAAE4F,EAAAC,GACH22D,EAAQS,SAAO,IAAlC,IAAAr3D,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAoC,KAC5B0X,EAAcmU,GAAsB2qC,EAD7B92D,EAAAlD,MAC4CxC,GACzDue,EAASnB,YAAYM,EAAYzU,SACjCjJ,GAAS,CACX,CAAC,OAAA4C,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD+1D,GAA8Bx9C,OAAOL,EACvC,CAKE2+C,CAA+BL,GAC/Br9C,IACF,C,y/BChCA,SAAS29C,GAAqB76D,GAC5B,IAAAwsC,EAAoB,CAClB,CAAC,KAAM,SACP,CAAC,KAAM,YACP,CAAC,KAAM,aACP,CAAC,KAAM,aACP,CAAC,KAAM,aACP,CAAC,KAAM,aACP,CAAC,KAAM,aACP,CAAC,QAAS,oBACV,CAAC,OAAQ,eACT,CAAC,KAAM,gBACP,CAAC,KAAM,gBACP,CAAC,MAAO,WACR,CAAC,MAAO,WACR,CAAC,MAAO,YACRxsC,IAAU,CAAC,KAAM,UAASysC,GAAAhkC,EAAAA,EAAAA,GAAA+jC,EAAA,GAK5B,MAJe,CACb7uC,KAjBS8uC,EAAA,GAkBTxsC,IAlBcwsC,EAAA,GAqBlB,CA8CC,SAAAquB,KAAA,OAAAA,IAAA/6D,EAAAA,EAAAA,GA5CM,YAKL,IAJA,IAAIg7D,EAA2B,EACzBC,EAAmD,CAAC,EACpDC,EtFkDCz7D,EAAOtD,OsFhDL8G,EAAI,EAAGA,EAAIi4D,EAAcj4D,IAAK,CACrC,IAEiCI,EAD7B83D,EAA+B,EAAE53D,EAAAC,SADXtC,EAAe+B,IAER,IAAjC,IAAAM,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAmC,KAAxBy3D,EAAO/3D,EAAAlD,MACV4R,QAAavR,EAAUyC,EAAGm4D,GAE1BC,EADe/+D,OAAOyV,GACI5V,OAASi/D,EAAQj/D,OACjD6+D,GAAoBK,EACpBF,GAAwBE,CAC1B,CAAC,OAAA96D,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,IAAMs3D,EAAeR,GAAqB73D,GACpCs4D,EAAkBD,EAAap7D,IAChC+6D,EAAwB5xD,eAAekyD,KAC1CN,EAAwBM,GAAmB,CACzCC,SAAUF,EACV99B,KAAM,IAGVy9B,EAAwBK,EAAap7D,KAAKs9B,MAAQ29B,CACpD,CAEA,IAAMM,EAAY11D,EAAai1D,GAEzBU,EAAqC,CAAC,EAC5C,IAAK,IAAMx7D,KAAO+6D,EAAyB,CACzC,IAAMK,EAAeL,EAAwB/6D,GAAKs7D,SAC5CG,EAAmBV,EAAwB/6D,GAAKs9B,KACtDk+B,EAAiBx7D,GAAO,CACtBs7D,SAAUF,EACV99B,KAAMz3B,EAAa41D,GAEvB,CAOA,MALoC,CAClCF,UAAAA,EACAC,iBAAAA,EAIJ,IAAC37D,MAAA,KAAA7D,UAAA,CCzFD,IAAI0/D,GAAuC,GACvC/gD,IAA6B,EAC7BD,IAAkC,EAEhCihD,GAAex1D,EAAsB,OACrCy1D,GAAqBn1D,EAAqBk1D,GAAc,OACxDE,GAAoBp1D,EAAqBm1D,GAAoB,OAEnE,SAAStsC,KAEP,IAAMwsC,EAAwBz1D,SAAS8T,cAAc,OACrD2hD,EAAsB50D,UAAUkT,IAAI,MAGpC,IAAM2X,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAG1B,IAAMU,EAAezU,SAAS8T,cAAc,OAO5C,OANAW,EAAa5T,UAAUkT,IAAI,MAG3B0hD,EAAsBjhD,YAAYkX,GAClC+pC,EAAsBjhD,YAAYC,GAE3B,CACLpU,QAASo1D,EACT/nD,GAAI,GAER,CAEA,SAASgoD,GAAmBC,EAAiChhD,EAAyBC,GACpF,SAASimC,EAAWx6C,EAAsBqoD,EAAwB5N,GAChE,SAAS5lC,EAAY7U,EAAsBmL,GACrBpL,EAAqBC,EAAS,OACtC2T,UAAYxI,EAAKyrB,IAC/B,CAEA,SAAS8kB,EAAW17C,EAAsBmL,GACpBpL,EAAqBC,EAAS,OACtC2T,UAAYxI,EAAKypD,SAAS59D,IACxC,CAEA,SAAS8d,EAAgB9U,EAAsBuU,GAC7CvU,EAAQ+U,aAAa,YAAa+qB,GAAgBvrB,GACpD,CAEA,SAASS,EAAqBhV,EAAsBsU,GAClDtU,EAAQ+U,aAAa,kBAAmB+qB,GAAgBxrB,GAC1D,CAGImmC,GACE4N,EAAYuM,SAASt7D,MAAQmhD,EAAama,SAASt7D,MACrDoiD,EAAW17C,EAASqoD,GACpBxzC,EAAY7U,EAASqoD,IAGnBA,EAAYzxB,OAAS6jB,EAAa7jB,MACpC/hB,EAAY7U,EAASqoD,GAGnBp0C,KAAsBM,GACxBO,EAAgB9U,EAASuU,GAGvBP,KAA2BM,GAC7BU,EAAqBhV,EAASsU,KAKhCO,EAAY7U,EAASqoD,GACrB3M,EAAW17C,EAASqoD,GACpBvzC,EAAgB9U,EAASuU,GACzBS,EAAqBhV,EAASsU,GAElC,CAEA,IAAMihD,EAAa,GACnB,IAAK,IAAMj8D,KAAOg8D,EAAWR,iBAAkB,CAC7C,IAAM3pD,EAAOmqD,EAAWR,iBAAiBx7D,GACzCi8D,EAAWj5D,KAAK6O,EAClB,CAEA,IAAMqqD,EAAqBD,EAAWhgE,OAChCuoD,EAAsB79C,EAAwBk1D,GAAmB,OAAgC5/D,OACvG,GAAIigE,IAAuB1X,EAAqB,CAC9C,IAAMzoC,EAAayoC,EAAsB0X,EACzC,GAAIngD,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMsrB,EAAalY,KACnBtT,EAASnB,YAAY2sB,EAAW9gC,QAClC,CACAm1D,GAAkBhhD,YAAYmB,EAChC,MAEE,IADA,IAAMmgD,EAA0Bx1D,EAAwBk1D,GAAmB,OAClE3/C,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDigD,EADkB3X,EAAsB,EAAItoC,GACTK,QACrC,CAEJ,CAGA,IADA,IAAM6/C,EAAyBz1D,EAAwBk1D,GAAmB,OACjE94D,EAAI,EAAGA,EAAIm5D,EAAoBn5D,IAAK,CAC3C,IAAMo+C,EAAeua,GAAmB34D,GAClCgsD,EAAckN,EAAWl5D,GACzB8tB,EAAkBurC,EAAuBr5D,GAE7Cm+C,EAAWrwB,EAAiBk+B,EAD1B5N,GAGuC,KAE7C,CAEAua,GAAqBO,EACrBvhD,GAAyBM,EACzBL,GAAoBM,CACtB,CAyBuC,SAAAohD,KAKtC,OALsCA,IAAAv8D,EAAAA,EAAAA,GAAvC,YACE,IAAMsd,EAAoBzV,GAAsB,sBAxBlD,WAUE,IATA,IAAMyV,EAAoBzV,GAAsB,qBAG1C67C,EAFYhO,GAAU,UAEEvxC,OACxBq4D,EAA4Bz/D,KAAKwF,IAAI,EAAGxF,KAAKC,MAAM0mD,EAAc,IAAM,GACvEwY,EAAkC,CACtCR,iBAAkB,CAAC,EACnBD,UAAW,GAEJx4D,EAAI,EAAGA,EAAIu5D,EAA2Bv5D,IAAK,CAClD,IAAMw5D,EAAc,SAASx5D,IAC7Bi5D,EAAWR,iBAAiBe,GAAe,CACzCjB,SAAU,CACR59D,KAAM,GACNsC,IAAKu8D,GAEPj/B,KAAM,QAAQv6B,IAElB,CACAg5D,GAAmBC,GAAY,EAAM5+C,EACvC,CAIEo/C,GACA,IAAMR,QDvGD,WAAsC,OAAAnB,GAAAh7D,MAAC,KAAD7D,UAAA,CCuGlBygE,GACzBV,GAAmBC,GAAY,EAAO5+C,EACxC,GAACi/C,GAAAx8D,MAAA,KAAA7D,UAAA,C,y/BXrDD,IAAMs1D,GAA6B,CAAC,uBAAwB,mBAAoB,wBAAyB,2BAA4B,kBAAmB,QAAS,SAAU,oBAAqB,eAAgB,oBAAqB,eAAgB,aAAc,UAAW,qBAAsB,SAAU,SAAU,UAAW,SAAU,mBAAoB,UAE7VD,GAA2B,CAC7B3qC,qBAAsB,CACpB1mB,IAAK,uBACLtC,KAAM,SACNqY,KAAM,SACNnM,OAAQ,GACRi+B,OAAQ,WACN2yB,GAAoB,uBACtB,EACAvvD,KAAM,SACNyxD,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,GAAGV,EAAW,GAAI,MAAMA,EAAW,GAAI,MAAMA,EAAW,KAAa,KAC3EiD,MAAO,CACLgL,KAAM,EACNjF,OAAQ,GAEV22D,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,GAAGV,EAAW,GAAI,MAAMA,EAAW,GAAI,MAAMA,EAAW,KAAa,KAC3EiD,MAAO,CACLgL,KAAM,EACNjF,OAAQ,GAEV22D,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,GAAGV,EAAW,GAAI,MAAMA,EAAW,GAAI,MAAMA,EAAW,KAAa,KAC3EiD,MAAO,CACLgL,KAAM,EACNjF,OAAQ,GAEV22D,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,GAAGV,EAAW,GAAI,MAAMA,EAAW,GAAI,MAAMA,EAAW,KAAa,KAC3EiD,MAAO,CACLgL,KAAM,EACNjF,OAAQ,GAEV22D,mBAAmB,EACnBC,wBAAyB,IAG7BnC,YAAa,iCAEfoC,iBAAkB,CAChB78D,IAAK,mBACLtC,KAAM,WACNqY,KAAM,OACNnM,OAAQ,GACRi+B,OAAQ,WACN2yB,GAAoB,mBACtB,EACAvvD,KAAM,SACNyxD,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,KACNuC,MAAO,CACLmlD,aAAc,KACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,MACNuC,MAAO,CACLmlD,aAAc,IACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,MACNuC,MAAO,CACLmlD,aAAc,IACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,MACNuC,MAAO,CACLmlD,aAAc,IACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,MACNuC,MAAO,CACLmlD,aAAc,IACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,MACNuC,MAAO,CACLmlD,aAAc,IACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,MACNuC,MAAO,CACLmlD,aAAc,IACdz9B,SAAS,EACT1c,KAAM,GAER0xD,mBAAmB,EACnBC,uBAAwB,IAG5BnC,YAAa,yCAEfqC,sBAAuB,CACrB98D,IAAK,wBACLtC,KAAM,SACNqY,KAAM,UACNnM,OAAQ,GACRi+B,OAAQ,WACN2yB,GAAoB,wBACtB,EACAvvD,KAAM,SACNyxD,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,IAG7BnC,YAAa,0CAEfz3B,yBAA0B,CACxBhjC,IAAK,2BACLtC,KAAM,SACNqY,KAAM,UACNnM,OAAQ,GACRi+B,OAAQ,WACN2yB,GAAoB,2BACtB,EACAvvD,KAAM,SACNyxD,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,IAG7BnC,YAAa,6CAEf13B,gBAAiB,CACf/iC,IAAK,kBACLtC,KAAM,SACNqY,KAAM,MACNnM,OAAQ,GACRi+B,OAAQ,WACN2yB,GAAoB,kBACtB,EACAvvD,KAAM,SACNyxD,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,OACNuC,MAAO,CACLgL,KAAM,EACN6B,OAAQ,cAEV6vD,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,OACNuC,MAAO,CACLgL,KAAM,EACN6B,OAAQ,WAEV6vD,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,OACNuC,MAAO,CACLgL,KAAM,EACN6B,OAAQ,WAEV6vD,mBAAmB,EACnBC,wBAAyB,IAG7BnC,YAAa,kFAEf/yD,MAAO,CACL1H,IAAK,QACLtC,KAAM,OACNqY,KAAM,SACNnM,OAAQ,GACRi+B,OAAQ,WACN2yB,GAAoB,QACtB,EACAvvD,KAAM,SACNyxD,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,IAG7BnC,YAAa,gBAEfz0C,OAAQ,CACNhmB,IAAK,SACLtC,KAAM,MACNqY,KAAM,SACNnM,OAAQ,GACRqB,KAAM,OACN48B,OAAQzV,GACRqoC,YAAa,IAEfuC,kBAAmB,CACjBh9D,IAAK,oBACLtC,KAAM,QACNqY,KAAM,oBACNnM,OAAQ,GACRi+B,OAAQvR,GACRrrB,KAAM,OACNwvD,YAAa,IAEfwC,aAAc,CACZj9D,IAAK,eACLtC,KAAM,KACNqY,KAAM,gBACNnM,OAAQ,GACRi+B,OAAQ0xB,GACRtuD,KAAM,OACNwvD,YAAa,IAEfr9C,kBAAmB,CACjBpd,IAAK,oBACLtC,KAAM,KACNqY,KAAM,YACN0kD,YAAa,cACb7wD,OAAQ,GACRqB,KAAM,SACN48B,OAAQ,WACN2yB,GAAoB,oBACtB,EACAkC,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,uBAAwB,GAE1B,CACEl/D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,KAI/Bj2C,aAAc,CACZ3mB,IAAK,eACLtC,KAAM,OACNqY,KAAM,cACN0kD,YAAa,iBACb7wD,OAAQ,GACRqB,KAAM,SACN48B,OAAQ,WACN2yB,GAAoB,eACtB,EACAkC,eAAgB,EAChBnL,OAAQ,EACRmJ,QAAS,CACP,CACEh9D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,GAE3B,CACEl/D,KAAM,KACNuC,MAAO,CACLgL,KAAM,EACN8xD,SAAS,GAEXJ,mBAAmB,EACnBC,wBAAyB,KAI/BM,WAAY,CACVl9D,IAAK,aACLtC,KAAM,QACNqY,KAAM,iBACNnM,OAAQ,GACRqB,KAAM,OACN48B,OMrcG,WACL/qB,GAAgB,aAChBu5C,GAAe56C,aAAa,YAAa,QAjB8G,WAEvHq7C,GAAAj3D,MAAC,KAAD7D,UAAA,CAgBhCmhE,GACAlgD,IACF,ENicIw9C,YAAa,IAEfj8D,QAAS,CACPwB,IAAK,UACLtC,KAAM,OACNqY,KAAM,WACNnM,OAAQ,GACRqB,KAAM,OACN48B,OW7UG,WACL8zB,GAAalgD,aAAa,YAAa,QAVxC,WAEsC4gD,GAAAx8D,MAAC,KAAD7D,UAAA,CASrCohE,EACF,EX2UI3C,YAAa,IAEf4C,mBAAoB,CAClBr9D,IAAK,qBACLtC,KAAM,OACNqY,KAAM,UACNnM,OAAQ,GACRi+B,OGvVG,Y/EvBA,WAAsC,OAAApmC,EAAA5B,MAAC,KAAD7D,UAAA,E+EwB3CshE,GAA0B/sC,KAAK,SAAC1sB,GAC9B,OAAQA,GACN,IAAK,UACHyqB,GAAc,eAAgB,WAC9B,MACF,IAAK,SACHA,GAAc,SAAU,cACxB,MACF,IAAK,cACHA,GAAc,UAAW,eACzB,MACF,QACEA,GAAc,QAAS,QAG7B,EACF,EHuUIrjB,KAAM,SACNwvD,YAAa,wBAEf8C,OAAQ,CACNv9D,IAAK,SACLtC,KAAM,OACNqY,KAAM,SACNnM,OAAQ,GACRqB,KAAM,SACN48B,OGtaG,WAAiC,OAAA8sB,GAAA90D,MAAC,KAAD7D,UAAA,EHuapCy+D,YAAa,IAEf+C,OAAQ,CACNx9D,IAAK,SACLtC,KAAM,OACNqY,KAAM,WACNnM,OAAQ,GACRqB,KAAM,SACN48B,OGzaG,WACL,IAAM7tB,EAAa1R,KACbm1D,EAAYp3D,SAAS8T,cAAc,SACzCsjD,EAAUhiD,aAAa,OAAQ,QAC/BgiD,EAAUhiD,aAAa,SAAU,oBACjCgiD,EAAUhiD,aAAa,OAAQzB,GAC/ByjD,EAAU1pD,GAAKiG,EACfyjD,EAAUv2D,UAAUkT,IAAI,MACxBqjD,EAAU/xC,iBACR,SACA,SAAUnf,GAER,GAAkC,IAA9BA,EAAMD,OAAO2oD,MAAMh5D,OACrBkK,EAAsB,SAAS6T,KAAcuC,aACxC,CAEL,IAAMmhD,EAAOnxD,EAAMD,OAAO2oD,MAAM,GAC1BlrD,EAAS,IAAI4zD,WAGnB5zD,EAAO6zD,OAAS,SAAU/5D,IF7B3B,SAAyBtD,GAAA,OAAAsyD,GAAAhzD,MAAC,KAAD7D,UAAA,EEkCtB6hE,CAHwBh6D,EAAEyI,OAAOxJ,QAGLytB,KAAK,SAACzsB,GAC5BA,EACFwqB,GAAc,eAAgB,SAE9BA,GAAc,QAAS,UAEzBnoB,EAAsB,SAAS6T,KAAcuC,QAC/C,EACF,EAGAxS,EAAO+zD,WAAWJ,EACpB,CACF,EACA,CAAE/xC,MAAM,IAEV8xC,EAAU/xC,iBACR,SACA,WACEvlB,EAAsB,SAAS6T,KAAcuC,QAC/C,EACA,CAAEoP,MAAM,IAGVtlB,SAAS2D,KAAKqS,OAAOohD,GACrBt3D,EAAsB,SAAS6T,KAAc+jD,OAC/C,EHuXItD,YAAa,IAEf/I,QAAS,CACP1xD,IAAK,UACLtC,KAAM,KACNqY,KAAM,SACNnM,OAAQ,GACRqB,KAAM,OACN48B,OG7XG,WACL,IAAM9+B,EAAM4qD,KACZt0B,OAAO2+B,KAAKj1D,EACd,EH2XI0xD,YAAa,IAEfwD,OAAQ,CACNj+D,IAAK,SACLtC,KAAM,KACNqY,KAAM,SACNnM,OAAQ,GACRqB,KAAM,OACN48B,OAAQ,WAAa,EACrB4yB,YAAa,IAEfyD,iBAAkB,CAChBl+D,IAAK,mBACLtC,KAAM,OACNqY,KAAM,SACNnM,OAAQ,GACRqB,KAAM,OACN48B,OAAQ,WAAa,EACrB4yB,YAAa,IAEf0D,OAAQ,CACNn+D,IAAK,SACLtC,KAAM,SACNqY,KAAM,SACNnM,OAAQ,iBACRqB,KAAM,OACN48B,OGnZG,WAELxI,OAAO2+B,KADK,mCAEd,EHiZIvD,YAAa,KAsBhB,SAAA2D,KAAA,OAAAA,IAAAt+D,EAAAA,EAAAA,GAlBM,YACL,IAC8BqD,EADeE,EAAAC,SAAlBtC,EAAe,IACZ,IAA9B,IAAAqC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAgC,KAArBzD,EAAGmD,EAAAlD,MACZ,GAAIqxD,GAAYx/C,QAAQ9R,IAAQ,EAAG,CACjC,IAAMq+D,QAAoB/9D,EAAU,EAAGN,GACvC,GAAoB,OAAhBq+D,GACF,GAA2B,WAAvBhN,GAASrxD,GAAKiL,KAAmB,CACnC,IAAMqzD,EAAoBvgE,SAASsgE,GACnChN,GAASrxD,GAAKuxD,OAAS+M,CACzB,MAE2B,WAAvBjN,GAASrxD,GAAKiL,OAChBomD,GAASrxD,GAAKuxD,OAASF,GAASrxD,GAAK08D,eAG3C,CACF,CAAC,OAAAr8D,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,OAAO,CACT,IAACjE,MAAA,KAAA7D,UAAA,CA4CA,SAAAs4D,KAAA,OAAAA,IAAAx0D,EAAAA,EAAAA,GA1CM,YACL,IAAMgD,EAAwB,GAC9B,IAAK,IAAM9C,KAAOqxD,GAAU,CAC1B,IAAIx/C,EAAOw/C,GAASrxD,GACpB,OAAQ6R,EAAK5G,MACX,IAAK,SACH4G,EAAKjI,OAASiI,EAAK6oD,QAAQ7oD,EAAK0/C,QAAQ7zD,KACxC,MACF,IAAK,OACH,GACO,iBADCsC,EAEJ6R,EAAKjI,OAAS4vB,KAAgC,MAAQ,WAGtD3nB,EAAKjI,OAAS,GAGlB,MACF,IAAK,SACHiI,EAAKjI,OAAS,GACF,uBAAR5J,IACF6R,EAAKjI,cAAgBxI,KAAyB,KAAO,MAEvD,MACF,IAAK,OAOH,GANY,YAARpB,IACF6R,EAAKjI,OAAS6pD,MAEJ,WAARzzD,IACF6R,EAAKjI,OAAS8pD,MAEJ,qBAAR1zD,EAA4B,CAC9B,IAAMhF,EAAO,IAAII,KAAKw4D,MACtB/hD,EAAKjI,OAASnN,EAAmBzB,EACnC,EAKJ8H,EAAOE,KAAK6O,EACd,CACA,OAAO/O,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAoBM,SAAeu2D,GAAmB1pD,EAAApJ,GAAA,OAAA8+D,GAAA1+D,MAAC,KAAD7D,UAAA,CAaxC,SAAAuiE,KAAA,OAAAA,IAAAz+D,EAAAA,EAAAA,GAbM,UAAmCE,EAAauxD,GACrD,SAAID,GAAYx/C,QAAQ9R,IAAQ,GAC1BqxD,GAASloD,eAAenJ,IACC,WAAvBqxD,GAASrxD,GAAKiL,WACsB/O,IAAlCm1D,GAASrxD,GAAK06D,QAAQnJ,IAA2D,OAAlCF,GAASrxD,GAAK06D,QAAQnJ,YACjE/xD,EAAU,EAAGQ,EAAKuxD,GACxBF,GAASrxD,GAAKuxD,OAASA,GAChB,EAMjB,IAAC1xD,MAAA,KAAA7D,UAAA,CAEM,SAASs2D,GAAWtyD,GACzB,GAAIsxD,GAAYx/C,QAAQ9R,IAAQ,GAC1BqxD,GAASloD,eAAenJ,GAC1B,OAAOqxD,GAASrxD,EAGtB,CAEO,SAAS2H,GAAsB3H,GACpC,GAAIsxD,GAAYx/C,QAAQ9R,IAAQ,GAC1BqxD,GAASloD,eAAenJ,GAAM,CAChC,IAAMw+D,EAAqBnN,GAAuB,aAE5CoN,EAD0BD,EAAmB9D,QAAQ8D,EAAmBjN,QAAQtxD,MACxB,QACxDy+D,EAAcrN,GAASrxD,GACzB2+D,EAAoBD,EAAYhE,QAAQgE,EAAYnN,QACpDkN,GACEE,EAAkBhC,oBACpBgC,EAAoBD,EAAYhE,QAAQiE,EAAkB/B,yBAG9D,IAAMgC,EAAmBD,EAAkB1+D,MAC3C,OAAQ2+D,EAAiB3zD,MACvB,KAAK,EACH,OAAO2zD,EAAiB9xD,OAE1B,KAAK,EACH,OAAO8xD,EAAiB54D,OAE1B,KAAK,EACH,OAAO44D,EAAgB,QAEzB,KAAK,EACH,OAAOA,EAET,QACE,MAAO,GAGb,CAEF,MAAO,EACT,C,y/BY/qBO,SAAStwC,GAAcvY,EAAuBjR,EAAiB+5D,GACpE,IAAMC,EAAoBv4D,EAAyB,OACnD,GAA0B,OAAtBu4D,EAA4B,KACe37D,EADfE,EAAAC,GACFw7D,GAAiB,IAA7C,IAAAz7D,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAA+C,CAAvBN,EAAAlD,MACRsc,QAChB,CAAC,OAAAlc,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACH,CAEA,IAAMsZ,EAAoBzV,GAAsB,qBAE1Co3D,EAAgB14D,SAAS8T,cAAc,OAC7C4kD,EAAc73D,UAAUkT,IAAI,MAC5B2kD,EAActjD,aAAa,YAAa+qB,GAAgBppB,IAExD,IAAM4hD,EAAoB34D,SAAS8T,cAAc,OACjD6kD,EAAkB93D,UAAUkT,IAAI,MAChC4kD,EAAkBnkD,YAAYZ,GAAelE,IAC7CgpD,EAAclkD,YAAYmkD,GAE1B,IAAMC,EAAuB54D,SAAS8T,cAAc,OAKpD,GAJA8kD,EAAqB/3D,UAAUkT,IAAI,MACnC6kD,EAAqB5kD,UAAYvV,EACjCi6D,EAAclkD,YAAYokD,GAEJ,YAAlBlzD,EAAAA,EAAAA,GAAO8yD,IAAP9yD,MAA8B8yD,GACF,mBAAnBA,aAAM,EAANA,EAAQh3B,QAAuB,CACxC,IAAMq3B,EAAsB74D,SAAS8T,cAAc,OACnD+kD,EAAoBh4D,UAAUkT,IAAI,MAClC8kD,EAAoB7kD,UAAYwkD,EAAO1uD,KACvC+uD,EAAoBxzC,iBAClB,QACA,WACEmzC,EAAOh3B,QACT,EACA,CAAElc,MAAM,IAEVozC,EAAclkD,YAAYqkD,EAC5B,CAGFH,EAAcrzC,iBACZ,eACA,SAAUnf,GACJA,SAAAA,EAAOD,QACTC,EAAMD,OAAOiQ,QAEjB,EACA,CAAEoP,MAAM,IAGVtlB,SAAS2D,KAAK6Q,YAAYkkD,EAC5B,CR5DO,IAAMI,GAAM5gE,EAAQ,MACZ24B,GAAW34B,EAAQ,MAAnB24B,OAER,SAASvb,GAAcnW,EAAQsU,GACpC,SAASslD,EAAYC,GACnB,OAAOv9D,KAAKQ,UAAU,CAAEuB,GAC1B,CACA,IAAMy7D,EAAKF,EAAY55D,GACjB+5D,EAAKH,EAAYtlD,GAEjB0lD,EAAmBF,EAAGrjE,OACtBwjE,EAAmBF,EAAGtjE,OAC5B,GAAIujE,IAAaC,EAAU,CACzB,GAAID,EAJiB,IAIIC,EAJJ,GAIuB,CAK1C,IAJA,IAAMC,EAAiBP,GAAIG,GACrBK,EAAiBR,GAAII,GAEvBK,GAAiB,EACZ78D,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAG1B,GAFoB28D,EAAOG,OAAO98D,KACd48D,EAAOE,OAAO98D,GAClC,CAGE68D,GAAQ,EACR,KACF,CACF,CACA,OAAOA,CACT,CACE,OAAIN,IAAOC,CAMf,CACE,OAAO,CAEX,CAEO,SAASj3D,KACd,IAAMw3D,EAAQ,CACZ,CAAC,GAAI,IACL,CAAC,GAAI,IACL,CAAC,GAAI,KAGHC,EAAgBljE,KAAKC,MAAsB,UAAhBD,KAAKilB,UAChCk+C,EAAgBnjE,KAAKC,MAAsB,UAAhBD,KAAKilB,UAE9Bhf,EAAS,IAAI2H,WAAW,IAC9B3H,EAAO,GAAK,GACZ,IAAK,IAAIC,EAAI,GAAIA,EAAI,EAAGA,IAAK,CAC3B,IACMk9D,EAAQH,EADJE,EAAgB,GAEpBpiE,EAAOqiE,EAAM,GAAMF,EAAgBE,EAAM,GAC/Cn9D,EAAOC,GAAKnF,EACZmiE,KAAmB,EACnBC,KAAmB,CACrB,CAEA,OAAO5jE,OAAO8J,aAAarG,MAAM,KAAMiD,EACzC,CAEO,SAAS8E,GAAoB7K,GAIlC,QAHa,IAAI3B,MAAOuB,UACDI,EAAY,GACb85B,SAAS,GAEjC,CAEO,SAASq+B,GAAiBnqD,EAAY8pD,GAAuD,IAArC3rB,EAAeltC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACzEkkE,EAAU77D,IAAI87D,gBAAgBp1D,GAC9Bq1D,EAAe/5D,SAAS8T,cAAc,KAS5C,OARAimD,EAAa/Z,KAAO6Z,EACpBE,EAAaC,SAAWxL,EACxBxuD,SAAS2D,KAAK6Q,YAAYulD,GAC1BA,EAAarC,QACbqC,EAAa7jD,SACbipC,WAAW,WACTnhD,IAAIi8D,gBAAgBJ,EACtB,EAAGh3B,GACIg3B,CACT,CA2BO,SAASpR,KACd,UAAI,iBAAkBzvB,UAAU/9B,UAAUi/D,eAO5C,CAEO,SAAS/5B,GAAgB1I,GAC9B,GAAiB,kBAANA,EACT,OAAIA,EACK,OAEA,OAGb,CAEO,SAAShB,GAAWhwB,GACzB,IAEE,OADA,IAAIzI,IAAIyI,IACD,CACT,CAAE,MAAO0zD,GACP,OAAO,CACT,CACF,C,y/BrDpIA,IA6CIC,GA5CAC,GAA8C,GAC9CC,IAAqD,EACrDC,GAAiD,GACjDC,GAA0E,CAC5E3+D,KAAM,CAAC,EACPoH,UAAW,EACXyK,GAAI,IAEF+sD,GAA6D,EAmC3DC,GAAwC,CAAC,EAI/C,GAA4B,oBAAjBh5D,aAA8B,CACvC,IAAMi5D,GAAmC,IAAIj5D,aAAa,IAAI1D,IAAgE,oBAC9Ho8D,GAAiCO,GAAiCn5D,MACnCI,OACjC,KAAO,CACL,IAAM+4D,GAAmC,IAAI58D,OAAO,IAAIC,IAAgE,mBACxHo8D,GAAiCO,EACnC,CAcE,SAEaC,GAA0Bp4D,GAAA,OAAAq4D,GAAArhE,MAAC,KAAD7D,UAAA,UAAAklE,KAWxC,OAXwCA,IAAAphE,EAAAA,EAAAA,GAAzC,UAA0CoC,GACxC,IAAMmG,EAASC,KASf,aAPqB,IAAI9D,QAAQ,SAACC,EAASC,GACzCq8D,GAAsC14D,GAAU5D,EAChDg8D,GAA+B57D,QAAU,SAAUhB,GACjDa,EAAOb,EAAEiB,QACX,EACA27D,GAA+B17D,YAAY,CAAC7C,EAAMmG,GACpD,EAEF,IAACxI,MAAA,KAAA7D,UAAA,CAED,SAASmlE,GAA6B5gD,EAA2CC,GAE/E,IADA,IAAM4gD,EAAc,IAAI5+D,YAAY,MAC3BO,EAAI,KAAaA,GAAK,EAAGA,IAChCq+D,EAAYr+D,GAAKwd,EAAYxd,GAAKyd,EAAYzd,GAEhD,OAAON,MAAMC,KAAK0+D,EACpB,CA4EC,SAAAv5C,KAAA,OAAAA,IAAA/nB,EAAAA,EAAAA,GA1EM,UAAyCoQ,GAC9C,IAAM9M,EAAM,IAAIhI,KACVsmB,EAA2Bte,EAAIzG,UAC/By5C,EAAahzC,EAAIkxB,SACnB3S,GAAc,EAElB,IAAKg/C,GAA2C,CAC9CA,IAA4C,EAC5CD,GAAsCp4D,KACtCu4D,GAAyC,CACvC9sD,GAAI2sD,GACJp3D,UAAWoY,EACXxf,KAAM,CAAC,GAET4+D,GAAqD,EACrD,IAAMO,QD6IH,SAAmCxgE,GAAA,OAAAulB,GAAAvmB,MAAC,KAAD7D,UAAA,CC7IPslE,CAAqB,CAAC,SACrDV,GAAkCS,EAAiBlkE,IAAI,SAAC0G,GAAC,OAAKA,EAAEkQ,EAAE,EACpE,CAGA,GQcK,SAAmC9S,GAAA,OAAAkzB,GAAAt0B,MAAC,KAAD7D,UAAA,CRdpCulE,CAAqBn+D,GAAM,KACED,EADFE,EAAAC,GACV4M,GAAY,IAA/B,IAAA7M,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAiC,KAAtBoO,EAAI1O,EAAAlD,MACP8hB,EAASlQ,EAAK2E,OACdwL,EAAU,KAAKD,KAAUq0B,IAC3BwqB,GAAgC9uD,QAAQiQ,IAAW,IAChD8+C,GAAuC3+D,KAAKiH,eAAe6Y,KAC9D6+C,GAAuC3+D,KAAK8f,GAAW,IAEzD6+C,GAAuC3+D,KAAK8f,GAAShf,KAAK,CAACjF,SAAS8T,EAAK3B,cAAewR,IAE5F,CAAC,OAAArhB,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CAWD,IATAg9D,IAAsD,GA5HK,KA8HzDn/C,GAAc,IAGZA,GAAem/C,GAAqD,GAAM,WACtEthE,EAAU,EAAGkhE,GAAqC5+D,KAAKQ,UAAUu+D,MAGrEl/C,EAAa,KACqC5P,EADrCC,EAAA1O,GACMs9D,IAA+B,IAApD,IAAA5uD,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAsD,KAA3Cse,EAAMhQ,EAAA9R,MACT+hB,EAAU,KAAKD,KAAUq0B,IACzBl0C,EAAO2+D,GAAuC3+D,KAAK8f,GACnDG,EAAY,CAAC,EACbC,QAAqB9hB,EAAU,EAAG0hB,GACxC,GAAII,EAAc,CAChB,IAAMC,EAAqBvgB,KAAKC,MAAMqgB,GAChCo/C,EAAWP,GAA2B/+D,GACtCu/D,EAAcN,GAA6B9+C,EAAmBrgB,MAAOw/D,GAC3Er/C,EAAUngB,MAAQy/D,EAClB,IAAMC,EAAgBhjD,GAAkB+iD,GACxCt/C,EAAU9f,IAAMq/D,EAAc,GAC9Bv/C,EAAU/f,IAAMs/D,EAAc,GAC9Bv/C,EAAUxkB,IAAMy4C,EAChBj0B,EAAU7Y,UAAY+Y,EAAmB/Y,UACzC6Y,EAAUpO,GAAKgO,CACjB,KAAO,CACL,IAAMy/C,EAAWP,GAA2B/+D,GAC5CigB,EAAUngB,MAAQw/D,EAClB,IAAMG,EAAajjD,GAAkB8iD,GACrCr/C,EAAU9f,IAAMs/D,EAAW,GAC3Bx/C,EAAU/f,IAAMu/D,EAAW,GAC3Bx/C,EAAUxkB,IAAMy4C,EAChBj0B,EAAU7Y,UAAYoY,EACtBS,EAAUpO,GAAKgO,CACjB,OACMviB,EAAU,EAAGwiB,EAASlgB,KAAKQ,UAAU6f,UACrCxhB,EAAa,EAAG+/D,GACxB,CAAC,OAAArgE,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACD68D,IAA4C,CAC9C,CACF,CACF,GAAC94C,GAAAhoB,MAAA,KAAA7D,UAAA,CAyCA,SAAA4lE,KAAA,OAAAA,IAAA9hE,EAAAA,EAAAA,GAvCM,YACL,IAIsB0Y,EAJhBpV,EAAM,IAAIhI,KACVsmB,EAAmBte,EAAIzG,UACvBy5C,EAAahzC,EAAIkxB,SACc1b,EAAAtV,SAAlBtC,EAAe,IACZ,IAAtB,IAAA4X,EAAArV,MAAAiV,EAAAI,EAAApV,KAAAC,MAAwB,KAAbzD,EAAGwY,EAAAvY,MACNyD,QAAapD,EAAU,EAAGN,GAC1B2D,EAAS7B,KAAKC,MAAM2B,GACpBif,EAAShf,EAAOoQ,GACtB,IAAK,IAAMiO,KAAWre,EAAOzB,KAAM,CACjC,IAAM0gB,EAAejf,EAAOzB,KAAK8f,GAC3BG,EAAY,CAAC,EACbC,QAAqB9hB,EAAU,EAAG0hB,GAClCD,EAAShkB,SAASikB,EAAQa,MAAM,KAAK,IAC3C,GAAIT,EAAc,CAChB,IAAMC,EAAqBvgB,KAAKC,MAAMqgB,GAChCo/C,EAAWP,GAA2Br+C,GACtC6+C,EAAcN,GAA6B9+C,EAAmBrgB,MAAOw/D,GAC3Er/C,EAAUngB,MAAQy/D,EAClB,IAAMI,EAAcnjD,GAAkB+iD,GACtCt/C,EAAU9f,IAAMw/D,EAAY,GAC5B1/C,EAAU/f,IAAMy/D,EAAY,GAC5B1/C,EAAUxkB,IAAM0kB,EAAmB1kB,IACnCwkB,EAAU7Y,UAAY+Y,EAAmB/Y,UACzC6Y,EAAUpO,GAAKgO,CACjB,KAAO,CACL,IAAMy/C,EAAWP,GAA2Br+C,GAC5CT,EAAUngB,MAAQw/D,EAClB,IAAMK,EAAcnjD,GAAkB8iD,GACtCr/C,EAAU9f,IAAMw/D,EAAY,GAC5B1/C,EAAU/f,IAAMy/D,EAAY,GAC5B1/C,EAAUxkB,IAAMy4C,EAChBj0B,EAAU7Y,UAAYoY,EACtBS,EAAUpO,GAAKgO,CACjB,OACMviB,EAAU,EAAGwiB,EAASlgB,KAAKQ,UAAU6f,GAC7C,OACMxhB,EAAa,EAAGgiB,EACxB,CAAC,OAAAtiB,GAAAuY,EAAA/U,EAAAxD,EAAA,SAAAuY,EAAA9U,GAAA,CACH,IAACjE,MAAA,KAAA7D,UAAA,CAaA,SAAA8lE,KAAA,OAAAA,IAAAhiE,EAAAA,EAAAA,GAXM,YACL,IAEsBmiB,EADhBnf,EAAuC,GAAGof,EAAA5e,SAD7BtC,EAAe,IAEZ,IAAtB,IAAAkhB,EAAA3e,MAAA0e,EAAAC,EAAA1e,KAAAC,MAAwB,KAAbzD,EAAGiiB,EAAAhiB,MACNyD,QAAapD,EAAU,EAAGN,GAChC,GAAI0D,EAAM,CACR,IAAMC,EAAS7B,KAAKC,MAAM2B,GAC1BZ,EAAOE,KAAKW,EACd,CACF,CAAC,OAAAtD,GAAA6hB,EAAAre,EAAAxD,EAAA,SAAA6hB,EAAApe,GAAA,CACD,OAAOhB,CACT,IAACjD,MAAA,KAAA7D,UAAA,CAlKDykE,GAA+B97D,UAAY,SAAUd,GACnD,IAAA0E,GAAAC,EAAAA,EAAAA,GAAyB3E,EAAE3B,KAAI,GAAxBY,EAAMyF,EAAA,GAAEF,EAAME,EAAA,GACjBw4D,GAAsC14D,KACxC04D,GAAsC14D,GAAQvF,UACvCi+D,GAAsC14D,GAEjD,EAGAo4D,GAA+B57D,QAAU,SAAUhB,GAEnD,EAyJA,IACIk+D,GADEC,GAAoC,CAAC,EAI3C,GAA4B,oBAAjBj6D,aAA8B,CACvC,IAAMmb,GAA4B,IAAInb,aAAa,IAAI1D,IAAI,oBAC3D09D,GAAyB7+C,GAA0Brb,MAC5BI,OACzB,KAAO,CACL,IAAMkb,GAAsB,IAAI/e,OAAO,IAAIC,IAAI,mBAC/C09D,GAAyB5+C,EAC3B,CAgBO,SAAe2f,GAAkBpjC,EAAAC,GAAA,OAAAsiE,GAAApiE,MAAC,KAAD7D,UAAA,CAcvC,SAAAimE,KAAA,OAAAA,IAAAniE,EAAAA,EAAAA,GAdM,UAAkC6iC,EAAoBC,GAC3D,IAAMv6B,EAASC,KAET+tB,QAA0B5C,KAC1ByuC,QA5CD,WAA2C,OAAAJ,GAAAjiE,MAAC,KAAD7D,UAAA,CA4CTmmE,GASvC,aAPqB,IAAI39D,QAAQ,SAACC,EAASC,GACzCs9D,GAAkC35D,GAAU5D,EAC5Cs9D,GAAuBl9D,QAAU,SAAUhB,GACzCa,EAAOb,EAAEiB,QACX,EACAi9D,GAAuBh9D,YAAY,CAACsxB,EAAmB6rC,EAA0Bv/B,EAAYC,EAAav6B,GAC5G,EAEF,GAAC45D,GAAApiE,MAAA,KAAA7D,UAAA,CA3BD+lE,GAAuBp9D,UAAY,SAAUd,GAC3C,IAAAu+D,GAAA55D,EAAAA,EAAAA,GAAyB3E,EAAE3B,KAAI,GAAxBY,EAAMs/D,EAAA,GAAE/5D,EAAM+5D,EAAA,GACjBJ,GAAkC35D,KACpC25D,GAAkC35D,GAAQvF,UACnCk/D,GAAkC35D,GAE7C,EAGA05D,GAAuBl9D,QAAU,SAAUhB,GAE3C,E8DlPA,IAAMw+D,GAAYl8D,EAAsB,OAClC+kB,GAAkBzkB,EAAqB47D,GAAW,OAClDC,GAAkB77D,EAAqB47D,GAAW,OAClDE,GAAqB97D,EAAqB67D,GAAiB,OAC3DE,GAAyB/7D,EAAqBykB,GAAiB,WAEjEixB,GAAsB,CAAC,EACvBxhC,IAA6B,EAC7BD,IAAkC,EAGlC+nD,GAA2C,KAC3CC,GAA0C,IAC1CC,GAA8C,KAC9CC,IAAuC,EACvCC,GAAyC,EACzCC,GAAyC,EACzCC,GAA+C,GAC/CC,IAA0C,EAC1CC,IAAyC,EACzCC,IAA6C,EAEjD,SAAS5zC,KAEP,IAAMC,EAAclpB,SAAS8T,cAAc,OAC3CoV,EAAYroB,UAAUkT,IAAI,MAC1BmV,EAAY9T,aAAa,OAAQ,QAGjC,IAAMvB,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYZ,GAAe,gBAGvC,IAAMyV,EAAiBrpB,SAAS8T,cAAc,OAC9CuV,EAAexoB,UAAUkT,IAAI,MAG7B,IAAMwV,EAAcvpB,SAAS8T,cAAc,OAC3CyV,EAAY1oB,UAAUkT,IAAI,MAG1B,IAAMyV,EAAiBxpB,SAAS8T,cAAc,OAC9C0V,EAAe3oB,UAAUkT,IAAI,MAG7B,IAAM4X,EAAgB3rB,SAAS8T,cAAc,OAC7C6X,EAAc9qB,UAAUkT,IAAI,MAE5B,IAAM2jC,EAAmB13C,SAAS8T,cAAc,OAChD4jC,EAAiB72C,UAAUkT,IAAI,MAC/B2jC,EAAiBtiC,aAAa,OAAQ,KACtCsiC,EAAiBtiC,aAAa,YAAa,SAE3C,IAAMuiC,EAAsB33C,SAAS8T,cAAc,OACnD6jC,EAAoB92C,UAAUkT,IAAI,MAClC4jC,EAAoBviC,aAAa,OAAQ,KACzCuiC,EAAoBviC,aAAa,YAAa,QAE9CuW,EAAcnX,YAAYkjC,GAC1B/rB,EAAcnX,YAAYmjC,GAG1B,IAAMmlB,EAAgB98D,SAAS8T,cAAc,OAC7CgpD,EAAcj8D,UAAUkT,IAAI,MAC5B+oD,EAActoD,YAAYZ,GAAe,yBAGzC,IAAMqlC,EAA0Bj5C,SAAS8T,cAAc,OAcvD,OAbAmlC,EAAwBp4C,UAAUkT,IAAI,MAGtCyV,EAAehV,YAAYmX,GAC3BnC,EAAehV,YAAYsoD,GAC3BtzC,EAAehV,YAAYykC,GAG3B/vB,EAAY1U,YAAYX,GACxBqV,EAAY1U,YAAY6U,GACxBH,EAAY1U,YAAY+U,GACxBL,EAAY1U,YAAYgV,GAEjB,CACLnpB,QAAS6oB,EACTxb,GAAI,GAER,CAEA,SAASqvD,KAEP,IAAMC,EAAgBh9D,SAAS8T,cAAc,OAC7CkpD,EAAcn8D,UAAUkT,IAAI,MAG5B,IAAM8jC,EAAc73C,SAAS8T,cAAc,OAC3C+jC,EAAYh3C,UAAUkT,IAAI,MAG1B,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYP,MAGxB,IAAMyX,EAAc1rB,SAAS8T,cAAc,OAC3C4X,EAAY7qB,UAAUkT,IAAI,MAG1B8jC,EAAYrjC,YAAYX,GACxBgkC,EAAYrjC,YAAYkX,GAGxB,IAAMuxC,EAAiBj9D,SAAS8T,cAAc,OAO9C,OANAmpD,EAAep8D,UAAUkT,IAAI,MAG7BipD,EAAcxoD,YAAYqjC,GAC1BmlB,EAAcxoD,YAAYyoD,GAEnB,CACL58D,QAAS28D,EACTtvD,GAAI,GAER,CAOA,SAASsX,GAAmC9e,GAC1C,IAAMC,EAAcD,EACpB,GAAIy2D,GAAgC,CAClC,IAAMvlB,EAAcjxC,EAAYC,OAAOnC,SAAW,EAClDk4D,GAAuBj3C,MAAMC,YAAY,OAA6CiyB,EAAY5mB,WACpG,CACiC,QAA7BrqB,EAAYC,OAAOL,OACrB/F,SAASolB,oBAAoBjf,EAAYC,OAAOH,OAAQ+e,GAE5D,CAEO,SAASk4C,KASd,IARA,IAAMnmD,EAAoBzV,GAAsB,qBAC1C27C,EAAa9N,GAAU,UAEvBgO,GADaF,EAAWt/C,MACVs/C,EAAWr/C,QACzBtC,EAAgB9E,KAAKC,MAAM0mD,EAAc,GAAK,GAAK,EAGnD39B,EAAwC,GACrC9iB,EAAI,EAAGA,EAHO,EAGaA,IAAK,CAUvC,IATA,IAAMijB,EAA2B,CAC/BtoB,KAAM,GACNqY,KAAM,GACNhC,GAAI,GACJzK,UAAW,EACX6c,QAAS,GACTxkB,cAAeA,GAGR8P,EAAI,EAAGA,EAAI9P,EAAe8P,IAAK,CAsBtCuU,EAAOG,QAAQnjB,KArBgC,CAC7CiI,KAAM,OACN8I,GAAI,EACJzK,UAAW,EACX5L,KAAM,GACNkM,OAAQ,CACNhM,KAAM,EACNuS,KAAM,GACNzT,MAAO,GAET6sB,UAAW,EACX9B,MAAO,CACL/pB,KAAM,GACN8rB,UAAW,CACTC,UAAW,GACXC,YAAa,IAEf3V,GAAI,EACJ2T,gBAAiB,KAIvB,CACA7B,EAAQ7iB,KAAKgjB,EACf,CAEAw9C,GACE,CACE39C,QAASA,EACTlZ,eAAgB,IAElB,EACAyQ,EAEJ,CAEA,SAASomD,GAAqBlmD,EAAgCtC,EAAyBC,GACrF,SAASimC,EAAW/lC,EAA0BrH,EAAmCqtC,GAC/E,SAASsiB,EAAWtoD,EAA0BrH,GAC5CqH,EAAYM,aAAa,OAAQ3H,EAAS7I,KAC5C,CAEA,SAASqQ,EAAWH,EAA0BrH,GAC5C,IAAM4vD,EAAkBj9D,EAAqB0U,EAAa,OACtDpF,EAAO,GACX,OAAQjC,EAAS7I,MACf,IAAK,OAML,IAAK,WACH8K,EAAO,cACP,MALF,IAAK,QACHA,EAAO,QACP,MAIF,IAAK,MACHA,EAAO,iBACP,MACF,IAAK,QACHA,EAAO,YACP,MACF,QACEA,EAAO,GAGXwE,GAAQmpD,EAAiB3tD,EAC3B,CAEA,SAASqrC,EAAajmC,EAA0BrH,EAAmCmH,GACjF,GAAsB,SAAlBnH,EAAS7I,KAAiB,CAC5B,IAAM2/C,EAAkBzvC,EAAYyjC,wBAC9BI,EAAM4L,EAAgB5L,IACtB4C,EAAOgJ,EAAgBhJ,KACvBC,EAAS+I,EAAgB/I,OACzBC,EAAQ8I,EAAgB9I,MACxBC,EAAc1iB,OAAO2iB,WACrBC,EAAe5iB,OAAO6iB,YAEtBV,EAAwB/6C,EAAqB0U,EAAa,WAC1D4iC,EAAmBt3C,EAAqB+6C,EAAuB,OAC/DxD,EAAsBv3C,EAAqB+6C,EAAuB,OAExEzD,EAAiBtiC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC3DknB,EAAiB1jC,UAAYvG,EAASlK,OAAOuG,KAEzC8K,GAAa4mC,EAAS,GAAK7C,EAAMiD,GAAgBH,EAAQ,GAAKF,EAAOG,GACvE/D,EAAoBtyB,iBAClB,eACA,WACEsyB,EAAoBviC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC9DmnB,EAAoB3jC,UAAYvG,EAASlK,OAAOuG,KAChD6tC,EAAoB92C,UAAUqV,OAAO,MACrCwhC,EAAiBtiC,aAAa,YAAa,QAC7C,EACA,CAAEkQ,MAAM,IAEVoyB,EAAiBtiC,aAAa,YAAa,QAC3CuiC,EAAoB92C,UAAUkT,IAAI,QAElC4jC,EAAoBviC,aAAa,OAAQ3H,EAASlK,OAAOhM,KAAKi5B,YAC9DmnB,EAAoB3jC,UAAYvG,EAASlK,OAAOuG,KAEpD,CACF,CAEA,SAASyoD,EAAWz9C,EAA0BrH,GAC5C,IAAI2b,EAAe,GACnB,OAAQ3b,EAAS7I,MACf,IAAK,OAGL,IAAK,QAGL,IAAK,WACHwkB,EAAO3b,EAASpW,KAChB,MACF,IAAK,MACH+xB,EAAO3b,EAAS6vD,MAChB,MACF,IAAK,QACHl0C,EAAO,OACP,MACF,QACEA,EAAO,OAGXhpB,EAAqB0U,EAAa,OAA8Bd,UAAYoV,CAC9E,CAEA,SAASopC,EAAc19C,EAA0BrH,GAC/C,IAAI0b,EAAkB,GACtB,OAAQ1b,EAAS7I,MACf,IAAK,OACHukB,EAAU,GAAG1b,EAAS2T,MAAQ3T,EAAS2T,MAAM/pB,KAAO,SAASoW,EAAS2T,MAAQ,CAAC3T,EAAS2T,MAAM+B,UAAUE,YAAa5V,EAAS2T,MAAM+B,UAAUC,UAAW,IAAI3V,EAASyV,UAAYzV,EAASyV,UAAY,GAAK,KAC5M,MACF,IAAK,QACHiG,EAAU,GAAG1b,EAAS0V,UAAUC,eAAoB3V,EAAS0V,UAAUE,cACvE,MACF,IAAK,WACH8F,EAAU,KACV,MACF,IAAK,MAEH,MACF,IAAK,QACHA,EAAU,KACV,MACF,QACEA,EAAU,OAGd/oB,EAAqB0U,EAAa,OAAiCd,UAAYmV,CACjF,CAEA,SAASo0C,EAAazoD,EAA0BrH,GAC9C,IAAMqvD,EAAgB18D,EAAqB0U,EAAa,WACxD,OAAQrH,EAAS7I,MACf,IAAK,OACHk4D,EAAcj3C,QAAU,WACtBu5B,GAAU3xC,EAAS2T,MAAM1T,GAAID,EAAS2T,MAAMC,gBAC9C,EACA,MACF,IAAK,QACHy7C,EAAcj3C,QAAU,WACtBu5B,GAAU3xC,EAASC,GAAID,EAAS4T,gBAClC,EACA,MACF,IAAK,WACHy7C,EAAcj3C,QAAU,WACtBu6B,GAAa3yC,EAASC,GACxB,EASN,CAEA,SAASyH,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEA,GAAImmC,QACFsiB,EAAWtoD,EAAarH,GACxBwH,EAAWH,EAAarH,GACxBstC,EAAajmC,EAAarH,EAAUmH,GACpC29C,EAAWz9C,EAAarH,GACxB+kD,EAAc19C,EAAarH,GAC3B8vD,EAAazoD,EAAarH,GAC1B0H,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,QAElC,GAAIlH,EAAS7I,OAASk2C,EAAal2C,KACjCw4D,EAAWtoD,EAAarH,GACxBwH,EAAWH,EAAarH,GACxBstC,EAAajmC,EAAarH,EAAUmH,GACpC29C,EAAWz9C,EAAarH,GACxB+kD,EAAc19C,EAAarH,GAC3B8vD,EAAazoD,EAAarH,GAC1B0H,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,OAC7B,CACL,OAAQlH,EAAS7I,MACf,IAAK,OACE0Q,GAAcwlC,EAAa15B,MAAO3T,EAAS2T,SAC9CoxC,EAAc19C,EAAarH,GAC3B8vD,EAAazoD,EAAarH,IAExBqtC,EAAazjD,OAASoW,EAASpW,MACjCk7D,EAAWz9C,EAAarH,GAEtBqtC,EAAav3C,OAAOlN,OAASoX,EAASlK,OAAOlN,MAC/C0kD,EAAajmC,EAAarH,EAAUmH,GAEtC,MACF,IAAK,QACCkmC,EAAaptC,KAAOD,EAASC,IAC/B6vD,EAAazoD,EAAarH,GAEvB6H,GAAcwlC,EAAa33B,UAAW1V,EAAS0V,YAClDqvC,EAAc19C,EAAarH,GAEzBqtC,EAAazjD,OAASoW,EAASpW,MACjCk7D,EAAWz9C,EAAarH,GAE1B,MACF,IAAK,WACCqtC,EAAaptC,KAAOD,EAASC,IAC/B6vD,EAAazoD,EAAarH,GAExBqtC,EAAazjD,OAASoW,EAASpW,MACjCk7D,EAAWz9C,EAAarH,GAO1B,MACF,IAAK,MAgBL,QACE,MAPF,IAAK,QACCA,EAAS7I,OAASk2C,EAAal2C,OACjC4tD,EAAc19C,EAAarH,GAC3B8kD,EAAWz9C,EAAarH,IAM1BkH,IAAmBN,IACrBgB,EAAqBP,EAAaH,GAEhCC,IAAcN,IAChBa,EAAgBL,EAAaF,EAEjC,CAEJ,CAEA,SAAS0J,EAAaxJ,EAA0BgK,EAAoB0+C,GAClE,SAASzhB,EAAWjnC,EAA0BgK,GAC5C,IAAM0lC,EAAkBpkD,EAAqB0U,EAAa,OAClC1U,EAAqBokD,EAAiB,OAC9CxwC,UAAY8K,EAAWznB,IACzC,CAEA,SAAS4d,EAAWH,EAA0BgK,GAC5C,IAAM0lC,EAAkBpkD,EAAqB0U,EAAa,OAE1DZ,GADwB9T,EAAqBokD,EAAiB,OACrC1lC,EAAWpP,KACtC,CAEA,SAASyF,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEI6oD,SACFzhB,EAAWjnC,EAAagK,GACxB7J,EAAWH,EAAagK,GACxB3J,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,KAE9BmK,EAAWznB,OAASmmE,EAAenmE,MACrC0kD,EAAWjnC,EAAagK,GAEtBA,EAAWpP,OAAS8tD,EAAe9tD,MACrCuF,EAAWH,EAAagK,GAEtBlK,IAAcN,IAChBa,EAAgBL,EAAaF,GAE3BD,IAAmBN,IACrBgB,EAAqBP,EAAaH,GAGxC,CAEA,IAAM6K,EAAUvI,EAAYuI,QACtBi+C,EAAgBj+C,EAAQ5pB,OAExB8nE,EAAwBp9D,EAAwB47D,GAAoB,OAAoBtmE,OAC9F,GAAI6nE,IAAkBC,EAAuB,CAC3C,IAAMhoD,EAAagoD,EAAwBD,EAC3C,GAAI/nD,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAM8nD,EAAmBZ,KACzBpnD,EAASnB,YAAYmpD,EAAiBt9D,QACxC,CACA67D,GAAmBlmD,OAAOL,EAC5B,MAEE,IADA,IAAMioD,EAAiBt9D,EAAwB47D,GAAoB,OAC1DrmD,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpD+nD,EADoBF,EAAwB,EAAI7nD,GACpBK,QAC9B,CAEJ,CAGA,IADA,IAAM0nD,EAAiBt9D,EAAwB47D,GAAoB,OAC1Dx/D,EAAI,EAAGA,EAAI+gE,EAAe/gE,IAAK,CACtC,IAEMmhE,EAFar+C,EAAQ9iB,GACUojB,QACalqB,OAE5CkoE,EAA2B19D,EADPw9D,EAAelhE,GACgC,OACnEyhD,EAAsB79C,EAAwBw9D,EAA0B,OAAyBloE,OACvG,GAAIioE,IAA4B1f,EAAqB,CACnD,IAAMzoC,EAAayoC,EAAsB0f,EACzC,GAAInoD,EAAa,EACf,IAAK,IAAIG,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAMiW,EAAiB7C,KACvB60C,EAAyBtpD,YAAYsX,EAAezrB,QACtD,MAGA,IADA,IAAM09D,EAA4Bz9D,EAAwBw9D,EAA0B,OAC3EjoD,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpDkoD,EADkB5f,EAAsB,EAAItoC,GACPK,QACvC,CAEJ,CACF,CAGA,IADA,IAAM8nD,EAAkB19D,EAAwB47D,GAAoB,OAC3Dx/D,EAAI,EAAGA,EAAI+gE,EAAe/gE,IAAK,CACtC,IAAMoiB,EAAaU,EAAQ9iB,GACrBuhE,EAAoBn/C,EAAWgB,QAC/B+9C,EAA0BI,EAAkBroE,OAC5CsoE,EAAoBF,EAAgBthE,GACpCohE,EAA2B19D,EAAqB89D,EAAmB,OACzE,GAAIpoB,GAAoBhzC,eAAe,WACrC,GAAIgzC,GAAoBt2B,QAAQ9iB,GAE9B4hB,EAAa4/C,EAAmBp/C,EADTg3B,GAAoBt2B,QAAQ9iB,SAGnD4hB,EAAa4/C,EAAmBp/C,EAAY,WAG9CR,EAAa4/C,EAAmBp/C,EAAY,MAI9C,IADA,IAAMq/C,EAAyB79D,EAAwBw9D,EAA0B,OACxE1yD,EAAI,EAAGA,EAAIyyD,EAAyBzyD,IAAK,CAChD,IAAM0J,EAAcqpD,EAAuB/yD,GACrCqC,EAAWwwD,EAAkB7yD,GACnC,GAAI0qC,GAAoBhzC,eAAe,WACrC,GAAIgzC,GAAoBt2B,QAAQ9iB,GAC9B,GAAIo5C,GAAoBt2B,QAAQ9iB,GAAGojB,QAAQ1U,GAEzCyvC,EAAW/lC,EAAarH,EADHqoC,GAAoBt2B,QAAQ9iB,GAAGojB,QAAQ1U,SAG5DyvC,EAAW/lC,EAAarH,EAAU,WAGpCotC,EAAW/lC,EAAarH,EAAU,WAGpCotC,EAAW/lC,EAAarH,EAAU,KAEtC,CACF,CAEAqoC,GAAsB7+B,EACtB3C,GAAoBM,EACpBP,GAAyBM,CAC3B,CAAC,SAEcypD,KAAc,OAAAC,GAAA7kE,MAAC,KAAD7D,UAAA,UAAA0oE,KA0B5B,OA1B4BA,IAAA5kE,EAAAA,EAAAA,GAA7B,YACE,IAAMsd,EAAoBzV,GAAsB,qBAC1Cif,EAA2Bjf,GAAsB,oBACvDi7D,GAA8Bh8C,EAAyBe,QACvD86C,GAAmC77C,EAAyBw+B,aAC5D4d,IAAiC,EACjCD,GAAuCz6D,KACvCk6D,GAAuB/mD,aAAa,aAAc,QAClD+mD,GAAuBt7D,UAAUqV,OAAO,MACxClW,SAASqlB,iBAAiBq3C,GAAsC13C,IAChE,IAAM/N,Q/DxRD,SAA+Brc,GAAA,OAAAulB,GAAA3mB,MAAC,KAAD7D,UAAA,C+DwRV2oE,CAAiB5B,IAC3CS,GAAqBlmD,GAAa,EAAOF,GACzC,IAAIkoC,EAAa,EACbsd,KACFtd,QAAmBliC,MAErBy/C,IAAiC,IAAIznE,MAAOuB,UAE1CmmE,GADEF,GAC+B/lE,KAAKuF,IAAIygE,GAAiCH,GAAiCplD,EAAY3Q,eAAiB81D,GAAmCnd,GAE3Iud,GAAiCJ,GAEpEE,GAAsC9lE,KAAKuF,IAAIsgE,GAAiCI,GAAiCD,IACjHG,IAAiC,EACjCR,GAAuB/mD,aAAa,aAAc,SApdlD+mD,GAAuBj3C,MAAMC,YAAY,OAAyC,GAAGm3C,QACrFH,GAAuBt7D,UAAUkT,IAAI,KAqdvC,GAACsqD,GAAA7kE,MAAA,KAAA7D,UAAA,UAEc4oE,KAAa,OAAAC,GAAAhlE,MAAC,KAAD7D,UAAA,UAAA6oE,KAyB3B,OAzB2BA,IAAA/kE,EAAAA,EAAAA,GAA5B,YACE2kE,KACGl0C,KAAK,WACA0yC,GACFzd,WACE,WACEof,IACF,EACA/nE,KAAKuF,IAAIsgE,GAAiCI,IAAiC,IAAI1nE,MAAOuB,YAGxFumE,IAAoC,CAExC,GAAE,MACK,SAAC7iE,GAEF4iE,IACF30C,GAAc,QAAS,uBACvBk3B,WAAW,WACTof,IACF,EA/lBwC,MAimBxC1B,IAAoC,CAExC,EACJ,IAACrjE,MAAA,KAAA7D,UAAA,CChnBD,IACMsmE,GAAkB77D,EADNN,EAAsB,OACgB,OAClD2+D,GAAmBr+D,EAAqB67D,GAAiB,OACzDyC,GAA4Bt+D,EAAqBq+D,GAAkB,OAErE3oB,GAAsB,CAAC,EACvBxhC,IAA6B,EAC7BD,IAAkC,EAGlCsqD,GAA+C,KAC/CC,GAA8C,IAE9CC,IAA2C,EAC3CC,IAA6C,EAC7CC,GAA6C,EAC7CC,GAA6C,EAE7CC,GAAmD,GACnDC,IAAiD,EAGrD,SAASC,KAEP,IAAMC,EAAyBp/D,SAAS8T,cAAc,OACtDsrD,EAAuBv+D,UAAUkT,IAAI,MAGrC,IAAM8jC,EAAc73C,SAAS8T,cAAc,OAC3C+jC,EAAYh3C,UAAUkT,IAAI,MAG1B,IAAMF,EAAc7T,SAAS8T,cAAc,OAC3CD,EAAYhT,UAAUkT,IAAI,MAC1BF,EAAYW,YAAYP,MAGxB,IAAMorD,EAAer/D,SAAS8T,cAAc,OAC5CurD,EAAax+D,UAAUkT,IAAI,MAG3B,IAAMurD,EAAct/D,SAAS8T,cAAc,OAC3CwrD,EAAYz+D,UAAUkT,IAAI,MAG1B8jC,EAAYrjC,YAAYX,GACxBgkC,EAAYrjC,YAAY6qD,GACxBxnB,EAAYrjC,YAAY8qD,GAGxB,IAAM5zC,EAAc1rB,SAAS8T,cAAc,OAO3C,OANA4X,EAAY7qB,UAAUkT,IAAI,MAG1BqrD,EAAuB5qD,YAAYqjC,GACnCunB,EAAuB5qD,YAAYkX,GAE5B,CACLrrB,QAAS++D,EACT1xD,GAAI,GAER,CAEA,SAAS6xD,GAAuBtoD,EAAoCtC,EAAyBC,GAC3F,SAASimC,EAAW/lC,EAA0BrH,EAAgCqtC,GAC5E,SAAS7lC,EAAWH,EAA0BrH,GAC5C,IAAM+2C,EAAkBpkD,EAAqB0U,EAAa,OACpDuoD,EAAkBj9D,EAAqBokD,EAAiB,OAC1D90C,EAAO,GACX,OAAQjC,EAAS7I,MACf,IAAK,QACH8K,EAAO,QACP,MACF,IAAK,WACHA,EAAO,cACP,MACF,IAAK,MACHA,EAAO,iBACP,MACF,IAAK,QACHA,EAAO,YAKXwE,GAAQmpD,EAAiB3tD,EAC3B,CAEA,SAAS8vD,EAAY1qD,EAA0BrH,GAC7C,IAAM4xD,EAAej/D,EAAqB0U,EAAa,WACnDk6B,EAAQ,GACZ,OAAQvhC,EAAS7I,MACf,IAAK,QACHoqC,EAAQ,KACR,MACF,IAAK,WACHA,EAAQ,KACR,MACF,IAAK,MACHA,EAAQ,KACR,MACF,IAAK,QACHA,EAAQ,KAKZqwB,EAAarrD,UAAYg7B,CAC3B,CAEA,SAASywB,EAAW3qD,EAA0BrH,GACxBrN,EAAqB0U,EAAa,WAC1Cd,UAAYvG,EAASpX,KAAKyc,QACxC,CAEA,SAASipC,EAAWjnC,EAA0BrH,GACxBrN,EAAqB0U,EAAa,OAC1Cd,UAAYvG,EAASpW,IACnC,CAEA,SAASspD,EAAc7rC,EAA0BrH,GAC/C,OAAQA,EAAS7I,MACf,IAAK,QACHkQ,EAAY+Q,QAAU,WACpBu5B,GAAU3xC,EAASC,GAAID,EAASP,IAClC,EACA,MACF,IAAK,WACH4H,EAAY+Q,QAAU,WACpBu6B,GAAa3yC,EAASI,KACxB,EACA,MACF,IAAK,MACHiH,EAAY+Q,QAAU,WACpBrP,GAAQ/I,EAASC,GACnB,EACA,MACF,IAAK,QACHoH,EAAY+Q,QAAU,KAK5B,CAEA,SAAS1Q,EAAgBL,EAA0BF,GACjDE,EAAYM,aAAa,YAAa+qB,GAAgBvrB,GACxD,CAEA,SAASS,EAAqBP,EAA0BH,GACtDG,EAAYM,aAAa,kBAAmB+qB,GAAgBxrB,GAC9D,CAEA,GAAImmC,QACF7lC,EAAWH,EAAarH,GACxB+xD,EAAY1qD,EAAarH,GACzBgyD,EAAW3qD,EAAarH,GACxBsuC,EAAWjnC,EAAarH,GACxBkzC,EAAc7rC,EAAarH,GAC3B0H,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,QAElC,GAAIlH,EAAS7I,OAASk2C,EAAal2C,KACjCqQ,EAAWH,EAAarH,GACxB+xD,EAAY1qD,EAAarH,GACzBgyD,EAAW3qD,EAAarH,GACxBsuC,EAAWjnC,EAAarH,GACxBkzC,EAAc7rC,EAAarH,GAC3B0H,EAAgBL,EAAaF,GAC7BS,EAAqBP,EAAaH,OAC7B,CACL,OAAQlH,EAAS7I,MACf,IAAK,WACE0Q,GAAcwlC,EAAazjD,KAAMoW,EAASpW,OAC7C0kD,EAAWjnC,EAAarH,GAEtBqtC,EAAazkD,OAASoX,EAASpX,MACjCopE,EAAW3qD,EAAarH,GAErB6H,GAAcwlC,EAAajtC,KAAMJ,EAASI,OAC7C8yC,EAAc7rC,EAAarH,GAE7B,MACF,IAAK,QACE6H,GAAcwlC,EAAazjD,KAAMoW,EAASpW,OAC7C0kD,EAAWjnC,EAAarH,GAEtBqtC,EAAazkD,OAASoX,EAASpX,MACjCopE,EAAW3qD,EAAarH,GAErB6H,GAAcwlC,EAAaptC,GAAID,EAASC,KAAQ4H,GAAcwlC,EAAa5tC,IAAKO,EAASP,MAC5FyzC,EAAc7rC,EAAarH,GAE7B,MACF,IAAK,MACE6H,GAAcwlC,EAAazjD,KAAMoW,EAASpW,OAC7C0kD,EAAWjnC,EAAarH,GAEtBqtC,EAAazkD,OAASoX,EAASpX,MACjCopE,EAAW3qD,EAAarH,GAErB6H,GAAcwlC,EAAaptC,GAAID,EAASC,KAC3CizC,EAAc7rC,EAAarH,GAE7B,MACF,IAAK,QACCqtC,EAAazkD,OAASoX,EAASpX,MACjCopE,EAAW3qD,EAAarH,GAM1BmH,IAAcN,IAChBa,EAAgBL,EAAaF,GAE3BD,IAAmBN,IACrBgB,EAAqBP,EAAaH,EAEtC,CAEJ,CAEA,IAAMrC,EAAe2E,EAAY3E,aAE3B6rC,EAAsB79C,EAAwBo+D,GAA2B,OAA+B9oE,OAC9G,GAAI0c,IAAiB6rC,EAAqB,CACxC,IAAMzoC,EAAayoC,EAAsB7rC,EACzC,GAAIoD,EAAa,EAAG,CAElB,IADA,IAAMC,EAAW,IAAIC,iBACZC,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CACpD,IAAM6pD,EAA2BP,KACjCxpD,EAASnB,YAAYkrD,EAAyBr/D,QAChD,CACAq+D,GAA0B1oD,OAAOL,EACnC,MAEE,IADA,IAAMgqD,EAA0Br/D,EAAwBo+D,GAA2B,OAC1E7oD,EAAI,EAAGC,EAAItf,KAAKwY,IAAI0G,GAAaG,EAAIC,EAAGD,IAAK,CAEpD8pD,EAD4BxhB,EAAsB,EAAItoC,GACTK,QAC/C,CAEJ,CAGA,IADA,IAAMypD,EAA0Br/D,EAAwBo+D,GAA2B,OAC1EhiE,EAAI,EAAGA,EAAI4V,EAAc5V,IAAK,CACrC,IAAMoY,EAAc6qD,EAAwBjjE,GACtC+Q,EAAWwJ,EAAY5E,MAAM3V,GACnC,GAAIo5C,GAAoBhzC,eAAe,SACrC,GAAIgzC,GAAoBzjC,MAAM3V,GAE5Bm+C,EAAW/lC,EAAarH,EADHqoC,GAAoBzjC,MAAM3V,SAG/Cm+C,EAAW/lC,EAAarH,EAAU,WAGpCotC,EAAW/lC,EAAarH,EAAU,KAEtC,CAEAqoC,GAAsB7+B,EACtB3C,GAAoBM,EACpBP,GAAyBM,CAC3B,CAEO,SAASirD,KAKd,IAJA,IAAM7oD,EAAoBzV,GAAsB,qBAC1C27C,EAAa9N,GAAU,UACvBoQ,EAAsB/oD,KAAKC,MAAMwmD,EAAWr/C,OAAS,GAAK,GAAK,EAC/DyU,EAAqC,GAClC3V,EAAI,EAAGA,EAAI6iD,EAAqB7iD,IACvC2V,EAAM1V,KAAK,CACTiI,KAAM,QACN8I,GAAI,EACJR,IAAK,GACL7W,KAAM,CACJwc,SAAU,EACVC,SAAU,IAEZzb,KAAM,KAGVkoE,GACE,CACEltD,MAAOA,EACPC,aAAcD,EAAMzc,OACpB0Q,eAAgB,IAElB,EACAyQ,EAEJ,CAAC,SAEc8oD,KAAkB,OAAAC,GAAAtmE,MAAC,KAAD7D,UAAA,UAAAmqE,KAuBhC,OAvBgCA,IAAArmE,EAAAA,EAAAA,GAAjC,YACE,IAAMsd,EAAoBzV,GAAsB,qBAC1Cif,EAA2Bjf,GAAsB,oBACvDu9D,GAAkCt+C,EAAyBe,QAC3Dq9C,GAAuCp+C,EAAyBw+B,aAEhEkgB,GAA2Ch9D,KAE3C,IAAMgV,QxEvHD,SAAmC/c,GAAA,OAAAgY,GAAA1Y,MAAC,KAAD7D,UAAA,CwEuHdoqE,CAAqBd,IAC/CM,GAAuBtoD,GAAa,EAAOF,GAC3C,IAAIkoC,EAAa,EACb4f,KACF5f,QAAmBliC,MAErBgiD,IAAqC,IAAIhqE,MAAOuB,UAE9C0oE,GADEH,GACmCroE,KAAKuF,IAAIgjE,GAAqCH,GAAqC3nD,EAAY3Q,eAAiBq4D,GAAuC1f,GAEvJ8f,GAAqCJ,GAElCnoE,KAAKuF,IAAI6iE,GAAqCI,GAAqCD,GAG/H,GAACe,GAAAtmE,MAAA,KAAA7D,UAAA,UAEcqqE,KAAiB,OAAAC,GAAAzmE,MAAC,KAAD7D,UAAA,UAAAsqE,KAwB/B,OAxB+BA,IAAAxmE,EAAAA,EAAAA,GAAhC,YACEomE,KACG31C,KAAK,WACA40C,GAC8B3f,WAC9B,WACE6gB,IACF,EACAxpE,KAAKuF,IAAI6iE,GAAqCI,IAAqC,IAAIjqE,MAAOuB,YAGhG4oE,IAAwC,CAE5C,GAAE,MACK,SAACllE,GAEF8kE,GAC8B3f,WAAW,WACzC6gB,IACF,EAxU4C,KA0U5Cd,IAAwC,CAE5C,EACJ,IAAC1lE,MAAA,KAAA7D,UAAA,CC3VD,IAAMuqE,GAA+BpgE,EAAsB,OACrDqgE,GAAqC//D,EAAqB8/D,GAA8B,OACxFE,GAAgChgE,EAAqB+/D,GAAoC,OACzF3xC,GAAmBpuB,EAAqBggE,GAA+B,wCACvE3xC,GAAwBruB,EAAqBggE,GAA+B,8CAC5E1xC,GAAsBtuB,EAAqBggE,GAA+B,4CAC1EzxC,GAAsBvuB,EAAqBggE,GAA+B,kCAC1ExxC,GAActuB,EAAwBquB,GAAqB,OAwC1D,SAAS0xC,KAEdH,GAA6B9qD,aAAa,YAAa,SACvD0B,IACF,CC0IA,IAAIwpD,IAAiB,EACjBC,IAAyB,EAE7BvnC,OAAOijB,IAAM,CACXukB,WAAY,YACa,IAAnBF,KACFA,IAAiB,EACjB/Q,KhBqWC,WAAiC,OAAAwI,GAAAv+D,MAAC,KAAD7D,UAAA,CgBpWlC8qE,GAAqBv2C,KAAK,WACxB01C,KACA1C,Kd9ID,WAA8B,OAAA1P,GAAAh0D,MAAC,KAAD7D,UAAA,Cc+I7B+qE,GACGx2C,KAAK,SAAC3mB,GACL,GAAe,OAAXA,EAAiB,CrBpJ/BsyC,GAAmBxwB,iBACjB,aACA,WACE0wB,GAA4Bv/C,KAAKswB,MAAM+uB,GAAmBwJ,WAAalJ,GACzE,EACA,CAAEwqB,SAAS,IAGb9qB,GAAmBxwB,iBACjB,SACA,SAAUnf,GACRkwC,IAAuB,EACvB,IACMwqB,EADS16D,EAAMD,OACOo5C,WAAalJ,GAEvCH,GADE4qB,EAAe7qB,GACUA,GAA4B,EAE5BA,GAA4B,EAEzD,IAAM8qB,EAAkBD,EAAe7qB,GACnC+qB,EAAQtqE,KAAKwY,IAAI6xD,GACjBC,EAAQ,IACND,EAAkB,GACpB9qB,GAA4Bv/C,KAAKC,MAAMmqE,GACvC5qB,GAA2BD,GAA4B,IAEvDA,GAA4Bv/C,KAAKuqE,KAAKH,GACtC5qB,GAA2BD,GAA4B,GAEzD+qB,EAAQtqE,KAAKwY,IAAI4xD,EAAe7qB,KAElC,IAAMirB,EAAc9qB,GAAyB,KAAKH,OAAgC,CAAEp4C,MAAO,EAAGsmB,OAAQ,GAChGg9C,EAAa/qB,GAAyB,KAAKF,OAA+B,CAAEr4C,MAAO,EAAGsmB,OAAQ,GAC9Fi9C,EAAWF,EAAYrjE,OAASsjE,EAAWtjE,MAAQqjE,EAAYrjE,OAASmjE,EACxE78C,GAAoF,GAA1E+8C,EAAY/8C,QAAUg9C,EAAWh9C,OAAS+8C,EAAY/8C,QAAU68C,GAAwC,GAA1B3qB,GAA2C,GAAX+qB,EAC9HjqB,GAAehB,GAA4BhyB,EAAQi9C,EAtChC,GAsCuDN,GACtEA,IAAiB5qB,KACnBD,GAA4Bv/C,KAAKswB,MAAM+uB,GAAmBwJ,WAAalJ,IACvEC,IAAuB,EAE3B,EACA,CAAEuqB,SAAS,IE1Cbnf,GAAsBn8B,iBACpB,aACA,WACEy8B,GAA+BtrD,KAAKswB,MAAM06B,GAAsBnC,WAAa6C,GAC/E,EACA,CAAEye,SAAS,IAGbnf,GAAsBn8B,iBACpB,SACA,SAAUnf,GACRi8C,IAA0B,EAC1B,IACMye,EADS16D,EAAMD,OACOo5C,WAAa6C,GAEvCH,GADE6e,EAAe9e,GACaA,GAA+B,EAE/BA,GAA+B,EAE/D,IAAM+e,EAAkBD,EAAe9e,GACnCgf,EAAQtqE,KAAKwY,IAAI6xD,GACjBC,EAAQ,IACND,EAAkB,GACpB/e,GAA+BtrD,KAAKC,MAAMmqE,GAC1C7e,GAA8BD,GAA+B,IAE7DA,GAA+BtrD,KAAKuqE,KAAKH,GACzC7e,GAA8BD,GAA+B,GAE/Dgf,EAAQtqE,KAAKwY,IAAI4xD,EAAe9e,KAElC,IAAMkf,EAAc/e,GAA4B,KAAKH,OAAmC,CAAEnkD,MAAO,EAAGsmB,OAAQ,GACtGg9C,EAAahf,GAA4B,KAAKF,OAAkC,CAAEpkD,MAAO,EAAGsmB,OAAQ,GACpGi9C,EAAWF,EAAYrjE,OAASsjE,EAAWtjE,MAAQqjE,EAAYrjE,OAASmjE,EACxE78C,GAAoF,GAA1E+8C,EAAY/8C,QAAUg9C,EAAWh9C,OAAS+8C,EAAY/8C,QAAU68C,GAA2C,GAA7B5e,GAA8C,GAAXgf,EACjIne,GAAkBf,GAA+B/9B,EAAQi9C,EAtCtC,GAsC6DN,GAC5EA,IAAiB7e,KACnBD,GAA+BtrD,KAAKswB,MAAM06B,GAAsBnC,WAAa6C,IAC7EC,IAA0B,EAE9B,EACA,CAAEwe,SAAS,ImB+GDxX,KACAnwB,OAAO3T,iBAAiB,SAAU,WAChC8jC,IACF,GACIgY,QACEA,OAAOC,aACTD,OAAOC,YAAY/7C,iBAAiB,SAAU,WAC5C8jC,IACF,GFyIhByW,KACKd,KACHA,IAAoC,EAC/BI,GAIHW,MAHAX,IAAwC,EACxCc,OhEpRC,WAAmC,OAAApiD,GAAApkB,MAAC,KAAD7D,UAAA,CkE0I5B0rE,GAAuBn3C,KAAK,WH+ZxCgzC,KACKN,KACHA,IAAgC,EAC3BC,GAIHuB,MAHAvB,IAAoC,EACpC0B,MGlaQ,GACA,IAAM+C,EAAatoC,OAAOC,WAAW,gCAC/BqtB,EAAqBxmD,EAAsB,6BACjDwhE,EAAWj8C,iBAAiB,SAAU,WACpC4iC,GAAkB3B,EAAmBib,eAAgBjb,EAAmBkb,aAC1E,GACAlb,EAAmBjhC,iBAAiB,QAAS,WAC3C2iC,KACAC,GAAkB3B,EAAmBib,eAAgBjb,EAAmBkb,aAC1E,GACAlb,EAAmBjhC,iBAAiB,MAAO,WACzC2iC,KACAC,GAAkB3B,EAAmBib,eAAgBjb,EAAmBkb,aAC1E,GACAlb,EAAmBjhC,iBAAiB,kBAAmB,WACrD2iC,KACAC,GAAkB3B,EAAmBib,eAAgBjb,EAAmBkb,aAC1E,GACAxhE,SAASqlB,iBAAiB,kBAAmB,WAC3C2iC,KACAC,GAAkB3B,EAAmBib,eAAgBjb,EAAmBkb,aAC1E,GACAlb,EAAmBjhC,iBAAiB,QAAS,WAC3C2iC,KACAC,GAAkB3B,EAAmBib,eAAgBjb,EAAmBkb,aAC1E,GAEA,IAAMC,EAAoC3hE,EAAsB,8CAChE2hE,EAAkCp8C,iBAAiB,QAAS,WAC1DiB,GAAkCm7C,EAAkC7nE,MACtE,GACA6nE,EAAkCp8C,iBAAiB,MAAO,WACxDiB,GAAkCm7C,EAAkC7nE,MACtE,GACA6nE,EAAkCp8C,iBAAiB,kBAAmB,WACpEiB,GAAkCm7C,EAAkC7nE,MACtE,GACAoG,SAASqlB,iBAAiB,kBAAmB,WAC3CiB,GAAkCm7C,EAAkC7nE,MACtE,GACA6nE,EAAkCp8C,iBAAiB,QAAS,WAC1DiB,GAAkCm7C,EAAkC7nE,MACtE,GACAimD,KACA4P,GAAoB,YhD3N3B,WAAqCz8B,GAAAx5B,MAAC,KAAD7D,UAAA,CgD4N5B+rE,GhDjLT,WAA8C,OAAAtuC,GAAA55B,MAAC,KAAD7D,UAAA,CgDkLrCgsE,GAAkCz3C,KAAK,YhDtChD,WAAkD6J,GAAAv6B,MAAC,KAAD7D,UAAA,CgDuCvCisE,EACF,GACA5hE,SAASqlB,iBACP,QACA,WACEmd,MxCnQuB,IAArCtH,GAAgBE,WAAWE,QAAyE,IAAtDh6B,GAAsB,8BACtE45B,GAAgBE,WAAWE,OAAQ,EACG,oBAA3BumC,wBAA8F,mBAA7CA,uBAAuBC,kBACjFD,uBAAuBC,oBACpB53C,KAAK,SAAC63C,GACmB,YAApBA,GAEF/oC,OAAO3T,iBACL,oBACA,SAAUnf,GACJA,EAAM2M,SACRqoB,GAAgBC,SAAUj1B,aAAK,EAALA,EAAOs1B,SAAU,EAEvCt1B,EAAM87D,qBACR9mC,GAAgBC,QAAUj1B,EAAM87D,uBAAyB,EAEzD9mC,GAAgBC,SAAUj1B,aAAK,EAALA,EAAOs1B,SAAU,CAGjD,GACA,EAKN,GAAE,MACK,SAACxhC,GAER,GAEFioE,QAAQC,IAAI,sCwCuOA,EACA,CAAE58C,MAAM,GAEZ,EACF,CACe,eAAX/hB,GAAsC,iBAAXA,IAC7BssD,KACAJ,KAEJ,GAAE,MACK,WACLI,KACAJ,IACF,EACJ,GAEJ,EACA0S,mBAAoB,WACb5B,KACHA,IAAyB,E9DzQxB,WAA2Bh7C,GAAA/rB,MAAC,KAAD7D,UAAA,C8D0Q5BysE,GACA1lD,K3FjNC,WAA2C7f,EAAArD,MAAC,KAAD7D,UAAA,C2FkN5C0sE,GjE7HC,WAAyD9G,GAAA/hE,MAAC,KAAD7D,UAAA,CiE8H1D2sE,G1E/OC,WAAwClxD,GAAA5X,MAAC,KAAD7D,UAAA,C0EgPzC4sE,GACA7lD,KAAqCwN,KAAK,YrEjEzC,WAA6C,OAAAzN,GAAAjjB,MAAC,KAAD7D,UAAA,EqEkE5C6sE,GAAiCt4C,KAAK,YrE1GvC,WAAqD/N,GAAA3iB,MAAC,KAAD7D,UAAA,CqE2GlD8sE,EACF,EACF,GAEJ,EACArhD,MAAO,CACLshD,WrBmmBG,WAELvtB,GAAW//B,aAAa,YAAa,SACrCyhC,IAA8B,EAC9B//B,IACF,EqBvmBI6rD,YrBymBG,SAAqB71D,EAAqCG,GAC/D4pC,IAA8B,EAC9BuI,GAAUtyC,EAASG,EACrB,EqB3mBI21D,kBtBhQG,WACL16C,GAAkB,gBAClB8rB,GAAkB5+B,aAAa,YAAa,SAC5C,IACkEtY,EADgEE,EAAAC,GAA/FqD,EAAwB6vC,GAA4B,QACrB,IAAlE,IAAAnzC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAAoE,CAAhCN,EAAAlD,MACRsc,QAC5B,CAAC,OAAAlc,GAAAgD,EAAAQ,EAAAxD,EAAA,SAAAgD,EAAAS,GAAA,CACD,IACoDiO,EADwDC,EAAA1O,GAAhFqD,EAAwB2vC,GAAqB,QACrB,IAApD,IAAAtkC,EAAAzO,MAAAwO,EAAAC,EAAAxO,KAAAC,MAAsD,CAAzBsO,EAAA9R,MACRsc,QACrB,CAAC,OAAAlc,GAAA2R,EAAAnO,EAAAxD,EAAA,SAAA2R,EAAAlO,GAAA,CACH,GsBuPEsiD,SAAU,CACRK,aAAAA,GACAyiB,cnBgnBG,WAEL1hB,GAAc/rC,aAAa,YAAa,SACxCwtC,IAAiC,EACjC9rC,IACF,EmBpnBIgsD,qBnChJG,WACL56C,GAAkB,mBAClBq4B,GAAqBnrC,aAAa,YAAa,QACjD,GmC+IEuK,OAAQ,CACN8gB,iBAAAA,GACAL,kBAAAA,GACAnU,mBAAAA,GACAlG,wBAAAA,GACAyC,kBAAAA,GACAC,mBAAAA,GACAs6C,uB5DvTG,WAGL/kD,GAFasK,GAAiB1uB,MACjB2uB,GAAiB3uB,OACLswB,KAAK,SAAC1sB,GACzBA,GACFirB,KACAR,GAAc,SAAU,WAExBA,GAAc,QAAS,UAE3B,EACF,G4D8SE6kC,OAAQ,CACNnC,WAAAA,GACAE,YAAAA,GACAmY,uBlBMG,WACL,IAAMpZ,EAAcf,KAChBoa,GAAmB,EAOvB/uD,GAAQsyC,GAD8B,CAAC,cAAe,QAAS,cAAe,mBAJ5Eyc,EADErZ,IAAgB,GAAKA,EAAc,EAC3BA,EAAc,GAEb,GAG0C,IACvDpD,GAA8BpxC,aAAa,OAAQ6tD,EAAQzyC,YAC3Dw3B,IACF,GkBhBE7vD,QAAS,CACP+qE,aL7KG,WACL5N,GAAalgD,aAAa,YAAa,QACzC,GK6KE+tD,UAAW,CACTC,eV/SG,WAELpT,GAAe56C,aAAa,YAAa,SACzC0B,IACF,GU6SEqW,iBAAkB,CAChBgD,6BAAAA,GACAkzC,4BDxSG,WACL5sD,GAAgB,2BAChBypD,GAA6B9qD,aAAa,YAAa,QACvDwB,IACF,ECqSIypD,6BAAAA,GACAiD,iCD1UG,WAaL,IAZA,IAAMjsE,EAAOm3B,GAAiB50B,MACxBm1B,EAAYN,GAAsB70B,MAClCo1B,EAAUN,GAAoB90B,MAEpCq1B,EAAmCl5B,OAAOg5B,GACvCvS,MAAM,KACN1lB,IAAI,SAAC0G,GAAC,OAAK9F,SAAS8F,EAAE,GAAC0xB,GAAA/sB,EAAAA,EAAAA,GAAA8sB,EAAA,GAFnB7C,EAAU8C,EAAA,GAAE7C,EAAY6C,EAAA,GAG/BC,EAA+Bp5B,OAAOi5B,GACnCxS,MAAM,KACN1lB,IAAI,SAAC0G,GAAC,OAAK9F,SAAS8F,EAAE,GAAC4xB,GAAAjtB,EAAAA,EAAAA,GAAAgtB,EAAA,GAFnB7C,EAAQ8C,EAAA,GAAE7C,EAAU6C,EAAA,GAIvB5C,EAAO,GACF9vB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAM2yB,EAAiBT,GAAYlyB,GAC7B4yB,EAAcD,EAAeE,aAAa,eAC1Cj4B,EAAMI,SAAS23B,EAAeE,aAAa,QAC7B,SAAhBD,GACF9C,EAAK7vB,KAAKrF,EAEd,CAEA40B,GAAuB70B,EAAM+0B,EAAYC,EAAcC,EAAUC,EAAYC,GAAMtC,KAAK,SAAU1sB,GAC5FA,GACF6iE,KACAp4C,GAAc,oBAAqB,aAEnCA,GAAc,QAAS,YAE3B,EACF,EC6SIs7C,iCD/RG,SAA0CjsE,GAC/C,IAAM+3B,EAAiBjvB,EAAqBuuB,GAAqB,YAA2Cr3B,OAExF,SADA+3B,EAAeE,aAAa,eAE9CF,EAAeja,aAAa,cAAe,SAE3Cia,EAAeja,aAAa,cAAe,OAE/C,ECwRIsa,2BAAAA,GACAF,4BAAAA,GACAg0C,gCxD3QG,SAAyClsE,GAC9C,IAAM+3B,EAAiBjvB,EAAqBuuB,GAAqB,YAA0Cr3B,OAEvF,SADA+3B,EAAeE,aAAa,eAE9CF,EAAeja,aAAa,cAAe,SAE3Cia,EAAeja,aAAa,cAAe,OAE/C,EwDoQIyZ,2BAAAA,IAEFk8B,SAAU,CACRoD,aAAAA,GACAE,cAAAA,GACAoV,qBPtSG,WAELnQ,GAAqBl+C,aAAa,YAAa,SAC/C0B,IACF,GOoSEmlC,IAAK,CACHzlC,QAAAA,GACAK,SAAAA,IAEF+/C,aAAc,CACZ1D,gCAAAA,GACAwQ,iCRpCG,WAEL3S,GAAiC37C,aAAa,YAAa,SAC3Dy8C,IAAmD,EACnD/6C,IACF,EQgCIwf,yBAAAA,GACAC,0BAAAA,GACAotC,mC9C9UG,WAAiD,OAAAntC,GAAAh9B,MAAC,KAAD7D,UAAA,E8C+UpDorC,0BAAAA,IAEF6iC,OAAQ,CACNn1B,WAAAA,GACAo1B,Y1BhWG,WACL37C,GAAkB,UAClBqmB,GAAYn5B,aAAa,YAAa,QAExC,I0BgWA,SAAe4jB,OAAU,G,GCtXrB8qC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBnuE,IAAjBouE,EACH,OAAOA,EAAa9vE,QAGrB,IAAIC,EAAS0vE,EAAyBE,GAAY,CAGjD7vE,QAAS,CAAC,GAOX,OAHA+vE,EAAoBF,GAAU5vE,EAAQA,EAAOD,QAAS4vE,GAG/C3vE,EAAOD,OACf,CAGA4vE,EAAoBrjD,EAAIwjD,ECzBxBH,EAAoBI,KAAO,CAAC,EhGAxB3vE,EAAW,GACfuvE,EAAoBK,EAAI,CAAC3nE,EAAQ4nE,EAAUC,EAAIC,KAC9C,IAAGF,EAAH,CAMA,IAAIG,EAAe5+D,IACnB,IAASlJ,EAAI,EAAGA,EAAIlI,EAASoB,OAAQ8G,IAAK,CAGzC,IAFA,IAAK2nE,EAAUC,EAAIC,GAAY/vE,EAASkI,GACpC+nE,GAAY,EACPr5D,EAAI,EAAGA,EAAIi5D,EAASzuE,OAAQwV,MACpB,EAAXm5D,GAAsBC,GAAgBD,IAAanmC,OAAOtjC,KAAKipE,EAAoBK,GAAGM,MAAO/qE,GAASoqE,EAAoBK,EAAEzqE,GAAK0qE,EAASj5D,KAC9Ii5D,EAASnoD,OAAO9Q,IAAK,IAErBq5D,GAAY,EACTF,EAAWC,IAAcA,EAAeD,IAG7C,GAAGE,EAAW,CACbjwE,EAAS0nB,OAAOxf,IAAK,GACrB,IAAIsR,EAAIs2D,SACEzuE,IAANmY,IAAiBvR,EAASuR,EAC/B,CACD,CACA,OAAOvR,CAnBP,CAJC8nE,EAAWA,GAAY,EACvB,IAAI,IAAI7nE,EAAIlI,EAASoB,OAAQ8G,EAAI,GAAKlI,EAASkI,EAAI,GAAG,GAAK6nE,EAAU7nE,IAAKlI,EAASkI,GAAKlI,EAASkI,EAAI,GACrGlI,EAASkI,GAAK,CAAC2nE,EAAUC,EAAIC,IiGJ/BR,EAAoBjuD,EAAI,CAAC3hB,EAASwwE,KACjC,IAAI,IAAIhrE,KAAOgrE,EACXZ,EAAoBluD,EAAE8uD,EAAYhrE,KAASoqE,EAAoBluD,EAAE1hB,EAASwF,IAC5EykC,OAAOwmC,eAAezwE,EAASwF,EAAK,CAAEkrE,YAAY,EAAMphE,IAAKkhE,EAAWhrE,MCH3EoqE,EAAoBhtE,EAAK+tE,KAEX,CAAC,GAAK,uBAAuB,GAAK,+BAA+B,IAAM,uBAAuB,IAAM,yBAAyB,IAAM,qBAAqB,IAAM,0BAA0B,IAAM,6BAA6B,IAAM,oCAAoC,IAAM,sBAAsB,IAAM,gCAAgC,IAAM,2BAA2B,IAAM,iCAAiCA,IAAYA,GAAW,IAAM,CAAC,GAAK,uBAAuB,GAAK,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,wBAAwBA,GAAW,OCH31Bf,EAAoBv/B,EAAI,WACvB,GAA0B,iBAAfugC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOznE,GACR,GAAsB,iBAAXw7B,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxB+qC,EAAoBluD,EAAI,CAACqvD,EAAKC,IAAU/mC,OAAOgnC,UAAUtiE,eAAeuiE,KAAKH,EAAKC,GCAlFpB,EAAoBuB,EAAI,K,MCAxBvB,EAAoBtwD,EAAyB,oBAAbzT,UAA4BA,SAASulE,SAAYhxE,KAAKwrD,SAASC,KAK/F,IAAIwlB,EAAkB,CACrB,IAAK,GAaNzB,EAAoBK,EAAEh5D,EAAK05D,GAA0C,IAA7BU,EAAgBV,GAGxD,IAAIW,EAAuB,CAACC,EAA4B7pE,KACvD,IAGImoE,EAAUc,GAHTT,EAAUsB,EAAaC,GAAW/pE,EAGhBa,EAAI,EAC3B,GAAG2nE,EAAS/1B,KAAM5gC,GAAgC,IAAxB83D,EAAgB93D,IAAa,CACtD,IAAIs2D,KAAY2B,EACZ5B,EAAoBluD,EAAE8vD,EAAa3B,KACrCD,EAAoBrjD,EAAEsjD,GAAY2B,EAAY3B,IAGhD,GAAG4B,EAAS,IAAInpE,EAASmpE,EAAQ7B,EAClC,CAEA,IADG2B,GAA4BA,EAA2B7pE,GACrDa,EAAI2nE,EAASzuE,OAAQ8G,IACzBooE,EAAUT,EAAS3nE,GAChBqnE,EAAoBluD,EAAE2vD,EAAiBV,IAAYU,EAAgBV,IACrEU,EAAgBV,GAAS,KAE1BU,EAAgBV,GAAW,EAE5B,OAAOf,EAAoBK,EAAE3nE,IAG1BopE,EAAqBtxE,KAAsB,gBAAIA,KAAsB,iBAAK,GAC9EsxE,EAAmBC,QAAQL,EAAqBM,KAAK,KAAM,IAC3DF,EAAmBlpE,KAAO8oE,EAAqBM,KAAK,KAAMF,EAAmBlpE,KAAKopE,KAAKF,G,KC7CvF,IAAIG,EAAsBjC,EAAoBK,OAAEvuE,EAAW,CAAC,KAAM,IAAOkuE,EAAoB,O,UAC7FiC,EAAsBjC,EAAoBK,EAAE4B,I","sources":["webpack://bus/webpack/universalModuleDefinition","webpack://bus/webpack/runtime/chunk loaded","webpack://bus/./src/tools/time.ts","webpack://bus/./src/data/storage/index.ts","webpack://bus/./src/data/analytics/data-usage/index.ts","webpack://bus/./src/tools/convert.ts","webpack://bus/./src/tools/elements.ts","webpack://bus/./src/data/apis/getAPIURL/index.ts","webpack://bus/./src/tools/pako-inflate/index.ts","webpack://bus/./src/data/apis/loader.ts","webpack://bus/./src/data/apis/getBusData/index.ts","webpack://bus/./src/data/apis/getBusEvent/index.ts","webpack://bus/./src/data/apis/getCarInfo/index.ts","webpack://bus/./src/data/apis/getLocation/index.ts","webpack://bus/./src/data/apis/getStop/index.ts","webpack://bus/./src/data/apis/index.ts","webpack://bus/./src/tools/array.ts","webpack://bus/./src/tools/text.ts","webpack://bus/./src/data/apis/getRoute/index.ts","webpack://bus/./src/data/search/index.ts","webpack://bus/./src/data/bus/index.ts","webpack://bus/./src/data/recent-views/index.ts","webpack://bus/./src/interface/icons/index.ts","webpack://bus/./src/interface/bus/properties.ts","webpack://bus/./src/interface/bus/index.ts","webpack://bus/./src/tools/math.ts","webpack://bus/./src/data/analytics/update-rate/index.ts","webpack://bus/./src/data/apis/getEstimateTime/index.ts","webpack://bus/./src/data/apis/getMaterialSymbolsSearchIndex/index.ts","webpack://bus/./src/data/folder/index.ts","webpack://bus/./src/data/analytics/bus-arrival-time/index.ts","webpack://bus/./src/tools/levenshtein.ts","webpack://bus/./src/data/search/searchMaterialSymbols.ts","webpack://bus/./src/interface/home/index.ts","webpack://bus/./src/interface/folder-icon-selector/index.ts","webpack://bus/./src/interface/folder-creator/index.ts","webpack://bus/./src/interface/folder-editor/index.ts","webpack://bus/./src/interface/folder-manager/index.ts","webpack://bus/./src/data/personal-schedule/index.ts","webpack://bus/./src/interface/personal-schedule-editor/index.ts","webpack://bus/./src/interface/personal-schedule-manager/index.ts","webpack://bus/./src/data/notification/apis/getNotificationAPIURL/index.ts","webpack://bus/./src/data/notification/apis/getNotificationToken/index.ts","webpack://bus/./src/data/notification/apis/getNotificationRequestBody/index.ts","webpack://bus/./src/data/notification/apis/loader.ts","webpack://bus/./src/data/notification/apis/rotateNotificationSecret/index.ts","webpack://bus/./src/data/notification/apis/scheduleNotification/index.ts","webpack://bus/./src/data/notification/index.ts","webpack://bus/./src/data/notification/apis/registerNotificationClient/index.ts","webpack://bus/./src/interface/register-notification/index.ts","webpack://bus/./src/tools/graphic.ts","webpack://bus/./src/tools/style.ts","webpack://bus/./src/tools/labels.ts","webpack://bus/./src/tools/address.ts","webpack://bus/./src/tools/cardinal-direction.ts","webpack://bus/./src/data/user-orientation/index.ts","webpack://bus/./src/data/location/index.ts","webpack://bus/./src/interface/save-to-folder/index.ts","webpack://bus/./src/interface/schedule-notification/index.ts","webpack://bus/./src/data/location/details.ts","webpack://bus/./src/interface/location/details/index.ts","webpack://bus/./src/data/apis/getSegmentBuffers/index.ts","webpack://bus/./src/data/user-position/index.ts","webpack://bus/./src/data/route/index.ts","webpack://bus/./src/data/apis/getProvider/index.ts","webpack://bus/./src/data/apis/getSemiTimeTable/index.ts","webpack://bus/./src/data/apis/getTimeTable/index.ts","webpack://bus/./src/data/route/details.ts","webpack://bus/./src/tools/qrcode.ts","webpack://bus/./src/interface/qrcode/index.ts","webpack://bus/./src/interface/route/details/actions.ts","webpack://bus/./src/interface/route/details/calendar.ts","webpack://bus/./src/interface/route/details/properties.ts","webpack://bus/./src/interface/route/details/index.ts","webpack://bus/./src/interface/route/index.ts","webpack://bus/./src/tools/permalink.ts","webpack://bus/./src/interface/location/index.ts","webpack://bus/./src/interface/search/index.ts","webpack://bus/./src/data/export/index.ts","webpack://bus/./src/data/settings/index.ts","webpack://bus/./src/data/import/index.ts","webpack://bus/./src/data/settings/version.ts","webpack://bus/./src/interface/settings/index.ts","webpack://bus/./src/tools/index.ts","webpack://bus/./src/interface/index.ts","webpack://bus/./src/interface/data-usage/index.ts","webpack://bus/./src/data/notification/apis/cancelNotification/index.ts","webpack://bus/./src/interface/notification-schedule-manager/index.ts","webpack://bus/./src/interface/settings/options.ts","webpack://bus/./src/data/analytics/storage-size.ts","webpack://bus/./src/interface/storage/index.ts","webpack://bus/./src/interface/prompt/index.ts","webpack://bus/./src/interface/home/folders/index.ts","webpack://bus/./src/interface/home/recent-views/index.ts","webpack://bus/./src/interface/personal-schedule-creator/index.ts","webpack://bus/./src/index.ts","webpack://bus/webpack/bootstrap","webpack://bus/webpack/runtime/amd options","webpack://bus/webpack/runtime/define property getters","webpack://bus/webpack/runtime/get javascript chunk filename","webpack://bus/webpack/runtime/global","webpack://bus/webpack/runtime/hasOwnProperty shorthand","webpack://bus/webpack/runtime/publicPath","webpack://bus/webpack/runtime/jsonp chunk loading","webpack://bus/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"bus\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"bus\"] = factory();\n\telse\n\t\troot[\"bus\"] = factory();\n})(self, () => {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","export function getThisWeekOrigin(): Date {\n  const today: Date = new Date();\n  const dayOfToday: number = today.getDay();\n  const originDate: number = today.getDate() - dayOfToday;\n  const origin: Date = new Date();\n  origin.setDate(originDate);\n  origin.setHours(0);\n  origin.setMinutes(0);\n  origin.setSeconds(0);\n  origin.setMilliseconds(0);\n  return origin;\n}\n\nexport function offsetDate(origin: Date, date: number, hours: number, minutes: number): Date {\n  const duplicatedOrigin = new Date();\n  duplicatedOrigin.setDate(1);\n  duplicatedOrigin.setMonth(0);\n  duplicatedOrigin.setHours(hours);\n  duplicatedOrigin.setMinutes(minutes);\n  duplicatedOrigin.setSeconds(0);\n  duplicatedOrigin.setMilliseconds(0);\n  duplicatedOrigin.setFullYear(origin.getFullYear());\n  duplicatedOrigin.setMonth(origin.getMonth());\n  duplicatedOrigin.setDate(origin.getDate());\n  duplicatedOrigin.setDate(duplicatedOrigin.getDate() + date);\n  return duplicatedOrigin;\n}\n\nexport function timeStampToNumber(string: string): number {\n  const regex = /[0-9\\.]*/gm;\n  const match = string.match(regex);\n  if (match) {\n    const year = parseInt(match[0]);\n    const month = parseInt(match[2]);\n    const date = parseInt(match[4]);\n    const hours = parseInt(match[6]);\n    const minutes = parseInt(match[8]);\n    const seconds = parseInt(match[10]);\n    const date_object = new Date();\n    date_object.setDate(1);\n    date_object.setMonth(0);\n    date_object.setFullYear(year);\n    date_object.setMonth(month - 1);\n    date_object.setDate(date);\n    date_object.setHours(hours);\n    date_object.setMinutes(minutes);\n    date_object.setSeconds(seconds);\n    return date_object.getTime();\n  }\n  return 0;\n}\n\nexport function dateToString(date: Date, template: string = 'YYYY-MM-DD hh:mm:ss'): string {\n  const result = template\n    .replaceAll(/Y{4,4}/g, date.getFullYear())\n    .replaceAll(/M{2,2}/g, String(date.getMonth() + 1).padStart(2, '0'))\n    .replaceAll(/D{2,2}/g, String(date.getDate()).padStart(2, '0'))\n    .replaceAll(/h{2,2}/g, String(date.getHours()).padStart(2, '0'))\n    .replaceAll(/m{2,2}/g, String(date.getMinutes()).padStart(2, '0'))\n    .replaceAll(/s{2,2}/g, String(date.getSeconds()).padStart(2, '0'));\n  return result;\n}\n\nexport function dateToRelativeTime(date: Date): string {\n  const time = date.getTime();\n  const seconds = Math.floor((new Date().getTime() - time) / 1000);\n  let interval = Math.floor(seconds / 31536000); // seconds in a year\n  if (interval >= 1) {\n    return `${interval}`;\n  }\n  interval = Math.floor(seconds / 2592000); // seconds in a month\n  if (interval >= 1) {\n    return `${interval}`;\n  }\n  interval = Math.floor(seconds / 86400); // seconds in a day\n  if (interval >= 1) {\n    return `${interval}`;\n  }\n  interval = Math.floor(seconds / 3600); // seconds in an hour\n  if (interval >= 1) {\n    return `${interval}`;\n  }\n  interval = Math.floor(seconds / 60); // seconds in a minute\n  if (interval >= 1) {\n    return `${interval}`;\n  }\n  if (seconds > 0) {\n    return `${seconds}`;\n  }\n  return '';\n}\n\nexport function formatTime(time: number, mode: number): string {\n  const roundedTime = time | 0;\n  switch (mode) {\n    case 0: {\n      return `${roundedTime}`;\n      break;\n    }\n    case 1: {\n      const minutes = String((roundedTime - (roundedTime % 60)) / 60);\n      const seconds = String(roundedTime % 60);\n      return [minutes, seconds].map((u) => u.padStart(2, '0')).join(':');\n      break;\n    }\n    case 2: {\n      const minutes = (roundedTime / 60) | 0;\n      return `${minutes}`;\n      break;\n    }\n    case 3: {\n      if (roundedTime >= 60 * 60) {\n        const hours = parseFloat((roundedTime / (60 * 60)).toFixed(1));\n        return `${hours}`;\n      }\n      if (60 <= roundedTime && roundedTime < 60 * 60) {\n        const minutes = (roundedTime / 60) | 0;\n        return `${minutes}`;\n      }\n      if (roundedTime < 60) {\n        return `${roundedTime}`;\n      }\n      break;\n    }\n    default: {\n      return '--';\n      break;\n    }\n  }\n}\n\nexport type WeekDayIndex = 0 | 1 | 2 | 3 | 4 | 5 | 6;\n// 0: Sunday, 1: Monday, 2: Tuesday, 3: Wednesday, 4: Thursday, 5: Friday, 6: Saturday\n\nexport type WeekDayIndexArray = Array<WeekDayIndex>;\n\nexport type WeekDayName = '' | '' | '' | '' | '' | '' | '';\n\nexport interface WeekDay {\n  name: WeekDayName;\n  day: WeekDayIndex;\n  code: string;\n}\n\nexport function indexToDay(index: WeekDayIndex): WeekDay {\n  const days = [\n    {\n      name: '',\n      day: 0,\n      code: 'd_0'\n    },\n    {\n      name: '',\n      day: 1,\n      code: 'd_1'\n    },\n    {\n      name: '',\n      day: 2,\n      code: 'd_2'\n    },\n    {\n      name: '',\n      day: 3,\n      code: 'd_3'\n    },\n    {\n      name: '',\n      day: 4,\n      code: 'd_4'\n    },\n    {\n      name: '',\n      day: 5,\n      code: 'd_5'\n    },\n    {\n      name: '',\n      day: 6,\n      code: 'd_6'\n    }\n  ];\n  return days[index];\n}\n\nexport function dateValueToDayOfWeek(dateValue: string): WeekDay {\n  const int = parseInt(dateValue);\n  const index = int - 1;\n  return indexToDay(index);\n}\n\nexport interface TimeObject {\n  hours: number;\n  minutes: number;\n}\n\nexport interface TimePeriod {\n  start: TimeObject;\n  end: TimeObject;\n}\n\nexport interface TimeStampPeriod {\n  start: Date;\n  end: Date;\n}\n\nexport function timeObjectToString(timeObject: TimeObject): string {\n  return `${String(timeObject.hours).padStart(2, '0')}:${String(timeObject.minutes).padStart(2, '0')}`;\n}\n\nexport function createDateObjectFromDate(year: number, month: number, date: number): Date {\n  const dateObject = new Date();\n  dateObject.setDate(1); // Set to the first day of the month to prevent date from being clamped\n  dateObject.setMonth(0);\n  dateObject.setFullYear(year);\n  dateObject.setMonth(month - 1);\n  dateObject.setDate(date);\n  dateObject.setHours(0);\n  dateObject.setMinutes(0);\n  dateObject.setSeconds(0);\n  dateObject.setMilliseconds(0);\n  return dateObject;\n}\n\nexport function maxConcurrency(periods: Array<TimePeriod>): number {\n  let events: Array<[number, 1 | -1]> = [];\n\n  // Convert periods into events\n  for (let { start, end } of periods) {\n    events.push([start.hours * 60 + start.minutes, 1]); // Start of a period\n    events.push([end.hours * 60 + end.minutes, -1]); // End of a period\n  }\n\n  // Sort events: Primary by time, secondary by type (-1 before +1)\n  events.sort((a, b) => (a[0] === b[0] ? a[1] - b[1] : a[0] - b[0]));\n\n  let maxCount = 0;\n  let currentCount = 0;\n\n  // Sweep through the events\n  for (let [, type] of events) {\n    currentCount += type;\n    maxCount = Math.max(maxCount, currentCount);\n  }\n\n  return maxCount;\n}\n\nexport function assignTracks(periods: Array<TimePeriod>): Array<Array<TimePeriod>> {\n  if (periods.length === 0) return [];\n\n  // Convert periods into events\n  let events: Array<[number, number, number]> = [];\n  let index = 0;\n  for (let { start, end } of periods) {\n    events.push([start.hours * 60 + start.minutes, end.hours * 60 + end.minutes, index]);\n    index += 1;\n  }\n\n  // Sort intervals by start time\n  events.sort((a, b) => a[0] - b[0]);\n\n  let tracks = [];\n  for (let [start, end, index] of events) {\n    let assigned = false;\n    for (let i = 0; i < tracks.length; i++) {\n      if (tracks[i][tracks[i].length - 1][1] <= start) {\n        tracks[i].push([start, end, index]);\n        assigned = true;\n        break;\n      }\n    }\n    if (!assigned) {\n      tracks.push([[start, end, index]]);\n    }\n  }\n\n  let i = 0;\n  for (const track of tracks) {\n    let j = 0;\n    for (const event of track) {\n      tracks[i][j] = periods[event[2]];\n      j += 1;\n    }\n    i += 1;\n  }\n\n  return tracks;\n}\n","const localforage = require('localforage');\n\nlet storage = {\n  cacheStore: false, // 0\n  settingsStore: false, // 1\n  dataUsageStatsStore: false, // 2\n  updateRateDataStore: false, // 3\n  updateRateDataWriteAheadLogStore: false, // 4\n  busArrivalTimeDataWriteAheadLogStore: false, // 5\n  busArrivalTimeDataStore: false, // 6\n  personalScheduleStore: false, // 7\n  recentViewsStore: false, // 8\n  notificationStore: false, // 9\n  notificationScheduleStore: false, // 10\n  folderListStore: false, // 11\n  folderContentIndexStore: false, // 12\n  folderContentStore: false // 13\n};\n\nconst stores = ['cacheStore', 'settingsStore', 'dataUsageStatsStore', 'updateRateDataStore', 'updateRateDataWriteAheadLogStore', 'busArrivalTimeDataWriteAheadLogStore', 'busArrivalTimeDataStore', 'personalScheduleStore', 'recentViewsStore', 'notificationStore', 'notificationScheduleStore', 'folderListStore', 'folderContentIndexStore', 'folderContentStore'];\n\nasync function dropInstance(store: number): Promise<any> {\n  const storeKey = stores[store];\n  if (storage[storeKey] === false) {\n    storage[storeKey] = await localforage.createInstance({\n      name: storeKey\n    });\n  }\n  const operation = await storage[storeKey].dropInstance();\n  return operation;\n}\n\nexport async function lfSetItem(store: number, key: string, value: any): Promise<any> {\n  try {\n    const storeKey = stores[store];\n    if (storage[storeKey] === false) {\n      storage[storeKey] = await localforage.createInstance({\n        name: storeKey\n      });\n    }\n    const operation = await storage[storeKey].setItem(key, value);\n    return operation;\n  } catch (err) {\n    console.error(err);\n    // await dropInstance(store);\n    return null;\n  }\n}\n\nexport async function lfGetItem(store: number, key: string): Promise<any> {\n  try {\n    const storeKey = stores[store];\n    if (storage[storeKey] === false) {\n      storage[storeKey] = await localforage.createInstance({\n        name: storeKey\n      });\n    }\n    const operation = await storage[storeKey].getItem(key);\n    return operation;\n  } catch (err) {\n    console.error(err);\n    // await dropInstance(store);\n    return null;\n  }\n}\n\nexport async function lfRemoveItem(store: number, key: string): Promise<any> {\n  try {\n    const storeKey = stores[store];\n    if (storage[storeKey] === false) {\n      storage[storeKey] = await localforage.createInstance({\n        name: storeKey\n      });\n    }\n    const operation = await storage[storeKey].removeItem(key);\n    return operation;\n  } catch (err) {\n    console.error(err);\n    // await dropInstance(store);\n    return null;\n  }\n}\n\nexport async function lfListItemKeys(store: number): Promise<Array<string>> {\n  try {\n    const storeKey = stores[store];\n    if (storage[storeKey] === false) {\n      storage[storeKey] = await localforage.createInstance({\n        name: storeKey\n      });\n    }\n    const keys = await storage[storeKey].keys();\n    return keys;\n  } catch (err) {\n    console.error(err);\n    return [];\n  }\n}\n\nexport function getStoreKey(store: number): string {\n  return stores[store];\n}\n\nexport function getStoresLength(): number {\n  return stores.length;\n}\n\n/*\nexport async function registerStore(id: string): Promise<number> {\n  const storeKey = `F${id}Store`;\n  if (!storage.hasOwnProperty(storeKey) && stores.indexOf(storeKey) < 0) {\n    storage[storeKey] = await localforage.createInstance({\n      name: storeKey\n    });\n    stores.push(storeKey);\n    return stores.length - 1;\n  } else {\n    return stores.indexOf(storeKey);\n  }\n}\n*/\n\nexport async function isStoragePersistent(): Promise<boolean> {\n  // Check if site's storage has been marked as persistent\n  if (navigator.storage) {\n    if (navigator.storage.persist) {\n      const isPersisted = await navigator.storage.persisted();\n      return isPersisted;\n    }\n  }\n  return false;\n}\n\nexport async function askForPersistentStorage(): Promise<'granted' | 'denied' | 'unsupported'> {\n  // Request persistent storage for site\n  if (navigator.storage) {\n    if (navigator.storage.persist) {\n      const isPersisted = await navigator.storage.persist();\n      return isPersisted ? 'granted' : 'denied';\n    }\n  }\n  return 'unsupported';\n}\n","import { createDateObjectFromDate, dateToString, offsetDate, TimeStampPeriod } from '../../../tools/time';\nimport { lfGetItem, lfListItemKeys, lfRemoveItem, lfSetItem } from '../../storage/index';\n\nexport interface DataUsageStatsChunk {\n  date: [year: number, month: number, day: number];\n  data: Array<number>;\n  stats: {\n    sum: number;\n    max: number;\n    min: number;\n  };\n}\n\nexport type DataUsageStatsChunkArray = Array<DataUsageStatsChunk>;\n\nexport interface DataUsageStats {\n  stats: {\n    sum: number;\n    max: number;\n    min: number;\n  };\n  period: TimeStampPeriod;\n  chart: string;\n}\n\nexport const DataUsagePeriod = 7; // days\n\nexport async function recordDataUsage(contentLength: number, date: Date) {\n  const key = `d_${dateToString(date, 'YYYY_MM_DD')}`;\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const index = hours * 60 + minutes;\n  const existingDataUsageStatsChunkJSON = await lfGetItem(2, key);\n  if (existingDataUsageStatsChunkJSON) {\n    const existingDataUsageStatsChunkObject = JSON.parse(existingDataUsageStatsChunkJSON) as DataUsageStatsChunk;\n    existingDataUsageStatsChunkObject.stats.sum += contentLength;\n    existingDataUsageStatsChunkObject.data[index] += contentLength;\n    const changedData = existingDataUsageStatsChunkObject.data[index];\n    if (changedData > existingDataUsageStatsChunkObject.stats.max) {\n      existingDataUsageStatsChunkObject.stats.max = changedData;\n    }\n    if (changedData < existingDataUsageStatsChunkObject.stats.min) {\n      existingDataUsageStatsChunkObject.stats.min = changedData;\n    }\n    await lfSetItem(2, key, JSON.stringify(existingDataUsageStatsChunkObject));\n  } else {\n    const newDataUsageStatsChunk = {} as DataUsageStatsChunk;\n    const data = new Uint32Array(60 * 24);\n    data[index] += contentLength;\n    newDataUsageStatsChunk.data = Array.from(data);\n    newDataUsageStatsChunk.stats = {\n      sum: contentLength,\n      max: contentLength,\n      min: 0\n    };\n    newDataUsageStatsChunk.date = [date.getFullYear(), date.getMonth() + 1, date.getDate()];\n    await lfSetItem(2, key, JSON.stringify(newDataUsageStatsChunk));\n  }\n}\n\nexport async function listDataUsageStatsChunks(): Promise<DataUsageStatsChunkArray> {\n  const endDate = new Date();\n  endDate.setHours(0);\n  endDate.setMinutes(0);\n  endDate.setSeconds(0);\n  endDate.setMilliseconds(0);\n  const startDate = offsetDate(endDate, -1 * DataUsagePeriod, 0, 0);\n  const result: DataUsageStatsChunkArray = [];\n  for (let i = 1; i <= DataUsagePeriod; i++) {\n    const date = offsetDate(startDate, i, 0, 0);\n    const key = `d_${dateToString(date, 'YYYY_MM_DD')}`;\n    const existingDataUsageStatsChunkJSON = await lfGetItem(2, key);\n    if (existingDataUsageStatsChunkJSON) {\n      const existingDataUsageStatsChunkObject = JSON.parse(existingDataUsageStatsChunkJSON) as DataUsageStatsChunk;\n      result.push(existingDataUsageStatsChunkObject);\n    } else {\n      const blankDataUsageStatsChunk = {} as DataUsageStatsChunk;\n      const data = new Uint32Array(60 * 24);\n      blankDataUsageStatsChunk.data = Array.from(data);\n      blankDataUsageStatsChunk.stats = {\n        sum: 0,\n        max: 0,\n        min: 0\n      };\n      blankDataUsageStatsChunk.date = [date.getFullYear(), date.getMonth() + 1, date.getDate()];\n      result.push(blankDataUsageStatsChunk);\n    }\n  }\n  return result;\n}\n\nexport async function discardExpiredDataUsageStats() {\n  const millisecondsPerDay = 60 * 60 * 24 * 1000;\n  const expirationPeriod = millisecondsPerDay * DataUsagePeriod;\n  const now = new Date().getTime();\n  const keys = await lfListItemKeys(2);\n  for (const key of keys) {\n    const json = await lfGetItem(2, key);\n    const object = JSON.parse(json) as DataUsageStatsChunk;\n    const date = createDateObjectFromDate(object.date[0], object.date[1], object.date[2]);\n    if (now - date.getTime() > expirationPeriod) {\n      await lfRemoveItem(2, key);\n    }\n  }\n}\n\nexport async function getDataUsageStats(width: number, height: number, padding: number): Promise<DataUsageStats> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"getDataUsageStats-worker\" */ './getDataUsageStats-worker.ts', import.meta.url));\n  const dataUsageStatsChunks = await listDataUsageStatsChunks();\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n    worker.postMessage([dataUsageStatsChunks, width, height, padding]); // Send data to the worker\n  });\n  return result;\n}\n","export function convertPositionsToDistance(lat1: number, lon1: number, lat2: number, lon2: number): number {\n  const R = 6378.137;\n  const dLat = (lat2 * Math.PI) / 180 - (lat1 * Math.PI) / 180;\n  const dLon = (lon2 * Math.PI) / 180 - (lon1 * Math.PI) / 180;\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos((lat1 * Math.PI) / 180) * Math.cos((lat2 * Math.PI) / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const d = R * c;\n  return d * 1000; // measured in meters\n}\n\nexport function convertBytes(contentLength: number): string {\n  const units = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n  let i = 0;\n\n  while (contentLength >= 1000 && i < units.length - 1) {\n    contentLength /= 1000;\n    i++;\n  }\n\n  return `${Math.floor(contentLength * 100) / 100} ${units[i]}`;\n}\n\nexport function convertNumberToLetters(number: number): string {\n  let result = '';\n  while (number > 0) {\n    let remainder = (number - 1) % 26; // Adjust for 1-based indexing\n    let letter = String.fromCharCode(remainder + 65); // A=65 in ASCII\n    result = letter + result;\n    number = Math.floor((number - 1) / 26); // Update number for next iteration\n  }\n  return result;\n}\n","export function documentQuerySelector(selectorExpression: string): HTMLElement {\n  return document.querySelector(selectorExpression);\n}\n\nexport function documentQuerySelectorAll(selectorExpression: string): NodeListOf<HTMLElement> {\n  return document.querySelectorAll(selectorExpression);\n}\n\nexport function elementQuerySelector(element: HTMLElement, selectorExpression: string): HTMLElement {\n  return element.querySelector(selectorExpression);\n}\n\nexport function elementQuerySelectorAll(element: HTMLElement, selectorExpression: string): NodeListOf<HTMLElement> {\n  return element.querySelectorAll(selectorExpression);\n}\n\nexport function getElementsBelow(referenceElement: HTMLElement, className: string): Array<HTMLElement> {\n  const elements = [];\n  let sibling = referenceElement.nextElementSibling;\n\n  while (sibling) {\n    if (sibling.classList.contains(className)) {\n      elements.push(sibling);\n    }\n    sibling = sibling.nextElementSibling;\n  }\n\n  return elements;\n}\n\nexport function removeFirstChild(element: HTMLElement): void {\n  const firstChild = element.firstChild;\n  if (firstChild !== null) {\n    element.removeChild(firstChild);\n  }\n}\n","import { getNoCacheParameter } from '../../../tools/index';\nimport { getSettingOptionValue } from '../../settings/index';\n\n/**\n * Get API URL with no cache parameter (query string).\n * @param city - 0: blobbus -> Taipei City, 2: ntpcbus -> New Taipei City\n * @param api - 0: BusData, 1: BusEvent, 2: CarInfo, 3: CarUnusual, 4: EstimateTime, 5: IStop, 6: IStopPath, 7: OrgPathAttribute, 8: PathDetail, 9: Provider, 10: Route, 11: Stop, 12: SemiTimeTable, 13: StopLocation, 14: TimeTable, 15: BusRouteFareList\n * @param alternative - Whether to use alternative resources\n * @param interval - The interval for no cache parameter\n * @returns The direct link to a gzip file.\n */\n\nexport function getAPIURL(city: number, api: number, alternative: boolean = false, interval: number = 10000): string {\n  const cities = ['blobbus', 'ntpcbus'];\n  // blobbus  Taipei City\n  // ntpcbus  New Taipei City\n  const buckets = ['BusData', 'BusEvent', 'CarInfo', 'CarUnusual', 'EstimateTime', 'IStop', 'IStopPath', 'OrgPathAttribute', 'PathDetail', 'Provider', 'Route', 'Stop', 'SemiTimeTable', 'StopLocation', 'TimeTable', 'BusRouteFareList'];\n  const proxy = getSettingOptionValue('proxy');\n  if (alternative) {\n    return `http://erichsia7.github.io/bus-alternative-static-apis/${cities[city]}/Get${buckets[api]}.gz?_=${getNoCacheParameter(interval)}`;\n  } else {\n    if (proxy) {\n      return `https://bus-proxy.erichsia7.workers.dev?url=https://tcgbusfs.blob.core.windows.net/${cities[city]}/Get${buckets[api]}.gz&_=${getNoCacheParameter(interval)}`;\n    } else {\n      return `https://tcgbusfs.blob.core.windows.net/${cities[city]}/Get${buckets[api]}.gz?_=${getNoCacheParameter(interval)}`;\n    }\n  }\n}\n\nexport function getMaterialSymbolsAPIURL(interval: number = 10000): string {\n  return `https://erichsia7.github.io/material-symbols-list/search-index.gz?_=${getNoCacheParameter(interval)}`;\n}\n","import { generateIdentifier } from '../index';\n\nlet pakoInflateWorkerResponses = {};\nvar port;\n\n// Check if SharedWorker is supported, and fall back to Worker if not\nif (typeof SharedWorker !== 'undefined') {\n  const pakoInflateSharedWorker = new SharedWorker(new URL(/* webpackChunkName: \"pakoInflate-worker\" */ './worker.ts', import.meta.url)); // Reusable shared worker\n  port = pakoInflateSharedWorker.port; // Access the port for communication\n  port.start(); // Start the port (required by some browsers)\n} else {\n  const pakoInflateWorker = new Worker(new URL(/* webpackChunkName: \"pakoInflate-worker\" */ './worker.ts', import.meta.url)); // Fallback to standard worker\n  port = pakoInflateWorker; // Use Worker directly for communication\n}\n\n// Handle messages from the worker\nport.onmessage = function (e) {\n  const [result, taskID] = e.data;\n  if (pakoInflateWorkerResponses[taskID]) {\n    pakoInflateWorkerResponses[taskID](result); // Resolve the correct promise\n    delete pakoInflateWorkerResponses[taskID]; // Clean up the response handler\n  }\n};\n\n// Handle errors\nport.onerror = function (e) {\n  console.error(e.message);\n};\n\nexport async function pakoInflate(buffer: ArrayBuffer): Promise<string> {\n  const taskID = generateIdentifier();\n\n  const result = await new Promise((resolve, reject) => {\n    pakoInflateWorkerResponses[taskID] = resolve; // Store the resolve function for this taskID\n\n    port.onerror = function (e) {\n      reject(e.message);\n    };\n\n    port.postMessage([buffer, taskID]); // Send the task to the worker\n  });\n\n  return result;\n}\n","import { pakoInflate } from '../../tools/pako-inflate/index';\nimport { timeStampToNumber } from '../../tools/time';\nimport { recordDataUsage } from '../analytics/data-usage/index';\n\ntype FetchTaskRequest = [resolve: Function, reject: Function, requestID: string, tag: string];\n\ninterface FetchTask {\n  processing: boolean;\n  requests: Array<FetchTaskRequest>;\n  failed: boolean;\n  timestamp: number;\n  result: any;\n}\n\ntype FetchTasks = { [url: string]: FetchTask };\n\nconst tasks: FetchTasks = {};\n\nconst TTL = 30000;\nconst FetchError = new Error('FetchError');\n\nexport async function fetchData(url: string, requestID: string, tag: string, fileType: 'json' | 'xml'): Promise<object> {\n  // Check concurrency\n  if (tasks.hasOwnProperty(url)) {\n    if (tasks[url].processing) {\n      return await new Promise((resolve, reject) => {\n        tasks[url].requests.push([resolve, reject, requestID, tag]);\n      });\n    } else if (tasks[url].result !== null && new Date().getTime() <= tasks[url].timestamp) {\n      setDataReceivingProgress(requestID, tag, 0, true);\n      return tasks[url].result;\n    }\n  } else {\n    tasks[url] = {\n      processing: true,\n      requests: [],\n      failed: false,\n      timestamp: -1,\n      result: null\n    };\n  }\n\n  // Fetch data\n  const response = await fetch(url);\n  if (!response.ok) {\n    setDataReceivingProgress(requestID, tag, 0, true);\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n\n  // Read chunks\n  const contentLength = parseInt(String(response.headers.get('content-length')));\n  const reader = response.body.getReader();\n  const chunks = [];\n  let receivedLength = 0;\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) {\n      break;\n    }\n    chunks.push(value);\n    receivedLength += value.length;\n    const progress = receivedLength / contentLength;\n    setDataReceivingProgress(requestID, tag, progress, false);\n    if (tasks.hasOwnProperty(url)) {\n      for (const request of tasks[url].requests) {\n        setDataReceivingProgress(request[2], request[3], progress, false);\n      }\n    }\n  }\n\n  // Concatenate all the chunks into a single Uint8Array\n  const uint8Array = new Uint8Array(receivedLength);\n  let position = 0;\n  for (const chunk of chunks) {\n    uint8Array.set(chunk, position);\n    position += chunk.length;\n  }\n\n  // Create a blob from the concatenated Uint8Array\n  const blob = new Blob([uint8Array], { type: 'application/gzip' });\n  const arrayBuffer = await blob.arrayBuffer();\n  const inflatedData = await pakoInflate(arrayBuffer);\n\n  let result;\n  switch (fileType) {\n    case 'json':\n      if (/^<!doctype html>/.test(inflatedData)) {\n        result = await fetchData(url.replace('https://tcgbusfs.blob.core.windows.net/', 'https://erichsia7.github.io/bus-alternative-static-apis/'), requestID, tag, fileType);\n      } else {\n        result = JSON.parse(inflatedData);\n      }\n      break;\n    case 'xml':\n      result = inflatedData;\n      break;\n    default:\n      break;\n  }\n\n  // Record data usage\n  const now = new Date();\n  await recordDataUsage(contentLength, now);\n\n  if (result) {\n    // Resolve promises\n    if (tasks.hasOwnProperty(url)) {\n      const progress = receivedLength / contentLength;\n      let request = tasks[url].requests.shift();\n      while (request) {\n        request[0](result);\n        setDataReceivingProgress(request[2], request[3], progress, false);\n        request = tasks[url].requests.shift();\n      }\n      tasks[url].result = result;\n      tasks[url].timestamp = now.getTime() + TTL;\n      tasks[url].processing = false;\n    }\n    discardExpiredFetchTasks();\n    return result;\n  } else {\n    // Reject promises\n    if (tasks.hasOwnProperty(url)) {\n      let request = tasks[url].requests.shift();\n      while (request) {\n        request[1](FetchError);\n        setDataReceivingProgress(request[2], request[3], 0, true);\n        request = tasks[url].requests.shift();\n      }\n      tasks[url].failed = true;\n    }\n    discardExpiredFetchTasks();\n    throw FetchError;\n  }\n}\n\nfunction discardExpiredFetchTasks(): void {\n  const now = new Date().getTime();\n  for (const url in tasks) {\n    if (tasks.hasOwnProperty(url)) {\n      if (!tasks[url].processing) {\n        if (now > tasks[url].timestamp) {\n          delete tasks[url];\n          continue;\n        }\n      }\n      if (tasks[url].failed) {\n        delete tasks[url];\n        continue;\n      }\n    }\n  }\n}\n\nexport type DataReceivingProgress = {\n  [requestID: string]: {\n    [tag: string]: {\n      expel: boolean;\n      progress: number;\n      total: number;\n    };\n  };\n};\n\nconst dataReceivingProgress: DataReceivingProgress = {};\n\nexport function setDataReceivingProgress(requestID: string, tag: string, progress: number, expel: boolean): void {\n  if (!dataReceivingProgress.hasOwnProperty(requestID)) {\n    dataReceivingProgress[requestID] = {};\n  }\n  if (dataReceivingProgress[requestID].hasOwnProperty(tag)) {\n    if (expel) {\n      dataReceivingProgress[requestID][tag].expel = true;\n    } else {\n      dataReceivingProgress[requestID][tag].expel = false;\n      dataReceivingProgress[requestID][tag].progress = progress;\n    }\n    broadcastDataReceivingProgress(requestID, 'run');\n  } else {\n    dataReceivingProgress[requestID][tag] = { expel: false, progress: progress, total: 1 };\n    broadcastDataReceivingProgress(requestID, 'start');\n  }\n}\n\nexport function getDataReceivingProgress(requestID: string): number {\n  if (dataReceivingProgress.hasOwnProperty(requestID)) {\n    if (typeof dataReceivingProgress[requestID] === 'object') {\n      let total: number = 0;\n      let received: number = 0;\n      for (const key in dataReceivingProgress[requestID]) {\n        if (!dataReceivingProgress[requestID][key].expel) {\n          total += dataReceivingProgress[requestID][key].total;\n          received += dataReceivingProgress[requestID][key].progress;\n        }\n      }\n      const progress = Math.min(Math.max(received / total, 0), 1);\n      return progress === Infinity || isNaN(progress) ? 1 : progress;\n    }\n  }\n  return 1;\n}\n\nexport function deleteDataReceivingProgress(requestID: string): void {\n  if (dataReceivingProgress.hasOwnProperty(requestID)) {\n    delete dataReceivingProgress[requestID];\n    broadcastDataReceivingProgress(requestID, 'end');\n  }\n}\n\nexport interface DataReceivingProgressEventDict {\n  target: string;\n  stage: 'start' | 'run' | 'end';\n  progress: number;\n}\n\nexport type DataReceivingProgressEvent = CustomEvent<DataReceivingProgressEventDict>;\n\nexport function broadcastDataReceivingProgress(requestID: string, stage: DataReceivingProgressEventDict['stage']): void {\n  const eventDict: DataReceivingProgressEventDict = {\n    target: requestID,\n    stage: stage,\n    progress: getDataReceivingProgress(requestID)\n  };\n  const event = new CustomEvent(requestID, { detail: eventDict });\n  document.dispatchEvent(event);\n}\n\nexport type DataUpdateTime = { [key: string]: number };\n\nexport const dataUpdateTime: DataUpdateTime = {};\n\nexport function setDataUpdateTime(requestID: string, timestamp: string | number): void {\n  if (!dataUpdateTime.hasOwnProperty(requestID)) {\n    dataUpdateTime[requestID] = 0;\n  }\n  let timeNumber = 0;\n  if (typeof timestamp === 'string') {\n    timeNumber = timeStampToNumber(timestamp);\n  }\n  if (timeNumber > dataUpdateTime[requestID]) {\n    dataUpdateTime[requestID] = timeNumber;\n  }\n}\n\nexport function getDataUpdateTime(requestID: string): number {\n  if (dataUpdateTime.hasOwnProperty(requestID)) {\n    return dataUpdateTime[requestID] * 1;\n  } else {\n    return 0;\n  }\n}\n\nexport function deleteDataUpdateTime(requestID: string): void {\n  if (dataUpdateTime.hasOwnProperty(requestID)) {\n    delete dataUpdateTime[requestID];\n  }\n}\n","import { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataUpdateTime } from '../loader';\n\nexport interface BusDataItem {\n  ProviderID: number;\n  StationID: number;\n  BusID: string; // vehicle registration number\n  CarType: '0' | '1' | '2' | '3'; // 0: normal bus (), 1: low-floor bus (), 2: disability-friendly bus (), 3: dog-friendly bus ()\n  CarID: number;\n  DutyStatus: '0' | '1' | '2'; // 0: normal, 1: start, 2: end\n  BusStatus: '0' | '1' | '2' | '3' | '4' | '5' | '99'; // 0: , 1: , 2: , 3: , 4: , 5: , 99: \n  RouteID: string; // number in string\n  GoBack: '0' | '1' | '2'; // 0: go, 1: back, 2: unknown\n  Longitude: string; // number in string\n  Latitude: string; // number in string\n  Speed: string; // number in string\n  Azimuth: string; // number in string\n  DataTime: string; // timestamp\n}\n\nexport type BusData = Array<BusDataItem>;\n\nexport async function getBusData(requestID: string): Promise<BusData> {\n  const apis = [\n    [0, 0],\n    [1, 0]\n  ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n  let result = [];\n  for (const api of apis) {\n    const data = await fetchData(api.url, requestID, `getBusData_${api.e[0]}`, 'json');\n    result = result.concat(data.BusInfo);\n    setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n  }\n  return result;\n}\n","import { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataUpdateTime } from '../loader';\n\nexport interface BusEventItem {\n  StationID: number;\n  CarType: '0' | '1' | '2' | '3'; // 0: normal bus (), 1: low-floor bus (), 2: disability-friendly bus (), 3: dog-friendly bus ()\n  BusID: string; // vehicle registration number\n  ProviderID: number;\n  CarID: number;\n  DutyStatus: '0' | '1' | '2'; // 0: normal, 1: start, 2: end\n  BusStatus: '0' | '1' | '2' | '3' | '4' | '5' | '99'; // 0: , 1: , 2: , 3: , 4: , 5: , 99: \n  RouteID: string; // PathAttributeId (number in string)\n  GoBack: '0' | '1' | '2'; // 0: go, 1: back, 2: unknown\n  StopID: string; // number in string\n  CarOnStop: '0' | '1'; // 0: leaving/left, 1: coming/came\n  DataTime: string; // timestamp\n}\n\nexport type BusEvent = Array<BusEventItem>;\n\nexport async function getBusEvent(requestID: string): Promise<BusEvent> {\n  const apis = [\n    [0, 1],\n    [1, 1]\n  ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n  let result = [];\n  for (const api of apis) {\n    const data = await fetchData(api.url, requestID, `getBusEvent_${api.e[0]}`, 'json');\n    result = result.concat(data.BusInfo);\n    setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n  }\n  return result;\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nexport interface CarInfoItem {\n  BusId: number; // BusId  BusID\n  BusNId: string;\n  CarNum: string; // CarNumber = BusID = vehicle registration number\n  CarType: '0' | '1' | '2' | '3'; // 0: normal bus (), 1: low-floor bus (), 2: disability-friendly bus (), 3: dog-friendly bus ()\n  IboxId: number;\n  StationId: number;\n  PathAttributeId: number;\n  BuildPeriod: string;\n  Ctime: string;\n}\n\nexport type CarInfo = Array<CarInfoItem>;\n\nexport interface SimplifiedCarInfoItem {\n  BusId: CarInfoItem['BusId'];\n  CarNum: CarInfoItem['CarNum'];\n  CarType: CarInfoItem['CarType'];\n  PathAttributeId: CarInfoItem['PathAttributeId'];\n}\n\nexport type SimplifiedCarInfo = { [key: string]: SimplifiedCarInfoItem };\n\nconst CarInfoAPIVariableCache = {\n  raw: {\n    data: [],\n    available: false\n  },\n  simplified: {\n    data: {},\n    available: false\n  }\n};\n\nasync function simplifyCarInfo(CarInfo: CarInfo): Promise<SimplifiedCarInfo> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"simplifyCarInfo-worker\" */ './simplifyCarInfo-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(CarInfo); // Send data to the worker\n  });\n\n  return result;\n}\n\nexport async function getCarInfo(requestID: string, simplified: boolean = false): Promise<CarInfo | SimplifiedCarInfo> {\n  async function getData() {\n    const apis = [\n      [0, 2],\n      [1, 2]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getCarInfo_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n\n  const cacheType = simplified ? 'simplified' : 'raw';\n  const cacheKey = `bus_${cacheType}_car_info_cache`;\n  const cacheTimeToLive = 60 * 60 * 24 * 30 * 1000;\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    let finalResult;\n    if (simplified) {\n      finalResult = await simplifyCarInfo(result);\n    } else {\n      finalResult = result;\n    }\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(finalResult));\n    if (!CarInfoAPIVariableCache[cacheType].available) {\n      CarInfoAPIVariableCache[cacheType].available = true;\n      CarInfoAPIVariableCache[cacheType].data = finalResult;\n    }\n    return finalResult;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      let finalResult;\n      if (simplified) {\n        finalResult = await simplifyCarInfo(result);\n      } else {\n        finalResult = result;\n      }\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(finalResult));\n      return finalResult;\n    } else {\n      if (!CarInfoAPIVariableCache[cacheType].available) {\n        const cache = await lfGetItem(0, cacheKey);\n        CarInfoAPIVariableCache[cacheType].available = true;\n        CarInfoAPIVariableCache[cacheType].data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getCarInfo_0', 0, true);\n      setDataReceivingProgress(requestID, 'getCarInfo_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return CarInfoAPIVariableCache[cacheType].data;\n    }\n  }\n}\n","import { ParsedAddress } from '../../../tools/address';\nimport { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nexport interface LocationItem {\n  Id: number; // StopID\n  routeId: number; // RouteID\n  nameZh: string; // name in Chinese\n  nameEn: string; // name in English\n  seqNo: number; // sequence on the route\n  pgp: string; // pgp (-1: get off, 0: get on and off, 1: get on)\n  goBack: '0' | '1' | '2'; // GoBack (0: go, 1: back, 2: unknown)\n  longitude: string; // number in string\n  latitude: string; // number in string\n  address: string;\n  stopLocationId: number; // LocationID\n  showLon: string; // number in string\n  showLat: string; // number in string\n  vector: string;\n}\n\nexport type Location = Array<LocationItem>;\n\nexport interface SimplifiedLocationItem {\n  n: string; // name\n  lo: number; // longitude\n  la: number; // latitude\n  g: string; // geohash\n  r: Array<number>; // RouteIDs\n  s: Array<number>; // StopIDs\n  v: Array<[number, number]>; // a set of vectors\n  a: Array<string>; // addresses\n  id: number; // stopLocationId\n}\n\nexport type SimplifiedLocation = { [l_id: string]: SimplifiedLocationItem };\n\nexport interface MergedLocationItem {\n  n: string; // name\n  lo: Array<number>; // longitude\n  la: Array<number>; // latitude\n  g: Array<string>; // geohash\n  r: Array<Array<number>>; // RouteIDs\n  s: Array<Array<number>>; // StopIDs\n  v: Array<Array<[number, number]>>; // sets of vectors\n  a: Array<ParsedAddress>; // addresses\n  id: Array<number>; // stopLocationIds\n  hash: string;\n}\n\nexport type MergedLocation = { [ml_hash: string]: MergedLocationItem };\n\nexport interface IndexedLocationItem {\n  lo: number; // longitude\n  la: number; // latitude\n  hash: string;\n}\n\nexport type IndexedLocation = { [geohash: string]: Array<IndexedLocationItem> };\n\nconst LocationAPIVariableCache = {\n  simplified: {\n    available: false,\n    data: {}\n  },\n  merged: {\n    available: false,\n    data: {}\n  },\n  indexed: {\n    available: false,\n    data: {}\n  }\n};\n\nasync function simplifyLocation(Location: Location): Promise<SimplifiedLocation> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"simplifyLocation-worker\" */ './simplifyLocation-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(Location); // Send data to the worker\n  });\n\n  return result;\n}\n\nasync function mergeLocationByName(object: SimplifiedLocation): Promise<MergedLocation> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"mergeLocationByName-worker\" */ './mergeLocationByName-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(object); // Send data to the worker\n  });\n\n  return result;\n}\n\nasync function indexLocationByGeohash(object: MergedLocation): Promise<IndexedLocation> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"indexLocationByGeohash-worker\" */ './indexLocationByGeohash-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(object); // Send data to the worker\n  });\n\n  return result;\n}\n\n/**\n * getLocation\n * @param requestID\n * @param type 0: simplified, 1: merged, 2: indexed\n * @returns SimplifiedLocation, MergedLocation, or IndexedLocation\n */\n\nexport async function getLocation(requestID: string, type: 0 | 1 | 2): Promise<SimplifiedLocation | MergedLocation | IndexedLocation> {\n  async function getData() {\n    const apis = [\n      [0, 11],\n      [1, 11]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getLocation_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 30 * 1000;\n  const cacheType = ['simplified', 'merged', 'indexed'][type];\n  const cacheKey = `bus_${cacheType}_location_cache`;\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    let finalResult;\n    switch (type) {\n      case 0: {\n        const result = await getData();\n        const simplified_result = await simplifyLocation(result);\n        finalResult = simplified_result;\n        break;\n      }\n      case 1: {\n        const simplified_result = await getLocation(requestID, 0);\n        const merged_result = await mergeLocationByName(simplified_result);\n        finalResult = merged_result;\n        break;\n      }\n      case 2: {\n        const merged_result = await getLocation(requestID, 1);\n        const indexed_result = await indexLocationByGeohash(merged_result);\n        finalResult = indexed_result;\n        break;\n      }\n      default:\n        break;\n    }\n\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(finalResult));\n    if (!LocationAPIVariableCache[cacheType].available) {\n      LocationAPIVariableCache[cacheType].available = true;\n      LocationAPIVariableCache[cacheType].data = finalResult;\n    }\n    return finalResult;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      let finalResult;\n      switch (type) {\n        case 0: {\n          const result = await getData();\n          const simplified_result = await simplifyLocation(result);\n          finalResult = simplified_result;\n          break;\n        }\n        case 1: {\n          const simplified_result = await getLocation(requestID, 0);\n          const merged_result = await mergeLocationByName(simplified_result);\n          finalResult = merged_result;\n          break;\n        }\n        case 2: {\n          const merged_result = await getLocation(requestID, 1);\n          const indexed_result = await indexLocationByGeohash(merged_result);\n          finalResult = indexed_result;\n          break;\n        }\n        default:\n          break;\n      }\n\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(finalResult));\n      if (!LocationAPIVariableCache[cacheType].available) {\n        LocationAPIVariableCache[cacheType].available = true;\n        LocationAPIVariableCache[cacheType].data = finalResult;\n      }\n      return finalResult;\n    } else {\n      if (!LocationAPIVariableCache[cacheType].available) {\n        const cache = await lfGetItem(0, cacheKey);\n        LocationAPIVariableCache[cacheType].available = true;\n        LocationAPIVariableCache[cacheType].data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getLocation_0', 0, true);\n      setDataReceivingProgress(requestID, 'getLocation_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return LocationAPIVariableCache[cacheType].data;\n    }\n  }\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nexport interface StopItem {\n  Id: number; // StopID\n  routeId: number; // RouteID\n  nameZh: string; // name in Chinese\n  nameEn: string; // name in English\n  seqNo: number; // sequence on the route\n  pgp: string; // pgp (-1: get off, 0: get on and off, 1: get on)\n  goBack: '0' | '1' | '2'; // GoBack (0: go, 1: back, 2: unknown)\n  longitude: string; // number in string\n  latitude: string; // number in string\n  address: string;\n  stopLocationId: number; // LocationID\n  showLon: string; // number in string\n  showLat: string; // number in string\n  vector: string;\n}\n\nexport type Stop = Array<StopItem>;\n\nexport interface SimplifiedStopItem {\n  seqNo: number;\n  goBack: '0' | '1' | '2'; // GoBack (0: go, 1: back, 2: unknown)\n  stopLocationId: number;\n}\n\nexport type SimplifiedStop = { [key: string]: SimplifiedStopItem };\n\nlet StopAPIVariableCache_available: boolean = false;\nlet StopAPIVariableCache_data: SimplifiedStop = {};\n\nasync function simplifyStop(array: Stop): Promise<SimplifiedStop> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"simplifyStop-worker\" */ './simplifyStop-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(array); // Send data to the worker\n  });\n\n  return result;\n}\n\nexport async function getStop(requestID: string): Promise<SimplifiedStop> {\n  async function getData() {\n    const apis = [\n      [0, 11],\n      [1, 11]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getStop_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 45 * 1000;\n  const cacheKey = 'bus_stop_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    const simplified_result = await simplifyStop(result);\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(simplified_result));\n    if (!StopAPIVariableCache_available) {\n      StopAPIVariableCache_available = true;\n      StopAPIVariableCache_data = simplified_result;\n    }\n    return simplified_result;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      const simplified_result = await simplifyStop(result);\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(simplified_result));\n      return simplified_result;\n    } else {\n      if (!StopAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        StopAPIVariableCache_available = true;\n        StopAPIVariableCache_data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getStop_0', 0, true);\n      setDataReceivingProgress(requestID, 'getStop_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return StopAPIVariableCache_data;\n    }\n  }\n}\n","import { formatTime } from '../../tools/time';\nimport { BusData, BusDataItem } from './getBusData/index';\nimport { BusEvent, BusEventItem } from './getBusEvent/index';\nimport { SimplifiedRoute } from './getRoute/index';\n\nexport interface EstimateTimeStatus {\n  code: 0 | 0.5 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8; // 8: loading\n  text: string;\n  time: number;\n}\n\nexport function parseEstimateTime(EstimateTime: string, mode: number): EstimateTimeStatus {\n  if (typeof EstimateTime === 'string') {\n    const time = parseInt(EstimateTime);\n    if (time === -3) {\n      return { code: 6, text: '', time };\n    }\n    if (time === -4) {\n      return { code: 5, text: '', time };\n    }\n    if (time === -2) {\n      return { code: 4, text: '', time };\n    }\n    if (time === -1) {\n      return { code: 3, text: '', time };\n    }\n    if (0 <= time && time <= 10) {\n      return { code: 2, text: '', time };\n    }\n    if (10 < time && time <= 180) {\n      return { code: 1, text: formatTime(time, mode), time };\n    }\n    if (180 < time && time <= 250) {\n      return { code: 0.5, text: formatTime(time, mode), time };\n    }\n    if (250 < time) {\n      return { code: 0, text: formatTime(time, mode), time };\n    }\n  }\n  return { code: 7, text: '', time: -5 };\n}\n\nexport interface TimeMoment {\n  type: 'moment';\n  hours: number;\n  minutes: number;\n}\n\nexport interface TimeRange {\n  type: 'range';\n  min: number;\n  max: number;\n}\n\n/**\n * parseTimeCode\n * @param code 0: hhmm/mm, 1: mmMM/mm\n * @param mode 0: moment, 1: range\n * @returns 0: TimeMoment, 1: TimeRange\n */\n\nexport function parseTimeCode(code: string, mode: 0 | 1): TimeMoment | TimeRange {\n  const codeLength = code.length;\n  if (mode === 0) {\n    let hours = 0;\n    let minutes = 0;\n    if (codeLength === 4) {\n      hours = parseInt(code.substring(0, 2));\n      minutes = parseInt(code.substring(2, 4));\n    }\n    if (codeLength === 2) {\n      minutes = parseInt(code);\n    }\n    return {\n      type: 'moment',\n      hours: hours,\n      minutes: minutes\n    };\n  }\n  if (mode === 1) {\n    let min = 0;\n    let max = 0;\n    if (codeLength === 4) {\n      const number1 = parseInt(code.substring(0, 2));\n      const number2 = parseInt(code.substring(2, 4));\n      min = Math.min(number1, number2);\n      max = Math.max(number1, number2);\n    }\n    if (codeLength === 2) {\n      const number = parseInt(code);\n      min = number;\n      max = number;\n    }\n    return {\n      type: 'range',\n      min: min,\n      max: max\n    };\n  }\n}\n\nexport interface BatchFoundBusPosition {\n  longitude: number;\n  latitude: number;\n}\n\nexport interface BatchFoundBus {\n  CarType: BusEventItem['CarType'];\n  BusStatus: BusEventItem['BusStatus'];\n  BusID: string;\n  CarOnStop: BusEventItem['CarOnStop'];\n  onThisRoute: boolean;\n  position: BatchFoundBusPosition;\n  RouteName: string;\n  RouteID: number;\n  index: number;\n}\n\nexport type BatchFoundBuses = { [key: string]: Array<BatchFoundBus> };\n\nexport function batchFindBusesForRoute(BusEvent: BusEvent, BusData: BusData, Route: SimplifiedRoute, RouteID: number, PathAttributeId: Array<number>): BatchFoundBuses {\n  const result = {} as BatchFoundBuses;\n  const BusDataObj: {\n    [key: string]: BusDataItem;\n  } = {};\n  for (const BusDataItem of BusData) {\n    const thisBusID = BusDataItem.BusID;\n    BusDataObj[thisBusID] = BusDataItem;\n  }\n\n  for (const BusEventItem of BusEvent) {\n    const processedItem = {} as BatchFoundBus;\n\n    // collect data from 'BusEvent'\n    processedItem.CarType = BusEventItem.CarType;\n    processedItem.BusStatus = BusEventItem.BusStatus;\n    processedItem.BusID = BusEventItem.BusID;\n    processedItem.CarOnStop = BusEventItem.CarOnStop;\n\n    // check whether this bus is on the route\n    const thisRouteID = parseInt(BusEventItem.RouteID);\n    const thisBusID = String(BusEventItem.BusID);\n    let isOnThisRoute: boolean = false;\n    let index: number = 0;\n    if (thisRouteID === RouteID || PathAttributeId.indexOf(thisRouteID) > -1 || thisRouteID === RouteID * 10) {\n      isOnThisRoute = true;\n      index = thisBusID.charCodeAt(0) * Math.pow(10, -5);\n    } else {\n      isOnThisRoute = false;\n      index = thisBusID.charCodeAt(0);\n    }\n    processedItem.onThisRoute = isOnThisRoute;\n    processedItem.index = index;\n\n    // collect data from 'BusData'\n    let thisBusData = {} as BusDataItem;\n    if (BusDataObj.hasOwnProperty(thisBusID)) {\n      thisBusData = BusDataObj[thisBusID];\n    } else {\n      continue;\n    }\n    processedItem.position = {\n      latitude: parseFloat(thisBusData.Latitude),\n      longitude: parseFloat(thisBusData.Longitude)\n    };\n\n    // search data from 'Route'\n    let searchedRoute = {};\n    let isRouteSearched = false;\n    for (const key in Route) {\n      const thisRouteItem = Route[key];\n      const pid = thisRouteItem.pid;\n      if (pid.indexOf(thisRouteID) > -1) {\n        searchedRoute = thisRouteItem;\n        isRouteSearched = true;\n        break;\n      }\n    }\n    processedItem.RouteName = isRouteSearched ? searchedRoute.n : '';\n    processedItem.RouteID = isRouteSearched ? searchedRoute.id : null;\n\n    const StopKey = `s_${BusEventItem.StopID}`;\n    if (!result.hasOwnProperty(StopKey)) {\n      result[StopKey] = [];\n    }\n    result[StopKey].push(processedItem);\n    // Handle multiple buses (of the same route) on a stop\n  }\n  return result;\n}\n\nexport function batchFindBusesForLocation(BusEvent: BusEvent, BusData: BusData, Route: SimplifiedRoute, StopIDList: Array<number>): BatchFoundBuses {\n  const result = {} as BatchFoundBuses;\n  const BusDataObj: {\n    [BusID: string]: BusDataItem;\n  } = {};\n  for (const BusDataItem of BusData) {\n    const thisBusID = BusDataItem.BusID;\n    BusDataObj[thisBusID] = BusDataItem;\n  }\n\n  for (const BusEventItem of BusEvent) {\n    const processedItem = {} as BatchFoundBus;\n\n    const thisStopID = parseInt(BusEventItem.StopID);\n    const thisRouteID = parseInt(BusEventItem.RouteID);\n    const thisBusID = String(BusEventItem.BusID);\n\n    // Check whether this bus is on one of the specified stops\n    if (StopIDList.indexOf(thisStopID) < 0) {\n      continue;\n    }\n\n    processedItem.index = thisBusID.charCodeAt(0);\n    processedItem.onThisRoute = true; // Every entry in Location is stop-route pair\n\n    // Collect data from 'BusEvent'\n    processedItem.CarType = BusEventItem.CarType;\n    processedItem.BusStatus = BusEventItem.BusStatus;\n    processedItem.BusID = BusEventItem.BusID;\n    processedItem.CarOnStop = BusEventItem.CarOnStop;\n\n    // Collect data from 'BusData'\n    let thisBusData = {} as BusDataItem;\n    if (BusDataObj.hasOwnProperty(thisBusID)) {\n      thisBusData = BusDataObj[thisBusID];\n    } else {\n      continue;\n    }\n    processedItem.position = {\n      latitude: parseFloat(thisBusData.Latitude),\n      longitude: parseFloat(thisBusData.Longitude)\n    };\n\n    // Search data from 'Route'\n    let searchedRoute = {};\n    let isRouteSearched = false;\n    for (const key in Route) {\n      const thisRouteItem = Route[key];\n      const pid = thisRouteItem.pid;\n      if (pid.indexOf(thisRouteID) > -1) {\n        searchedRoute = thisRouteItem;\n        isRouteSearched = true;\n        break;\n      }\n    }\n    processedItem.RouteName = isRouteSearched ? searchedRoute.n : '';\n    processedItem.RouteID = isRouteSearched ? searchedRoute.id : null;\n\n    const StopKey = `s_${thisStopID}`;\n    if (!result.hasOwnProperty(StopKey)) {\n      result[StopKey] = [];\n    }\n    result[StopKey].push(processedItem);\n  }\n  return result;\n}\n\ninterface FormattedBusStatus {\n  onStop: boolean;\n  situation: string;\n  text: string;\n}\n\ninterface FormattedBusPosition {\n  longitude: number;\n  latitude: number;\n}\n\nexport function parseCarType(CarType: '0' | '1' | '2' | '3'): '' | '' | '' | '' | '' {\n  let type = '';\n  switch (CarType) {\n    case '0':\n      type = '';\n      break;\n    case '1':\n      type = '';\n      break;\n    case '2':\n      type = '';\n      break;\n    case '3':\n      type = '';\n      break;\n    default:\n      type = '';\n  }\n  return type;\n}\n\nexport function parseCarOnStop(CarOnStop: '0' | '1'): string {\n  let onStop = '';\n  switch (CarOnStop) {\n    case '0':\n      onStop = '';\n      break;\n    case '1':\n      onStop = '';\n      break;\n    default:\n      onStop = ''; // Handle unexpected values if necessary\n  }\n  return onStop;\n}\n\nexport function parseBusStatus(BusStatus: '0' | '1' | '2' | '3' | '4' | '5' | '99'): string {\n  let situation = '';\n  switch (BusStatus) {\n    case '0':\n      situation = '';\n      break;\n    case '1':\n      situation = '';\n      break;\n    case '2':\n      situation = '';\n      break;\n    case '3':\n      situation = '';\n      break;\n    case '4':\n      situation = '';\n      break;\n    case '5':\n      situation = '';\n      break;\n    case '99':\n      situation = '';\n      break;\n    default:\n      situation = ''; // Handle unexpected values if necessary\n  }\n  return situation;\n}\n\nexport interface FormattedBus {\n  type: '' | '' | '' | '' | '';\n  carNumber: string;\n  status: FormattedBusStatus;\n  RouteName: string;\n  onThisRoute: boolean;\n  index: number;\n  position: FormattedBusPosition;\n}\n\nexport function formatBus(batchFoundBus: BatchFoundBus): FormattedBus {\n  const result = {} as FormattedBus;\n\n  const CarType = batchFoundBus.CarType;\n  const type = parseCarType(CarType);\n  result.type = type;\n\n  const CarOnStop = batchFoundBus.CarOnStop;\n  const onStop = parseCarOnStop(CarOnStop);\n\n  const BusStatus = batchFoundBus.BusStatus;\n  const situation = parseBusStatus(BusStatus);\n\n  result.carNumber = batchFoundBus.BusID;\n  result.status = {\n    onStop: onStop,\n    situation: situation,\n    text: `${onStop} | ${situation}`\n  };\n  result.RouteName = batchFoundBus.RouteName;\n  result.onThisRoute = batchFoundBus.onThisRoute;\n  result.index = batchFoundBus.index;\n  result.position = batchFoundBus.position;\n  return result;\n}\n","// Function to split data based on delta\n\n/**\n * Splits data into groups based on delta between consecutive elements.\n *\n * @param {Array<[number, number]>} data - Array of tuples where each tuple contains two numbers.\n * @returns {Array<Array<[number, number]>>} - Array of groups, each containing arrays of tuples.\n */\n\nexport function splitDataByDelta(data: Array<[number, number]>): Array<Array<[number, number]>> {\n  const result: Array<Array<[number, number]>> = [];\n  let currentGroup: Array<[number, number]> = [];\n\n  for (let i = 0; i < data.length; i++) {\n    if (i === 0 || data[i][0] - data[i - 1][0] > 0) {\n      if (currentGroup.length > 0) {\n        result.push(currentGroup);\n      }\n      currentGroup = [data[i]];\n    } else {\n      currentGroup.push(data[i]);\n    }\n  }\n\n  if (currentGroup.length > 0) {\n    result.push(currentGroup);\n  }\n\n  return result;\n}\n\nexport function areItemsDifferent(arr: Array): boolean {\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = i + 1; j < arr.length; j++) {\n      if (arr[i] === arr[j]) {\n        return false; // Found a duplicate\n      }\n    }\n  }\n  return true; // No duplicates found\n}\n\n/**\n * Get common items from the two arrays\n * @param arrayA - The first array\n * @param arrayB - The second array\n * @returns An array of the common items\n */\n\nexport function getIntersection(arrayA: Array, arrayB: Array): Array {\n  let result = [];\n  if (arrayA.length <= arrayB.length) {\n    for (const item of arrayA) {\n      if (arrayB.indexOf(item) > -1) {\n        result.push(item);\n      }\n    }\n  } else {\n    for (const item of arrayB) {\n      if (arrayA.indexOf(item) > -1) {\n        result.push(item);\n      }\n    }\n  }\n  return result;\n}\n","import { getTextWidth } from './graphic';\n\nexport function getUnicodes(string: string, unique: boolean = true): Array<number> {\n  let result = [];\n  if (typeof string === 'string') {\n    const stringLength = string.length;\n    for (let i = 0; i < stringLength; i++) {\n      const unicode = string.charCodeAt(i);\n      if (result.indexOf(unicode) < 0 || !unique) {\n        result.push(unicode);\n      }\n    }\n  }\n  return result;\n}\n\nexport function containPhoneticSymbols(string: string): boolean {\n  const regex = /[\\u3100-\\u312F\\\\\\\\]/gm;\n  if (regex.test(string)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function truncateText(text: string, weight: number, size: string, fontFamily: string, maxWidth: number): string {\n  const ellipsis = '...';\n  const ellipsisWidth = getTextWidth(ellipsis, weight, size, fontFamily);\n  const fullTextWidth = getTextWidth(text, weight, size, fontFamily);\n  const fullTextLength = text.length;\n  if (fullTextLength === 0) {\n    return text;\n  }\n  if (fullTextWidth <= maxWidth) {\n    return text;\n  } else {\n    const averageCharacterWidth = fullTextWidth / fullTextLength;\n    const truncatedLength = Math.floor(maxWidth / averageCharacterWidth) - 2;\n    let lengthAdjustment = 0;\n    let lastLength = 0;\n    for (let i = 0; i < 5; i++) {\n      const adjustedText = text.substring(0, truncatedLength + lengthAdjustment);\n      const adjustedTextWidth = getTextWidth(adjustedText, weight, size, fontFamily) + ellipsisWidth;\n      if (adjustedTextWidth <= maxWidth) {\n        lastLength = truncatedLength + lengthAdjustment;\n        lengthAdjustment += 1;\n      } else {\n        break;\n      }\n    }\n    return `${text.substring(0, lastLength)}${ellipsis}`;\n  }\n}\n\nexport function formatNumberWithSuffix(num: number, maxLength: number = 4): string {\n  const suffixes = ['', 'K', 'M', 'B', 'T', 'Q'];\n  let magnitude = 0;\n\n  while (Math.abs(num) >= 1000 && magnitude < suffixes.length - 1) {\n    num /= 1000;\n    magnitude++;\n  }\n\n  let numStr = num.toFixed(1).replace(/\\.0$/, '');\n\n  while (numStr.length + suffixes[magnitude].length > maxLength && numStr.includes('.')) {\n    numStr = numStr.slice(0, -1);\n  }\n\n  return numStr + suffixes[magnitude];\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nexport interface RouteItem {\n  providerId: number;\n  providerName: string;\n  nameZh: string; // name in Chinese\n  nameEn: string; // name in English\n  aliasName: string; // another name in Chinese\n  pathAttributeId: number;\n  pathAttributeNId: string;\n  pathAttributeName: string; // another name in Chinese\n  pathAttributeEname: string; // another name in English\n  buildPeriod: '1' | '2' | '3' | '9' | '10';\n  departureZh: string; // departure stop name in Chinese\n  destinationZh: string; // destination stop name in Chinese\n  departureEn: string; // departure stop name in English\n  destinationEn: string; // destination stop name in English\n  goFirstBusTime: string; // time code (hhmm)\n  goLastBusTime: string;\n  backFirstBusTime: string;\n  backLastBusTime: string;\n  offPeakHeadway: string; // time code (hhmm or mm)\n  busTimeDesc: string;\n  roadMapUrl: string;\n  headwayDesc: string;\n  holidayGoFirstBusTime: string;\n  holidayBackFirstBusTime: string;\n  holidayBackLastBusTime: string;\n  holidayGoLastBusTime: string;\n  holidayBusTimeDesc: string;\n  realSequence: string; // number in string\n  holidayHeadwayDesc: string;\n  holidayOffPeakHeadway: string;\n  holidayPeakHeadway: string;\n  segmentBufferEn: string;\n  ticketPriceDescriptionZh: string;\n  ticketPriceDescriptionEn: string;\n  peakHeadway: string;\n  ttiaPathId: string;\n  segmentBufferZh: string;\n  distance: string;\n  NId: string;\n  Id: number; // RouteID\n  routeType: string;\n}\n\nexport type Route = Array<RouteItem>;\n\nexport interface SimplifiedRouteItem {\n  pd: number;\n  n: string;\n  pid: Array<number>;\n  dep: string;\n  des: string;\n  id: number;\n}\n\nexport type SimplifiedRoute = { [key: string]: SimplifiedRouteItem };\n\nlet RouteAPIVariableCache_available: boolean = false;\nlet RouteAPIVariableCache_data: object = {};\n\nasync function simplifyRoute(Route: Route): Promise<SimplifiedRoute> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"simplifyRoute-worker\" */ './simplifyRoute-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(Route); // Send data to the worker\n  });\n\n  return result;\n}\n\nexport async function getRoute(requestID: string, simplify: boolean = true): Promise<SimplifiedRoute | Route> {\n  async function getData() {\n    const apis = [\n      [0, 10],\n      [1, 10]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getRoute_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n  if (simplify === false) {\n    return await getData();\n  }\n  const cacheTimeToLive = 60 * 60 * 24 * 1 * 1000;\n  const cacheKey = 'bus_route_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    const simplified_result = await simplifyRoute(result);\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(simplified_result));\n    if (!RouteAPIVariableCache_available) {\n      RouteAPIVariableCache_available = true;\n      RouteAPIVariableCache_data = simplified_result;\n    }\n    return simplified_result;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      const simplified_result = await simplifyRoute(result);\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(simplified_result));\n      if (!RouteAPIVariableCache_available) {\n        RouteAPIVariableCache_available = true;\n        RouteAPIVariableCache_data = simplified_result;\n      }\n      return simplified_result;\n    } else {\n      if (!RouteAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        RouteAPIVariableCache_available = true;\n        RouteAPIVariableCache_data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getRoute_0', 0, true);\n      setDataReceivingProgress(requestID, 'getRoute_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return RouteAPIVariableCache_data;\n    }\n  }\n}\n","import { getIntersection } from '../../tools/array';\nimport { generateIdentifier } from '../../tools/index';\nimport { getUnicodes } from '../../tools/text';\nimport { getCarInfo, SimplifiedCarInfo } from '../apis/getCarInfo/index';\nimport { getLocation, MergedLocation } from '../apis/getLocation/index';\nimport { getRoute, SimplifiedRoute, SimplifiedRouteItem } from '../apis/getRoute/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../apis/loader';\n\nexport async function searchRouteByName(query: string): Promise<Array<SimplifiedRouteItem>> {\n  const requestID = generateIdentifier();\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  let result: Array<SimplifiedRouteItem> = [];\n  for (const key in Route) {\n    const thisRoute = Route[key];\n    if (String(thisRoute.n).indexOf(query) > -1) {\n      result.push(thisRoute);\n    }\n  }\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n\nexport async function searchRouteByRouteID(RouteID: number): Promise<SimplifiedRouteItem | false> {\n  const requestID = generateIdentifier();\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  let result = {} as SimplifiedRouteItem;\n  const routeKey = `r_${RouteID}`;\n  if (!Route.hasOwnProperty(routeKey)) {\n    return false;\n  }\n  result = Route[routeKey];\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n\nexport async function searchRouteByPathAttributeId(PathAttributeId: number): Promise<Array<SimplifiedRouteItem>> {\n  const requestID = generateIdentifier();\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  let result: Array<SimplifiedRouteItem> = [];\n  for (const key in Route) {\n    const thisRoute = Route[key];\n    if (String(thisRoute.pid).indexOf(PathAttributeId) > -1) {\n      result.push(thisRoute);\n    }\n  }\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n\nexport interface SearchItem {\n  id: string | number | Array<number>;\n  pid: Array<number>;\n  dep: string;\n  des: string;\n  n: string;\n  hash: string;\n  lo: Array<number>;\n  la: Array<number>;\n  r: Array<Array<number>>;\n  s: Array<Array<number>>;\n  type: 0 | 1 | 2; // 0: route, 1: location, 2: car info\n}\n\nexport interface SearchResult {\n  item: SearchItem;\n  score: number;\n}\n\nexport type SearchIndex = { [unicodeKey: string]: Array<number> };\n\nlet searchIndex: SearchIndex = {};\nlet searchList: Array<SearchItem> = [];\nlet readyToSearch: boolean = false;\n\nexport async function prepareForSearch() {\n  if (readyToSearch) {\n    return;\n  }\n\n  const requestID = generateIdentifier();\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  const mergedLocation = (await getLocation(requestID, 1)) as MergedLocation;\n  const CarInfo = (await getCarInfo(requestID, true)) as SimplifiedCarInfo;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n\n  let index: SearchIndex = {};\n  let list: Array<SearchItem> = [];\n  let i: number = 0;\n  for (const key in Route) {\n    const thisRoute = Route[key];\n    const thisItem = {\n      id: thisRoute.id,\n      pid: thisRoute.pid,\n      dep: thisRoute.dep,\n      des: thisRoute.des,\n      n: thisRoute.n,\n      hash: '',\n      lo: '',\n      la: '',\n      r: '',\n      s: '',\n      type: 0\n    };\n    list.push(thisItem);\n    const unicodes = getUnicodes(`${thisItem.n.toLowerCase()}${thisItem.dep.toLowerCase()}${thisItem.des.toLowerCase()}`, true);\n    for (const unicode of unicodes) {\n      const key = `u_${unicode}`;\n      if (!index.hasOwnProperty(key)) {\n        index[key] = [];\n      }\n      index[key].push(i);\n    }\n    i += 1;\n  }\n  for (const key in mergedLocation) {\n    const thisLocation = mergedLocation[key];\n    const thisItem = {\n      id: thisLocation.id,\n      n: thisLocation.n,\n      lo: thisLocation.lo,\n      la: thisLocation.la,\n      r: thisLocation.r,\n      s: thisLocation.s,\n      hash: thisLocation.hash,\n      dep: '',\n      des: '',\n      pid: [],\n      type: 1\n    };\n    list.push(thisItem);\n    const unicodes = getUnicodes(thisItem.n.toLowerCase(), true);\n    for (const unicode of unicodes) {\n      const key = `u_${unicode}`;\n      if (!index.hasOwnProperty(key)) {\n        index[key] = [];\n      }\n      index[key].push(i);\n    }\n    i += 1;\n  }\n  for (const key in CarInfo) {\n    const thisCarInfo = CarInfo[key];\n    const thisItem = {\n      id: thisCarInfo.BusId,\n      pid: [],\n      dep: '',\n      des: '',\n      n: thisCarInfo.CarNum,\n      hash: '',\n      lo: '',\n      la: '',\n      r: '',\n      s: '',\n      type: 2\n    };\n    list.push(thisItem);\n    const unicodes = getUnicodes(thisItem.n.toLowerCase(), true);\n    for (const unicode of unicodes) {\n      const key = `u_${unicode}`;\n      if (!index.hasOwnProperty(key)) {\n        index[key] = [];\n      }\n      index[key].push(i);\n    }\n    i += 1;\n  }\n  searchIndex = index;\n  searchList = list;\n  readyToSearch = true;\n}\n\nfunction calculateSearchResultScore(queryUnicodes: Array<number>, resultUnicodes: Array<number>): number {\n  // 1. Index data by characters for entries well-differentiated in characters\n  // 2. The results are ranked by positional difference for relevance\n  // 3. Some entries are prioritized for exact matches\n  let score = 0;\n  let i = 0;\n  for (const unicode of resultUnicodes) {\n    const indexOfUnicode = queryUnicodes.indexOf(unicode, i);\n    score += indexOfUnicode - i;\n    i += 1;\n  }\n  if (queryUnicodes === resultUnicodes) {\n    score = Math.abs(score) * 10;\n  }\n  return score;\n}\n\nexport function searchFor(query: string, type: SearchItem['type'] | -1, limit: number): Array<SearchResult> {\n  if (!readyToSearch) {\n    return [];\n  }\n\n  const lowerCaseQuery = query.toLowerCase();\n  const queryUnicodes = getUnicodes(lowerCaseQuery, true);\n  const asIsQueryUnicodes = getUnicodes(lowerCaseQuery, false);\n  let unicodeGroups = [];\n\n  for (const unicode of queryUnicodes) {\n    const key = `u_${unicode}`;\n    if (searchIndex.hasOwnProperty(key)) {\n      unicodeGroups.push(searchIndex[key]);\n    }\n  }\n\n  unicodeGroups.sort(function (a, b) {\n    return a.length - b.length;\n  });\n\n  const unicodeGroupsLength1 = unicodeGroups.length - 1;\n  let intersection = [];\n\n  if (unicodeGroupsLength1 === 0) {\n    intersection = unicodeGroups[0];\n  }\n\n  if (unicodeGroupsLength1 > 0) {\n    for (let i = 0; i < unicodeGroupsLength1; i++) {\n      const currentGroup = unicodeGroups[i];\n      const nextGroup = unicodeGroups[i + 1];\n      if (i === 0) {\n        intersection = getIntersection(currentGroup, nextGroup);\n      } else {\n        intersection = getIntersection(intersection, nextGroup);\n      }\n    }\n  }\n\n  let result: Array<SearchResult> = [];\n  let quantity: number = 0;\n\n  const exactMatchIds = new Set(); // Track exact matches to avoid duplicates\n  if (type === -1 || type === 2) {\n    // Prioritize exact matches for buses\n    const exactMatches = searchList.filter((item) => item.n === lowerCaseQuery && item.type === 2);\n    for (const item of exactMatches) {\n      result.push({\n        item: item,\n        score: Infinity // Highest possible score for exact matches\n      });\n      exactMatchIds.add(item.id);\n      quantity += 1;\n      if (quantity >= limit) {\n        break;\n      }\n    }\n  }\n\n  if (quantity < limit) {\n    for (const j of intersection) {\n      let thisItem = searchList[j];\n\n      // Check if the item is of the type\n      if (type !== -1 && type !== thisItem.type) {\n        continue;\n      }\n\n      // Check if the item is not already an exact match\n      if (exactMatchIds.has(thisItem.id)) {\n        continue;\n      }\n\n      const score = calculateSearchResultScore(asIsQueryUnicodes, getUnicodes(thisItem.n, false));\n      if (quantity < limit) {\n        result.push({\n          item: thisItem,\n          score: score\n        });\n      } else {\n        break;\n      }\n      quantity += 1;\n    }\n  }\n\n  result.sort(function (a, b) {\n    return b.score - a.score;\n  });\n\n  return result;\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { getBusData } from '../apis/getBusData/index';\nimport { getBusEvent } from '../apis/getBusEvent/index';\nimport { CarInfoItem, getCarInfo } from '../apis/getCarInfo/index';\nimport { getLocation, SimplifiedLocation } from '../apis/getLocation/index';\nimport { getStop } from '../apis/getStop/index';\nimport { parseBusStatus, parseCarOnStop, parseCarType } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../apis/loader';\nimport { searchRouteByPathAttributeId } from '../search/index';\n\nexport interface integratedBus {\n  properties: Array<{\n    key: string;\n    icon: MaterialSymbols;\n    value: string;\n  }>;\n  RouteID: number;\n  FullPathAttributeId: Array<number>;\n}\n\nexport async function integrateBus(id: CarInfoItem['BusId'], requestID: string): Promise<integratedBus> {\n  const carKey = `c_${id}`;\n  const CarInfo = await getCarInfo(requestID, true);\n  const BusData = await getBusData(requestID);\n  const BusEvent = await getBusEvent(requestID);\n  const Stop = await getStop(requestID);\n  const Location = (await getLocation(requestID, 0)) as SimplifiedLocation;\n\n  let result: integratedBus = {\n    properties: [],\n    LocationName: ''\n  };\n\n  // Collect data from CarInfo\n  let thisCar = {};\n  if (CarInfo.hasOwnProperty(carKey)) {\n    thisCar = CarInfo[carKey];\n  } else {\n    return result;\n  }\n\n  const thisCarNumber = thisCar.CarNum;\n  result.properties.push({\n    key: 'car_number',\n    icon: 'tag',\n    value: thisCarNumber\n  });\n\n  const thisCarType = thisCar.CarType;\n  const type = parseCarType(thisCarType);\n  result.properties.push({\n    key: 'car_type',\n    icon: 'directions_bus',\n    value: type\n  });\n\n  // Collect data from BusData\n  let thisBusDataItem = {};\n  for (const BusDataItem of BusData) {\n    const thisBusDataItemBusID = BusDataItem.BusID;\n    if (thisBusDataItemBusID === thisCarNumber) {\n      thisBusDataItem = BusDataItem;\n      break;\n    }\n  }\n  const thisBusDataItemPathAttributeId = parseInt(thisBusDataItem.RouteID);\n  // result.PathAttributeId = thisBusDataItemPathAttributeId;\n  const thisBusDataItemBusStatus = thisBusDataItem.BusStatus;\n  const situation = parseBusStatus(thisBusDataItemBusStatus);\n  const thisBusDataItemGoBack = parseInt(thisBusDataItem.GoBack);\n\n  // Collect data from BusEvent\n  let thisBusEventItem = {};\n  for (const BusEventItem of BusEvent) {\n    const thisBusEventItemBusID = BusEventItem.BusID;\n    if (thisBusEventItemBusID === thisCarNumber) {\n      thisBusEventItem = BusEventItem;\n      break;\n    }\n  }\n\n  const thisBusEventItemCarOnStop = thisBusEventItem.CarOnStop;\n  const onStop = parseCarOnStop(thisBusEventItemCarOnStop);\n  result.properties.push({\n    key: 'status',\n    icon: 'vital_signs',\n    value: `${onStop} | ${situation}`\n  });\n  const thisBusEventItemStopID = thisBusEventItem.StopID;\n\n  // Search routes\n  const searchedRoutes = await searchRouteByPathAttributeId(thisBusDataItemPathAttributeId);\n  let searchedRoute = {};\n  if (searchedRoutes.length > 0) {\n    searchedRoute = searchedRoutes[0];\n  } else {\n    return result;\n  }\n  const thisRouteID = searchedRoute.id;\n  const thisRouteFullPathAttributeId = searchedRoute.pid;\n  const thisRouteName = searchedRoute.n;\n  const thisRouteDeparture = searchedRoute.dep;\n  const thisRouteDestination = searchedRoute.des;\n  const thisRouteDirection = [thisRouteDestination, thisRouteDeparture, ''][thisBusDataItemGoBack ? thisBusDataItemGoBack : 0];\n  result.properties.push({\n    key: 'route',\n    icon: 'route',\n    value: `${thisRouteName} - ${thisRouteDirection}`\n  });\n\n  result.RouteID = thisRouteID;\n  result.FullPathAttributeId = thisRouteFullPathAttributeId;\n\n  // Collect data from Stop\n  const StopKey = `s_${thisBusEventItemStopID}`;\n  let thisStopItem = {};\n  if (Stop.hasOwnProperty(StopKey)) {\n    thisStopItem = Stop[StopKey];\n  } else {\n    return result;\n  }\n  const thisStopItemStopLocationId = thisStopItem.stopLocationId;\n\n  // Collect data drom Location\n  const LocationKey = `l_${thisStopItemStopLocationId}`;\n  const thisLocationItem = Location[LocationKey];\n  const thisLocationItemName = thisLocationItem.n;\n  result.properties.push({\n    key: 'location_name',\n    icon: 'location_on',\n    value: thisLocationItemName\n  });\n\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n","import { generateIdentifier } from '../../tools/index';\nimport { dateToRelativeTime } from '../../tools/time';\nimport { getCarInfo } from '../apis/getCarInfo/index';\nimport { getLocation, MergedLocation } from '../apis/getLocation/index';\nimport { getRoute } from '../apis/getRoute/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../apis/loader';\nimport { lfGetItem, lfListItemKeys, lfRemoveItem, lfSetItem } from '../storage/index';\n\ninterface RecentViewRoute {\n  type: 'route';\n  time: string;\n  name: string;\n  id: number;\n}\n\ninterface RecentViewLocation {\n  type: 'location';\n  time: string;\n  name: string;\n  hash: string;\n}\n\ninterface RecentViewBus {\n  type: 'bus';\n  time: string;\n  name: string;\n  id: number;\n}\n\ninterface RecentViewEmpty {\n  type: 'empty';\n  time: string;\n  name: string;\n  id: number;\n}\n\nexport type RecentView = RecentViewRoute | RecentViewLocation | RecentViewBus | RecentViewEmpty;\n\nexport type RecentViewArray = Array<RecentView>;\n\nexport async function listRecentViews(): Promise<RecentViewArray> {\n  const result = [];\n  const now = new Date().getTime();\n  const keys = await lfListItemKeys(8);\n  for (const key of keys) {\n    const item = await lfGetItem(8, key);\n    const itemObject = JSON.parse(item) as RecentView;\n    const itemObjectTime = new Date(itemObject.time).getTime();\n    if (now - itemObjectTime <= 24 * 60 * 60 * 14 * 1000) {\n      result.push(itemObject);\n    }\n  }\n  if (result.length === 0) {\n    result.push({\n      type: 'empty',\n      time: new Date().toISOString(),\n      name: '',\n      id: 0\n    });\n  }\n  return result;\n}\n\nexport async function discardExpiredRecentViews() {\n  const now = new Date().getTime();\n  const keys = await lfListItemKeys(8);\n  for (const key of keys) {\n    const item = await lfGetItem(8, key);\n    const itemObject = JSON.parse(item) as RecentView;\n    const itemObjectTime = new Date(itemObject.time).getTime();\n    if (now - itemObjectTime > 24 * 60 * 60 * 14 * 1000) {\n      await lfRemoveItem(8, key);\n    }\n  }\n}\n\nexport async function logRecentView(type: RecentView['type'], param: RecentViewRoute['id'] | RecentViewLocation['hash'] | RecentViewBus['id']) {\n  const requestID = generateIdentifier();\n  const key = `${type}_${param}`;\n  const time = new Date().toISOString();\n  const existingJSON = await lfGetItem(8, key);\n  if (existingJSON) {\n    const existingRecentViewObject = JSON.parse(existingJSON) as RecentView;\n    existingRecentViewObject.time = time;\n    await lfSetItem(8, key, JSON.stringify(existingRecentViewObject));\n  } else {\n    switch (type) {\n      case 'route': {\n        const Route = await getRoute(requestID, true);\n        const routeKey = `r_${param}`;\n        if (Route.hasOwnProperty(routeKey)) {\n          const thisRoute = Route[routeKey];\n          const name = thisRoute.n;\n          const recentViewRouteObject: RecentViewRoute = {\n            type: 'route',\n            time: time,\n            name: name,\n            id: param\n          };\n          await lfSetItem(8, key, JSON.stringify(recentViewRouteObject));\n        }\n        break;\n      }\n      case 'location': {\n        const Location = (await getLocation(requestID, 1)) as MergedLocation;\n        const LocationKey = `ml_${param}`;\n        if (Location.hasOwnProperty(LocationKey)) {\n          const thisLocation = Location[LocationKey];\n          const name = thisLocation.n;\n          const recentViewLocationObject: RecentViewLocation = {\n            type: 'location',\n            time: time,\n            name: name,\n            hash: param\n          };\n          await lfSetItem(8, key, JSON.stringify(recentViewLocationObject));\n        }\n        break;\n      }\n      case 'bus': {\n        const CarInfo = await getCarInfo(requestID, true);\n        const CarKey = `c_${param}`;\n        if (CarInfo.hasOwnProperty(CarKey)) {\n          const thisCar = CarInfo[CarKey];\n          const name = thisCar.CarNum;\n          const recentViewBusObject: RecentViewBus = {\n            type: 'bus',\n            time: time,\n            name: name,\n            id: param\n          };\n          await lfSetItem(8, key, JSON.stringify(recentViewBusObject));\n        }\n        break;\n      }\n      default:\n        break;\n    }\n  }\n}\n\nexport async function getRecentView(type: RecentView['type'], param: RecentViewRoute['id'] | RecentViewLocation['hash'] | RecentViewBus['id']): Promise<RecentView | boolean> {\n  const key = `${type}_${param}`;\n  const existingRecentViewRoute = await lfGetItem(8, key);\n  if (existingRecentViewRoute) {\n    return JSON.parse(existingRecentViewRoute);\n  } else {\n    return false;\n  }\n}\n\ninterface integratedRecentViewTime {\n  absolute: string;\n  relative: string;\n}\n\nexport interface integratedRecentViewRoute {\n  type: 'route';\n  time: integratedRecentViewTime;\n  name: string;\n  id: number;\n  pid: Array<number>;\n}\n\nexport interface integratedRecentViewLocation {\n  type: 'location';\n  time: integratedRecentViewTime;\n  name: string;\n  hash: string;\n}\n\nexport interface integratedRecentViewBus {\n  type: 'bus';\n  time: integratedRecentViewTime;\n  name: string;\n  id: number;\n}\n\nexport interface integratedRecentViewEmpty {\n  type: 'empty';\n  time: integratedRecentViewTime;\n  name: string;\n  id: number;\n}\n\nexport type integratedRecentView = integratedRecentViewRoute | integratedRecentViewLocation | integratedRecentViewBus | integratedRecentViewEmpty;\n\nexport interface integratedRecentViews {\n  items: Array<integratedRecentView>;\n  itemQuantity: number;\n  dataUpdateTime: number;\n}\n\nexport async function integrateRecentViews(requestID: string): Promise<integratedRecentViews> {\n  const recentViewList = await listRecentViews();\n  const Route = await getRoute(requestID, true);\n  let items: Array<integratedRecentView> = [];\n  let itemQuantity: number = 0;\n  for (const recentView of recentViewList) {\n    const recentViewType = recentView.type;\n    const recentViewTime = new Date(recentView.time);\n    switch (recentViewType) {\n      case 'route': {\n        let integratedRecentViewRoute: integratedRecentViewRoute = {};\n        integratedRecentViewRoute.type = 'route';\n        const thisRouteName = recentView.name;\n        integratedRecentViewRoute.name = thisRouteName;\n        const thisRouteID = recentView.id;\n        integratedRecentViewRoute.id = thisRouteID;\n        const thisRouteKey = `r_${thisRouteID}`;\n        const thisRoute = Route[thisRouteKey];\n        const thisRoutePathAttributeId = thisRoute.pid;\n        integratedRecentViewRoute.pid = thisRoutePathAttributeId;\n        integratedRecentViewRoute.time = {\n          absolute: recentViewTime.getTime(),\n          relative: dateToRelativeTime(recentViewTime)\n        };\n        items.push(integratedRecentViewRoute);\n        itemQuantity += 1;\n        break;\n      }\n      case 'location': {\n        let integratedRecentViewLocation: integratedRecentViewLocation = {};\n        integratedRecentViewLocation.type = 'location';\n        const thisLocationHash = recentView.hash;\n        integratedRecentViewLocation.hash = thisLocationHash;\n        const thisLocationName = recentView.name;\n        integratedRecentViewLocation.name = thisLocationName;\n        integratedRecentViewLocation.time = {\n          absolute: recentViewTime.getTime(),\n          relative: dateToRelativeTime(recentViewTime)\n        };\n        items.push(integratedRecentViewLocation);\n        itemQuantity += 1;\n        break;\n      }\n      case 'bus': {\n        let integratedRecentViewBus: integratedRecentViewBus = {};\n        integratedRecentViewBus.type = 'bus';\n        const thisBusID = recentView.id;\n        integratedRecentViewBus.id = thisBusID;\n        const thisBusName = recentView.name;\n        integratedRecentViewBus.name = thisBusName;\n        integratedRecentViewBus.time = {\n          absolute: recentViewTime.getTime(),\n          relative: dateToRelativeTime(recentViewTime)\n        };\n        items.push(integratedRecentViewBus);\n        itemQuantity += 1;\n        break;\n      }\n      case 'empty': {\n        let integratedRecentViewEmpty: integratedRecentViewEmpty = {};\n        integratedRecentViewEmpty.type = 'empty';\n        const thisEmptyID = recentView.id;\n        integratedRecentViewEmpty.id = thisEmptyID;\n        const thisEmptyName = recentView.name;\n        integratedRecentViewEmpty.name = thisEmptyName;\n        integratedRecentViewEmpty.time = {\n          absolute: recentViewTime.getTime(),\n          relative: dateToRelativeTime(recentViewTime)\n        };\n        items.push(integratedRecentViewEmpty);\n        itemQuantity = 1;\n        break;\n      }\n      default:\n        break;\n    }\n  }\n  items.sort(function (a, b) {\n    return b.time.absolute - a.time.absolute;\n  });\n\n  const result: integratedRecentViews = {\n    items: items,\n    itemQuantity: itemQuantity,\n    dataUpdateTime: new Date().getTime()\n  };\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n","import { elementQuerySelector } from '../../tools/elements';\nimport { MaterialSymbols } from './material-symbols-type';\n\nexport function getIconHTML(identifier: MaterialSymbols): string {\n  return /*html*/ `<span class=\"css_material_symbols_rounded\">${identifier}</span>`;\n}\n\nexport function getIconElement(identifier: MaterialSymbols): HTMLSpanElement {\n  const iconElement = document.createElement('span');\n  iconElement.classList.add('css_material_symbols_rounded');\n  iconElement.innerText = identifier;\n  return iconElement;\n}\n\nexport function getBlankIconElement(): HTMLSpanElement {\n  const iconElement = document.createElement('span');\n  iconElement.classList.add('css_material_symbols_rounded');\n  return iconElement;\n}\n\nexport function setIcon(parentElement: HTMLElement, identifier: MaterialSymbols): void {\n  const thisSpanElement = elementQuerySelector(parentElement, 'span.css_material_symbols_rounded');\n  thisSpanElement.innerText = identifier;\n}\n","import { integratedBus } from '../../data/bus/index';\nimport { getSettingOptionValue } from '../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { compareThings } from '../../tools/index';\nimport { getBlankIconElement, setIcon } from '../icons/index';\nimport { GeneratedElement } from '../index';\nimport { BusPropertiesGroupBodyElement } from './index';\n\nlet previousProperties = [];\nlet previousSkeletonScreen: boolean = false;\nlet previousAnimation: boolean = false;\n\nfunction generateElementOfBusProperty(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_bus_property');\n\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_bus_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_bus_property_value');\n\n  element.appendChild(iconElement);\n  element.appendChild(valueElement);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nexport function setUpBusPropertiesFieldSkeletonScreen() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultPropertyQuantity = 5;\n  let properties = [];\n  for (let i = 0; i < defaultPropertyQuantity; i++) {\n    properties.push({\n      key: i,\n      icon: '',\n      value: ''\n    });\n  }\n  updateBusPropertiesField(properties, true, playing_animation);\n}\n\nexport function updateBusPropertiesField(properties: integratedBus['properties'], skeletonScreen: boolean, animation: boolean): void {\n  function updateProperty(thisElement: HTMLElement, thisProperty: object, previousProperty: object): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: object): void {\n      const thisPropertyIconElement = elementQuerySelector(thisElement, '.css_bus_property_icon');\n      setIcon(thisPropertyIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: object): void {\n      elementQuerySelector(thisElement, '.css_bus_property_value').innerText = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', animation);\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', skeletonScreen);\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n      updateAnimation(thisElement, animation);\n    } else {\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n    }\n  }\n\n  const propertyQuantity = properties.length;\n\n  // BusGroupPropertiesElement.setAttribute('skeleton-screen', skeletonScreen);\n\n  const currentPropertyCapacity = elementQuerySelectorAll(BusPropertiesGroupBodyElement, '.css_bus_property').length;\n  if (propertyQuantity !== currentPropertyCapacity) {\n    const difference = currentPropertyCapacity - propertyQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        // const propertyIndex = currentPropertyCapacity + o;\n        const newPropertyElement = generateElementOfBusProperty(skeletonScreen);\n        fragment.appendChild(newPropertyElement.element);\n      }\n      BusPropertiesGroupBodyElement.append(fragment);\n    } else {\n      const propertyElements = elementQuerySelectorAll(BusPropertiesGroupBodyElement, '.css_bus_property');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const propertyIndex = currentPropertyCapacity - 1 - o;\n        propertyElements[propertyIndex].remove();\n      }\n    }\n  }\n\n  const propertyElements = elementQuerySelectorAll(BusPropertiesGroupBodyElement, '.css_bus_property');\n  for (let i = 0; i < propertyQuantity; i++) {\n    const thisPropertyElement = propertyElements[i];\n    const thisProperty = properties[i];\n    if (previousProperties.length === 0) {\n      updateProperty(thisPropertyElement, thisProperty, null);\n    } else {\n      updateProperty(thisPropertyElement, thisProperty, previousProperties[i]);\n    }\n  }\n\n  previousProperties = properties;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n","import { integrateBus } from '../../data/bus/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { getSettingOptionValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { generateIdentifier } from '../../tools/index';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\nimport { setUpBusPropertiesFieldSkeletonScreen, updateBusPropertiesField } from './properties';\n\nexport const BusField = documentQuerySelector('.css_bus_field');\nexport const BusHeadElement = elementQuerySelector(BusField, '.css_bus_head');\nexport const BusBodyElement = elementQuerySelector(BusField, '.css_bus_body');\nexport const BusGroupsElement = elementQuerySelector(BusBodyElement, '.css_bus_groups');\nexport const BusPropertiesGroupElement = elementQuerySelector(BusGroupsElement, '.css_bus_group[group=\"properties\"]');\nexport const BusPropertiesGroupBodyElement = elementQuerySelector(BusPropertiesGroupElement, '.css_bus_group_body');\nexport const BusLocationGroupElement = elementQuerySelector(BusGroupsElement, '.css_bus_group[group=\"location\"]');\n\nexport function openBus(id: number): void {\n  pushPageHistory('Bus');\n  logRecentView('bus', id);\n  BusField.setAttribute('displayed', 'true');\n  initializeBusPage(id);\n  closePreviousPage();\n}\n\nexport function closeBus(): void {\n  // revokePageHistory('Bus');\n  BusField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nasync function initializeBusPage(id: number) {\n  setUpBusPropertiesFieldSkeletonScreen();\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const requestID = generateIdentifier();\n  const integration = await integrateBus(id, requestID);\n  updateBusPropertiesField(integration.properties, false, playing_animation);\n}\n\nfunction updateBusField(integration: object, skeletonScreen: boolean): void {\n  function updateProperty(thisElement: HTMLElement, thisItem: object): void {}\n  function updateLocation(thisElement: HTMLElement, thisItem: object): void {}\n}\n","export function calculateStandardDeviation(arr: Array<number>): number {\n  // Step 1: Calculate the mean\n  const mean = arr.reduce((acc, val) => acc + val, 0) / arr.length;\n  // Step 2: Calculate the squared difference between each element and the mean\n  const squaredDifferences = arr.map((val) => Math.pow(val - mean, 2));\n  // Step 3: Find the mean of those squared differences\n  const meanOfSquaredDifferences = squaredDifferences.reduce((acc, val) => acc + val, 0) / arr.length;\n  // Step 4: Take the square root of that mean\n  const standardDeviation = Math.sqrt(meanOfSquaredDifferences);\n  return standardDeviation;\n}\n\nexport function standardizeArray(array: Array<number>): Array<number> {\n  // Calculate the mean of the array\n  const mean = array.reduce((acc, val) => acc + val, 0) / array.length;\n\n  // Calculate the standard deviation\n  const stdDev = calculateStandardDeviation(array);\n\n  // Standardize the array\n  return array.map((val) => (val - mean) / stdDev);\n}\n\n// Function to calculate Pearson correlation coefficient\nexport function pearsonCorrelation(x: Array<number>, y: Array<number>): number {\n  const n = x.length;\n  if (n !== y.length) {\n    throw new Error('Arrays must have the same length');\n  }\n\n  let sumX = 0,\n    sumY = 0,\n    sumXY = 0,\n    sumXSquared = 0,\n    sumYSquared = 0;\n\n  for (let i = 0; i < n; i++) {\n    sumX += x[i];\n    sumY += y[i];\n    sumXY += x[i] * y[i];\n    sumXSquared += x[i] ** 2;\n    sumYSquared += y[i] ** 2;\n  }\n\n  const numerator = n * sumXY - sumX * sumY;\n  const denominator = Math.sqrt((n * sumXSquared - sumX ** 2) * (n * sumYSquared - sumY ** 2));\n\n  if (denominator === 0) {\n    return 0; // Correlation is undefined in this case\n  }\n\n  return numerator / denominator;\n}\n\nexport function mergeStandardDeviation(targetAverage: number, targetSTDEV: number, targetDataLength: number, sourceAverage: number, sourceSTDEV: number, sourceDataLength: number): number {\n  const mergedDataLength = targetDataLength + sourceDataLength;\n\n  const mergedAverage = (targetDataLength * targetAverage + sourceDataLength * sourceAverage) / mergedDataLength;\n\n  const mergedVariance = (targetDataLength * (Math.pow(targetSTDEV, 2) + Math.pow(targetAverage, 2)) + sourceDataLength * (Math.pow(sourceSTDEV, 2) + Math.pow(sourceAverage, 2))) / mergedDataLength - Math.pow(mergedAverage, 2);\n\n  const mergedSTDEV = Math.sqrt(mergedVariance);\n  return mergedSTDEV;\n}\n\nexport function mergePearsonCorrelation(targetXAverage: number, targetYAverage: number, targetXSTDEV: number, targetYSTDEV: number, targetDataLength: number, targetCorrelation: number, sourceXAverage: number, sourceYAverage: number, sourceXSTDEV: number, sourceYSTDEV: number, sourceDataLength: number, sourceCorrelation: number): number {\n  const mergedDataLength = targetDataLength + sourceDataLength;\n\n  const mergedXAverage = (targetDataLength * targetXAverage + sourceDataLength * sourceXAverage) / mergedDataLength;\n  const mergedYAverage = (targetDataLength * targetYAverage + sourceDataLength * sourceYAverage) / mergedDataLength;\n\n  const mergedXSTDEV = mergeStandardDeviation(targetXAverage, targetXSTDEV, targetDataLength, sourceXAverage, sourceXSTDEV, sourceDataLength);\n  const mergedYSTDEV = mergeStandardDeviation(targetYAverage, targetYSTDEV, targetDataLength, sourceYAverage, sourceYSTDEV, sourceDataLength);\n\n  const mergedCorrelation = (targetDataLength * (targetXSTDEV * targetYSTDEV * targetCorrelation + targetXAverage * targetYAverage) + sourceDataLength * (sourceXSTDEV * sourceYSTDEV * sourceCorrelation + sourceXAverage * sourceYAverage) - mergedDataLength * mergedXAverage * mergedYAverage) / (mergedDataLength * mergedXSTDEV * mergedYSTDEV);\n  return mergedCorrelation;\n}\n\n/**\n * get the unit vecotr towards the same direction\n * @param vector [a1, a2, a3, ...]\n * @returns [b1, b2, b3, ...]\n */\n\nexport function normalizeVector(vector: Array<number>): Array<number> {\n  const length = Math.hypot(vector);\n  const componentQuantity = vector.length;\n  const newVector = new Float32Array(componentQuantity);\n  if (length > 0) {\n    const scale = 1 / length;\n    for (let i = componentQuantity; i > 0; i--) {\n      newVector[i] = vector[i] * scale;\n    }\n    return Array.from(newVector);\n  } else {\n    return vector;\n  }\n}\n\nexport function smoothArray(array: Array<number>): Array<number> {\n  const arrayLength = array.length;\n  const result = [];\n  for (let i = 1; i < arrayLength; i += 3) {\n    const currentItem = array[i];\n    const previousItem = array[i - 1] || currentItem;\n    const nextItem = array[i + 1] || currentItem;\n    result.push((previousItem + currentItem + nextItem) / 3);\n  }\n  return result;\n}\n\nexport function softmaxArray(array: Array<number>): Array<number> {\n  const arrayLength = array.length;\n\n  // Return an empty array if the input is empty\n  if (arrayLength === 0) {\n    return [];\n  }\n\n  // Find the global maximum\n  let max = -Infinity;\n  for (let i = arrayLength - 1; i >= 0; i--) {\n    const item = array[i];\n    if (item > max) {\n      max = item;\n    }\n  }\n\n  // Exponentiate each element (for numerical stability, subtract the max value)\n  // Sum all the exponentiated values\n  const expArray = new Float32Array(arrayLength);\n  let sumExp = 0;\n  for (let j = arrayLength - 1; j >= 0; j--) {\n    const exp = Math.exp(array[j] - max);\n    expArray[j] = exp;\n    sumExp += exp;\n  }\n\n  // Normalize each value\n  const normalizedArray = new Float32Array(arrayLength);\n  for (let k = arrayLength - 1; k >= 0; k--) {\n    const normalizedValue = expArray[k] / sumExp;\n    normalizedArray[k] = normalizedValue;\n  }\n  return Array.from(normalizedArray);\n}\n\nexport function sigmoidArray(array: Array<number>): Array<number> {\n  const arrayLength = array.length;\n  const normalizedArray = new Float32Array(arrayLength);\n  for (let i = arrayLength - 1; i >= 0; i--) {\n    normalizedArray[i] = 1 / (1 + Math.exp(-1 * array[i]));\n  }\n  return Array.from(normalizedArray);\n}\n\nexport function calculateAverage(array: Array<number>): number {\n  if (array.length === 0) {\n    return 0;\n  } else {\n    const sum = array.reduce((acc, curr) => acc + curr, 0);\n    return sum / array.length;\n  }\n}\n\nexport function findGlobalExtrema(array: Array<number>): [minimum: number, maximum: number] {\n  const arrayLength = array.length;\n  if (arrayLength === 0) {\n    return [0, 0];\n  }\n\n  let min = Infinity;\n  let max = -Infinity;\n\n  for (let i = arrayLength - 1; i >= 0; i--) {\n    const item = array[i];\n    if (item > max) {\n      max = item;\n    }\n    if (item < min) {\n      min = item;\n    }\n  }\n  return [min, max];\n}\n","import { generateIdentifier } from '../../../tools/index';\nimport { mergePearsonCorrelation, mergeStandardDeviation } from '../../../tools/math';\nimport { EstimateTime } from '../../apis/getEstimateTime/index';\nimport { lfGetItem, lfListItemKeys, lfRemoveItem, lfSetItem } from '../../storage/index';\n\nexport type UpdateRateData = [estimateTime: number, timestamp: number]; // EstimateTime (seconds), timestamp (seconds)\n\nexport interface UpdateRateDataGroupStats {\n  estimate_time: {\n    average: number;\n    stdev: number;\n  };\n  timestamp: {\n    average: number;\n    stdev: number;\n  };\n  correlation: number;\n  length: number;\n}\n\nexport interface UpdateRateDataGroup {\n  stats: UpdateRateDataGroupStats;\n  timestamp: number;\n  id: number; // stop id\n}\n\nexport type UpdateRateDataGroupArray = Array<UpdateRateDataGroup>;\n\nexport interface UpdateRateDataWriteAheadLogGroup {\n  data: Array<UpdateRateData>;\n  timestamp: number;\n  id: string;\n}\n\nconst updateRateData_sampleQuantity: number = 32;\nlet updateRateData_trackedStops: Array<number> = [];\nlet updateRateData_writeAheadLog_id: string = '';\nlet updateRateData_writeAheadLog_tracking: boolean = false;\nlet updateRateData_writeAheadLog_currentDataLength: number = 0;\nconst updateRateData_writeAheadLog_maxDataLength: number = 45;\nlet updateRateData_writeAheadLog_group: UpdateRateDataWriteAheadLogGroup = {\n  data: {},\n  timestamp: 0,\n  id: ''\n};\nconst updateRateData_groups: Array<UpdateRateDataGroup> = [];\nconst updateRateData_groupsIndex: { [key: string]: number } = {};\n\nfunction getUpdateRateDataStats(data: Array<UpdateRateData>): UpdateRateDataGroupStats {\n  let sumEstimateTime = 0;\n  let sumEstimateTimeSquared = 0;\n  let sumTimestamp = 0;\n  let sumTimestampSquared = 0;\n  let dataLength = 0;\n  for (const item of data) {\n    const estimateTime = item[0];\n    const timestamp = item[1];\n    dataLength += 1;\n    sumEstimateTime += estimateTime;\n    sumTimestamp += timestamp;\n    sumEstimateTimeSquared += Math.pow(estimateTime, 2);\n    sumTimestampSquared += Math.pow(timestamp, 2);\n  }\n\n  const averageEstimateTime = sumEstimateTime / dataLength;\n  const averageTimestamp = sumTimestamp / dataLength;\n\n  const estimateTimeVariance = sumEstimateTimeSquared / dataLength - Math.pow(averageEstimateTime, 2);\n  const timestampVariance = sumTimestampSquared / dataLength - Math.pow(averageTimestamp, 2);\n\n  const estimateTimeSTDEV = Math.sqrt(estimateTimeVariance);\n  const timestampSTDEV = Math.sqrt(timestampVariance);\n\n  let covariance = 0;\n  for (const item2 of data) {\n    const estimateTime = item2[0];\n    const timestamp = item2[1];\n    covariance += (estimateTime - averageEstimateTime) * (timestamp - averageTimestamp);\n  }\n  covariance /= dataLength;\n\n  const correlation = covariance / (estimateTimeSTDEV * timestampSTDEV);\n\n  const result: UpdateRateDataGroupStats = {\n    estimate_time: {\n      average: averageEstimateTime,\n      stdev: estimateTimeSTDEV\n    },\n    timestamp: {\n      average: averageTimestamp,\n      stdev: timestampSTDEV\n    },\n    length: dataLength,\n    correlation: correlation\n  };\n  return result;\n}\n\nfunction mergeUpdateRateDataStats(targetStats: UpdateRateDataGroupStats, sourceStats: UpdateRateDataGroupStats): UpdateRateDataGroupStats {\n  const mergedDataLength = targetStats.length + sourceStats.length;\n\n  const mergedAverageEstimateTime = (targetStats.estimate_time.average * targetStats.length + sourceStats.estimate_time.average * sourceStats.length) / mergedDataLength;\n  const mergedAverageTimestamp = (targetStats.timestamp.average * targetStats.length + sourceStats.timestamp.average * sourceStats.length) / mergedDataLength;\n\n  const mergedEstimateTimeSTDEV = mergeStandardDeviation(targetStats.estimate_time.average, targetStats.estimate_time.stdev, targetStats.length, sourceStats.estimate_time.average, sourceStats.estimate_time.stdev, sourceStats.length);\n  const mergedTimestampSTDEV = mergeStandardDeviation(targetStats.timestamp.average, targetStats.timestamp.stdev, targetStats.length, sourceStats.timestamp.average, sourceStats.timestamp.stdev, sourceStats.length);\n\n  const mergedCorrelation = mergePearsonCorrelation(targetStats.estimate_time.average, targetStats.timestamp.average, targetStats.estimate_time.stdev, targetStats.timestamp.stdev, targetStats.length, targetStats.correlation, sourceStats.estimate_time.average, sourceStats.timestamp.average, sourceStats.estimate_time.stdev, sourceStats.timestamp.stdev, sourceStats.length, sourceStats.correlation);\n\n  const result: UpdateRateDataGroupStats = {\n    estimate_time: {\n      average: mergedAverageEstimateTime,\n      stdev: mergedEstimateTimeSTDEV\n    },\n    timestamp: {\n      average: mergedAverageTimestamp,\n      stdev: mergedTimestampSTDEV\n    },\n    length: mergedDataLength,\n    correlation: mergedCorrelation\n  };\n  return result;\n}\n\nexport async function collectUpdateRateData(EstimateTime: EstimateTime) {\n  const now = new Date();\n  const currentTimestamp: number = now.getTime();\n  let needToReset = false;\n  // Initialize\n  if (!updateRateData_writeAheadLog_tracking) {\n    updateRateData_writeAheadLog_tracking = true;\n    updateRateData_trackedStops = [];\n    updateRateData_writeAheadLog_id = generateIdentifier();\n    updateRateData_writeAheadLog_group = {\n      data: {},\n      timestamp: currentTimestamp,\n      id: updateRateData_writeAheadLog_id\n    };\n    updateRateData_writeAheadLog_currentDataLength = 0;\n    const EstimateTimeLength1: number = EstimateTime.length - 1;\n    for (let i = 0; i < updateRateData_sampleQuantity; i++) {\n      const randomIndex: number = Math.floor(Math.random() * EstimateTimeLength1);\n      const randomItem = EstimateTime[randomIndex];\n      updateRateData_trackedStops.push(randomItem.StopID);\n    }\n  }\n\n  // Record EstimateTime\n  for (const item of EstimateTime) {\n    const stopID = item.StopID;\n    const stopKey = `s_${stopID}`;\n    if (updateRateData_trackedStops.indexOf(stopID) > -1) {\n      if (!updateRateData_writeAheadLog_group.data.hasOwnProperty(stopKey)) {\n        updateRateData_writeAheadLog_group.data[stopKey] = [];\n      }\n      updateRateData_writeAheadLog_group.data[stopKey].push([parseInt(item.EstimateTime), Math.floor((currentTimestamp - updateRateData_writeAheadLog_group.timestamp) / 1000)]);\n    }\n  }\n\n  updateRateData_writeAheadLog_currentDataLength += 1;\n  if (updateRateData_writeAheadLog_currentDataLength > updateRateData_writeAheadLog_maxDataLength) {\n    needToReset = true;\n  }\n\n  if (updateRateData_writeAheadLog_currentDataLength % 5 === 0) {\n    await lfSetItem(4, updateRateData_writeAheadLog_id, JSON.stringify(updateRateData_writeAheadLog_group));\n  }\n\n  if (needToReset) {\n    for (const stopID of updateRateData_trackedStops) {\n      const stopKey = `s_${stopID}`;\n      const data = updateRateData_writeAheadLog_group.data[stopKey];\n      const dataGroup = {} as UpdateRateDataGroup;\n      const existingData = await lfGetItem(3, stopKey);\n      if (existingData) {\n        const existingDataObject = JSON.parse(existingData) as UpdateRateDataGroup;\n        dataGroup.stats = mergeUpdateRateDataStats(existingDataObject.stats, getUpdateRateDataStats(data));\n        dataGroup.timestamp = existingDataObject.timestamp;\n        dataGroup.id = stopID;\n      } else {\n        dataGroup.stats = getUpdateRateDataStats(data);\n        dataGroup.timestamp = currentTimestamp;\n        dataGroup.id = stopID;\n      }\n      await lfSetItem(3, stopKey, JSON.stringify(dataGroup));\n      if (updateRateData_groupsIndex.hasOwnProperty(stopKey)) {\n        const existingIndex = updateRateData_groupsIndex[stopKey];\n        updateRateData_groups.splice(existingIndex, 1, dataGroup);\n      } else {\n        updateRateData_groups[stopKey] = updateRateData_groups.length;\n        updateRateData_groups.push(dataGroup);\n      }\n      await lfRemoveItem(4, updateRateData_writeAheadLog_id);\n    }\n\n    updateRateData_writeAheadLog_tracking = false;\n  }\n}\n\nexport async function recoverUpdateRateDataFromWriteAheadLog() {\n  const now = new Date().getTime();\n  const oneWeekAgo = now - 60 * 60 * 7 * 1000;\n  const keys = await lfListItemKeys(4);\n  for (const key of keys) {\n    const json = await lfGetItem(4, key);\n    if (json) {\n      const object = JSON.parse(json) as UpdateRateDataWriteAheadLogGroup;\n      const thisTimestamp = object.timestamp;\n      const thisID = object.id;\n      if (thisTimestamp > oneWeekAgo) {\n        for (const stopKey in object.data) {\n          const thisStopData = object.data[stopKey];\n          const dataGroup = {} as UpdateRateDataGroup;\n          const existingData = await lfGetItem(3, stopKey);\n          if (existingData) {\n            const existingDataObject = JSON.parse(existingData) as UpdateRateDataGroup;\n            dataGroup.stats = mergeUpdateRateDataStats(existingDataObject.stats, getUpdateRateDataStats(thisStopData));\n            dataGroup.timestamp = existingDataObject.timestamp;\n            dataGroup.id = existingDataObject.id;\n          } else {\n            dataGroup.stats = getUpdateRateDataStats(thisStopData);\n            dataGroup.timestamp = thisTimestamp;\n            dataGroup.id = parseInt(stopKey.split('_')[1]);\n          }\n          await lfSetItem(3, stopKey, JSON.stringify(dataGroup));\n          if (updateRateData_groupsIndex.hasOwnProperty(stopKey)) {\n            const existingIndex = updateRateData_groupsIndex[stopKey];\n            updateRateData_groups.splice(existingIndex, 1, dataGroup);\n          } else {\n            updateRateData_groups[stopKey] = updateRateData_groups.length;\n            updateRateData_groups.push(dataGroup);\n          }\n        }\n      }\n      await lfRemoveItem(4, thisID);\n    }\n  }\n}\n\nexport async function initializeUpdateRateDataGroups() {\n  const now = new Date().getTime();\n  const oneWeekAgo = now - 60 * 60 * 7 * 1000;\n  const keys = await lfListItemKeys(3);\n  let index: number = 0;\n  for (const key of keys) {\n    const json = await lfGetItem(3, key);\n    if (json) {\n      const object = JSON.parse(json) as UpdateRateDataGroup;\n      const thisTimestamp = object.timestamp;\n      if (thisTimestamp > oneWeekAgo) {\n        updateRateData_groups.push(object);\n        updateRateData_groupsIndex[key] = index;\n        index += 1;\n      }\n    }\n  }\n}\n\nexport function listUpdateRateDataGroups(): Array<UpdateRateDataGroup> {\n  const now = new Date().getTime();\n  const oneWeekAgo = now - 60 * 60 * 7 * 1000;\n  return updateRateData_groups.filter((item) => item.timestamp > oneWeekAgo);\n}\n\nexport async function discardExpiredUpdateRateDataGroups() {\n  const now = new Date().getTime();\n  const oneWeekAgo = now - 60 * 60 * 7 * 1000;\n  const keys = await lfListItemKeys(3);\n  for (const key of keys) {\n    const json = await lfGetItem(3, key);\n    const object = JSON.parse(json) as UpdateRateDataGroup;\n    const thisTimestamp = object.timestamp;\n    if (thisTimestamp <= oneWeekAgo) {\n      await lfRemoveItem(3, key);\n    }\n  }\n}\n\nconst getUpdateRateWorkerResponses = {};\nlet port;\n\n// Check if SharedWorker is supported, and fall back to Worker if not\nif (typeof SharedWorker !== 'undefined') {\n  const getUpdateRateSharedWorker = new SharedWorker(new URL(/* webpackChunkName: \"getUpdateRate-worker\" */ './getUpdateRate-worker.ts', import.meta.url)); // Reusable shared worker\n  port = getUpdateRateSharedWorker.port; // Access the port for communication\n  port.start(); // Start the port (required by some browsers)\n} else {\n  const getUpdateRateWorker = new Worker(new URL(/* webpackChunkName: \"getUpdateRate-worker\" */ './getUpdateRate-worker.ts', import.meta.url)); // Fallback to standard worker\n  port = getUpdateRateWorker; // Use Worker directly for communication\n}\n\n// Handle messages from the worker\nport.onmessage = function (e) {\n  const [result, taskID] = e.data;\n  if (getUpdateRateWorkerResponses[taskID]) {\n    getUpdateRateWorkerResponses[taskID](result); // Resolve the correct promise\n    delete getUpdateRateWorkerResponses[taskID]; // Clean up the response handler\n  }\n};\n\n// Handle errors\nport.onerror = function (e) {\n  console.error(e.message);\n};\n\nexport async function getUpdateRate(): Promise<number> {\n  const dataGroups = await listUpdateRateDataGroups();\n  const taskID = generateIdentifier();\n\n  const result = await new Promise((resolve, reject) => {\n    getUpdateRateWorkerResponses[taskID] = resolve; // Store the resolve function for this taskID\n\n    port.onerror = function (e) {\n      reject(e.message);\n    };\n\n    port.postMessage([dataGroups, taskID]); // Send the task to the worker\n  });\n\n  return result;\n}\n","import { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataUpdateTime } from '../loader';\n\nexport interface EstimateTimeItem {\n  RouteID: number;\n  StopID: number;\n  EstimateTime: string | '-1' | '-2' | '-3' | '-4'; // x (>=0): remaining time to wait measured in seconds, -1: no departed bus, -2: skip stopping (due to traffic moderation), -3: the next bus will not come until tomorrow, -4: not in operation\n  GoBack: '0' | '1' | '2'; // 0: go, 1: back, 2: unknown\n}\n\nexport type EstimateTime = Array<EstimateTimeItem>;\n\nexport async function getEstimateTime(requestID: string): Promise<EstimateTime> {\n  const apis = [\n    [0, 4],\n    [1, 4]\n  ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n  let result = [];\n  for (const api of apis) {\n    const data = await fetchData(api.url, requestID, `getEstimateTime_${api.e[0]}`, 'json');\n    result = result.concat(data.BusInfo);\n    setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n  }\n  return result;\n}\n","import { MaterialSymbols } from '../../../interface/icons/material-symbols-type';\nimport { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getMaterialSymbolsAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress } from '../loader';\n\nlet MaterialSymbolsAPIVariableCache_available: boolean = false;\nlet MaterialSymbolsAPIVariableCache_data: Array<string> = [];\n\nexport interface MaterialSymbolsSearchIndex {\n  dictionary: string;\n  symbols: { [symbol: MaterialSymbols]: Array<number> };\n}\n\nexport async function getMaterialSymbolsSearchIndex(requestID: string): Promise<MaterialSymbolsSearchIndex> {\n  async function getData() {\n    const apiurl = getMaterialSymbolsAPIURL();\n    const data = await fetchData(apiurl, requestID, 'getMaterialSymbolsSearchIndex', 'json');\n    return data;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 7 * 1000;\n  const cacheKey = 'bus_material_symbols_search_index_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(result));\n    if (!MaterialSymbolsAPIVariableCache_available) {\n      MaterialSymbolsAPIVariableCache_available = true;\n      MaterialSymbolsAPIVariableCache_data = result;\n    }\n    return result;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(result));\n      if (!MaterialSymbolsAPIVariableCache_available) {\n        MaterialSymbolsAPIVariableCache_available = true;\n        MaterialSymbolsAPIVariableCache_data = result;\n      }\n      return result;\n    } else {\n      if (!MaterialSymbolsAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        MaterialSymbolsAPIVariableCache_available = true;\n        MaterialSymbolsAPIVariableCache_data = JSON.parse(cache)\n      }\n      setDataReceivingProgress(requestID, 'getMaterialSymbolsSearchIndex', 0, true);\n      return MaterialSymbolsAPIVariableCache_data;\n    }\n  }\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { generateLabelFromAddresses } from '../../tools/address';\nimport { CardinalDirection, getCardinalDirectionFromVector } from '../../tools/cardinal-direction';\nimport { generateIdentifier } from '../../tools/index';\nimport { generateDirectionLabels, generateLetterLabels } from '../../tools/labels';\nimport { normalizeVector } from '../../tools/math';\nimport { collectBusArrivalTimeData } from '../analytics/bus-arrival-time/index';\nimport { collectUpdateRateData } from '../analytics/update-rate/index';\nimport { EstimateTimeItem, getEstimateTime } from '../apis/getEstimateTime/index';\nimport { getLocation, MergedLocation, MergedLocationItem, SimplifiedLocation } from '../apis/getLocation/index';\nimport { getMaterialSymbolsSearchIndex } from '../apis/getMaterialSymbolsSearchIndex/index';\nimport { getRoute, SimplifiedRoute, SimplifiedRouteItem } from '../apis/getRoute/index';\nimport { getStop, SimplifiedStop } from '../apis/getStop/index';\nimport { EstimateTimeStatus, parseEstimateTime } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime, getDataUpdateTime, setDataReceivingProgress } from '../apis/loader';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../settings/index';\nimport { lfGetItem, lfListItemKeys, lfRemoveItem, lfSetItem } from '../storage/index';\n\ninterface FolderContentRouteEndPoints {\n  departure: string;\n  destination: string;\n}\n\nexport interface FolderContentStopRoute {\n  name: string;\n  endPoints: FolderContentRouteEndPoints;\n  id: number;\n}\n\nexport interface FolderContentStop {\n  type: 'stop';\n  id: number;\n  timestamp: number;\n  name: string;\n  direction: number;\n  route: FolderContentStopRoute;\n}\n\nexport interface FolderContentRoute {\n  type: 'route';\n  id: number;\n  timestamp: number;\n  name: string;\n  endPoints: FolderContentRouteEndPoints;\n}\n\nexport interface FolderContentLocation {\n  type: 'location';\n  id: string; // hash\n  timestamp: number;\n  name: string;\n}\n\nexport interface FolderContentBus {\n  type: 'bus';\n  id: number; // CarID\n  timestamp: number;\n  busID: string; // BusID\n}\n\nexport interface FolderContentEmpty {\n  type: 'empty';\n  id: number;\n}\n\nexport type FolderContent = FolderContentStop | FolderContentRoute | FolderContentLocation | FolderContentBus | FolderContentEmpty;\n\nexport interface Folder {\n  name: string;\n  icon: MaterialSymbols;\n  id: string;\n  timestamp: number;\n}\n\nexport type FolderArray = Array<Folder>;\n\nexport interface FolderWithContent extends Folder {\n  content: Array<FolderContent>;\n  contentLength: number;\n}\n\nexport type FolderWithContentArray = Array<FolderWithContent>;\n\nconst FolderList: { [key: string]: Folder } = {};\n\nexport async function initializeFolderList() {\n  const folderKeys = await lfListItemKeys(11);\n  for (const folderKey of folderKeys) {\n    const thisFolderJSON = await lfGetItem(11, folderKey);\n    if (thisFolderJSON) {\n      const thisFolderObject = JSON.parse(thisFolderJSON) as Folder;\n      if (!FolderList.hasOwnProperty(folderKey)) {\n        FolderList[folderKey] = thisFolderObject;\n      }\n    }\n  }\n}\n\nexport async function createFolder(name: Folder['name'], icon: Folder['icon']): Promise<Folder['id'] | false> {\n  // Validate icon\n  const requestID = generateIdentifier();\n  const materialSymbolsSearchIndex = await getMaterialSymbolsSearchIndex(requestID);\n  deleteDataReceivingProgress(requestID);\n  if (!materialSymbolsSearchIndex.symbols.hasOwnProperty(icon)) return false;\n\n  // Check existence\n  const folderID = generateIdentifier();\n  const folderKey = `f_${folderID}`;\n  if (FolderList.hasOwnProperty(folderKey)) {\n    return false;\n  }\n  const existingFolder = await lfGetItem(11, folderKey);\n  if (existingFolder) {\n    return false;\n  }\n\n  // Generate folder\n  const nowTime = new Date().getTime();\n  let newFolder: Folder = {\n    name: name,\n    icon: icon,\n    id: folderID,\n    timestamp: nowTime\n  };\n\n  // Save folder\n  FolderList[folderKey] = newFolder;\n  await lfSetItem(11, folderKey, JSON.stringify(newFolder));\n  await lfSetItem(12, folderKey, JSON.stringify([]));\n  return folderID;\n}\n\nexport async function updateFolder(folderID: Folder['id'], name: Folder['name'], icon: Folder['icon']): Promise<boolean> {\n  const folderKey: string = `f_${folderID}`;\n\n  // Check existence\n  const existingFolderJSON = await lfGetItem(11, folderKey);\n  if (!existingFolderJSON) {\n    return false;\n  }\n  const existingFolderObject = JSON.parse(existingFolderJSON) as Folder;\n\n  // Validate icon\n  const requestID = generateIdentifier();\n  const materialSymbolsSearchIndex = await getMaterialSymbolsSearchIndex(requestID);\n  deleteDataReceivingProgress(requestID);\n  if (!materialSymbolsSearchIndex.symbols.hasOwnProperty(icon)) return false;\n\n  // Generate folder\n  const modifiedFolder: Folder = {\n    name: name,\n    icon: icon,\n    id: folderID,\n    timestamp: existingFolderObject.timestamp\n  };\n\n  // Save folder\n  FolderList[folderKey] = modifiedFolder;\n  await lfSetItem(11, folderKey, JSON.stringify(modifiedFolder));\n  return true;\n}\n\nexport function getFolder(folderID: Folder['id']): Folder | false {\n  const folderKey: string = `f_${folderID}`;\n  if (!FolderList.hasOwnProperty(folderKey)) {\n    return false;\n  }\n  const folderObject: Folder = {\n    name: FolderList[folderKey].name,\n    icon: FolderList[folderKey].icon,\n    id: FolderList[folderKey].id,\n    timestamp: FolderList[folderKey].timestamp\n  };\n  return folderObject;\n  // return cloneDeep(Folders[folderKey]);\n}\n\nexport function listFolders(): FolderArray {\n  const result = [];\n  for (const folderKey in FolderList) {\n    const folderObject: Folder = {\n      name: FolderList[folderKey].name,\n      icon: FolderList[folderKey].icon,\n      id: FolderList[folderKey].id,\n      timestamp: FolderList[folderKey].timestamp\n    };\n    result.push(folderObject);\n  }\n  result.sort(function (a, b) {\n    return a.timestamp - b.timestamp;\n  });\n  return result;\n}\n\nexport async function listFolderContent(folderID: Folder['id']): Promise<Array<FolderContent>> {\n  const result: Array<FolderContent> = [];\n\n  const folderKey: string = `f_${folderID}`;\n  const thisFolder = getFolder(folderID);\n  if (typeof thisFolder === 'boolean' && thisFolder === false) {\n    return result;\n  }\n\n  const thisFolderContentIndexJSON = await lfGetItem(12, folderKey);\n  if (!thisFolderContentIndexJSON) {\n    return result;\n  }\n  const thisFolderContentIndexArray = JSON.parse(thisFolderContentIndexJSON) as Array<string>;\n  if (thisFolderContentIndexArray.length === 0) {\n    const emptyItem: FolderContentEmpty = {\n      type: 'empty',\n      id: 0,\n      index: 0\n    };\n    result.push(emptyItem);\n    return result;\n  }\n\n  for (const thisFolderContentKey of thisFolderContentIndexArray) {\n    const thisContentJSON = await lfGetItem(13, thisFolderContentKey);\n    if (thisContentJSON) {\n      const thisContentObject = JSON.parse(thisContentJSON) as FolderContent;\n      result.push(thisContentObject);\n    }\n  }\n  return result;\n}\n\nasync function getFolderContentLength(folderID: Folder['id']): Promise<number> {\n  const folderKey: string = `f_${folderID}`;\n  const thisFolderContentIndexJSON = await lfGetItem(12, folderKey);\n  if (!thisFolderContentIndexJSON) {\n    return 0;\n  }\n  const thisFolderContentIndexArray = JSON.parse(thisFolderContentIndexJSON) as Array<string>;\n  return thisFolderContentIndexArray.length;\n}\n\nexport async function listFoldersWithContent(): Promise<FolderWithContentArray> {\n  const folders = await listFolders();\n  const result: FolderWithContentArray = [];\n  for (const folder of folders) {\n    const folderContent = await listFolderContent(folder.id);\n    const folderContentLength = await getFolderContentLength(folder.id);\n    result.push({\n      name: folder.name,\n      icon: folder.icon,\n      id: folder.id,\n      timestamp: folder.timestamp,\n      content: folderContent,\n      contentLength: folderContentLength\n    });\n  }\n  return result;\n}\n\nexport async function listAllFolderContent(types: Array<FolderContent['type']>): Promise<Array<FolderContent>> {\n  let useFilter: boolean = true;\n  if (typeof types !== 'object' || !Array.isArray(types)) {\n    useFilter = false;\n  }\n  let result: Array<FolderContent> = [];\n  const keys = await lfListItemKeys(13);\n  for (const key of keys) {\n    const json = await lfGetItem(13, key);\n    if (json) {\n      const object = JSON.parse(json) as FolderContent;\n      if (useFilter) {\n        if (types.indexOf(object.type) > -1) {\n          result.push(object);\n        }\n      } else {\n        result.push(object);\n      }\n    }\n  }\n  return result;\n}\n\nexport interface integratedFolderContentStopRoute extends FolderContentStopRoute {\n  pathAttributeId: Array<number>;\n}\n\nexport interface integratedFolderContentStop extends FolderContentStop {\n  status: EstimateTimeStatus;\n  route: integratedFolderContentStopRoute;\n}\n\nexport interface integratedFolderContentRoute extends FolderContentRoute {\n  pathAttributeId: Array<number>;\n}\n\nexport interface integratedFolderContentLocation extends FolderContentLocation {\n  // labels: string;\n}\n\nexport interface integratedFolderContentBus extends FolderContentBus {}\n\nexport interface integratedFolderContentEmpty extends FolderContentEmpty {}\n\nexport type integratedFolderContent = integratedFolderContentStop | integratedFolderContentRoute | integratedFolderContentLocation | integratedFolderContentBus | integratedFolderContentEmpty;\n\nexport interface integratedFolder extends Folder {\n  content: Array<integratedFolderContent>;\n  contentLength: number;\n}\n\nexport interface integratedFolders {\n  folders: Array<integratedFolder>;\n  dataUpdateTime: number;\n}\n\nexport async function integrateFolders(requestID: string): Promise<integratedFolders> {\n  setDataReceivingProgress(requestID, 'getEstimateTime_0', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_1', 0, false);\n  setDataReceivingProgress(requestID, 'getRoute_0', 0, false);\n  setDataReceivingProgress(requestID, 'getRoute_1', 0, false);\n\n  const EstimateTime = await getEstimateTime(requestID);\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  // const Location = (await getLocation(requestID, 1)) as MergedLocation;\n\n  const foldersWithContent = await listFoldersWithContent();\n\n  const time_formatting_mode = getSettingOptionValue('time_formatting_mode') as number;\n  // const location_labels = getSettingOptionValue('location_labels');\n  const power_saving = getSettingOptionValue('power_saving') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n\n  let StopIDs = [] as Array<number>;\n  for (const folderWithContent1 of foldersWithContent) {\n    StopIDs = StopIDs.concat(\n      folderWithContent1.content\n        .filter((m) => {\n          return m.type === 'stop' ? true : false;\n        })\n        .map((e) => e.id)\n    );\n  }\n\n  let batchFoundEstimateTime: { [key: string]: EstimateTimeItem } = {};\n  for (const EstimateTimeItem of EstimateTime) {\n    if (StopIDs.indexOf(EstimateTimeItem.StopID) > -1) {\n      const thisStopKey: string = `s_${EstimateTimeItem.StopID}`;\n      batchFoundEstimateTime[thisStopKey] = EstimateTimeItem;\n    }\n  }\n\n  let folders: integratedFolders['folders'] = [];\n\n  for (const folderWithContent2 of foldersWithContent) {\n    // Initialize integratedFolder\n    const integratedFolder: integratedFolder = {\n      name: folderWithContent2.name,\n      icon: folderWithContent2.icon,\n      id: folderWithContent2.id,\n      timestamp: folderWithContent2.timestamp,\n      content: [],\n      contentLength: folderWithContent2.contentLength\n    };\n\n    for (let item of folderWithContent2.content) {\n      let integratedItem = item as integratedFolderContent;\n      switch (integratedItem.type) {\n        case 'stop': {\n          const thisStopKey = `s_${integratedItem.id}`;\n          let thisEstimateTime = {} as EstimateTimeItem;\n          if (batchFoundEstimateTime.hasOwnProperty(thisStopKey)) {\n            thisEstimateTime = batchFoundEstimateTime[thisStopKey];\n          } else {\n            break;\n          }\n          integratedItem.status = parseEstimateTime(thisEstimateTime.EstimateTime, time_formatting_mode);\n          const thisRouteKey = `r_${integratedItem.route.id}`;\n          const thisRoute = Route[thisRouteKey] as SimplifiedRouteItem;\n          integratedItem.route.pathAttributeId = thisRoute.pid;\n          break;\n        }\n        case 'route': {\n          const thisRouteKey = `r_${integratedItem.id}`;\n          const thisRoute = Route[thisRouteKey] as SimplifiedRouteItem;\n          integratedItem.pathAttributeId = thisRoute.pid;\n          break;\n        }\n        case 'location': {\n          /*\n          const thisLocationKey = `ml_${integratedItem.id}`;\n          const thisLocation = Location[thisLocationKey] as MergedLocationItem;\n          let labels: Array<string> = [];\n          switch (location_labels) {\n            case 'address':\n              labels = generateLabelFromAddresses(thisLocation.a);\n              break;\n            case 'letters':\n              const stopLocationIds = thisLocation.id;\n              const stopLocationQuantity = stopLocationIds.length;\n              labels = generateLetterLabels(stopLocationQuantity);\n              break;\n            case 'directions':\n              const setsOfVectors = thisLocation.v;\n              const cardinalDirections: Array<CardinalDirection> = [];\n              for (const vectorSet of setsOfVectors) {\n                let x: number = 0;\n                let y: number = 0;\n                for (const vector of vectorSet) {\n                  x += vector[0];\n                  y += vector[1];\n                }\n                const meanVector = normalizeVector([x, y]) as [number, number];\n                const cardinalDirection = getCardinalDirectionFromVector(meanVector);\n                cardinalDirections.push(cardinalDirection);\n              }\n\n              labels = generateDirectionLabels(cardinalDirections);\n              break;\n            default:\n              break;\n          }\n          integratedItem.labels = labels.join(' - ');\n          */\n          break;\n        }\n        case 'bus':\n          break;\n        case 'empty':\n          break;\n        default:\n          break;\n      }\n      integratedFolder.content.push(integratedItem);\n    }\n    folders.push(integratedFolder);\n  }\n\n  const result: integratedFolders = {\n    folders: folders,\n    dataUpdateTime: getDataUpdateTime(requestID)\n  };\n\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n\n  if (!power_saving) {\n    if (refresh_interval_setting.dynamic) {\n      await collectUpdateRateData(EstimateTime);\n    }\n    await collectBusArrivalTimeData(EstimateTime);\n  }\n\n  return result;\n}\n\nexport async function saveToFolder(folderID: Folder['id'], content: FolderContent): Promise<boolean> {\n  const folderKey = `f_${folderID}`;\n  const contentKey = `${content.type}_${content.id}`;\n  const thisFolder = getFolder(folderID);\n\n  if (typeof thisFolder === 'boolean' && thisFolder === false) {\n    return false;\n  }\n\n  const thisFolderContentIndexJSON = (await lfGetItem(12, folderKey)) as string;\n  if (!thisFolderContentIndexJSON) {\n    return false;\n  }\n\n  const thisFolderContentIndexArray = JSON.parse(thisFolderContentIndexJSON) as Array<string>;\n  if (thisFolderContentIndexArray.length === 0 || thisFolderContentIndexArray.indexOf(contentKey) < 0) {\n    await lfSetItem(12, folderKey, JSON.stringify(thisFolderContentIndexArray.concat(contentKey)));\n    await lfSetItem(13, contentKey, JSON.stringify(content));\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport async function isFolderContentSaved(type: FolderContent['type'], id: FolderContent['id']): Promise<boolean> {\n  const folderContentKeyToCheck = `${type}_${id}`;\n\n  const keys = await lfListItemKeys(12);\n  for (const key of keys) {\n    const thisFolderContentIndexJSON = (await lfGetItem(12, key)) as string;\n    if (!thisFolderContentIndexJSON) {\n      continue;\n    }\n    const thisFolderContentIndexArray = JSON.parse(thisFolderContentIndexJSON) as Array<string>;\n    if (thisFolderContentIndexArray.indexOf(folderContentKeyToCheck) > -1) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport async function removeFromFolder(folderID: Folder['id'], type: FolderContent['type'], id: FolderContent['id']): Promise<boolean> {\n  const folderKey = `f_${folderID}`;\n  const thisFolderContentKey = `${type}_${id}`;\n\n  // Check existence\n  const thisFolder = getFolder(folderID);\n  if (typeof thisFolder === 'boolean' && thisFolder === false) {\n    return false;\n  }\n\n  // Remove reference from folder content index\n  const thisFolderContentIndexJSON = (await lfGetItem(12, folderKey)) as string;\n  if (!thisFolderContentIndexJSON) {\n    return false;\n  }\n  const thisFolderContentIndexArray = JSON.parse(thisFolderContentIndexJSON) as Array<string>;\n  const index = thisFolderContentIndexArray.indexOf(thisFolderContentKey);\n  if (index > -1 && thisFolderContentIndexArray.length > 0) {\n    thisFolderContentIndexArray.splice(index, 1);\n    await lfSetItem(12, folderKey, JSON.stringify(thisFolderContentIndexArray));\n  }\n\n  // Remove content if there are no other references\n  const isSaved = await isFolderContentSaved(type, id);\n  if (isSaved === false) {\n    await lfRemoveItem(13, thisFolderContentKey);\n  }\n  return true;\n}\n\nexport async function saveStop(folderID: Folder['id'], StopID: number, RouteID: number): Promise<boolean> {\n  const requestID = generateIdentifier();\n  const Stop = (await getStop(requestID)) as SimplifiedStop;\n  const Location = (await getLocation(requestID, 0)) as SimplifiedLocation;\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n\n  const thisStop = Stop[`s_${StopID}`];\n  const thisStopDirection: number = parseInt(thisStop.goBack);\n  const thisLocation = Location[`l_${thisStop.stopLocationId}`];\n  const thisStopName: string = thisLocation.n;\n\n  const thisRoute = Route[`r_${RouteID}`];\n  const thisRouteName: string = thisRoute.n;\n  const thisRouteDeparture: string = thisRoute.dep;\n  const thisRouteDestination: string = thisRoute.des;\n\n  const newContent: FolderContentStop = {\n    type: 'stop',\n    id: StopID,\n    timestamp: new Date().getTime(),\n    name: thisStopName,\n    direction: thisStopDirection,\n    route: {\n      name: thisRouteName,\n      endPoints: {\n        departure: thisRouteDeparture,\n        destination: thisRouteDestination\n      },\n      id: RouteID\n    }\n  };\n  const save = await saveToFolder(folderID, newContent);\n  return save;\n}\n\nexport async function saveRoute(folderID: Folder['id'], RouteID: number): Promise<boolean> {\n  const requestID = generateIdentifier();\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisRouteKey = `r_${RouteID}`;\n  let thisRoute = {} as SimplifiedRouteItem;\n  if (Route.hasOwnProperty(thisRouteKey)) {\n    thisRoute = Route[thisRouteKey];\n  } else {\n    return false;\n  }\n\n  const newContent: FolderContentRoute = {\n    type: 'route',\n    id: RouteID,\n    timestamp: new Date().getTime(),\n    name: thisRoute.n,\n    endPoints: {\n      departure: thisRoute.dep,\n      destination: thisRoute.des\n    }\n  };\n  const save = await saveToFolder(folderID, newContent);\n  return save;\n}\n\nexport async function saveLocation(folderID: Folder['id'], hash: string): Promise<boolean> {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  let thisLocation = {} as MergedLocationItem;\n  if (Location.hasOwnProperty(thisLocationKey)) {\n    thisLocation = Location[thisLocationKey];\n  } else {\n    return false;\n  }\n\n  const newContent: FolderContentLocation = {\n    type: 'location',\n    id: hash,\n    timestamp: new Date().getTime(),\n    name: thisLocation.n\n  };\n  const save = await saveToFolder(folderID, newContent);\n  return save;\n}\n\n// TODO: Save Bus\n\nexport async function updateFolderContentIndex(folderID: Folder['id'], type: FolderContent['type'], id: FolderContent['id'], direction: 'up' | 'down'): Promise<boolean> {\n  const folderKey = `f_${folderID}`;\n  const thisFolderContentKey = `${type}_${id}`;\n  const thisFolder = getFolder(folderID);\n  if (typeof thisFolder === 'boolean' && thisFolder === false) {\n    return false;\n  }\n\n  const thisFolderContentIndexJSON = (await lfGetItem(12, folderKey)) as string;\n  if (!thisFolderContentIndexJSON) {\n    return false;\n  }\n  const thisFolderContentIndexArray = JSON.parse(thisFolderContentIndexJSON) as Array<string>;\n\n  const index = thisFolderContentIndexArray.indexOf(thisFolderContentKey);\n  if (index > -1 && thisFolderContentIndexArray.length > 1) {\n    let offset: number = 0;\n    switch (direction) {\n      case 'up':\n        offset = -1;\n        break;\n      case 'down':\n        offset = 1;\n        break;\n      default:\n        offset = 0;\n        break;\n    }\n    thisFolderContentIndexArray.splice(index, 1);\n    thisFolderContentIndexArray.splice(index + offset, 0, thisFolderContentKey);\n    await lfSetItem(12, folderKey, JSON.stringify(thisFolderContentIndexArray));\n    return true;\n  } else {\n    return false;\n  }\n}\n","import { generateIdentifier } from '../../../tools/index';\nimport { findGlobalExtrema } from '../../../tools/math';\nimport { WeekDayIndex } from '../../../tools/time';\nimport { EstimateTime } from '../../apis/getEstimateTime/index';\nimport { listAllFolderContent } from '../../folder/index';\nimport { isInPersonalSchedule, listPersonalSchedules, PersonalSchedule } from '../../personal-schedule/index';\nimport { lfGetItem, lfListItemKeys, lfRemoveItem, lfSetItem } from '../../storage/index';\n\nconst busArrivalTimeData_writeAheadLog_maxDataLength: number = 32;\nlet busArrivalTimeData_writeAheadLog_id: string = '';\nlet busArrivalTimeData_writeAheadLog_tracking: boolean = false;\nlet busArrivalTimeData_trackedStops: Array<number> = [];\nlet busArrivalTimeData_writeAheadLog_group: BusArrivalTimeDataWriteAheadLog = {\n  data: {},\n  timestamp: 0,\n  id: ''\n};\nlet busArrivalTimeData_writeAheadLog_currentDataLength: number = 0;\n\nexport type BusArrivalTimeData = [estimateTime: number, timestamp: number]; // EstimateTime (seconds), timestamp (milliseconds)\n\nexport type BusArrivalTimeDataGroupStats = Array<number>;\n\nexport interface BusArrivalTimeDataGroup {\n  stats: BusArrivalTimeDataGroupStats;\n  day: WeekDayIndex;\n  max: number;\n  min: number;\n  timestamp: number;\n  id: number; // stop id\n}\n\nexport type BusArrivalTimeDataGroupArray = Array<BusArrivalTimeDataGroup>;\n\nexport interface BusArrivalTimeDataWriteAheadLog {\n  data: {\n    [key: string]: Array<BusArrivalTimeData>;\n  };\n  timestamp: number;\n  id: string;\n}\n\nexport interface BusArrivalTime {\n  personalSchedule: PersonalSchedule;\n  chart: string; // svg\n  day: WeekDayIndex;\n}\n\nexport interface BusArrivalTimes {\n  [stopKey: string]: Array<BusArrivalTime>;\n}\n\nconst getBusArrivalTimeDataStatsWorkerTasks = {};\nlet getBusArrivalTimeDataStatsPort;\n\n// Check if SharedWorker is supported, and fall back to Worker if not\nif (typeof SharedWorker !== 'undefined') {\n  const getBusArrivalTimeDataStatsWorker = new SharedWorker(new URL(/* webpackChunkName: \"getBusArrivalTimeDataStats-worker\" */ './getBusArrivalTimeDataStats-worker.ts', import.meta.url)); // Reusable shared worker\n  getBusArrivalTimeDataStatsPort = getBusArrivalTimeDataStatsWorker.port; // Access the port for communication\n  getBusArrivalTimeDataStatsPort.start(); // Start the port (required by some browsers)\n} else {\n  const getBusArrivalTimeDataStatsWorker = new Worker(new URL(/* webpackChunkName: \"getBusArrivalTimeDataStats-worker\" */ './getBusArrivalTimeDataStats-worker.ts', import.meta.url)); // Fallback to standard worker\n  getBusArrivalTimeDataStatsPort = getBusArrivalTimeDataStatsWorker; // Use Worker directly for communication\n}\n\n// Handle messages from the worker\ngetBusArrivalTimeDataStatsPort.onmessage = function (e) {\n  const [result, taskID] = e.data;\n  if (getBusArrivalTimeDataStatsWorkerTasks[taskID]) {\n    getBusArrivalTimeDataStatsWorkerTasks[taskID](result); // resolve\n    delete getBusArrivalTimeDataStatsWorkerTasks[taskID];\n  }\n};\n\n// Handle errors\ngetBusArrivalTimeDataStatsPort.onerror = function (e) {\n  console.error(e.message);\n};\n\nasync function getBusArrivalTimeDataStats(data: Array<BusArrivalTimeData>): Promise<BusArrivalTimeDataGroupStats> {\n  const taskID = generateIdentifier();\n\n  const result = await new Promise((resolve, reject) => {\n    getBusArrivalTimeDataStatsWorkerTasks[taskID] = resolve; // Store the resolve function for this taskID\n    getBusArrivalTimeDataStatsPort.onerror = function (e) {\n      reject(e.message);\n    };\n    getBusArrivalTimeDataStatsPort.postMessage([data, taskID]); // Send the task to the worker\n  });\n  return result;\n}\n\nfunction mergeBusArrivalTimeDataStats(targetStats: BusArrivalTimeDataGroupStats, sourceStats: BusArrivalTimeDataGroupStats): BusArrivalTimeDataGroupStats {\n  const mergedArray = new Uint32Array(60 * 24);\n  for (let i = 60 * 24 - 1; i >= 0; i--) {\n    mergedArray[i] = targetStats[i] + sourceStats[i];\n  }\n  return Array.from(mergedArray);\n}\n\nexport async function collectBusArrivalTimeData(EstimateTime: EstimateTime) {\n  const now = new Date();\n  const currentTimestamp: number = now.getTime();\n  const currentDay = now.getDay();\n  let needToReset = false;\n  // Initialize\n  if (!busArrivalTimeData_writeAheadLog_tracking) {\n    busArrivalTimeData_writeAheadLog_tracking = true;\n    busArrivalTimeData_writeAheadLog_id = generateIdentifier();\n    busArrivalTimeData_writeAheadLog_group = {\n      id: busArrivalTimeData_writeAheadLog_id,\n      timestamp: currentTimestamp,\n      data: {}\n    };\n    busArrivalTimeData_writeAheadLog_currentDataLength = 0;\n    const allFolderContent = await listAllFolderContent(['stop']);\n    busArrivalTimeData_trackedStops = allFolderContent.map((e) => e.id);\n  }\n\n  // Record EstimateTime\n  if (isInPersonalSchedule(now)) {\n    for (const item of EstimateTime) {\n      const stopID = item.StopID;\n      const stopKey = `s_${stopID}_${currentDay}`;\n      if (busArrivalTimeData_trackedStops.indexOf(stopID) > -1) {\n        if (!busArrivalTimeData_writeAheadLog_group.data.hasOwnProperty(stopKey)) {\n          busArrivalTimeData_writeAheadLog_group.data[stopKey] = [];\n        }\n        busArrivalTimeData_writeAheadLog_group.data[stopKey].push([parseInt(item.EstimateTime), currentTimestamp]);\n      }\n    }\n\n    busArrivalTimeData_writeAheadLog_currentDataLength += 1;\n    if (busArrivalTimeData_writeAheadLog_currentDataLength > busArrivalTimeData_writeAheadLog_maxDataLength) {\n      needToReset = true;\n    }\n\n    if (needToReset || busArrivalTimeData_writeAheadLog_currentDataLength % 8 === 0) {\n      await lfSetItem(5, busArrivalTimeData_writeAheadLog_id, JSON.stringify(busArrivalTimeData_writeAheadLog_group));\n    }\n\n    if (needToReset) {\n      for (const stopID of busArrivalTimeData_trackedStops) {\n        const stopKey = `s_${stopID}_${currentDay}`;\n        const data = busArrivalTimeData_writeAheadLog_group.data[stopKey];\n        const dataGroup = {} as BusArrivalTimeDataGroup;\n        const existingData = await lfGetItem(6, stopKey);\n        if (existingData) {\n          const existingDataObject = JSON.parse(existingData) as BusArrivalTimeDataGroup;\n          const newStats = getBusArrivalTimeDataStats(data);\n          const mergedStats = mergeBusArrivalTimeDataStats(existingDataObject.stats, newStats);\n          dataGroup.stats = mergedStats;\n          const mergedExtrema = findGlobalExtrema(mergedStats);\n          dataGroup.min = mergedExtrema[0];\n          dataGroup.max = mergedExtrema[1];\n          dataGroup.day = currentDay;\n          dataGroup.timestamp = existingDataObject.timestamp;\n          dataGroup.id = stopID;\n        } else {\n          const newStats = getBusArrivalTimeDataStats(data);\n          dataGroup.stats = newStats;\n          const newExtrema = findGlobalExtrema(newStats);\n          dataGroup.min = newExtrema[0];\n          dataGroup.max = newExtrema[1];\n          dataGroup.day = currentDay;\n          dataGroup.timestamp = currentTimestamp;\n          dataGroup.id = stopID;\n        }\n        await lfSetItem(6, stopKey, JSON.stringify(dataGroup));\n        await lfRemoveItem(5, busArrivalTimeData_writeAheadLog_id);\n      }\n      busArrivalTimeData_writeAheadLog_tracking = false;\n    }\n  }\n}\n\nexport async function recoverBusArrivalTimeDataFromWriteAheadLog() {\n  const now = new Date();\n  const currentTimestamp = now.getTime();\n  const currentDay = now.getDay();\n  const keys = await lfListItemKeys(5);\n  for (const key of keys) {\n    const json = await lfGetItem(5, key);\n    const object = JSON.parse(json) as BusArrivalTimeDataWriteAheadLog;\n    const thisID = object.id;\n    for (const stopKey in object.data) {\n      const thisStopData = object.data[stopKey];\n      const dataGroup = {} as BusArrivalTimeDataGroup;\n      const existingData = await lfGetItem(6, stopKey);\n      const stopID = parseInt(stopKey.split('_')[1]);\n      if (existingData) {\n        const existingDataObject = JSON.parse(existingData) as BusArrivalTimeDataGroup;\n        const newStats = getBusArrivalTimeDataStats(thisStopData);\n        const mergedStats = mergeBusArrivalTimeDataStats(existingDataObject.stats, newStats);\n        dataGroup.stats = mergedStats;\n        const newExtremum = findGlobalExtrema(mergedStats);\n        dataGroup.min = newExtremum[0];\n        dataGroup.max = newExtremum[1];\n        dataGroup.day = existingDataObject.day;\n        dataGroup.timestamp = existingDataObject.timestamp;\n        dataGroup.id = stopID;\n      } else {\n        const newStats = getBusArrivalTimeDataStats(thisStopData);\n        dataGroup.stats = newStats;\n        const newExtremum = findGlobalExtrema(newStats);\n        dataGroup.min = newExtremum[0];\n        dataGroup.max = newExtremum[1];\n        dataGroup.day = currentDay;\n        dataGroup.timestamp = currentTimestamp;\n        dataGroup.id = stopID;\n      }\n      await lfSetItem(6, stopKey, JSON.stringify(dataGroup));\n    }\n    await lfRemoveItem(5, thisID);\n  }\n}\n\nexport async function listBusArrivalTimeDataGroups(): Promise<BusArrivalTimeDataGroupArray> {\n  const keys = await lfListItemKeys(6);\n  const result: BusArrivalTimeDataGroupArray = [];\n  for (const key of keys) {\n    const json = await lfGetItem(6, key);\n    if (json) {\n      const object = JSON.parse(json) as BusArrivalTimeDataGroup;\n      result.push(object);\n    }\n  }\n  return result;\n}\n\nconst getBusArrivalTimesWorkerResponses = {};\nlet getBusArrivalTimesPort;\n\n// Check if SharedWorker is supported, and fall back to Worker if not\nif (typeof SharedWorker !== 'undefined') {\n  const getUpdateRateSharedWorker = new SharedWorker(new URL('./getBusArrivalTimes-worker.ts', import.meta.url)); // Reusable shared worker\n  getBusArrivalTimesPort = getUpdateRateSharedWorker.port; // Access the port for communication\n  getBusArrivalTimesPort.start(); // Start the port (required by some browsers)\n} else {\n  const getUpdateRateWorker = new Worker(new URL('./getBusArrivalTimes-worker.ts', import.meta.url)); // Fallback to standard worker\n  getBusArrivalTimesPort = getUpdateRateWorker; // Use Worker directly for communication\n}\n\n// Handle messages from the worker\ngetBusArrivalTimesPort.onmessage = function (e) {\n  const [result, taskID] = e.data;\n  if (getBusArrivalTimesWorkerResponses[taskID]) {\n    getBusArrivalTimesWorkerResponses[taskID](result); // Resolve the correct promise\n    delete getBusArrivalTimesWorkerResponses[taskID]; // Clean up the response handler\n  }\n};\n\n// Handle errors\ngetBusArrivalTimesPort.onerror = function (e) {\n  console.error(e.message);\n};\n\nexport async function getBusArrivalTimes(chartWidth: number, chartHeight: number): Promise<BusArrivalTimes> {\n  const taskID = generateIdentifier();\n\n  const personalSchedules = await listPersonalSchedules();\n  const busArrivalTimeDataGroups = await listBusArrivalTimeDataGroups();\n\n  const result = await new Promise((resolve, reject) => {\n    getBusArrivalTimesWorkerResponses[taskID] = resolve; // Store the resolve function for this taskID\n    getBusArrivalTimesPort.onerror = function (e) {\n      reject(e.message);\n    };\n    getBusArrivalTimesPort.postMessage([personalSchedules, busArrivalTimeDataGroups, chartWidth, chartHeight, taskID]); // Send the task to the worker\n  });\n  return result;\n}\n","export const levenshtein = require('js-levenshtein');\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { getIntersection } from '../../tools/array';\nimport { generateIdentifier } from '../../tools/index';\nimport { levenshtein } from '../../tools/levenshtein';\nimport { getMaterialSymbolsSearchIndex } from '../apis/getMaterialSymbolsSearchIndex/index';\nimport { deleteDataReceivingProgress } from '../apis/loader';\n\nlet searchStructure = {};\nlet readyToSearch = false;\n\nexport async function prepareForMaterialSymbolsSearch() {\n  if (readyToSearch) return;\n\n  const requestID = generateIdentifier();\n  const materialSymbolsSearchIndex = await getMaterialSymbolsSearchIndex(requestID);\n  deleteDataReceivingProgress(requestID);\n\n  const dictionary = materialSymbolsSearchIndex.dictionary.split(',');\n  const symbols = materialSymbolsSearchIndex.symbols;\n  const names = [];\n  const wordToSymbols: { [wordIndexKey: string]: Array<number> } = {};\n\n  let nameIndex = 0;\n  for (const symbol in symbols) {\n    // Create list of symbol names\n    names.push(symbol);\n    // Build wordIndex  nameIndex mapping\n    for (const wordIndex of symbols[symbol]) {\n      const wordIndexKey = `w${wordIndex}`;\n      if (!wordToSymbols.hasOwnProperty(wordIndexKey)) {\n        wordToSymbols[wordIndexKey] = [];\n      }\n      wordToSymbols[wordIndexKey].push(nameIndex);\n    }\n    nameIndex++;\n  }\n\n  searchStructure = { dictionary, names, wordToSymbols };\n  readyToSearch = true;\n}\n\nexport function searchForMaterialSymbols(query: string, searchFrom: number = 0, skipBroadTerms: boolean = true, broadThreshold: number = 0.3): Array<{ item: MaterialSymbols; score: number }> {\n  if (!readyToSearch) return [];\n\n  const { dictionary, names, wordToSymbols } = searchStructure;\n  const broadLength = Math.round(names.length * broadThreshold);\n\n  // Split query\n  const queryWords = Array.from(\n    new Set(\n      query\n        .trim()\n        .toLowerCase()\n        .split(/[\\s_-]+/)\n    )\n  );\n  const queryWordsLength = queryWords.length;\n\n  // Fuzzy match words to dictionary indices\n  const minDistances = new Uint8Array(queryWordsLength);\n  const matchedWordIndexes = new Int16Array(queryWordsLength).fill(-1);\n\n  for (let j = searchFrom; j < queryWordsLength; j++) {\n    minDistances[j] = queryWords[j].length;\n    for (let i = 0, l = dictionary.length; i < l; i++) {\n      const distance = levenshtein(queryWords[j], dictionary[i]);\n      if (distance <= minDistances[j]) {\n        minDistances[j] = distance;\n        matchedWordIndexes[j] = i;\n      }\n    }\n  }\n\n  // Pair words with symbols\n  let indexArrays = [];\n  for (let i = queryWordsLength - 1; i >= 0; i--) {\n    if (matchedWordIndexes[i] < 0) continue;\n    const arr = wordToSymbols[`w${matchedWordIndexes[i]}`] || [];\n    if (skipBroadTerms && arr.length > broadLength) continue;\n    indexArrays.push(arr);\n  }\n\n  const indexArraysLength = indexArrays.length;\n\n  if (indexArraysLength === 0) return [];\n\n  // Sort by length (shortest  longest)\n  indexArrays.sort((a, b) => a.length - b.length);\n\n  // Intersect\n  let candidates = indexArrays[0];\n  for (let i = 1; i < indexArraysLength; i++) {\n    candidates = getIntersection(candidates, indexArrays[i]);\n  }\n\n  // Rank candidates\n  const scored = [];\n  for (let i = 0, l = candidates.length; i < l; i++) {\n    let score = 0;\n    for (let j = queryWordsLength - 1; j >= 0; j--) {\n      if (matchedWordIndexes[j] < 0) continue;\n      const symbolWordIndexes = wordToSymbols[`w${matchedWordIndexes[j]}`] || [];\n      if (symbolWordIndexes.indexOf(candidates[i]) > -1) {\n        score -= j; // earlier query words = higher weight\n      }\n    }\n    scored.push({\n      item: names[candidates[i]],\n      score: score\n    });\n  }\n\n  scored.sort((a, b) => b.score - a.score);\n  return scored;\n}\n","import { getCarInfo } from '../../data/apis/getCarInfo/index';\nimport { getLocation } from '../../data/apis/getLocation/index';\nimport { getMaterialSymbolsSearchIndex } from '../../data/apis/getMaterialSymbolsSearchIndex/index';\nimport { getRoute } from '../../data/apis/getRoute/index';\nimport { DataReceivingProgressEvent, deleteDataReceivingProgress, deleteDataUpdateTime, getDataReceivingProgress, setDataReceivingProgress } from '../../data/apis/loader';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\n\nconst dataDownloadRequestID = 'downloadData';\nexport let dataDownloadCompleted = false;\n\nconst HomeField = documentQuerySelector('.css_home_field');\nconst HomeHeadElement = elementQuerySelector(HomeField, '.css_home_head');\nconst homeButtonRightElement = elementQuerySelector(HomeHeadElement, '.css_home_button_right');\nconst progressElement = elementQuerySelector(homeButtonRightElement, 'svg#download-svg path[progress=\"progress\"]');\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  const pixels = (1 - getDataReceivingProgress(dataDownloadRequestID)) * 189;\n  progressElement.style.setProperty('--b-cssvar-stroke-dashoffset', `${pixels}px`);\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n    progressElement.addEventListener(\n      'transitionend',\n      function () {\n        homeButtonRightElement.setAttribute('complete', 'true');\n      },\n      { once: true }\n    );\n    progressElement.style.setProperty('--b-cssvar-stroke-dashoffset', `${0}px`);\n    dataDownloadCompleted = true;\n  }\n}\n\nexport async function downloadData() {\n  /*\n  setDataReceivingProgress(dataDownloadRequestID, 'getRoute_0', 0, false);\n  setDataReceivingProgress(dataDownloadRequestID, 'getRoute_1', 0, false);\n  */\n  // eliminate duplicate downloads in integrateFolders\n  setDataReceivingProgress(dataDownloadRequestID, 'getLocation_0', 0, false);\n  setDataReceivingProgress(dataDownloadRequestID, 'getLocation_1', 0, false);\n  setDataReceivingProgress(dataDownloadRequestID, 'getCarInfo_0', 0, false);\n  setDataReceivingProgress(dataDownloadRequestID, 'getCarInfo_1', 0, false);\n  setDataReceivingProgress(dataDownloadRequestID, 'getMaterialSymbolsSearchIndex', 0, false);\n  document.addEventListener(dataDownloadRequestID, handleDataReceivingProgressUpdates);\n  await getRoute(dataDownloadRequestID, true);\n  await getLocation(dataDownloadRequestID, 1);\n  await getCarInfo(dataDownloadRequestID, true);\n  await getMaterialSymbolsSearchIndex(dataDownloadRequestID);\n  deleteDataReceivingProgress(dataDownloadRequestID);\n  deleteDataUpdateTime(dataDownloadRequestID);\n}\n","import { getMaterialSymbolsSearchIndex } from '../../data/apis/getMaterialSymbolsSearchIndex/index';\nimport { deleteDataReceivingProgress } from '../../data/apis/loader';\nimport { prepareForMaterialSymbolsSearch, searchForMaterialSymbols } from '../../data/search/searchMaterialSymbols';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { generateIdentifier } from '../../tools/index';\nimport { containPhoneticSymbols } from '../../tools/text';\nimport { dataDownloadCompleted } from '../home/index';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\ntype Target = 'editor' | 'creator' | '';\n\nlet currentTarget: Target = '';\n\nconst folderEditorField = documentQuerySelector('.css_folder_editor_field');\nconst folderCreatorField = documentQuerySelector('.css_folder_creator_field');\nconst folderIconSelectorField = documentQuerySelector('.css_folder_icon_selector_field');\n\nfunction generateElementOfSymbol(symbol: string): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_folder_icon_selector_symbol');\n  element.onclick = function () {\n    selectFolderIcon(symbol, currentTarget);\n  };\n  element.appendChild(getIconElement(symbol));\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nasync function initializeFolderIconSelectorField() {\n  const materialSymbolsElement = elementQuerySelector(folderIconSelectorField, '.css_folder_icon_selector_body .css_folder_icon_selector_material_symbols');\n  materialSymbolsElement.innerHTML = '';\n  const requestID = generateIdentifier();\n  const materialSymbols = await getMaterialSymbolsSearchIndex(requestID);\n  deleteDataReceivingProgress(requestID);\n  const fragment = new DocumentFragment();\n  for (const symbol in materialSymbols.symbols) {\n    const symbolElement = generateElementOfSymbol(symbol, currentTarget);\n    fragment.appendChild(symbolElement.element);\n  }\n  materialSymbolsElement.append(fragment);\n}\n\nexport function updateMaterialSymbolsSearchResult(query: string): void {\n  const materialSymbolsSearchResultsElement = elementQuerySelector(folderIconSelectorField, '.css_folder_icon_selector_body .css_folder_icon_selector_material_symbols_search_results');\n  const materialSymbolsElement = elementQuerySelector(folderIconSelectorField, '.css_folder_icon_selector_body .css_folder_icon_selector_material_symbols');\n  if (!containPhoneticSymbols(query)) {\n    const searchResults = searchForMaterialSymbols(query);\n    const fragment = new DocumentFragment();\n    for (const result of searchResults) {\n      const symbolElement = generateElementOfSymbol(result.item, currentTarget);\n      fragment.appendChild(symbolElement.element);\n    }\n    materialSymbolsSearchResultsElement.innerHTML = '';\n    materialSymbolsSearchResultsElement.append(fragment);\n    materialSymbolsSearchResultsElement.setAttribute('displayed', searchResults.length > 0 ? 'true' : 'false');\n    materialSymbolsElement.setAttribute('displayed', searchResults.length > 0 ? 'false' : 'true');\n  }\n}\n\nexport function selectFolderIcon(symbol: string): void {\n  let iconInputElement;\n  switch (currentTarget) {\n    case 'editor':\n      iconInputElement = elementQuerySelector(folderEditorField, '.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input input');\n      break;\n    case 'creator':\n      iconInputElement = elementQuerySelector(folderCreatorField, '.css_folder_creator_body .css_folder_creator_groups .css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input input');\n      break;\n    default:\n      break;\n  }\n  iconInputElement.value = symbol;\n  closeFolderIconSelector();\n}\n\nexport function openFolderIconSelector(target: Target): void {\n  pushPageHistory('FolderIconSelector');\n  var openFolderIconSelectorElement;\n  switch (target) {\n    case 'editor':\n      currentTarget = 'editor';\n      openFolderIconSelectorElement = elementQuerySelector(folderEditorField, '.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input .css_folder_editor_open_folder_icon_selector');\n      break;\n    case 'creator':\n      currentTarget = 'creator';\n      openFolderIconSelectorElement = elementQuerySelector(folderCreatorField, '.css_folder_creator_body .css_folder_creator_groups .css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input .css_folder_creator_open_folder_icon_selector');\n      break;\n    default:\n      break;\n  }\n  if (dataDownloadCompleted) {\n    folderIconSelectorField.setAttribute('displayed', 'true');\n    initializeFolderIconSelectorField(currentTarget);\n    prepareForMaterialSymbolsSearch();\n  } else {\n    promptMessage('download_for_offline', '');\n  }\n}\n\nexport function closeFolderIconSelector(): void {\n  revokePageHistory('FolderIconSelector');\n  folderIconSelectorField.setAttribute('displayed', 'false');\n}\n","import { createFolder } from '../../data/folder/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { openFolderIconSelector } from '../folder-icon-selector/index';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst FolderCreatorField = documentQuerySelector('.css_folder_creator_field');\nconst FolderCreatorBodyElement = elementQuerySelector(FolderCreatorField, '.css_folder_creator_body');\nconst FolderCreatorGroupsElement = elementQuerySelector(FolderCreatorBodyElement, '.css_folder_creator_groups');\nconst NameInputElement = elementQuerySelector(FolderCreatorGroupsElement, '.css_folder_creator_group[group=\"folder-name\"] .css_folder_creator_group_body input');\nconst IconInputElement = elementQuerySelector(FolderCreatorGroupsElement, '.css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input input');\nconst OpenFolderIconSelectorElement = elementQuerySelector(FolderCreatorGroupsElement, '.css_folder_creator_field .css_folder_creator_body .css_folder_creator_groups .css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input .css_folder_creator_open_folder_icon_selector');\n\nOpenFolderIconSelectorElement.onclick = function () {\n  openFolderIconSelector('creator');\n};\n\nexport function createFormulatedFolder(): void {\n  const name = NameInputElement.value;\n  const icon = IconInputElement.value;\n  createFolder(name, icon).then((e) => {\n    if (e) {\n      closeFolderCreator();\n      promptMessage('folder', '');\n    } else {\n      promptMessage('error', '');\n    }\n  });\n}\n\nexport function openFolderCreator(): void {\n  pushPageHistory('FolderCreator');\n  FolderCreatorField.setAttribute('displayed', 'true');\n  closePreviousPage();\n}\n\nexport function closeFolderCreator(): void {\n  // revokePageHistory('FolderCreator');\n  FolderCreatorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n","import { Folder, FolderContent, getFolder, listFolderContent, removeFromFolder, updateFolder, updateFolderContentIndex } from '../../data/folder/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { generateIdentifier } from '../../tools/index';\nimport { openFolderIconSelector } from '../folder-icon-selector/index';\nimport { getIconElement } from '../icons/index';\nimport { MaterialSymbols } from '../icons/material-symbols-type';\nimport { closePreviousPage, GeneratedElement, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst FolderEditorField = documentQuerySelector('.css_folder_editor_field');\nconst FolderEditorHeadElement = elementQuerySelector(FolderEditorField, '.css_folder_editor_head');\nconst LeftButtonElement = elementQuerySelector(FolderEditorHeadElement, '.css_folder_editor_button_left');\nconst FolderEditorBodyElement = elementQuerySelector(FolderEditorField, '.css_folder_editor_body');\nconst FolderEditorGroupsElement = elementQuerySelector(FolderEditorBodyElement, '.css_folder_editor_groups');\nconst NameInputElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-name\"] .css_folder_editor_group_body input') as HTMLInputElement;\nconst IconInputElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input input') as HTMLInputElement;\nconst OpenFolderIconSelectorElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input .css_folder_editor_open_folder_icon_selector');\nconst FolderContentElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-content\"] .css_folder_editor_group_body');\n\nOpenFolderIconSelectorElement.onclick = function () {\n  openFolderIconSelector('editor');\n};\n\nfunction generateElementOfItem(folder: Folder, item: FolderContent): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main container\n  const itemElement = document.createElement('div');\n  itemElement.id = identifier;\n  itemElement.classList.add('css_folder_editor_folder_item');\n  itemElement.setAttribute('type', item.type);\n\n  // Icon, context, main text\n  let context = '';\n  let main = '';\n  let icon: MaterialSymbols = '';\n  switch (item.type) {\n    case 'stop':\n      icon = 'location_on';\n      context = `${item.route ? item.route.name : ''} - ${item.route ? [item.route.endPoints.destination, item.route.endPoints.departure, ''][item.direction ? item.direction : 0] : ''}`;\n      main = item.name;\n      break;\n    case 'route':\n      icon = 'route';\n      context = `${item.endPoints.departure} \\u2194 ${item.endPoints.destination}`;\n      main = item.name;\n      break;\n    case 'location':\n      icon = 'location_on';\n      context = '';\n      main = item.name;\n      break;\n    case 'bus':\n      context = '';\n      main = item.name;\n      break;\n    case 'empty':\n      icon = 'lightbulb';\n      context = '';\n      main = '';\n      break;\n    default:\n      icon = '';\n      context = 'null';\n      main = 'null';\n      break;\n  }\n\n  // Icon element\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_folder_editor_folder_item_icon');\n  iconElement.appendChild(getIconElement(icon));\n\n  // Context element\n  const contextElement = document.createElement('div');\n  contextElement.classList.add('css_folder_editor_folder_item_context');\n  contextElement.appendChild(document.createTextNode(context));\n\n  // Main element\n  const mainElement = document.createElement('div');\n  mainElement.classList.add('css_folder_editor_folder_item_main');\n  mainElement.appendChild(document.createTextNode(main));\n\n  // Capsule element\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_folder_editor_folder_item_capsule');\n\n  // Sort up control\n  const sortUpElement = document.createElement('div');\n  sortUpElement.classList.add('css_folder_editor_folder_item_sort_control_up');\n  sortUpElement.appendChild(getIconElement('keyboard_arrow_down'));\n  sortUpElement.onclick = () => {\n    moveItemOnFolderEditor(identifier, folder.id, item.type, item.id, 'up');\n  };\n\n  // Sort down control\n  const sortDownElement = document.createElement('div');\n  sortDownElement.classList.add('css_folder_editor_folder_item_sort_control_down');\n  sortDownElement.appendChild(getIconElement('keyboard_arrow_down'));\n  sortDownElement.onclick = () => {\n    moveItemOnFolderEditor(identifier, folder.id, item.type, item.id, 'down');\n  };\n\n  // Delete control\n  const deleteElement = document.createElement('div');\n  deleteElement.classList.add('css_folder_editor_folder_item_delete');\n  deleteElement.appendChild(getIconElement('delete'));\n  deleteElement.onclick = () => {\n    removeItemOnFolderEditor(identifier, folder.id, item.type, item.id);\n  };\n\n  // Capsule separators\n  const separator1Element = document.createElement('div');\n  separator1Element.classList.add('css_folder_editor_folder_item_capsule_separator');\n  const separator2Element = document.createElement('div');\n  separator2Element.classList.add('css_folder_editor_folder_item_capsule_separator');\n\n  // Assemble capsule\n  capsuleElement.appendChild(sortUpElement);\n  capsuleElement.appendChild(sortDownElement);\n  capsuleElement.appendChild(deleteElement);\n  capsuleElement.appendChild(separator1Element);\n  capsuleElement.appendChild(separator2Element);\n\n  // Assemble main item\n  itemElement.appendChild(iconElement);\n  itemElement.appendChild(contextElement);\n  itemElement.appendChild(mainElement);\n  itemElement.appendChild(capsuleElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction updateFolderEditorField(folder: Folder, content: Array<FolderContent>): void {\n  NameInputElement.value = folder.name;\n  IconInputElement.value = folder.icon;\n\n  LeftButtonElement.onclick = function () {\n    saveEditedFolder(folder.id);\n  };\n\n  FolderContentElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  for (const item of content) {\n    const thisItemElement = generateElementOfItem(folder, item);\n    fragment.appendChild(thisItemElement.element);\n  }\n  FolderContentElement.append(fragment);\n}\n\nasync function initializeFolderEditorField(folderID: string) {\n  // TODO: add skeleton screen\n  const folder = getFolder(folderID);\n  const content = await listFolderContent(folderID);\n  updateFolderEditorField(folder, content);\n}\n\nexport function openFolderEditor(folderID: string): void {\n  pushPageHistory('FolderEditor');\n  FolderEditorField.setAttribute('displayed', 'true');\n  initializeFolderEditorField(folderID);\n  closePreviousPage();\n}\n\nexport function closeFolderEditor(): void {\n  // revokePageHistory('FolderEditor');\n  FolderEditorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport function removeItemOnFolderEditor(itemID: string, folderID: Folder['id'], type: FolderContent['type'], id: number): void {\n  const itemElement = elementQuerySelector(FolderEditorField, `.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-content\"] .css_folder_editor_group_body .css_folder_editor_folder_item#${itemID}`);\n  removeFromFolder(folderID, type, id).then((e) => {\n    if (e) {\n      itemElement.remove();\n      switch (type) {\n        case 'stop':\n          promptMessage('delete', '');\n          break;\n        case 'route':\n          promptMessage('delete', '');\n          break;\n        case 'location':\n          promptMessage('delete', '');\n          break;\n        default:\n          break;\n      }\n    } else {\n      promptMessage('error', '');\n    }\n  });\n}\n\nexport function moveItemOnFolderEditor(itemID: string, folderID: Folder['id'], type: FolderContent['type'], id: FolderContent['id'], direction: 'up' | 'down'): void {\n  const itemElement = elementQuerySelector(FolderEditorField, `.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-content\"] .css_folder_editor_group_body .css_folder_editor_folder_item#${itemID}`);\n  updateFolderContentIndex(folderID, type, id, direction).then((e) => {\n    if (e) {\n      switch (direction) {\n        case 'up':\n          const previousSibling = itemElement.previousElementSibling;\n          if (previousSibling) {\n            itemElement.parentNode.insertBefore(itemElement, previousSibling);\n          }\n          promptMessage('arrow_circle_up', '');\n          break;\n        case 'down':\n          const nextSibling = itemElement.nextElementSibling;\n          if (nextSibling) {\n            itemElement.parentNode.insertBefore(nextSibling, itemElement);\n          }\n          promptMessage('arrow_circle_down', '');\n          break;\n        default:\n          break;\n      }\n    } else {\n      promptMessage('error', '');\n    }\n  });\n}\n\nexport function saveEditedFolder(folderID: string): void {\n  const name = NameInputElement.value;\n  const icon = IconInputElement.value;\n  updateFolder(folderID, name, icon).then(function (e) {\n    if (e) {\n      closeFolderEditor();\n      promptMessage('check_circle', '');\n    } else {\n      promptMessage('error', '');\n    }\n  });\n}\n","import { FolderWithContent, listFoldersWithContent } from '../../data/folder/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { openFolderEditor } from '../folder-editor/index';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\n\nconst FolderManagerField = documentQuerySelector('.css_folder_manager_field');\nconst FolderManagerBodyElement = elementQuerySelector(FolderManagerField, '.css_folder_manager_body');\nconst FolderManagerFolderListElement = elementQuerySelector(FolderManagerBodyElement, '.css_folder_manager_folder_list');\n\nfunction generateElementOfItem(item: FolderWithContent): GeneratedElement {\n  // Main container\n  const folderItemElement = document.createElement('div');\n  folderItemElement.classList.add('css_folder_manager_folder_item');\n  folderItemElement.onclick = () => {\n    openFolderEditor(item.id);\n  };\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_folder_manager_folder_item_icon');\n  iconElement.appendChild(getIconElement(item.icon));\n\n  // Name\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_folder_manager_folder_item_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_folder_manager_folder_item_status');\n  statusElement.appendChild(document.createTextNode(String(item.contentLength)));\n\n  // Arrow\n  const arrowElement = document.createElement('div');\n  arrowElement.classList.add('css_folder_manager_folder_item_arrow');\n  arrowElement.appendChild(getIconElement('arrow_forward_ios'));\n\n  // Assemble\n  folderItemElement.appendChild(iconElement);\n  folderItemElement.appendChild(nameElement);\n  folderItemElement.appendChild(statusElement);\n  folderItemElement.appendChild(arrowElement);\n\n  return {\n    element: folderItemElement,\n    id: ''\n  };\n}\n\nasync function initializeFolderManagerField() {\n  const foldersWithContent = await listFoldersWithContent();\n  FolderManagerFolderListElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  for (const item of foldersWithContent) {\n    const newItemElement = generateElementOfItem(item);\n    fragment.appendChild(newItemElement.element);\n  }\n  FolderManagerFolderListElement.append(fragment);\n}\n\nexport function openFolderManager(): void {\n  pushPageHistory('FolderManager');\n  FolderManagerField.setAttribute('displayed', 'true');\n  initializeFolderManagerField();\n  // closePreviousPage();\n}\n\nexport function closeFolderManager(): void {\n  revokePageHistory('FolderManager');\n  FolderManagerField.setAttribute('displayed', 'false');\n  // openPreviousPage();\n}\n","import { generateIdentifier } from '../../tools/index';\nimport { TimePeriod, WeekDayIndexArray } from '../../tools/time';\nimport { lfGetItem, lfListItemKeys, lfSetItem } from '../storage/index';\n\nexport interface PersonalSchedule {\n  name: string;\n  period: TimePeriod;\n  days: WeekDayIndexArray;\n  id: string;\n}\n\nexport type PersonalScheduleArray = Array<PersonalSchedule>;\n\nexport type MergedPersonalScheduleTimeline = { [key: string]: Array<TimePeriod> };\n\nexport async function createPersonalSchedule(name: string, startHours: number, startMinutes: number, endHours: number, endMinutes: number, days: Array<number>): Promise<boolean> {\n  const identifier = generateIdentifier();\n  if (startHours < 0 || startHours > 23 || startMinutes < 0 || startMinutes > 59 || endHours < 0 || endHours > 23 || endMinutes < 0 || endMinutes > 59) {\n    return false;\n  }\n  if (!Number.isInteger(startHours) || !Number.isInteger(startMinutes) || !Number.isInteger(endHours) || !Number.isInteger(endMinutes)) {\n    return false;\n  }\n  if (days.length > 7) {\n    return false;\n  }\n  for (const day of days) {\n    if (typeof day === 'number') {\n      if (day < 0 || day > 6 || !Number.isInteger(day)) {\n        return false;\n      }\n    }\n  }\n\n  const object: PersonalSchedule = {\n    name: name,\n    period: {\n      start: {\n        hours: startHours,\n        minutes: startMinutes\n      },\n      end: {\n        hours: endHours,\n        minutes: endMinutes\n      }\n    },\n    days: days,\n    id: identifier\n  };\n  await lfSetItem(7, identifier, JSON.stringify(object));\n  return true;\n}\n\nexport async function getPersonalSchedule(personalScheduleID: string): Promise<PersonalSchedule> {\n  const existingPersonalSchedule = await lfGetItem(7, personalScheduleID);\n  if (existingPersonalSchedule) {\n    const object = JSON.parse(existingPersonalSchedule);\n    return object;\n  }\n}\n\nexport async function updatePersonalSchedule(personalSchedule: PersonalSchedule): Promise<boolean> {\n  const thisPersonalSchedule = await getPersonalSchedule(personalSchedule.id);\n  if (thisPersonalSchedule) {\n    await lfSetItem(7, personalSchedule.id, JSON.stringify(personalSchedule));\n  }\n}\n\nexport async function listPersonalSchedules(): Promise<PersonalScheduleArray> {\n  const result: PersonalScheduleArray = [];\n  const keys = await lfListItemKeys(7);\n  for (const key of keys) {\n    const existingPersonalSchedule = await lfGetItem(7, key);\n    if (existingPersonalSchedule) {\n      const existingPersonalScheduleObject = JSON.parse(existingPersonalSchedule);\n      result.push(existingPersonalScheduleObject);\n    }\n  }\n\n  result.sort(function (a, b) {\n    return a.period.end.hours * 60 + a.period.end.minutes - (b.period.end.hours * 60 + b.period.end.minutes);\n  });\n\n  result.sort(function (a, b) {\n    return a.period.start.hours * 60 + a.period.start.minutes - (b.period.start.hours * 60 + b.period.start.minutes);\n  });\n\n  return result;\n}\n\nexport async function getMergedPersonalScheduleTimeline(): Promise<MergedPersonalScheduleTimeline> {\n  const personalSchedules = await listPersonalSchedules();\n\n  const result: MergedPersonalScheduleTimeline = {};\n\n  for (const personalSchedule of personalSchedules) {\n    for (const day of personalSchedule.days) {\n      const dayKey = `d_${day}`;\n      if (!result.hasOwnProperty(dayKey)) {\n        result[dayKey] = [];\n      }\n      const object = {\n        start: personalSchedule.period.start,\n        end: personalSchedule.period.end\n      };\n      result[dayKey].push(object);\n    }\n  }\n\n  for (const dayKey in result) {\n    const personalSchedulesOfThisDay = result[dayKey];\n    const personalSchedulesOfThisDayLength = personalSchedulesOfThisDay.length;\n    const mergedPersonalSchedulesOfThisDay = [];\n    for (let i = 0; i < personalSchedulesOfThisDayLength; i++) {\n      const previousPersonalScheduleOfThisDay = personalSchedulesOfThisDay[i - 1] || personalSchedulesOfThisDay[i];\n      const currentPersonalScheduleOfThisDay = personalSchedulesOfThisDay[i];\n      if (mergedPersonalSchedulesOfThisDay.length === 0) {\n        mergedPersonalSchedulesOfThisDay.push(currentPersonalScheduleOfThisDay);\n      } else {\n        // Check whether the current is after the previous and  the current is before the previous's end\n        if (currentPersonalScheduleOfThisDay.start.hours * 60 + currentPersonalScheduleOfThisDay.start.minutes >= previousPersonalScheduleOfThisDay.start.hours * 60 + previousPersonalScheduleOfThisDay.start.minutes && currentPersonalScheduleOfThisDay.start.hours * 60 + currentPersonalScheduleOfThisDay.start.minutes <= previousPersonalScheduleOfThisDay.end.hours * 60 + previousPersonalScheduleOfThisDay.end.minutes) {\n          mergedPersonalSchedulesOfThisDay[mergedPersonalSchedulesOfThisDay.length - 1].end.hours = currentPersonalScheduleOfThisDay.end.hours;\n          mergedPersonalSchedulesOfThisDay[mergedPersonalSchedulesOfThisDay.length - 1].end.minutes = currentPersonalScheduleOfThisDay.end.minutes;\n        } else {\n          mergedPersonalSchedulesOfThisDay.push(currentPersonalScheduleOfThisDay);\n        }\n      }\n    }\n    result[dayKey] = mergedPersonalSchedulesOfThisDay;\n  }\n\n  return result;\n}\n\nexport async function isInPersonalSchedule(date: Date): boolean {\n  const timeline = await getMergedPersonalScheduleTimeline();\n  const day = date.getDay();\n  const dayKey = `d_${day}`;\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n\n  if (timeline.hasOwnProperty(dayKey)) {\n    const personalSchedulesOfTheDay = timeline[dayKey];\n    for (const personalScheduleOfTheDay of personalSchedulesOfTheDay) {\n      if (hours * 60 + minutes >= personalScheduleOfTheDay.start.hours * 60 + personalScheduleOfTheDay.start.minutes && hours * 60 + minutes <= personalScheduleOfTheDay.end.hours * 60 + personalScheduleOfTheDay.end.minutes) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n","import { getPersonalSchedule, updatePersonalSchedule } from '../../data/personal-schedule/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { timeObjectToString, WeekDayIndex } from '../../tools/time';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\n\nconst PersonalScheduleEditorField = documentQuerySelector('.css_personal_schedule_editor_field');\nconst PersonalScheduleEditorBodyElement = elementQuerySelector(PersonalScheduleEditorField, '.css_personal_schedule_editor_body');\nconst PersonalScheduleEditorHeadElement = elementQuerySelector(PersonalScheduleEditorField, '.css_personal_schedule_editor_head');\nconst leftButtonElement = elementQuerySelector(PersonalScheduleEditorHeadElement, '.css_personal_schedule_editor_button_left');\nconst PersonalScheduleEditorGroups = elementQuerySelector(PersonalScheduleEditorBodyElement, '.css_personal_schedule_editor_groups');\nconst nameInputElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-name\"] .css_personal_schedule_editor_group_body input');\nconst startTimeInputElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-start-time\"] .css_personal_schedule_editor_group_body input');\nconst endTimeInputElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-end-time\"] .css_personal_schedule_editor_group_body input');\nconst dayGroupBodyElement = elementQuerySelector(PersonalScheduleEditorGroups, '.css_personal_schedule_editor_group[group=\"schedule-days\"] .css_personal_schedule_editor_group_body');\nconst dayElements = elementQuerySelectorAll(dayGroupBodyElement, '.css_personal_schedule_editor_day');\n\nexport async function saveEditedPersonalSchedule(personalScheduleID: string) {\n  const name = nameInputElement.value;\n  const startTime = startTimeInputElement.value;\n  const endTime = endTimeInputElement.value;\n\n  const [startHours, startMinutes] = String(startTime)\n    .split(':')\n    .map((e) => parseInt(e));\n  const [endHours, endMinutes] = String(endTime)\n    .split(':')\n    .map((e) => parseInt(e));\n\n  let days = [];\n  for (let i = 0; i < 7; i++) {\n    const thisDayElement = dayElements[i];\n    const highlighted = thisDayElement.getAttribute('highlighted');\n    const day = parseInt(thisDayElement.getAttribute('day'));\n    if (highlighted === 'true') {\n      days.push(day);\n    }\n  }\n\n  let personalSchedule = await getPersonalSchedule(personalScheduleID);\n  personalSchedule.name = name;\n  personalSchedule.days = days;\n  personalSchedule.period.start.hours = startHours;\n  personalSchedule.period.start.minutes = startMinutes;\n  personalSchedule.period.end.hours = endHours;\n  personalSchedule.period.end.minutes = endMinutes;\n\n  await updatePersonalSchedule(personalSchedule);\n  closePersonalScheduleEditor();\n}\n\nasync function initializePersonalScheduleEditorField(personalScheduleID: string) {\n  const personalSchedule = await getPersonalSchedule(personalScheduleID);\n  nameInputElement.value = personalSchedule.name;\n  startTimeInputElement.value = timeObjectToString(personalSchedule.period.start);\n  endTimeInputElement.value = timeObjectToString(personalSchedule.period.end);\n\n  for (let i = 0; i < 7; i++) {\n    const thisDayElement = dayElements[i];\n    if (personalSchedule.days.indexOf(i) > -1) {\n      thisDayElement.setAttribute('highlighted', 'true');\n    } else {\n      thisDayElement.setAttribute('highlighted', 'false');\n    }\n  }\n  leftButtonElement.onclick = function () {\n    saveEditedPersonalSchedule(personalScheduleID);\n  };\n}\n\nexport function openPersonalScheduleEditor(personalScheduleID: string): void {\n  pushPageHistory('PersonalScheduleEditor');\n  PersonalScheduleEditorField.setAttribute('displayed', 'true');\n  initializePersonalScheduleEditorField(personalScheduleID);\n  closePreviousPage();\n}\n\nexport function closePersonalScheduleEditor(): void {\n  // revokePageHistory('PersonalScheduleEditor');\n  PersonalScheduleEditorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport function switchPersonalScheduleEditorDay(day: WeekDayIndex): void {\n  const thisDayElement = elementQuerySelector(dayGroupBodyElement, `.css_personal_schedule_editor_day[day=\"${day}\"]`);\n  const highlighted = thisDayElement.getAttribute('highlighted');\n  if (highlighted === 'true') {\n    thisDayElement.setAttribute('highlighted', 'false');\n  } else {\n    thisDayElement.setAttribute('highlighted', 'true');\n  }\n}\n","import { listPersonalSchedules, PersonalSchedule } from '../../data/personal-schedule/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { openPersonalScheduleEditor } from '../personal-schedule-editor/index';\n\nconst PersonalScheduleManagerField = documentQuerySelector('.css_personal_schedule_manager_field');\nconst PersonalScheduleManagerBodyElement = elementQuerySelector(PersonalScheduleManagerField, '.css_personal_schedule_manager_body');\nconst ListElement = elementQuerySelector(PersonalScheduleManagerBodyElement, '.css_personal_schedule_manager_list');\n\nfunction generateElementOfItem(item: PersonalSchedule): GeneratedElement {\n  // const identifier = generateIdentifier();\n\n  // Main item element\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_personal_schedule_manager_item');\n  // itemElement.id = identifier;\n  itemElement.onclick = function () {\n    openPersonalScheduleEditor(item.id);\n  };\n\n  // Name element\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_personal_schedule_manager_item_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n  itemElement.appendChild(nameElement);\n\n  // Arrow element\n  const arrowElement = document.createElement('div');\n  arrowElement.classList.add('css_personal_schedule_manager_item_arrow');\n  const iconElement = document.createElement('span');\n  iconElement.appendChild(getIconElement('arrow_forward_ios'));\n  arrowElement.appendChild(iconElement);\n  itemElement.appendChild(arrowElement);\n\n  return {\n    element: itemElement,\n    id: ''\n  };\n}\nasync function initializePersonalScheduleManagerField() {\n  ListElement.innerHTML = '';\n  const personalSchedules = await listPersonalSchedules();\n  const fragment = new DocumentFragment();\n  for (const item of personalSchedules) {\n    const thisElement = generateElementOfItem(item);\n    fragment.appendChild(thisElement.element);\n  }\n  ListElement.append(fragment);\n}\n\nexport function openPersonalScheduleManager(): void {\n  pushPageHistory('PersonalScheduleManager');\n  PersonalScheduleManagerField.setAttribute('displayed', 'true');\n  initializePersonalScheduleManagerField();\n}\n\nexport function closePersonalScheduleManager(): void {\n  revokePageHistory('PersonalScheduleManager');\n  PersonalScheduleManagerField.setAttribute('displayed', 'false');\n}\n","import { NotificationProvider, NotificationResponse } from '../../index';\n\nexport function getNotificationAPIURL(method: NotificationResponse['method']): string | false {\n  if (NotificationProvider === '') {\n    return false;\n  }\n  const url = new URL(NotificationProvider);\n  if (['cancel', 'register', 'schedule', 'rotate', 'reschedule'].indexOf(method) > -1) {\n    url.searchParams.set('method', method);\n    return url.toString();\n  } else {\n    return false;\n  }\n}\n","import { sha512 } from '../../../../tools/index';\nimport { NotificationClient } from '../../index';\n\nexport function getNotificationToken(client_id: NotificationClient['client_id'], secret: NotificationClient['secret'], payload: object): string {\n  const now = new Date().getTime();\n  const window = 5 * 1000;\n  const i = (now - (now % window)) / window;\n  const result = sha512(sha512(`${client_id}\\n${secret}\\n${i}\\n${sha512(`${client_id}\\n${secret}\\n${sha512(JSON.stringify(payload))}`)}`));\n  return result;\n}\n","import { sha512 } from '../../../../tools/index';\nimport { NotificationClientID, NotificationResponse, NotificationSecret } from '../../index';\nimport { getNotificationToken } from '../getNotificationToken/index';\n\nexport function getNotificationRequestBody(method: NotificationResponse['method'], parameters: Array<any>): object | false {\n  switch (method) {\n    case 'cancel':\n      if (NotificationClientID === '' || NotificationSecret === '' || parameters.length !== 1) {\n        return false;\n      } else {\n        return {\n          client_id: NotificationClientID,\n          token: getNotificationToken(NotificationClientID, NotificationSecret, { schedule_id: parameters[0] }),\n          schedule_id: parameters[0]\n        };\n      }\n      break;\n    case 'register':\n      if (parameters.length !== 1) {\n        return false;\n      } else {\n        const currentDate = new Date();\n        currentDate.setMilliseconds(0);\n        currentDate.setSeconds(0);\n        return {\n          hash: sha512(`${sha512(parameters[0])}${currentDate.getTime()}`)\n        };\n      }\n      break;\n    case 'schedule':\n      if (NotificationClientID === '' || NotificationSecret === '' || parameters.length !== 9) {\n        return false;\n      } else {\n        return {\n          client_id: NotificationClientID,\n          token: getNotificationToken(NotificationClientID, NotificationSecret, { stop_id: parameters[0], location_name: parameters[1], route_id: parameters[2], route_name: parameters[3], direction: parameters[4], estimate_time: parameters[5], time_formatting_mode: parameters[6], time_offset: parameters[7], scheduled_time: parameters[8] }),\n          stop_id: parameters[0],\n          location_name: parameters[1],\n          route_id: parameters[2],\n          route_name: parameters[3],\n          direction: parameters[4],\n          estimate_time: parameters[5],\n          time_formatting_mode: parameters[6],\n          time_offset: parameters[7],\n          scheduled_time: parameters[8]\n        };\n      }\n      break;\n    case 'rotate':\n      if (NotificationClientID === '' || NotificationSecret === '' || parameters.length !== 0) {\n        return false;\n      } else {\n        return {\n          client_id: NotificationClientID,\n          token: getNotificationToken(NotificationClientID, NotificationSecret, {})\n        };\n      }\n      break;\n    case 'reschedule':\n      if (NotificationClientID === '' || NotificationSecret === '' || parameters.length !== 3) {\n        return false;\n      } else {\n        return {\n          client_id: NotificationClientID,\n          token: getNotificationToken(NotificationClientID, NotificationSecret, { schedule_id: parameters[0], estimate_time: parameters[1], scheduled_time: parameters[2] }),\n          schedule_id: parameters[0],\n          estimate_time: parameters[1],\n          scheduled_time: parameters[2]\n        };\n      }\n      break;\n    default:\n      return false;\n      break;\n  }\n}\n","type NotificationResponseCode = 200 | 400 | 401 | 404 | 500;\n\ninterface NotificationResponseCancel {\n  result: string;\n  code: NotificationResponseCode;\n  method: 'cancel';\n}\n\ninterface NotificationResponseRegister {\n  result: string;\n  code: NotificationResponseCode;\n  method: 'register';\n  client_id: string | 'null';\n  secret: string | 'null';\n}\n\ninterface NotificationResponseSchedule {\n  result: string;\n  code: NotificationResponseCode;\n  method: 'schedule';\n  schedule_id: string | 'null';\n}\n\ninterface NotificationResponseRotate {\n  result: string;\n  code: NotificationResponseCode;\n  method: 'rotate';\n  secret: string | 'null';\n}\n\ninterface NotificationResponseReschedule {\n  result: string;\n  code: NotificationResponseCode;\n  method: 'reschedule';\n}\n\nexport type NotificationResponse = NotificationResponseCancel | NotificationResponseRegister | NotificationResponseSchedule | NotificationResponseRotate | NotificationResponseReschedule;\n\nexport async function makeNotificationRequest(method: NotificationResponse['method'], url: string | false, body: object | false): Promise<NotificationResponse | false> {\n  try {\n    if (url === false || body === false) {\n      return false;\n    }\n\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body),\n      credentials: 'omit'\n    };\n\n    // Send the request\n    const response = await fetch(url, requestOptions);\n\n    if (!response.ok) {\n      // Log additional details for debugging\n      const errorText = await response.text();\n      console.error('API request failed', {\n        status: response.status,\n        statusText: response.statusText,\n        body: errorText\n      });\n      return false;\n    }\n\n    // Attempt to parse the JSON response\n    try {\n      const text = await response.text();\n      const json = JSON.parse(text);\n      switch (method) {\n        case 'cancel':\n          return json as NotificationResponseCancel;\n          break;\n        case 'register':\n          return json as NotificationResponseRegister;\n          break;\n        case 'schedule':\n          return json as NotificationResponseSchedule;\n          break;\n        case 'rotate':\n          return json as NotificationResponseRotate;\n          break;\n        case 'reschedule':\n          return json as NotificationResponseReschedule;\n          break;\n        default:\n          return false;\n          break;\n      }\n    } catch (jsonError) {\n      console.error('Failed to parse JSON response', jsonError);\n      throw new Error('Invalid JSON response from server');\n    }\n  } catch (error) {\n    // Catch and log errors\n    console.error('Error making request:', error);\n    return false;\n  }\n}\n","import { NotificationClientID, NotificationSecret, saveNotificationClient, setNotificationSecret } from '../../index';\nimport { getNotificationAPIURL } from '../getNotificationAPIURL/index';\nimport { getNotificationRequestBody } from '../getNotificationRequestBody/index';\nimport { makeNotificationRequest } from '../loader';\n\nexport async function rotateNotificationSecret(): Promise<boolean> {\n  if (NotificationClientID === '' || NotificationSecret === '') {\n    return false;\n  }\n  const url = getNotificationAPIURL('rotate');\n  const requestBody = getNotificationRequestBody('rotate', []);\n  const response = await makeNotificationRequest('rotate', url, requestBody);\n  if (response === false) {\n    return false;\n  } else {\n    if (response.code === 200 && response.method === 'rotate') {\n      setNotificationSecret(response.secret);\n      await saveNotificationClient();\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n","import { NotificationClientID, NotificationSchedule, NotificationSecret, saveNotificationSchedule } from '../../index';\nimport { getNotificationAPIURL } from '../getNotificationAPIURL/index';\nimport { getNotificationRequestBody } from '../getNotificationRequestBody/index';\nimport { makeNotificationRequest } from '../loader';\nimport { rotateNotificationSecret } from '../rotateNotificationSecret/index';\n\nexport async function scheduleNotification(stop_id: NotificationSchedule['stop_id'], location_name: NotificationSchedule['location_name'], route_id: NotificationSchedule['route_id'], route_name: NotificationSchedule['route_name'], direction: NotificationSchedule['direction'], estimate_time: NotificationSchedule['estimate_time'], time_formatting_mode: NotificationSchedule['time_formatting_mode'], time_offset: NotificationSchedule['time_offset'], scheduled_time: string | number | Date): Promise<string | false> {\n  if (NotificationClientID === '' || NotificationSecret === '' || stop_id === undefined || location_name === undefined || route_id === undefined || route_name === undefined || direction === undefined || estimate_time === undefined || typeof time_formatting_mode !== 'number' || scheduled_time === undefined) {\n    return false;\n  }\n  let processed_schedule_time = new Date();\n  switch (typeof scheduled_time) {\n    case 'string':\n      processed_schedule_time = new Date(scheduled_time);\n      break;\n    case 'number':\n      processed_schedule_time = new Date(scheduled_time);\n      break;\n    default:\n      if (scheduled_time instanceof Date) {\n        processed_schedule_time = scheduled_time;\n      } else {\n        return false;\n      }\n      break;\n  }\n  const url = getNotificationAPIURL('schedule');\n  const requestBody = getNotificationRequestBody('schedule', [stop_id, location_name, route_id, route_name, direction, estimate_time, time_formatting_mode, time_offset, processed_schedule_time.toISOString()]);\n  const response = await makeNotificationRequest('schedule', url, requestBody);\n  if (response === false) {\n    return false;\n  } else {\n    if (response.code === 200 && response.method === 'schedule') {\n      if (Math.random() > 0.8) {\n        await rotateNotificationSecret();\n      }\n      await saveNotificationSchedule(response.schedule_id, stop_id, location_name, route_id, route_name, direction, estimate_time, time_formatting_mode, time_offset, processed_schedule_time.getTime());\n      return response.schedule_id;\n    } else {\n      return false;\n    }\n  }\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { generateIdentifier, isValidURL } from '../../tools/index';\nimport { getLocation, SimplifiedLocation, SimplifiedLocationItem } from '../apis/getLocation/index';\nimport { getRoute, SimplifiedRoute, SimplifiedRouteItem } from '../apis/getRoute/index';\nimport { getStop, SimplifiedStop, SimplifiedStopItem } from '../apis/getStop/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime, getDataUpdateTime } from '../apis/loader';\nimport { getSettingOptionValue } from '../settings/index';\nimport { lfGetItem, lfListItemKeys, lfRemoveItem, lfSetItem } from '../storage/index';\nimport { scheduleNotification } from './apis/scheduleNotification/index';\n\nexport interface NotificationClient {\n  provider: string;\n  client_id: string;\n  secret: string;\n}\n\nexport interface NotificationSchedule {\n  schedule_id: string;\n  stop_id: number;\n  location_name: string;\n  route_id: number;\n  route_name: string;\n  direction: string;\n  estimate_time: number;\n  time_formatting_mode: number;\n  time_offset: number;\n  scheduled_time: number;\n}\n\nexport let NotificationProvider: NotificationClient['provider'] = ''; // base url\nexport let NotificationClientID: NotificationClient['client_id'] = '';\nexport let NotificationSecret: NotificationClient['secret'] = '';\n\nconst NotifcationSchedules: Array<NotificationSchedule> = [];\nconst NotifcationSchedulesIndex: {\n  [schedule_id: NotificationSchedule['schedule_id']]: number;\n} = {};\nconst NotifcationSchedulesStopIDIndex: {\n  [stop_key: string]: Array<number>;\n} = {};\n\nexport async function saveNotificationClient() {\n  const currentClient: NotificationClient = {\n    provider: NotificationProvider,\n    client_id: NotificationClientID,\n    secret: NotificationSecret\n  };\n  await lfSetItem(9, 'n_client', JSON.stringify(currentClient));\n}\n\nexport async function loadNotificationClient() {\n  const existingClient = await lfGetItem(9, 'n_client');\n  if (existingClient) {\n    const existingClientObject = JSON.parse(existingClient) as NotificationClient;\n    NotificationProvider = existingClientObject.provider;\n    NotificationClientID = existingClientObject.client_id;\n    NotificationSecret = existingClientObject.secret;\n  }\n}\n\nexport function getNotificationClientStatus(): boolean {\n  if (NotificationClientID === '' || NotificationSecret === '') {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nexport function setNotificationProvider(provider: NotificationClient['provider']): void {\n  if (isValidURL(provider)) {\n    const url = new URL(provider);\n    NotificationProvider = `${url.protocol}//${url.hostname}`;\n  } else {\n    throw new Error('The provider is not valid.');\n  }\n}\n\nexport function getNotificationProvider(): NotificationClient['provider'] {\n  return String(NotificationProvider);\n}\n\nexport function setNotificationClientID(client_id: NotificationClient['client_id']): void {\n  if (client_id !== undefined) {\n    NotificationClientID = String(client_id);\n  }\n}\n\nexport function setNotificationSecret(secret: NotificationClient['secret']): void {\n  if (secret !== undefined) {\n    NotificationSecret = String(secret);\n  }\n}\n\nexport async function initializeNotificationSchedules() {\n  const now = new Date().getTime();\n  const keys = await lfListItemKeys(10);\n  let index: number = 0;\n  for (const key of keys) {\n    const thisScheduleJSON = await lfGetItem(10, key);\n    const thisSchedule = JSON.parse(thisScheduleJSON) as NotificationSchedule;\n    // const thisScheduledTime = thisSchedule.scheduled_time;\n    // if (thisScheduledTime > now) {\n    const thisScheduleID = thisSchedule.schedule_id;\n    const thisScheduleStopID = thisSchedule.stop_id;\n    const thisScheduleStopKey = `s_${thisScheduleStopID}`;\n    NotifcationSchedules.push(thisSchedule);\n    NotifcationSchedulesIndex[thisScheduleID] = index;\n    if (!NotifcationSchedulesStopIDIndex.hasOwnProperty(thisScheduleStopKey)) {\n      NotifcationSchedulesStopIDIndex[thisScheduleStopKey] = [];\n    }\n    NotifcationSchedulesStopIDIndex[thisScheduleStopKey].push(index);\n    index += 1;\n    // }\n  }\n}\n\nexport async function saveNotificationSchedule(schedule_id: NotificationSchedule['schedule_id'], stop_id: NotificationSchedule['stop_id'], location_name: NotificationSchedule['location_name'], route_id: NotificationSchedule['route_id'], route_name: NotificationSchedule['route_name'], direction: NotificationSchedule['direction'], estimate_time: NotificationSchedule['estimate_time'], time_formatting_mode: NotificationSchedule['time_formatting_mode'], time_offset: NotificationSchedule['time_offset'], scheduled_time: NotificationSchedule['scheduled_time']) {\n  const thisNotificationSchedule: NotificationSchedule = {\n    schedule_id: schedule_id,\n    stop_id: stop_id,\n    location_name: location_name,\n    route_id: route_id,\n    route_name: route_name,\n    direction: direction,\n    estimate_time: estimate_time,\n    time_formatting_mode: time_formatting_mode,\n    time_offset: time_offset,\n    scheduled_time: scheduled_time\n  };\n  const thisNotificationScheduleStopKey = `s_${stop_id}`;\n  const thisNotificationScheduleIndex = NotifcationSchedules.length; // length - 1 + 1\n  NotifcationSchedules.push(thisNotificationSchedule);\n  NotifcationSchedulesIndex[schedule_id] = thisNotificationScheduleIndex;\n  if (!NotifcationSchedulesStopIDIndex.hasOwnProperty(thisNotificationScheduleStopKey)) {\n    NotifcationSchedulesStopIDIndex[thisNotificationScheduleStopKey] = [];\n  }\n  NotifcationSchedulesStopIDIndex[thisNotificationScheduleStopKey].push(thisNotificationScheduleIndex);\n  await lfSetItem(10, schedule_id, JSON.stringify(thisNotificationSchedule));\n}\n\nexport function getNotificationSchedule(schedule_id: NotificationSchedule['schedule_id']): NotificationSchedule | false {\n  if (NotifcationSchedulesIndex.hasOwnProperty(schedule_id)) {\n    const thisScheduleIndex = NotifcationSchedulesIndex[schedule_id];\n    const thisSchedule = NotifcationSchedules[thisScheduleIndex];\n    const thisScheduledTime = thisSchedule.scheduled_time;\n    const now = new Date().getTime();\n    if (thisScheduledTime > now) {\n      return thisSchedule;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nexport async function updateNotificationSchedule(schedule_id: NotificationSchedule['schedule_id'], estimate_time: NotificationSchedule['estimate_time'], scheduled_time: NotificationSchedule['scheduled_time']) {\n  if (NotifcationSchedulesIndex.hasOwnProperty(schedule_id)) {\n    const existingScheduleIndex = NotifcationSchedulesIndex[schedule_id];\n    const existingSchedule = NotifcationSchedules[existingScheduleIndex];\n    const updatedSchedule: NotificationSchedule = Object.assign(existingSchedule, {\n      estimate_time: estimate_time,\n      scheduled_time: scheduled_time\n    });\n    NotifcationSchedules.splice(existingScheduleIndex, 1, updatedSchedule);\n    await lfSetItem(10, schedule_id, JSON.stringify(updatedSchedule));\n  }\n}\n\nexport async function removeNotificationSchedule(schedule_id: NotificationSchedule['schedule_id']) {\n  if (NotifcationSchedulesIndex.hasOwnProperty(schedule_id)) {\n    const existingScheduleIndex = NotifcationSchedulesIndex[schedule_id];\n    const existingSchedule = NotifcationSchedules[existingScheduleIndex];\n    const thisScheduleStopID = existingSchedule.stop_id;\n    const thisScheduleStopKey = `s_${thisScheduleStopID}`;\n    NotifcationSchedules.splice(existingScheduleIndex, 1, null);\n    NotifcationSchedulesStopIDIndex[thisScheduleStopKey].splice(NotifcationSchedulesStopIDIndex[thisScheduleStopKey].indexOf(existingScheduleIndex), 1);\n    delete NotifcationSchedulesIndex[schedule_id];\n    await lfRemoveItem(10, schedule_id);\n  }\n}\n\nexport function listNotifcationSchedules(): Array<NotificationSchedule> {\n  const now = new Date().getTime();\n  const result: Array<NotificationSchedule> = [];\n  for (const thisSchedule of NotifcationSchedules) {\n    if (thisSchedule !== null) {\n      const thisScheduledTime = thisSchedule.scheduled_time;\n      if (thisScheduledTime > now) {\n        result.push(thisSchedule);\n      }\n    }\n  }\n  return result;\n}\n\nexport function listNotifcationSchedulesOfStop(StopID: NotificationSchedule['stop_id']): Array<NotificationSchedule> {\n  const result: Array<NotificationSchedule> = [];\n  const now = new Date().getTime();\n  const thisStopKey = `s_${StopID}`;\n  if (NotifcationSchedulesStopIDIndex.hasOwnProperty(thisStopKey)) {\n    const indexes = NotifcationSchedulesStopIDIndex[thisStopKey];\n    for (const index of indexes) {\n      const thisSchedule = NotifcationSchedules[index];\n      if (thisSchedule !== null) {\n        const thisScheduledTime = thisSchedule.scheduled_time;\n        if (thisScheduledTime > now) {\n          result.push(thisSchedule);\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport function stopHasNotifcationSchedules(StopID: NotificationSchedule['stop_id']): boolean {\n  const now = new Date().getTime();\n  const thisStopKey = `s_${StopID}`;\n  if (NotifcationSchedulesStopIDIndex.hasOwnProperty(thisStopKey)) {\n    const indexes = NotifcationSchedulesStopIDIndex[thisStopKey];\n    for (const index of indexes) {\n      const thisSchedule = NotifcationSchedules[index];\n      if (thisSchedule !== null) {\n        const thisScheduledTime = thisSchedule.scheduled_time;\n        if (thisScheduledTime > now) {\n          return true;\n        }\n      }\n    }\n  }\n  return false;\n}\n\nexport async function discardExpiredNotificationSchedules() {\n  const now = new Date().getTime();\n  for (const schedule_id in NotifcationSchedulesIndex) {\n    const existingScheduleIndex = NotifcationSchedulesIndex[schedule_id];\n    const existingSchedule = NotifcationSchedules[existingScheduleIndex];\n    const thisScheduledTime = existingSchedule.scheduled_time;\n    if (thisScheduledTime <= now) {\n      const thisScheduleStopID = existingSchedule.stop_id;\n      const thisScheduleStopKey = `s_${thisScheduleStopID}`;\n      NotifcationSchedules.splice(existingScheduleIndex, 1, null);\n      NotifcationSchedulesStopIDIndex[thisScheduleStopKey].splice(NotifcationSchedulesStopIDIndex[thisScheduleStopKey].indexOf(existingScheduleIndex), 1);\n      delete NotifcationSchedulesIndex[schedule_id];\n      await lfRemoveItem(10, schedule_id);\n    }\n  }\n}\n\nexport interface IntegratedNotificationScheduleItem {\n  name: NotificationSchedule['location_name'];\n  stop_id: NotificationSchedule['stop_id'];\n  estimate_time: NotificationSchedule['estimate_time'];\n  schedule_id: NotificationSchedule['schedule_id'];\n  scheduled_time: NotificationSchedule['scheduled_time'];\n  route: {\n    name: NotificationSchedule['route_name'];\n    direction: NotificationSchedule['direction'];\n    id: NotificationSchedule['route_id'];\n    pathAttributeId: SimplifiedRouteItem['pid'];\n  };\n  is_first: boolean;\n  date: string;\n  hours: string;\n  minutes: string;\n}\n\nexport interface IntegratedNotificationSchedules {\n  items: Array<IntegratedNotificationScheduleItem>;\n  itemQuantity: number;\n  dataUpdateTime: number;\n}\n\nexport async function integrateNotifcationSchedules(requestID: string): Promise<IntegratedNotificationSchedules> {\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  const notificationSchedules = listNotifcationSchedules();\n  const now = new Date().getTime();\n\n  const items: Array<IntegratedNotificationScheduleItem> = [];\n\n  for (const item of notificationSchedules) {\n    const integratedItem = {} as IntegratedNotificationScheduleItem;\n    const thisItemName = item.location_name;\n    integratedItem.name = thisItemName;\n\n    const thisItemStopID = item.stop_id;\n    integratedItem.stop_id = thisItemStopID;\n\n    const thisItemEstimateTime = item.estimate_time;\n    integratedItem.estimate_time = thisItemEstimateTime;\n\n    const thisItemScheduleID = item.schedule_id;\n    integratedItem.schedule_id = thisItemScheduleID;\n\n    const thisItemScheduledTime = item.scheduled_time;\n    integratedItem.scheduled_time = thisItemScheduledTime;\n\n    const thisItemScheduledTimeDateInstance = new Date(thisItemScheduledTime);\n    const thisItemDate = thisItemScheduledTimeDateInstance.getDate();\n    const thisItemHours = thisItemScheduledTimeDateInstance.getHours();\n    const thisItemMinutes = thisItemScheduledTimeDateInstance.getMinutes();\n    integratedItem.date = String(thisItemDate).padStart(2, '0');\n    integratedItem.hours = String(thisItemHours).padStart(2, '0');\n    integratedItem.minutes = String(thisItemMinutes).padStart(2, '0');\n\n    integratedItem.route = {};\n    const thisRouteName = item.route_name;\n    integratedItem.route.name = thisRouteName;\n\n    const thisRouteID = item.route_id;\n    integratedItem.route.id = thisRouteID;\n\n    const thisRouteDirection = item.direction;\n    integratedItem.route.direction = thisRouteDirection;\n\n    // Collect data from Route\n    const thisNotificationScheduleRouteID = item.route_id;\n    const thisNotificationScheduleRouteKey = `r_${thisNotificationScheduleRouteID}`;\n    let thisNotificationScheduleRoute = {} as SimplifiedRouteItem;\n    if (Route.hasOwnProperty(thisNotificationScheduleRouteKey)) {\n      thisNotificationScheduleRoute = Route[thisNotificationScheduleRouteKey];\n    } else {\n      continue;\n    }\n    const thisNotificationScheduleRoutePathAttributeId = thisNotificationScheduleRoute.pid;\n    integratedItem.route.pathAttributeId = thisNotificationScheduleRoutePathAttributeId;\n\n    items.push(integratedItem);\n  }\n\n  items.sort(function (a, b) {\n    return a.scheduled_time - b.scheduled_time;\n  });\n\n  const items2: Array<IntegratedNotificationScheduleItem> = [];\n  let itemQuantity: IntegratedNotificationSchedules['itemQuantity'] = 0;\n  const groups: { [key: string]: true } = {};\n  for (const item of items) {\n    const groupKey = `g_${item.date}_${item.hours}`;\n    if (!groups.hasOwnProperty(groupKey)) {\n      groups[groupKey] = true;\n      item.is_first = true;\n    } else {\n      item.is_first = false;\n    }\n    items2.push(item);\n    itemQuantity += 1;\n  }\n\n  const result: IntegratedNotificationSchedules = {\n    items: items2,\n    itemQuantity: itemQuantity,\n    dataUpdateTime: Math.max(getDataUpdateTime(requestID), now)\n  };\n  deleteDataUpdateTime(requestID);\n  deleteDataReceivingProgress(requestID);\n  return result;\n}\n\nexport interface ScheduleNotificationOption {\n  name: string;\n  time_offset: number;\n  icon: MaterialSymbols;\n  index: number;\n}\n\nexport type ScheduleNotificationOptions = Array<ScheduleNotificationOption>;\n\nexport const scheduleNotificationOptions: ScheduleNotificationOptions = [\n  {\n    name: '5',\n    time_offset: -5,\n    icon: 'clock_loader_10',\n    index: 0\n  },\n  {\n    name: '10',\n    time_offset: -10,\n    icon: 'clock_loader_20',\n    index: 1\n  },\n  {\n    name: '15',\n    time_offset: -15,\n    icon: 'clock_loader_40',\n    index: 2\n  },\n  {\n    name: '20',\n    time_offset: -20,\n    icon: 'clock_loader_60',\n    index: 3\n  },\n  {\n    name: '25',\n    time_offset: -25,\n    icon: 'clock_loader_80',\n    index: 4\n  },\n  {\n    name: '30',\n    time_offset: -30,\n    icon: 'clock_loader_90',\n    index: 5\n  }\n];\n\nexport async function scheduleNotificationForStop(StopID: number, RouteID: number, EstimateTime: number, index: number): Promise<0 | 1 | 2> {\n  if (getNotificationClientStatus()) {\n    const time_formatting_mode = getSettingOptionValue('time_formatting_mode') as number;\n    const requestID = generateIdentifier();\n    const Stop = (await getStop(requestID)) as SimplifiedStop;\n    const Location = (await getLocation(requestID, 0)) as SimplifiedLocation;\n    const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n\n    deleteDataReceivingProgress(requestID);\n    deleteDataUpdateTime(requestID);\n\n    // Collect data from Stop\n    const StopKey = `s_${StopID}`;\n    let thisStop = {} as SimplifiedStopItem;\n    if (Stop.hasOwnProperty(StopKey)) {\n      thisStop = Stop[StopKey];\n    } else {\n      return 0;\n    }\n    const thisStopLocationId = thisStop.stopLocationId;\n    const thisStopGoBack = thisStop.goBack;\n\n    // Collect data from Location\n    const thisLocationKey = `l_${thisStopLocationId}`;\n    let thisLocation = {} as SimplifiedLocationItem;\n    if (Location.hasOwnProperty(thisLocationKey)) {\n      thisLocation = Location[thisLocationKey];\n    } else {\n      return 0;\n    }\n    const thisLocationName = thisLocation.n;\n\n    // Collect data from Route\n    const RouteKey = `r_${RouteID}`;\n    let thisRoute = {} as SimplifiedRouteItem;\n    if (Route.hasOwnProperty(RouteKey)) {\n      thisRoute = Route[RouteKey];\n    } else {\n      return 0;\n    }\n\n    const thisRouteName = thisRoute.n;\n    const thisRouteDeparture = thisRoute.dep;\n    const thisRouteDestination = thisRoute.des;\n    const thisRouteDirection = [thisRouteDestination, thisRouteDeparture, ''][thisStopGoBack ? parseInt(thisStopGoBack) : 0];\n\n    // Collect data from scheduleNotificationOptions\n    const thisOption = scheduleNotificationOptions[index];\n    const timeOffset = thisOption.time_offset;\n\n    const now = new Date().getTime();\n    const scheduled_time = now + EstimateTime * 1000 + timeOffset * 60 * 1000;\n\n    const scheduling = await scheduleNotification(StopID, thisLocationName, RouteID, thisRouteName, thisRouteDirection, EstimateTime, time_formatting_mode, timeOffset, scheduled_time);\n    if (scheduling === false) {\n      return 0; // error\n    } else {\n      return 1; // successful\n    }\n  } else {\n    return 2; // no registration\n  }\n}\n","import { saveNotificationClient, setNotificationClientID, setNotificationSecret } from '../..';\nimport { getNotificationAPIURL } from '../getNotificationAPIURL/index';\nimport { getNotificationRequestBody } from '../getNotificationRequestBody/index';\nimport { makeNotificationRequest } from '../loader';\n\nexport async function registerNotificationClient(registrationKey: string): Promise<boolean> {\n  if (!registrationKey) {\n    return false;\n  }\n  const url = getNotificationAPIURL('register');\n  const requestBody = getNotificationRequestBody('register', [registrationKey]);\n  const response = await makeNotificationRequest('register', url, requestBody);\n  if (response === false) {\n    return false;\n  } else {\n    if (response.code === 200 && response.method === 'register') {\n      setNotificationClientID(response.client_id)\n      setNotificationSecret(response.secret)\n      await saveNotificationClient();\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n","import { registerNotificationClient } from '../../data/notification/apis/registerNotificationClient/index';\nimport { getNotificationProvider, setNotificationProvider } from '../../data/notification/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { isValidURL } from '../../tools/index';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst RegisterNotificationField = documentQuerySelector('.css_register_notification_field');\nconst RegisterNotificationBodyElement = elementQuerySelector(RegisterNotificationField, '.css_register_notification_body');\nconst RegisterNotificationGroupsElement = elementQuerySelector(RegisterNotificationBodyElement, '.css_register_notification_groups');\n\nconst ProviderInputElement = elementQuerySelector(RegisterNotificationGroupsElement, '.css_register_notification_group[group=\"provider\"] .css_register_notification_group_body input');\nconst RgistrationKeyInputElement = elementQuerySelector(RegisterNotificationGroupsElement, '.css_register_notification_group[group=\"registration-key\"] .css_register_notification_group_body input');\n\nfunction initializeRegisterNotificationField() {\n  ProviderInputElement.value = getNotificationProvider();\n  RgistrationKeyInputElement.value = '';\n}\n\nexport function openRegisterNotification(): void {\n  pushPageHistory('RegisterNotification');\n  RegisterNotificationField.setAttribute('displayed', 'true');\n  initializeRegisterNotificationField();\n  closePreviousPage();\n}\n\nexport function closeRegisterNotification(): void {\n  // revokePageHistory('RegisterNotification');\n  RegisterNotificationField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport async function saveFormulatedRegisterNotification() {\n  promptMessage('manufacturing', '');\n  const provider = ProviderInputElement.value;\n  const registrationKey = RgistrationKeyInputElement.value;\n  if (!isValidURL(provider)) {\n    promptMessage('error', '');\n    return;\n  }\n  // register\n  setNotificationProvider(provider);\n  const registering = await registerNotificationClient(registrationKey);\n  if (registering) {\n    promptMessage('check_circle', '');\n    return;\n  } else {\n    promptMessage('error', '');\n    return;\n  }\n}\n","export function getTextWidth(text: string, weight: number, size: string, fontFamily: string): number {\n  const canvas: HTMLCanvasElement = getTextWidth.canvas || (getTextWidth.canvas = document.createElement('canvas'));\n  const context = canvas.getContext('2d');\n  const font: string = `${weight} ${size} ${fontFamily}`;\n  context.font = font;\n  return context.measureText(text).width;\n}\n\nexport function getTextHeight(text: string, weight: number, size: string, fontFamily: string): number {\n  const canvas: HTMLCanvasElement = getTextHeight.canvas || (getTextHeight.canvas = document.createElement('canvas'));\n  const context = canvas.getContext('2d');\n  const font: string = `${weight} ${size} ${fontFamily}`;\n  context.font = font;\n  context.textBaseline = 'top';\n  return context.measureText(text).actualBoundingBoxDescent;\n}\n\ninterface CornerRadius {\n  tl: number;\n  tr: number;\n  br: number;\n  bl: number;\n}\n\nexport function drawRoundedRect(ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, radius: number | CornerRadius, fill: string): void {\n  // If radius is a single value, treat it as the same for all corners\n  if (typeof radius === 'number') {\n    radius = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    // Set defaults if individual radii are not provided\n    radius = {\n      tl: radius.tl || 0,\n      tr: radius.tr || 0,\n      br: radius.br || 0,\n      bl: radius.bl || 0\n    };\n  }\n\n  // Start path\n  ctx.beginPath();\n  // Move to the top-left corner, accounting for the top-left radius\n  ctx.moveTo(x + radius.tl, y);\n  // Draw the top line, rounding the top-right corner\n  ctx.lineTo(x + width - radius.tr, y);\n  ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\n  // Draw the right side, rounding the bottom-right corner\n  ctx.lineTo(x + width, y + height - radius.br);\n  ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);\n  // Draw the bottom side, rounding the bottom-left corner\n  ctx.lineTo(x + radius.bl, y + height);\n  ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\n  // Draw the left side, rounding the top-left corner\n  ctx.lineTo(x, y + radius.tl);\n  ctx.quadraticCurveTo(x, y, x + radius.tl, y);\n  // Complete the path\n  ctx.closePath();\n\n  ctx.fillStyle = fill;\n  ctx.fill(); // To fill the shape\n}\n\nexport function generateRoundedRectPath(x: number, y: number, width: number, height: number, radius: number | CornerRadius, inverted: boolean): Array<string> {\n  // Normalize the radius object\n  if (typeof radius === 'number') {\n    radius = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    radius = {\n      tl: radius.tl || 0,\n      tr: radius.tr || 0,\n      br: radius.br || 0,\n      bl: radius.bl || 0\n    };\n  }\n  const { tl, tr, br, bl } = radius;\n  const command = [];\n  if (inverted) {\n    if (tl !== 0) {\n      command.push(`M${x} ${y + tl}`, `Q${x} ${y} ${x + tl} ${y}`, `H${x}`, `V${y + tl}`);\n    }\n    if (tr !== 0) {\n      command.push(`M${x + width - tr} ${y}`, `Q${x + width} ${y} ${x + width} ${y + tr}`, `V${y}`, `H${x + width - tr}`);\n    }\n    if (br !== 0) {\n      command.push(`M${x + width} ${y + height - br}`, `Q${x + width} ${y + height} ${x + width - br} ${y + height}`, `H${x + width}`, `V${y + height - br}`);\n    }\n    if (bl !== 0) {\n      command.push(`M${x + bl} ${y + height}`, `Q${x} ${y + height} ${x} ${y + height - bl}`, `V${y + height}`, `H${x + bl}`);\n    }\n  } else {\n    command.push(`M${x + tl} ${y}`, `H${x + width - tr}`, `Q${x + width} ${y} ${x + width} ${y + tr}`, `V${y + height - br}`, `Q${x + width} ${y + height} ${x + width - br} ${y + height}`, `H${x + bl}`, `Q${x} ${y + height} ${x} ${y + height - bl}`, `V${y + tl}`, `Q${x} ${y} ${x + tl} ${y}`);\n  }\n  return command;\n}\n","export type ColorScheme = 'light' | 'dark';\n\nexport function getColorScheme(): ColorScheme {\n  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n  if (mediaQuery.matches) {\n    return 'dark';\n  } else {\n    return 'light';\n  }\n}\n\nconst CssVariableValueCache = {\n  light: {},\n  dark: {}\n};\n\nexport function getCSSVariableValue(property: string): string {\n  const CurrentColorScheme = getColorScheme();\n  if (CssVariableValueCache[CurrentColorScheme].hasOwnProperty(property)) {\n    return CssVariableValueCache[CurrentColorScheme][property];\n  }\n  const value = getComputedStyle(document.documentElement).getPropertyValue(property);\n  CssVariableValueCache[CurrentColorScheme][property] = value;\n  return value;\n}\n","import { CardinalDirection } from './cardinal-direction';\nimport { convertNumberToLetters } from './convert';\n\nexport function generateLetterLabels(quantity: number): Array<string> {\n  let result: Array<string> = [];\n  for (let i = 0; i < quantity; i++) {\n    result.push(`${convertNumberToLetters(i + 1)}`);\n  }\n  return result;\n}\n\nexport function generateDirectionLabels(cardinalDirections: Array<CardinalDirection>): Array<string> {\n  const result: Array<string> = [];\n  for (const cardinalDirection of cardinalDirections) {\n    result.push(`${cardinalDirection.name}${cardinalDirection.symbol}`);\n  }\n  return result;\n}\n","import { areItemsDifferent } from './array';\nimport { generateLetterLabels } from './labels';\n\ninterface AddressPart {\n  suffixes?: string;\n  key: keyof ParsedAddress;\n  process: (e: Array<string> | null) => Array<string> | Array<number> | null;\n  type: number;\n}\n\nexport interface ParsedAddress {\n  city: Array<string>;\n  district: Array<string>;\n  area: Array<string>;\n  road: Array<string>;\n  road_section: Array<number>;\n  alley: Array<number>;\n  alley_branch: Array<number>;\n  doorplate: Array<number>;\n  floornumber: Array<string>;\n  exit: Array<string>;\n  direction: Array<string>;\n  [key: string]: Array<string> | Array<number> | null;\n}\n\ninterface FeatureCounts {\n  [key: string]: { count: number; chars: string; index: number };\n}\n\nexport function mergeAddressesIntoOne(addresses: Array<string>): ParsedAddress | string {\n  const parts: Array<AddressPart> = [\n    {\n      suffixes: '',\n      key: 'city',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.trim();\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'district',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.trim();\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'area',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.trim();\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'road',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.replaceAll(/[\\(\\)\\\\]/gim, '').trim();\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'road_section',\n      process: function (e) {\n        var toNumber = function (char) {\n          switch (char) {\n            case '':\n              return 1;\n              break;\n            case '':\n              return 2;\n              break;\n            case '':\n              return 3;\n              break;\n            case '':\n              return 4;\n              break;\n            case '':\n              return 5;\n              break;\n            case '':\n              return 6;\n              break;\n            case '':\n              return 7;\n              break;\n            case '':\n              return 8;\n              break;\n            case '':\n              return 9;\n              break;\n            case '':\n              return 10;\n              break;\n          }\n          if (!isNaN(parseInt(char))) {\n            return parseInt(char);\n          }\n          return 0;\n        };\n        var len = String(e).length;\n        var numbers = [];\n        for (let i = 0; i < len; i++) {\n          var p = toNumber(String(e).charAt(i));\n          if (p === 10) {\n            if (numbers.length > 0) {\n              numbers = [numbers.reduce((a, b) => a + b, 0) * 10];\n            }\n          } else {\n            numbers = [numbers.reduce((a, b) => a + b, 0) + p];\n          }\n        }\n        return numbers;\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'alley',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return parseInt(t.trim().replaceAll(/[]/gim));\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'alley_branch',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return parseInt(t.trim().replaceAll(/[]/gim));\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'doorplate',\n      process: function (e) {\n        var numbers = String(e).match(/[0-9]+/gim);\n        numbers =\n          numbers?.map((n) => {\n            if (n === null) {\n              return null;\n            } else {\n              return parseInt(n);\n            }\n          }) || null;\n        return numbers;\n      },\n      type: 0\n    },\n    {\n      suffixes: '',\n      key: 'floornumber',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.trim();\n          });\n        }\n      },\n      type: 0\n    },\n    {\n      key: 'exit',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.trim();\n          });\n        }\n      },\n      type: 2\n    },\n    {\n      key: 'direction',\n      process: function (e) {\n        if (e === null) {\n          return null;\n        } else {\n          return e.map((t) => {\n            return t.trim().replace(/[]/gim, '');\n          });\n        }\n      },\n      type: 1\n    }\n  ];\n\n  function parseAddress(address: string): object {\n    function regex(suffixes, type) {\n      if (type === 0) {\n        return new RegExp(`([^]+[${suffixes}])`, 'gmi');\n      }\n      if (type === 1) {\n        return new RegExp(`([]+[])`, 'gmi');\n      }\n      if (type === 2) {\n        return new RegExp(`([0-9]+[])`, 'gmi');\n      }\n    }\n    var result = {};\n    for (var part of parts) {\n      var r = regex(part?.suffixes, part.type);\n      result[part.key] = part.process(String(address).match(r));\n    }\n    return result;\n  }\n\n  function mergeAddresses(addresses: Array<string>): object {\n    var result = {};\n    for (var address of addresses) {\n      var parsedAddress = parseAddress(address);\n      for (var part of parts) {\n        if (!result.hasOwnProperty(part.key)) {\n          result[part.key] = [];\n        }\n        result[part.key] = result[part.key].concat(parsedAddress[part.key]);\n      }\n    }\n    for (var key in result) {\n      result[key] = Array.from(new Set(result[key]))\n        .filter((e) => (e ? true : false))\n        .sort(function (a, b) {\n          if (typeof a === 'number' && typeof b === 'number') {\n            return a - b;\n          } else {\n            return String(a).charCodeAt(0) - String(b).charCodeAt(0);\n          }\n        });\n    }\n    return result;\n  }\n  return mergeAddresses(addresses);\n}\n\nexport function addressToString(address: ParsedAddress): string {\n  return `${address.city.join('')}${address.district.join('')}${address.road.join('')}${\n    address.road_section.sort(function (a, b) {\n      return a - b;\n    }).length > 0\n      ? address.road_section.join('') + ''\n      : ''\n  }${\n    address.alley.length > 0\n      ? address.alley\n          .sort(function (a, b) {\n            return a - b;\n          })\n          .join('') + ''\n      : ''\n  }${\n    address.alley_branch.length > 0\n      ? address.alley_branch\n          .sort(function (a, b) {\n            return a - b;\n          })\n          .join('') + ''\n      : ''\n  }${\n    address.doorplate.length > 0\n      ? address.doorplate\n          .sort(function (a, b) {\n            return a - b;\n          })\n          .join('') + ''\n      : ''\n  }${address.floornumber.length > 0 ? address.floornumber.join('') + '' : ''}${address.direction.length > 0 ? '' + address.direction.join('') + '' : ''}`;\n}\n\nexport function extractCommonFeaturesFromAddresses(addresses: Array<string>): string {\n  // Create an object to store feature occurrences\n  const featureCounts: { [key: string]: { count: number; chars: string; index: number } } = {};\n\n  // Create a set to store unique simplified addresses\n  const simplifiedSet = new Set<string>();\n\n  // Iterate through each address\n  for (const address of addresses) {\n    // Extract common features by splitting the address\n    const features = String(address)\n      .split('')\n      .filter((feature) => feature.trim() !== '');\n\n    // Join the extracted features to create a simplified address\n    const simplifiedAddress = features.join('');\n\n    // Add the simplified address to the set\n    simplifiedSet.add(simplifiedAddress);\n\n    // Count occurrences of each feature\n    let index = 0;\n    for (const feature of features) {\n      // Check if the feature is a digit\n      if (!isNaN(parseInt(feature))) {\n        // Create a key for the digit feature\n        const digitKey = `digit_${index}_${feature.charCodeAt(0)}`;\n        featureCounts[digitKey] = {\n          count: (featureCounts[digitKey]?.count || 0) + 1,\n          chars: feature,\n          index: index\n        };\n      } else {\n        // Create a key for non-digit features\n        const featureKey = `chars_${index}_${feature.charCodeAt(0)}`;\n        featureCounts[featureKey] = {\n          count: (featureCounts[featureKey]?.count || 0) + 1,\n          chars: feature,\n          index: index\n        };\n      }\n      index += 1;\n    }\n  }\n\n  // Set threshold and limit for filtering features\n  const threshold = addresses.length * 0.6;\n  const limit = addresses.length * 1;\n\n  // Convert the feature counts object to an array of [feature, count] pairs\n  const sortedFeatures = Object.entries(featureCounts)\n    .filter((pair) => threshold <= pair[1].count && pair[1].count <= limit)\n    .sort((a, b) => a[1].index - b[1].index);\n\n  // Extract the features from the sorted array\n  const commonFeatures = sortedFeatures.map((pair) => pair[1].chars);\n\n  return commonFeatures.join('');\n}\n\nexport function generateLabelFromAddresses(addresses: Array<ParsedAddress>): Array<string> {\n  const result = [];\n  const filledProperties = {};\n  for (const address of addresses) {\n    for (const key in address) {\n      if (!filledProperties.hasOwnProperty(key)) {\n        filledProperties[key] = 0;\n      }\n      if (address[key].length > 0) {\n        filledProperties[key] = filledProperties[key] + 1;\n      }\n    }\n  }\n  let commonProperties = Object.entries(filledProperties)\n    .map((property) => {\n      return { key: property[0], value: property[1] };\n    })\n    .filter((e) => {\n      return e.value === addresses.length ? true : false;\n    })\n    .sort(function (a, b) {\n      return a.value - b.value;\n    });\n  if (commonProperties.length > 0) {\n    for (const commonProperty of commonProperties) {\n      let components = [];\n      let len = -Infinity;\n      for (const address of addresses) {\n        const component = address[commonProperty.key].join('');\n        components.push(component);\n        const componentLen = component.length;\n        if (componentLen > len) {\n          len = componentLen;\n        }\n      }\n      if (areItemsDifferent(components)) {\n        result.push({ components: components, len: len });\n      }\n    }\n  }\n\n  if (result.length > 0) {\n    result.sort(function (a, b) {\n      return a.len - b.len;\n    });\n    return result[0].components;\n  } else {\n    const addressesLength = addresses.length;\n    return generateLetterLabels(addressesLength);\n  }\n}\n","import { MaterialSymbols } from '../interface/icons/material-symbols-type';\nimport { normalizeVector } from './math';\n\nexport type CardinalDirectionVector = [number, number];\n\nexport interface CardinalDirection {\n  vector: CardinalDirectionVector;\n  id: number;\n  name: string;\n  symbol: string;\n  icon: MaterialSymbols;\n}\n\nexport const UnknownCardinalDirection: CardinalDirection = {\n  vector: [0, 0],\n  id: -1,\n  name: '',\n  symbol: '?',\n  icon: 'explore'\n};\n\n// cardinal directions\nexport const NorthCardinalDirection: CardinalDirection = {\n  vector: [0, 1], // 90 degress\n  id: 0,\n  name: '',\n  symbol: '',\n  icon: 'north'\n};\n\nexport const WestCardinalDirection: CardinalDirection = {\n  vector: [1, 0], // 0 degres\n  id: 1,\n  name: '',\n  symbol: '',\n  icon: 'east'\n};\n\nexport const SouthCardinalDirection: CardinalDirection = {\n  vector: [0, -1], // 270 degress\n  id: 2,\n  name: '',\n  symbol: '',\n  icon: 'south'\n};\n\nexport const EastCardinalDirection: CardinalDirection = {\n  vector: [-1, 0], // 180 degress\n  id: 3,\n  name: '',\n  symbol: '',\n  icon: 'west'\n};\n\n// intercardinal directions\nconst NorthEastCardinalDirection: CardinalDirection = {\n  vector: [Math.SQRT1_2, Math.SQRT1_2], // 45 degrees\n  id: 4,\n  name: '',\n  symbol: '',\n  icon: 'north_east'\n};\n\nconst SouthEastCardinalDirection: CardinalDirection = {\n  vector: [Math.SQRT1_2, -Math.SQRT1_2], // 135 degrees\n  id: 5,\n  name: '',\n  symbol: '',\n  icon: 'south_east'\n};\n\nexport const SouthWestCardinalDirection: CardinalDirection = {\n  vector: [-Math.SQRT1_2, -Math.SQRT1_2], // 225 degrees\n  id: 6,\n  name: '',\n  symbol: '',\n  icon: 'south_west'\n};\n\nexport const NorthWestCardinalDirection: CardinalDirection = {\n  vector: [-Math.SQRT1_2, Math.SQRT1_2], // 315 degrees\n  id: 7,\n  name: '',\n  symbol: '',\n  icon: 'north_west'\n};\n\nexport function getCardinalDirectionFromVector(vector: [number, number]): CardinalDirection {\n  const directions: Array<CardinalDirection> = [UnknownCardinalDirection, NorthCardinalDirection, EastCardinalDirection, SouthCardinalDirection, WestCardinalDirection, NorthEastCardinalDirection, SouthEastCardinalDirection, SouthWestCardinalDirection, NorthWestCardinalDirection];\n  const unitVector = normalizeVector(vector);\n  let maxDotProduct = -Infinity;\n  let bestMatch: CardinalDirection = directions[0];\n  for (const direction of directions) {\n    const dotProduct = direction.vector[0] * unitVector[0] + direction.vector[1] * unitVector[1];\n    if (dotProduct > maxDotProduct) {\n      maxDotProduct = dotProduct;\n      bestMatch = direction;\n    }\n  }\n  return bestMatch;\n}\n","import { CardinalDirection, getCardinalDirectionFromVector, UnknownCardinalDirection } from '../../tools/cardinal-direction';\nimport { getSettingOptionValue } from '../settings/index';\n\ninterface Orientation {\n  degree: number;\n  cardinalDirection: CardinalDirection;\n}\n\nconst userOrientation = {\n  current: -1,\n  permission: {\n    gained: false,\n    asked: false\n  },\n  id: 0\n};\n\nexport function askForCalibratingPermission(): void {\n  if (userOrientation.permission.asked === false && getSettingOptionValue('display_user_orientation') === true) {\n    userOrientation.permission.asked = true;\n    if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {\n      DeviceOrientationEvent.requestPermission()\n        .then((permissionState) => {\n          if (permissionState === 'granted') {\n            // Permission granted, start listening to the event\n            window.addEventListener(\n              'deviceorientation',\n              function (event: DeviceOrientationEvent) {\n                if (event.absolute) {\n                  userOrientation.current = event?.alpha || -1;\n                } else {\n                  if (event.webkitCompassHeading) {\n                    userOrientation.current = event.webkitCompassHeading || -1;\n                  } else {\n                    userOrientation.current = event?.alpha || -1;\n                  }\n                }\n              },\n              true\n            );\n          } else {\n            console.error('Permission not granted for DeviceOrientation');\n          }\n        })\n        .catch((err) => {\n          console.error('Error requesting DeviceOrientation permission:', err);\n        });\n    } else {\n      console.log(`DeviceOrientation isn't supported.`);\n    }\n  }\n}\n\nexport function getUserOrientation(): Orientation {\n  const alpha = userOrientation.current;\n  if (alpha === -1) {\n    return {\n      degree: -1,\n      cardinalDirection: UnknownCardinalDirection\n    };\n  } else {\n    let angle: number = alpha + 90;\n    if (angle > 360) {\n      angle -= 360;\n    }\n    angle *= Math.PI / 180;\n    const vector = [Math.cos(angle), Math.sin(angle)];\n    const cardinalDirection = getCardinalDirectionFromVector(vector);\n    return {\n      degree: alpha,\n      cardinalDirection: cardinalDirection\n    };\n  }\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { addressToString, generateLabelFromAddresses } from '../../tools/address';\nimport { CardinalDirection, getCardinalDirectionFromVector } from '../../tools/cardinal-direction';\nimport { generateDirectionLabels, generateLetterLabels } from '../../tools/labels';\nimport { normalizeVector } from '../../tools/math';\nimport { BusArrivalTime, getBusArrivalTimes } from '../analytics/bus-arrival-time/index';\nimport { getBusData } from '../apis/getBusData/index';\nimport { getBusEvent } from '../apis/getBusEvent/index';\nimport { EstimateTime, EstimateTimeItem, getEstimateTime } from '../apis/getEstimateTime/index';\nimport { getLocation, MergedLocation } from '../apis/getLocation/index';\nimport { getRoute, SimplifiedRoute } from '../apis/getRoute/index';\nimport { getStop } from '../apis/getStop/index';\nimport { batchFindBusesForLocation, EstimateTimeStatus, formatBus, FormattedBus, parseEstimateTime } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime, getDataUpdateTime, setDataReceivingProgress } from '../apis/loader';\nimport { getSettingOptionValue } from '../settings/index';\nimport { getUserOrientation } from '../user-orientation/index';\n\ninterface BatchFoundEstimateTimeItem extends EstimateTimeItem {}\n\ntype BatchFoundEstimateTime = {\n  [key: string]: BatchFoundEstimateTimeItem;\n};\n\nfunction batchFindEstimateTime(EstimateTime: EstimateTime, StopIDList: Array<number>): BatchFoundEstimateTime {\n  const result = {};\n  for (const item of EstimateTime) {\n    if (StopIDList.indexOf(item.StopID) > -1) {\n      const thisStopKey: string = `s_${item.StopID}`;\n      result[thisStopKey] = item;\n    }\n  }\n  return result;\n}\n\ntype BatchFoundEstimateTimeRanking = {\n  [key: string]: IntegratedLocationItemRanking;\n};\n\nfunction rankBatchFoundEstimateTime(batchFoundEstimateTime: BatchFoundEstimateTime, StopIDList: Array<number>): BatchFoundEstimateTimeRanking {\n  // StopIDList act as a secondary filter\n  const result: BatchFoundEstimateTimeRanking = {};\n  const rankingArray: Array<[number, number]> = []; // StopID, EstimateTime\n  for (const thisStopKey in batchFoundEstimateTime) {\n    const thisBatchFoundEstimateTimeItem = batchFoundEstimateTime[thisStopKey];\n    const thisStopID = thisBatchFoundEstimateTimeItem.StopID;\n    const thisEstimateTime = parseInt(thisBatchFoundEstimateTimeItem.EstimateTime);\n    if (thisEstimateTime >= 0 && StopIDList.indexOf(thisStopID) > -1) {\n      rankingArray.push([thisStopID, thisEstimateTime]);\n    }\n  }\n  const rankingArrayLength = rankingArray.length;\n  rankingArray.sort(function (a, b) {\n    return a[1] - b[1];\n  });\n  let index = 1;\n  for (const rankingItem of rankingArray) {\n    // Classify into 4 groups and give a code\n    const rankingRatio = index / rankingArrayLength;\n    const rankingCode = (rankingRatio - (rankingRatio % 0.25)) / 0.25;\n    const thisStopID = rankingItem[0];\n    const thisStopKey = `s_${thisStopID}`;\n    result[thisStopKey] = {\n      number: index,\n      text: index.toString(),\n      code: rankingCode\n    };\n    index += 1;\n  }\n  return result;\n}\n\nexport interface LocationGroupProperty {\n  key: string;\n  icon: MaterialSymbols;\n  value: string;\n}\n\nexport interface LocationGroup {\n  name: string;\n  properties: Array<LocationGroupProperty>;\n}\n\nexport interface IntegratedLocationItemRanking {\n  number: number;\n  text: '--' | string;\n  code: -1 | 0 | 1 | 2 | 3 | 4; // -1: not applicable, 0: 0-25%, 1: 25-50%, 2: 50-75%, 3: 75-100%, 4: 100%\n}\n\nexport interface IntegratedLocationItem {\n  route_name: string;\n  route_direction: string;\n  routeId: number;\n  stopId: number;\n  status: EstimateTimeStatus;\n  ranking: IntegratedLocationItemRanking;\n  buses: Array<FormattedBus>;\n  busArrivalTimes: Array<BusArrivalTime>;\n}\n\nexport interface IntegratedLocation {\n  groupedItems: {\n    [g_index: string]: Array<IntegratedLocationItem>;\n  };\n  groups: {\n    [g_index: string]: LocationGroup;\n  };\n  groupQuantity: number;\n  itemQuantity: {\n    [g_index: string]: number;\n  };\n  LocationName: string;\n  dataUpdateTime: number;\n  hash: string;\n}\n\nexport async function integrateLocation(hash: string, chartWidth: number, chartHeight: number, requestID: string): Promise<IntegratedLocation> {\n  setDataReceivingProgress(requestID, 'getLocation_0', 0, false);\n  setDataReceivingProgress(requestID, 'getLocation_1', 0, false);\n  setDataReceivingProgress(requestID, 'getRoute_0', 0, false);\n  setDataReceivingProgress(requestID, 'getRoute_1', 0, false);\n  setDataReceivingProgress(requestID, 'getStop_0', 0, false);\n  setDataReceivingProgress(requestID, 'getStop_1', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_0', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_1', 0, false);\n  setDataReceivingProgress(requestID, 'getBusEvent_0', 0, false);\n  setDataReceivingProgress(requestID, 'getBusEvent_1', 0, false);\n  const EstimateTime = await getEstimateTime(requestID);\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  const Stop = await getStop(requestID);\n  const BusEvent = await getBusEvent(requestID);\n  const BusData = await getBusData(requestID);\n  const BusArrivalTimes = await getBusArrivalTimes(chartWidth, chartHeight);\n\n  const time_formatting_mode = getSettingOptionValue('time_formatting_mode');\n  const location_labels = getSettingOptionValue('location_labels');\n  const display_user_orientation = getSettingOptionValue('display_user_orientation');\n\n  const groupedItems = {} as IntegratedLocation['groupedItems'];\n  const itemQuantity = {} as IntegratedLocation['itemQuantity'];\n  const groups = {} as IntegratedLocation['groups'];\n\n  const userOrientation = getUserOrientation();\n\n  const thisLocationKey = `ml_${hash}`;\n  const thisLocation = Location[thisLocationKey];\n  const thisLocationName = thisLocation.n;\n  const stopLocationIds = thisLocation.id;\n  const setsOfVectors = thisLocation.v;\n\n  let StopIDs = [];\n  let RouteIDs = [];\n  const stopLocationQuantity = stopLocationIds.length;\n\n  for (let i = 0; i < stopLocationQuantity; i++) {\n    StopIDs = StopIDs.concat(thisLocation.s[i]);\n    RouteIDs = RouteIDs.concat(thisLocation.r[i]);\n  }\n\n  const batchFoundEstimateTime = batchFindEstimateTime(EstimateTime, StopIDs);\n  const batchFoundBuses = batchFindBusesForLocation(BusEvent, BusData, Route, StopIDs);\n\n  const cardinalDirections: Array<CardinalDirection> = [];\n  for (const vectorSet of setsOfVectors) {\n    let x: number = 0;\n    let y: number = 0;\n    for (const vector of vectorSet) {\n      x += vector[0];\n      y += vector[1];\n    }\n    const meanVector = normalizeVector([x, y]);\n    const cardinalDirection = getCardinalDirectionFromVector(meanVector);\n    cardinalDirections.push(cardinalDirection);\n  }\n\n  let labels: Array<string> = [];\n  switch (location_labels) {\n    case 'address':\n      labels = generateLabelFromAddresses(thisLocation.a);\n      break;\n    case 'letters':\n      labels = generateLetterLabels(stopLocationQuantity);\n      break;\n    case 'directions':\n      labels = generateDirectionLabels(cardinalDirections);\n      break;\n    default:\n      break;\n  }\n\n  for (let i = 0; i < stopLocationQuantity; i++) {\n    const groupKey = `g_${i}`;\n    groupedItems[groupKey] = [];\n    itemQuantity[groupKey] = 0;\n    groups[groupKey] = {\n      name: labels[i],\n      properties: [\n        {\n          key: 'address',\n          icon: 'personal_places',\n          value: addressToString(thisLocation.a[i])\n        },\n        {\n          key: 'exact_position',\n          icon: 'location_on',\n          value: `${thisLocation.la[i].toFixed(5)}, ${thisLocation.lo[i].toFixed(5)}`\n        },\n        {\n          key: 'cardinal_direction',\n          icon: cardinalDirections[i].icon,\n          value: `${cardinalDirections[i].name}${display_user_orientation && userOrientation.cardinalDirection.id !== -1 && userOrientation.cardinalDirection.id === cardinalDirections[i].id ? '' : ''}`\n        }\n      ]\n    };\n\n    const thisGroupStops = thisLocation.s[i];\n    const stopQuantity = thisGroupStops.length;\n    const thisGroupRanking = rankBatchFoundEstimateTime(batchFoundEstimateTime, thisGroupStops);\n\n    for (let o = 0; o < stopQuantity; o++) {\n      const integratedItem = {} as IntegratedLocationItem;\n      // Collect data from 'Stop'\n      const thisStopID = thisLocation.s[i][o];\n      const thisStopKey = `s_${thisStopID}`;\n      let thisStop: SimplifiedStopItem = {};\n      if (Stop.hasOwnProperty(thisStopKey)) {\n        thisStop = Stop[thisStopKey];\n      } else {\n        continue;\n      }\n      integratedItem.stopId = thisStopID;\n\n      // Collect data from 'thisGroupRanking'\n      let thisItemRanking = { number: 0, text: '--', code: -1 } as IntegratedLocationItemRanking;\n      if (thisGroupRanking.hasOwnProperty(thisStopKey)) {\n        thisItemRanking = thisGroupRanking[thisStopKey];\n      }\n      integratedItem.ranking = thisItemRanking;\n\n      // Collect data from 'Route'\n      const thisRouteID: number = thisLocation.r[i][o];\n      const thisRouteKey = `r_${thisRouteID}`;\n      let thisRoute: SimplifiedRouteItem = {};\n      if (Route.hasOwnProperty(thisRouteKey)) {\n        thisRoute = Route[thisRouteKey];\n      } else {\n        continue;\n      }\n      integratedItem.route_name = thisRoute.n;\n      integratedItem.route_direction = `${[thisRoute.des, thisRoute.dep, ''][parseInt(thisStop.goBack)]}`;\n      integratedItem.routeId = thisRouteID;\n\n      // Collect data from 'batchFoundEstimateTime'\n      let thisEstimateTime = {} as EstimateTimeItem;\n      if (batchFoundEstimateTime.hasOwnProperty(thisStopKey)) {\n        thisEstimateTime = batchFoundEstimateTime[thisStopKey];\n      } else {\n        continue;\n      }\n      const parsedEstimateTime = parseEstimateTime(thisEstimateTime.EstimateTime, time_formatting_mode);\n      integratedItem.status = parsedEstimateTime;\n\n      // Collect data from 'batchFoundBuses'\n      let buses = [];\n      if (batchFoundBuses.hasOwnProperty(thisStopKey)) {\n        buses = batchFoundBuses[thisStopKey].map((e) => formatBus(e));\n      }\n      integratedItem.buses = buses;\n\n      // Collect data from 'BusArrivalTimes'\n      let thisBusArrivalTimes = [];\n      if (BusArrivalTimes.hasOwnProperty(thisStopKey)) {\n        thisBusArrivalTimes = BusArrivalTimes[thisStopKey];\n      }\n      integratedItem.busArrivalTimes = thisBusArrivalTimes;\n\n      groupedItems[groupKey].push(integratedItem);\n      itemQuantity[groupKey] += 1;\n    }\n  }\n\n  for (const key in groupedItems) {\n    groupedItems[key].sort(function (a, b) {\n      return a.routeId - b.routeId;\n    });\n    /*\n      .map((item: IntegratedLocationItem) => {\n        // accessing ranking[key] inside map callback will cause constant violations any way\n        return {\n          route_name: item.route_name,\n          route_direction: item.route_direction,\n          routeId: item.routeId,\n          stopId: item.stopId,\n          status: item.status,\n          rank: {\n            number: thisRankingIndex + 1,\n            code: 0\n          },\n          buses: item.buses,\n          busArrivalTimes: item.busArrivalTimes\n        };\n      })*/\n  }\n  const result: IntegratedLocation = {\n    groupedItems: groupedItems,\n    groups: groups,\n    groupQuantity: stopLocationQuantity,\n    itemQuantity: itemQuantity,\n    LocationName: thisLocationName,\n    hash: hash,\n    dataUpdateTime: getDataUpdateTime(requestID)\n  };\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  //await recordEstimateTimeForUpdateRate(EstimateTime);\n  return result;\n}\n","import { FolderWithContent, isFolderContentSaved, listFoldersWithContent, saveLocation, saveRoute, saveStop } from '../../data/folder/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { booleanToString } from '../../tools/index';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\ntype SaveToFolderType = 'stop-on-route' | 'stop-on-location' | 'route' | 'route-on-route' | 'bus' | 'location' | 'location-on-route';\n\nconst SaveToFolderField = documentQuerySelector('.css_save_to_folder_field');\nconst SaveToFolderBodyElement = elementQuerySelector(SaveToFolderField, '.css_save_to_folder_body');\nconst SaveToFolderListElement = elementQuerySelector(SaveToFolderBodyElement, '.css_save_to_folder_list');\n\nconst successfulSaveMessage = '';\nconst failedSaveMessage = '';\n\nfunction generateElementOfItem(item: FolderWithContent, type: SaveToFolderType, parameters: Array<any>): GeneratedElement {\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_save_to_folder_list_item');\n\n  // Icon element\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_save_to_folder_item_icon');\n  const iconSpanElement = document.createElement('span');\n  iconSpanElement.appendChild(getIconElement(item.icon));\n  iconElement.appendChild(iconSpanElement);\n\n  // Name element\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_save_to_folder_item_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n\n  // Event handler\n  switch (type) {\n    case 'stop-on-route':\n      itemElement.onclick = function () {\n        saveStopItemOnRoute(parameters[0], item.id, parameters[1], parameters[2]);\n      };\n      break;\n    case 'stop-on-location':\n      itemElement.onclick = function () {\n        saveStopItemOnLocation(parameters[0], item.id, parameters[1], parameters[2]);\n      };\n      break;\n    case 'route':\n      itemElement.onclick = function () {\n        saveRouteOnDetailsPage(item.id, parameters[0]);\n      };\n      break;\n    case 'route-on-route':\n      itemElement.onclick = function () {\n        saveRouteOnRoute(item.id, parameters[0]);\n      };\n      break;\n    case 'location':\n      itemElement.onclick = function () {\n        saveLocationOnDetailsPage(item.id, parameters[0]);\n      };\n      break;\n    case 'location-on-route':\n      itemElement.onclick = function () {\n        saveLocationOnRoute(item.id, parameters[0]);\n      };\n      break;\n    case 'bus':\n      // No action\n      break;\n    default:\n      break;\n  }\n\n  itemElement.appendChild(iconElement);\n  itemElement.appendChild(nameElement);\n\n  return {\n    element: itemElement,\n    id: ''\n  };\n}\n\nasync function initializeSaveToFolderField(type: SaveToFolderType, parameters: Array<any>) {\n  const foldersWithContent = await listFoldersWithContent();\n  SaveToFolderListElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  for (const item of foldersWithContent) {\n    const newItemElement = generateElementOfItem(item, type, parameters);\n    fragment.appendChild(newItemElement.element);\n  }\n  SaveToFolderListElement.append(fragment);\n}\n\nexport function openSaveToFolder(type: SaveToFolderType, parameters: Array<any>): void {\n  pushPageHistory('SaveToFolder');\n  SaveToFolderField.setAttribute('displayed', 'true');\n  initializeSaveToFolderField(type, parameters);\n}\n\nexport function closeSaveToFolder(): void {\n  revokePageHistory('SaveToFolder');\n  SaveToFolderField.setAttribute('displayed', 'false');\n}\n\nfunction saveStopItemOnRoute(itemElementID: string, folderID: string, StopID: number, RouteID: number): void {\n  const itemElement = documentQuerySelector(`.css_route_field .css_route_groups .css_route_group .css_route_group_tracks .css_route_group_items_track .css_route_group_item#${itemElementID}`);\n  const saveToFolderButtonElement = elementQuerySelector(itemElement, '.css_route_group_item_body .css_route_group_item_buttons .css_route_group_item_button[type=\"save-to-folder\"]');\n  saveStop(folderID, StopID, RouteID).then((e) => {\n    if (e) {\n      isFolderContentSaved('stop', StopID).then((k) => {\n        if (k) {\n          saveToFolderButtonElement.setAttribute('highlighted', booleanToString(k));\n          promptMessage('folder', successfulSaveMessage);\n          closeSaveToFolder();\n        }\n      });\n    } else {\n      promptMessage('warning', failedSaveMessage);\n    }\n  });\n}\n\nfunction saveStopItemOnLocation(itemElementID: string, folderID: string, StopID: number, RouteID: number): void {\n  const itemElement = documentQuerySelector(`.css_location_field .css_location_groups .css_location_group .css_location_group_items .css_location_group_item#${itemElementID}`);\n  const saveToFolderButtonElement = elementQuerySelector(itemElement, '.css_location_group_item_body .css_location_group_item_buttons .css_location_group_item_button[type=\"save-to-folder\"]');\n  saveStop(folderID, StopID, RouteID).then((e) => {\n    if (e) {\n      isFolderContentSaved('stop', StopID).then((k) => {\n        if (k) {\n          saveToFolderButtonElement.setAttribute('highlighted', booleanToString(k));\n          promptMessage('folder', successfulSaveMessage);\n          closeSaveToFolder();\n        }\n      });\n    } else {\n      promptMessage('warning', failedSaveMessage);\n    }\n  });\n}\n\nfunction saveRouteOnDetailsPage(folderID: string, RouteID: number): void {\n  const actionButtonElement = documentQuerySelector('.css_route_details_field .css_route_details_body .css_route_details_groups .css_route_details_group[group=\"actions\"] .css_route_details_group_body .css_route_details_action_button[action=\"save-to-folder\"]');\n  saveRoute(folderID, RouteID).then((e) => {\n    if (e) {\n      isFolderContentSaved('route', RouteID).then((k) => {\n        if (k) {\n          actionButtonElement.setAttribute('highlighted', 'true');\n          promptMessage('folder', successfulSaveMessage);\n          closeSaveToFolder();\n        }\n      });\n    } else {\n      promptMessage('warning', failedSaveMessage);\n    }\n  });\n}\n\nfunction saveRouteOnRoute(folderID: string, RouteID: number): void {\n  saveRoute(folderID, RouteID).then((e) => {\n    if (e) {\n      isFolderContentSaved('route', RouteID).then((k) => {\n        if (k) {\n          promptMessage('folder', successfulSaveMessage);\n          closeSaveToFolder();\n        }\n      });\n    } else {\n      promptMessage('warning', failedSaveMessage);\n    }\n  });\n}\n\nfunction saveLocationOnDetailsPage(folderID: string, hash: string): void {\n  saveLocation(folderID, hash).then((e) => {\n    if (e) {\n      isFolderContentSaved('location', hash).then((k) => {\n        if (k) {\n          promptMessage('folder', successfulSaveMessage);\n          closeSaveToFolder();\n        }\n      });\n    } else {\n      promptMessage('warning', failedSaveMessage);\n    }\n  });\n}\n\nfunction saveLocationOnRoute(folderID: string, hash: string): void {\n  saveLocation(folderID, hash).then((e) => {\n    if (e) {\n      isFolderContentSaved('location', hash).then((k) => {\n        if (k) {\n          promptMessage('folder', successfulSaveMessage);\n          closeSaveToFolder();\n        }\n      });\n    } else {\n      promptMessage('warning', failedSaveMessage);\n    }\n  });\n}\n","import { scheduleNotificationForStop, ScheduleNotificationOption, scheduleNotificationOptions } from '../../data/notification/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst ScheduleNotificationField = documentQuerySelector('.css_schedule_notification_field');\nconst ScheduleNotificationBodyElement = elementQuerySelector(ScheduleNotificationField, '.css_schedule_notification_body');\nconst ScheduleNotificationListElement = elementQuerySelector(ScheduleNotificationBodyElement, '.css_schedule_notification_list');\n\ntype ScheduleNotificationType = 'stop-on-route' | 'stop-on-location';\n\nfunction generateElementOfItem(item: ScheduleNotificationOption, type: ScheduleNotificationType, parameters: Array<any>): GeneratedElement {\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_schedule_notification_list_item');\n\n  // Icon element\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_schedule_notification_item_icon');\n  const iconSpanElement = document.createElement('span');\n  iconSpanElement.appendChild(getIconElement(item.icon));\n  iconElement.appendChild(iconSpanElement);\n\n  // Name element\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_schedule_notification_item_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n\n  // Event handler\n  switch (type) {\n    case 'stop-on-route':\n      itemElement.onclick = function () {\n        scheduleNotificationForStopItemOnRoute(parameters[0], parameters[1], parameters[2], parameters[3], item.index);\n      };\n      break;\n    case 'stop-on-location':\n      itemElement.onclick = function () {\n        scheduleNotificationForStopItemOnLocation(parameters[0], parameters[1], parameters[2], parameters[3], item.index);\n      };\n      break;\n    default:\n      break;\n  }\n\n  itemElement.appendChild(iconElement);\n  itemElement.appendChild(nameElement);\n\n  return {\n    element: itemElement,\n    id: ''\n  };\n}\n\nfunction initializeScheduleNotificationField(type: ScheduleNotificationType, parameters: Array<any>): void {\n  ScheduleNotificationListElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  for (const item of scheduleNotificationOptions) {\n    const newElement = generateElementOfItem(item, type, parameters);\n    fragment.appendChild(newElement.element);\n  }\n  ScheduleNotificationListElement.append(fragment);\n}\n\nexport function openScheduleNotification(type: ScheduleNotificationType, parameters: Array<any>): void {\n  pushPageHistory('ScheduleNotification');\n  ScheduleNotificationField.setAttribute('displayed', 'true');\n  initializeScheduleNotificationField(type, parameters);\n}\n\nexport function closeScheduleNotification(): void {\n  revokePageHistory('ScheduleNotification');\n  ScheduleNotificationField.setAttribute('displayed', 'false');\n}\n\nexport function scheduleNotificationForStopItemOnRoute(itemElementID: string, StopID: number, RouteID: number, EstimateTime: number, index: number): void {\n  const itemElement = documentQuerySelector(`.css_route_field .css_route_groups .css_route_group .css_route_group_tracks .css_route_group_items_track .css_route_group_item#${itemElementID}`);\n  const scheduleNotificationButtonElement = elementQuerySelector(itemElement, '.css_route_group_item_body .css_route_group_item_buttons .css_route_group_item_button[type=\"schedule-notification\"]');\n  promptMessage('manufacturing', '');\n  scheduleNotificationButtonElement.setAttribute('enabled', 'false');\n  closeScheduleNotification();\n  scheduleNotificationForStop(StopID, RouteID, EstimateTime, index).then((result) => {\n    switch (result) {\n      case 0:\n        promptMessage('error', '');\n        scheduleNotificationButtonElement.setAttribute('enabled', 'true');\n        break;\n      case 1:\n        promptMessage('check_circle', '');\n        scheduleNotificationButtonElement.setAttribute('enabled', 'true');\n        scheduleNotificationButtonElement.setAttribute('highlighted', 'true');\n        break;\n      case 2:\n        promptMessage('warning', '');\n        scheduleNotificationButtonElement.setAttribute('enabled', 'true');\n        break;\n      default:\n        break;\n    }\n  });\n}\n\nexport function scheduleNotificationForStopItemOnLocation(itemElementID: string, StopID: number, RouteID: number, EstimateTime: number, index: number): void {\n  const itemElement = documentQuerySelector(`.css_location_field .css_location_groups .css_location_group .css_location_group_items .css_location_group_item#${itemElementID}`);\n  const scheduleNotificationButtonElement = elementQuerySelector(itemElement, '.css_location_group_item_body .css_location_group_item_buttons .css_location_group_item_button[type=\"schedule-notification\"]');\n  promptMessage('manufacturing', '');\n  scheduleNotificationButtonElement.setAttribute('enabled', 'false');\n  closeScheduleNotification();\n  scheduleNotificationForStop(StopID, RouteID, EstimateTime, index).then((result) => {\n    switch (result) {\n      case 0:\n        promptMessage('error', '');\n        scheduleNotificationButtonElement.setAttribute('enabled', 'true');\n        break;\n      case 1:\n        promptMessage('check_circle', '');\n        scheduleNotificationButtonElement.setAttribute('enabled', 'true');\n        scheduleNotificationButtonElement.setAttribute('highlighted', 'true');\n        break;\n      case 2:\n        promptMessage('warning', '');\n        scheduleNotificationButtonElement.setAttribute('enabled', 'true');\n        break;\n      default:\n        break;\n    }\n  });\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { shareLocationPermalink, showLocationPermalinkQRCode } from '../../interface/location/details/index';\nimport { openSaveToFolder } from '../../interface/save-to-folder/index';\nimport { getLocation, MergedLocation, MergedLocationItem } from '../apis/getLocation/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../apis/loader';\n\nexport interface IntegratedLocationDetailsAction {\n  icon: MaterialSymbols;\n  action: Function;\n  key: string,\n  name: string;\n}\n\nexport type IntegratedLocationDetailsActionArray = Array<IntegratedLocationDetailsAction>;\n\nexport interface IntegratedLocationDetails {\n  actions: IntegratedLocationDetailsActionArray;\n  actionsQuantity: number\n  hash: string;\n}\n\nexport async function integrateLocationDetails(hash: string, requestID: string): Promise<IntegratedLocationDetails> {\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  let thisLocation = {} as MergedLocationItem;\n  if (Location.hasOwnProperty(thisLocationKey)) {\n    thisLocation = Location[thisLocationKey];\n  } else {\n    return {\n      actions: [],\n      actionsQuantity: 0,\n      hash: hash\n    };\n  }\n  const actions: IntegratedLocationDetailsActionArray = [\n    {\n      icon: 'folder',\n      name: '',\n      key: 'save-to-folder',\n      action: function () {\n        openSaveToFolder('location', [hash]);\n      }\n    },\n    {\n      icon: 'ios_share',\n      name: '',\n      key: 'permalink',\n      action: function () {\n        shareLocationPermalink(hash);\n      }\n    },\n    {\n      icon: 'qr_code_2',\n      name: '',\n      key: 'permalink-qr-code',\n      action: function () {\n        showLocationPermalinkQRCode(hash);\n      }\n    }\n  ];\n  const result: IntegratedLocationDetails = {\n    actions: actions,\n    actionsQuantity: actions.length,\n    hash: hash\n  };\n  return result;\n}\n","import { getLocation, MergedLocation, MergedLocationItem } from '../../../data/apis/getLocation/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../../../data/apis/loader';\nimport { IntegratedLocationDetails, IntegratedLocationDetailsAction, integrateLocationDetails } from '../../../data/location/details';\nimport { getSettingOptionValue } from '../../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { booleanToString, generateIdentifier } from '../../../tools/index';\nimport { getPermalink } from '../../../tools/permalink';\nimport { getBlankIconElement, setIcon } from '../../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../../index';\nimport { promptMessage } from '../../prompt/index';\nimport { openQRCode } from '../../qrcode/index';\n\nlet previousIntegration = {} as IntegratedLocationDetails;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nconst LocationDetailsField = documentQuerySelector('.css_location_details_field');\nconst LocationDetailsBodyElement = elementQuerySelector(LocationDetailsField, '.css_location_details_body');\nconst LocationDetailsActionsElement = elementQuerySelector(LocationDetailsBodyElement, '.css_location_details_actions');\n\nfunction generateElementOfItem(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_details_action');\n\n  // Icon\n  const icon = document.createElement('div');\n  icon.classList.add('css_location_details_action_icon');\n  icon.appendChild(getBlankIconElement());\n  element.appendChild(icon);\n\n  // Name\n  const name = document.createElement('div');\n  name.classList.add('css_location_details_action_name');\n  element.appendChild(name);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction updateLocationDetailsField(integration: IntegratedLocationDetails, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction, previousItem: IntegratedLocationDetailsAction | null): void {\n    function updateIcon(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_action_icon');\n      setIcon(thisIconElement, thisItem.icon);\n    }\n\n    function updateName(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      const nameElement = elementQuerySelector(thisElement, '.css_location_details_action_name');\n      nameElement.innerText = thisItem.name;\n    }\n\n    function updateOnclick(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      thisElement.onclick = thisItem.action;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateIcon(thisElement, thisItem);\n      updateName(thisElement, thisItem);\n      updateOnclick(thisElement, thisItem);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (previousItem.key !== thisItem.key) {\n        updateIcon(thisElement, thisItem);\n        updateName(thisElement, thisItem);\n        updateOnclick(thisElement, thisItem);\n      }\n\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const actions = integration.actions;\n  const actionsQuantity = integration.actionsQuantity;\n\n  const currentActionsCapacity = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action').length;\n  if (actionsQuantity !== currentActionsCapacity) {\n    const difference = currentActionsCapacity - actionsQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newItemElement = generateElementOfItem();\n        fragment.appendChild(newItemElement.element);\n      }\n      LocationDetailsActionsElement.append(fragment);\n    } else {\n      const LocationActionElements = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const itemIndex = currentActionsCapacity - 1 - o;\n        LocationActionElements[itemIndex].remove();\n      }\n    }\n  }\n\n  const LocationActionElements = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action');\n\n  for (let i = 0; i < actionsQuantity; i++) {\n    const thisElement = LocationActionElements[i];\n    const thisItem = actions[i];\n    if (previousIntegration.hasOwnProperty('actions')) {\n      if (previousIntegration.actions[i]) {\n        const previousItem = previousIntegration.actions[i];\n        updateItem(thisElement, thisItem, previousItem);\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    } else {\n      updateItem(thisElement, thisItem, null);\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nfunction setUpLocationDetailsFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const actions: IntegratedLocationDetailsAction[] = [];\n  /*\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  */\n  const defaultActionsQuantity = 3;\n  for (let i = 0; i < defaultActionsQuantity; i++) {\n    actions.push({\n      name: '',\n      icon: '',\n      key: `action-${i}`,\n      action: function () {}\n    });\n  }\n\n  updateLocationDetailsField(\n    {\n      actions: actions,\n      actionsQuantity: defaultActionsQuantity,\n      hash: ''\n    },\n    true,\n    playing_animation\n  );\n}\n\nasync function initializeLocationDetailsField(hash: string) {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const requestID = generateIdentifier();\n  const integration = await integrateLocationDetails(hash, requestID);\n  updateLocationDetailsField(integration, false, playing_animation);\n}\n\nexport function openLocationDetails(hash: string): void {\n  pushPageHistory('LocationDetails');\n  LocationDetailsField.setAttribute('displayed', 'true');\n  setUpLocationDetailsFieldSkeletonScreen();\n  initializeLocationDetailsField(hash);\n}\n\nexport function closeLocationDetails(): void {\n  revokePageHistory('LocationDetails');\n  LocationDetailsField.setAttribute('displayed', 'false');\n}\n\nexport async function shareLocationPermalink(hash: string) {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  if (Location.hasOwnProperty(thisLocationKey)) {\n    const thisLocation = Location[thisLocationKey] as MergedLocationItem;\n    const link = getPermalink(1, {\n      hash: hash\n    });\n    if (navigator.share) {\n      navigator\n        .share({\n          title: thisLocation.n,\n          url: link\n        })\n        .then(() => {\n          promptMessage('check_circle', '');\n        })\n        .catch((e) => {\n          promptMessage('cancel', '');\n          console.error(e);\n        });\n    }\n  }\n}\n\nexport async function showLocationPermalinkQRCode(hash: string) {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  if (Location.hasOwnProperty(thisLocationKey)) {\n    const link = getPermalink(1, {\n      hash: hash\n    });\n    openQRCode(link);\n  }\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nexport interface BufferZoneItem {\n  Direction: 0 | 1 | 2; // (goBack/GoBack)\n  OriginStopID: number;\n  DestinationStopID: number;\n}\n\nexport type BufferZones = Array<BufferZoneItem>;\n\nexport interface SegmentBufferItem {\n  RouteID: number;\n  BufferZones: BufferZones;\n}\n\nexport type SegmentBuffers = Array<SegmentBufferItem>;\n\nexport type SimplifiedSegmentBufferItem = { [key: string]: Array<BufferZoneItem> };\n\nexport type SimplifiedSegmentBuffer = { [key: string]: SimplifiedSegmentBufferItem };\n\nlet SegmentBuffersAPIVariableCache_available: boolean = false;\nlet SegmentBuffersAPIVariableCache_data: object = {};\n\nasync function extractSegmentBuffers(xml: string): Promise<SegmentBuffers> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"extractSegmentBuffers-worker\" */ './extractSegmentBuffers-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(xml); // Send data to the worker\n  });\n\n  return result;\n}\n\nasync function simplifySegmentBuffers(array: SegmentBuffers): Promise<SimplifiedSegmentBuffer> {\n  const worker = new Worker(new URL(/* webpackChunkName: \"simplifySegmentBuffers-worker\" */ './simplifySegmentBuffers-worker.ts', import.meta.url));\n\n  // Wrap worker communication in a promise\n  const result = await new Promise((resolve, reject) => {\n    worker.onmessage = function (e) {\n      resolve(e.data); // Resolve the promise with the worker's result\n      worker.terminate(); // Terminate the worker when done\n    };\n\n    worker.onerror = function (e) {\n      reject(e.message); // Reject the promise on error\n      worker.terminate(); // Terminate the worker if an error occurs\n    };\n\n    worker.postMessage(array); // Send data to the worker\n  });\n\n  return result;\n}\n\nexport async function getSegmentBuffers(requestID: string): Promise<SimplifiedSegmentBuffer> {\n  async function getData() {\n    const apis = [\n      [0, 15],\n      [1, 15]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = '';\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getSegmentBuffers_${api.e[0]}`, 'xml');\n      result += data;\n      setDataUpdateTime(requestID, -1);\n    }\n    return result;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 30 * 1000;\n  const cacheKey = 'bus_segment_buffers_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    const extractedResult = await extractSegmentBuffers(result);\n    const simplifiedResult = await simplifySegmentBuffers(extractedResult);\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(simplifiedResult));\n    if (!SegmentBuffersAPIVariableCache_available) {\n      SegmentBuffersAPIVariableCache_available = true;\n      SegmentBuffersAPIVariableCache_data = simplifiedResult;\n    }\n    return simplifiedResult;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      const extractedResult = await extractSegmentBuffers(result);\n      const simplifiedResult = await simplifySegmentBuffers(extractedResult);\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(simplifiedResult));\n      return simplifiedResult;\n    } else {\n      if (!SegmentBuffersAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        SegmentBuffersAPIVariableCache_available = true;\n        SegmentBuffersAPIVariableCache_data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getSegmentBuffers_0', 0, true);\n      setDataReceivingProgress(requestID, 'getSegmentBuffers_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return SegmentBuffersAPIVariableCache_data;\n    }\n  }\n}\n","import { convertPositionsToDistance } from '../../tools/convert';\nimport { getSettingOptionValue } from '../settings/index';\n\ninterface position {\n  latitude: number;\n  longitude: number;\n}\n\nconst userPosition = {\n  current: {\n    latitude: 0,\n    longitude: 0\n  },\n  permission: {\n    gained: false,\n    asked: false\n  },\n  id: 0\n};\n\nexport function askForPositioningPermission(): void {\n  function successHandler(position: any): void {\n    userPosition.permission.gained = true;\n    userPosition.current.latitude = position.coords.latitude;\n    userPosition.current.longitude = position.coords.longitude;\n  }\n  function errorHandler(error: any): void {\n    /*\n    let message = '';\n    // Check for known errors\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        message = 'This website does not have permission to use the Geolocation API';\n        break;\n      case error.POSITION_UNAVAILABLE:\n        message = 'The current position could not be determined.';\n        break;\n      case error.PERMISSION_DENIED_TIMEOUT:\n        message = 'The current position could not be determined ' + 'within the specified timeout period.';\n        break;\n    }\n    if (message == '') {\n      const strErrorCode = error.code.toString();\n      message = 'The position could not be determined due to ' + 'an unknown error (Code: ' + strErrorCode + ').';\n    }\n    console.log(message);\n    */\n  }\n  if (userPosition.permission.asked === false && getSettingOptionValue('display_user_location')) {\n    userPosition.permission.asked = true;\n    userPosition.id = navigator.geolocation.watchPosition(successHandler, errorHandler, {\n      enableHighAccuracy: true,\n      timeout: 30000,\n      maximumAge: 0\n    });\n  }\n}\n\nexport function getUserPosition(): position {\n  if (userPosition.permission.asked && userPosition.permission.gained) {\n    return userPosition.current;\n  }\n  if (!userPosition.permission.asked && !userPosition.permission.gained) {\n    askForPositioningPermission();\n    return userPosition.current;\n  }\n  if (userPosition.permission.asked && !userPosition.permission.gained) {\n    return userPosition.current;\n  }\n}\n\nexport function isNearUserPosition(latitude: number, longitude: number, radius: number = 450): boolean {\n  const currentUserPosition = getUserPosition();\n  const distance = convertPositionsToDistance(latitude, longitude, currentUserPosition.latitude, currentUserPosition.longitude);\n  if (distance <= radius) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function getNearestPosition(positions: Array<position>, radius: number = 450): position | null {\n  const currentUserPosition = getUserPosition();\n  let shortestDistance = Infinity;\n  let nearestIndex = -1;\n  for (let i = positions.length - 1; i > 0; i--) {\n    const position = positions[i];\n    const distance = convertPositionsToDistance(currentUserPosition.latitude, currentUserPosition.longitude, position.latitude, position.longitude);\n    if (distance <= radius) {\n      if (distance < shortestDistance) {\n        nearestIndex = i;\n        shortestDistance = distance;\n      }\n    }\n  }\n\n  if (nearestIndex > 0) {\n    return positions[nearestIndex];\n  } else {\n    return null;\n  }\n}\n","import { convertPositionsToDistance } from '../../tools/convert';\nimport { BusArrivalTime, getBusArrivalTimes } from '../analytics/bus-arrival-time/index';\nimport { getBusData } from '../apis/getBusData/index';\nimport { getBusEvent } from '../apis/getBusEvent/index';\nimport { getEstimateTime } from '../apis/getEstimateTime/index';\nimport { getLocation, IndexedLocation, IndexedLocationItem, MergedLocation, SimplifiedLocation, SimplifiedLocationItem } from '../apis/getLocation/index';\nimport { getRoute, SimplifiedRoute, SimplifiedRouteItem } from '../apis/getRoute/index';\nimport { getSegmentBuffers, SimplifiedSegmentBufferItem } from '../apis/getSegmentBuffers/index';\nimport { getStop, SimplifiedStopItem } from '../apis/getStop/index';\nimport { batchFindBusesForRoute, EstimateTimeStatus, formatBus, FormattedBus, parseEstimateTime } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime, getDataUpdateTime, setDataReceivingProgress } from '../apis/loader';\nimport { getSettingOptionValue } from '../settings/index';\nimport { getNearestPosition } from '../user-position/index';\n\ninterface formattedOverlappingRoute {\n  name: string;\n  RouteEndPoints: {\n    RouteDeparture: string;\n    RouteDestination: string;\n    text: string;\n    html: string;\n  };\n  RouteID: number;\n  PathAttributeId: Array<number>;\n}\n\nexport interface integratedStopItemPosition {\n  longitude: number;\n  latitude: number;\n}\n\nexport interface integratedStopItemSegmentBuffer {\n  isSegmentBuffer: boolean;\n  isStartingPoint: boolean;\n  isEndingPoint: boolean;\n}\n\nexport interface integratedStopItemNearbyLocationItem {\n  name: string;\n  distance: number;\n  hash: string;\n}\n\nexport interface integratedStopItem {\n  name: string;\n  goBack: '0' | '1' | '2';\n  status: EstimateTimeStatus;\n  buses: Array<FormattedBus>;\n  overlappingRoutes: Array<formattedOverlappingRoute>;\n  busArrivalTimes: Array<BusArrivalTime>;\n  nearbyLocations: Array<integratedStopItemNearbyLocationItem>;\n  sequence: number;\n  position: integratedStopItemPosition;\n  nearest: boolean;\n  segmentBuffer: integratedStopItemSegmentBuffer;\n  progress: number;\n  id: number;\n}\n\nexport interface IntegratedRoute {\n  groupedItems: { [key: string]: Array<integratedStopItem> };\n  groupQuantity: number;\n  itemQuantity: { [key: string]: number };\n  RouteName: string;\n  RouteEndPoints: {\n    RouteDeparture: string;\n    RouteDestination: string;\n  };\n  dataUpdateTime: number;\n  RouteID: number;\n  PathAttributeId: Array<number>;\n}\n\nexport async function integrateRoute(RouteID: number, PathAttributeId: Array<number>, chartWidth: number, chartHeight: number, requestID: string): Promise<IntegratedRoute> {\n  setDataReceivingProgress(requestID, 'getRoute_0', 0, false);\n  setDataReceivingProgress(requestID, 'getRoute_1', 0, false);\n  setDataReceivingProgress(requestID, 'getStop_0', 0, false);\n  setDataReceivingProgress(requestID, 'getStop_1', 0, false);\n  setDataReceivingProgress(requestID, 'getLocation_0', 0, false);\n  setDataReceivingProgress(requestID, 'getLocation_1', 0, false);\n  setDataReceivingProgress(requestID, 'getSegmentBuffers_0', 0, false);\n  setDataReceivingProgress(requestID, 'getSegmentBuffers_1', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_0', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_1', 0, false);\n  setDataReceivingProgress(requestID, 'getBusEvent_0', 0, false);\n  setDataReceivingProgress(requestID, 'getBusEvent_1', 0, false);\n  setDataReceivingProgress(requestID, 'getBusData_0', 0, false);\n  setDataReceivingProgress(requestID, 'getBusData_1', 0, false);\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  const Stop = await getStop(requestID);\n  const SimplifiedLocation = (await getLocation(requestID, 0)) as SimplifiedLocation;\n  const MergedLocation = (await getLocation(requestID, 1)) as MergedLocation;\n  const IndexedLocation = (await getLocation(requestID, 2)) as IndexedLocation;\n  const SegmentBuffers = await getSegmentBuffers(requestID);\n  const EstimateTime = await getEstimateTime(requestID);\n  const BusEvent = await getBusEvent(requestID);\n  const BusData = await getBusData(requestID);\n  const BusArrivalTimes = await getBusArrivalTimes(chartWidth, chartHeight);\n\n  const batchFoundBuses = batchFindBusesForRoute(BusEvent, BusData, Route, RouteID, PathAttributeId);\n\n  let hasSegmentBuffers: boolean = false;\n  let thisSegmentBuffers: SimplifiedSegmentBufferItem = {};\n  if (SegmentBuffers.hasOwnProperty(`r_${RouteID}`)) {\n    hasSegmentBuffers = true;\n    thisSegmentBuffers = SegmentBuffers[`r_${RouteID}`];\n  }\n\n  const time_formatting_mode = getSettingOptionValue('time_formatting_mode') as number;\n\n  let result = [];\n  let positions = [];\n\n  for (const item of EstimateTime) {\n    let integratedStopItem = {} as integratedStopItem;\n\n    const thisRouteID = item.RouteID;\n\n    // Check whether this stop is on this route or not\n    if ([RouteID, RouteID * 10].includes(thisRouteID) || PathAttributeId.includes(thisRouteID)) {\n      // Parse estimate time\n      integratedStopItem.status = parseEstimateTime(item?.EstimateTime, time_formatting_mode);\n\n      // Collect data from 'Stop'\n      const thisStopKey = `s_${item.StopID}`;\n      let thisStop = {} as SimplifiedStopItem;\n      if (Stop.hasOwnProperty(thisStopKey)) {\n        thisStop = Stop[thisStopKey];\n      } else {\n        continue;\n      }\n      integratedStopItem.id = item.StopID;\n      integratedStopItem.sequence = thisStop.seqNo;\n      integratedStopItem.goBack = thisStop.goBack;\n\n      // Collect data from 'SimplifiedLocation'\n      const thisLocationKey = `l_${thisStop.stopLocationId}`;\n      let thisSimplifiedLocation = {} as SimplifiedLocationItem;\n      if (SimplifiedLocation.hasOwnProperty(thisLocationKey)) {\n        thisSimplifiedLocation = SimplifiedLocation[thisLocationKey];\n      } else {\n        continue;\n      }\n      integratedStopItem.name = thisSimplifiedLocation.n;\n      integratedStopItem.overlappingRoutes = thisSimplifiedLocation.r\n        .filter((id: number) => id !== RouteID)\n        .map((id: number) => {\n          const overlappingRouteKey = `r_${id}`;\n          if (Route.hasOwnProperty(overlappingRouteKey)) {\n            const overlappingRoute = Route[overlappingRouteKey] as SimplifiedRouteItem;\n            const formattedOverlappingRoute = {\n              name: overlappingRoute.n,\n              RouteEndPoints: {\n                RouteDeparture: overlappingRoute.dep,\n                RouteDestination: overlappingRoute.des,\n                text: `${overlappingRoute.dep} \\u2194 ${overlappingRoute.des}`, // u2194 -> ''\n                html: `<span>${overlappingRoute.dep}</span><span>\\u2194</span><span>${overlappingRoute.des}</span>`\n              },\n              RouteID: overlappingRoute.id,\n              PathAttributeId: overlappingRoute.pid\n            };\n            return formattedOverlappingRoute;\n          } else {\n            return null;\n          }\n        })\n        .filter((e) => {\n          return e !== null;\n        });\n      integratedStopItem.position = {\n        longitude: thisSimplifiedLocation.lo,\n        latitude: thisSimplifiedLocation.la\n      };\n      positions.push({\n        latitude: thisSimplifiedLocation.la,\n        longitude: thisSimplifiedLocation.lo,\n        id: item.StopID\n      });\n\n      // Collect data from 'IndexedLocation' and 'MergedLocation'\n      const thisSimplifiedLocationGeohash = thisSimplifiedLocation.g;\n      let thisIndexedLocationItem: Array<IndexedLocationItem> = [];\n      if (IndexedLocation.hasOwnProperty(thisSimplifiedLocationGeohash)) {\n        thisIndexedLocationItem = IndexedLocation[thisSimplifiedLocationGeohash];\n      }\n      let nearbyLocations: Array<integratedStopItemNearbyLocationItem> = [];\n      for (const item of thisIndexedLocationItem) {\n        const mergedLocationKey = `ml_${item.hash}`;\n        if (MergedLocation.hasOwnProperty(mergedLocationKey)) {\n          const thisMergedLocation = MergedLocation[mergedLocationKey];\n          const nearbyLocationItem: integratedStopItemNearbyLocationItem = {\n            name: thisMergedLocation.n,\n            distance: convertPositionsToDistance(thisMergedLocation.la[0], thisMergedLocation.lo[0], thisSimplifiedLocation.la, thisSimplifiedLocation.lo) | 0,\n            hash: thisMergedLocation.hash\n          };\n          nearbyLocations.push(nearbyLocationItem);\n        }\n      }\n      nearbyLocations.sort(function (a, b) {\n        return a.distance - b.distance;\n      });\n      integratedStopItem.nearbyLocations = nearbyLocations;\n\n      // Collect data from 'batchFoundBuses'\n      let buses = []; // as Array<FormattedBus>\n      for (const overlappingStopID of thisSimplifiedLocation.s) {\n        const overlappingStopKey = `s_${overlappingStopID}`;\n        if (batchFoundBuses.hasOwnProperty(overlappingStopKey)) {\n          buses.push(batchFoundBuses[overlappingStopKey].map((e) => formatBus(e)));\n        }\n      }\n      integratedStopItem.buses = buses.flat().sort(function (a, b) {\n        return a.index - b.index;\n      });\n\n      // Collect data from 'BusArrivalTimes'\n      let thisBusArrivalTimes = [];\n      if (BusArrivalTimes.hasOwnProperty(thisStopKey)) {\n        thisBusArrivalTimes = BusArrivalTimes[thisStopKey];\n      }\n      integratedStopItem.busArrivalTimes = thisBusArrivalTimes;\n\n      // Check whether this stop is segment buffer\n      let isSegmentBuffer: boolean = false;\n      let isStartingPoint: boolean = false;\n      let isEndingPoint: boolean = false;\n      let useReversed: boolean = false;\n      if (hasSegmentBuffers) {\n        const groupKey = `g_${integratedStopItem.goBack}`;\n        let segmentBufferGroup = [];\n\n        if (thisSegmentBuffers.hasOwnProperty(groupKey)) {\n          segmentBufferGroup = thisSegmentBuffers[groupKey];\n        } else {\n          if (integratedStopItem.goBack === '1') {\n            useReversed = true;\n            segmentBufferGroup = thisSegmentBuffers['g_0'];\n          }\n        }\n\n        for (const thisBufferZone of segmentBufferGroup) {\n          if (thisBufferZone.OriginStopID === item.StopID || thisBufferZone.DestinationStopID === item.StopID) {\n            isSegmentBuffer = true;\n          }\n          if (useReversed) {\n            if (thisBufferZone.OriginStopID === item.StopID) {\n              isEndingPoint = true;\n            }\n            if (thisBufferZone.DestinationStopID === item.StopID) {\n              isStartingPoint = true;\n            }\n          } else {\n            if (thisBufferZone.OriginStopID === item.StopID) {\n              isStartingPoint = true;\n            }\n            if (thisBufferZone.DestinationStopID === item.StopID) {\n              isEndingPoint = true;\n            }\n          }\n        }\n      }\n      integratedStopItem.segmentBuffer = {\n        isSegmentBuffer,\n        isStartingPoint,\n        isEndingPoint\n      };\n\n      result.push(integratedStopItem);\n    }\n  }\n\n  result.sort(function (a, b) {\n    return a.sequence - b.sequence;\n  });\n\n  const nearestPosition = getNearestPosition(positions, 450);\n\n  let isBufferZoneOpened: boolean = false;\n  let isBufferZoneClosed: boolean = false;\n\n  let groupedItems: { [key: string]: Array<integratedStopItem> } = {};\n  let groupQuantity: number = 0;\n  let itemQuantity: { [key: string]: number } = {};\n\n  const resultLength = result.length;\n\n  for (let index = 0; index < resultLength; index++) {\n    let item = result[index];\n    const nextItem = result[index + 1] || item;\n    let progress = 0;\n\n    if (item.buses.length > 0) {\n      if (item.buses[0].onThisRoute) {\n        const [x, y] = [item.buses[0].position.longitude, item.buses[0].position.latitude];\n        const [x1, y1] = [item.position.longitude, item.position.latitude];\n        const [x2, y2] = [nextItem.position.longitude, nextItem.position.latitude];\n        const dotProduct = (x - x1) * (x2 - x) + (y - y1) * (y2 - y);\n        if (dotProduct >= 0) {\n          // ensure that (x, y) is between (x1, y1) and (x2, y2)\n          const distance1 = Math.hypot(x - x1, y - y1);\n          const distance2 = Math.hypot(x - x2, y - y2);\n          progress = Math.max(0, Math.min(distance1 / (distance1 + distance2), 1));\n        }\n      }\n    }\n    item.progress = progress;\n\n    if (item.segmentBuffer.isStartingPoint) {\n      isBufferZoneOpened = true;\n    }\n\n    if (item.segmentBuffer.isEndingPoint) {\n      if (isBufferZoneOpened) {\n        isBufferZoneClosed = true;\n      }\n    }\n\n    if (isBufferZoneOpened && !isBufferZoneClosed) {\n      item.segmentBuffer.isSegmentBuffer = true;\n    }\n\n    if (isBufferZoneOpened && isBufferZoneClosed) {\n      isBufferZoneOpened = false;\n      isBufferZoneClosed = false;\n    }\n\n    let isNearest = false;\n    if (nearestPosition !== null) {\n      if (nearestPosition.id === item.id) {\n        isNearest = true;\n      }\n    }\n    item.nearest = isNearest;\n\n    const groupKey = `g_${item.goBack}` || 'g_0';\n\n    if (!groupedItems.hasOwnProperty(groupKey)) {\n      groupedItems[groupKey] = [];\n      itemQuantity[groupKey] = 0;\n      groupQuantity += 1;\n    }\n\n    groupedItems[groupKey].push(item);\n    itemQuantity[groupKey] += 1;\n  }\n\n  const thisRoute = Route[`r_${RouteID}`];\n  const thisRouteName = thisRoute.n;\n  const thisRouteDeparture = thisRoute.dep;\n  const thisRouteDestination = thisRoute.des;\n\n  const result2: IntegratedRoute = {\n    groupedItems: groupedItems,\n    groupQuantity: groupQuantity,\n    itemQuantity: itemQuantity,\n    RouteName: thisRouteName,\n    RouteEndPoints: {\n      RouteDeparture: thisRouteDeparture,\n      RouteDestination: thisRouteDestination\n    },\n    dataUpdateTime: getDataUpdateTime(requestID),\n    RouteID,\n    PathAttributeId\n  };\n\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  // await recordEstimateTimeForUpdateRate(EstimateTime);\n  return result2;\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nexport interface ProviderItem {\n  id: number;\n  nameZn: string; // name in Chinese (Zhngwn)\n  nameEn: string; // name in English\n  email: string;\n  phoneInfo: string;\n  stationId: string;\n  stationNameZn: string;\n  stationNameEn: string;\n  type: '0' | '1' | '2' | '3' | '4' | '5'; // 0: city bus station, 1: coach bus station, 2: MRT station, 3: train station, 4: airport, 5: port\n}\n\nexport type Provider = Array<ProviderItem>;\n\nlet ProviderAPIVariableCache_available: boolean = false;\nlet ProviderAPIVariableCache_data: object = {};\n\nexport async function getProvider(requestID: string): Promise<Provider> {\n  async function getData() {\n    const apis = [\n      [0, 9],\n      [1, 9]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getProvider_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 60 * 1000;\n  const cacheKey = 'bus_provider_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(result));\n    if (!ProviderAPIVariableCache_available) {\n      ProviderAPIVariableCache_available = true;\n      ProviderAPIVariableCache_data = result;\n    }\n    return result;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(result));\n      return result;\n    } else {\n      if (!ProviderAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        ProviderAPIVariableCache_available = true;\n        ProviderAPIVariableCache_data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getProvider_0', 0, true);\n      setDataReceivingProgress(requestID, 'getProvider_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return ProviderAPIVariableCache_data;\n    }\n  }\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nlet SemiTimetableAPIVariableCache_available: boolean = false;\nlet SemiTimetableAPIVariableCache_data: object = {};\n\nexport async function getSemiTimeTable(requestID: string): Promise<object> {\n  async function getData() {\n    const apis = [\n      [0, 12],\n      [1, 12]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getSemiTimeTable_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 14 * 1000;\n  const cacheKey = 'bus_semi_timetable_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(result));\n    if (!SemiTimetableAPIVariableCache_available) {\n      SemiTimetableAPIVariableCache_available = true;\n      SemiTimetableAPIVariableCache_data = result;\n    }\n    return result;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(result));\n      return result;\n    } else {\n      if (!SemiTimetableAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        SemiTimetableAPIVariableCache_available = true;\n        SemiTimetableAPIVariableCache_data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getSemiTimeTable_0', 0, true);\n      setDataReceivingProgress(requestID, 'getSemiTimeTable_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return SemiTimetableAPIVariableCache_data;\n    }\n  }\n}\n","import { lfGetItem, lfSetItem } from '../../storage/index';\nimport { getAPIURL } from '../getAPIURL/index';\nimport { fetchData, setDataReceivingProgress, setDataUpdateTime } from '../loader';\n\nlet TimetableAPIVariableCache_available: boolean = false;\nlet TimetableAPIVariableCache_data: object = {};\n\nexport async function getTimeTable(requestID: string): Promise<object> {\n  async function getData() {\n    const apis = [\n      [0, 14],\n      [1, 14]\n    ].map((e) => ({ url: getAPIURL(e[0], e[1]), e: e }));\n    let result = [];\n    for (const api of apis) {\n      const data = await fetchData(api.url, requestID, `getTimeTable_${api.e[0]}`, 'json');\n      result = result.concat(data.BusInfo);\n      setDataUpdateTime(requestID, data.EssentialInfo.UpdateTime);\n    }\n    return result;\n  }\n\n  const cacheTimeToLive = 60 * 60 * 24 * 14 * 1000;\n  const cacheKey = 'bus_timetable_cache';\n  const cacheTimestamp = await lfGetItem(0, `${cacheKey}_timestamp`);\n  if (cacheTimestamp === null) {\n    const result = await getData();\n    await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n    await lfSetItem(0, cacheKey, JSON.stringify(result));\n    if (!TimetableAPIVariableCache_available) {\n      TimetableAPIVariableCache_available = true;\n      TimetableAPIVariableCache_data = result;\n    }\n    return result;\n  } else {\n    if (new Date().getTime() - parseInt(cacheTimestamp) > cacheTimeToLive) {\n      const result = await getData();\n      await lfSetItem(0, `${cacheKey}_timestamp`, new Date().getTime());\n      await lfSetItem(0, cacheKey, JSON.stringify(result));\n      return result;\n    } else {\n      if (!TimetableAPIVariableCache_available) {\n        const cache = await lfGetItem(0, cacheKey);\n        TimetableAPIVariableCache_available = true;\n        TimetableAPIVariableCache_data = JSON.parse(cache);\n      }\n      setDataReceivingProgress(requestID, 'getTimeTable_0', 0, true);\n      setDataReceivingProgress(requestID, 'getTimeTable_1', 0, true);\n      setDataUpdateTime(requestID, -1);\n      return TimetableAPIVariableCache_data;\n    }\n  }\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { dateToString, dateValueToDayOfWeek, getThisWeekOrigin, offsetDate } from '../../tools/time';\nimport { getProvider, Provider, ProviderItem } from '../apis/getProvider/index';\nimport { getRoute, Route, RouteItem } from '../apis/getRoute/index';\nimport { getSemiTimeTable } from '../apis/getSemiTimeTable/index';\nimport { getTimeTable } from '../apis/getTimeTable/index';\nimport { parseTimeCode, TimeMoment, TimeRange } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../apis/loader';\n\nfunction findRoute(Route: Route, RouteID: number): RouteItem {\n  let thisRoute = {} as RouteItem;\n  for (const item of Route) {\n    if (item.Id === RouteID) {\n      thisRoute = item;\n      break;\n    }\n  }\n  return thisRoute;\n}\n\nfunction findProvider(Provider: Provider, providerId: number): ProviderItem {\n  let thisProvider = {} as ProviderItem;\n  for (const item of Provider) {\n    if (item.id === providerId) {\n      thisProvider = item;\n    }\n  }\n  return thisProvider;\n}\n\nexport interface CalendarEvent {\n  date: Date;\n  dateString: string;\n  duration: number;\n  deviation: number;\n}\n\nexport type CalendarEventGroup = Array<CalendarEvent>;\n\nexport interface CalendarDay {\n  name: string;\n  day: number;\n  code: string;\n}\n\nexport interface Calendar {\n  calendarDays: {\n    [key: string]: CalendarDay;\n  };\n  calendarDayQuantity: 7;\n  calendarEventGroups: {\n    [key: string]: CalendarEventGroup;\n  };\n  calendarEventQuantity: {\n    [key: string]: number;\n  };\n}\n\nfunction generateCalendarFromTimeTables(RouteID: number, PathAttributeId: Array<number>, timeTableRules: object, SemiTimeTable: [], TimeTable: []): Calendar {\n  let calendar: Calendar = {\n    calendarDays: {\n      d_0: {\n        name: '',\n        day: 0,\n        code: 'd_0'\n      },\n      d_1: {\n        name: '',\n        day: 1,\n        code: 'd_1'\n      },\n      d_2: {\n        name: '',\n        day: 2,\n        code: 'd_2'\n      },\n      d_3: {\n        name: '',\n        day: 3,\n        code: 'd_3'\n      },\n      d_4: {\n        name: '',\n        day: 4,\n        code: 'd_4'\n      },\n      d_5: {\n        name: '',\n        day: 5,\n        code: 'd_5'\n      },\n      d_6: {\n        name: '',\n        day: 6,\n        code: 'd_6'\n      }\n    },\n    calendarDayQuantity: 7,\n    calendarEventGroups: {\n      d_0: [],\n      d_1: [],\n      d_2: [],\n      d_3: [],\n      d_4: [],\n      d_5: [],\n      d_6: []\n    },\n    calendarEventQuantity: {\n      d_0: 0,\n      d_1: 0,\n      d_2: 0,\n      d_3: 0,\n      d_4: 0,\n      d_5: 0,\n      d_6: 0\n    }\n  };\n  const thisWeekOrigin = getThisWeekOrigin();\n  for (const item of SemiTimeTable) {\n    if (PathAttributeId.indexOf(item.PathAttributeId) > -1) {\n      if (item.DateType === '0') {\n        const dayOfWeek = dateValueToDayOfWeek(item.DateValue);\n        const thisDayOrigin = offsetDate(thisWeekOrigin, dayOfWeek.day, 0, 0);\n        const thisPeriodStartTime = parseTimeCode(item.StartTime, 0);\n        const thisPeriodStartTimeDateObject = offsetDate(thisDayOrigin, 0, thisPeriodStartTime.hours, thisPeriodStartTime.minutes);\n        const thisPeriodEndTime = parseTimeCode(item.EndTime, 0);\n        const thisPeriodEndTimeDateObject = offsetDate(thisDayOrigin, 0, thisPeriodEndTime.hours, thisPeriodEndTime.minutes);\n        const thisPeriodDurationInMinutes = Math.abs(thisPeriodEndTime.hours * 60 + thisPeriodEndTime.minutes - (thisPeriodStartTime.hours * 60 + thisPeriodStartTime.minutes));\n\n        const minWindow = parseInt(item.LongHeadway);\n        const maxWindow = parseInt(item.LowHeadway);\n        const averageWindow = (maxWindow + minWindow) / 2;\n        const headwayQuantity = thisPeriodDurationInMinutes / averageWindow;\n\n        for (let i = 0; i < headwayQuantity; i++) {\n          let violateRules = false;\n          const thisHeadwayDate = offsetDate(thisDayOrigin, 0, thisPeriodStartTime.hours, thisPeriodStartTime.minutes + maxWindow * i);\n          if (thisHeadwayDate.getTime() < thisPeriodStartTimeDateObject.getTime()) {\n            violateRules = true;\n          }\n          if (thisHeadwayDate.getTime() > thisPeriodEndTimeDateObject.getTime()) {\n            violateRules = true;\n          }\n          // TODO: check timeTableRules\n          if (violateRules === false) {\n            calendar.calendarEventGroups[dayOfWeek.code].push({\n              date: thisHeadwayDate,\n              dateString: dateToString(thisHeadwayDate, 'hh:mm'),\n              duration: maxWindow,\n              deviation: Math.abs(averageWindow - maxWindow)\n            });\n            calendar.calendarEventQuantity[dayOfWeek.code] += 1;\n          }\n        }\n      }\n    }\n  }\n  for (const item of TimeTable) {\n    if (PathAttributeId.indexOf(item.PathAttributeId) > -1) {\n      if (item.DateType === '0') {\n        let violateRules = false;\n        const dayOfWeek = dateValueToDayOfWeek(item.DateValue);\n        const thisDayOrigin = offsetDate(thisWeekOrigin, dayOfWeek.day, 0, 0);\n        const thisDepartureTime = parseTimeCode(item.DepartureTime, 0);\n        const thisHeadwayDate = offsetDate(thisDayOrigin, 0, thisDepartureTime.hours, thisDepartureTime.minutes);\n        // TODO: check timeTableRules\n        if (violateRules === false) {\n          calendar.calendarEventGroups[dayOfWeek.code].push({\n            date: thisHeadwayDate,\n            dateString: dateToString(thisHeadwayDate, 'hh:mm'),\n            duration: 15,\n            deviation: 0\n          });\n          calendar.calendarEventQuantity[dayOfWeek.code] += 1;\n        }\n      }\n    }\n  }\n  for (const code in calendar.calendarEventGroups) {\n    calendar.calendarEventGroups[code].sort(function (a, b) {\n      return a.date.getTime() - b.date.getTime();\n    });\n  }\n  return calendar;\n}\n\nexport interface TimeTableRules {\n  go: {\n    weekday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n    holiday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n  };\n  back: {\n    weekday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n    holiday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n  };\n  realSequence: any;\n}\n\nfunction getTimeTableRules(thisRoute: RouteItem): TimeTableRules {\n  const thisRouteGoFirstBusTime = parseTimeCode(thisRoute.goFirstBusTime, 0);\n  const thisRouteGoLastBusTime = parseTimeCode(thisRoute.goLastBusTime, 0);\n\n  const thisRouteBackFirstBusTime = parseTimeCode(thisRoute.backFirstBusTime, 0);\n  const thisRouteBackLastBusTime = parseTimeCode(thisRoute.backLastBusTime, 0);\n\n  const thisRouteGoFirstBusTimeOnHoliday = parseTimeCode(thisRoute.holidayGoFirstBusTime, 0);\n  const thisRouteGoLastBusTimeOnHoliday = parseTimeCode(thisRoute.holidayGoLastBusTime, 0);\n\n  const thisRouteBackFirstBusTimeOnHoliday = parseTimeCode(thisRoute.holidayBackFirstBusTime, 0);\n  const thisRouteBackLastBusTimeOnHoliday = parseTimeCode(thisRoute.holidayBackLastBusTime, 0);\n\n  const rushHourWindow = parseTimeCode(thisRoute.peakHeadway, 1);\n  const offRushHourWindow = parseTimeCode(thisRoute.offPeakHeadway, 1);\n\n  const rushHourWindowOnHoliday = parseTimeCode(thisRoute.holidayPeakHeadway, 1);\n  const offRushHourWindowOnHoliday = parseTimeCode(thisRoute.holidayOffPeakHeadway, 1);\n  // window  the interval/gap between arrivals of buses\n\n  const realSequence = thisRoute.realSequence;\n  return {\n    go: {\n      weekday: {\n        first: thisRouteGoFirstBusTime,\n        last: thisRouteGoLastBusTime,\n        rushHourWindow: rushHourWindow,\n        offRushHourWindow: offRushHourWindow\n      },\n      holiday: {\n        first: thisRouteGoFirstBusTimeOnHoliday,\n        last: thisRouteGoLastBusTimeOnHoliday,\n        rushHourWindow: rushHourWindowOnHoliday,\n        offRushHourWindow: offRushHourWindowOnHoliday\n      }\n    },\n    back: {\n      weekday: {\n        first: thisRouteBackFirstBusTime,\n        last: thisRouteBackLastBusTime,\n        rushHourWindow: rushHourWindow,\n        offRushHourWindow: offRushHourWindow\n      },\n      holiday: {\n        first: thisRouteBackFirstBusTimeOnHoliday,\n        last: thisRouteBackLastBusTimeOnHoliday,\n        rushHourWindow: rushHourWindowOnHoliday,\n        offRushHourWindow: offRushHourWindowOnHoliday\n      }\n    },\n    realSequence: realSequence\n  };\n}\n\nexport interface integratedRouteDetailsProperty {\n  key: string;\n  icon: MaterialSymbols;\n  value: string;\n}\n\nexport type integratedRouteDetailsProperties = Array<integratedRouteDetailsProperty>;\n\nexport interface integratedRouteDetails {\n  timeTableRules: TimeTableRules;\n  calendar: Calendar;\n  properties: integratedRouteDetailsProperties;\n}\n\nexport async function integrateRouteDetails(RouteID: number, PathAttributeId: Array<number>, requestID: string): Promise<integratedRouteDetails> {\n  const Route = (await getRoute(requestID, false)) as Route;\n  const thisRoute = findRoute(Route, RouteID);\n\n  const SemiTimeTable = await getSemiTimeTable(requestID);\n  const TimeTable = await getTimeTable(requestID);\n  const Provider = await getProvider(requestID);\n  const timeTableRules = getTimeTableRules(thisRoute);\n  const calendar = generateCalendarFromTimeTables(RouteID, PathAttributeId, timeTableRules, SemiTimeTable, TimeTable);\n  const thisProviderId = thisRoute.providerId;\n  const thisProvider = findProvider(Provider, thisProviderId);\n\n  const result: integratedRouteDetails = {\n    timeTableRules: timeTableRules,\n    calendar: calendar,\n    properties: [\n      {\n        key: 'route_name',\n        icon: 'route',\n        value: thisRoute.nameZh\n      },\n      {\n        key: 'pricing',\n        icon: 'attach_money',\n        value: thisRoute.ticketPriceDescriptionZh\n      },\n      {\n        key: 'provider_name',\n        icon: 'corporate_fare',\n        value: thisProvider.nameZn\n      },\n      {\n        key: 'provider_phone',\n        icon: 'call',\n        value: thisProvider.phoneInfo\n      },\n      {\n        key: 'provider_email',\n        icon: 'alternate_email',\n        value: thisProvider.email\n      }\n    ]\n  };\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n","import { generateRoundedRectPath } from './graphic';\n\nconst QRCode = require('qrcode/lib/core/qrcode');\n\nexport type QRCodeErrorCorrectionLevel = 'L' | 'M' | 'Q' | 'H';\n\n/**\n * Generate a QR code matrix (2D Boolean array)\n * @param text The input text to encode\n * @param errorCorrectionLevel L, M, Q, H\n * @returns 2D array (1 = filled, 0 = blank)\n */\n\nexport function generateQRCodeMatrix(text: string, errorCorrectionLevel: QRCodeErrorCorrectionLevel): Array<Array<0 | 1>> {\n  const qrData = QRCode.create(text, {\n    errorCorrectionLevel: errorCorrectionLevel\n  });\n\n  const size = qrData.modules.size;\n  const matrix = [];\n\n  for (let y = 0; y < size; y++) {\n    const row = [];\n    for (let x = 0; x < size; x++) {\n      const bit = qrData.modules.get(x, y);\n      row.push(bit);\n    }\n    matrix.push(row);\n  }\n\n  return matrix;\n}\n\nexport function generateRoundedQRCodeSVG(text: string, errorCorrectionLevel: QRCodeErrorCorrectionLevel = 'L', outerRadius: number = 0.5, innerRadius: number = 0.3, padding: number = 1, fill: string = '#000000', scale: number = 4): string {\n  const filledNeighborhood = [\n    [\n      [-1, 0],\n      [0, -1]\n    ], // top-left\n    [\n      [0, -1],\n      [1, 0]\n    ], // top-right\n    [\n      [1, 0],\n      [0, 1]\n    ], // bottom-right\n    [\n      [0, 1],\n      [-1, 0]\n    ] // bottom-left\n  ];\n\n  const blankNeighborhood = [\n    [\n      [-1, 0],\n      [-1, -1],\n      [0, -1]\n    ],\n    [\n      [0, -1],\n      [1, -1],\n      [1, 0]\n    ],\n    [\n      [1, 0],\n      [1, 1],\n      [0, 1]\n    ],\n    [\n      [0, 1],\n      [-1, 1],\n      [-1, 0]\n    ]\n  ];\n\n  // [x, y]\n\n  const data = generateQRCodeMatrix(text, errorCorrectionLevel);\n  const size = data.length;\n\n  let commands: Array<string> = [];\n\n  for (let y = 0; y < size; y++) {\n    for (let x = 0; x < size; x++) {\n      if (data[y][x] === 1) {\n        // filled\n        const cornerRadius = new Uint8Array(4);\n        for (let k = 0; k < 4; k++) {\n          const neighbors = filledNeighborhood[k];\n          let displayed = 1;\n          for (const neighbor of neighbors) {\n            if (data[y + neighbor[1]]?.[x + neighbor[0]] === 1) {\n              displayed *= 0;\n            }\n          }\n          cornerRadius[k] = displayed;\n        }\n        commands = commands.concat(\n          generateRoundedRectPath(\n            (x + padding) * scale,\n            (y + padding) * scale,\n            1 * scale,\n            1 * scale,\n            {\n              tl: cornerRadius[0] * outerRadius * scale,\n              tr: cornerRadius[1] * outerRadius * scale,\n              br: cornerRadius[2] * outerRadius * scale,\n              bl: cornerRadius[3] * outerRadius * scale\n            },\n            false\n          )\n        );\n      } else {\n        // blank\n        const cornerRadius = new Uint8Array(4);\n        for (let k = 0; k < 4; k++) {\n          const neighbors = blankNeighborhood[k];\n          let displayed = 1;\n          for (const neighbor of neighbors) {\n            if (!data[y + neighbor[1]]?.[x + neighbor[0]]) {\n              displayed *= 0;\n            }\n          }\n          cornerRadius[k] = displayed;\n        }\n        if (cornerRadius.some((r) => r !== 0)) {\n          commands = commands.concat(\n            generateRoundedRectPath(\n              (x + padding) * scale,\n              (y + padding) * scale,\n              1 * scale,\n              1 * scale,\n              {\n                tl: cornerRadius[0] * innerRadius * scale,\n                tr: cornerRadius[1] * innerRadius * scale,\n                br: cornerRadius[2] * innerRadius * scale,\n                bl: cornerRadius[3] * innerRadius * scale\n              },\n              true\n            )\n          );\n        }\n      }\n    }\n  }\n\n  return `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${(size + padding * 2) * scale} ${(size + padding * 2) * scale}\" shape-rendering=\"geometricPrecision\"><path d=\"${commands.join(' ')}\" fill=\"${fill}\" stroke=\"${fill}\" stroke-width=\"0.1\" stroke-linejoin=\"round\" fill-rule=\"nonzero\" /></svg>`;\n}\n","import { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { generateRoundedQRCodeSVG } from '../../tools/qrcode';\nimport { pushPageHistory, revokePageHistory } from '../index';\n\nconst QRCodeField = documentQuerySelector('.css_qrcode_field');\nconst QRCodeBodyElement = elementQuerySelector(QRCodeField, '.css_qrcode_body');\n\nexport function initializeQRCodeField(text: string): void {\n  const svg = generateRoundedQRCodeSVG(text, 'M', 0.5, 0.3, 1, 'var(--b-cssvar-333333)', 4);\n  QRCodeBodyElement.innerHTML = svg;\n}\n\nexport function openQRCode(text: string): void {\n  pushPageHistory('QRCode');\n  QRCodeField.setAttribute('displayed', 'true');\n  initializeQRCodeField(text);\n  // closePreviousPage();\n}\n\nexport function closeQRCode(): void {\n  revokePageHistory('QRCode');\n  QRCodeField.setAttribute('displayed', 'false');\n  // openPreviousPage();\n}\n","import { searchRouteByRouteID } from '../../../data/search/index';\nimport { getPermalink } from '../../../tools/permalink';\nimport { promptMessage } from '../../prompt/index';\nimport { openQRCode } from '../../qrcode/index';\n\nexport async function shareRoutePermalink(RouteID: number) {\n  const thisRoute = await searchRouteByRouteID(RouteID);\n  if (thisRoute !== false) {\n    const link = getPermalink(0, {\n      id: RouteID,\n      name: thisRoute.n\n    });\n    if (navigator.share) {\n      navigator\n        .share({\n          title: thisRoute.n,\n          url: link\n        })\n        .then(() => {\n          promptMessage('check_circle', '');\n        })\n        .catch((e) => {\n          promptMessage('cancel', '');\n          console.error(e);\n        });\n    }\n  }\n}\n\nexport async function showRoutePermalinkQRCode(RouteID: number) {\n  const thisRoute = await searchRouteByRouteID(RouteID);\n  if (thisRoute !== false) {\n    const link = getPermalink(0, {\n      id: RouteID,\n      name: thisRoute.n\n    });\n    openQRCode(link);\n  }\n}\n","import { Calendar, CalendarDay, CalendarEvent, CalendarEventGroup } from '../../../data/route/details';\nimport { getSettingOptionValue } from '../../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { drawRoundedRect } from '../../../tools/graphic';\nimport { booleanToString } from '../../../tools/index';\nimport { getCSSVariableValue } from '../../../tools/style';\nimport { GeneratedElement, querySize } from '../../index';\nimport { CalendarDaysElement, CalendarEventGroupsElement } from './index';\n\nconst calendarRatio = 70;\nconst scaleLimit = 3150 / (calendarRatio * 24);\nconst gridlineBoxHeight = 10;\nconst gridlineWidth = 1.2;\nconst gridlineLabelWidthLimit = 45;\nconst fontFamily: string = '\"Noto Sans TC\", sans-serif';\n\nlet canvasSize = querySize('route-details-canvas');\nlet canvasWidth = canvasSize.width;\nlet canvasHeight = canvasSize.height;\nlet canvasScale = Math.min(window.devicePixelRatio, scaleLimit) || 1;\n\nlet previousCalendar = {} as Calendar;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nfunction resizeRouteDetailsCalendarCanvas(canvas: HTMLCanvasElement): void {\n  canvasSize = querySize('route-details-canvas');\n  canvasWidth = canvasSize.width;\n  canvasHeight = canvasSize.height;\n  canvasScale = Math.min(window.devicePixelRatio, scaleLimit) || 1;\n\n  // Set the new size\n  canvas.width = canvasWidth * canvasScale;\n  canvas.height = canvasHeight * canvasScale;\n\n  // Reset transformations before scaling\n  const context = canvas.getContext('2d');\n  context.setTransform(1, 0, 0, 1, 0, 0);\n  context.scale(canvasScale, canvasScale);\n}\n\nfunction generateElementOfDay(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_route_details_calendar_day');\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction generateElementOfEventGroup(): GeneratedElement {\n  // Main event group element\n  const eventGroupElement = document.createElement('div');\n  eventGroupElement.classList.add('css_route_details_calendar_event_group');\n\n  // Canvas element\n  const canvasElement = document.createElement('canvas');\n  canvasElement.classList.add('css_route_details_calendar_event_group_canvas');\n  eventGroupElement.appendChild(canvasElement);\n\n  return {\n    element: eventGroupElement,\n    id: ''\n  };\n}\n\nexport function setUpCalendarGroupSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultEventQuantity = {\n    d_0: 47,\n    d_1: 47,\n    d_2: 47,\n    d_3: 47,\n    d_4: 47,\n    d_5: 47,\n    d_6: 47\n  };\n  const defaultDayQuantity = 7;\n  let calendarEventGroups = {};\n  let calendarDays = {};\n  for (let i = 0; i < defaultDayQuantity; i++) {\n    const eventGroupKey = `d_${i}`;\n    calendarEventGroups[eventGroupKey] = [];\n    calendarDays[eventGroupKey] = {\n      day: i,\n      code: `d_{i}`,\n      name: ''\n    };\n    for (let j = 0; j < defaultEventQuantity[eventGroupKey]; j++) {\n      const date = new Date();\n      date.setHours(0);\n      date.setMinutes(j * 30);\n      date.setSeconds(0);\n      date.setMilliseconds(0);\n      calendarEventGroups[eventGroupKey].push({\n        date: date,\n        dateString: '',\n        duration: 15\n      });\n    }\n  }\n  updateCalendarGroup(\n    {\n      calendarEventGroups: calendarEventGroups,\n      calendarDays: calendarDays,\n      calendarDayQuantity: defaultDayQuantity,\n      calendarEventQuantity: defaultEventQuantity\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateDay(thisDayElement: HTMLElement, thisDay: CalendarDay, currentDay: number, skeletonScreen: boolean, animation: boolean, index: number): void {\n  thisDayElement.innerText = thisDay.name;\n  thisDayElement.setAttribute('day', index.toString());\n  thisDayElement.onclick = function () {\n    switchCalendarDay(index);\n  };\n  thisDayElement.setAttribute('highlighted', currentDay === index ? 'true' : 'false');\n  thisDayElement.setAttribute('animation', booleanToString(animation));\n  thisDayElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n}\n\nfunction updateEventGroup(thisCalendarEventGroupElement: HTMLElement, thisCalendarEventGroup: CalendarEventGroup, currentDay: number, mainColor: string, mainColorR: string, mainColorG: string, mainColorB: string, mainColorA: string, gridColor: string, index: number): void {\n  function drawGridline(thisContext: CanvasRenderingContext2D, hours: number, gridColor: string): void {\n    const boxX = 0;\n    const boxY = hours * calendarRatio;\n\n    // Cache the color value once\n    thisContext.fillStyle = gridColor;\n\n    // Draw line\n    thisContext.fillRect(boxX + gridlineLabelWidthLimit, boxY + 5, canvasWidth - gridlineLabelWidthLimit, gridlineWidth);\n\n    // Draw label\n    thisContext.font = `400 ${12}px ${fontFamily}`;\n    thisContext.textBaseline = 'top';\n    const labelText = `${String(hours).padStart(2, '0')}:00`;\n    const labelMeasurement = thisContext.measureText(labelText);\n    const labelWidth = labelMeasurement.width;\n    const labelHeight = labelMeasurement.actualBoundingBoxDescent;\n    thisContext.fillText(labelText, (gridlineLabelWidthLimit - labelWidth) / 2, boxY + (gridlineBoxHeight - labelHeight) / 2, labelWidth);\n  }\n\n  function drawEvent(thisContext: CanvasRenderingContext2D, thisCalendarEvent: CalendarEvent, mainColor: string, mainColorR: string, mainColorG: string, mainColorB: string, mainColorA: string): void {\n    // Calculate the start of the day for this event only once.\n    const thisDayStart = new Date();\n    thisDayStart.setDate(1);\n    thisDayStart.setMonth(0);\n    thisDayStart.setFullYear(thisCalendarEvent.date.getFullYear());\n    thisDayStart.setMonth(thisCalendarEvent.date.getMonth());\n    thisDayStart.setDate(thisCalendarEvent.date.getDate());\n    thisDayStart.setHours(0);\n    thisDayStart.setMinutes(0);\n    thisDayStart.setSeconds(0);\n    thisDayStart.setMilliseconds(0);\n\n    const boxX = gridlineLabelWidthLimit;\n    const boxY = ((thisCalendarEvent.date.getTime() - thisDayStart.getTime()) / (24 * 60 * 60 * 1000)) * 24 * calendarRatio;\n    const boxWidth = canvasWidth - gridlineLabelWidthLimit;\n    const boxHeight = ((thisCalendarEvent.duration * 60 * 1000) / (24 * 60 * 60 * 1000)) * 24 * calendarRatio;\n\n    // Draw background with rounded rectangle\n    drawRoundedRect(thisContext, boxX, boxY, boxWidth, boxHeight, 3, `rgba(${mainColorR}, ${mainColorG}, ${mainColorB}, ${mainColorA})`);\n\n    // Draw decoration (a thin rounded rectangle)\n    drawRoundedRect(thisContext, boxX, boxY, 3, boxHeight, { tl: 3, tr: 0, bl: 3, br: 0 }, mainColor);\n\n    // Draw event text\n    thisContext.font = `400 ${14}px ${fontFamily}`;\n    thisContext.textBaseline = 'top';\n    thisContext.fillStyle = mainColor;\n    const text = thisCalendarEvent.dateString;\n    const textMeasurement = thisContext.measureText(text);\n    const textWidth = textMeasurement.width;\n    const textHeight = textMeasurement.actualBoundingBoxDescent;\n    thisContext.fillText(text, boxX + 8, boxY + (boxHeight - textHeight) / 2, textWidth);\n  }\n\n  function updateDisplayed(thisCalendarEventGroupElement: HTMLElement, currentDay: number, index: number): void {\n    // Set the displayed attribute based on whether it is the current day.\n    const isDisplayed = currentDay === index;\n    thisCalendarEventGroupElement.setAttribute('displayed', booleanToString(isDisplayed));\n  }\n\n  // Get the canvas and its 2D context.\n  const thisCalendarEventGroupCanvas = elementQuerySelector(thisCalendarEventGroupElement, '.css_route_details_calendar_event_group_canvas') as HTMLCanvasElement;\n  const thisCalendarEventGroupCanvasContext = thisCalendarEventGroupCanvas.getContext('2d');\n\n  // Update the displayed attribute\n  updateDisplayed(thisCalendarEventGroupElement, currentDay, index);\n\n  // Always resize the canvas to ensure proper dimensions.\n  resizeRouteDetailsCalendarCanvas(thisCalendarEventGroupCanvas);\n\n  const isDisplayed = currentDay === index;\n  if (isDisplayed) {\n    // Clear the canvas and redraw the content when displayed.\n    thisCalendarEventGroupCanvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n\n    // Draw the gridlines.\n    for (let hours = 0; hours < 24; hours++) {\n      drawGridline(thisCalendarEventGroupCanvasContext, hours, gridColor);\n    }\n\n    // Draw all events for this group.\n    for (const thisCalendarEvent of thisCalendarEventGroup) {\n      drawEvent(thisCalendarEventGroupCanvasContext, thisCalendarEvent, mainColor, mainColorR, mainColorG, mainColorB, mainColorA);\n    }\n  } else {\n    // When not displayed, clear the canvas.\n    thisCalendarEventGroupCanvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  }\n}\n\nexport function updateCalendarGroup(calendar: Calendar, skeletonScreen: boolean, animation: boolean): void {\n  // The default day to display.\n  const currentDay = new Date().getDay();\n\n  // Retrieve the CSS variable values just once\n  const mainColorR = getCSSVariableValue('--b-cssvar-main-color-r');\n  const mainColorG = getCSSVariableValue('--b-cssvar-main-color-g');\n  const mainColorB = getCSSVariableValue('--b-cssvar-main-color-b');\n  const mainColorA = getCSSVariableValue('--b-cssvar-main-color-opacity-e');\n  const mainColor = getCSSVariableValue('--b-cssvar-main-color');\n  const gridColor = getCSSVariableValue('--b-cssvar-ededf2');\n\n  const eventGroups = calendar.calendarDays;\n  const eventGroupQuantity = calendar.calendarDayQuantity;\n  const calendarEventGroups = calendar.calendarEventGroups;\n  const eventQuantity = calendar.calendarEventQuantity;\n\n  const currentEventGroupCapacity = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group').length;\n  if (eventGroupQuantity !== currentEventGroupCapacity) {\n    const difference = currentEventGroupCapacity - eventGroupQuantity;\n    if (difference < 0) {\n      // Add missing day and event group elements.\n      const calendarDaysFragment = new DocumentFragment();\n      const calendarEventGroupsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newDayElement = generateElementOfDay();\n        calendarDaysFragment.appendChild(newDayElement.element);\n        const newEventGroupElement = generateElementOfEventGroup();\n        calendarEventGroupsFragment.appendChild(newEventGroupElement.element);\n      }\n      CalendarDaysElement.append(calendarDaysFragment);\n      CalendarEventGroupsElement.append(calendarEventGroupsFragment);\n    } else {\n      // Remove extra elements.\n      const CalendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n      const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const eventGroupIndex = currentEventGroupCapacity - 1 - o;\n        CalendarDayElements[eventGroupIndex].remove();\n        CalendarEventGroupElements[eventGroupIndex].remove();\n      }\n    }\n  }\n\n  // Update each day and its corresponding event group.\n  const CalendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n  const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n  for (let i = 0; i < eventGroupQuantity; i++) {\n    const eventGroupKey = `d_${i}`;\n    const thisDay = eventGroups[eventGroupKey];\n    const thisEventGroup = calendarEventGroups[eventGroupKey];\n\n    const thisDayElement = CalendarDayElements[i];\n    const thisEventGroupElement = CalendarEventGroupElements[i];\n\n    updateDay(thisDayElement, thisDay, currentDay, skeletonScreen, animation, i);\n    updateEventGroup(thisEventGroupElement, thisEventGroup, currentDay, mainColor, mainColorR, mainColorG, mainColorB, mainColorA, gridColor, i);\n  }\n\n  previousCalendar = calendar;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nexport function switchCalendarDay(day: number): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const calendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n  const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n  for (let i = 0; i < 7; i++) {\n    const thisCalendarDayElement = calendarDayElements[i];\n    // const thisCalendarDayElementDay = parseInt(thisCalendarDayElement.getAttribute('day'));\n    const thisEventGroupElement = CalendarEventGroupElements[i];\n    // if (thisCalendarDayElementDay === day) {\n    /*\n      thisCalendarDayElement.setAttribute('highlighted', 'true');\n      thisEventGroupElement.setAttribute('displayed', 'true');\n      */\n    const eventGroupKey = `d_${i}`;\n    const calendarEventGroup = previousCalendar?.calendarEventGroups[eventGroupKey];\n    const calendarDay = previousCalendar?.calendarDays[eventGroupKey];\n    if (calendarEventGroup && calendarDay) {\n      // Retrieve the CSS variable values just once\n      const mainColorR = getCSSVariableValue('--b-cssvar-main-color-r');\n      const mainColorG = getCSSVariableValue('--b-cssvar-main-color-g');\n      const mainColorB = getCSSVariableValue('--b-cssvar-main-color-b');\n      const mainColorA = getCSSVariableValue('--b-cssvar-main-color-opacity-e');\n      const mainColor = getCSSVariableValue('--b-cssvar-main-color');\n      const gridColor = getCSSVariableValue('--b-cssvar-ededf2');\n\n      // Reuse the drawing logic from updateEventGroup and updateDay for the visible event group.\n      updateDay(thisCalendarDayElement, calendarDay, day, false, playing_animation, i);\n      updateEventGroup(thisEventGroupElement, calendarEventGroup, day, mainColor, mainColorR, mainColorG, mainColorB, mainColorA, gridColor, i);\n    }\n    /*} else {\n      thisCalendarDayElement.setAttribute('highlighted', 'false');\n      thisEventGroupElement.setAttribute('displayed', 'false');\n\n      // Clear the canvas for non-displayed elements.\n      const canvas = elementQuerySelector(thisEventGroupElement, '.css_route_details_calendar_event_group_canvas') as HTMLCanvasElement;\n      const ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n    }*/\n  }\n}\n","import { getSettingOptionValue } from '../../../data/settings/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { booleanToString, compareThings } from '../../../tools/index';\nimport { getBlankIconElement, setIcon } from '../../icons/index';\nimport { GeneratedElement } from '../../index';\nimport { PropertiesGroupBodyElement, PropertiesGroupElement } from './index';\n\nlet previousProperties = [];\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nfunction generateElementOfProperty(): GeneratedElement {\n  const propertyElement = document.createElement('div');\n  propertyElement.classList.add('css_route_details_property');\n\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_route_details_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n  propertyElement.appendChild(iconElement);\n\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_route_details_property_value');\n  propertyElement.appendChild(valueElement);\n\n  return {\n    element: propertyElement,\n    id: ''\n  };\n}\n\nexport function setUppropertiesGroupSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultPropertyQuantity = 5;\n  const properties = [];\n  for (let i = 0; i < defaultPropertyQuantity; i++) {\n    properties.push({\n      key: i,\n      icon: 'none',\n      value: ''\n    });\n  }\n  updatePropertiesField(properties, true, playing_animation);\n}\n\nexport function updatePropertiesField(properties: Array, skeletonScreen: boolean, animation: boolean): void {\n  function updateProperty(thisElement: HTMLElement, thisProperty: object, previousProperty: object): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: object): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_route_details_property_icon');\n      setIcon(thisIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: object): void {\n      elementQuerySelector(thisElement, '.css_route_details_property_value').innerText = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (previousAnimation !== animation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (previousSkeletonScreen !== skeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const propertyQuantity = properties.length;\n\n  if (skeletonScreen !== previousSkeletonScreen) {\n    PropertiesGroupElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  const currentPropertyCapacity = elementQuerySelectorAll(PropertiesGroupBodyElement, '.css_route_details_property').length;\n  if (propertyQuantity !== currentPropertyCapacity) {\n    const difference = currentPropertyCapacity - propertyQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        // const propertyIndex = currentPropertyCapacity + o;\n        const newPropertyElement = generateElementOfProperty();\n        fragment.appendChild(newPropertyElement.element);\n      }\n      PropertiesGroupBodyElement.append(fragment);\n    } else {\n      const propertyElements = elementQuerySelectorAll(PropertiesGroupBodyElement, '.css_route_details_property');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const propertyIndex = currentPropertyCapacity - 1 - o;\n        propertyElements[propertyIndex].remove();\n      }\n    }\n  }\n\n  const propertyElements = elementQuerySelectorAll(PropertiesGroupBodyElement, '.css_route_details_property');\n  for (let i = 0; i < propertyQuantity; i++) {\n    const thisPropertyElement = propertyElements[i];\n    const thisProperty = properties[i];\n    if (previousProperties.length === 0) {\n      updateProperty(thisPropertyElement, thisProperty, null);\n    } else {\n      updateProperty(thisPropertyElement, thisProperty, previousProperties[i]);\n    }\n  }\n\n  previousProperties = properties;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n","import { isFolderContentSaved } from '../../../data/folder/index';\nimport { integrateRouteDetails } from '../../../data/route/details';\nimport { getSettingOptionValue } from '../../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { booleanToString, generateIdentifier } from '../../../tools/index';\nimport { pushPageHistory, revokePageHistory } from '../../index';\nimport { openSaveToFolder } from '../../save-to-folder/index';\nimport { shareRoutePermalink, showRoutePermalinkQRCode } from './actions';\nimport { setUpCalendarGroupSkeletonScreen, updateCalendarGroup } from './calendar';\nimport { setUppropertiesGroupSkeletonScreen, updatePropertiesField } from './properties';\n\nexport const RouteDetailsField = documentQuerySelector('.css_route_details_field');\nexport const RouteDetailsBodyElement = elementQuerySelector(RouteDetailsField, '.css_route_details_body');\nexport const RouteDetailsGroupsElement = elementQuerySelector(RouteDetailsBodyElement, '.css_route_details_groups');\n\nexport const CalendarGroupElement = elementQuerySelector(RouteDetailsGroupsElement, '.css_route_details_group[group=\"calendar\"]');\nexport const CalendarGroupBodyElement = elementQuerySelector(CalendarGroupElement, '.css_route_details_group_body');\nexport const CalendarDaysElement = elementQuerySelector(CalendarGroupBodyElement, '.css_route_details_calendar_days');\nexport const CalendarEventGroupsElement = elementQuerySelector(CalendarGroupBodyElement, '.css_route_details_calendar_event_groups');\n\nexport const ActionsGroupElement = elementQuerySelector(RouteDetailsField, '.css_route_details_body .css_route_details_groups .css_route_details_group[group=\"actions\"]');\nexport const svaeToFolderActionButtonElement = elementQuerySelector(ActionsGroupElement, '.css_route_details_group_body .css_route_details_action_button[action=\"save-to-folder\"]');\nexport const getPermalinkActionButton = elementQuerySelector(ActionsGroupElement, '.css_route_details_group_body .css_route_details_action_button[action=\"get-permalink\"]');\nexport const showPermalinkQRCodeActionButton = elementQuerySelector(ActionsGroupElement, '.css_route_details_group_body .css_route_details_action_button[action=\"show-permalink-qrcode\"]');\n\nexport const PropertiesGroupElement = elementQuerySelector(RouteDetailsGroupsElement, '.css_route_details_group[group=\"properties\"]');\nexport const PropertiesGroupBodyElement = elementQuerySelector(PropertiesGroupElement, '.css_route_details_group_body');\n\nasync function initializeRouteDetailsField(RouteID: number, PathAttributeId: Array<number>) {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const existence = await isFolderContentSaved('route', RouteID);\n  svaeToFolderActionButtonElement.setAttribute('animation', booleanToString(playing_animation));\n  svaeToFolderActionButtonElement.setAttribute('highlighted', booleanToString(existence));\n  svaeToFolderActionButtonElement.onclick = function () {\n    openSaveToFolder('route', [RouteID]);\n  };\n  getPermalinkActionButton.setAttribute('animation', booleanToString(playing_animation));\n  getPermalinkActionButton.onclick = function () {\n    shareRoutePermalink(RouteID);\n  };\n  showPermalinkQRCodeActionButton.setAttribute('animation', booleanToString(playing_animation));\n  showPermalinkQRCodeActionButton.onclick = function () {\n    showRoutePermalinkQRCode(RouteID);\n  };\n  setUppropertiesGroupSkeletonScreen(PropertiesGroupElement);\n  setUpCalendarGroupSkeletonScreen();\n  const requestID = generateIdentifier();\n  const integration = await integrateRouteDetails(RouteID, PathAttributeId, requestID);\n  updatePropertiesField(integration.properties, false, playing_animation);\n  updateCalendarGroup(integration.calendar, false, playing_animation);\n}\n\nexport function openRouteDetails(RouteID: number, PathAttributeId: Array<number>): void {\n  pushPageHistory('RouteDetails');\n  RouteDetailsField.setAttribute('displayed', 'true');\n  initializeRouteDetailsField(RouteID, PathAttributeId);\n}\n\nexport function closeRouteDetails(): void {\n  revokePageHistory('RouteDetails');\n  RouteDetailsField.setAttribute('displayed', 'false');\n  const CalendarEventGroupElements = elementQuerySelectorAll(CalendarEventGroupsElement, '.css_route_details_calendar_event_group');\n  for (const CalendarEventGroupElement of CalendarEventGroupElements) {\n    CalendarEventGroupElement.remove();\n  }\n  const CalendarDayElements = elementQuerySelectorAll(CalendarDaysElement, '.css_route_details_calendar_day');\n  for (const CalendarDayElement of CalendarDayElements) {\n    CalendarDayElement.remove();\n  }\n}\n","import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { isFolderContentSaved } from '../../data/folder/index';\nimport { stopHasNotifcationSchedules } from '../../data/notification/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { IntegratedRoute, integratedStopItem, integrateRoute } from '../../data/route/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll, getElementsBelow } from '../../tools/elements';\nimport { getTextWidth } from '../../tools/graphic';\nimport { booleanToString, compareThings, generateIdentifier } from '../../tools/index';\nimport { indexToDay, timeObjectToString } from '../../tools/time';\nimport { getIconElement, getIconHTML } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, GroupStyles, openPreviousPage, pushPageHistory, querySize } from '../index';\nimport { promptMessage } from '../prompt/index';\nimport { openSaveToFolder } from '../save-to-folder/index';\nimport { openScheduleNotification } from '../schedule-notification/index';\nimport { openRouteDetails } from './details/index';\n\nconst RouteField = documentQuerySelector('.css_route_field');\nconst RouteHeadElement = elementQuerySelector(RouteField, '.css_route_head');\nconst RouteNameElement = elementQuerySelector(RouteHeadElement, '.css_route_name');\nconst RouteNameSpanElement = elementQuerySelector(RouteNameElement, 'span');\nconst RouteButtonRightElement = elementQuerySelector(RouteHeadElement, '.css_route_button_right');\nconst RouteUpdateTimerElement = elementQuerySelector(RouteHeadElement, '.css_route_update_timer_box .css_route_update_timer');\nconst RouteGroupTabsElement = elementQuerySelector(RouteHeadElement, '.css_route_group_tabs');\nconst RouteGroupTabsTrayElement = elementQuerySelector(RouteGroupTabsElement, '.css_route_group_tabs_tray');\nconst RouteGroupTabLineTrackElement = elementQuerySelector(RouteHeadElement, '.css_route_group_tab_line_track');\nconst RouteGroupTabLineElement = elementQuerySelector(RouteGroupTabLineTrackElement, '.css_route_group_tab_line');\nconst RouteGroupsElement = elementQuerySelector(RouteField, '.css_route_groups');\n\nlet previousIntegration = {} as IntegratedRoute;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet routeSliding_initialIndex: number = 0;\nlet routeSliding_targetIndex: number = 0;\nlet routeSliding_groupQuantity: number = 0;\nlet routeSliding_groupStyles: GroupStyles = {};\nlet routeSliding_fieldWidth: number = 0;\nlet routeSliding_fieldHeight: number = 0;\nlet routeSliding_sliding: boolean = false;\n\nlet routeRefreshTimer_retryInterval: number = 10 * 1000;\nlet routeRefreshTimer_baseInterval: number = 15 * 1000;\nlet routeRefreshTimer_minInterval: number = 5 * 1000;\nlet routeRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet routeRefreshTimer_dynamic: boolean = true;\nlet routeRefreshTimer_lastUpdate: number = 0;\nlet routeRefreshTimer_nextUpdate: number = 0;\nlet routeRefreshTimer_currentRequestID: string = '';\nlet routeRefreshTimer_refreshing: boolean = false;\nlet routeRefreshTimer_streaming: boolean = false;\nlet routeRefreshTimer_streamStarted: boolean = false;\n\nlet currentRouteIDSet_RouteID: number = 0;\nlet currentRouteIDSet_PathAttributeId: Array<number> = [];\n\nlet tabPadding: number = 20;\n\nexport function initializeRouteSliding(): void {\n  RouteGroupsElement.addEventListener(\n    'touchstart',\n    function () {\n      routeSliding_initialIndex = Math.round(RouteGroupsElement.scrollLeft / routeSliding_fieldWidth);\n    },\n    { passive: true }\n  );\n\n  RouteGroupsElement.addEventListener(\n    'scroll',\n    function (event: Event) {\n      routeSliding_sliding = true;\n      const target = event.target as HTMLElement;\n      const currentIndex = target.scrollLeft / routeSliding_fieldWidth;\n      if (currentIndex > routeSliding_initialIndex) {\n        routeSliding_targetIndex = routeSliding_initialIndex + 1;\n      } else {\n        routeSliding_targetIndex = routeSliding_initialIndex - 1;\n      }\n      const indexDifference = currentIndex - routeSliding_initialIndex;\n      let delta = Math.abs(indexDifference);\n      if (delta > 1) {\n        if (indexDifference > 0) {\n          routeSliding_initialIndex = Math.floor(currentIndex);\n          routeSliding_targetIndex = routeSliding_initialIndex + 1;\n        } else {\n          routeSliding_initialIndex = Math.ceil(currentIndex);\n          routeSliding_targetIndex = routeSliding_initialIndex - 1;\n        }\n        delta = Math.abs(currentIndex - routeSliding_initialIndex);\n      }\n      const initialSize = routeSliding_groupStyles[`g_${routeSliding_initialIndex}`] || { width: 0, offset: 0 };\n      const targetSize = routeSliding_groupStyles[`g_${routeSliding_targetIndex}`] || { width: 0, offset: 0 };\n      const tabWidth = initialSize.width + (targetSize.width - initialSize.width) * delta;\n      const offset = (initialSize.offset + (targetSize.offset - initialSize.offset) * delta) * -1 + routeSliding_fieldWidth * 0.5 - tabWidth * 0.5;\n      updateRouteCSS(routeSliding_groupQuantity, offset, tabWidth - tabPadding, currentIndex);\n      if (currentIndex === routeSliding_targetIndex) {\n        routeSliding_initialIndex = Math.round(RouteGroupsElement.scrollLeft / routeSliding_fieldWidth);\n        routeSliding_sliding = false;\n      }\n    },\n    { passive: true }\n  );\n}\n\nexport function updateRouteCSS(groupQuantity: number, offset: number, tabLineWidth: number, percentage: number): void {\n  RouteGroupsElement.style.setProperty('--b-cssvar-route-group-quantity', groupQuantity.toString());\n  RouteGroupTabLineElement.style.setProperty('--b-cssvar-route-tab-line-width-scale', tabLineWidth.toString());\n  RouteGroupTabsTrayElement.style.setProperty('--b-cssvar-route-tabs-tray-offset', `${offset.toString()}px`);\n  RouteGroupTabsTrayElement.style.setProperty('--b-cssvar-route-percentage', percentage.toString());\n}\n\nfunction animateUpdateTimer(): void {\n  RouteUpdateTimerElement.style.setProperty('--b-cssvar-route-update-timer-interval', `${routeRefreshTimer_dynamicInterval}ms`);\n  RouteUpdateTimerElement.classList.add('css_route_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (routeRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    RouteUpdateTimerElement.style.setProperty('--b-cssvar-route-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfThreadBox(): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main thread box element\n  const threadBoxElement = document.createElement('div');\n  threadBoxElement.classList.add('css_route_group_thread_box');\n  threadBoxElement.id = identifier;\n  threadBoxElement.setAttribute('stretched', 'false');\n  threadBoxElement.setAttribute('stretching', 'false');\n  threadBoxElement.setAttribute('push-direction', '0'); // 0: normal state, 1: downward, 2: upward\n  threadBoxElement.setAttribute('push-state', '0'); // 0: normal state, 1: compensation , 2: transition\n\n  // Thread container\n  const threadElement = document.createElement('div');\n  threadElement.classList.add('css_route_group_thread');\n\n  // Thread progress\n  const threadProgressElement = document.createElement('div');\n  threadProgressElement.classList.add('css_route_group_thread_progress');\n  threadProgressElement.setAttribute('displayed', 'false');\n  threadElement.appendChild(threadProgressElement);\n\n  // Thread status container\n  const threadStatusElement = document.createElement('div');\n  threadStatusElement.classList.add('css_route_group_thread_status');\n\n  // Next slide\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n  threadStatusElement.appendChild(nextSlideElement);\n\n  // Current slide\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n  threadStatusElement.appendChild(currentSlideElement);\n\n  // Assemble\n  threadBoxElement.appendChild(threadElement);\n  threadBoxElement.appendChild(threadStatusElement);\n\n  return {\n    element: threadBoxElement,\n    id: identifier\n  };\n}\n\nfunction generateElementOfItem(threadBoxIdentifier: string): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main item element\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_route_group_item');\n  itemElement.id = identifier;\n  itemElement.setAttribute('stretched', 'false');\n  itemElement.setAttribute('stretching', 'false');\n  itemElement.setAttribute('push-direction', '0'); // 0: normal state, 1: downward, 2: upward\n  itemElement.setAttribute('push-state', '0'); // 0: normal state, 1: compensation , 2: transition\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_route_group_item_head');\n\n  // Name\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_route_group_item_name');\n  headElement.appendChild(nameElement);\n\n  // Capsule\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_route_group_item_capsule');\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_route_group_item_status');\n\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n  statusElement.appendChild(nextSlideElement);\n\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n  statusElement.appendChild(currentSlideElement);\n\n  capsuleElement.appendChild(statusElement);\n\n  // Stretch button\n  const stretchElement = document.createElement('div');\n  stretchElement.classList.add('css_route_group_item_stretch');\n  stretchElement.appendChild(getIconElement('keyboard_arrow_down'));\n  stretchElement.onclick = () => {\n    stretchRouteItem(identifier, threadBoxIdentifier);\n  };\n  capsuleElement.appendChild(stretchElement);\n\n  // Capsule separator\n  const capsuleSeparatorElement = document.createElement('div');\n  capsuleSeparatorElement.classList.add('css_route_group_item_capsule_separator');\n  capsuleElement.appendChild(capsuleSeparatorElement);\n\n  headElement.appendChild(capsuleElement);\n\n  // Body\n  const bodyElement = document.createElement('div');\n  bodyElement.classList.add('css_route_group_item_body');\n  bodyElement.setAttribute('displayed', 'false');\n\n  // Buttons\n  const buttonsElement = document.createElement('div');\n  buttonsElement.classList.add('css_route_group_item_buttons');\n\n  // Tab: \n  const tabBusElement = document.createElement('div');\n  tabBusElement.classList.add('css_route_group_item_button');\n  tabBusElement.setAttribute('highlighted', 'true');\n  tabBusElement.setAttribute('type', 'tab');\n  tabBusElement.setAttribute('code', '0');\n  tabBusElement.onclick = () => {\n    switchRouteBodyTab(identifier, 0);\n  };\n\n  const tabBusIconElement = document.createElement('div');\n  tabBusIconElement.classList.add('css_route_group_item_button_icon');\n  tabBusIconElement.appendChild(getIconElement('directions_bus'));\n  tabBusElement.appendChild(tabBusIconElement);\n  tabBusElement.appendChild(document.createTextNode(''));\n  buttonsElement.appendChild(tabBusElement);\n\n  // Tab: \n  const tabArrivalElement = document.createElement('div');\n  tabArrivalElement.classList.add('css_route_group_item_button');\n  tabArrivalElement.setAttribute('highlighted', 'false');\n  tabArrivalElement.setAttribute('type', 'tab');\n  tabArrivalElement.setAttribute('code', '1');\n  tabArrivalElement.onclick = () => {\n    switchRouteBodyTab(identifier, 1);\n  };\n\n  const tabArrivalIconElement = document.createElement('div');\n  tabArrivalIconElement.classList.add('css_route_group_item_button_icon');\n  tabArrivalIconElement.appendChild(getIconElement('departure_board'));\n  tabArrivalElement.appendChild(tabArrivalIconElement);\n  tabArrivalElement.appendChild(document.createTextNode(''));\n  buttonsElement.appendChild(tabArrivalElement);\n\n  // Tab: \n  const tabRouteElement = document.createElement('div');\n  tabRouteElement.classList.add('css_route_group_item_button');\n  tabRouteElement.setAttribute('highlighted', 'false');\n  tabRouteElement.setAttribute('type', 'tab');\n  tabRouteElement.setAttribute('code', '2');\n  tabRouteElement.onclick = () => {\n    switchRouteBodyTab(identifier, 2);\n  };\n\n  const tabRouteIconElement = document.createElement('div');\n  tabRouteIconElement.classList.add('css_route_group_item_button_icon');\n  tabRouteIconElement.appendChild(getIconElement('route'));\n  tabRouteElement.appendChild(tabRouteIconElement);\n  tabRouteElement.appendChild(document.createTextNode(''));\n  buttonsElement.appendChild(tabRouteElement);\n\n  // Tab: \n  const tabLocationElement = document.createElement('div');\n  tabLocationElement.classList.add('css_route_group_item_button');\n  tabLocationElement.setAttribute('highlighted', 'false');\n  tabLocationElement.setAttribute('type', 'tab');\n  tabLocationElement.setAttribute('code', '3');\n  tabLocationElement.onclick = () => {\n    switchRouteBodyTab(identifier, 3);\n  };\n\n  const tabLocationIconElement = document.createElement('div');\n  tabLocationIconElement.classList.add('css_route_group_item_button_icon');\n  tabLocationIconElement.appendChild(getIconElement('location_on'));\n  tabLocationElement.appendChild(tabLocationIconElement);\n  tabLocationElement.appendChild(document.createTextNode(''));\n  buttonsElement.appendChild(tabLocationElement);\n\n  // Save to folder\n  const saveToFolderElement = document.createElement('div');\n  saveToFolderElement.classList.add('css_route_group_item_button');\n  saveToFolderElement.setAttribute('highlighted', 'false');\n  saveToFolderElement.setAttribute('type', 'save-to-folder');\n  /*\n  saveToFolderElement.onclick = () => {\n    openSaveToFolder('stop-on-route', [identifier, null, null]);\n  };\n  */\n\n  const saveToFolderIconElement = document.createElement('div');\n  saveToFolderIconElement.classList.add('css_route_group_item_button_icon');\n  saveToFolderIconElement.appendChild(getIconElement('folder'));\n  saveToFolderElement.appendChild(saveToFolderIconElement);\n  saveToFolderElement.appendChild(document.createTextNode(''));\n  buttonsElement.appendChild(saveToFolderElement);\n\n  // Schedule notification\n  const scheduleNotificationElement = document.createElement('div');\n  scheduleNotificationElement.classList.add('css_route_group_item_button');\n  scheduleNotificationElement.setAttribute('highlighted', 'false');\n  scheduleNotificationElement.setAttribute('type', 'schedule-notification');\n  scheduleNotificationElement.setAttribute('enabled', 'true');\n\n  const scheduleNotificationIconElement = document.createElement('div');\n  scheduleNotificationIconElement.classList.add('css_route_group_item_button_icon');\n  scheduleNotificationIconElement.appendChild(getIconElement('notifications'));\n  scheduleNotificationElement.appendChild(scheduleNotificationIconElement);\n  scheduleNotificationElement.appendChild(document.createTextNode(''));\n  buttonsElement.appendChild(scheduleNotificationElement);\n\n  bodyElement.appendChild(buttonsElement);\n\n  // Buses\n  const busesElement = document.createElement('div');\n  busesElement.classList.add('css_route_group_item_buses');\n  busesElement.setAttribute('displayed', 'true');\n  bodyElement.appendChild(busesElement);\n\n  // Overlapping routes\n  const overlappingRoutesElement = document.createElement('div');\n  overlappingRoutesElement.classList.add('css_route_group_item_overlapping_routes');\n  overlappingRoutesElement.setAttribute('displayed', 'false');\n  bodyElement.appendChild(overlappingRoutesElement);\n\n  // Bus arrival times\n  const busArrivalTimesElement = document.createElement('div');\n  busArrivalTimesElement.classList.add('css_route_group_item_bus_arrival_times');\n  busArrivalTimesElement.setAttribute('displayed', 'false');\n  bodyElement.appendChild(busArrivalTimesElement);\n\n  // Nearby locations\n  const nearbyLocationsElement = document.createElement('div');\n  nearbyLocationsElement.classList.add('css_route_group_item_nearby_locations');\n  nearbyLocationsElement.setAttribute('displayed', 'false');\n  bodyElement.appendChild(nearbyLocationsElement);\n\n  // Assemble\n  itemElement.appendChild(headElement);\n  itemElement.appendChild(bodyElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction generateElementOfGroup(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_route_group');\n\n  const tracksElement = document.createElement('div');\n  tracksElement.classList.add('css_route_group_tracks');\n\n  const threadTrackElement = document.createElement('div');\n  threadTrackElement.classList.add('css_route_group_threads_track');\n\n  const threadBoxSpace = document.createElement('div');\n  threadBoxSpace.classList.add('css_route_group_thread_box_space_top');\n\n  const itemsTrackElement = document.createElement('div');\n  itemsTrackElement.classList.add('css_route_group_items_track');\n\n  const itemSpaceElement = document.createElement('div');\n  itemSpaceElement.classList.add('css_route_group_item_space_top');\n\n  itemsTrackElement.appendChild(itemSpaceElement);\n  threadTrackElement.appendChild(threadBoxSpace);\n  tracksElement.appendChild(threadTrackElement);\n  tracksElement.appendChild(itemsTrackElement);\n  element.appendChild(tracksElement);\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction generateElementOfTab(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_route_group_tab');\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction setUpRouteFieldSkeletonScreen(RouteID: IntegratedRoute['RouteID'], PathAttributeId: IntegratedRoute['PathAttributeId']): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const defaultItemQuantity: number = Math.floor(FieldHeight / 50) + 5;\n  const defaultGroupQuantity = 2;\n  let groupedItems: IntegratedRoute['groupedItems'] = {};\n  for (let i = 0; i < defaultGroupQuantity; i++) {\n    const groupKey: string = `g_${i}`;\n    groupedItems[groupKey] = [];\n    for (let j = 0; j < defaultItemQuantity; j++) {\n      groupedItems[groupKey].push({\n        name: '',\n        goBack: '0',\n        status: { code: 8, text: '', time: -6 },\n        buses: [],\n        overlappingRoutes: [],\n        busArrivalTimes: [],\n        nearbyLocations: [],\n        sequence: j,\n        position: {\n          longitude: 0,\n          latitude: 0\n        },\n        nearest: false,\n        progress: 0,\n        segmentBuffer: {\n          isSegmentBuffer: false,\n          isStartingPoint: false,\n          isEndingPoint: false\n        },\n        id: 0\n      });\n    }\n  }\n  updateRouteField(\n    {\n      groupedItems: groupedItems,\n      groupQuantity: defaultGroupQuantity,\n      itemQuantity: {\n        g_0: defaultItemQuantity,\n        g_1: defaultItemQuantity\n      },\n      RouteName: '',\n      RouteEndPoints: {\n        RouteDeparture: '',\n        RouteDestination: ''\n      },\n      RouteID: RouteID,\n      PathAttributeId: PathAttributeId,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateRouteField(integration: IntegratedRoute, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, thisItem: integratedStopItem, previousItem: integratedStopItem | null, skeletonScreen: boolean, animation: boolean): void {\n    function updateStatus(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, thisItem: integratedStopItem, skeletonScreen: boolean, animation: boolean): void {\n      const thisThreadStatusElement = elementQuerySelector(thisThreadBoxElement, '.css_route_group_thread_status');\n      const currentThreadSlideElement = elementQuerySelector(thisThreadStatusElement, '.css_current_slide');\n      const nextThreadSlideElement = elementQuerySelector(thisThreadStatusElement, '.css_next_slide');\n\n      const thisItemStatusElement = elementQuerySelector(thisItemElement, '.css_route_group_item_status');\n      const currentItemSlideElement = elementQuerySelector(thisItemStatusElement, '.css_current_slide');\n      const nextItemSlideElement = elementQuerySelector(thisItemStatusElement, '.css_next_slide');\n\n      nextThreadSlideElement.setAttribute('code', thisItem.status.code.toString());\n\n      nextItemSlideElement.setAttribute('code', thisItem.status.code.toString());\n      nextItemSlideElement.innerText = thisItem.status.text;\n\n      if (!skeletonScreen) {\n        if (animation) {\n          const thisItemElementRect = thisItemElement.getBoundingClientRect();\n          const top = thisItemElementRect.top;\n          const left = thisItemElementRect.left;\n          const bottom = thisItemElementRect.bottom;\n          const right = thisItemElementRect.right;\n          const windowWidth = window.innerWidth;\n          const windowHeight = window.innerHeight;\n          if (bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n            currentThreadSlideElement.addEventListener(\n              'animationend',\n              function () {\n                currentThreadSlideElement.setAttribute('code', thisItem.status.code.toString());\n                currentThreadSlideElement.classList.remove('css_slide_fade_out');\n                nextThreadSlideElement.setAttribute('displayed', 'false');\n              },\n              { once: true }\n            );\n            currentItemSlideElement.addEventListener(\n              'animationend',\n              function () {\n                currentItemSlideElement.setAttribute('code', thisItem.status.code.toString());\n                currentItemSlideElement.innerText = thisItem.status.text;\n                currentItemSlideElement.classList.remove('css_slide_fade_out');\n                nextItemSlideElement.setAttribute('displayed', 'false');\n              },\n              { once: true }\n            );\n            nextItemSlideElement.setAttribute('displayed', 'true');\n            nextThreadSlideElement.setAttribute('displayed', 'true');\n            currentThreadSlideElement.classList.add('css_slide_fade_out');\n            currentItemSlideElement.classList.add('css_slide_fade_out');\n            return;\n          }\n        }\n      }\n\n      currentThreadSlideElement.setAttribute('code', thisItem.status.code.toString());\n      currentItemSlideElement.setAttribute('code', thisItem.status.code.toString());\n      currentItemSlideElement.innerText = thisItem.status.text;\n    }\n\n    function updateSegmentBuffer(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, thisItem: integratedStopItem): void {\n      thisItemElement.setAttribute('segment-buffer', booleanToString(thisItem.segmentBuffer.isSegmentBuffer));\n      thisThreadBoxElement.setAttribute('segment-buffer', booleanToString(thisItem.segmentBuffer.isSegmentBuffer));\n    }\n\n    function updateName(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      elementQuerySelector(thisItemElement, '.css_route_group_item_name').innerText = thisItem.name;\n    }\n\n    function updateBuses(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      elementQuerySelector(thisItemElement, '.css_route_group_item_buses').innerHTML = thisItem.buses.length === 0 ? '<div class=\"css_route_group_item_buses_message\"></div>' : thisItem.buses.map((bus) => `<div class=\"css_route_group_item_bus\" on-this-route=\"${bus.onThisRoute}\"><div class=\"css_route_group_item_bus_title\"><div class=\"css_route_group_item_bus_icon\">${getIconHTML('directions_bus')}</div><div class=\"css_route_group_item_bus_car_number\">${bus.carNumber}</div></div><div class=\"css_route_group_item_bus_attributes\"><div class=\"css_route_group_item_bus_route\">${bus.RouteName}</div><div class=\"css_route_group_item_bus_car_status\">${bus.status.text}</div><div class=\"css_route_group_item_bus_car_type\">${bus.type}</div></div></div>`).join('');\n    }\n\n    function updateOverlappingRoutes(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      elementQuerySelector(thisItemElement, '.css_route_group_item_overlapping_routes').innerHTML = thisItem.overlappingRoutes.length === 0 ? '<div class=\"css_route_group_item_overlapping_route_message\"></div>' : thisItem.overlappingRoutes.map((route) => `<div class=\"css_route_group_item_overlapping_route\"><div class=\"css_route_group_item_overlapping_route_title\"><div class=\"css_route_group_item_overlapping_route_icon\">${getIconHTML('route')}</div><div class=\"css_route_group_item_overlapping_route_name\">${route.name}</div></div><div class=\"css_route_group_item_overlapping_route_endpoints\">${route.RouteEndPoints.html}</div><div class=\"css_route_group_item_overlapping_route_actions\"><div class=\"css_route_group_item_overlapping_route_action_button\" onclick=\"bus.route.switchRoute(${route.RouteID}, [${route.PathAttributeId.join(',')}])\"></div><div class=\"css_route_group_item_overlapping_route_action_button\" onclick=\"bus.folder.openSaveToFolder('route-on-route', [${route.RouteID}])\"></div></div></div>`).join('');\n    }\n\n    function updateBusArrivalTimes(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      elementQuerySelector(thisItemElement, '.css_route_group_item_bus_arrival_times').innerHTML = thisItem.busArrivalTimes.length === 0 ? '<div class=\"css_route_group_item_bus_arrival_message\"></div>' : thisItem.busArrivalTimes.map((busArrivalTime) => `<div class=\"css_route_group_item_bus_arrival_time\"><div class=\"css_route_group_item_bus_arrival_time_title\"><div class=\"css_route_group_item_bus_arrival_time_icon\">${getIconHTML('calendar_view_day')}</div><div class=\"css_route_group_item_bus_arrival_time_personal_schedule_name\">${busArrivalTime.personalSchedule.name}</div><div class=\"css_route_group_item_bus_arrival_time_personal_schedule_time\">${indexToDay(busArrivalTime.day).name} ${timeObjectToString(busArrivalTime.personalSchedule.period.start)} - ${timeObjectToString(busArrivalTime.personalSchedule.period.end)}</div></div><div class=\"css_route_group_item_bus_arrival_time_chart\">${busArrivalTime.chart}</div></div>`).join('');\n    }\n\n    function updateNearbyLocations(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      elementQuerySelector(thisItemElement, '.css_route_group_item_nearby_locations').innerHTML = thisItem.nearbyLocations.length === 0 ? '<div class=\"css_route_group_item_nearby_locations_message\"></div>' : thisItem.nearbyLocations.map((nearbyLocation) => `<div class=\"css_route_group_item_nearby_location\"><div class=\"css_route_group_item_nearby_location_title\"><div class=\"css_route_group_item_nearby_location_icon\">${getIconHTML('location_on')}</div><div class=\"css_route_group_item_nearby_location_name\">${nearbyLocation.name}</div></div><div class=\"css_route_group_item_nearby_location_distance\">${nearbyLocation.distance}</div><div class=\"css_route_group_item_nearby_location_actions\"><div class=\"css_route_group_item_nearby_location_action_button\" onclick=\"bus.location.openLocation('${nearbyLocation.hash}')\"></div><div class=\"css_route_group_item_nearby_location_action_button\" onclick=\"bus.folder.openSaveToFolder('location-on-route', ['${nearbyLocation.hash}'])\"></div></div></div>`).join('');\n    }\n\n    function updateNearest(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, thisItem: integratedStopItem): void {\n      thisItemElement.setAttribute('nearest', booleanToString(thisItem.nearest));\n      thisThreadBoxElement.setAttribute('nearest', booleanToString(thisItem.nearest));\n    }\n\n    function updateThread(thisThreadBoxElement: HTMLElement, thisItem: integratedStopItem, previousItem: integratedStopItem | null, skeletonScreen: boolean, animation: boolean): void {\n      const previousProgress = previousItem?.progress || 0;\n      const thisProgress = thisItem?.progress || 0;\n      const thisThreadProgressElement = elementQuerySelector(thisThreadBoxElement, '.css_route_group_thread .css_route_group_thread_progress');\n      if (!skeletonScreen) {\n        if (animation) {\n          if (previousProgress !== 0 && thisProgress === 0 && Math.abs(thisProgress - previousProgress) > 0) {\n            thisThreadProgressElement.style.setProperty('--b-cssvar-thread-progress-translate-y', '100%');\n            thisThreadProgressElement.addEventListener(\n              'transitionend',\n              function () {\n                thisThreadProgressElement.setAttribute('displayed', 'false');\n                thisThreadProgressElement.style.setProperty('--b-cssvar-thread-progress-translate-y', '-100%');\n              },\n              { once: true }\n            );\n            return;\n          }\n        }\n      }\n      if (thisProgress > 0) {\n        thisThreadProgressElement.setAttribute('displayed', 'true');\n        thisThreadProgressElement.style.setProperty('--b-cssvar-thread-progress-translate-y', `${(thisProgress - 1) * 100}%`);\n      } else {\n        thisThreadProgressElement.setAttribute('displayed', 'false');\n      }\n    }\n\n    function updateStretch(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, skeletonScreen: boolean): void {\n      if (skeletonScreen) {\n        const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_route_group_item_body');\n        thisItemBodyElement.setAttribute('displayed', 'false');\n        thisItemElement.setAttribute('stretched', 'false');\n        thisThreadBoxElement.setAttribute('stretched', 'false');\n      }\n    }\n\n    function updateAnimation(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, animation: boolean): void {\n      thisItemElement.setAttribute('animation', booleanToString(animation));\n      thisThreadBoxElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisItemElement: HTMLElement, thisThreadBoxElement: HTMLElement, skeletonScreen: boolean): void {\n      thisItemElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n      thisThreadBoxElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    function updateSaveToFolderButton(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      const saveToFolderButtonElement = elementQuerySelector(thisItemElement, '.css_route_group_item_body .css_route_group_item_buttons .css_route_group_item_button[type=\"save-to-folder\"]');\n      saveToFolderButtonElement.onclick = function () {\n        openSaveToFolder('stop-on-route', [thisItemElement.id, thisItem.id, integration.RouteID]);\n      };\n      isFolderContentSaved('stop', thisItem.id).then((e) => {\n        saveToFolderButtonElement.setAttribute('highlighted', booleanToString(e));\n      });\n    }\n\n    function updateScheduleNotificationButton(thisItemElement: HTMLElement, thisItem: integratedStopItem): void {\n      const scheduleNotificationButtonElement = elementQuerySelector(thisItemElement, '.css_route_group_item_body .css_route_group_item_buttons .css_route_group_item_button[type=\"schedule-notification\"]');\n      scheduleNotificationButtonElement.onclick = function () {\n        openScheduleNotification('stop-on-route', [thisItemElement.id, thisItem.id, integration.RouteID, thisItem.status.time]);\n      };\n      const havingNotifcationSchedules = stopHasNotifcationSchedules(thisItem.id);\n      scheduleNotificationButtonElement.setAttribute('highlighted', booleanToString(havingNotifcationSchedules));\n    }\n\n    if (previousItem === null) {\n      updateStatus(thisItemElement, thisThreadBoxElement, thisItem, skeletonScreen, animation);\n      updateName(thisItemElement, thisItem);\n      updateBuses(thisItemElement, thisItem);\n      updateOverlappingRoutes(thisItemElement, thisItem);\n      updateBusArrivalTimes(thisItemElement, thisItem);\n      updateNearbyLocations(thisItemElement, thisItem);\n      updateSegmentBuffer(thisItemElement, thisThreadBoxElement, thisItem);\n      updateNearest(thisItemElement, thisThreadBoxElement, thisItem);\n      updateThread(thisThreadBoxElement, thisItem, previousItem, skeletonScreen, animation);\n      updateStretch(thisItemElement, thisThreadBoxElement, skeletonScreen);\n      updateAnimation(thisItemElement, thisThreadBoxElement, animation);\n      updateSkeletonScreen(thisItemElement, thisThreadBoxElement, skeletonScreen);\n      updateSaveToFolderButton(thisItemElement, thisItem);\n      updateScheduleNotificationButton(thisItemElement, thisItem);\n    } else {\n      if (thisItem.status.time !== previousItem.status.time) {\n        updateStatus(thisItemElement, thisThreadBoxElement, thisItem, skeletonScreen, animation);\n        updateScheduleNotificationButton(thisItemElement, thisItem);\n      }\n      if (!compareThings(previousItem.buses, thisItem.buses)) {\n        updateBuses(thisItemElement, thisItem);\n      }\n      if (!compareThings(previousItem.busArrivalTimes, thisItem.busArrivalTimes)) {\n        updateBusArrivalTimes(thisItemElement, thisItem);\n      }\n      if (previousItem.nearest !== thisItem.nearest) {\n        updateNearest(thisItemElement, thisThreadBoxElement, thisItem);\n      }\n      if (previousItem.progress !== thisItem.progress) {\n        updateThread(thisThreadBoxElement, thisItem, previousItem, skeletonScreen, animation);\n      }\n      if (previousItem.id !== thisItem.id) {\n        updateName(thisItemElement, thisItem);\n        updateSegmentBuffer(thisItemElement, thisThreadBoxElement, thisItem);\n        updateOverlappingRoutes(thisItemElement, thisItem);\n        updateNearbyLocations(thisItemElement, thisItem);\n        updateSaveToFolderButton(thisItemElement, thisItem);\n        updateScheduleNotificationButton(thisItemElement, thisItem);\n      }\n      if (previousAnimation !== animation) {\n        updateAnimation(thisItemElement, thisThreadBoxElement, animation);\n      }\n      if (previousSkeletonScreen !== skeletonScreen) {\n        updateStretch(thisItemElement, thisThreadBoxElement, skeletonScreen);\n        updateSkeletonScreen(thisItemElement, thisThreadBoxElement, skeletonScreen);\n      }\n    }\n  }\n\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n\n  const groupQuantity = integration.groupQuantity;\n  const itemQuantity = integration.itemQuantity;\n  const groupedItems = integration.groupedItems;\n\n  routeSliding_groupQuantity = groupQuantity;\n  routeSliding_fieldWidth = FieldWidth;\n  routeSliding_fieldHeight = FieldHeight;\n\n  let cumulativeOffset = 0;\n  const groupNames = [integration.RouteEndPoints.RouteDestination, integration.RouteEndPoints.RouteDeparture, ''].map((e) => `${e}`);\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const width = getTextWidth(groupNames[i], 500, '17px', `\"Noto Sans TC\", sans-serif`) + tabPadding;\n    routeSliding_groupStyles[groupKey] = {\n      width: width,\n      offset: cumulativeOffset\n    };\n    cumulativeOffset += width;\n  }\n  routeSliding_groupStyles[`g_${groupQuantity}`] = {\n    width: 0,\n    offset: cumulativeOffset\n  };\n\n  if (!routeSliding_sliding) {\n    const initialGroupKey = `g_${routeSliding_initialIndex}`;\n    const initialGroupStyle = routeSliding_groupStyles[initialGroupKey];\n    const offset = initialGroupStyle.offset * -1 + routeSliding_fieldWidth * 0.5 - initialGroupStyle.width * 0.5;\n    const tabLineWidth = initialGroupStyle.width - tabPadding;\n    updateRouteCSS(routeSliding_groupQuantity, offset, tabLineWidth, routeSliding_initialIndex);\n  }\n\n  if (previousSkeletonScreen !== skeletonScreen) {\n    RouteNameElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    RouteGroupTabsElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    RouteGroupTabLineTrackElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  if (previousAnimation !== animation) {\n    RouteNameElement.setAttribute('animation', booleanToString(animation));\n    RouteGroupTabsElement.setAttribute('animation', booleanToString(animation));\n    RouteGroupTabLineTrackElement.setAttribute('animation', booleanToString(animation));\n  }\n\n  if (previousIntegration?.RouteID !== integration.RouteID) {\n    RouteButtonRightElement.onclick = function () {\n      openRouteDetails(integration.RouteID, integration.PathAttributeId);\n    };\n  }\n\n  if (previousIntegration?.RouteName !== integration.RouteName) {\n    RouteNameSpanElement.innerText = integration.RouteName;\n  }\n\n  const currentGroupCapacity = elementQuerySelectorAll(RouteGroupsElement, '.css_route_group').length;\n  if (groupQuantity !== currentGroupCapacity) {\n    const difference = currentGroupCapacity - groupQuantity;\n    if (difference < 0) {\n      const newGroupsFragment = new DocumentFragment();\n      const newTabsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newGroupElement = generateElementOfGroup();\n        newGroupsFragment.appendChild(newGroupElement.element);\n        const newTabElement = generateElementOfTab();\n        newTabsFragment.appendChild(newTabElement.element);\n      }\n      RouteGroupsElement.append(newGroupsFragment);\n      RouteGroupTabsTrayElement.append(newTabsFragment);\n    } else {\n      const GroupElements = elementQuerySelectorAll(RouteGroupsElement, '.css_route_group');\n      const TabElements = elementQuerySelectorAll(RouteGroupTabsTrayElement, '.css_route_group_tab');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const groupIndex = currentGroupCapacity - 1 - o;\n        GroupElements[groupIndex].remove();\n        TabElements[groupIndex].remove();\n      }\n    }\n  }\n\n  const RouteGroupElements = elementQuerySelectorAll(RouteGroupsElement, '.css_route_group');\n\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisGroupElement = RouteGroupElements[i];\n    const thisGroupItemsTrackElement = elementQuerySelector(thisGroupElement, '.css_route_group_items_track');\n    const thisGroupThreadsTrackElement = elementQuerySelector(thisGroupElement, '.css_route_group_threads_track');\n    const currentItemCapacity = elementQuerySelectorAll(thisGroupItemsTrackElement, '.css_route_group_item').length;\n    if (itemQuantity[groupKey] !== currentItemCapacity) {\n      const difference = currentItemCapacity - itemQuantity[groupKey];\n      if (difference < 0) {\n        const newItemsFragment = new DocumentFragment();\n        const newThreadsFragment = new DocumentFragment();\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newThreadBoxElement = generateElementOfThreadBox();\n          const newItemElement = generateElementOfItem(newThreadBoxElement.id);\n          newItemsFragment.appendChild(newItemElement.element);\n          newThreadsFragment.appendChild(newThreadBoxElement.element);\n        }\n        thisGroupItemsTrackElement.append(newItemsFragment);\n        thisGroupThreadsTrackElement.append(newThreadsFragment);\n      } else {\n        const thisGroupItemElements = elementQuerySelectorAll(thisGroupItemsTrackElement, '.css_route_group_item');\n        const thisGroupThreadElements = elementQuerySelectorAll(thisGroupThreadsTrackElement, '.css_route_group_thread_box');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          thisGroupItemElements[itemIndex].remove();\n          thisGroupThreadElements[itemIndex].remove();\n        }\n      }\n    }\n  }\n\n  const TabElements = elementQuerySelectorAll(RouteGroupTabsTrayElement, '.css_route_group_tab');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n\n    const thisTabElement = TabElements[i];\n    thisTabElement.innerHTML = [integration.RouteEndPoints.RouteDestination, integration.RouteEndPoints.RouteDeparture, ''].map((e) => `<span>${e}</span>`)[i];\n    thisTabElement.style.setProperty('--b-cssvar-route-tab-width', `${routeSliding_groupStyles[groupKey].width}px`);\n    thisTabElement.style.setProperty('--b-cssvar-route-tab-index', i.toString());\n\n    const thisGroupElement = RouteGroupElements[i];\n    if (skeletonScreen) {\n      thisGroupElement.scrollTop = 0;\n    }\n\n    const thisGroupItemsTrackElement = elementQuerySelector(thisGroupElement, '.css_route_group_items_track');\n    const thisGroupThreadsTrackElement = elementQuerySelector(thisGroupElement, '.css_route_group_threads_track');\n    const thisGroupItemElements = elementQuerySelectorAll(thisGroupItemsTrackElement, '.css_route_group_item');\n    const thisGroupThreadElements = elementQuerySelectorAll(thisGroupThreadsTrackElement, '.css_route_group_thread_box');\n    for (let j = 0; j < itemQuantity[groupKey]; j++) {\n      const thisItemElement = thisGroupItemElements[j];\n      const thisThreadBoxElement = thisGroupThreadElements[j];\n      const thisItem = groupedItems[groupKey][j];\n      if (previousIntegration.hasOwnProperty('groupedItems')) {\n        if (previousIntegration.groupedItems.hasOwnProperty(groupKey)) {\n          if (previousIntegration.groupedItems[groupKey][j]) {\n            const previousItem = previousIntegration.groupedItems[groupKey][j];\n            updateItem(thisItemElement, thisThreadBoxElement, thisItem, previousItem, skeletonScreen, animation);\n          } else {\n            updateItem(thisItemElement, thisThreadBoxElement, thisItem, null, skeletonScreen, animation);\n          }\n        } else {\n          updateItem(thisItemElement, thisThreadBoxElement, thisItem, null, skeletonScreen, animation);\n        }\n      } else {\n        updateItem(thisItemElement, thisThreadBoxElement, thisItem, null, skeletonScreen, animation);\n      }\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nasync function refreshRoute() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  const busArrivalTimeChartSize = querySize('route-bus-arrival-time-chart');\n  routeRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  routeRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  routeRefreshTimer_refreshing = true;\n  routeRefreshTimer_currentRequestID = generateIdentifier();\n  RouteUpdateTimerElement.setAttribute('refreshing', 'true');\n  RouteUpdateTimerElement.classList.remove('css_route_update_timer_slide_rtl');\n  document.addEventListener(routeRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateRoute(currentRouteIDSet_RouteID, currentRouteIDSet_PathAttributeId, busArrivalTimeChartSize.width, busArrivalTimeChartSize.height, routeRefreshTimer_currentRequestID);\n  updateRouteField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (routeRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  routeRefreshTimer_lastUpdate = new Date().getTime();\n  if (routeRefreshTimer_dynamic) {\n    routeRefreshTimer_nextUpdate = Math.max(routeRefreshTimer_lastUpdate + routeRefreshTimer_minInterval, integration.dataUpdateTime + routeRefreshTimer_baseInterval / updateRate);\n  } else {\n    routeRefreshTimer_nextUpdate = routeRefreshTimer_lastUpdate + routeRefreshTimer_baseInterval;\n  }\n  routeRefreshTimer_dynamicInterval = Math.max(routeRefreshTimer_minInterval, routeRefreshTimer_nextUpdate - routeRefreshTimer_lastUpdate);\n  routeRefreshTimer_refreshing = false;\n  RouteUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nexport function streamRoute(): void {\n  refreshRoute()\n    .then(function () {\n      if (routeRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamRoute();\n          },\n          Math.max(routeRefreshTimer_minInterval, routeRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        routeRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (routeRefreshTimer_streaming) {\n        promptMessage('error', `${routeRefreshTimer_retryInterval / 1000}`);\n        setTimeout(function () {\n          streamRoute();\n        }, routeRefreshTimer_retryInterval);\n      } else {\n        routeRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openRoute(RouteID: IntegratedRoute['RouteID'], PathAttributeId: IntegratedRoute['PathAttributeId']): void {\n  pushPageHistory('Route');\n  logRecentView('route', RouteID);\n  currentRouteIDSet_RouteID = RouteID;\n  currentRouteIDSet_PathAttributeId = PathAttributeId;\n  routeSliding_initialIndex = 0;\n  routeSliding_groupStyles = {};\n  RouteField.setAttribute('displayed', 'true');\n  RouteGroupsElement.scrollLeft = 0;\n  RouteGroupsElement.focus();\n  setUpRouteFieldSkeletonScreen(RouteID, PathAttributeId);\n  if (!routeRefreshTimer_streaming) {\n    routeRefreshTimer_streaming = true;\n    if (!routeRefreshTimer_streamStarted) {\n      routeRefreshTimer_streamStarted = true;\n      streamRoute();\n    } else {\n      refreshRoute();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeRoute(): void {\n  // revokePageHistory('Route');\n  RouteField.setAttribute('displayed', 'false');\n  routeRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport function switchRoute(RouteID: IntegratedRoute['RouteID'], PathAttributeId: IntegratedRoute['PathAttributeId']): void {\n  routeRefreshTimer_streaming = false;\n  openRoute(RouteID, PathAttributeId);\n}\n\nexport function stretchRouteItem(itemElementID: string, threadBoxElementID: string): void {\n  const itemElement = elementQuerySelector(RouteGroupsElement, `.css_route_group .css_route_group_tracks .css_route_group_items_track .css_route_group_item#${itemElementID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_route_group_item_body');\n  const threadBoxElement = elementQuerySelector(RouteGroupsElement, `.css_route_group .css_route_group_tracks .css_route_group_threads_track .css_route_group_thread_box#${threadBoxElementID}`);\n\n  const itemsTrackElement = itemElement.parentElement as HTMLElement;\n  const threadTrackElement = threadBoxElement.parentElement as HTMLElement;\n\n  const elementsBelowThreadBoxElement = getElementsBelow(threadBoxElement, 'css_route_group_thread_box');\n  const elementsBelowItemElement = getElementsBelow(itemElement, 'css_route_group_item');\n\n  const elementsBelowLength = elementsBelowItemElement.length; // = elementsBelowThreadBoxElement.length\n\n  const itemsTrackElementRect = itemsTrackElement.getBoundingClientRect();\n  const itemElementRect = itemElement.getBoundingClientRect();\n  const threadTrackElementRect = threadTrackElement.getBoundingClientRect();\n  const threadBoxElementRect = threadBoxElement.getBoundingClientRect();\n\n  // const threadBoxElementX = threadBoxElementRect.left - threadTrackElementRect.left;\n  const threadBoxElementY = threadBoxElementRect.top - threadTrackElementRect.top;\n\n  // const itemElementX = itemElementRect.left - itemsTrackElementRect.left;\n  const itemElementY = itemElementRect.top - itemsTrackElementRect.top; // itemElementRect.top + scrollTop - (itemsTrackElementRect.top + scrollTop)\n\n  const stretched = itemElement.getAttribute('stretched') === 'true' ? true : false;\n  const animation = itemElement.getAttribute('animation') === 'true' ? true : false;\n\n  if (animation) {\n    const pushDirection = stretched ? '2' : '1';\n\n    // Separate the elements from the document flow while keeping its position\n    threadBoxElement.setAttribute('stretching', 'true');\n    // threadBoxElement.style.setProperty('--b-cssvar-css-route-group-thread-box-x', `${threadBoxElementX}px`);\n    threadBoxElement.style.setProperty('--b-cssvar-css-route-group-thread-box-y', `${threadBoxElementY}px`);\n\n    itemElement.setAttribute('stretching', 'true');\n    // itemElement.style.setProperty('--b-cssvar-css-route-group-item-x', `${itemElementX}px`);\n    itemElement.style.setProperty('--b-cssvar-css-route-group-item-y', `${itemElementY}px`);\n\n    // Set push direction and push state\n    for (let i = 0; i < elementsBelowLength; i++) {\n      const thisItemElement = elementsBelowItemElement[i];\n      const thisThreadBoxElement = elementsBelowThreadBoxElement[i];\n      // thisThreadBoxElement.style.setProperty('--b-cssvar-css-route-group-thread-z-index', (elementsBelowLength - i - 1).toString());\n      thisThreadBoxElement.style.setProperty('--b-cssvar-css-route-group-thread-z-index', (-1 * i - 1).toString());\n      thisThreadBoxElement.setAttribute('push-direction', pushDirection);\n      thisThreadBoxElement.setAttribute('push-state', '1');\n      thisItemElement.setAttribute('push-direction', pushDirection);\n      thisItemElement.setAttribute('push-state', '1');\n    }\n\n    itemElement.addEventListener(\n      'transitionend',\n      function () {\n        // Reset the push direction and push state\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          const thisThreadBoxElement = elementsBelowThreadBoxElement[i];\n          thisThreadBoxElement.setAttribute('push-direction', '0');\n          thisThreadBoxElement.setAttribute('push-state', '0');\n          thisItemElement.setAttribute('push-direction', '0');\n          thisItemElement.setAttribute('push-state', '0');\n        }\n        // Deposit the element\n        threadBoxElement.setAttribute('stretching', 'false');\n        itemElement.setAttribute('stretching', 'false');\n      },\n      { once: true }\n    );\n\n    itemElement.addEventListener(\n      'transitionstart',\n      function () {\n        // Transition the elements below\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          const thisThreadBoxElement = elementsBelowThreadBoxElement[i];\n          thisThreadBoxElement.setAttribute('push-state', '2');\n          thisItemElement.setAttribute('push-state', '2');\n        }\n      },\n      { once: true }\n    );\n  }\n\n  // Switch the state of the stretching element\n  if (stretched) {\n    if (animation) {\n      itemBodyElement.addEventListener(\n        'transitionend',\n        function () {\n          itemBodyElement.setAttribute('displayed', 'false');\n        },\n        { once: true }\n      );\n    } else {\n      itemBodyElement.setAttribute('displayed', 'false');\n    }\n    itemElement.setAttribute('stretched', 'false');\n    threadBoxElement.setAttribute('stretched', 'false');\n  } else {\n    itemBodyElement.setAttribute('displayed', 'true');\n    itemElement.setAttribute('stretched', 'true');\n    threadBoxElement.setAttribute('stretched', 'true');\n  }\n}\n\nexport function switchRouteBodyTab(itemID: string, tabCode: number): void {\n  const itemElement = elementQuerySelector(RouteGroupsElement, `.css_route_group_item#${itemID}`);\n  const buttons = elementQuerySelector(itemElement, '.css_route_group_item_buttons');\n  const button = elementQuerySelectorAll(buttons, '.css_route_group_item_button[highlighted=\"true\"][type=\"tab\"]');\n  for (const t of button) {\n    t.setAttribute('highlighted', 'false');\n  }\n  elementQuerySelector(buttons, `.css_route_group_item_button[code=\"${tabCode}\"]`).setAttribute('highlighted', 'true');\n  switch (tabCode) {\n    case 0:\n      elementQuerySelector(itemElement, '.css_route_group_item_buses').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_route_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_overlapping_routes').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_nearby_locations').setAttribute('displayed', 'false');\n      break;\n    case 1:\n      elementQuerySelector(itemElement, '.css_route_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_bus_arrival_times').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_route_group_item_overlapping_routes').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_nearby_locations').setAttribute('displayed', 'false');\n      break;\n    case 2:\n      elementQuerySelector(itemElement, '.css_route_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_overlapping_routes').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_route_group_item_nearby_locations').setAttribute('displayed', 'false');\n      break;\n    case 3:\n      elementQuerySelector(itemElement, '.css_route_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_overlapping_routes').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_route_group_item_nearby_locations').setAttribute('displayed', 'true');\n      break;\n    default:\n      break;\n  }\n}\n","import { searchRouteByName, searchRouteByRouteID } from '../data/search/index';\nimport { openLocation } from '../interface/location/index';\nimport { openRoute } from '../interface/route/index';\n\nexport function openPermalink(): void {\n  const current_url = new URL(location.href);\n  const permalinkValue = current_url.searchParams.get('permalink');\n  if (permalinkValue !== null) {\n    const permalinkString = String(permalinkValue);\n    if (/^[0-1]\\@(.*)(\\~.*){0,1}/.test(permalinkString)) {\n      const values = permalinkString.split(/[\\@\\~]/);\n      const type = parseInt(values[0]);\n      // route\n      switch (type) {\n        case 0:\n          searchRouteByRouteID(parseInt(values[1], 16)).then((result) => {\n            if (result !== false) {\n              openRoute(result.id, result.pid);\n            } else {\n              searchRouteByName(values[2]).then((result2) => {\n                if (result2.length > 0) {\n                  openRoute(result2[0].id, result2[0].pid);\n                }\n              });\n            }\n          });\n          break;\n        case 1:\n          openLocation(values[1]);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n}\n\nexport function getPermalink(type: number, approach: object): string {\n  const link = new URL('https://erichsia7.github.io/bus/');\n  switch (type) {\n    case 0:\n      link.searchParams.set('permalink', `0@${parseInt(approach.id).toString(16)}~${approach.name}`);\n      break;\n    case 1:\n      link.searchParams.set('permalink', `1@${approach.hash}`);\n      break;\n    default:\n      break;\n  }\n  return decodeURIComponent(link.toString());\n}\n","import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { isFolderContentSaved } from '../../data/folder/index';\nimport { IntegratedLocation, IntegratedLocationItem, integrateLocation, LocationGroupProperty } from '../../data/location/index';\nimport { stopHasNotifcationSchedules } from '../../data/notification/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll, getElementsBelow } from '../../tools/elements';\nimport { getTextWidth } from '../../tools/graphic';\nimport { booleanToString, compareThings, generateIdentifier } from '../../tools/index';\nimport { indexToDay, timeObjectToString } from '../../tools/time';\nimport { getBlankIconElement, getIconElement, getIconHTML, setIcon } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, GroupStyles, openPreviousPage, pushPageHistory, querySize } from '../index';\nimport { promptMessage } from '../prompt/index';\nimport { openSaveToFolder } from '../save-to-folder/index';\nimport { openScheduleNotification } from '../schedule-notification/index';\nimport { openLocationDetails } from './details/index';\n\nconst LocationField = documentQuerySelector('.css_location_field');\nconst LocationHeadElement = elementQuerySelector(LocationField, '.css_location_head');\nconst LocationNameElement = elementQuerySelector(LocationHeadElement, '.css_location_name');\nconst LocationNameSpanElement = elementQuerySelector(LocationNameElement, 'span');\nconst LocationButtonRightElement = elementQuerySelector(LocationHeadElement, '.css_location_button_right');\nconst LocationGroupsElement = elementQuerySelector(LocationField, '.css_location_groups');\nconst LocationGroupTabsElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tabs');\nconst LocationGroupTabsTrayElement = elementQuerySelector(LocationGroupTabsElement, '.css_location_group_tabs_tray');\nconst LocationGroupTabLineTrackElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tab_line_track');\nconst LocationGroupTabLineElement = elementQuerySelector(LocationGroupTabLineTrackElement, '.css_location_group_tab_line');\nconst LocationUpdateTimerElement = elementQuerySelector(LocationHeadElement, '.css_location_update_timer_box .css_location_update_timer');\n\nlet previousIntegration = {} as IntegratedLocation;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet locationSliding_initialIndex: number = 0;\nlet locationSliding_targetIndex: number = 0;\nlet locationSliding_groupQuantity: number = 0;\nlet locationSliding_groupStyles: GroupStyles = {};\nlet locationSliding_fieldWidth: number = 0;\nlet locationSliding_fieldHeight: number = 0;\nlet locationSliding_sliding: boolean = false;\n\nlet locationRefreshTimer_retryInterval: number = 10 * 1000;\nlet locationRefreshTimer_baseInterval: number = 15 * 1000;\nlet locationRefreshTimer_minInterval: number = 5 * 1000;\nlet locationRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet locationRefreshTimer_dynamic: boolean = true;\nlet locationRefreshTimer_lastUpdate: number = 0;\nlet locationRefreshTimer_nextUpdate: number = 0;\nlet locationRefreshTimer_currentRequestID: string = '';\nlet locationRefreshTimer_refreshing: boolean = false;\nlet locationRefreshTimer_streaming: boolean = false;\nlet locationRefreshTimer_streamStarted: boolean = false;\n\nlet currentHashSet_hash: string = '';\n\nlet tabPadding: number = 20;\n\nexport function initializeLocationSliding(): void {\n  LocationGroupsElement.addEventListener(\n    'touchstart',\n    function () {\n      locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / locationSliding_fieldWidth);\n    },\n    { passive: true }\n  );\n\n  LocationGroupsElement.addEventListener(\n    'scroll',\n    function (event: Event) {\n      locationSliding_sliding = true;\n      const target = event.target as HTMLElement;\n      const currentIndex = target.scrollLeft / locationSliding_fieldWidth;\n      if (currentIndex > locationSliding_initialIndex) {\n        locationSliding_targetIndex = locationSliding_initialIndex + 1;\n      } else {\n        locationSliding_targetIndex = locationSliding_initialIndex - 1;\n      }\n      const indexDifference = currentIndex - locationSliding_initialIndex;\n      let delta = Math.abs(indexDifference);\n      if (delta > 1) {\n        if (indexDifference > 0) {\n          locationSliding_initialIndex = Math.floor(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex + 1;\n        } else {\n          locationSliding_initialIndex = Math.ceil(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex - 1;\n        }\n        delta = Math.abs(currentIndex - locationSliding_initialIndex);\n      }\n      const initialSize = locationSliding_groupStyles[`g_${locationSliding_initialIndex}`] || { width: 0, offset: 0 };\n      const targetSize = locationSliding_groupStyles[`g_${locationSliding_targetIndex}`] || { width: 0, offset: 0 };\n      const tabWidth = initialSize.width + (targetSize.width - initialSize.width) * delta;\n      const offset = (initialSize.offset + (targetSize.offset - initialSize.offset) * delta) * -1 + locationSliding_fieldWidth * 0.5 - tabWidth * 0.5;\n      updateLocationCSS(locationSliding_groupQuantity, offset, tabWidth - tabPadding, currentIndex);\n      if (currentIndex === locationSliding_targetIndex) {\n        locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / locationSliding_fieldWidth);\n        locationSliding_sliding = false;\n      }\n    },\n    { passive: true }\n  );\n}\n\nexport function updateLocationCSS(groupQuantity: number, offset: number, tabLineWidth: number, percentage: number): void {\n  LocationGroupsElement.style.setProperty('--b-cssvar-location-group-quantity', groupQuantity.toString());\n  LocationGroupTabLineElement.style.setProperty('--b-cssvar-location-tab-line-width-scale', tabLineWidth.toString());\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-tabs-tray-offset', `${offset.toString()}px`);\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-percentage', percentage.toString());\n}\n\nfunction animateUpdateTimer(): void {\n  LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-interval', `${locationRefreshTimer_dynamicInterval}ms`);\n  LocationUpdateTimerElement.classList.add('css_location_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (locationRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfItem(): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main container\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_location_group_item');\n  itemElement.id = identifier;\n  itemElement.setAttribute('stretched', 'false');\n  itemElement.setAttribute('stretching', 'false');\n  itemElement.setAttribute('push-direction', '0');\n  itemElement.setAttribute('push-state', '0');\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_location_group_item_head');\n\n  // Rank\n  const rankElement = document.createElement('div');\n  rankElement.classList.add('css_location_group_item_rank');\n  const rankNextSlideElement = document.createElement('div');\n  rankNextSlideElement.classList.add('css_location_group_item_rank_next_slide');\n  rankNextSlideElement.setAttribute('code', '-1');\n  rankNextSlideElement.setAttribute('displayed', 'false');\n  const rankCurrentSlideElement = document.createElement('div');\n  rankCurrentSlideElement.classList.add('css_location_group_item_rank_current_slide');\n  rankCurrentSlideElement.setAttribute('code', '-1');\n  rankCurrentSlideElement.setAttribute('displayed', 'true');\n  rankElement.appendChild(rankNextSlideElement);\n  rankElement.appendChild(rankCurrentSlideElement);\n\n  // Route direction\n  const routeDirectionElement = document.createElement('div');\n  routeDirectionElement.classList.add('css_location_group_item_route_direction');\n\n  // Route name\n  const routeNameElement = document.createElement('div');\n  routeNameElement.classList.add('css_location_group_item_route_name');\n\n  // Capsule\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_location_group_item_capsule');\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_location_group_item_status');\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n  statusElement.appendChild(nextSlideElement);\n  statusElement.appendChild(currentSlideElement);\n\n  // Stretch button\n  const stretchElement = document.createElement('div');\n  stretchElement.classList.add('css_location_group_item_stretch');\n  stretchElement.appendChild(getIconElement('keyboard_arrow_down'));\n  stretchElement.onclick = () => {\n    stretchLocationItem(identifier);\n  };\n\n  // Capsule separator\n  const capsuleSeparatorElement = document.createElement('div');\n  capsuleSeparatorElement.classList.add('css_location_group_item_capsule_separator');\n\n  // Assemble capsule\n  capsuleElement.appendChild(statusElement);\n  capsuleElement.appendChild(stretchElement);\n  capsuleElement.appendChild(capsuleSeparatorElement);\n\n  // Assemble head\n  headElement.appendChild(rankElement);\n  headElement.appendChild(routeDirectionElement);\n  headElement.appendChild(routeNameElement);\n  headElement.appendChild(capsuleElement);\n\n  // Body\n  const bodyElement = document.createElement('div');\n  bodyElement.classList.add('css_location_group_item_body');\n  bodyElement.setAttribute('displayed', 'false');\n\n  // Buttons\n  const buttonsElement = document.createElement('div');\n  buttonsElement.classList.add('css_location_group_item_buttons');\n\n  // Tab: \n  const busTabButtonElement = document.createElement('div');\n  busTabButtonElement.classList.add('css_location_group_item_button');\n  busTabButtonElement.setAttribute('highlighted', 'true');\n  busTabButtonElement.setAttribute('type', 'tab');\n  busTabButtonElement.setAttribute('code', '0');\n  const busTabIconElement = document.createElement('div');\n  busTabIconElement.classList.add('css_location_group_item_button_icon');\n  busTabIconElement.appendChild(getIconElement('directions_bus'));\n  busTabButtonElement.appendChild(busTabIconElement);\n  busTabButtonElement.appendChild(document.createTextNode(''));\n  busTabButtonElement.onclick = () => {\n    switchLocationBodyTab(identifier, 0);\n  };\n\n  // Tab: \n  const arrivalTabButtonElement = document.createElement('div');\n  arrivalTabButtonElement.classList.add('css_location_group_item_button');\n  arrivalTabButtonElement.setAttribute('highlighted', 'false');\n  arrivalTabButtonElement.setAttribute('type', 'tab');\n  arrivalTabButtonElement.setAttribute('code', '1');\n  const arrivalTabIconElement = document.createElement('div');\n  arrivalTabIconElement.classList.add('css_location_group_item_button_icon');\n  arrivalTabIconElement.appendChild(getIconElement('departure_board'));\n  arrivalTabButtonElement.appendChild(arrivalTabIconElement);\n  arrivalTabButtonElement.appendChild(document.createTextNode(''));\n  arrivalTabButtonElement.onclick = () => {\n    switchLocationBodyTab(identifier, 1);\n  };\n\n  // Button: \n  const saveButtonElement = document.createElement('div');\n  saveButtonElement.classList.add('css_location_group_item_button');\n  saveButtonElement.setAttribute('highlighted', 'false');\n  saveButtonElement.setAttribute('type', 'save-to-folder');\n  const saveButtonIconElement = document.createElement('div');\n  saveButtonIconElement.classList.add('css_location_group_item_button_icon');\n  saveButtonIconElement.appendChild(getIconElement('folder'));\n  saveButtonElement.appendChild(saveButtonIconElement);\n  saveButtonElement.appendChild(document.createTextNode(''));\n  /*\n  saveButtonElement.onclick = () => {\n    openSaveToFolder('stop-on-location', [identifier, null, null]);\n  };\n  */\n\n  // Button: \n  const notifyButtonElement = document.createElement('div');\n  notifyButtonElement.classList.add('css_location_group_item_button');\n  notifyButtonElement.setAttribute('highlighted', 'false');\n  notifyButtonElement.setAttribute('type', 'schedule-notification');\n  notifyButtonElement.setAttribute('enabled', 'true');\n  const notifyButtonIconElement = document.createElement('div');\n  notifyButtonIconElement.classList.add('css_location_group_item_button_icon');\n  notifyButtonIconElement.appendChild(getIconElement('notifications'));\n  notifyButtonElement.appendChild(notifyButtonIconElement);\n  notifyButtonElement.appendChild(document.createTextNode(''));\n  /*\n  notifyButtonElement.onclick = () => {\n    openScheduleNotification('stop-on-location', [identifier, null, null, null]);\n  };\n  */\n\n  // Assemble buttons\n  buttonsElement.appendChild(busTabButtonElement);\n  buttonsElement.appendChild(arrivalTabButtonElement);\n  buttonsElement.appendChild(saveButtonElement);\n  buttonsElement.appendChild(notifyButtonElement);\n\n  // Buses\n  const busesElement = document.createElement('div');\n  busesElement.classList.add('css_location_group_item_buses');\n  busesElement.setAttribute('displayed', 'true');\n\n  // Bus arrival times\n  const busArrivalTimesElement = document.createElement('div');\n  busArrivalTimesElement.classList.add('css_location_group_item_bus_arrival_times');\n  busArrivalTimesElement.setAttribute('displayed', 'false');\n\n  // Assemble body\n  bodyElement.appendChild(buttonsElement);\n  bodyElement.appendChild(busesElement);\n  bodyElement.appendChild(busArrivalTimesElement);\n\n  // Assemble item\n  itemElement.appendChild(headElement);\n  itemElement.appendChild(bodyElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction generateElementOfGroup(): GeneratedElement {\n  // Main container\n  const groupElement = document.createElement('div');\n  groupElement.classList.add('css_location_group');\n\n  // Details\n  const detailsElement = document.createElement('div');\n  detailsElement.classList.add('css_location_group_details');\n\n  // Details body\n  const detailsBodyElement = document.createElement('div');\n  detailsBodyElement.classList.add('css_location_group_details_body');\n  detailsElement.appendChild(detailsBodyElement);\n\n  // Items\n  const itemsElement = document.createElement('div');\n  itemsElement.classList.add('css_location_group_items');\n\n  // Assemble group\n  groupElement.appendChild(detailsElement);\n  groupElement.appendChild(itemsElement);\n\n  return {\n    element: groupElement,\n    id: ''\n  };\n}\n\nfunction generateElementOfTab(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_group_tab');\n\n  const span = document.createElement('span');\n  element.appendChild(span);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction generateElementOfGroupDetailsProperty(): GeneratedElement {\n  // Main container\n  const propertyElement = document.createElement('div');\n  propertyElement.classList.add('css_location_group_details_property');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_location_details_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  // Value\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_location_details_property_value');\n\n  // Assemble\n  propertyElement.appendChild(iconElement);\n  propertyElement.appendChild(valueElement);\n\n  return {\n    element: propertyElement,\n    id: ''\n  };\n}\n\nfunction setUpLocationFieldSkeletonScreen(hash: IntegratedLocation['hash']): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const defaultItemQuantity: IntegratedLocation['itemQuantity'] = { g_0: Math.floor(FieldHeight / 50) + 5, g_1: Math.floor(FieldHeight / 50) + 5 };\n  const defaultGroupQuantity = 2;\n  let groupedItems: IntegratedLocation['groupedItems'] = {};\n  for (let i = 0; i < defaultGroupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    groupedItems[groupKey] = [];\n    for (let j = 0; j < defaultItemQuantity[groupKey]; j++) {\n      groupedItems[groupKey].push({\n        route_name: '',\n        route_direction: '',\n        routeId: 0,\n        stopId: 0,\n        status: {\n          code: 8,\n          text: '',\n          time: -6\n        },\n        ranking: {\n          number: 0,\n          text: '--',\n          code: -1\n        },\n        buses: [],\n        busArrivalTimes: []\n      });\n    }\n  }\n  updateLocationField(\n    {\n      groupedItems: groupedItems,\n      groupQuantity: defaultGroupQuantity,\n      groups: {\n        g_0: {\n          name: '',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        },\n        g_1: {\n          name: '',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        }\n      },\n      itemQuantity: defaultItemQuantity,\n      LocationName: '',\n      hash: hash,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateLocationField(integration: IntegratedLocation, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationItem, previousItem: IntegratedLocationItem | null): void {\n    function updateStatus(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisItemStatusElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_status');\n      const nextSlideElement = elementQuerySelector(thisItemStatusElement, '.css_next_slide');\n      const currentSlideElement = elementQuerySelector(thisItemStatusElement, '.css_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.status.code.toString());\n      nextSlideElement.innerText = thisItem.status.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n            currentSlideElement.innerText = thisItem.status.text;\n            currentSlideElement.classList.remove('css_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n        currentSlideElement.innerText = thisItem.status.text;\n      }\n    }\n\n    function updateRank(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRankElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_rank');\n      const nextSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_next_slide');\n      const currentSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n      nextSlideElement.innerText = thisItem.ranking.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n            currentSlideElement.innerText = thisItem.ranking.text;\n            currentSlideElement.classList.remove('css_location_group_item_rank_current_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_location_group_item_rank_current_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n        currentSlideElement.innerText = thisItem.ranking.text;\n      }\n    }\n\n    function updateRouteDirection(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteDirectionElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_direction');\n      thisRouteDirectionElement.innerText = thisItem.route_direction;\n    }\n\n    function updateRouteName(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteNameElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_name');\n      thisRouteNameElement.innerText = thisItem.route_name;\n    }\n\n    function updateBuses(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buses');\n      thisBusesElement.innerHTML = thisItem.buses.length === 0 ? '<div class=\"css_location_group_item_buses_message\"></div>' : thisItem.buses.map((bus) => `<div class=\"css_location_group_item_bus\" on-this-route=\"${bus.onThisRoute}\"><div class=\"css_location_group_item_bus_title\"><div class=\"css_location_group_item_bus_icon\">${getIconHTML('directions_bus')}</div><div class=\"css_location_group_item_bus_car_number\">${bus.carNumber}</div></div><div class=\"css_location_group_item_bus_attributes\"><div class=\"css_location_group_item_bus_route\">${bus.RouteName}</div><div class=\"css_location_group_item_bus_car_status\">${bus.status.text}</div><div class=\"css_location_group_item_bus_car_type\">${bus.type}</div></div></div>`).join('');\n    }\n\n    function updateBusArrivalTimes(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusArrivalTimesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_bus_arrival_times');\n      thisBusArrivalTimesElement.innerHTML = thisItem.busArrivalTimes.length === 0 ? '<div class=\"css_location_group_item_bus_arrival_message\"></div>' : thisItem.busArrivalTimes.map((busArrivalTime) => `<div class=\"css_location_group_item_bus_arrival_time\"><div class=\"css_location_group_item_bus_arrival_time_title\"><div class=\"css_location_group_item_bus_arrival_time_icon\">${getIconHTML('calendar_view_day')}</div><div class=\"css_location_group_item_bus_arrival_time_personal_schedule_name\">${busArrivalTime.personalSchedule.name}</div><div class=\"css_location_group_item_bus_arrival_time_personal_schedule_time\">${indexToDay(busArrivalTime.day).name} ${timeObjectToString(busArrivalTime.personalSchedule.period.start)} - ${timeObjectToString(busArrivalTime.personalSchedule.period.end)}</div></div><div class=\"css_location_group_item_bus_arrival_time_chart\">${busArrivalTime.chart}</div></div>`).join('');\n    }\n\n    function updateStretch(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      if (skeletonScreen) {\n        thisElement.setAttribute('stretched', 'false');\n      }\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    function updateSaveToFolderButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const saveToFolderButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"save-to-folder\"]');\n      saveToFolderButtonElement.onclick = function () {\n        openSaveToFolder('stop-on-location', [thisItemElement.id, thisItem.stopId, thisItem.routeId]);\n      };\n      isFolderContentSaved('stop', thisItem.stopId).then((e) => {\n        saveToFolderButtonElement.setAttribute('highlighted', booleanToString(e));\n      });\n    }\n\n    function updateScheduleNotificationButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const scheduleNotificationButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"schedule-notification\"]');\n      scheduleNotificationButtonElement.onclick = function () {\n        openScheduleNotification('stop-on-location', [thisItemElement.id, thisItem.stopId, thisItem.routeId, thisItem.status.time]);\n      };\n      const havingNotifcationSchedules = stopHasNotifcationSchedules(thisItem.stopId);\n      scheduleNotificationButtonElement.setAttribute('highlighted', booleanToString(havingNotifcationSchedules));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateStatus(thisElement, thisItem, animation);\n      updateRank(thisElement, thisItem, animation);\n      updateRouteDirection(thisElement, thisItem);\n      updateRouteName(thisElement, thisItem);\n      updateBuses(thisElement, thisItem);\n      updateBusArrivalTimes(thisElement, thisItem);\n      updateStretch(thisElement, skeletonScreen);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n      updateSaveToFolderButton(thisElement, thisItem);\n      updateScheduleNotificationButton(thisElement, thisItem);\n    } else {\n      if (thisItem.status.time !== previousItem.status.time) {\n        updateStatus(thisElement, thisItem, animation);\n        updateScheduleNotificationButton(thisElement, thisItem);\n      }\n      if (previousItem.ranking.number !== thisItem.ranking.number || previousItem.ranking.code !== thisItem.ranking.code) {\n        updateRank(thisElement, thisItem, animation);\n      }\n      if (previousItem.stopId !== thisItem.stopId) {\n        updateRouteDirection(thisElement, thisItem);\n        updateRouteName(thisElement, thisItem);\n        updateSaveToFolderButton(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.buses, thisItem.buses)) {\n        updateBuses(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.busArrivalTimes, thisItem.busArrivalTimes)) {\n        updateBusArrivalTimes(thisElement, thisItem);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateStretch(thisElement, skeletonScreen);\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  function updateProperty(thisElement: HTMLElement, thisProperty: LocationGroupProperty, previousProperty: LocationGroupProperty | null): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_property_icon');\n      setIcon(thisIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      elementQuerySelector(thisElement, '.css_location_details_property_value').innerHTML = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (!compareThings(previousProperty.icon, thisProperty.icon)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty.value, thisProperty.value)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n\n  const groupQuantity = integration.groupQuantity;\n  const itemQuantity = integration.itemQuantity;\n  const groupedItems = integration.groupedItems;\n  const groups = integration.groups;\n\n  locationSliding_groupQuantity = groupQuantity;\n  locationSliding_fieldWidth = FieldWidth;\n  locationSliding_fieldHeight = FieldHeight;\n\n  let cumulativeOffset = 0;\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const width = getTextWidth(groups[groupKey].name, 500, '17px', `\"Noto Sans TC\", sans-serif`) + tabPadding;\n    locationSliding_groupStyles[groupKey] = {\n      width: width,\n      offset: cumulativeOffset\n    };\n    cumulativeOffset += width;\n  }\n  locationSliding_groupStyles[`g_${groupQuantity}`] = {\n    width: 0,\n    offset: cumulativeOffset\n  };\n\n  if (!locationSliding_sliding) {\n    const initialGroupKey = `g_${locationSliding_initialIndex}`;\n    const initialGroupStyle = locationSliding_groupStyles[initialGroupKey];\n    const offset = initialGroupStyle.offset * -1 + locationSliding_fieldWidth * 0.5 - initialGroupStyle.width * 0.5;\n    const tabLineWidth = initialGroupStyle.width - tabPadding;\n    updateLocationCSS(locationSliding_groupQuantity, offset, tabLineWidth, locationSliding_initialIndex);\n  }\n\n  if (previousIntegration?.hash !== integration.hash) {\n    LocationButtonRightElement.onclick = function () {\n      openLocationDetails(integration.hash);\n    };\n  }\n\n  if (previousIntegration?.LocationName !== integration.LocationName) {\n    LocationNameSpanElement.innerText = integration.LocationName;\n  }\n\n  if (previousAnimation !== animation) {\n    LocationNameElement.setAttribute('animation', booleanToString(animation));\n    LocationGroupTabsElement.setAttribute('animation', booleanToString(animation));\n  }\n\n  if (previousSkeletonScreen !== skeletonScreen) {\n    LocationNameElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabsElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabLineTrackElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  // TODO: updateTab\n  const currentGroupCapacity = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group').length;\n  if (groupQuantity !== currentGroupCapacity) {\n    const difference = currentGroupCapacity - groupQuantity;\n    if (difference < 0) {\n      const groupsFragment = new DocumentFragment();\n      const tabsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newGroupElement = generateElementOfGroup();\n        groupsFragment.appendChild(newGroupElement.element);\n        const newTabElement = generateElementOfTab();\n        tabsFragment.appendChild(newTabElement.element);\n      }\n      LocationGroupsElement.append(groupsFragment);\n      LocationGroupTabsTrayElement.append(tabsFragment);\n    } else {\n      const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n      const LocationGroupTabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const groupIndex = currentGroupCapacity - 1 - o;\n        LocationGroupElements[groupIndex].remove();\n        LocationGroupTabElements[groupIndex].remove();\n      }\n    }\n  }\n\n  const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisLocationGroupElement = LocationGroupElements[i];\n    const currentItemCapacity = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item').length;\n    if (itemQuantity[groupKey] !== currentItemCapacity) {\n      const difference = currentItemCapacity - itemQuantity[groupKey];\n      if (difference < 0) {\n        const LocationGroupItemsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_items');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newItemElement = generateElementOfItem();\n          LocationGroupItemsElement.appendChild(newItemElement.element);\n        }\n      } else {\n        const LocationGroupItemElements = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          LocationGroupItemElements[itemIndex].remove();\n        }\n      }\n    }\n\n    const currentGroupPropertyCapacity = elementQuerySelectorAll(elementQuerySelectorAll(LocationGroupsElement, '.css_location_group')[i], '.css_location_group_details .css_location_group_details_body .css_location_group_details_property').length;\n    const groupPropertyQuantity = groups[groupKey].properties.length;\n    if (groupPropertyQuantity !== currentGroupPropertyCapacity) {\n      const difference = currentGroupPropertyCapacity - groupPropertyQuantity;\n      if (difference < 0) {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          // var propertyIndex = currentGroupPropertyCapacity + o;\n          const newPropertyElement = generateElementOfGroupDetailsProperty();\n          thisLocationGroupDetailsBodyElement.appendChild(newPropertyElement.element);\n        }\n      } else {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        const propertyElements = elementQuerySelectorAll(thisLocationGroupDetailsBodyElement, '.css_location_group_details_property');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const propertyIndex = currentGroupPropertyCapacity - 1 - o;\n          propertyElements[propertyIndex].remove();\n        }\n      }\n    }\n  }\n\n  const tabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n  const groupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisTabElement = tabElements[i];\n    const thisTabSpanElement = elementQuerySelector(thisTabElement, 'span');\n    thisTabSpanElement.innerText = groups[groupKey].name;\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-width', `${locationSliding_groupStyles[groupKey].width}px`);\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-index', i.toString());\n    const thisGroupElement = groupElements[i];\n    const propertyElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_details .css_location_group_details_body .css_location_group_details_property`);\n    const itemElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_items .css_location_group_item`);\n\n    const groupPropertyQuantity = groups[groupKey].properties.length; // TODO: propertyQuantity\n    for (let k = 0; k < groupPropertyQuantity; k++) {\n      const thisProperty = groups[groupKey].properties[k];\n      const thisElement = propertyElements[k];\n      if (previousIntegration.hasOwnProperty('groups')) {\n        if (previousIntegration.groups.hasOwnProperty(groupKey)) {\n          if (previousIntegration.groups[groupKey].properties[k]) {\n            const previousProperty = previousIntegration.groups[groupKey].properties[k];\n            updateProperty(thisElement, thisProperty, previousProperty);\n          } else {\n            updateProperty(thisElement, thisProperty, null);\n          }\n        } else {\n          updateProperty(thisElement, thisProperty, null);\n        }\n      } else {\n        updateProperty(thisElement, thisProperty, null);\n      }\n    }\n\n    for (let j = 0; j < itemQuantity[groupKey]; j++) {\n      const thisElement = itemElements[j];\n      const thisItem = groupedItems[groupKey][j];\n      if (previousIntegration.hasOwnProperty('groupedItems')) {\n        if (previousIntegration.groupedItems.hasOwnProperty(groupKey)) {\n          if (previousIntegration.groupedItems[groupKey][j]) {\n            const previousItem = previousIntegration.groupedItems[groupKey][j];\n            updateItem(thisElement, thisItem, previousItem);\n          } else {\n            updateItem(thisElement, thisItem, null);\n          }\n        } else {\n          updateItem(thisElement, thisItem, null);\n        }\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nasync function refreshLocation() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  const busArrivalTimeChartSize = querySize('location-bus-arrival-time-chart');\n  locationRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  locationRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  locationRefreshTimer_refreshing = true;\n  locationRefreshTimer_currentRequestID = generateIdentifier();\n  LocationUpdateTimerElement.setAttribute('refreshing', 'true');\n  LocationUpdateTimerElement.classList.remove('css_location_update_timer_slide_rtl');\n  document.addEventListener(locationRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateLocation(currentHashSet_hash, busArrivalTimeChartSize.width, busArrivalTimeChartSize.height, locationRefreshTimer_currentRequestID);\n  updateLocationField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (locationRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  locationRefreshTimer_lastUpdate = new Date().getTime();\n  if (locationRefreshTimer_dynamic) {\n    locationRefreshTimer_nextUpdate = Math.max(locationRefreshTimer_lastUpdate + locationRefreshTimer_minInterval, integration.dataUpdateTime + locationRefreshTimer_baseInterval / updateRate);\n  } else {\n    locationRefreshTimer_nextUpdate = locationRefreshTimer_lastUpdate + locationRefreshTimer_baseInterval;\n  }\n  locationRefreshTimer_dynamicInterval = Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - locationRefreshTimer_lastUpdate);\n  locationRefreshTimer_refreshing = false;\n  LocationUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nexport function streamLocation(): void {\n  refreshLocation()\n    .then(function () {\n      if (locationRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamLocation();\n          },\n          Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (locationRefreshTimer_streaming) {\n        promptMessage('error', `${locationRefreshTimer_retryInterval / 1000}`);\n        setTimeout(function () {\n          streamLocation();\n        }, locationRefreshTimer_retryInterval);\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openLocation(hash: IntegratedLocation['hash']): void {\n  pushPageHistory('Location');\n  logRecentView('location', hash);\n  currentHashSet_hash = hash;\n  locationSliding_initialIndex = 0;\n  locationSliding_groupStyles = {};\n  LocationField.setAttribute('displayed', 'true');\n  LocationGroupsElement.scrollLeft = 0;\n  LocationGroupsElement.focus();\n  setUpLocationFieldSkeletonScreen(hash);\n  if (!locationRefreshTimer_streaming) {\n    locationRefreshTimer_streaming = true;\n    if (!locationRefreshTimer_streamStarted) {\n      locationRefreshTimer_streamStarted = true;\n      streamLocation();\n    } else {\n      refreshLocation();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeLocation(): void {\n  // revokePageHistory('Location');\n  LocationField.setAttribute('displayed', 'false');\n  locationRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport function stretchLocationItem(itemElementID: string): void {\n  const itemElement = elementQuerySelector(LocationGroupsElement, `.css_location_group .css_location_group_items .css_location_group_item#${itemElementID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n\n  const itemsElement = itemElement.parentElement as HTMLElement;\n\n  const elementsBelowItemElement = getElementsBelow(itemElement, 'css_location_group_item');\n  const elementsBelowLength = elementsBelowItemElement.length;\n\n  const itemsElementRect = itemsElement.getBoundingClientRect();\n  const itemElementRect = itemElement.getBoundingClientRect();\n\n  // const itemElementX = itemElementRect.left - itemsElementRect.left;\n  const itemElementY = itemElementRect.top - itemsElementRect.top;\n\n  const stretched = itemElement.getAttribute('stretched') === 'true' ? true : false;\n  const animation = itemElement.getAttribute('animation') === 'true' ? true : false;\n\n  if (animation) {\n    const pushDirection = stretched ? '2' : '1';\n\n    // Separate the elements from the document flow while keeping its position\n    itemElement.setAttribute('stretching', 'true');\n    // itemElement.style.setProperty('--b-cssvar-css-location-group-item-x', `${itemElementX}px`);\n    itemElement.style.setProperty('--b-cssvar-css-location-group-item-y', `${itemElementY}px`);\n\n    // Set push direction and push state\n    for (let i = 0; i < elementsBelowLength; i++) {\n      const thisItemElement = elementsBelowItemElement[i];\n      thisItemElement.setAttribute('push-direction', pushDirection);\n      thisItemElement.setAttribute('push-state', '1');\n    }\n\n    itemElement.addEventListener(\n      'transitionend',\n      function () {\n        // Reset the push direction and push state\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-direction', '0');\n          thisItemElement.setAttribute('push-state', '0');\n        }\n        // Deposit the element\n        itemElement.setAttribute('stretching', 'false');\n      },\n      { once: true }\n    );\n\n    itemElement.addEventListener(\n      'transitionstart',\n      function () {\n        // Transition the elements below\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-state', '2');\n        }\n      },\n      { once: true }\n    );\n  }\n\n  if (stretched) {\n    if (animation) {\n      itemBodyElement.addEventListener(\n        'transitionend',\n        function () {\n          itemBodyElement.setAttribute('displayed', 'false');\n        },\n        { once: true }\n      );\n    } else {\n      itemBodyElement.setAttribute('displayed', 'false');\n    }\n    itemElement.setAttribute('stretched', 'false');\n  } else {\n    itemBodyElement.setAttribute('displayed', 'true');\n    itemElement.setAttribute('stretched', 'true');\n  }\n}\n\nexport function switchLocationBodyTab(itemID: string, tabCode: number): void {\n  const itemElement = elementQuerySelector(LocationGroupsElement, `.css_location_group .css_location_group_items .css_location_group_item#${itemID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n  const buttonsElement = elementQuerySelector(itemBodyElement, '.css_location_group_item_buttons');\n  const buttonElements = elementQuerySelectorAll(buttonsElement, '.css_location_group_item_button[highlighted=\"true\"][type=\"tab\"]');\n  for (const t of buttonElements) {\n    t.setAttribute('highlighted', 'false');\n  }\n  elementQuerySelector(buttonsElement, `.css_location_group_item_button[code=\"${tabCode}\"]`).setAttribute('highlighted', 'true');\n  switch (tabCode) {\n    case 0:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      break;\n    case 1:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'true');\n      break;\n    default:\n      break;\n  }\n}\n","import { prepareForSearch, searchFor, SearchItem, SearchResult } from '../../data/search/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { drawRoundedRect } from '../../tools/graphic';\nimport { supportTouch } from '../../tools/index';\nimport { getCSSVariableValue } from '../../tools/style';\nimport { containPhoneticSymbols } from '../../tools/text';\nimport { openBus } from '../bus/index';\nimport { dataDownloadCompleted } from '../home/index';\nimport { getBlankIconElement, getIconElement, setIcon } from '../icons/index';\nimport { MaterialSymbols } from '../icons/material-symbols-type';\nimport { GeneratedElement, pushPageHistory, querySize, revokePageHistory, scrollDocumentToTop } from '../index';\nimport { openLocation } from '../location/index';\nimport { promptMessage } from '../prompt/index';\nimport { openRoute } from '../route/index';\n\nlet previousSearchResults: Array<SearchResult> = [];\n\nconst searchField = documentQuerySelector('.css_search_field');\nconst searchHeadElement = elementQuerySelector(searchField, '.css_search_head');\nconst searchBodyElement = elementQuerySelector(searchField, '.css_search_body');\nconst searchInputElement = elementQuerySelector(searchHeadElement, '.css_search_search_input #search_input') as HTMLInputElement;\nconst searchInputCanvasElement = elementQuerySelector(searchHeadElement, '.css_search_search_input canvas') as HTMLCanvasElement;\nconst searchTypeFilterButtonElement = elementQuerySelector(searchHeadElement, '.css_search_button_right');\nconst searchResultsElement = elementQuerySelector(searchBodyElement, '.css_search_results');\nconst searchKeyboardElement = elementQuerySelector(searchBodyElement, '.css_search_keyboard');\n\nconst searchInputCanvasContext = searchInputCanvasElement.getContext('2d');\nconst searchInputPlaceholder = '';\nconst searchInputCanvasScale = window.devicePixelRatio;\n\nconst padding: number = 15 * searchInputCanvasScale;\nconst cursorWidth: number = 1.8 * searchInputCanvasScale;\nconst cursorBorderRadius: number = 0.9 * searchInputCanvasScale;\nconst selectionHighlightBorderRadius: number = 4 * searchInputCanvasScale;\nconst lineHeight: number = 25 * searchInputCanvasScale;\nconst fontWeight: string = '400';\nconst fontSize: number = 20 * searchInputCanvasScale;\nconst fontFamily: string = '\"Noto Sans TC\", sans-serif';\n\nconst keyboardRows: Array<[string, string, string, string, string]> = [\n  ['', '', '1', '2', '3'],\n  ['', '', '4', '5', '6'],\n  ['', '', '7', '8', '9'],\n  ['', '', '', '0', '']\n];\n\nlet textColor: string = getCSSVariableValue('--b-cssvar-333333');\nlet placeholderTextColor: string = getCSSVariableValue('--b-cssvar-aeaeb2');\nlet cursorColor: string = getCSSVariableValue('--b-cssvar-main-color');\nlet textWidth: number = 0;\nlet textWidthToCursorStart: number = 0;\nlet selectedTextWidth: number = 0;\nlet selection: boolean = false;\nlet cursorOffset: number = 0;\nlet size = querySize('head-two-button');\nlet width = size.width * searchInputCanvasScale;\nlet height = size.height * searchInputCanvasScale;\nlet playingCursorAnimation: boolean = false;\nlet keyboardInitialized = false;\n\nexport function typeTextIntoInput(value): void {\n  const currentValue = getSearchInputValue();\n  const newValue = `${currentValue}${value}`;\n  searchInputElement.value = newValue;\n  updateSearchResult();\n  updateSearchInput(-1, -1);\n  scrollDocumentToTop();\n}\n\nexport function deleteCharFromInput(): void {\n  const currentValue = getSearchInputValue();\n  const newValue = currentValue.substring(0, currentValue.length - 1);\n  searchInputElement.value = newValue;\n  updateSearchResult();\n  updateSearchInput(-1, -1);\n  scrollDocumentToTop();\n}\n\nexport function emptyInput(): void {\n  searchInputElement.value = '';\n  updateSearchResult();\n  updateSearchInput(-1, -1);\n  scrollDocumentToTop();\n}\n\nexport function openSystemKeyboard(event: Event): void {\n  event.preventDefault();\n  searchInputElement.focus();\n  scrollDocumentToTop();\n}\n\nfunction initializeKeyboard(): void {\n  if (!keyboardInitialized) {\n    keyboardInitialized = true;\n    const fragment = new DocumentFragment();\n    for (const row of keyboardRows) {\n      for (const item of row) {\n        const newButtonElement = document.createElement('button');\n        newButtonElement.classList.add('css_search_keyboard_key');\n        const eventName = supportTouch() ? 'touchstart' : 'mousedown';\n        switch (item) {\n          case '':\n            newButtonElement.addEventListener(eventName, deleteCharFromInput);\n            newButtonElement.appendChild(getIconElement('backspace'));\n            break;\n          case '':\n            newButtonElement.addEventListener(eventName, emptyInput);\n            newButtonElement.appendChild(document.createTextNode(item));\n            break;\n          case '':\n            newButtonElement.addEventListener(eventName, openSystemKeyboard);\n            newButtonElement.appendChild(getIconElement('keyboard'));\n            break;\n          default:\n            // Use an IIFE (Immediately Invoked Function Expression) to create a new scope for each item value. This ensures that the item variable is captured by value rather than by reference.\n            newButtonElement.addEventListener(\n              eventName,\n              (function (currentItem) {\n                return function () {\n                  typeTextIntoInput(currentItem);\n                };\n              })(item)\n            );\n            newButtonElement.appendChild(document.createTextNode(item));\n            break;\n        }\n\n        fragment.appendChild(newButtonElement);\n      }\n    }\n    searchKeyboardElement.append(fragment);\n  }\n}\n\nexport function openKeyboard(): void {\n  initializeKeyboard();\n  searchKeyboardElement.setAttribute('displayed', 'true');\n  playingCursorAnimation = true;\n  animateCursor();\n  updateSearchInput(-1, -1);\n}\n\nexport function closeKeyboard(): void {\n  searchKeyboardElement.setAttribute('displayed', 'false');\n  playingCursorAnimation = false;\n}\n\nexport function getSearchTypeFilterValue(): SearchItem['type'] | -1 {\n  return parseInt(searchTypeFilterButtonElement.getAttribute('type'));\n}\n\nexport function getSearchInputValue(): string {\n  return String(searchInputElement.value);\n}\n\nexport function updateSearchInput(cursorStart: number, cursorEnd: number): void {\n  let value = getSearchInputValue();\n  let empty = false;\n  if (value.length === 0) {\n    value = searchInputPlaceholder;\n    empty = true;\n    cursorStart = 0;\n    cursorEnd = 0;\n  } else {\n    if (cursorStart === -1 && cursorEnd === -1) {\n      cursorStart = value.length;\n      cursorEnd = cursorStart * 1;\n    }\n  }\n\n  size = querySize('head-two-button');\n  width = size.width * searchInputCanvasScale;\n  height = size.height * searchInputCanvasScale;\n  textColor = getCSSVariableValue('--b-cssvar-333333');\n  placeholderTextColor = getCSSVariableValue('--b-cssvar-aeaeb2');\n  cursorColor = getCSSVariableValue('--b-cssvar-main-color');\n\n  searchInputCanvasContext.font = `${fontWeight} ${fontSize}px ${fontFamily}`;\n  searchInputCanvasContext.textAlign = 'center';\n  searchInputCanvasContext.textBaseline = 'middle';\n\n  textWidth = searchInputCanvasContext.measureText(value).width;\n  textWidthToCursorStart = searchInputCanvasContext.measureText(value.substring(0, cursorStart)).width;\n  selectedTextWidth = searchInputCanvasContext.measureText(value.substring(cursorStart, cursorEnd)).width;\n  cursorOffset = empty ? 1 : Math.max(1, textWidthToCursorStart);\n\n  searchInputCanvasContext.clearRect(0, 0, width, height);\n\n  if (cursorStart === cursorEnd) {\n    selection = true;\n    searchInputCanvasContext.globalAlpha = 1;\n    searchInputCanvasContext.fillStyle = empty ? placeholderTextColor : textColor;\n    searchInputCanvasContext.fillText(value, textWidth / 2 + (Math.min(cursorOffset, width - padding) - cursorOffset), height / 2);\n    drawRoundedRect(searchInputCanvasContext, Math.min(cursorOffset, width - padding), (height - lineHeight) / 2, cursorWidth, lineHeight, cursorBorderRadius, cursorColor);\n  } else {\n    selection = false;\n    searchInputCanvasContext.globalAlpha = 0.27;\n    drawRoundedRect(searchInputCanvasContext, Math.min(cursorOffset, width - padding), (height - lineHeight) / 2, selectedTextWidth, lineHeight, selectionHighlightBorderRadius, cursorColor);\n    searchInputCanvasContext.globalAlpha = 1;\n    searchInputCanvasContext.fillStyle = empty ? placeholderTextColor : textColor;\n    searchInputCanvasContext.fillText(value, textWidth / 2 + (Math.min(cursorOffset, width - padding) - cursorOffset), height / 2);\n    searchInputCanvasContext.globalAlpha = 0.08;\n    drawRoundedRect(searchInputCanvasContext, Math.min(cursorOffset, width - padding), (height - lineHeight) / 2, selectedTextWidth, lineHeight, selectionHighlightBorderRadius, cursorColor);\n  }\n}\n\nexport function resizeSearchInputCanvas(): void {\n  size = querySize('head-two-button');\n  width = size.width;\n  height = size.height;\n  searchInputCanvasElement.width = width * searchInputCanvasScale;\n  searchInputCanvasElement.height = height * searchInputCanvasScale;\n  updateSearchInput(-1, -1);\n}\n\nfunction animateCursor(): void {\n  const x = performance.now();\n  const alpha = 1 - Math.pow(Math.sin((Math.PI * x) / 960), 4);\n  if (selection) {\n    searchInputCanvasContext.globalAlpha = alpha;\n    searchInputCanvasContext.clearRect(Math.min(cursorOffset, width - padding) - 1, 0, cursorWidth + 2, height);\n    drawRoundedRect(searchInputCanvasContext, Math.min(cursorOffset, width - padding), (height - lineHeight) / 2, cursorWidth, lineHeight, cursorBorderRadius, cursorColor);\n  }\n  if (playingCursorAnimation) {\n    window.requestAnimationFrame(animateCursor);\n  }\n}\n\nfunction generateElementOfSearchResultItem(): GeneratedElement {\n  const searchResultItemElement = document.createElement('div');\n  searchResultItemElement.classList.add('css_search_search_result');\n\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_search_search_result_name');\n\n  const typeElement = document.createElement('div');\n  typeElement.classList.add('css_search_search_result_type');\n  typeElement.appendChild(getBlankIconElement());\n\n  searchResultItemElement.appendChild(typeElement);\n  searchResultItemElement.appendChild(nameElement);\n  return {\n    element: searchResultItemElement,\n    id: ''\n  };\n}\n\nexport function updateSearchResult(): void {\n  const typeToIcon: Array<MaterialSymbols> = ['route', 'location_on', 'directions_bus'];\n\n  function updateItem(element: HTMLElement, currentItem: SearchResult, previousItem: SearchResult | null): void {\n    function updateTypeIcon(item: SearchResult, element: HTMLElement): void {\n      const thisSearchResultTypeElement = elementQuerySelector(element, '.css_search_search_result_type');\n      setIcon(thisSearchResultTypeElement, typeToIcon[item.item.type]);\n    }\n\n    function updateName(item: SearchResult, element: HTMLElement): void {\n      const nameElement = elementQuerySelector(element, '.css_search_search_result_name');\n      nameElement.innerText = item.item.n;\n    }\n\n    function updateClickHandler(item: SearchResult, element: HTMLElement): void {\n      switch (item.item.type) {\n        case 0:\n          element.onclick = function () {\n            openRoute(item.item.id as number, item.item.pid);\n          };\n          break;\n        case 1:\n          element.onclick = function () {\n            openLocation(item.item.hash);\n          };\n          break;\n        case 2:\n          element.onclick = function () {\n            openBus(item.item.id as number);\n          };\n          break;\n        default:\n          break;\n      }\n    }\n    // compare the current item with the previous item\n    if (previousItem) {\n      if (currentItem.item.type !== previousItem.item.type) {\n        updateTypeIcon(currentItem, element);\n      }\n      if (currentItem.item.id !== previousItem.item.id) {\n        updateName(currentItem, element);\n        updateClickHandler(currentItem, element);\n      }\n    }\n    // if the previous item is null, it means this is a new item\n    else {\n      updateTypeIcon(currentItem, element);\n      updateName(currentItem, element);\n      updateClickHandler(currentItem, element);\n    }\n  }\n\n  const currentType = getSearchTypeFilterValue();\n  const currentValue = getSearchInputValue();\n  if (!containPhoneticSymbols(currentValue)) {\n    const searchResults = searchFor(currentValue, currentType, 30);\n    const searchResultLength = searchResults.length;\n    const currentItemCapacity = elementQuerySelectorAll(searchResultsElement, '.css_search_search_result').length;\n    if (searchResultLength !== currentItemCapacity) {\n      const difference = currentItemCapacity - searchResultLength;\n      if (difference < 0) {\n        const fragment = new DocumentFragment();\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newElement = generateElementOfSearchResultItem();\n          fragment.appendChild(newElement.element);\n        }\n        searchResultsElement.appendChild(fragment);\n      } else {\n        const searchResultElements2 = elementQuerySelectorAll(searchResultsElement, '.css_search_search_result');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          searchResultElements2[itemIndex].remove();\n        }\n      }\n    }\n\n    const searchResultElements = elementQuerySelectorAll(searchResultsElement, '.css_search_search_result');\n    for (let i = 0; i < searchResultLength; i++) {\n      const previousItem = previousSearchResults[i];\n      const currentItem = searchResults[i];\n      const thisItemElement = searchResultElements[i];\n      if (previousItem) {\n        updateItem(thisItemElement, currentItem, previousItem);\n      } else {\n        updateItem(thisItemElement, currentItem, null);\n      }\n    }\n    previousSearchResults = searchResults;\n  }\n}\n\nexport function switchSearchTypeFilter(): void {\n  const currentType = getSearchTypeFilterValue();\n  let newType: number = -1;\n  if (currentType >= -1 && currentType < 2) {\n    newType = currentType + 1;\n  } else {\n    newType = -1;\n  }\n  const icons: Array<MaterialSymbols> = ['filter_list', 'route', 'location_on', 'directions_bus'];\n  setIcon(searchTypeFilterButtonElement, icons[newType + 1]);\n  searchTypeFilterButtonElement.setAttribute('type', newType.toString());\n  updateSearchResult();\n}\n\nexport function openSearch(): void {\n  if (dataDownloadCompleted) {\n    pushPageHistory('Search');\n    searchField.setAttribute('displayed', 'true');\n    openKeyboard();\n    prepareForSearch();\n  } else {\n    promptMessage('download_for_offline', '');\n  }\n}\n\nexport function closeSearch(): void {\n  revokePageHistory('Search');\n  closeKeyboard();\n  searchField.setAttribute('displayed', 'false');\n}\n","import { FolderWithContentArray, listFoldersWithContent } from '../folder/index';\nimport { listPersonalSchedules, PersonalScheduleArray } from '../personal-schedule/index';\nimport { listRecentViews, RecentViewArray } from '../recent-views/index';\nimport { listSettingsWithOptions, SettingsWithOptionsArray } from '../settings/index';\n\nexport interface ExportedDataVersion1 {\n  time: string;\n  version: 1;\n  folders: FolderWithContentArray;\n}\n\nexport interface ExportedDataVersion2 {\n  time: string;\n  version: 2;\n  folders: FolderWithContentArray;\n  settings: SettingsWithOptionsArray;\n}\n\nexport interface ExportedDataVersion3 {\n  time: string;\n  version: 3;\n  folders: FolderWithContentArray;\n  settings: SettingsWithOptionsArray;\n  personal_schedules: PersonalScheduleArray;\n}\n\nexport interface ExportedDataVersion4 {\n  time: string;\n  version: 4;\n  folders: FolderWithContentArray;\n  settings: SettingsWithOptionsArray;\n  personal_schedules: PersonalScheduleArray;\n  recent_views: RecentViewArray;\n}\n\nexport type ExportedData = ExportedDataVersion1 | ExportedDataVersion2 | ExportedDataVersion3 | ExportedDataVersion4;\n\nexport async function exportData(): Promise<string> {\n  const foldersWithContent = await listFoldersWithContent();\n  const settings = listSettingsWithOptions();\n  const personalSchedules = await listPersonalSchedules();\n  const RecentViews = await listRecentViews();\n  let result: ExportedDataVersion4 = {};\n  result.time = new Date().toISOString();\n  result.version = 4;\n  result.folders = foldersWithContent;\n  result.settings = settings;\n  result.personal_schedules = personalSchedules;\n  result.recent_views = RecentViews;\n  return JSON.stringify(result);\n}\n","import { openDataUsage } from '../../interface/data-usage/index';\nimport { openFolderManager } from '../../interface/folder-manager/index';\nimport { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { openNotificationScheduleManager } from '../../interface/notification-schedule-manager/index';\nimport { openPersonalScheduleManager } from '../../interface/personal-schedule-manager/index';\nimport { downloadExportFile, openFileToImportData, showPromptToAskForPersistentStorage, viewSourceCodeOfCurrentVersion, viewGitHubRepository } from '../../interface/settings/index';\nimport { openSettingsOptions } from '../../interface/settings/options';\nimport { openStorage } from '../../interface/storage/index';\nimport { dateToRelativeTime, formatTime } from '../../tools/time';\nimport { getNotificationClientStatus } from '../notification/index';\nimport { isStoragePersistent, lfGetItem, lfListItemKeys, lfSetItem } from '../storage/index';\nimport { getHTMLVersionBranchName, getHTMLVersionHash, getHTMLVersionTimeStamp } from './version';\n\ntype SettingType = 'select' | 'page' | 'info' | 'action';\n\nexport interface SettingSelectOptionStringValue {\n  type: 0;\n  string: string;\n}\n\nexport interface SettingSelectOptionNumberValue {\n  type: 1;\n  number: number;\n}\n\nexport interface SettingSelectOptionBooleanValue {\n  type: 2;\n  boolean: boolean;\n}\n\nexport interface SettingSelectOptionRefreshIntervalValue {\n  type: 3;\n  baseInterval: number;\n  dynamic: boolean;\n}\n\nexport type SettingSelectOptionValue = SettingSelectOptionStringValue | SettingSelectOptionNumberValue | SettingSelectOptionBooleanValue | SettingSelectOptionRefreshIntervalValue;\n\nexport interface SettingSelectOption {\n  name: string;\n  value: SettingSelectOptionValue;\n  resourceIntensive: boolean;\n  powerSavingAlternative: -1 | number; // index of the option to redirect to when power saving mode is enabled\n}\n\nexport type SettingSelectOptions = Array<SettingSelectOption>;\n\nexport interface SettingSelect {\n  key: string;\n  name: string;\n  icon: MaterialSymbols;\n  status: string;\n  action: Function;\n  type: 'select';\n  default_option: number;\n  option: number;\n  options: SettingSelectOptions;\n  description: string;\n}\n\nexport interface SettingPage {\n  key: string;\n  name: string;\n  icon: MaterialSymbols;\n  status: string;\n  type: 'page';\n  action: Function;\n  description: string;\n}\n\nexport interface SettingInfo {\n  key: string;\n  name: string;\n  icon: MaterialSymbols;\n  status: string;\n  type: 'info';\n  action: Function;\n  description: string;\n}\n\nexport interface SettingAction {\n  key: string;\n  name: string;\n  icon: MaterialSymbols;\n  status: string;\n  type: 'action';\n  action: Function;\n  description: string;\n}\n\nexport type Setting = SettingSelect | SettingPage | SettingInfo | SettingAction;\n\nexport type SettingsObject = { [key: string]: Setting };\n\nexport type SettingsArray = Array<Setting>;\n\nexport interface SettingWithOption {\n  key: string;\n  option: number;\n}\n\nexport type SettingsWithOptionsArray = Array<SettingWithOption>;\n\nconst SettingKeys: Array<string> = ['time_formatting_mode', 'refresh_interval', 'display_user_location', 'display_user_orientation', 'location_labels', 'proxy', 'folder', 'personal_schedule', 'notification', 'playing_animation', 'power_saving', 'data_usage', 'storage', 'persistent_storage', 'export', 'import', 'version', 'branch', 'last_update_date', 'github'];\n\nlet Settings: SettingsObject = {\n  time_formatting_mode: {\n    key: 'time_formatting_mode',\n    name: '',\n    icon: 'glyphs',\n    status: '',\n    action: function () {\n      openSettingsOptions('time_formatting_mode');\n    },\n    type: 'select',\n    default_option: 0,\n    option: 0,\n    options: [\n      {\n        name: `${formatTime(11, 3)}/${formatTime(61, 3)}/${formatTime(60 * 61 + 1, 3)}`,\n        value: {\n          type: 1,\n          number: 3\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: `${formatTime(11, 2)}/${formatTime(61, 2)}/${formatTime(60 * 61 + 1, 2)}`,\n        value: {\n          type: 1,\n          number: 2\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: `${formatTime(11, 1)}/${formatTime(61, 1)}/${formatTime(60 * 61 + 1, 1)}`,\n        value: {\n          type: 1,\n          number: 1\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: `${formatTime(11, 0)}/${formatTime(61, 0)}/${formatTime(60 * 61 + 1, 0)}`,\n        value: {\n          type: 1,\n          number: 0\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ],\n    description: ''\n  },\n  refresh_interval: {\n    key: 'refresh_interval',\n    name: '',\n    icon: 'pace',\n    status: '',\n    action: function () {\n      openSettingsOptions('refresh_interval');\n    },\n    type: 'select',\n    default_option: 0,\n    option: 0,\n    options: [\n      {\n        name: '',\n        value: {\n          baseInterval: 15 * 1000,\n          dynamic: true,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 2\n      },\n      {\n        name: '10',\n        value: {\n          baseInterval: 10 * 1000,\n          dynamic: false,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 2\n      },\n      {\n        name: '20',\n        value: {\n          baseInterval: 20 * 1000,\n          dynamic: false,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 3\n      },\n      {\n        name: '30',\n        value: {\n          baseInterval: 30 * 1000,\n          dynamic: false,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 4\n      },\n      {\n        name: '40',\n        value: {\n          baseInterval: 40 * 1000,\n          dynamic: false,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 5\n      },\n      {\n        name: '50',\n        value: {\n          baseInterval: 50 * 1000,\n          dynamic: false,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 6\n      },\n      {\n        name: '60',\n        value: {\n          baseInterval: 60 * 1000,\n          dynamic: false,\n          type: 3\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 6\n      }\n    ],\n    description: ''\n  },\n  display_user_location: {\n    key: 'display_user_location',\n    name: '',\n    icon: 'near_me',\n    status: '',\n    action: function () {\n      openSettingsOptions('display_user_location');\n    },\n    type: 'select',\n    default_option: 1,\n    option: 1,\n    options: [\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: true\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 1\n      },\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: false\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ],\n    description: ''\n  },\n  display_user_orientation: {\n    key: 'display_user_orientation',\n    name: '',\n    icon: 'explore',\n    status: '',\n    action: function () {\n      openSettingsOptions('display_user_orientation');\n    },\n    type: 'select',\n    default_option: 1,\n    option: 1,\n    options: [\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: true\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 1\n      },\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: false\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ],\n    description: ''\n  },\n  location_labels: {\n    key: 'location_labels',\n    name: '',\n    icon: 'tag',\n    status: '',\n    action: function () {\n      openSettingsOptions('location_labels');\n    },\n    type: 'select',\n    default_option: 0,\n    option: 0,\n    options: [\n      {\n        name: '',\n        value: {\n          type: 0,\n          string: 'directions'\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: '',\n        value: {\n          type: 0,\n          string: 'address'\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: '',\n        value: {\n          type: 0,\n          string: 'letters'\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ],\n    description: ''\n  },\n  proxy: {\n    key: 'proxy',\n    name: '',\n    icon: 'router',\n    status: '',\n    action: function () {\n      openSettingsOptions('proxy');\n    },\n    type: 'select',\n    default_option: 1,\n    option: 1,\n    options: [\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: true\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: false\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ],\n    description: ''\n  },\n  folder: {\n    key: 'folder',\n    name: '',\n    icon: 'folder',\n    status: '',\n    type: 'page',\n    action: openFolderManager,\n    description: ''\n  },\n  personal_schedule: {\n    key: 'personal_schedule',\n    name: '',\n    icon: 'calendar_view_day',\n    status: '',\n    action: openPersonalScheduleManager,\n    type: 'page',\n    description: ''\n  },\n  notification: {\n    key: 'notification',\n    name: '',\n    icon: 'notifications',\n    status: '',\n    action: openNotificationScheduleManager,\n    type: 'page',\n    description: ''\n  },\n  playing_animation: {\n    key: 'playing_animation',\n    name: '',\n    icon: 'animation',\n    description: '',\n    status: '',\n    type: 'select',\n    action: function () {\n      openSettingsOptions('playing_animation');\n    },\n    default_option: 0,\n    option: 0,\n    options: [\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: true\n        },\n        resourceIntensive: true,\n        powerSavingAlternative: 1\n      },\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: false\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ]\n  },\n  power_saving: {\n    key: 'power_saving',\n    name: '',\n    icon: 'battery_low',\n    description: '',\n    status: '',\n    type: 'select',\n    action: function () {\n      openSettingsOptions('power_saving');\n    },\n    default_option: 1,\n    option: 1,\n    options: [\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: true\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      },\n      {\n        name: '',\n        value: {\n          type: 2,\n          boolean: false\n        },\n        resourceIntensive: false,\n        powerSavingAlternative: -1\n      }\n    ]\n  },\n  data_usage: {\n    key: 'data_usage',\n    name: '',\n    icon: 'bigtop_updates',\n    status: '',\n    type: 'page',\n    action: openDataUsage,\n    description: ''\n  },\n  storage: {\n    key: 'storage',\n    name: '',\n    icon: 'database',\n    status: '',\n    type: 'page',\n    action: openStorage,\n    description: ''\n  },\n  persistent_storage: {\n    key: 'persistent_storage',\n    name: '',\n    icon: 'storage',\n    status: '',\n    action: showPromptToAskForPersistentStorage,\n    type: 'action',\n    description: ''\n  },\n  export: {\n    key: 'export',\n    name: '',\n    icon: 'upload',\n    status: '',\n    type: 'action',\n    action: downloadExportFile,\n    description: ''\n  },\n  import: {\n    key: 'import',\n    name: '',\n    icon: 'download',\n    status: '',\n    type: 'action',\n    action: openFileToImportData,\n    description: ''\n  },\n  version: {\n    key: 'version',\n    name: '',\n    icon: 'commit',\n    status: '',\n    type: 'info',\n    action: viewSourceCodeOfCurrentVersion,\n    description: ''\n  },\n  branch: {\n    key: 'branch',\n    name: '',\n    icon: 'rebase',\n    status: '',\n    type: 'info',\n    action: function () {},\n    description: ''\n  },\n  last_update_date: {\n    key: 'last_update_date',\n    name: '',\n    icon: 'update',\n    status: '',\n    type: 'info',\n    action: function () {},\n    description: ''\n  },\n  github: {\n    key: 'github',\n    name: 'GitHub',\n    icon: 'book_2',\n    status: '@EricHsia7/bus',\n    type: 'info',\n    action: viewGitHubRepository,\n    description: ''\n  }\n};\n\nexport async function initializeSettings(): Promise<boolean> {\n  const userSettings = await lfListItemKeys(1);\n  for (const key of userSettings) {\n    if (SettingKeys.indexOf(key) > -1) {\n      const userSetting = await lfGetItem(1, key);\n      if (userSetting !== null) {\n        if (Settings[key].type === 'select') {\n          const userSettingOption = parseInt(userSetting);\n          Settings[key].option = userSettingOption;\n        }\n      } else {\n        if (Settings[key].type === 'select') {\n          Settings[key].option = Settings[key].default_option;\n        }\n      }\n    }\n  }\n  return true;\n}\n\nexport async function listSettings(): Promise<SettingsArray> {\n  const result: SettingsArray = [];\n  for (const key in Settings) {\n    let item = Settings[key];\n    switch (item.type) {\n      case 'select':\n        item.status = item.options[item.option].name;\n        break;\n      case 'page':\n        switch (key) {\n          case 'notification':\n            item.status = getNotificationClientStatus() ? '' : '';\n            break;\n          default:\n            item.status = '';\n            break;\n        }\n        break;\n      case 'action':\n        item.status = '';\n        if (key === 'persistent_storage') {\n          item.status = (await isStoragePersistent()) ? '' : '';\n        }\n        break;\n      case 'info':\n        if (key === 'version') {\n          item.status = getHTMLVersionHash();\n        }\n        if (key === 'branch') {\n          item.status = getHTMLVersionBranchName();\n        }\n        if (key === 'last_update_date') {\n          const date = new Date(getHTMLVersionTimeStamp());\n          item.status = dateToRelativeTime(date);\n        }\n        break;\n      default:\n        break;\n    }\n    result.push(item);\n  }\n  return result;\n}\n\nexport function listSettingsWithOptions(): SettingsWithOptionsArray {\n  let result: SettingsWithOptionsArray = [];\n  for (const key in Settings) {\n    if (SettingKeys.indexOf(key) > -1) {\n      if (Settings.hasOwnProperty(key)) {\n        if (Settings[key].type === 'select') {\n          const item: SettingWithOption = {\n            key: key,\n            option: Settings[key].option\n          };\n          result.push(item);\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport async function changeSettingOption(key: string, option: number): Promise<boolean> {\n  if (SettingKeys.indexOf(key) > -1) {\n    if (Settings.hasOwnProperty(key)) {\n      if (Settings[key].type === 'select') {\n        if (Settings[key].options[option] !== undefined && Settings[key].options[option] !== null) {\n          await lfSetItem(1, key, option);\n          Settings[key].option = option;\n          return true;\n        }\n      }\n    }\n  }\n  return false;\n}\n\nexport function getSetting(key: string): Setting | undefined {\n  if (SettingKeys.indexOf(key) > -1) {\n    if (Settings.hasOwnProperty(key)) {\n      return Settings[key];\n    }\n  }\n}\n\nexport function getSettingOptionValue(key: string): SettingSelectOptionStringValue['string'] | SettingSelectOptionNumberValue['number'] | SettingSelectOptionBooleanValue['boolean'] | SettingSelectOptionRefreshIntervalValue {\n  if (SettingKeys.indexOf(key) > -1) {\n    if (Settings.hasOwnProperty(key)) {\n      const powerSavingSetting = Settings['power_saving'] as SettingSelect;\n      const powerSavingSettingValue = powerSavingSetting.options[powerSavingSetting.option].value as SettingSelectOptionBooleanValue;\n      const powerSavingSettingValueBoolean = powerSavingSettingValue.boolean;\n      const thisSetting = Settings[key] as SettingSelect;\n      let thisSettingOption = thisSetting.options[thisSetting.option];\n      if (powerSavingSettingValueBoolean) {\n        if (thisSettingOption.resourceIntensive) {\n          thisSettingOption = thisSetting.options[thisSettingOption.powerSavingAlternative];\n        }\n      }\n      const thisSettingValue = thisSettingOption.value;\n      switch (thisSettingValue.type) {\n        case 0:\n          return thisSettingValue.string as string;\n          break;\n        case 1:\n          return thisSettingValue.number as number;\n          break;\n        case 2:\n          return thisSettingValue.boolean as boolean;\n          break;\n        case 3:\n          return thisSettingValue as SettingSelectOptionRefreshIntervalValue;\n          break;\n        default:\n          return '' as string;\n          break;\n      }\n    }\n  }\n  return '';\n}\n","import { ExportedData } from '../export/index';\nimport { createFolder, FolderWithContentArray, saveToFolder, updateFolder } from '../folder/index';\nimport { createPersonalSchedule, getPersonalSchedule, PersonalScheduleArray, updatePersonalSchedule } from '../personal-schedule/index';\nimport { getRecentView, logRecentView, RecentViewArray } from '../recent-views/index';\nimport { changeSettingOption, getSetting, SettingsWithOptionsArray } from '../settings/index';\nimport { lfGetItem } from '../storage/index';\n\nexport async function importFolders(data: FolderWithContentArray): Promise<boolean> {\n  for (const FolderWithContent of data) {\n    const folder = FolderWithContent;\n    var update = false;\n    var creation = false;\n    const folderKey: string = `f_${folder.id}`;\n    const existingFolder: string = await lfGetItem(11, folderKey);\n    if (existingFolder) {\n      update = await updateFolder(folder.id, folder.name, folder.icon);\n    } else {\n      creation = await createFolder(folder.name, folder.icon);\n    }\n    if (update) {\n      for (const content of FolderWithContent.content) {\n        await saveToFolder(FolderWithContent.id, content);\n      }\n    }\n    if (creation) {\n      for (const content of FolderWithContent.content) {\n        await saveToFolder(creation, content);\n      }\n    }\n  }\n}\n\nexport async function importSettings(data: SettingsWithOptionsArray): Promise<boolean> {\n  for (const SettingWithOption of data) {\n    const existingSetting = getSetting(SettingWithOption.key);\n    if (existingSetting) {\n      if (existingSetting.type === 'select') {\n        await changeSettingOption(SettingWithOption.key, SettingWithOption.option);\n      }\n    }\n  }\n  return true;\n}\n\nexport async function importPersonalSchedules(data: PersonalScheduleArray): Promise<boolean> {\n  for (const PersonalSchedule of data) {\n    const existingPersonalSchedule = await getPersonalSchedule(PersonalSchedule.id);\n    if (existingPersonalSchedule) {\n      await updatePersonalSchedule(PersonalSchedule);\n    } else {\n      await createPersonalSchedule(PersonalSchedule.name, PersonalSchedule.period.start.hours, PersonalSchedule.period.start.minutes, PersonalSchedule.period.end.hours, PersonalSchedule.period.end.minutes, PersonalSchedule.days);\n    }\n  }\n  return true;\n}\n\nexport async function importRecentViews(data: RecentViewArray): Promise<boolean> {\n  for (const RecentView of data) {\n    switch (RecentView.type) {\n      case 'route':\n        const existingRecentViewRoute = await getRecentView('route', RecentView.id);\n        if (!existingRecentViewRoute) {\n          await logRecentView(RecentView.type, RecentView.id);\n        }\n        break;\n      case 'location':\n        const existingRecentViewLocation = await getRecentView('location', RecentView.hash);\n        if (!existingRecentViewLocation) {\n          await logRecentView(RecentView.type, RecentView.hash);\n        }\n        break;\n      case 'bus':\n        const existingRecentViewBus = await getRecentView('bus', RecentView.id);\n        if (!existingRecentViewBus) {\n          await logRecentView(RecentView.type, RecentView.id);\n        }\n        break;\n      default:\n        break;\n    }\n  }\n  return true;\n}\n\nexport async function importData(data: string): Promise<boolean> {\n  const parsedData: ExportedData = JSON.parse(data);\n  switch (parsedData.version) {\n    case 1:\n      await importFolders(parsedData.folders);\n      return true;\n      break;\n    case 2:\n      await importFolders(parsedData.folders);\n      await importSettings(parsedData.settings);\n      return true;\n      break;\n    case 3:\n      await importFolders(parsedData.folders);\n      await importSettings(parsedData.settings);\n      await importPersonalSchedules(parsedData.personal_schedules);\n      return true;\n      break;\n    case 4:\n      await importFolders(parsedData.folders);\n      await importSettings(parsedData.settings);\n      await importPersonalSchedules(parsedData.personal_schedules);\n      await importRecentViews(parsedData.recent_views);\n      return true;\n      break;\n    default:\n      return false;\n      break;\n  }\n}\n","import { documentQuerySelector } from '../../tools/elements';\n\nfunction refreshPageWithTimeStamp(id: string, enforce: boolean = false): void {\n  // Get the URLSearchParams object from the current URL\n  const searchParams = new URLSearchParams(window.location.search);\n  // Set the 'timestamp' query parameter to the current timestamp\n  searchParams.set('v', id);\n  // Construct the new URL with updated query parameters\n  const newUrl = window.location.pathname + '?' + searchParams.toString();\n  if (enforce) {\n    // Redirect to the new URL\n    window.location.replace(newUrl);\n  } else {\n    history.replaceState(null, '', newUrl);\n  }\n}\n\ninterface AppVersion {\n  build: number;\n  hash: string;\n  full_hash: string;\n  branch_name: string; // branch name of the code base\n  timestamp: string; // timestamp in ISO fromat\n}\n\nasync function getAppVersion(): Promise<AppVersion | false> {\n  try {\n    const response = await fetch(`./version.json?_=${new Date().getTime()}`, {\n      cache: 'no-store'\n    });\n    if (!response.ok) {\n      throw new Error('Network response was not ok');\n    }\n    return response.json();\n  } catch (error) {\n    console.error('There was a problem with the fetch operation:', error);\n    return false;\n  }\n}\n\nexport function getHTMLVersionHash(): string {\n  return documentQuerySelector('head meta[name=\"version-hash\"]').getAttribute('content');\n}\n\nexport function getHTMLVersionFullHash(): string {\n  return documentQuerySelector('head meta[name=\"version-full-hash\"]').getAttribute('content');\n}\n\nexport function getHTMLVersionBranchName(): string {\n  return documentQuerySelector('head meta[name=\"version-branch-name\"]').getAttribute('content');\n}\n\nexport function getTreeURLOfCurrentVersion(): string {\n  const currentFullHash = getHTMLVersionFullHash();\n  return `https://github.com/EricHsia7/bus/tree/${currentFullHash}`;\n}\n\nexport function getHTMLVersionTimeStamp(): string {\n  return documentQuerySelector('head meta[name=\"version-time-stamp\"]').getAttribute('content');\n}\n\ntype AppVersionStatus = 'fetchError' | 'unknownError' | 'refreshing' | 'ok';\n\nexport async function checkAppVersion(): Promise<AppVersionStatus> {\n  const appVersion = await getAppVersion();\n  if (typeof appVersion === 'boolean') {\n    if (appVersion === false) {\n      return 'fetchError';\n    } else {\n      return 'unknownError';\n    }\n  } else {\n    if (getHTMLVersionHash() !== appVersion.hash) {\n      refreshPageWithTimeStamp(appVersion.hash, true);\n      return 'refreshing';\n    } else {\n      refreshPageWithTimeStamp(appVersion.hash, false);\n      return 'ok';\n    }\n  }\n}\n","import { exportData } from '../../data/export/index';\nimport { importData } from '../../data/import/index';\nimport { listSettings, Setting } from '../../data/settings/index';\nimport { getTreeURLOfCurrentVersion } from '../../data/settings/version';\nimport { askForPersistentStorage } from '../../data/storage/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { generateIdentifier, releaseFile } from '../../tools/index';\nimport { getIconElement } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst SettingsField = documentQuerySelector('.css_settings_field');\nconst SettingsBodyElement = elementQuerySelector(SettingsField, '.css_settings_body');\nconst SettingsElement = elementQuerySelector(SettingsBodyElement, '.css_settings');\n\nfunction generateElementOfItem(item: Setting): GeneratedElement {\n  const settingElement = document.createElement('div');\n  settingElement.classList.add('css_setting');\n  settingElement.setAttribute('type', item.type);\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_setting_icon');\n  const iconSpanElement = document.createElement('span');\n  iconSpanElement.appendChild(getIconElement(item.icon));\n  iconElement.appendChild(iconSpanElement);\n\n  // Name\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_setting_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_setting_status');\n  statusElement.appendChild(document.createTextNode(item.status));\n\n  // Arrow\n  const arrowElement = document.createElement('div');\n  arrowElement.classList.add('css_setting_arrow');\n  const arrowSpanElement = document.createElement('span');\n  arrowSpanElement.appendChild(getIconElement('arrow_forward_ios'));\n  arrowElement.appendChild(arrowSpanElement);\n\n  // Event handler (lambda)\n  if (typeof item.action === 'function') {\n    settingElement.onclick = function () {\n      item.action();\n    };\n  } else if (typeof item.action === 'string') {\n    settingElement.setAttribute('onclick', item.action);\n  }\n\n  // Assemble\n  settingElement.appendChild(iconElement);\n  settingElement.appendChild(nameElement);\n  settingElement.appendChild(statusElement);\n  settingElement.appendChild(arrowElement);\n\n  return {\n    element: settingElement,\n    id: ''\n  };\n}\n\nasync function initializeSettingsField() {\n  const list = await listSettings();\n  SettingsElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  for (const item of list) {\n    const thisElement = generateElementOfItem(item);\n    fragment.appendChild(thisElement.element);\n  }\n  SettingsElement.append(fragment);\n}\n\nexport function openSettings(): void {\n  pushPageHistory('Settings');\n  SettingsField.setAttribute('displayed', 'true');\n  initializeSettingsField();\n}\n\nexport function closeSettings(): void {\n  revokePageHistory('Settings');\n  SettingsField.setAttribute('displayed', 'false');\n}\n\nexport async function downloadExportFile() {\n  promptMessage('manufacturing', '');\n  const content = await exportData();\n  releaseFile(content, 'application/json', 'bus-export.json');\n}\n\nexport function openFileToImportData(): void {\n  const identifier = generateIdentifier();\n  const fileInput = document.createElement('input');\n  fileInput.setAttribute('type', 'file');\n  fileInput.setAttribute('accept', 'application/json');\n  fileInput.setAttribute('name', identifier);\n  fileInput.id = identifier;\n  fileInput.classList.add('css_import_file_input');\n  fileInput.addEventListener(\n    'change',\n    function (event) {\n      // Check if a file is selected\n      if (event.target.files.length === 0) {\n        documentQuerySelector(`body #${identifier}`).remove();\n      } else {\n        // Get the first file selected by the user\n        const file = event.target.files[0];\n        const reader = new FileReader();\n\n        // When the file is successfully read\n        reader.onload = function (e) {\n          // Get the file content as text\n          const fileTextContent = e.target.result;\n\n          // Import the data\n          importData(fileTextContent).then((f) => {\n            if (f) {\n              promptMessage('check_circle', '');\n            } else {\n              promptMessage('error', '');\n            }\n            documentQuerySelector(`body #${identifier}`).remove();\n          });\n        };\n\n        // Read the file as text\n        reader.readAsText(file);\n      }\n    },\n    { once: true }\n  );\n  fileInput.addEventListener(\n    'cancel',\n    function () {\n      documentQuerySelector(`body #${identifier}`).remove();\n    },\n    { once: true }\n  );\n\n  document.body.append(fileInput);\n  documentQuerySelector(`body #${identifier}`).click();\n}\n\nexport function viewSourceCodeOfCurrentVersion(): void {\n  const url = getTreeURLOfCurrentVersion();\n  window.open(url);\n}\n\nexport function viewGitHubRepository(): void {\n  const url = 'https://github.com/EricHsia7/bus';\n  window.open(url);\n}\n\nexport function showPromptToAskForPersistentStorage(): void {\n  askForPersistentStorage().then((e) => {\n    switch (e) {\n      case 'granted':\n        promptMessage('check_circle', '');\n        break;\n      case 'denied':\n        promptMessage('cancel', '');\n        break;\n      case 'unsupported':\n        promptMessage('warning', '');\n        break;\n      default:\n        promptMessage('error', '');\n        break;\n    }\n  });\n}\n","import { promptMessage } from '../interface/prompt/index';\n\nexport const md5 = require('md5');\nexport const { sha512 } = require('js-sha512');\n\nexport function compareThings(a: any, b: any): boolean {\n  function anyToString(any: any): string {\n    return JSON.stringify({ e: any });\n  }\n  const ax = anyToString(a);\n  const bx = anyToString(b);\n  const length: number = 32;\n  const axLength: number = ax.length;\n  const bxLength: number = bx.length;\n  if (axLength === bxLength) {\n    if (axLength > length || bxLength > length) {\n      const hash_a: string = md5(ax);\n      const hash_b: string = md5(bx);\n\n      let equal: boolean = true;\n      for (let i = 0; i < 8; i++) {\n        const a_i: string = hash_a.charAt(i);\n        const b_i: string = hash_b.charAt(i);\n        if (a_i === b_i) {\n          continue;\n        } else {\n          equal = false;\n          break;\n        }\n      }\n      return equal;\n    } else {\n      if (ax === bx) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  } else {\n    return false;\n  }\n}\n\nexport function generateIdentifier(): string {\n  const chars = [\n    [48, 10], // 0-9: 48 - 57\n    [97, 26], // a-z: 97 - 122\n    [65, 26] // A-Z: 65 - 90\n  ];\n\n  let randomNumber1 = Math.floor(Math.random() * 0x10000000);\n  let randomNumber2 = Math.floor(Math.random() * 0x10000000);\n\n  const result = new Uint8Array(17);\n  result[0] = 95;\n  for (let i = 16; i > 0; i--) {\n    const n = randomNumber2 % 3;\n    const range = chars[n];\n    const code = range[0] + (randomNumber1 % range[1]);\n    result[i] = code;\n    randomNumber1 >>>= 1;\n    randomNumber2 >>>= 1;\n  }\n\n  return String.fromCharCode.apply(null, result);\n}\n\nexport function getNoCacheParameter(interval: number): string {\n  const time = new Date().getTime();\n  const number = (time / interval) | 0;\n  const string = number.toString(16);\n  return string;\n}\n\nexport function downloadBlobFile(blob: Blob, fileName: string, timeout: number = 32 * 1000): string {\n  const blobURL = URL.createObjectURL(blob);\n  const downloadLink = document.createElement('a');\n  downloadLink.href = blobURL;\n  downloadLink.download = fileName;\n  document.body.appendChild(downloadLink);\n  downloadLink.click();\n  downloadLink.remove();\n  setTimeout(() => {\n    URL.revokeObjectURL(blobURL);\n  }, timeout);\n  return blobURL;\n}\n\nexport function releaseFile(content: string, type: string = 'application/json', fileName: string): void {\n  const blob = new Blob([content], { type: type });\n  const fileObj = new File([blob], fileName, { type: type });\n  if (navigator.canShare && navigator.canShare({ files: [fileObj] })) {\n    navigator\n      .share({\n        files: [fileObj]\n      })\n      .catch((error) => {\n        promptMessage('download', '', {\n          text: '',\n          action: function () {\n            downloadBlobFile(blob, fileName);\n          }\n        });\n      });\n  } else {\n    downloadBlobFile(blob, fileName);\n  }\n}\n\nexport function isRunningStandalone(): boolean {\n  return window.matchMedia('(display-mode: standalone)').matches;\n}\n\nexport function supportTouch(): boolean {\n  if ('ontouchstart' in window || navigator.maxTouchPoints) {\n    // Touch events are supported\n    return true;\n  } else {\n    // Touch events are not supported\n    return false;\n  }\n}\n\nexport function booleanToString(x: boolean): 'true' | 'false' {\n  if (typeof x === 'boolean') {\n    if (x) {\n      return 'true';\n    } else {\n      return 'false';\n    }\n  }\n}\n\nexport function isValidURL(string: string): boolean {\n  try {\n    new URL(string);\n    return true; // If no error is thrown, it's a valid URL\n  } catch (_) {\n    return false; // Invalid URL\n  }\n}\n\nexport function nearestPowerOf2(x: number): number {\n  return 1 << (31 - Math.clz32(x));\n}\n","import { documentQuerySelector } from '../tools/elements';\nimport { isRunningStandalone } from '../tools/index';\nimport { closeBus, openBus } from './bus/index';\nimport { closeFolderCreator, openFolderCreator } from './folder-creator/index';\nimport { closeFolderEditor, openFolderEditor } from './folder-editor/index';\nimport { closeFolderManager, openFolderManager } from './folder-manager/index';\nimport { closePersonalScheduleEditor, openPersonalScheduleEditor } from './personal-schedule-editor/index';\nimport { closePersonalScheduleManager, openPersonalScheduleManager } from './personal-schedule-manager/index';\nimport { closeRegisterNotification, openRegisterNotification } from './register-notification/index';\nimport { closeSearch, openSearch } from './search/index';\nimport { closeSettings, openSettings } from './settings/index';\n\nconst SplashScreenElement = documentQuerySelector('.css_splash_screen');\nconst ErrorMessageElement = documentQuerySelector('.css_error_message');\n\nconst splashScreenTimer_minimalTimeOut = 100;\nconst splashScreenTimer_openTime = new Date().getTime();\n\ntype Page = 'Home' | 'FolderCreator' | 'FolderEditor' | 'FolderIconSelector' | 'FolderManager' | 'LocationDetails' | 'Location' | 'RouteDetails' | 'Route' | 'SaveToFolder' | 'Search' | 'Settings' | 'SettingsOptions' | 'DataUsage' | 'PersonalScheduleManager' | 'PersonalScheduleCreator' | 'PersonalScheduleEditor' | 'Bus' | 'RegisterNotification' | 'ScheduleNotification' | 'NotificationScheduleManager' | 'QRCode';\n\nlet pageHistory: Array<Page> = ['Home'];\n\nexport function pushPageHistory(page: Page): void {\n  const pageHistoryLength = pageHistory.length;\n  const lastPage = pageHistory[pageHistoryLength - 1];\n  if (lastPage !== page) {\n    pageHistory.push(page);\n  }\n}\n\nexport function revokePageHistory(page: Page): void {\n  if (pageHistory.indexOf(page) > -1) {\n    const pageHistoryLength = pageHistory.length;\n    if (pageHistory[pageHistoryLength - 1] === page) {\n      pageHistory.pop();\n    }\n  }\n}\n\nexport function closePreviousPage(): void {\n  const pageHistoryLength = pageHistory.length;\n  if (pageHistoryLength > 1) {\n    const previousPage = pageHistory[pageHistoryLength - 2];\n    switch (previousPage) {\n      case 'Home':\n        break;\n      case 'FolderCreator':\n        closeFolderCreator();\n        break;\n      case 'FolderEditor':\n        closeFolderEditor();\n        break;\n      case 'FolderIconSelector':\n        break;\n      case 'FolderManager':\n        closeFolderManager();\n        break;\n      case 'Location':\n        break;\n      case 'LocationDetails':\n        break;\n      case 'Route':\n        break;\n      case 'RouteDetails':\n        break;\n      case 'SaveToFolder':\n        break;\n      case 'Search':\n        closeSearch();\n        break;\n      case 'Settings':\n        closeSettings();\n        break;\n      case 'SettingsOptions':\n        break;\n      case 'DataUsage':\n        break;\n      case 'PersonalScheduleManager':\n        closePersonalScheduleManager();\n        break;\n      case 'PersonalScheduleCreator':\n        break;\n      case 'PersonalScheduleEditor':\n        closePersonalScheduleEditor();\n        break;\n      case 'Bus':\n        closeBus();\n        break;\n      case 'RegisterNotification':\n        closeRegisterNotification();\n        break;\n      case 'ScheduleNotification':\n        break;\n      case 'NotificationScheduleManager':\n        break;\n      case 'QRCode':\n        break;\n      default:\n        break;\n    }\n  }\n}\n\nexport function openPreviousPage(): void {\n  const pageHistoryLength = pageHistory.length;\n  if (pageHistoryLength > 1) {\n    const previousPage = pageHistory[pageHistoryLength - 2];\n    pageHistory.pop();\n    switch (previousPage) {\n      case 'Home':\n        break;\n      case 'FolderCreator':\n        openFolderCreator();\n        break;\n      case 'FolderEditor':\n        openFolderEditor();\n        break;\n      case 'FolderIconSelector':\n        break;\n      case 'FolderManager':\n        openFolderManager();\n        break;\n      case 'Location':\n        break;\n      case 'LocationDetails':\n        break;\n      case 'Route':\n        break;\n      case 'RouteDetails':\n        break;\n      case 'SaveToFolder':\n        break;\n      case 'Search':\n        openSearch();\n        break;\n      case 'Settings':\n        openSettings();\n        break;\n      case 'SettingsOptions':\n        break;\n      case 'DataUsage':\n        break;\n      case 'PersonalScheduleManager':\n        openPersonalScheduleManager();\n        break;\n      case 'PersonalScheduleCreator':\n        break;\n      case 'PersonalScheduleEditor':\n        openPersonalScheduleEditor();\n        break;\n      case 'Bus':\n        openBus();\n        break;\n      case 'RegisterNotification':\n        openRegisterNotification();\n        break;\n      case 'ScheduleNotification':\n        break;\n      case 'NotificationScheduleManager':\n        break;\n      case 'QRCode':\n        break;\n      default:\n        break;\n    }\n  }\n}\n\nexport function setSplashScreenIconOffsetY(): void {\n  let offset = 0;\n  if (isRunningStandalone()) {\n    offset = (-1 * (window.outerHeight - window.innerHeight)) / 2;\n  }\n  documentQuerySelector('.css_splash_screen svg.css_splash_screen_icon').style.setProperty('--b-cssvar-splash-screen-icon-offset-y', `${offset}px`);\n}\n\nexport function fadeOutSplashScreen(callback: Function): void {\n  function fadeOut() {\n    SplashScreenElement.classList.add('css_splash_screen_fade_out');\n    SplashScreenElement.addEventListener(\n      'animationend',\n      function () {\n        SplashScreenElement.setAttribute('displayed', 'false');\n        SplashScreenElement.classList.remove('css_splash_screen_fade_out');\n        if (typeof callback === 'function') {\n          callback();\n        }\n      },\n      { once: true }\n    );\n  }\n  const cureentTime = new Date().getTime();\n  if (cureentTime - splashScreenTimer_openTime < splashScreenTimer_minimalTimeOut) {\n    setTimeout(fadeOut, Math.max(1, cureentTime - splashScreenTimer_openTime));\n  } else {\n    fadeOut();\n  }\n}\n\nexport function showErrorMessage(): void {\n  ErrorMessageElement.setAttribute('displayed', 'true');\n}\n\nexport interface GeneratedElement {\n  element: HTMLElement;\n  id: string;\n}\n\nexport type GroupStyles = {\n  [key: string]: {\n    width: number;\n    offset: number;\n  };\n};\n\nexport interface Size {\n  width: number;\n  height: number;\n}\n\ntype SizeType = 'window' | 'head' | 'head-one-button' | 'head-two-button' | 'route-details-canvas' | 'route-bus-arrival-time-chart' | 'location-bus-arrival-time-chart';\n\nexport function querySize(type: SizeType): Size {\n  let width: number = 0;\n  let height: number = 0;\n  const windowWidth = window.innerWidth;\n  const windowHeight = window.innerHeight;\n  switch (type) {\n    case 'window':\n      width = windowWidth;\n      height = windowHeight;\n      break;\n    case 'head':\n      width = windowWidth;\n      height = 55;\n      break;\n    case 'head-one-button':\n      width = windowWidth - 55;\n      height = 55;\n      break;\n    case 'head-two-button':\n      width = windowWidth - 55 * 2;\n      height = 55;\n      break;\n    case 'route-details-canvas':\n      width = windowWidth - 10 * 2 - 10 * 2;\n      height = 24 * 70;\n      break;\n    case 'route-bus-arrival-time-chart':\n      width = windowWidth - 45 - 15 - 20;\n      height = 75;\n      break;\n    case 'location-bus-arrival-time-chart':\n      width = windowWidth - 30 - 20;\n      height = 75;\n      break;\n    default:\n      width = 0;\n      height = 0;\n      break;\n  }\n  return {\n    width,\n    height\n  };\n}\n\nexport function scrollDocumentToTop(): void {\n  window.scrollTo({\n    top: 0,\n    behavior: 'instant'\n  });\n}\n","import { getDataUsageStats } from '../../data/analytics/data-usage/index';\nimport { convertBytes } from '../../tools/convert';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/elements';\nimport { dateToString } from '../../tools/time';\nimport { closePreviousPage, openPreviousPage, pushPageHistory, querySize } from '../index';\n\nconst dataUsageField = documentQuerySelector('.css_data_usage_field');\nconst dataUsageBodyElement = elementQuerySelector(dataUsageField, '.css_data_usage_body');\nconst chartElement = elementQuerySelector(dataUsageBodyElement, '.css_data_usage_chart');\nconst statisticsElement = elementQuerySelector(dataUsageBodyElement, '.css_data_usage_statistics');\nconst totalDataUsageElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"total-data-usage\"] .css_data_usage_statistics_item_value');\nconst maxDataUsagePerMinuteElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"max-data-usage-per-minute\"] .css_data_usage_statistics_item_value');\nconst minDataUsagePerMinuteElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"min-data-usage-per-minute\"] .css_data_usage_statistics_item_value');\nconst startTimeElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"start-time\"] .css_data_usage_statistics_item_value');\nconst endTimeElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"end-time\"] .css_data_usage_statistics_item_value');\n\nasync function initializeDataUsage() {\n  const WindowSize = querySize('window');\n  const graphWidth = WindowSize.width;\n  const graphHeight = Math.min((5 / 18) * graphWidth, WindowSize.height * 0.33);\n  const stats = await getDataUsageStats(graphWidth, graphHeight, 20);\n  totalDataUsageElement.innerText = convertBytes(stats.stats.sum);\n  maxDataUsagePerMinuteElement.innerText = convertBytes(stats.stats.max);\n  minDataUsagePerMinuteElement.innerText = convertBytes(stats.stats.min);\n  startTimeElement.innerText = dateToString(stats.period.start, 'YYYY-MM-DD');\n  endTimeElement.innerText = dateToString(stats.period.end, 'YYYY-MM-DD');\n  chartElement.innerHTML = stats.chart;\n}\n\nexport function openDataUsage(): void {\n  pushPageHistory('DataUsage');\n  dataUsageField.setAttribute('displayed', 'true');\n  initializeDataUsage();\n  closePreviousPage();\n}\n\nexport function closeDataUsage(): void {\n  // revokePageHistory('DataUsage');\n  dataUsageField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n","import { NotificationClientID, NotificationSchedule, NotificationSecret, removeNotificationSchedule } from '../../index';\nimport { getNotificationAPIURL } from '../getNotificationAPIURL/index';\nimport { getNotificationRequestBody } from '../getNotificationRequestBody/index';\nimport { makeNotificationRequest } from '../loader';\n\nexport async function cancelNotification(schedule_id: NotificationSchedule['schedule_id']): Promise<boolean> {\n  if (NotificationClientID === '' || NotificationSecret === '' || schedule_id === undefined) {\n    return false;\n  }\n  const url = getNotificationAPIURL('cancel', [schedule_id]);\n  const requestBody = getNotificationRequestBody('cancel', [schedule_id]);\n  const response = await makeNotificationRequest('cancel', url, requestBody);\n  if (response === false) {\n    return false;\n  } else {\n    if (response.code === 200 && response.method === 'cancel') {\n      await removeNotificationSchedule(schedule_id);\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n","import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { cancelNotification } from '../../data/notification/apis/cancelNotification/index';\nimport { IntegratedNotificationScheduleItem, IntegratedNotificationSchedules, integrateNotifcationSchedules, NotificationSchedule } from '../../data/notification/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { booleanToString, compareThings, generateIdentifier } from '../../tools/index';\nimport { getIconElement } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, openPreviousPage, pushPageHistory, querySize } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst NotificationScheduleManagerField = documentQuerySelector('.css_notification_schedule_manager_field');\nconst NotificationScheduleManagerHeadElement = elementQuerySelector(NotificationScheduleManagerField, '.css_notification_schedule_manager_head');\nconst NotificationScheduleManagerUpdateTimerBoxElement = elementQuerySelector(NotificationScheduleManagerHeadElement, '.css_notification_schedule_manager_update_timer_box');\nconst NotificationScheduleManagerUpdateTimerElement = elementQuerySelector(NotificationScheduleManagerUpdateTimerBoxElement, '.css_notification_schedule_manager_update_timer');\nconst NotificationScheduleManagerBody = elementQuerySelector(NotificationScheduleManagerField, '.css_notification_schedule_manager_body');\nconst NotificationScheduleList = elementQuerySelector(NotificationScheduleManagerBody, '.css_notification_schedule_manager_notification_schedule_list');\n\nlet previousIntegration = {} as IntegratedNotificationSchedules;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet notifcationScheduleManagerRefreshTimer_retryInterval: number = 10 * 1000;\nlet notifcationScheduleManagerRefreshTimer_baseInterval: number = 15 * 1000;\nlet notifcationScheduleManagerRefreshTimer_minInterval: number = 5 * 1000;\nlet notifcationScheduleManagerRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet notifcationScheduleManagerRefreshTimer_dynamic: boolean = true;\nlet notifcationScheduleManagerRefreshTimer_lastUpdate: number = 0;\nlet notifcationScheduleManagerRefreshTimer_nextUpdate: number = 0;\nlet notifcationScheduleManagerRefreshTimer_currentRequestID: string = '';\nlet notifcationScheduleManagerRefreshTimer_refreshing: boolean = false;\nlet notifcationScheduleManagerRefreshTimer_streaming: boolean = false;\nlet notifcationScheduleManagerRefreshTimer_streamStarted: boolean = false;\n\nfunction animateUpdateTimer(): void {\n  NotificationScheduleManagerUpdateTimerElement.style.setProperty('--b-cssvar-notification-schedule-manager-update-timer-interval', `${notifcationScheduleManagerRefreshTimer_dynamicInterval}ms`);\n  NotificationScheduleManagerUpdateTimerElement.classList.add('css_notification_schedule_manager_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (notifcationScheduleManagerRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    NotificationScheduleManagerUpdateTimerElement.style.setProperty('--b-cssvar-notification-schedule-manager-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfItem(): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main item element\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_notification_schedule_manager_item');\n  itemElement.id = identifier;\n\n  // Hours element\n  const hoursElement = document.createElement('div');\n  hoursElement.classList.add('css_notification_schedule_manager_item_hours');\n  itemElement.appendChild(hoursElement);\n\n  // Notification schedule container\n  const notificationScheduleElement = document.createElement('div');\n  notificationScheduleElement.classList.add('css_notification_schedule_manager_item_notification_schedule');\n\n  // Minutes element\n  const minutesElement = document.createElement('div');\n  minutesElement.classList.add('css_notification_schedule_manager_item_notification_schedule_minutes');\n  notificationScheduleElement.appendChild(minutesElement);\n\n  // Context element\n  const contextElement = document.createElement('div');\n  contextElement.classList.add('css_notification_schedule_manager_item_notification_schedule_context');\n  notificationScheduleElement.appendChild(contextElement);\n\n  // Main element\n  const mainElement = document.createElement('div');\n  mainElement.classList.add('css_notification_schedule_manager_item_notification_schedule_main');\n  notificationScheduleElement.appendChild(mainElement);\n\n  // Cancel button element\n  const cancelElement = document.createElement('div');\n  cancelElement.classList.add('css_notification_schedule_manager_item_notification_schedule_cancel');\n  const iconElement = document.createElement('span');\n  iconElement.appendChild(getIconElement('close'));\n  cancelElement.appendChild(iconElement);\n\n  notificationScheduleElement.appendChild(cancelElement);\n\n  // Assemble\n  itemElement.appendChild(notificationScheduleElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction updateNotificationScheduleManagerField(integration: IntegratedNotificationSchedules, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem, previousItem: IntegratedNotificationScheduleItem | null): void {\n    function updateHours(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemHoursElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_hours');\n      thisItemHoursElement.innerText = thisItem.hours;\n    }\n\n    function updateMinutes(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemMinutesElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_minutes');\n      thisItemMinutesElement.innerText = thisItem.minutes;\n    }\n\n    function updateMain(thisItemElement: HTMLElementm, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemMainElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_main');\n      thisItemMainElement.innerText = thisItem.name;\n    }\n\n    function updateContext(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemContextElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_context');\n      thisItemContextElement.innerText = `${thisItem.route.name} - ${thisItem.route.direction}`;\n    }\n\n    function updateCancel(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      const thisItemNotificationScheduleElement = elementQuerySelector(thisItemElement, '.css_notification_schedule_manager_item_notification_schedule');\n      const thisItemCancelElement = elementQuerySelector(thisItemNotificationScheduleElement, '.css_notification_schedule_manager_item_notification_schedule_cancel');\n      thisItemCancelElement.onclick = function () {\n        cancelNotificationOnNotificationScheduleManager(thisItemElement.id, thisItem.schedule_id);\n      };\n    }\n\n    function updateFirst(thisItemElement: HTMLElement, thisItem: IntegratedNotificationScheduleItem): void {\n      thisItemElement.setAttribute('first', booleanToString(thisItem.is_first));\n    }\n\n    function updateAnimation(thisItemElement: HTMLElement, animation: boolean): void {\n      thisItemElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisItemElement: HTMLElement, skeletonScreen: boolean): void {\n      thisItemElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateHours(thisItemElement, thisItem);\n      updateMinutes(thisItemElement, thisItem);\n      updateMain(thisItemElement, thisItem);\n      updateContext(thisItemElement, thisItem);\n      updateCancel(thisItemElement, thisItem);\n      updateFirst(thisItemElement, thisItem);\n      updateAnimation(thisItemElement, animation);\n      updateSkeletonScreen(thisItemElement, skeletonScreen);\n    } else {\n      if (thisItem.hours !== previousItem.hours) {\n        updateHours(thisItemElement, thisItem);\n      }\n      if (thisItem.minutes !== previousItem.minutes) {\n        updateMinutes(thisItemElement, thisItem);\n      }\n      if (!compareThings(previousItem.schedule_id, thisItem.schedule_id)) {\n        updateMain(thisItemElement, thisItem);\n        updateContext(thisItemElement, thisItem);\n        updateCancel(thisItemElement, thisItem);\n      }\n      if (previousItem.is_first !== thisItem.is_first) {\n        updateFirst(thisItemElement, thisItem);\n      }\n      if (previousAnimation !== animation) {\n        updateAnimation(thisItemElement, animation);\n      }\n      if (previousSkeletonScreen !== skeletonScreen) {\n        updateSkeletonScreen(thisItemElement, skeletonScreen);\n      }\n    }\n  }\n\n  const itemQuantity = integration.itemQuantity;\n  const items = integration.items;\n\n  const currentItemCapacity = elementQuerySelectorAll(NotificationScheduleList, '.css_notification_schedule_manager_item').length;\n  if (itemQuantity !== currentItemCapacity) {\n    const difference = currentItemCapacity - itemQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newItemElement = generateElementOfItem();\n        fragment.appendChild(newItemElement.element);\n      }\n      NotificationScheduleList.append(fragment);\n    } else {\n      const NotificationScheduleItemElements = elementQuerySelectorAll(NotificationScheduleList, '.css_notification_schedule_manager_item');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const itemIndex = currentItemCapacity - 1 - o;\n        NotificationScheduleItemElements[itemIndex].remove();\n      }\n    }\n  }\n\n  const NotificationScheduleItemElements = elementQuerySelectorAll(NotificationScheduleList, '.css_notification_schedule_manager_item');\n  for (let j = 0; j < itemQuantity; j++) {\n    const thisItemElement = NotificationScheduleItemElements[j];\n    const thisItem = items[j];\n    if (previousIntegration.hasOwnProperty('items')) {\n      if (previousIntegration.items[j]) {\n        const previousItem = previousIntegration.items[j];\n        updateItem(thisItemElement, thisItem, previousItem);\n      } else {\n        updateItem(thisItemElement, thisItem, null);\n      }\n    } else {\n      updateItem(thisItemElement, thisItem, null);\n    }\n  }\n\n  previousIntegration = integration;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nfunction setUpNotificationScheduleManagerFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const defaultItemQuantity: IntegratedNotificationSchedules['itemQuantity'] = Math.floor(FieldHeight / 50) + 5;\n  let items: IntegratedNotificationSchedules['items'] = [];\n  for (let i = 0; i < defaultItemQuantity; i++) {\n    items.push({\n      name: '',\n      stop_id: 0,\n      estimate_time: 0,\n      schedule_id: 'null',\n      scheduled_time: 0,\n      route: {\n        name: '',\n        direction: '',\n        id: 0,\n        pathAttributeId: []\n      },\n      is_first: true,\n      date: '',\n      hours: '',\n      minutes: ''\n    });\n  }\n  updateNotificationScheduleManagerField(\n    {\n      items: items,\n      itemQuantity: defaultItemQuantity,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nasync function refreshNotificationScheduleManager() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  notifcationScheduleManagerRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  notifcationScheduleManagerRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  notifcationScheduleManagerRefreshTimer_refreshing = true;\n  notifcationScheduleManagerRefreshTimer_currentRequestID = generateIdentifier();\n  NotificationScheduleManagerUpdateTimerElement.setAttribute('refreshing', 'true');\n  NotificationScheduleManagerUpdateTimerElement.classList.remove('css_notification_schedule_manager_update_timer_slide_rtl');\n  document.addEventListener(notifcationScheduleManagerRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateNotifcationSchedules(notifcationScheduleManagerRefreshTimer_currentRequestID);\n  updateNotificationScheduleManagerField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (notifcationScheduleManagerRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  notifcationScheduleManagerRefreshTimer_lastUpdate = new Date().getTime();\n  if (notifcationScheduleManagerRefreshTimer_dynamic) {\n    notifcationScheduleManagerRefreshTimer_nextUpdate = Math.max(notifcationScheduleManagerRefreshTimer_lastUpdate + notifcationScheduleManagerRefreshTimer_minInterval, integration.dataUpdateTime + notifcationScheduleManagerRefreshTimer_baseInterval / updateRate);\n  } else {\n    notifcationScheduleManagerRefreshTimer_nextUpdate = notifcationScheduleManagerRefreshTimer_lastUpdate + notifcationScheduleManagerRefreshTimer_baseInterval;\n  }\n  notifcationScheduleManagerRefreshTimer_dynamicInterval = Math.max(notifcationScheduleManagerRefreshTimer_minInterval, notifcationScheduleManagerRefreshTimer_nextUpdate - notifcationScheduleManagerRefreshTimer_lastUpdate);\n  notifcationScheduleManagerRefreshTimer_refreshing = false;\n  NotificationScheduleManagerUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nasync function streamNotificationScheduleManager() {\n  refreshNotificationScheduleManager()\n    .then(function () {\n      if (notifcationScheduleManagerRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamNotificationScheduleManager();\n          },\n          Math.max(notifcationScheduleManagerRefreshTimer_minInterval, notifcationScheduleManagerRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        notifcationScheduleManagerRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (notifcationScheduleManagerRefreshTimer_streaming) {\n        setTimeout(function () {\n          streamNotificationScheduleManager();\n        }, notifcationScheduleManagerRefreshTimer_retryInterval);\n      } else {\n        notifcationScheduleManagerRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openNotificationScheduleManager(): void {\n  pushPageHistory('NotificationScheduleManager');\n  NotificationScheduleManagerField.setAttribute('displayed', 'true');\n  setUpNotificationScheduleManagerFieldSkeletonScreen();\n  if (!notifcationScheduleManagerRefreshTimer_streaming) {\n    notifcationScheduleManagerRefreshTimer_streaming = true;\n    if (!notifcationScheduleManagerRefreshTimer_streamStarted) {\n      notifcationScheduleManagerRefreshTimer_streamStarted = true;\n      streamNotificationScheduleManager();\n    } else {\n      refreshNotificationScheduleManager();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeNotificationScheduleManager(): void {\n  // revokePageHistory('NotificationScheduleManager');\n  NotificationScheduleManagerField.setAttribute('displayed', 'false');\n  notifcationScheduleManagerRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport async function cancelNotificationOnNotificationScheduleManager(identifier: string, schedule_id: NotificationSchedule['schedule_id']) {\n  promptMessage('manufacturing', '');\n  const cancellation = await cancelNotification(schedule_id);\n  if (cancellation) {\n    const itemElement = elementQuerySelector(NotificationScheduleList, `.css_notification_schedule_manager_item#${identifier}`);\n    itemElement.remove();\n    promptMessage('check_circle', '');\n    if (!notifcationScheduleManagerRefreshTimer_refreshing) {\n      const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n      const integration = await integrateNotifcationSchedules(notifcationScheduleManagerRefreshTimer_currentRequestID);\n      updateNotificationScheduleManagerField(integration, false, playing_animation);\n    }\n  } else {\n    promptMessage('error', '');\n  }\n}\n","import { changeSettingOption, getSetting, SettingSelect, SettingSelectOption } from '../../data/settings/index';\nimport { documentQuerySelector, documentQuerySelectorAll, elementQuerySelector } from '../../tools/elements';\nimport { closePreviousPage, GeneratedElement, openPreviousPage, pushPageHistory } from '../index';\n\nconst SettingsOptionsField = documentQuerySelector('.css_settings_options_field');\nconst SettingsOptionsBodyElement = elementQuerySelector(SettingsOptionsField, '.css_settings_options_body');\nconst SettingsOptionsOptionsElement = elementQuerySelector(SettingsOptionsBodyElement, '.css_settings_options');\nconst SettingsOptionsDescriptionElement = elementQuerySelector(SettingsOptionsBodyElement, '.css_options_description');\nconst SettingsOptionsHeadElement = elementQuerySelector(SettingsOptionsField, '.css_settings_options_head');\nconst SettingsOptionsTitleElement = elementQuerySelector(SettingsOptionsHeadElement, '.css_settings_options_title');\n\nfunction generateElementOfItem(setting: SettingSelect, item: SettingSelectOption, index: number): GeneratedElement {\n  const optionElement = document.createElement('div');\n  optionElement.classList.add('css_option');\n\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_option_name');\n  nameElement.appendChild(document.createTextNode(item.name));\n\n  const checkboxContainerElement = document.createElement('div');\n  checkboxContainerElement.classList.add('css_option_checkbox');\n\n  const checkboxElement = document.createElement('input');\n  checkboxElement.type = 'checkbox';\n  checkboxElement.checked = setting.option === index;\n  checkboxElement.onclick = (event) => {\n    settingsOptionsHandler(event, setting.key, index);\n  };\n\n  checkboxContainerElement.appendChild(checkboxElement);\n  optionElement.appendChild(nameElement);\n  optionElement.appendChild(checkboxContainerElement);\n\n  return {\n    element: optionElement,\n    id: ''\n  };\n}\n\nfunction initializeSettingsOptionsField(settingKey: string): void {\n  const setting = getSetting(settingKey) as SettingSelect;\n  SettingsOptionsTitleElement.innerText = setting.name;\n  SettingsOptionsDescriptionElement.innerText = setting.description;\n  SettingsOptionsOptionsElement.innerHTML = '';\n  const fragment = new DocumentFragment();\n  let index: number = 0;\n  for (const item of setting.options) {\n    const thisElement = generateElementOfItem(setting, item, index);\n    fragment.appendChild(thisElement.element);\n    index += 1;\n  }\n  SettingsOptionsOptionsElement.append(fragment);\n}\n\nexport function openSettingsOptions(settingKey: string): void {\n  pushPageHistory('SettingsOptions');\n  SettingsOptionsField.setAttribute('displayed', 'true');\n  initializeSettingsOptionsField(settingKey);\n  closePreviousPage();\n}\n\nexport function closeSettingsOptions(): void {\n  // revokePageHistory('SettingsOptions');\n  SettingsOptionsField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport function settingsOptionsHandler(event: Event, settingKey: string, index: number): void {\n  const checkboxes = documentQuerySelectorAll('.css_settings_options_field .css_settings_options_body .css_settings_options .css_option .css_option_checkbox input[type=\"checkbox\"]') as NodeListOf<HTMLInputElement>;\n  for (const checkbox of checkboxes) {\n    checkbox.checked = false;\n  }\n  const target = event.target as HTMLInputElement;\n  target.checked = true;\n  changeSettingOption(settingKey, index);\n}\n","import { convertBytes } from '../../tools/convert';\nimport { getStoresLength, lfGetItem, lfListItemKeys } from '../storage/index';\n\ninterface StoreCategory {\n  name: string;\n  key: string;\n}\n\ninterface StoreSizeInBytes {\n  category: StoreCategory;\n  size: number;\n}\n\ntype CategorizedSizesInBytes = { [key: string]: StoreSizeInBytes };\n\nexport interface StoreSize {\n  category: StoreCategory;\n  size: string;\n}\n\nexport type CategorizedSizes = { [key: string]: StoreSize };\n\nexport interface StoreSizeStatistics {\n  categorizedSizes: CategorizedSizes;\n  totalSize: number;\n}\n\nfunction storeIndexToCategory(store: number): StoreCategory {\n  const [name, key] = [\n    ['', 'cache'],\n    ['', 'settings'],\n    ['', 'analytics'],\n    ['', 'analytics'],\n    ['', 'analytics'],\n    ['', 'analytics'],\n    ['', 'analytics'],\n    ['', 'personalSchedule'],\n    ['', 'recentViews'],\n    ['', 'notification'],\n    ['', 'notification'],\n    ['', 'folders'],\n    ['', 'folders'],\n    ['', 'folders']\n  ][store] || ['', 'others'];\n  const result = {\n    name,\n    key\n  };\n  return result;\n}\n\nexport async function getStoresSizeStatistics(): Promise<StoreSizeStatistics> {\n  let totalSizeInBytes: number = 0;\n  const categorizedSizesInBytes: CategorizedSizesInBytes = {};\n  const storesLength = getStoresLength();\n\n  for (let i = 0; i < storesLength; i++) {\n    const keysInStore = await lfListItemKeys(i);\n    let thisStoreSizeInBytes: number = 0;\n    for (const itemKey of keysInStore) {\n      const item = await lfGetItem(i, itemKey);\n      const itemInString = String(item);\n      const itemLength = itemInString.length + itemKey.length;\n      totalSizeInBytes += itemLength;\n      thisStoreSizeInBytes += itemLength;\n    }\n    const thisCategory = storeIndexToCategory(i);\n    const thisCategoryKey = thisCategory.key;\n    if (!categorizedSizesInBytes.hasOwnProperty(thisCategoryKey)) {\n      categorizedSizesInBytes[thisCategoryKey] = {\n        category: thisCategory,\n        size: 0\n      };\n    }\n    categorizedSizesInBytes[thisCategory.key].size += thisStoreSizeInBytes;\n  }\n\n  const totalSize = convertBytes(totalSizeInBytes);\n\n  const categorizedSizes: CategorizedSizes = {};\n  for (const key in categorizedSizesInBytes) {\n    const thisCategory = categorizedSizesInBytes[key].category;\n    const thisCategorySize = categorizedSizesInBytes[key].size;\n    categorizedSizes[key] = {\n      category: thisCategory,\n      size: convertBytes(thisCategorySize)\n    };\n  }\n\n  const result: StoreSizeStatistics = {\n    totalSize,\n    categorizedSizes\n  };\n\n  return result;\n}\n","import { getStoresSizeStatistics, StoreSize, StoreSizeStatistics } from '../../data/analytics/storage-size';\nimport { getSettingOptionValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { booleanToString } from '../../tools/index';\nimport { GeneratedElement, querySize } from '../index';\n\nlet previousCategories: Array<StoreSize> = [];\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nconst StorageField = documentQuerySelector('.css_storage_field');\nconst StorageBodyElement = elementQuerySelector(StorageField, '.css_storage_body');\nconst StatisticsElement = elementQuerySelector(StorageBodyElement, '.css_storage_statistics');\n\nfunction generateElementOfItem(): GeneratedElement {\n  // Create root element\n  const statisticsItemElement = document.createElement('div');\n  statisticsItemElement.classList.add('css_storage_statistics_item');\n\n  // Create name element\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_storage_statistics_item_name');\n\n  // Create value element\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_storage_statistics_item_value');\n\n  // Append children\n  statisticsItemElement.appendChild(nameElement);\n  statisticsItemElement.appendChild(valueElement);\n\n  return {\n    element: statisticsItemElement,\n    id: ''\n  };\n}\n\nfunction updateStorageField(statistics: StoreSizeStatistics, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(element: HTMLElement, currentItem: StoreSize, previousItem: StoreSize | null): void {\n    function updateValue(element: HTMLElement, item: StoreSize): void {\n      const typeElement = elementQuerySelector(element, '.css_storage_statistics_item_value');\n      typeElement.innerText = item.size;\n    }\n\n    function updateName(element: HTMLElement, item: StoreSize): void {\n      const nameElement = elementQuerySelector(element, '.css_storage_statistics_item_name');\n      nameElement.innerText = item.category.name;\n    }\n\n    function updateAnimation(element: HTMLElement, animation: boolean): void {\n      element.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(element: HTMLElement, skeletonScreen: boolean): void {\n      element.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    // compare the current item with the previous item\n    if (previousItem) {\n      if (currentItem.category.key !== previousItem.category.key) {\n        updateName(element, currentItem);\n        updateValue(element, currentItem);\n      }\n\n      if (currentItem.size !== previousItem.size) {\n        updateValue(element, currentItem);\n      }\n\n      if (previousAnimation !== animation) {\n        updateAnimation(element, animation);\n      }\n\n      if (previousSkeletonScreen !== skeletonScreen) {\n        updateSkeletonScreen(element, skeletonScreen);\n      }\n    }\n    // if the previous item is null, it means this is a new item\n    else {\n      updateValue(element, currentItem);\n      updateName(element, currentItem);\n      updateAnimation(element, animation);\n      updateSkeletonScreen(element, skeletonScreen);\n    }\n  }\n\n  const categories = [];\n  for (const key in statistics.categorizedSizes) {\n    const item = statistics.categorizedSizes[key];\n    categories.push(item);\n  }\n\n  const categoriesQuantity = categories.length;\n  const currentItemCapacity = elementQuerySelectorAll(StatisticsElement, '.css_storage_statistics_item').length;\n  if (categoriesQuantity !== currentItemCapacity) {\n    const difference = currentItemCapacity - categoriesQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newElement = generateElementOfItem();\n        fragment.appendChild(newElement.element);\n      }\n      StatisticsElement.appendChild(fragment);\n    } else {\n      const statisticsItemElements2 = elementQuerySelectorAll(StatisticsElement, '.css_storage_statistics_item');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const itemIndex = currentItemCapacity - 1 - o;\n        statisticsItemElements2[itemIndex].remove();\n      }\n    }\n  }\n\n  const statisticsItemElements = elementQuerySelectorAll(StatisticsElement, '.css_storage_statistics_item');\n  for (let i = 0; i < categoriesQuantity; i++) {\n    const previousItem = previousCategories[i];\n    const currentItem = categories[i];\n    const thisItemElement = statisticsItemElements[i];\n    if (previousItem) {\n      updateItem(thisItemElement, currentItem, previousItem);\n    } else {\n      updateItem(thisItemElement, currentItem, null);\n    }\n  }\n\n  previousCategories = categories;\n  previousSkeletonScreen = skeletonScreen;\n  previousAnimation = animation;\n}\n\nfunction setUpStorageFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const FieldSize = querySize('window');\n  // const FieldWidth = FieldSize.width;\n  const FieldHeight = FieldSize.height;\n  const defaultCategoriesQuantity = Math.min(7, Math.floor(FieldHeight / 55) + 2);\n  const statistics: StoreSizeStatistics = {\n    categorizedSizes: {},\n    totalSize: 0\n  };\n  for (let i = 0; i < defaultCategoriesQuantity; i++) {\n    const categoryKey = `store-${i}`;\n    statistics.categorizedSizes[categoryKey] = {\n      category: {\n        name: '',\n        key: categoryKey\n      },\n      size: `size-${i}`\n    };\n  }\n  updateStorageField(statistics, true, playing_animation);\n}\n\nasync function refreshStorageStatistics() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  setUpStorageFieldSkeletonScreen();\n  const statistics = await getStoresSizeStatistics();\n  updateStorageField(statistics, false, playing_animation);\n}\n\nexport function openStorage(): void {\n  StorageField.setAttribute('displayed', 'true');\n  refreshStorageStatistics();\n}\n\nexport function closeStorage(): void {\n  StorageField.setAttribute('displayed', 'false');\n}\n","import { getSettingOptionValue } from '../../data/settings/index';\nimport { documentQuerySelectorAll } from '../../tools/elements';\nimport { booleanToString } from '../../tools/index';\nimport { getIconElement } from '../icons/index';\nimport { MaterialSymbols } from '../icons/material-symbols-type';\n\nexport interface PromptButton {\n  text: string;\n  action: Function;\n}\n\nexport function promptMessage(icon: MaterialSymbols, message: string, button: PromptButton | null): void {\n  const allPromptElements = documentQuerySelectorAll('.css_prompt');\n  if (allPromptElements !== null) {\n    for (const promptElement of allPromptElements) {\n      promptElement.remove();\n    }\n  }\n\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n\n  const promptElement = document.createElement('div');\n  promptElement.classList.add('css_prompt');\n  promptElement.setAttribute('animation', booleanToString(playing_animation));\n\n  const promptIconElement = document.createElement('div');\n  promptIconElement.classList.add('css_prompt_icon');\n  promptIconElement.appendChild(getIconElement(icon));\n  promptElement.appendChild(promptIconElement);\n\n  const promptMessageElement = document.createElement('div');\n  promptMessageElement.classList.add('css_prompt_message');\n  promptMessageElement.innerText = message;\n  promptElement.appendChild(promptMessageElement);\n\n  if (typeof button === 'object' && button !== null && button !== undefined) {\n    if (typeof button?.action === 'function') {\n      const promptButtonElement = document.createElement('div');\n      promptButtonElement.classList.add('css_prompt_button');\n      promptButtonElement.innerText = button.text;\n      promptButtonElement.addEventListener(\n        'click',\n        function () {\n          button.action();\n        },\n        { once: true }\n      );\n      promptElement.appendChild(promptButtonElement);\n    }\n  }\n\n  promptElement.addEventListener(\n    'animationend',\n    function (event) {\n      if (event?.target) {\n        event.target.remove();\n      }\n    },\n    { once: true }\n  );\n\n  document.body.appendChild(promptElement);\n}\n","import { getUpdateRate } from '../../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../../data/apis/loader';\nimport { Folder, integratedFolder, integratedFolderContent, integratedFolders, integrateFolders } from '../../../data/folder/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../../data/settings/index';\nimport { booleanToString, compareThings, generateIdentifier } from '../../../tools/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { getBlankIconElement, getIconElement, setIcon } from '../../icons/index';\nimport { MaterialSymbols } from '../../icons/material-symbols-type';\nimport { GeneratedElement, querySize } from '../../index';\nimport { openLocation } from '../../location/index';\nimport { promptMessage } from '../../prompt/index';\nimport { openRoute } from '../../route/index';\n\nconst HomeField = documentQuerySelector('.css_home_field');\nconst HomeHeadElement = elementQuerySelector(HomeField, '.css_home_head');\nconst HomeBodyElement = elementQuerySelector(HomeField, '.css_home_body');\nconst HomeFoldersElement = elementQuerySelector(HomeBodyElement, '.css_home_folders');\nconst HomeUpdateTimerElement = elementQuerySelector(HomeHeadElement, '.css_home_update_timer_box .css_home_update_timer');\n\nlet previousIntegration = {} as integratedFolders;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet foldersRefreshTimer_retryInterval: number = 10 * 1000;\nlet foldersRefreshTimer_baseInterval: number = 15 * 1000;\nlet foldersRefreshTimer_minInterval: number = 5 * 1000;\nlet foldersRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet foldersRefreshTimer_dynamic: boolean = true;\nlet foldersRefreshTimer_lastUpdate: number = 0;\nlet foldersRefreshTimer_nextUpdate: number = 0;\nlet foldersRefreshTimer_currentRequestID: string = '';\nlet foldersRefreshTimer_refreshing: boolean = false;\nlet foldersRefreshTimer_streaming: boolean = false;\nlet foldersRefreshTimer_streamStarted: boolean = false;\n\nfunction generateElementOfItem(): GeneratedElement {\n  // Main container\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_home_folder_item');\n  itemElement.setAttribute('type', 'stop');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_home_folder_item_icon');\n  iconElement.appendChild(getIconElement('location_on'));\n\n  // Context\n  const contextElement = document.createElement('div');\n  contextElement.classList.add('css_home_folder_item_context');\n\n  // Main\n  const mainElement = document.createElement('div');\n  mainElement.classList.add('css_home_folder_item_main');\n\n  // Capsule\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_home_folder_item_capsule');\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_home_folder_item_status');\n\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n\n  statusElement.appendChild(nextSlideElement);\n  statusElement.appendChild(currentSlideElement);\n\n  // Button\n  const buttonElement = document.createElement('div');\n  buttonElement.classList.add('css_home_folder_item_button');\n  buttonElement.appendChild(getIconElement('keyboard_arrow_right'));\n\n  // Capsule separator\n  const capsuleSeparatorElement = document.createElement('div');\n  capsuleSeparatorElement.classList.add('css_home_folder_item_capsule_separator');\n\n  // Assemble capsule\n  capsuleElement.appendChild(statusElement);\n  capsuleElement.appendChild(buttonElement);\n  capsuleElement.appendChild(capsuleSeparatorElement);\n\n  // Assemble item\n  itemElement.appendChild(iconElement);\n  itemElement.appendChild(contextElement);\n  itemElement.appendChild(mainElement);\n  itemElement.appendChild(capsuleElement);\n\n  return {\n    element: itemElement,\n    id: ''\n  };\n}\n\nfunction generateElementOfFolder(): GeneratedElement {\n  // Main container\n  const folderElement = document.createElement('div');\n  folderElement.classList.add('css_home_folder');\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_home_folder_head');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_home_folder_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  // Name\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_home_folder_name');\n\n  // Assemble head\n  headElement.appendChild(iconElement);\n  headElement.appendChild(nameElement);\n\n  // Content\n  const contentElement = document.createElement('div');\n  contentElement.classList.add('css_home_folder_content');\n\n  // Assemble folder\n  folderElement.appendChild(headElement);\n  folderElement.appendChild(contentElement);\n\n  return {\n    element: folderElement,\n    id: ''\n  };\n}\n\nfunction animateUpdateTimer(): void {\n  HomeUpdateTimerElement.style.setProperty('--b-cssvar-home-update-timer-interval', `${foldersRefreshTimer_dynamicInterval}ms`);\n  HomeUpdateTimerElement.classList.add('css_home_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (foldersRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    HomeUpdateTimerElement.style.setProperty('--b-cssvar-home-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nexport function setUpFolderFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const contentLength = Math.floor(FieldHeight / 50 / 3) + 2;\n  const folderQuantity = 3;\n\n  const folders: integratedFolders['folders'] = [];\n  for (let i = 0; i < folderQuantity; i++) {\n    const folder: integratedFolder = {\n      name: '',\n      icon: '',\n      id: '',\n      timestamp: 0,\n      content: [],\n      contentLength: contentLength\n    };\n\n    for (let j = 0; j < contentLength; j++) {\n      const folderContent: integratedFolderContent = {\n        type: 'stop',\n        id: 0,\n        timestamp: 0,\n        name: '',\n        status: {\n          code: 8,\n          text: '',\n          time: -6\n        },\n        direction: 0,\n        route: {\n          name: '',\n          endPoints: {\n            departure: '',\n            destination: ''\n          },\n          id: 0,\n          pathAttributeId: []\n        }\n      };\n      folder.content.push(folderContent);\n    }\n    folders.push(folder);\n  }\n\n  updateFoldersElement(\n    {\n      folders: folders,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateFoldersElement(integration: integratedFolders, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: integratedFolderContent, previousItem: integratedFolderContent | null) {\n    function updateType(thisElement: HTMLElement, thisItem: integratedFolderContent): void {\n      thisElement.setAttribute('type', thisItem.type);\n    }\n\n    function updateIcon(thisElement: HTMLElement, thisItem: integratedFolderContent): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_home_folder_item_icon');\n      let icon = '' as MaterialSymbols;\n      switch (thisItem.type) {\n        case 'stop':\n          icon = 'location_on';\n          break;\n        case 'route':\n          icon = 'route';\n          break;\n        case 'location':\n          icon = 'location_on';\n          break;\n        case 'bus':\n          icon = 'directions_bus';\n          break;\n        case 'empty':\n          icon = 'lightbulb';\n          break;\n        default:\n          icon = '';\n          break;\n      }\n      setIcon(thisIconElement, icon);\n    }\n\n    function updateStatus(thisElement: HTMLElement, thisItem: integratedFolderContent, animation: boolean): void {\n      if (thisItem.type === 'stop') {\n        const thisElementRect = thisElement.getBoundingClientRect();\n        const top = thisElementRect.top;\n        const left = thisElementRect.left;\n        const bottom = thisElementRect.bottom;\n        const right = thisElementRect.right;\n        const windowWidth = window.innerWidth;\n        const windowHeight = window.innerHeight;\n\n        const thisItemStatusElement = elementQuerySelector(thisElement, '.css_home_folder_item_capsule .css_home_folder_item_status');\n        const nextSlideElement = elementQuerySelector(thisItemStatusElement, '.css_next_slide');\n        const currentSlideElement = elementQuerySelector(thisItemStatusElement, '.css_current_slide');\n\n        nextSlideElement.setAttribute('code', thisItem.status.code.toString());\n        nextSlideElement.innerText = thisItem.status.text;\n\n        if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n          currentSlideElement.addEventListener(\n            'animationend',\n            function () {\n              currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n              currentSlideElement.innerText = thisItem.status.text;\n              currentSlideElement.classList.remove('css_slide_fade_out');\n              nextSlideElement.setAttribute('displayed', 'false');\n            },\n            { once: true }\n          );\n          nextSlideElement.setAttribute('displayed', 'true');\n          currentSlideElement.classList.add('css_slide_fade_out');\n        } else {\n          currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n          currentSlideElement.innerText = thisItem.status.text;\n        }\n      }\n    }\n\n    function updateMain(thisElement: HTMLElement, thisItem: integratedFolderContent): void {\n      let main: string = '';\n      switch (thisItem.type) {\n        case 'stop':\n          main = thisItem.name;\n          break;\n        case 'route':\n          main = thisItem.name;\n          break;\n        case 'location':\n          main = thisItem.name;\n          break;\n        case 'bus':\n          main = thisItem.busID;\n          break;\n        case 'empty':\n          main = '';\n          break;\n        default:\n          main = 'null';\n          break;\n      }\n      elementQuerySelector(thisElement, '.css_home_folder_item_main').innerText = main;\n    }\n\n    function updateContext(thisElement: HTMLElement, thisItem: integratedFolderContent): void {\n      let context: string = '';\n      switch (thisItem.type) {\n        case 'stop':\n          context = `${thisItem.route ? thisItem.route.name : ''} - ${thisItem.route ? [thisItem.route.endPoints.destination, thisItem.route.endPoints.departure, ''][thisItem.direction ? thisItem.direction : 0] : ''}`;\n          break;\n        case 'route':\n          context = `${thisItem.endPoints.departure} \\u2194 ${thisItem.endPoints.destination}`;\n          break;\n        case 'location':\n          context = '';\n          break;\n        case 'bus':\n          // context = thisItem.currentRoute.name; // TODO: integration\n          break;\n        case 'empty':\n          context = '';\n          break;\n        default:\n          context = 'null';\n          break;\n      }\n      elementQuerySelector(thisElement, '.css_home_folder_item_context').innerText = context;\n    }\n\n    function updateButton(thisElement: HTMLElement, thisItem: integratedFolderContent): void {\n      const buttonElement = elementQuerySelector(thisElement, '.css_home_folder_item_capsule .css_home_folder_item_button');\n      switch (thisItem.type) {\n        case 'stop':\n          buttonElement.onclick = function () {\n            openRoute(thisItem.route.id, thisItem.route.pathAttributeId);\n          };\n          break;\n        case 'route':\n          buttonElement.onclick = function () {\n            openRoute(thisItem.id, thisItem.pathAttributeId);\n          };\n          break;\n        case 'location':\n          buttonElement.onclick = function () {\n            openLocation(thisItem.id);\n          };\n          break;\n        case 'bus':\n          break;\n        case 'empty':\n          break;\n        default:\n          break;\n      }\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateType(thisElement, thisItem);\n      updateIcon(thisElement, thisItem);\n      updateStatus(thisElement, thisItem, animation);\n      updateMain(thisElement, thisItem);\n      updateContext(thisElement, thisItem);\n      updateButton(thisElement, thisItem);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (thisItem.type !== previousItem.type) {\n        updateType(thisElement, thisItem);\n        updateIcon(thisElement, thisItem);\n        updateStatus(thisElement, thisItem, animation);\n        updateMain(thisElement, thisItem);\n        updateContext(thisElement, thisItem);\n        updateButton(thisElement, thisItem);\n        updateAnimation(thisElement, animation);\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      } else {\n        switch (thisItem.type) {\n          case 'stop':\n            if (!compareThings(previousItem.route, thisItem.route)) {\n              updateContext(thisElement, thisItem);\n              updateButton(thisElement, thisItem);\n            }\n            if (previousItem.name !== thisItem.name) {\n              updateMain(thisElement, thisItem);\n            }\n            if (previousItem.status.time !== thisItem.status.time) {\n              updateStatus(thisElement, thisItem, animation);\n            }\n            break;\n          case 'route':\n            if (previousItem.id !== thisItem.id) {\n              updateButton(thisElement, thisItem);\n            }\n            if (!compareThings(previousItem.endPoints, thisItem.endPoints)) {\n              updateContext(thisElement, thisItem);\n            }\n            if (previousItem.name !== thisItem.name) {\n              updateMain(thisElement, thisItem);\n            }\n            break;\n          case 'location':\n            if (previousItem.id !== thisItem.id) {\n              updateButton(thisElement, thisItem);\n            }\n            if (previousItem.name !== thisItem.name) {\n              updateMain(thisElement, thisItem);\n            }\n            /*\n            if (!compareThings(previousItem.labels, thisItem.labels)) {\n              updateContext(thisElement, thisItem);\n            }\n            */\n            break;\n          case 'bus':\n            /*\n            if (!compareThings(previousItem.currentRoute, thisItem.currentRoute)) {\n              updateContext(thisElement, thisItem);\n            }\n            if (!compareThings(previousItem.busID, thisItem.busID)) {\n              updateMain(thisElement, thisItem);\n            }\n            */\n            break;\n          case 'empty':\n            if (thisItem.type !== previousItem.type) {\n              updateContext(thisElement, thisItem);\n              updateMain(thisElement, thisItem);\n            }\n            break;\n          default:\n            break;\n        }\n        if (skeletonScreen !== previousSkeletonScreen) {\n          updateSkeletonScreen(thisElement, skeletonScreen);\n        }\n        if (animation !== previousAnimation) {\n          updateAnimation(thisElement, animation);\n        }\n      }\n    }\n  }\n\n  function updateFolder(thisElement: HTMLElement, thisFolder: Folder, previousFolder: Folder | null): void {\n    function updateName(thisElement: HTMLElement, thisFolder: Folder): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_home_folder_head');\n      const thisNameElement = elementQuerySelector(thisHeadElement, '.css_home_folder_name');\n      thisNameElement.innerText = thisFolder.name;\n    }\n\n    function updateIcon(thisElement: HTMLElement, thisFolder: Folder): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_home_folder_head');\n      const thisIconElement = elementQuerySelector(thisHeadElement, '.css_home_folder_icon');\n      setIcon(thisIconElement, thisFolder.icon);\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousFolder === null || previousFolder === undefined) {\n      updateName(thisElement, thisFolder);\n      updateIcon(thisElement, thisFolder);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (thisFolder.name !== previousFolder.name) {\n        updateName(thisElement, thisFolder);\n      }\n      if (thisFolder.icon !== previousFolder.icon) {\n        updateIcon(thisElement, thisFolder);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const folders = integration.folders;\n  const foldersLength = folders.length;\n\n  const currentFolderCapacity = elementQuerySelectorAll(HomeFoldersElement, '.css_home_folder').length;\n  if (foldersLength !== currentFolderCapacity) {\n    const difference = currentFolderCapacity - foldersLength;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newFolderElement = generateElementOfFolder();\n        fragment.appendChild(newFolderElement.element);\n      }\n      HomeFoldersElement.append(fragment);\n    } else {\n      const FolderElements = elementQuerySelectorAll(HomeFoldersElement, '.css_home_folder');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const folderIndex = currentFolderCapacity - 1 - o;\n        FolderElements[folderIndex].remove();\n      }\n    }\n  }\n\n  const FolderElements = elementQuerySelectorAll(HomeFoldersElement, '.css_home_folder');\n  for (let i = 0; i < foldersLength; i++) {\n    const thisFolder = folders[i];\n    const thisFolderContent = thisFolder.content;\n    const thisFolderContentLength = thisFolderContent.length;\n    const thisFolderElement = FolderElements[i];\n    const thisFolderContentElement = elementQuerySelector(thisFolderElement, '.css_home_folder_content');\n    const currentItemCapacity = elementQuerySelectorAll(thisFolderContentElement, '.css_home_folder_item').length;\n    if (thisFolderContentLength !== currentItemCapacity) {\n      const difference = currentItemCapacity - thisFolderContentLength;\n      if (difference < 0) {\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newItemElement = generateElementOfItem();\n          thisFolderContentElement.appendChild(newItemElement.element);\n        }\n      } else {\n        const FolderContentItemElements = elementQuerySelectorAll(thisFolderContentElement, '.css_home_folder_item');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          FolderContentItemElements[itemIndex].remove();\n        }\n      }\n    }\n  }\n\n  const FolderElements2 = elementQuerySelectorAll(HomeFoldersElement, '.css_home_folder');\n  for (let i = 0; i < foldersLength; i++) {\n    const thisFolder = folders[i];\n    const thisFolderContent = thisFolder.content;\n    const thisFolderContentLength = thisFolderContent.length; // the actual length (including 'empty content')\n    const thisFolderElement = FolderElements2[i];\n    const thisFolderContentElement = elementQuerySelector(thisFolderElement, '.css_home_folder_content');\n    if (previousIntegration.hasOwnProperty('folders')) {\n      if (previousIntegration.folders[i]) {\n        const previousFolder = previousIntegration.folders[i];\n        updateFolder(thisFolderElement, thisFolder, previousFolder);\n      } else {\n        updateFolder(thisFolderElement, thisFolder, null);\n      }\n    } else {\n      updateFolder(thisFolderElement, thisFolder, null);\n    }\n\n    const thisFolderItemElements = elementQuerySelectorAll(thisFolderContentElement, '.css_home_folder_item');\n    for (let j = 0; j < thisFolderContentLength; j++) {\n      const thisElement = thisFolderItemElements[j];\n      const thisItem = thisFolderContent[j];\n      if (previousIntegration.hasOwnProperty('folders')) {\n        if (previousIntegration.folders[i]) {\n          if (previousIntegration.folders[i].content[j]) {\n            const previousItem = previousIntegration.folders[i].content[j];\n            updateItem(thisElement, thisItem, previousItem);\n          } else {\n            updateItem(thisElement, thisItem, null);\n          }\n        } else {\n          updateItem(thisElement, thisItem, null);\n        }\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nasync function refreshFolders() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  foldersRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  foldersRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  foldersRefreshTimer_refreshing = true;\n  foldersRefreshTimer_currentRequestID = generateIdentifier();\n  HomeUpdateTimerElement.setAttribute('refreshing', 'true');\n  HomeUpdateTimerElement.classList.remove('css_home_update_timer_slide_rtl');\n  document.addEventListener(foldersRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateFolders(foldersRefreshTimer_currentRequestID);\n  updateFoldersElement(integration, false, playing_animation);\n  let updateRate = 0;\n  if (foldersRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  foldersRefreshTimer_lastUpdate = new Date().getTime();\n  if (foldersRefreshTimer_dynamic) {\n    foldersRefreshTimer_nextUpdate = Math.max(foldersRefreshTimer_lastUpdate + foldersRefreshTimer_minInterval, integration.dataUpdateTime + foldersRefreshTimer_baseInterval / updateRate);\n  } else {\n    foldersRefreshTimer_nextUpdate = foldersRefreshTimer_lastUpdate + foldersRefreshTimer_baseInterval;\n  }\n  foldersRefreshTimer_dynamicInterval = Math.max(foldersRefreshTimer_minInterval, foldersRefreshTimer_nextUpdate - foldersRefreshTimer_lastUpdate);\n  foldersRefreshTimer_refreshing = false;\n  HomeUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nasync function streamFolders() {\n  refreshFolders()\n    .then(function () {\n      if (foldersRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamFolders();\n          },\n          Math.max(foldersRefreshTimer_minInterval, foldersRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        foldersRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (foldersRefreshTimer_streaming) {\n        promptMessage('error', `${foldersRefreshTimer_retryInterval / 1000}`);\n        setTimeout(function () {\n          streamFolders();\n        }, foldersRefreshTimer_retryInterval);\n      } else {\n        foldersRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function initializeFolders(): void {\n  setUpFolderFieldSkeletonScreen();\n  if (!foldersRefreshTimer_streaming) {\n    foldersRefreshTimer_streaming = true;\n    if (!foldersRefreshTimer_streamStarted) {\n      foldersRefreshTimer_streamStarted = true;\n      streamFolders();\n    } else {\n      refreshFolders();\n    }\n  }\n}\n","import { getUpdateRate } from '../../../data/analytics/update-rate/index';\nimport { integratedRecentView, integratedRecentViews, integrateRecentViews } from '../../../data/recent-views/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../../data/settings/index';\nimport { booleanToString, compareThings, generateIdentifier } from '../../../tools/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { openBus } from '../../bus/index';\nimport { getBlankIconElement, setIcon } from '../../icons/index';\nimport { GeneratedElement, querySize } from '../../index';\nimport { openLocation } from '../../location/index';\nimport { openRoute } from '../../route/index';\n\nconst HomeField = documentQuerySelector('.css_home_field');\nconst HomeBodyElement = elementQuerySelector(HomeField, '.css_home_body');\nconst RecentViewsField = elementQuerySelector(HomeBodyElement, '.css_home_recent_views');\nconst RecentViewsContentElement = elementQuerySelector(RecentViewsField, '.css_home_recent_views_content');\n\nlet previousIntegration = {};\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet recentViewsRefreshTimer_retryInterval: number = 10 * 1000;\nlet recentViewsRefreshTimer_baseInterval: number = 15 * 1000;\nlet recentViewsRefreshTimer_minInterval: number = 5 * 1000;\nlet recentViewsRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet recentViewsRefreshTimer_dynamic: boolean = true;\nlet recentViewsRefreshTimer_streaming: boolean = false;\nlet recentViewsRefreshTimer_lastUpdate: number = 0;\nlet recentViewsRefreshTimer_nextUpdate: number = 0;\nlet recentViewsRefreshTimer_refreshing: boolean = false;\nlet recentViewsRefreshTimer_currentRequestID: string = '';\nlet recentViewsRefreshTimer_streamStarted: boolean = false;\nlet recentViewsRefreshTimer_timer: ReturnType<typeof setTimeout>;\n\nfunction generateElementOfRecentViewItem(): GeneratedElement {\n  // Main container\n  const recentViewsItemElement = document.createElement('div');\n  recentViewsItemElement.classList.add('css_home_recent_views_item');\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_home_recent_views_item_head');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_home_recent_views_item_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  // Title\n  const titleElement = document.createElement('div');\n  titleElement.classList.add('css_home_recent_views_item_title');\n\n  // Time\n  const timeElement = document.createElement('div');\n  timeElement.classList.add('css_home_recent_views_item_time');\n\n  // Assemble head\n  headElement.appendChild(iconElement);\n  headElement.appendChild(titleElement);\n  headElement.appendChild(timeElement);\n\n  // Name\n  const nameElement = document.createElement('div');\n  nameElement.classList.add('css_home_recent_views_item_name');\n\n  // Assemble item\n  recentViewsItemElement.appendChild(headElement);\n  recentViewsItemElement.appendChild(nameElement);\n\n  return {\n    element: recentViewsItemElement,\n    id: ''\n  };\n}\n\nfunction updateRecentViewsField(integration: integratedRecentViews, skeletonScreen: boolean, animation: boolean) {\n  function updateItem(thisElement: HTMLElement, thisItem: integratedRecentView, previousItem: integratedRecentView): void {\n    function updateIcon(thisElement: HTMLElement, thisItem: integratedRecentView): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_home_recent_views_item_head');\n      const thisIconElement = elementQuerySelector(thisHeadElement, '.css_home_recent_views_item_icon');\n      let icon = '';\n      switch (thisItem.type) {\n        case 'route':\n          icon = 'route';\n          break;\n        case 'location':\n          icon = 'location_on';\n          break;\n        case 'bus':\n          icon = 'directions_bus';\n          break;\n        case 'empty':\n          icon = 'lightbulb';\n          break;\n        default:\n          break;\n      }\n      setIcon(thisIconElement, icon);\n    }\n\n    function updateTitle(thisElement: HTMLElement, thisItem: integratedRecentView): void {\n      const titleElement = elementQuerySelector(thisElement, '.css_home_recent_views_item_head .css_home_recent_views_item_title');\n      let title = '';\n      switch (thisItem.type) {\n        case 'route':\n          title = '';\n          break;\n        case 'location':\n          title = '';\n          break;\n        case 'bus':\n          title = '';\n          break;\n        case 'empty':\n          title = '';\n          break;\n        default:\n          break;\n      }\n      titleElement.innerText = title;\n    }\n\n    function updateTime(thisElement: HTMLElement, thisItem: integratedRecentView): void {\n      const timeElement = elementQuerySelector(thisElement, '.css_home_recent_views_item_head .css_home_recent_views_item_time');\n      timeElement.innerText = thisItem.time.relative;\n    }\n\n    function updateName(thisElement: HTMLElement, thisItem: integratedRecentView): void {\n      const nameElement = elementQuerySelector(thisElement, '.css_home_recent_views_item_name');\n      nameElement.innerText = thisItem.name;\n    }\n\n    function updateOnclick(thisElement: HTMLElement, thisItem: integratedRecentView): void {\n      switch (thisItem.type) {\n        case 'route':\n          thisElement.onclick = function () {\n            openRoute(thisItem.id, thisItem.pid);\n          };\n          break;\n        case 'location':\n          thisElement.onclick = function () {\n            openLocation(thisItem.hash);\n          };\n          break;\n        case 'bus':\n          thisElement.onclick = function () {\n            openBus(thisItem.id);\n          };\n          break;\n        case 'empty':\n          thisElement.onclick = null;\n          break;\n        default:\n          break;\n      }\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateIcon(thisElement, thisItem);\n      updateTitle(thisElement, thisItem);\n      updateTime(thisElement, thisItem);\n      updateName(thisElement, thisItem);\n      updateOnclick(thisElement, thisItem);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (thisItem.type !== previousItem.type) {\n        updateIcon(thisElement, thisItem);\n        updateTitle(thisElement, thisItem);\n        updateTime(thisElement, thisItem);\n        updateName(thisElement, thisItem);\n        updateOnclick(thisElement, thisItem);\n        updateAnimation(thisElement, animation);\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      } else {\n        switch (thisItem.type) {\n          case 'location':\n            if (!compareThings(previousItem.name, thisItem.name)) {\n              updateName(thisElement, thisItem);\n            }\n            if (previousItem.time !== thisItem.time) {\n              updateTime(thisElement, thisItem);\n            }\n            if (!compareThings(previousItem.hash, thisItem.hash)) {\n              updateOnclick(thisElement, thisItem);\n            }\n            break;\n          case 'route':\n            if (!compareThings(previousItem.name, thisItem.name)) {\n              updateName(thisElement, thisItem);\n            }\n            if (previousItem.time !== thisItem.time) {\n              updateTime(thisElement, thisItem);\n            }\n            if (!compareThings(previousItem.id, thisItem.id) || !compareThings(previousItem.pid, thisItem.pid)) {\n              updateOnclick(thisElement, thisItem);\n            }\n            break;\n          case 'bus':\n            if (!compareThings(previousItem.name, thisItem.name)) {\n              updateName(thisElement, thisItem);\n            }\n            if (previousItem.time !== thisItem.time) {\n              updateTime(thisElement, thisItem);\n            }\n            if (!compareThings(previousItem.id, thisItem.id)) {\n              updateOnclick(thisElement, thisItem);\n            }\n            break;\n          case 'empty':\n            if (previousItem.time !== thisItem.time) {\n              updateTime(thisElement, thisItem);\n            }\n            break;\n          default:\n            break;\n        }\n        if (animation !== previousAnimation) {\n          updateAnimation(thisElement, animation);\n        }\n        if (skeletonScreen !== previousSkeletonScreen) {\n          updateSkeletonScreen(thisElement, skeletonScreen);\n        }\n      }\n    }\n  }\n\n  const itemQuantity = integration.itemQuantity;\n\n  const currentItemCapacity = elementQuerySelectorAll(RecentViewsContentElement, '.css_home_recent_views_item').length;\n  if (itemQuantity !== currentItemCapacity) {\n    const difference = currentItemCapacity - itemQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newRecentViewItemElement = generateElementOfRecentViewItem();\n        fragment.appendChild(newRecentViewItemElement.element);\n      }\n      RecentViewsContentElement.append(fragment);\n    } else {\n      const RecentViewsItemElements = elementQuerySelectorAll(RecentViewsContentElement, '.css_home_recent_views_item');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const recentViewItemIndex = currentItemCapacity - 1 - o;\n        RecentViewsItemElements[recentViewItemIndex].remove();\n      }\n    }\n  }\n\n  const RecentViewsItemElements = elementQuerySelectorAll(RecentViewsContentElement, '.css_home_recent_views_item');\n  for (let i = 0; i < itemQuantity; i++) {\n    const thisElement = RecentViewsItemElements[i];\n    const thisItem = integration.items[i];\n    if (previousIntegration.hasOwnProperty('items')) {\n      if (previousIntegration.items[i]) {\n        const previousItem = previousIntegration.items[i];\n        updateItem(thisElement, thisItem, previousItem);\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    } else {\n      updateItem(thisElement, thisItem, null);\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nexport function setUpRecentViewsFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const defaultItemQuantity = Math.floor(WindowSize.height / 70 / 3) + 2;\n  const items: Array<integratedRecentView> = [];\n  for (let i = 0; i < defaultItemQuantity; i++) {\n    items.push({\n      type: 'route',\n      id: 0,\n      pid: [],\n      time: {\n        absolute: 0,\n        relative: ''\n      },\n      name: ''\n    });\n  }\n  updateRecentViewsField(\n    {\n      items: items,\n      itemQuantity: items.length,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nasync function refreshRecentViews() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  recentViewsRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  recentViewsRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  recentViewsRefreshTimer_refreshing = true;\n  recentViewsRefreshTimer_currentRequestID = generateIdentifier();\n  // documentQuerySelector('.css_home_update_timer').setAttribute('refreshing', 'true');\n  const integration = await integrateRecentViews(recentViewsRefreshTimer_currentRequestID);\n  updateRecentViewsField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (recentViewsRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  recentViewsRefreshTimer_lastUpdate = new Date().getTime();\n  if (recentViewsRefreshTimer_dynamic) {\n    recentViewsRefreshTimer_nextUpdate = Math.max(recentViewsRefreshTimer_lastUpdate + recentViewsRefreshTimer_minInterval, integration.dataUpdateTime + recentViewsRefreshTimer_baseInterval / updateRate);\n  } else {\n    recentViewsRefreshTimer_nextUpdate = recentViewsRefreshTimer_lastUpdate + recentViewsRefreshTimer_baseInterval;\n  }\n  recentViewsRefreshTimer_dynamicInterval = Math.max(recentViewsRefreshTimer_minInterval, recentViewsRefreshTimer_nextUpdate - recentViewsRefreshTimer_lastUpdate);\n  recentViewsRefreshTimer_refreshing = false;\n  // documentQuerySelector('.css_home_update_timer').setAttribute('refreshing', 'false');\n}\n\nasync function streamRecentViews() {\n  refreshRecentViews()\n    .then(function () {\n      if (recentViewsRefreshTimer_streaming) {\n        recentViewsRefreshTimer_timer = setTimeout(\n          function () {\n            streamRecentViews();\n          },\n          Math.max(recentViewsRefreshTimer_minInterval, recentViewsRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        recentViewsRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (recentViewsRefreshTimer_streaming) {\n        recentViewsRefreshTimer_timer = setTimeout(function () {\n          streamRecentViews();\n        }, recentViewsRefreshTimer_retryInterval);\n      } else {\n        recentViewsRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function initializeRecentViews(): void {\n  setUpRecentViewsFieldSkeletonScreen();\n  if (!recentViewsRefreshTimer_streaming) {\n    recentViewsRefreshTimer_streaming = true;\n    if (!recentViewsRefreshTimer_streamStarted) {\n      recentViewsRefreshTimer_streamStarted = true;\n      streamRecentViews();\n    } else {\n      refreshRecentViews();\n    }\n  }\n}\n","import { createPersonalSchedule } from '../../data/personal-schedule/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../tools/elements';\nimport { WeekDayIndex } from '../../tools/time';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst PersonalScheduleCreatorField = documentQuerySelector('.css_personal_schedule_creator_field');\nconst PersonalScheduleCreatorBodyElement = elementQuerySelector(PersonalScheduleCreatorField, '.css_personal_schedule_creator_body');\nconst PersonalScheduleCreatorGroups = elementQuerySelector(PersonalScheduleCreatorBodyElement, '.css_personal_schedule_creator_groups');\nconst nameInputElement = elementQuerySelector(PersonalScheduleCreatorGroups, '.css_personal_schedule_creator_group[group=\"schedule-name\"] .css_personal_schedule_creator_group_body input');\nconst startTimeInputElement = elementQuerySelector(PersonalScheduleCreatorGroups, '.css_personal_schedule_creator_group[group=\"schedule-start-time\"] .css_personal_schedule_creator_group_body input');\nconst endTimeInputElement = elementQuerySelector(PersonalScheduleCreatorGroups, '.css_personal_schedule_creator_group[group=\"schedule-end-time\"] .css_personal_schedule_creator_group_body input');\nconst dayGroupBodyElement = elementQuerySelector(PersonalScheduleCreatorGroups, '.css_personal_schedule_creator_group[group=\"schedule-days\"] .css_personal_schedule_creator_group_body');\nconst dayElements = elementQuerySelectorAll(dayGroupBodyElement, '.css_personal_schedule_creator_day');\n\nexport function createFormulatedPersonalSchedule(): void {\n  const name = nameInputElement.value;\n  const startTime = startTimeInputElement.value;\n  const endTime = endTimeInputElement.value;\n\n  const [startHours, startMinutes] = String(startTime)\n    .split(':')\n    .map((e) => parseInt(e));\n  const [endHours, endMinutes] = String(endTime)\n    .split(':')\n    .map((e) => parseInt(e));\n\n  let days = [];\n  for (let i = 0; i < 7; i++) {\n    const thisDayElement = dayElements[i];\n    const highlighted = thisDayElement.getAttribute('highlighted');\n    const day = parseInt(thisDayElement.getAttribute('day'));\n    if (highlighted === 'true') {\n      days.push(day);\n    }\n  }\n\n  createPersonalSchedule(name, startHours, startMinutes, endHours, endMinutes, days).then(function (e) {\n    if (e) {\n      closePersonalScheduleCreator();\n      promptMessage('calendar_view_day', '');\n    } else {\n      promptMessage('error', '');\n    }\n  });\n}\n\nexport function openPersonalScheduleCreator(): void {\n  pushPageHistory('PersonalScheduleCreator');\n  PersonalScheduleCreatorField.setAttribute('displayed', 'true');\n  closePreviousPage();\n}\n\nexport function closePersonalScheduleCreator(): void {\n  // revokePageHistory('PersonalScheduleCreator');\n  PersonalScheduleCreatorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport function switchPersonalScheduleCreatorDay(day: WeekDayIndex): void {\n  const thisDayElement = elementQuerySelector(dayGroupBodyElement, `.css_personal_schedule_creator_day[day=\"${day}\"]`);\n  const highlighted = thisDayElement.getAttribute('highlighted');\n  if (highlighted === 'true') {\n    thisDayElement.setAttribute('highlighted', 'false');\n  } else {\n    thisDayElement.setAttribute('highlighted', 'true');\n  }\n}\n","import { recoverBusArrivalTimeDataFromWriteAheadLog } from './data/analytics/bus-arrival-time/index';\r\nimport { discardExpiredDataUsageStats } from './data/analytics/data-usage/index';\r\nimport { discardExpiredUpdateRateDataGroups, initializeUpdateRateDataGroups, recoverUpdateRateDataFromWriteAheadLog } from './data/analytics/update-rate/index';\r\nimport { initializeFolderList } from './data/folder/index';\r\nimport { discardExpiredNotificationSchedules, initializeNotificationSchedules, loadNotificationClient } from './data/notification/index';\r\nimport { discardExpiredRecentViews } from './data/recent-views/index';\r\nimport { initializeSettings } from './data/settings/index';\r\nimport { checkAppVersion } from './data/settings/version';\r\nimport { askForCalibratingPermission } from './data/user-orientation/index';\r\nimport { askForPositioningPermission } from './data/user-position/index';\r\nimport { closeBus, openBus } from './interface/bus/index';\r\nimport { closeDataUsage } from './interface/data-usage/index';\r\nimport { closeFolderCreator, createFormulatedFolder, openFolderCreator } from './interface/folder-creator/index';\r\nimport { closeFolderIconSelector, updateMaterialSymbolsSearchResult } from './interface/folder-icon-selector/index';\r\nimport { closeFolderManager } from './interface/folder-manager/index';\r\nimport { initializeFolders, setUpFolderFieldSkeletonScreen } from './interface/home/folders/index';\r\nimport { downloadData } from './interface/home/index';\r\nimport { initializeRecentViews, setUpRecentViewsFieldSkeletonScreen } from './interface/home/recent-views/index';\r\nimport { fadeOutSplashScreen, setSplashScreenIconOffsetY, showErrorMessage } from './interface/index';\r\nimport { closeLocationDetails } from './interface/location/details/index';\r\nimport { closeLocation, initializeLocationSliding, openLocation } from './interface/location/index';\r\nimport { closeNotificationScheduleManager, openNotificationScheduleManager } from './interface/notification-schedule-manager/index';\r\nimport { closePersonalScheduleCreator, createFormulatedPersonalSchedule, openPersonalScheduleCreator, switchPersonalScheduleCreatorDay } from './interface/personal-schedule-creator/index';\r\nimport { closePersonalScheduleEditor, openPersonalScheduleEditor, saveEditedPersonalSchedule, switchPersonalScheduleEditorDay } from './interface/personal-schedule-editor/index';\r\nimport { closePersonalScheduleManager } from './interface/personal-schedule-manager/index';\r\nimport { closeQRCode, openQRCode } from './interface/qrcode/index';\r\nimport { closeRegisterNotification, openRegisterNotification, saveFormulatedRegisterNotification } from './interface/register-notification/index';\r\nimport { closeRouteDetails } from './interface/route/details/index';\r\nimport { closeRoute, initializeRouteSliding, switchRoute } from './interface/route/index';\r\nimport { closeSaveToFolder, openSaveToFolder } from './interface/save-to-folder/index';\r\nimport { closeScheduleNotification } from './interface/schedule-notification/index';\r\nimport { closeSearch, openSearch, resizeSearchInputCanvas, switchSearchTypeFilter, updateSearchInput, updateSearchResult } from './interface/search/index';\r\nimport { closeSettings, openSettings } from './interface/settings/index';\r\nimport { closeSettingsOptions } from './interface/settings/options';\r\nimport { closeStorage } from './interface/storage/index';\r\nimport { openPermalink } from './tools/permalink';\r\nimport { documentQuerySelector } from './tools/elements';\r\n\r\nimport './interface/theme.css';\r\n\r\nimport './interface/index.css';\r\n\r\nimport './interface/icons/index.css';\r\n\r\nimport './interface/animation.css';\r\n\r\nimport './interface/home/field.css';\r\nimport './interface/home/head.css';\r\nimport './interface/home/body.css';\r\n\r\nimport './interface/home/recent-views/recent-views.css';\r\nimport './interface/home/recent-views/item.css';\r\n\r\nimport './interface/home/folders/folders.css';\r\nimport './interface/home/folders/item.css';\r\n\r\nimport './interface/search/field.css';\r\nimport './interface/search/head.css';\r\nimport './interface/search/body.css';\r\nimport './interface/search/keyboard.css';\r\n\r\nimport './interface/route/field.css';\r\nimport './interface/route/head.css';\r\nimport './interface/route/groups.css';\r\nimport './interface/route/item.css';\r\nimport './interface/route/thread.css';\r\nimport './interface/route/index.css';\r\n\r\nimport './interface/route/details/field.css';\r\nimport './interface/route/details/head.css';\r\nimport './interface/route/details/body.css';\r\nimport './interface/route/details/groups.css';\r\nimport './interface/route/details/actions.css';\r\nimport './interface/route/details/properties.css';\r\nimport './interface/route/details/calendar.css';\r\n\r\nimport './interface/location/field.css';\r\nimport './interface/location/head.css';\r\nimport './interface/location/groups.css';\r\nimport './interface/location/group-details.css';\r\nimport './interface/location/group-items.css';\r\nimport './interface/location/index.css';\r\n\r\nimport './interface/location/details/field.css';\r\nimport './interface/location/details/head.css';\r\nimport './interface/location/details/body.css';\r\nimport './interface/location/details/actions.css';\r\nimport './interface/location/details/index.css';\r\n\r\nimport './interface/bus/field.css';\r\nimport './interface/bus/head.css';\r\nimport './interface/bus/body.css';\r\nimport './interface/bus/groups.css';\r\nimport './interface/bus/properties.css';\r\n\r\nimport './interface/settings/field.css';\r\nimport './interface/settings/head.css';\r\nimport './interface/settings/body.css';\r\nimport './interface/settings/items.css';\r\nimport './interface/settings/index.css';\r\n\r\nimport './interface/save-to-folder/field.css';\r\nimport './interface/save-to-folder/head.css';\r\nimport './interface/save-to-folder/body.css';\r\nimport './interface/save-to-folder/list.css';\r\nimport './interface/save-to-folder/item.css';\r\n\r\nimport './interface/folder-manager/field.css';\r\nimport './interface/folder-manager/head.css';\r\nimport './interface/folder-manager/body.css';\r\nimport './interface/folder-manager/list.css';\r\nimport './interface/folder-manager/item.css';\r\n\r\nimport './interface/folder-editor/field.css';\r\nimport './interface/folder-editor/head.css';\r\nimport './interface/folder-editor/body.css';\r\nimport './interface/folder-editor/groups.css';\r\nimport './interface/folder-editor/folder-name.css';\r\nimport './interface/folder-editor/folder-icon.css';\r\nimport './interface/folder-editor/folder-content.css';\r\n\r\nimport './interface/folder-creator/field.css';\r\nimport './interface/folder-creator/head.css';\r\nimport './interface/folder-creator/body.css';\r\nimport './interface/folder-creator/groups.css';\r\nimport './interface/folder-creator/folder-name.css';\r\nimport './interface/folder-creator/folder-icon.css';\r\n\r\nimport './interface/folder-icon-selector/field.css';\r\nimport './interface/folder-icon-selector/head.css';\r\nimport './interface/folder-icon-selector/body.css';\r\nimport './interface/folder-icon-selector/symbols.css';\r\n\r\nimport './interface/personal-schedule-manager/field.css';\r\nimport './interface/personal-schedule-manager/head.css';\r\nimport './interface/personal-schedule-manager/body.css';\r\nimport './interface/personal-schedule-manager/list.css';\r\nimport './interface/personal-schedule-manager/item.css';\r\n\r\nimport './interface/personal-schedule-creator/field.css';\r\nimport './interface/personal-schedule-creator/head.css';\r\nimport './interface/personal-schedule-creator/body.css';\r\nimport './interface/personal-schedule-creator/groups.css';\r\nimport './interface/personal-schedule-creator/schedule-name.css';\r\nimport './interface/personal-schedule-creator/schedule-start-time.css';\r\nimport './interface/personal-schedule-creator/schedule-end-time.css';\r\nimport './interface/personal-schedule-creator/schedule-days.css';\r\n\r\nimport './interface/personal-schedule-editor/field.css';\r\nimport './interface/personal-schedule-editor/head.css';\r\nimport './interface/personal-schedule-editor/body.css';\r\nimport './interface/personal-schedule-editor/groups.css';\r\nimport './interface/personal-schedule-editor/schedule-name.css';\r\nimport './interface/personal-schedule-editor/schedule-start-time.css';\r\nimport './interface/personal-schedule-editor/schedule-end-time.css';\r\nimport './interface/personal-schedule-editor/schedule-days.css';\r\n\r\nimport './interface/notification-schedule-manager/field.css';\r\nimport './interface/notification-schedule-manager/head.css';\r\nimport './interface/notification-schedule-manager/body.css';\r\nimport './interface/notification-schedule-manager/list.css';\r\nimport './interface/notification-schedule-manager/item.css';\r\n\r\nimport './interface/register-notification/field.css';\r\nimport './interface/register-notification/head.css';\r\nimport './interface/register-notification/body.css';\r\nimport './interface/register-notification/groups.css';\r\nimport './interface/register-notification/provider.css';\r\nimport './interface/register-notification/registration-key.css';\r\n\r\nimport './interface/schedule-notification/field.css';\r\nimport './interface/schedule-notification/head.css';\r\nimport './interface/schedule-notification/body.css';\r\nimport './interface/schedule-notification/list.css';\r\nimport './interface/schedule-notification/item.css';\r\n\r\nimport './interface/data-usage/field.css';\r\nimport './interface/data-usage/head.css';\r\nimport './interface/data-usage/body.css';\r\nimport './interface/data-usage/chart.css';\r\nimport './interface/data-usage/statistics.css';\r\n\r\nimport './interface/storage/field.css';\r\nimport './interface/storage/head.css';\r\nimport './interface/storage/body.css';\r\nimport './interface/storage/statistics.css';\r\nimport './interface/storage/index.css';\r\n\r\nimport './interface/qrcode/field.css';\r\nimport './interface/qrcode/head.css';\r\nimport './interface/qrcode/body.css';\r\nimport './interface/qrcode/qrcode.css';\r\n\r\nimport './interface/prompt/index.css';\r\n\r\nlet busInitialized = false;\r\nlet busSecondlyInitialized = false;\r\n\r\nwindow.bus = {\r\n  initialize: function () {\r\n    if (busInitialized === false) {\r\n      busInitialized = true;\r\n      setSplashScreenIconOffsetY();\r\n      initializeSettings().then(function () {\r\n        setUpRecentViewsFieldSkeletonScreen();\r\n        setUpFolderFieldSkeletonScreen();\r\n        checkAppVersion()\r\n          .then((status) => {\r\n            if (status === 'ok') {\r\n              initializeRouteSliding();\r\n              initializeLocationSliding();\r\n              resizeSearchInputCanvas();\r\n              window.addEventListener('resize', () => {\r\n                resizeSearchInputCanvas();\r\n              });\r\n              if (screen) {\r\n                if (screen.orientation) {\r\n                  screen.orientation.addEventListener('change', () => {\r\n                    resizeSearchInputCanvas();\r\n                  });\r\n                }\r\n              }\r\n              initializeRecentViews();\r\n              initializeFolderList().then(() => {\r\n                initializeFolders();\r\n              });\r\n              const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n              const searchInputElement = documentQuerySelector('.css_search_field .css_search_head .css_search_search_input #search_input') as HTMLInputElement;\r\n              mediaQuery.addEventListener('change', function () {\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('paste', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('cut', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('selectionchange', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              document.addEventListener('selectionchange', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('keyup', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n\r\n              const searchMaterialSymbolsInputElement = documentQuerySelector('.css_folder_icon_selector_field .css_folder_icon_selector_head .css_folder_icon_selector_search_input #search_material_symbols_input') as HTMLInputElement;\r\n              searchMaterialSymbolsInputElement.addEventListener('paste', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              searchMaterialSymbolsInputElement.addEventListener('cut', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              searchMaterialSymbolsInputElement.addEventListener('selectionchange', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              document.addEventListener('selectionchange', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              searchMaterialSymbolsInputElement.addEventListener('keyup', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              openPermalink();\r\n              fadeOutSplashScreen(function () {\r\n                loadNotificationClient();\r\n                initializeNotificationSchedules().then(function () {\r\n                  discardExpiredNotificationSchedules();\r\n                });\r\n                document.addEventListener(\r\n                  'click',\r\n                  function () {\r\n                    askForPositioningPermission();\r\n                    askForCalibratingPermission();\r\n                  },\r\n                  { once: true }\r\n                );\r\n              });\r\n            }\r\n            if (status === 'fetchError' || status === 'unknownError') {\r\n              showErrorMessage();\r\n              fadeOutSplashScreen();\r\n            }\r\n          })\r\n          .catch(() => {\r\n            showErrorMessage();\r\n            fadeOutSplashScreen();\r\n          });\r\n      });\r\n    }\r\n  },\r\n  secondlyInitialize: function () {\r\n    if (!busSecondlyInitialized) {\r\n      busSecondlyInitialized = true;\r\n      downloadData();\r\n      discardExpiredUpdateRateDataGroups();\r\n      discardExpiredDataUsageStats();\r\n      recoverBusArrivalTimeDataFromWriteAheadLog();\r\n      discardExpiredRecentViews();\r\n      discardExpiredUpdateRateDataGroups().then(function () {\r\n        initializeUpdateRateDataGroups().then(function () {\r\n          recoverUpdateRateDataFromWriteAheadLog();\r\n        });\r\n      });\r\n    }\r\n  },\r\n  route: {\r\n    closeRoute,\r\n    switchRoute,\r\n    closeRouteDetails\r\n  },\r\n  location: {\r\n    openLocation,\r\n    closeLocation,\r\n    closeLocationDetails\r\n  },\r\n  folder: {\r\n    openSaveToFolder,\r\n    closeSaveToFolder,\r\n    closeFolderManager,\r\n    closeFolderIconSelector,\r\n    openFolderCreator,\r\n    closeFolderCreator,\r\n    createFormulatedFolder\r\n  },\r\n  search: {\r\n    openSearch,\r\n    closeSearch,\r\n    switchSearchTypeFilter\r\n  },\r\n  storage: {\r\n    closeStorage\r\n  },\r\n  dataUsage: {\r\n    closeDataUsage\r\n  },\r\n  personalSchedule: {\r\n    closePersonalScheduleManager,\r\n    openPersonalScheduleCreator,\r\n    closePersonalScheduleCreator,\r\n    createFormulatedPersonalSchedule,\r\n    switchPersonalScheduleCreatorDay,\r\n    openPersonalScheduleEditor,\r\n    closePersonalScheduleEditor,\r\n    switchPersonalScheduleEditorDay,\r\n    saveEditedPersonalSchedule\r\n  },\r\n  settings: {\r\n    openSettings,\r\n    closeSettings,\r\n    closeSettingsOptions\r\n  },\r\n  bus: {\r\n    openBus,\r\n    closeBus\r\n  },\r\n  notification: {\r\n    openNotificationScheduleManager,\r\n    closeNotificationScheduleManager,\r\n    openRegisterNotification,\r\n    closeRegisterNotification,\r\n    saveFormulatedRegisterNotification,\r\n    closeScheduleNotification\r\n  },\r\n  qrcode: {\r\n    openQRCode,\r\n    closeQRCode\r\n  }\r\n};\r\n\r\nexport default window.bus;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + ({\"36\":\"simplifyRoute-worker\",\"93\":\"extractSegmentBuffers-worker\",\"275\":\"getUpdateRate-worker\",\"439\":\"simplifyCarInfo-worker\",\"444\":\"pakoInflate-worker\",\"454\":\"simplifyLocation-worker\",\"473\":\"mergeLocationByName-worker\",\"627\":\"getBusArrivalTimeDataStats-worker\",\"661\":\"simplifyStop-worker\",\"757\":\"indexLocationByGeohash-worker\",\"818\":\"getDataUsageStats-worker\",\"897\":\"simplifySegmentBuffers-worker\"}[chunkId] || chunkId) + \".\" + {\"36\":\"f8d9d6dd61ca508f8b97\",\"93\":\"1e01584f4dc705054c33\",\"113\":\"980a2bd5c76ebe76878c\",\"275\":\"b569cc4f0daa96891992\",\"439\":\"054ffb4a4294b11b17de\",\"444\":\"fdbb2e8558e5ee42b8ef\",\"454\":\"81fdde400df4e1b317de\",\"473\":\"01d95f115b41468004ce\",\"494\":\"980a2bd5c76ebe76878c\",\"627\":\"7899c940614cbd654d2b\",\"661\":\"1c25d8990601fa977d16\",\"757\":\"470ac98b5c1d5d032240\",\"818\":\"d20b1f30a1a3b2c032f8\",\"897\":\"89749e6b138f2494beeb\"}[chunkId] + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"./\";","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkbus\"] = self[\"webpackChunkbus\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [377], () => (__webpack_require__(6519)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["root","factory","exports","module","define","amd","self","deferred","offsetDate","origin","date","hours","minutes","duplicatedOrigin","Date","setDate","setMonth","setHours","setMinutes","setSeconds","setMilliseconds","setFullYear","getFullYear","getMonth","getDate","dateToString","arguments","length","undefined","replaceAll","String","padStart","getHours","getMinutes","getSeconds","dateToRelativeTime","time","getTime","seconds","Math","floor","interval","formatTime","mode","roundedTime","map","u","join","parseFloat","toFixed","indexToDay","index","name","day","code","dateValueToDayOfWeek","dateValue","parseInt","timeObjectToString","timeObject","createDateObjectFromDate","year","month","dateObject","localforage","require","storage","cacheStore","settingsStore","dataUsageStatsStore","updateRateDataStore","updateRateDataWriteAheadLogStore","busArrivalTimeDataWriteAheadLogStore","busArrivalTimeDataStore","personalScheduleStore","recentViewsStore","notificationStore","notificationScheduleStore","folderListStore","folderContentIndexStore","folderContentStore","stores","lfSetItem","_x2","_x3","_x4","_lfSetItem","apply","_asyncToGenerator","store","key","value","storeKey","createInstance","setItem","err","lfGetItem","_x5","_x6","_lfGetItem","getItem","lfRemoveItem","_x7","_x8","_lfRemoveItem","removeItem","lfListItemKeys","_x9","_lfListItemKeys","keys","isStoragePersistent","_isStoragePersistent","navigator","persist","persisted","_askForPersistentStorage","_recordDataUsage","contentLength","existingDataUsageStatsChunkJSON","existingDataUsageStatsChunkObject","JSON","parse","stats","sum","data","changedData","max","min","stringify","newDataUsageStatsChunk","Uint32Array","Array","from","_listDataUsageStatsChunks","endDate","startDate","result","i","push","blankDataUsageStatsChunk","_discardExpiredDataUsageStats","_step","now","_iterator","_createForOfIteratorHelper","s","n","done","json","object","millisecondsPerDay","e","f","_getDataUsageStats","width","height","padding","worker","Worker","URL","dataUsageStatsChunks","listDataUsageStatsChunks","Promise","resolve","reject","onmessage","terminate","onerror","message","postMessage","convertPositionsToDistance","lat1","lon1","lat2","lon2","dLat","PI","dLon","a","sin","cos","atan2","sqrt","convertBytes","units","convertNumberToLetters","number","remainder","fromCharCode","documentQuerySelector","selectorExpression","document","querySelector","documentQuerySelectorAll","querySelectorAll","elementQuerySelector","element","elementQuerySelectorAll","getElementsBelow","referenceElement","className","elements","sibling","nextElementSibling","classList","contains","getAPIURL","city","api","alternative","cities","buckets","proxy","getSettingOptionValue","getNoCacheParameter","port","pakoInflateWorkerResponses","SharedWorker","pakoInflateSharedWorker","start","pakoInflateWorker","_pakoInflate","buffer","taskID","generateIdentifier","_e$data","_slicedToArray","tasks","FetchError","Error","fetchData","_x","_fetchData","url","requestID","tag","fileType","hasOwnProperty","processing","requests","timestamp","setDataReceivingProgress","failed","response","fetch","ok","status","headers","get","reader","body","getReader","chunks","receivedLength","_yield$reader$read","read","progress","request","uint8Array","Uint8Array","position","_i","_chunks","chunk","set","blob","Blob","type","arrayBuffer","inflatedData","pakoInflate","test","replace","recordDataUsage","shift","discardExpiredFetchTasks","dataReceivingProgress","expel","broadcastDataReceivingProgress","total","getDataReceivingProgress","_typeof","received","Infinity","isNaN","deleteDataReceivingProgress","stage","eventDict","target","event","CustomEvent","detail","dispatchEvent","dataUpdateTime","setDataUpdateTime","timeNumber","string","match","date_object","timeStampToNumber","getDataUpdateTime","deleteDataUpdateTime","getBusData","_getBusData","concat","BusInfo","EssentialInfo","UpdateTime","getBusEvent","_getBusEvent","CarInfoAPIVariableCache","raw","available","simplified","simplifyCarInfo","_simplifyCarInfo","CarInfo","getCarInfo","_getCarInfo","getData","_getData","cacheType","cacheKey","cacheTimestamp","finalResult","cache","LocationAPIVariableCache","merged","indexed","simplifyLocation","_simplifyLocation","Location","mergeLocationByName","_mergeLocationByName","indexLocationByGeohash","_indexLocationByGeohash","getLocation","_getLocation","simplified_result","merged_result","StopAPIVariableCache_available","StopAPIVariableCache_data","simplifyStop","_simplifyStop","array","getStop","_getStop","parseEstimateTime","EstimateTime","text","parseTimeCode","codeLength","substring","number1","number2","parseCarType","CarType","parseCarOnStop","CarOnStop","onStop","parseBusStatus","BusStatus","situation","formatBus","batchFoundBus","carNumber","BusID","RouteName","onThisRoute","areItemsDifferent","arr","j","getIntersection","arrayA","arrayB","item","indexOf","_step2","_iterator2","getUnicodes","unique","stringLength","unicode","charCodeAt","containPhoneticSymbols","RouteAPIVariableCache_available","RouteAPIVariableCache_data","simplifyRoute","_simplifyRoute","Route","getRoute","_getRoute","_searchRouteByName","query","thisRoute","searchRouteByRouteID","_searchRouteByRouteID","RouteID","routeKey","_searchRouteByPathAttributeId","PathAttributeId","pid","searchIndex","searchList","readyToSearch","_prepareForSearch","mergedLocation","list","thisItem","id","dep","des","hash","lo","la","r","_step5","_iterator5","toLowerCase","thisLocation","_step6","_iterator6","thisCarInfo","BusId","CarNum","_step7","_iterator7","calculateSearchResultScore","queryUnicodes","resultUnicodes","score","abs","_integrateBus","carKey","BusData","BusEvent","Stop","properties","LocationName","thisCar","thisCarNumber","icon","thisBusDataItem","BusDataItem","thisBusDataItemPathAttributeId","thisBusDataItemGoBack","GoBack","thisBusEventItem","BusEventItem","thisBusEventItemStopID","StopID","searchedRoutes","searchRouteByPathAttributeId","searchedRoute","thisRouteID","thisRouteFullPathAttributeId","thisRouteName","thisRouteDeparture","thisRouteDirection","FullPathAttributeId","StopKey","thisLocationItemName","stopLocationId","listRecentViews","_listRecentViews","itemObject","toISOString","_discardExpiredRecentViews","logRecentView","_logRecentView","param","existingJSON","existingRecentViewObject","recentViewRouteObject","LocationKey","recentViewLocationObject","CarKey","recentViewBusObject","getRecentView","_getRecentView","existingRecentViewRoute","_integrateRecentViews","_step3","recentViewList","items","itemQuantity","_iterator3","recentView","recentViewType","recentViewTime","integratedRecentViewRoute","thisRoutePathAttributeId","absolute","relative","integratedRecentViewLocation","thisLocationHash","thisLocationName","integratedRecentViewBus","thisBusID","thisBusName","integratedRecentViewEmpty","thisEmptyID","thisEmptyName","sort","b","getIconHTML","identifier","getIconElement","iconElement","createElement","add","innerText","getBlankIconElement","setIcon","parentElement","previousProperties","previousSkeletonScreen","previousAnimation","generateElementOfBusProperty","appendChild","valueElement","updateBusPropertiesField","skeletonScreen","animation","updateProperty","thisElement","thisProperty","previousProperty","updateIcon","updateValue","updateAnimation","setAttribute","updateSkeletonScreen","compareThings","propertyQuantity","currentPropertyCapacity","BusPropertiesGroupBodyElement","difference","fragment","DocumentFragment","o","d","newPropertyElement","append","propertyElements","remove","thisPropertyElement","BusField","BusBodyElement","BusGroupsElement","BusPropertiesGroupElement","openBus","pushPageHistory","_initializeBusPage","initializeBusPage","closePreviousPage","closeBus","openPreviousPage","playing_animation","setUpBusPropertiesFieldSkeletonScreen","integration","integrateBus","mergeStandardDeviation","targetAverage","targetSTDEV","targetDataLength","sourceAverage","sourceSTDEV","sourceDataLength","mergedDataLength","mergedAverage","mergedVariance","pow","normalizeVector","vector","hypot","componentQuantity","newVector","Float32Array","scale","findGlobalExtrema","arrayLength","updateRateData_trackedStops","updateRateData_writeAheadLog_id","updateRateData_writeAheadLog_tracking","updateRateData_writeAheadLog_currentDataLength","updateRateData_writeAheadLog_group","updateRateData_groups","updateRateData_groupsIndex","getUpdateRateDataStats","sumEstimateTime","sumEstimateTimeSquared","sumTimestamp","sumTimestampSquared","dataLength","estimateTime","averageEstimateTime","averageTimestamp","estimateTimeVariance","timestampVariance","estimateTimeSTDEV","timestampSTDEV","covariance","item2","estimate_time","average","stdev","correlation","mergeUpdateRateDataStats","targetStats","sourceStats","mergedAverageEstimateTime","mergedAverageTimestamp","mergedEstimateTimeSTDEV","mergedTimestampSTDEV","mergedCorrelation","targetXAverage","targetYAverage","targetXSTDEV","targetYSTDEV","targetCorrelation","sourceXAverage","sourceYAverage","sourceXSTDEV","sourceYSTDEV","sourceCorrelation","mergePearsonCorrelation","_collectUpdateRateData","currentTimestamp","needToReset","EstimateTimeLength1","randomItem","random","stopID","stopKey","_step4","_iterator4","dataGroup","existingData","existingDataObject","existingIndex","splice","_recoverUpdateRateDataFromWriteAheadLog","oneWeekAgo","thisTimestamp","thisID","thisStopData","split","_initializeUpdateRateDataGroups","discardExpiredUpdateRateDataGroups","_discardExpiredUpdateRateDataGroups","getUpdateRateWorkerResponses","getUpdateRateSharedWorker","getUpdateRateWorker","getUpdateRate","_getUpdateRate","dataGroups","filter","getEstimateTime","_getEstimateTime","MaterialSymbolsAPIVariableCache_available","MaterialSymbolsAPIVariableCache_data","getMaterialSymbolsSearchIndex","_getMaterialSymbolsSearchIndex","apiurl","getMaterialSymbolsAPIURL","FolderList","_initializeFolderList","folderKey","thisFolderJSON","thisFolderObject","createFolder","_createFolder","materialSymbolsSearchIndex","symbols","folderID","newFolder","updateFolder","_updateFolder","existingFolderJSON","existingFolderObject","modifiedFolder","getFolder","listFolderContent","_listFolderContent","thisFolder","thisFolderContentIndexJSON","thisFolderContentIndexArray","thisFolderContentKey","thisContentJSON","thisContentObject","getFolderContentLength","_getFolderContentLength","listFoldersWithContent","_listFoldersWithContent","folders","folderObject","listFolders","folder","folderContent","folderContentLength","content","_listAllFolderContent","types","useFilter","isArray","_integrateFolders","foldersWithContent","time_formatting_mode","power_saving","refresh_interval_setting","StopIDs","folderWithContent1","m","batchFoundEstimateTime","EstimateTimeItem","_step8","folderWithContent2","integratedFolder","_iterator8","integratedItem","thisStopKey","thisEstimateTime","route","pathAttributeId","dynamic","collectUpdateRateData","_collectBusArrivalTimeData","collectBusArrivalTimeData","saveToFolder","_x0","_x1","_saveToFolder","contentKey","isFolderContentSaved","_x10","_x11","_isFolderContentSaved","_step9","folderContentKeyToCheck","_iterator9","_removeFromFolder","saveStop","_x15","_x16","_x17","_saveStop","thisStop","thisStopDirection","goBack","thisStopName","thisRouteDestination","newContent","direction","endPoints","departure","destination","saveRoute","_x18","_x19","_saveRoute","thisRouteKey","saveLocation","_x20","_x21","_saveLocation","thisLocationKey","_updateFolderContentIndex","offset","levenshtein","searchStructure","_prepareForMaterialSymbolsSearch","dictionary","names","wordToSymbols","nameIndex","symbol","wordIndexKey","dataDownloadRequestID","dataDownloadCompleted","HomeHeadElement","homeButtonRightElement","progressElement","handleDataReceivingProgressUpdates","pixels","style","setProperty","removeEventListener","addEventListener","once","_downloadData","currentTarget","folderEditorField","folderCreatorField","folderIconSelectorField","generateElementOfSymbol","onclick","iconInputElement","closeFolderIconSelector","selectFolderIcon","_initializeFolderIconSelectorField","materialSymbolsElement","innerHTML","materialSymbols","symbolElement","updateMaterialSymbolsSearchResult","materialSymbolsSearchResultsElement","searchResults","searchFrom","skipBroadTerms","broadThreshold","_searchStructure","broadLength","round","queryWords","Set","trim","queryWordsLength","minDistances","matchedWordIndexes","Int16Array","fill","l","distance","indexArrays","indexArraysLength","candidates","scored","searchForMaterialSymbols","openFolderIconSelector","initializeFolderIconSelectorField","prepareForMaterialSymbolsSearch","promptMessage","revokePageHistory","FolderCreatorField","FolderCreatorBodyElement","FolderCreatorGroupsElement","NameInputElement","IconInputElement","openFolderCreator","closeFolderCreator","FolderEditorField","FolderEditorHeadElement","LeftButtonElement","FolderEditorBodyElement","FolderEditorGroupsElement","OpenFolderIconSelectorElement","FolderContentElement","generateElementOfItem","itemElement","context","main","contextElement","createTextNode","mainElement","capsuleElement","sortUpElement","moveItemOnFolderEditor","sortDownElement","deleteElement","itemID","_x12","_x13","_x14","removeFromFolder","then","removeItemOnFolderEditor","separator1Element","separator2Element","updateFolderEditorField","closeFolderEditor","thisItemElement","_initializeFolderEditorField","openFolderEditor","initializeFolderEditorField","_x22","_x23","_x24","_x25","updateFolderContentIndex","previousSibling","previousElementSibling","parentNode","insertBefore","nextSibling","FolderManagerField","FolderManagerBodyElement","FolderManagerFolderListElement","folderItemElement","nameElement","statusElement","arrowElement","_initializeFolderManagerField","newItemElement","openFolderManager","initializeFolderManagerField","closeFolderManager","createPersonalSchedule","_createPersonalSchedule","startHours","startMinutes","endHours","endMinutes","days","Number","isInteger","period","end","getPersonalSchedule","_getPersonalSchedule","personalScheduleID","existingPersonalSchedule","updatePersonalSchedule","_updatePersonalSchedule","personalSchedule","listPersonalSchedules","_listPersonalSchedules","existingPersonalScheduleObject","_getMergedPersonalScheduleTimeline","dayKey","personalSchedulesOfThisDay","personalSchedulesOfThisDayLength","mergedPersonalSchedulesOfThisDay","previousPersonalScheduleOfThisDay","currentPersonalScheduleOfThisDay","_isInPersonalSchedule","timeline","getMergedPersonalScheduleTimeline","getDay","personalScheduleOfTheDay","PersonalScheduleEditorField","PersonalScheduleEditorBodyElement","PersonalScheduleEditorHeadElement","leftButtonElement","PersonalScheduleEditorGroups","nameInputElement","startTimeInputElement","endTimeInputElement","dayGroupBodyElement","dayElements","saveEditedPersonalSchedule","_saveEditedPersonalSchedule","startTime","endTime","_String$split$map","_String$split$map2","_String$split$map3","_String$split$map4","thisDayElement","highlighted","getAttribute","closePersonalScheduleEditor","_initializePersonalScheduleEditorField","openPersonalScheduleEditor","initializePersonalScheduleEditorField","PersonalScheduleManagerField","PersonalScheduleManagerBodyElement","ListElement","_initializePersonalScheduleManagerField","personalSchedules","openPersonalScheduleManager","initializePersonalScheduleManagerField","closePersonalScheduleManager","getNotificationAPIURL","method","NotificationProvider","searchParams","toString","getNotificationToken","client_id","secret","payload","sha512","getNotificationRequestBody","parameters","NotificationClientID","NotificationSecret","token","schedule_id","currentDate","stop_id","location_name","route_id","route_name","time_offset","scheduled_time","makeNotificationRequest","_makeNotificationRequest","requestOptions","credentials","jsonError","error","_rotateNotificationSecret","requestBody","setNotificationSecret","saveNotificationClient","_scheduleNotification","processed_schedule_time","rotateNotificationSecret","_saveNotificationSchedule","saveNotificationSchedule","NotifcationSchedules","NotifcationSchedulesIndex","NotifcationSchedulesStopIDIndex","_saveNotificationClient","currentClient","provider","_loadNotificationClient","existingClient","existingClientObject","getNotificationClientStatus","_initializeNotificationSchedules","thisScheduleJSON","thisSchedule","thisScheduleID","thisScheduleStopKey","thisNotificationSchedule","thisNotificationScheduleStopKey","thisNotificationScheduleIndex","_removeNotificationSchedule","existingScheduleIndex","stopHasNotifcationSchedules","_discardExpiredNotificationSchedules","existingSchedule","integrateNotifcationSchedules","_integrateNotifcationSchedules","notificationSchedules","listNotifcationSchedules","thisItemName","thisItemStopID","thisItemEstimateTime","thisItemScheduleID","thisItemScheduledTime","thisItemScheduledTimeDateInstance","thisItemDate","thisItemHours","thisItemMinutes","thisNotificationScheduleRouteKey","thisNotificationScheduleRoutePathAttributeId","items2","groups","_items","groupKey","is_first","scheduleNotificationOptions","scheduleNotificationForStop","_scheduleNotificationForStop","thisStopLocationId","thisStopGoBack","RouteKey","timeOffset","scheduling","scheduleNotification","_registerNotificationClient","registrationKey","RegisterNotificationField","RegisterNotificationBodyElement","RegisterNotificationGroupsElement","ProviderInputElement","RgistrationKeyInputElement","initializeRegisterNotificationField","openRegisterNotification","closeRegisterNotification","_saveFormulatedRegisterNotification","isValidURL","protocol","hostname","setNotificationProvider","registering","registerNotificationClient","getTextWidth","weight","size","fontFamily","canvas","getContext","font","measureText","drawRoundedRect","ctx","x","y","radius","tl","tr","br","bl","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","fillStyle","generateRoundedRectPath","inverted","_radius","command","CssVariableValueCache","light","dark","getCSSVariableValue","property","CurrentColorScheme","window","matchMedia","matches","getComputedStyle","documentElement","getPropertyValue","generateLetterLabels","quantity","addressToString","address","district","road","road_section","alley","alley_branch","doorplate","floornumber","UnknownCardinalDirection","NorthCardinalDirection","WestCardinalDirection","SouthCardinalDirection","EastCardinalDirection","NorthEastCardinalDirection","SQRT1_2","SouthEastCardinalDirection","SouthWestCardinalDirection","NorthWestCardinalDirection","getCardinalDirectionFromVector","directions","unitVector","maxDotProduct","bestMatch","_directions","dotProduct","userOrientation","current","permission","gained","asked","getUserOrientation","alpha","degree","cardinalDirection","angle","rankBatchFoundEstimateTime","StopIDList","rankingArray","thisBatchFoundEstimateTimeItem","thisStopID","rankingArrayLength","_rankingArray","rankingRatio","rankingCode","_integrateLocation","chartWidth","chartHeight","BusArrivalTimes","getBusArrivalTimes","location_labels","display_user_orientation","groupedItems","stopLocationIds","setsOfVectors","v","RouteIDs","stopLocationQuantity","batchFindEstimateTime","batchFoundBuses","BusDataObj","processedItem","thisBusData","latitude","Latitude","longitude","Longitude","isRouteSearched","thisRouteItem","batchFindBusesForLocation","cardinalDirections","vectorSet","labels","addresses","filledProperties","commonProperties","Object","entries","commonProperty","components","len","component","componentLen","generateLabelFromAddresses","generateDirectionLabels","thisGroupStops","stopQuantity","thisGroupRanking","stopId","thisItemRanking","ranking","route_direction","routeId","parsedEstimateTime","buses","thisBusArrivalTimes","busArrivalTimes","groupQuantity","SaveToFolderField","SaveToFolderBodyElement","SaveToFolderListElement","successfulSaveMessage","failedSaveMessage","iconSpanElement","itemElementID","saveToFolderButtonElement","k","booleanToString","closeSaveToFolder","saveStopItemOnRoute","saveStopItemOnLocation","actionButtonElement","_initializeSaveToFolderField","openSaveToFolder","initializeSaveToFolderField","ScheduleNotificationField","ScheduleNotificationBodyElement","ScheduleNotificationListElement","scheduleNotificationButtonElement","closeScheduleNotification","scheduleNotificationForStopItemOnRoute","scheduleNotificationForStopItemOnLocation","openScheduleNotification","newElement","initializeScheduleNotificationField","_integrateLocationDetails","actions","actionsQuantity","action","_shareLocationPermalink","shareLocationPermalink","_showLocationPermalinkQRCode","showLocationPermalinkQRCode","SegmentBuffersAPIVariableCache_available","SegmentBuffersAPIVariableCache_data","extractSegmentBuffers","_extractSegmentBuffers","xml","simplifySegmentBuffers","_simplifySegmentBuffers","_getSegmentBuffers","extractedResult","simplifiedResult","userPosition","askForPositioningPermission","geolocation","watchPosition","coords","enableHighAccuracy","timeout","maximumAge","getUserPosition","_integrateRoute","SimplifiedLocation","MergedLocation","IndexedLocation","SegmentBuffers","getSegmentBuffers","isOnThisRoute","batchFindBusesForRoute","hasSegmentBuffers","thisSegmentBuffers","positions","integratedStopItem","includes","sequence","seqNo","thisSimplifiedLocation","overlappingRoutes","overlappingRouteKey","overlappingRoute","RouteEndPoints","RouteDeparture","RouteDestination","html","thisSimplifiedLocationGeohash","g","thisIndexedLocationItem","nearbyLocations","mergedLocationKey","thisMergedLocation","nearbyLocationItem","overlappingStopKey","flat","isSegmentBuffer","isStartingPoint","isEndingPoint","useReversed","segmentBufferGroup","thisBufferZone","OriginStopID","DestinationStopID","segmentBuffer","nearestPosition","currentUserPosition","shortestDistance","nearestIndex","getNearestPosition","isBufferZoneOpened","isBufferZoneClosed","resultLength","nextItem","_ref","_ref2","x1","y1","_ref3","x2","y2","distance1","distance2","isNearest","nearest","result2","ProviderAPIVariableCache_available","ProviderAPIVariableCache_data","_getProvider","SemiTimetableAPIVariableCache_available","SemiTimetableAPIVariableCache_data","_getSemiTimeTable","TimetableAPIVariableCache_available","TimetableAPIVariableCache_data","_getTimeTable","generateCalendarFromTimeTables","timeTableRules","SemiTimeTable","TimeTable","today","dayOfToday","originDate","calendar","calendarDays","d_0","d_1","d_2","d_3","d_4","d_5","d_6","calendarDayQuantity","calendarEventGroups","calendarEventQuantity","thisWeekOrigin","DateType","dayOfWeek","DateValue","thisDayOrigin","thisPeriodStartTime","StartTime","thisPeriodStartTimeDateObject","thisPeriodEndTime","EndTime","thisPeriodEndTimeDateObject","thisPeriodDurationInMinutes","minWindow","LongHeadway","maxWindow","LowHeadway","averageWindow","headwayQuantity","violateRules","thisHeadwayDate","dateString","duration","deviation","thisDepartureTime","DepartureTime","_integrateRouteDetails","Id","findRoute","getSemiTimeTable","getTimeTable","Provider","getProvider","thisRouteGoFirstBusTime","goFirstBusTime","thisRouteGoLastBusTime","goLastBusTime","thisRouteBackFirstBusTime","backFirstBusTime","thisRouteBackLastBusTime","backLastBusTime","thisRouteGoFirstBusTimeOnHoliday","holidayGoFirstBusTime","thisRouteGoLastBusTimeOnHoliday","holidayGoLastBusTime","thisRouteBackFirstBusTimeOnHoliday","holidayBackFirstBusTime","thisRouteBackLastBusTimeOnHoliday","holidayBackLastBusTime","rushHourWindow","peakHeadway","offRushHourWindow","offPeakHeadway","rushHourWindowOnHoliday","holidayPeakHeadway","offRushHourWindowOnHoliday","holidayOffPeakHeadway","go","weekday","first","last","holiday","back","realSequence","getTimeTableRules","thisProvider","providerId","findProvider","nameZh","ticketPriceDescriptionZh","nameZn","phoneInfo","email","QRCode","generateRoundedQRCodeSVG","outerRadius","innerRadius","filledNeighborhood","blankNeighborhood","errorCorrectionLevel","qrData","create","modules","matrix","row","bit","generateQRCodeMatrix","commands","cornerRadius","displayed","_data","neighbor","_data2","some","QRCodeField","QRCodeBodyElement","openQRCode","svg","initializeQRCodeField","_shareRoutePermalink","link","getPermalink","share","title","_showRoutePermalinkQRCode","canvasSize","querySize","canvasWidth","canvasHeight","canvasScale","devicePixelRatio","previousCalendar","generateElementOfDay","generateElementOfEventGroup","eventGroupElement","canvasElement","updateDay","thisDay","currentDay","calendarDayElements","CalendarDaysElement","CalendarEventGroupElements","CalendarEventGroupsElement","_previousCalendar","_previousCalendar2","thisCalendarDayElement","thisEventGroupElement","eventGroupKey","calendarEventGroup","calendarDay","mainColorR","mainColorG","mainColorB","mainColorA","mainColor","gridColor","updateEventGroup","switchCalendarDay","thisCalendarEventGroupElement","thisCalendarEventGroup","drawGridline","thisContext","boxY","fillRect","boxX","textBaseline","labelText","labelMeasurement","labelWidth","labelHeight","actualBoundingBoxDescent","fillText","drawEvent","thisCalendarEvent","thisDayStart","boxWidth","boxHeight","textMeasurement","textWidth","textHeight","thisCalendarEventGroupCanvas","thisCalendarEventGroupCanvasContext","isDisplayed","updateDisplayed","setTransform","resizeRouteDetailsCalendarCanvas","clearRect","updateCalendarGroup","eventGroups","eventGroupQuantity","currentEventGroupCapacity","calendarDaysFragment","calendarEventGroupsFragment","newDayElement","newEventGroupElement","CalendarDayElements","eventGroupIndex","thisEventGroup","generateElementOfProperty","propertyElement","updatePropertiesField","PropertiesGroupElement","PropertiesGroupBodyElement","RouteDetailsField","RouteDetailsBodyElement","RouteDetailsGroupsElement","CalendarGroupElement","CalendarGroupBodyElement","ActionsGroupElement","svaeToFolderActionButtonElement","getPermalinkActionButton","showPermalinkQRCodeActionButton","_initializeRouteDetailsField","existence","shareRoutePermalink","showRoutePermalinkQRCode","setUppropertiesGroupSkeletonScreen","defaultEventQuantity","setUpCalendarGroupSkeletonScreen","integrateRouteDetails","openRouteDetails","initializeRouteDetailsField","RouteField","RouteHeadElement","RouteNameElement","RouteNameSpanElement","RouteButtonRightElement","RouteUpdateTimerElement","RouteGroupTabsElement","RouteGroupTabsTrayElement","RouteGroupTabLineTrackElement","RouteGroupTabLineElement","RouteGroupsElement","previousIntegration","routeSliding_initialIndex","routeSliding_targetIndex","routeSliding_groupQuantity","routeSliding_groupStyles","routeSliding_fieldWidth","routeSliding_sliding","routeRefreshTimer_baseInterval","routeRefreshTimer_minInterval","routeRefreshTimer_dynamicInterval","routeRefreshTimer_dynamic","routeRefreshTimer_lastUpdate","routeRefreshTimer_nextUpdate","routeRefreshTimer_currentRequestID","routeRefreshTimer_refreshing","routeRefreshTimer_streaming","routeRefreshTimer_streamStarted","currentRouteIDSet_RouteID","currentRouteIDSet_PathAttributeId","updateRouteCSS","tabLineWidth","percentage","offsetRatio","generateElementOfThreadBox","threadBoxElement","threadElement","threadProgressElement","threadStatusElement","nextSlideElement","currentSlideElement","threadBoxIdentifier","headElement","stretchElement","threadBoxElementID","itemBodyElement","itemsTrackElement","threadTrackElement","elementsBelowThreadBoxElement","elementsBelowItemElement","elementsBelowLength","itemsTrackElementRect","getBoundingClientRect","itemElementRect","threadTrackElementRect","threadBoxElementY","top","itemElementY","stretched","pushDirection","thisThreadBoxElement","stretchRouteItem","capsuleSeparatorElement","bodyElement","buttonsElement","tabBusElement","switchRouteBodyTab","tabBusIconElement","tabArrivalElement","tabArrivalIconElement","tabRouteElement","tabRouteIconElement","tabLocationElement","tabLocationIconElement","saveToFolderElement","saveToFolderIconElement","scheduleNotificationElement","scheduleNotificationIconElement","busesElement","overlappingRoutesElement","busArrivalTimesElement","nearbyLocationsElement","generateElementOfGroup","tracksElement","threadBoxSpace","itemSpaceElement","generateElementOfTab","updateRouteField","_previousIntegration","_previousIntegration2","updateItem","previousItem","updateStatus","thisThreadStatusElement","currentThreadSlideElement","nextThreadSlideElement","thisItemStatusElement","currentItemSlideElement","nextItemSlideElement","thisItemElementRect","left","bottom","right","windowWidth","innerWidth","windowHeight","innerHeight","updateSegmentBuffer","updateName","updateBuses","bus","updateOverlappingRoutes","updateBusArrivalTimes","busArrivalTime","chart","updateNearbyLocations","nearbyLocation","updateNearest","updateThread","previousProgress","thisProgress","thisThreadProgressElement","updateStretch","updateSaveToFolderButton","updateScheduleNotificationButton","havingNotifcationSchedules","WindowSize","FieldWidth","FieldHeight","cumulativeOffset","groupNames","initialGroupStyle","currentGroupCapacity","newGroupsFragment","newTabsFragment","newGroupElement","newTabElement","GroupElements","TabElements","groupIndex","RouteGroupElements","thisGroupElement","thisGroupItemsTrackElement","thisGroupThreadsTrackElement","currentItemCapacity","newItemsFragment","newThreadsFragment","newThreadBoxElement","thisGroupItemElements","thisGroupThreadElements","itemIndex","thisTabElement","scrollTop","refreshRoute","_refreshRoute","busArrivalTimeChartSize","baseInterval","integrateRoute","updateRate","streamRoute","setTimeout","openRoute","scrollLeft","focus","defaultItemQuantity","g_0","g_1","setUpRouteFieldSkeletonScreen","tabCode","buttons","openPermalink","permalinkValue","location","href","permalinkString","values","searchRouteByName","openLocation","approach","decodeURIComponent","LocationDetailsField","LocationDetailsBodyElement","LocationDetailsActionsElement","updateLocationDetailsField","updateOnclick","currentActionsCapacity","LocationActionElements","_initializeLocationDetailsField","integrateLocationDetails","openLocationDetails","setUpLocationDetailsFieldSkeletonScreen","initializeLocationDetailsField","LocationField","LocationHeadElement","LocationNameElement","LocationNameSpanElement","LocationButtonRightElement","LocationGroupsElement","LocationGroupTabsElement","LocationGroupTabsTrayElement","LocationGroupTabLineTrackElement","LocationGroupTabLineElement","LocationUpdateTimerElement","locationSliding_initialIndex","locationSliding_targetIndex","locationSliding_groupQuantity","locationSliding_groupStyles","locationSliding_fieldWidth","locationSliding_sliding","locationRefreshTimer_baseInterval","locationRefreshTimer_minInterval","locationRefreshTimer_dynamicInterval","locationRefreshTimer_dynamic","locationRefreshTimer_lastUpdate","locationRefreshTimer_nextUpdate","locationRefreshTimer_currentRequestID","locationRefreshTimer_refreshing","locationRefreshTimer_streaming","locationRefreshTimer_streamStarted","currentHashSet_hash","updateLocationCSS","rankElement","rankNextSlideElement","rankCurrentSlideElement","routeDirectionElement","routeNameElement","itemsElement","itemsElementRect","stretchLocationItem","busTabButtonElement","busTabIconElement","switchLocationBodyTab","arrivalTabButtonElement","arrivalTabIconElement","saveButtonElement","saveButtonIconElement","notifyButtonElement","notifyButtonIconElement","groupElement","detailsElement","detailsBodyElement","span","generateElementOfGroupDetailsProperty","updateLocationField","thisElementRect","thisHeadElement","updateRank","thisRankElement","updateRouteDirection","updateRouteName","thisItemBodyElement","thisItemButtonsElement","groupsFragment","tabsFragment","LocationGroupElements","LocationGroupTabElements","thisLocationGroupElement","LocationGroupItemsElement","LocationGroupItemElements","currentGroupPropertyCapacity","groupPropertyQuantity","thisLocationGroupDetailsElement","thisLocationGroupDetailsBodyElement","tabElements","groupElements","itemElements","refreshLocation","_refreshLocation","integrateLocation","streamLocation","setUpLocationFieldSkeletonScreen","previousSearchResults","searchField","searchHeadElement","searchBodyElement","searchInputElement","searchInputCanvasElement","searchTypeFilterButtonElement","searchResultsElement","searchKeyboardElement","searchInputCanvasContext","searchInputCanvasScale","cursorWidth","cursorBorderRadius","selectionHighlightBorderRadius","lineHeight","fontSize","keyboardRows","textColor","placeholderTextColor","cursorColor","textWidthToCursorStart","selectedTextWidth","selection","cursorOffset","playingCursorAnimation","keyboardInitialized","deleteCharFromInput","currentValue","getSearchInputValue","newValue","updateSearchResult","updateSearchInput","scrollDocumentToTop","emptyInput","openSystemKeyboard","preventDefault","openKeyboard","newButtonElement","eventName","supportTouch","currentItem","initializeKeyboard","animateCursor","getSearchTypeFilterValue","cursorStart","cursorEnd","empty","textAlign","globalAlpha","resizeSearchInputCanvas","performance","requestAnimationFrame","generateElementOfSearchResultItem","searchResultItemElement","typeElement","typeToIcon","updateTypeIcon","updateClickHandler","currentType","limit","lowerCaseQuery","asIsQueryUnicodes","unicodeGroups","unicodeGroupsLength1","intersection","currentGroup","exactMatchIds","exactMatches","has","searchFor","searchResultLength","searchResultElements2","searchResultElements","openSearch","prepareForSearch","closeSearch","_exportData","settings","Settings","SettingKeys","option","listSettingsWithOptions","RecentViews","version","personal_schedules","recent_views","importFolders","_importFolders","FolderWithContent","update","creation","importSettings","_importSettings","SettingWithOption","existingSetting","getSetting","changeSettingOption","importPersonalSchedules","_importPersonalSchedules","PersonalSchedule","_importRecentViews","RecentView","_importData","parsedData","importRecentViews","refreshPageWithTimeStamp","enforce","URLSearchParams","search","newUrl","pathname","history","replaceState","_getAppVersion","getHTMLVersionHash","getHTMLVersionBranchName","getTreeURLOfCurrentVersion","getHTMLVersionTimeStamp","_checkAppVersion","appVersion","getAppVersion","SettingsField","SettingsBodyElement","SettingsElement","settingElement","arrowSpanElement","_initializeSettingsField","_listSettings","listSettings","openSettings","initializeSettingsField","closeSettings","_downloadExportFile","exportData","fileName","fileObj","File","canShare","files","downloadBlobFile","releaseFile","SplashScreenElement","ErrorMessageElement","splashScreenTimer_openTime","pageHistory","page","pageHistoryLength","pop","previousPage","setSplashScreenIconOffsetY","outerHeight","fadeOutSplashScreen","callback","fadeOut","cureentTime","showErrorMessage","scrollTo","behavior","dataUsageField","dataUsageBodyElement","chartElement","statisticsElement","totalDataUsageElement","maxDataUsagePerMinuteElement","minDataUsagePerMinuteElement","startTimeElement","endTimeElement","_initializeDataUsage","graphWidth","graphHeight","getDataUsageStats","_cancelNotification","removeNotificationSchedule","NotificationScheduleManagerField","NotificationScheduleManagerHeadElement","NotificationScheduleManagerUpdateTimerBoxElement","NotificationScheduleManagerUpdateTimerElement","NotificationScheduleManagerBody","NotificationScheduleList","notifcationScheduleManagerRefreshTimer_baseInterval","notifcationScheduleManagerRefreshTimer_minInterval","notifcationScheduleManagerRefreshTimer_dynamicInterval","notifcationScheduleManagerRefreshTimer_dynamic","notifcationScheduleManagerRefreshTimer_lastUpdate","notifcationScheduleManagerRefreshTimer_nextUpdate","notifcationScheduleManagerRefreshTimer_currentRequestID","notifcationScheduleManagerRefreshTimer_refreshing","notifcationScheduleManagerRefreshTimer_streaming","notifcationScheduleManagerRefreshTimer_streamStarted","hoursElement","notificationScheduleElement","minutesElement","cancelElement","updateNotificationScheduleManagerField","updateHours","updateMinutes","thisItemNotificationScheduleElement","updateMain","updateContext","updateCancel","_cancelNotificationOnNotificationScheduleManager","cancelNotificationOnNotificationScheduleManager","updateFirst","NotificationScheduleItemElements","refreshNotificationScheduleManager","_refreshNotificationScheduleManager","streamNotificationScheduleManager","_streamNotificationScheduleManager","openNotificationScheduleManager","setUpNotificationScheduleManagerFieldSkeletonScreen","cancellation","cancelNotification","SettingsOptionsField","SettingsOptionsBodyElement","SettingsOptionsOptionsElement","SettingsOptionsDescriptionElement","SettingsOptionsHeadElement","SettingsOptionsTitleElement","setting","optionElement","checkboxContainerElement","checkboxElement","checked","settingKey","settingsOptionsHandler","openSettingsOptions","description","options","initializeSettingsOptionsField","storeIndexToCategory","_getStoresSizeStatistics","totalSizeInBytes","categorizedSizesInBytes","storesLength","thisStoreSizeInBytes","itemKey","itemLength","thisCategory","thisCategoryKey","category","totalSize","categorizedSizes","thisCategorySize","previousCategories","StorageField","StorageBodyElement","StatisticsElement","statisticsItemElement","updateStorageField","statistics","categories","categoriesQuantity","statisticsItemElements2","statisticsItemElements","_refreshStorageStatistics","defaultCategoriesQuantity","categoryKey","setUpStorageFieldSkeletonScreen","getStoresSizeStatistics","default_option","resourceIntensive","powerSavingAlternative","refresh_interval","display_user_location","boolean","personal_schedule","notification","data_usage","initializeDataUsage","refreshStorageStatistics","persistent_storage","askForPersistentStorage","export","import","fileInput","file","FileReader","onload","importData","readAsText","click","open","branch","last_update_date","github","_initializeSettings","userSetting","userSettingOption","_changeSettingOption","powerSavingSetting","powerSavingSettingValueBoolean","thisSetting","thisSettingOption","thisSettingValue","button","allPromptElements","promptElement","promptIconElement","promptMessageElement","promptButtonElement","md5","anyToString","any","ax","bx","axLength","bxLength","hash_a","hash_b","equal","charAt","chars","randomNumber1","randomNumber2","range","blobURL","createObjectURL","downloadLink","download","revokeObjectURL","maxTouchPoints","_","getBusArrivalTimeDataStatsPort","busArrivalTimeData_writeAheadLog_id","busArrivalTimeData_writeAheadLog_tracking","busArrivalTimeData_trackedStops","busArrivalTimeData_writeAheadLog_group","busArrivalTimeData_writeAheadLog_currentDataLength","getBusArrivalTimeDataStatsWorkerTasks","getBusArrivalTimeDataStatsWorker","getBusArrivalTimeDataStats","_getBusArrivalTimeDataStats","mergeBusArrivalTimeDataStats","mergedArray","allFolderContent","listAllFolderContent","isInPersonalSchedule","newStats","mergedStats","mergedExtrema","newExtrema","_recoverBusArrivalTimeDataFromWriteAheadLog","newExtremum","_listBusArrivalTimeDataGroups","getBusArrivalTimesPort","getBusArrivalTimesWorkerResponses","_getBusArrivalTimes","busArrivalTimeDataGroups","listBusArrivalTimeDataGroups","_e$data2","HomeField","HomeBodyElement","HomeFoldersElement","HomeUpdateTimerElement","foldersRefreshTimer_baseInterval","foldersRefreshTimer_minInterval","foldersRefreshTimer_dynamicInterval","foldersRefreshTimer_dynamic","foldersRefreshTimer_lastUpdate","foldersRefreshTimer_nextUpdate","foldersRefreshTimer_currentRequestID","foldersRefreshTimer_refreshing","foldersRefreshTimer_streaming","foldersRefreshTimer_streamStarted","buttonElement","generateElementOfFolder","folderElement","contentElement","setUpFolderFieldSkeletonScreen","updateFoldersElement","updateType","thisIconElement","busID","updateButton","previousFolder","foldersLength","currentFolderCapacity","newFolderElement","FolderElements","thisFolderContentLength","thisFolderContentElement","FolderContentItemElements","FolderElements2","thisFolderContent","thisFolderElement","thisFolderItemElements","refreshFolders","_refreshFolders","integrateFolders","streamFolders","_streamFolders","RecentViewsField","RecentViewsContentElement","recentViewsRefreshTimer_baseInterval","recentViewsRefreshTimer_minInterval","recentViewsRefreshTimer_dynamic","recentViewsRefreshTimer_streaming","recentViewsRefreshTimer_lastUpdate","recentViewsRefreshTimer_nextUpdate","recentViewsRefreshTimer_currentRequestID","recentViewsRefreshTimer_streamStarted","generateElementOfRecentViewItem","recentViewsItemElement","titleElement","timeElement","updateRecentViewsField","updateTitle","updateTime","newRecentViewItemElement","RecentViewsItemElements","setUpRecentViewsFieldSkeletonScreen","refreshRecentViews","_refreshRecentViews","integrateRecentViews","streamRecentViews","_streamRecentViews","PersonalScheduleCreatorField","PersonalScheduleCreatorBodyElement","PersonalScheduleCreatorGroups","closePersonalScheduleCreator","busInitialized","busSecondlyInitialized","initialize","initializeSettings","checkAppVersion","passive","currentIndex","indexDifference","delta","ceil","initialSize","targetSize","tabWidth","screen","orientation","initializeFolderList","mediaQuery","selectionStart","selectionEnd","searchMaterialSymbolsInputElement","loadNotificationClient","initializeNotificationSchedules","discardExpiredNotificationSchedules","DeviceOrientationEvent","requestPermission","permissionState","webkitCompassHeading","console","log","secondlyInitialize","downloadData","discardExpiredDataUsageStats","recoverBusArrivalTimeDataFromWriteAheadLog","discardExpiredRecentViews","initializeUpdateRateDataGroups","recoverUpdateRateDataFromWriteAheadLog","closeRoute","switchRoute","closeRouteDetails","closeLocation","closeLocationDetails","createFormulatedFolder","switchSearchTypeFilter","newType","closeStorage","dataUsage","closeDataUsage","openPersonalScheduleCreator","createFormulatedPersonalSchedule","switchPersonalScheduleCreatorDay","switchPersonalScheduleEditorDay","closeSettingsOptions","closeNotificationScheduleManager","saveFormulatedRegisterNotification","qrcode","closeQRCode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","amdO","O","chunkIds","fn","priority","notFulfilled","fulfilled","every","definition","defineProperty","enumerable","chunkId","globalThis","this","Function","obj","prop","prototype","call","p","baseURI","installedChunks","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","forEach","bind","__webpack_exports__"],"ignoreList":[],"sourceRoot":""}