"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[139],{540(e,t,a){a.d(t,{F:()=>$,a:()=>U});var n=a(467),i=a(5767),s=a(9566),r=a(3459),o=a(8179),d=a(8024),c=a(4537),l=a(3030),u=a(9119),f=a(4690),p=a(8194),m=(0,o.bv)(".re"),v=(0,o.aI)(m,".xe"),h=(0,o.aI)(m,".gf"),b=(0,o.aI)(h,"._f"),g=(0,o.aI)(v,".cf .df"),y={},k=!1,w=!1,C=15e3,I=5e3,L=15e3,x=!0,A=0,E=0,_="",M=!1,T=!1,j=!1;function D(){var e=document.createElement("div");e.classList.add("fg"),e.setAttribute("type","stop");var t=document.createElement("div");t.classList.add("gg"),t.appendChild((0,c.YC)("location_on"));var a=document.createElement("div");a.classList.add("hg");var n=document.createElement("div");n.classList.add("ig");var i=document.createElement("div");i.classList.add("jg");var s=document.createElement("div");s.classList.add("mg");var r=document.createElement("div");r.classList.add("_a"),r.setAttribute("code","0"),r.setAttribute("displayed","false");var o=document.createElement("div");o.classList.add("ab"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),s.appendChild(r),s.appendChild(o);var d=document.createElement("div");d.classList.add("kg"),d.appendChild((0,c.YC)("keyboard_arrow_right"));var l=document.createElement("div");return l.classList.add("lg"),i.appendChild(s),i.appendChild(d),i.appendChild(l),e.appendChild(t),e.appendChild(a),e.appendChild(n),e.appendChild(i),e}function P(){var e=document.createElement("div");e.classList.add("ag");var t=document.createElement("div");t.classList.add("bg");var a=document.createElement("div");a.classList.add("cg"),a.appendChild((0,c.oC)());var n=document.createElement("div");n.classList.add("dg"),t.appendChild(a),t.appendChild(n);var i=document.createElement("div");return i.classList.add("eg"),e.appendChild(t),e.appendChild(i),e}function S(e){var t=e;if(M){var a=t.detail.progress-1;g.style.setProperty("--ve",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,S)}function $(){for(var e=(0,r.Js)("playing_animation"),t=Math.floor((0,p.YC)("window")[1]/50/3)+2,a=[],n=0;n<3;n++){for(var i={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:t},s=0;s<t;s++){i.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}a.push(i)}Q({folders:a,dataUpdateTime:0},!0,e)}function Q(e,t,a){function n(e,n,i){function s(e,t){e.setAttribute("type",t.type)}function r(e,t){var a=(0,o.aI)(e,".gg"),n="";switch(t.type){case"stop":case"location":n="location_on";break;case"route":n="route";break;case"bus":n="directions_bus";break;case"empty":n="lightbulb";break;default:n=""}(0,c.yD)(a,n)}function u(e,t,a){if("stop"===t.type){var n=e.getBoundingClientRect(),i=n.top,s=n.left,r=n.bottom,d=n.right,c=window.innerWidth,l=window.innerHeight,u=(0,o.aI)(e,".jg .mg"),f=(0,o.aI)(u,"._a"),p=(0,o.aI)(u,".ab");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,a&&r>0&&i<l&&d>0&&s<c?(p.addEventListener("animationend",function(){p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,p.classList.remove("kb"),f.setAttribute("displayed","false")},{once:!0}),f.setAttribute("displayed","true"),p.classList.add("kb")):(p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text)}}function p(e,t){var a="";switch(t.type){case"stop":case"route":case"location":a=t.name;break;case"bus":a=t.busID;break;case"empty":a="沒有內容";break;default:a="null"}(0,o.aI)(e,".ig").innerText=a}function m(e,t){var a="";switch(t.type){case"stop":a=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":a=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":a="地點";break;case"bus":break;case"empty":a="提示";break;default:a="null"}(0,o.aI)(e,".hg").innerText=a}function v(e,t){var a=(0,o.aI)(e,".jg .kg");switch(t.type){case"stop":a.onclick=function(){(0,f.SR)(t.route.id,t.route.pathAttributeId)};break;case"route":a.onclick=function(){(0,f.SR)(t.id,t.pathAttributeId)};break;case"location":a.onclick=function(){(0,l.so)(t.id)}}}function h(e,t){e.setAttribute("animation",(0,d.xZ)(t))}function b(e,t){e.setAttribute("skeleton-screen",(0,d.xZ)(t))}if(null==i)s(e,n),r(e,n),u(e,n,a),p(e,n),m(e,n),v(e,n),h(e,a),b(e,t);else if(n.type!==i.type)s(e,n),r(e,n),u(e,n,a),p(e,n),m(e,n),v(e,n),h(e,a),b(e,t);else{switch(n.type){case"stop":(0,d.hw)(i.route,n.route)||(m(e,n),v(e,n)),i.name!==n.name&&p(e,n),i.status.time!==n.status.time&&u(e,n,a);break;case"route":i.id!==n.id&&v(e,n),(0,d.hw)(i.endPoints,n.endPoints)||m(e,n),i.name!==n.name&&p(e,n);break;case"location":i.id!==n.id&&v(e,n),i.name!==n.name&&p(e,n);break;case"bus":default:break;case"empty":n.type!==i.type&&(m(e,n),p(e,n))}t!==w&&b(e,t),a!==k&&h(e,a)}}function i(e,n,i){function s(e,t){var a=(0,o.aI)(e,".bg");(0,o.aI)(a,".dg").innerText=t.name}function r(e,t){var a=(0,o.aI)(e,".bg"),n=(0,o.aI)(a,".cg");(0,c.yD)(n,t.icon)}function l(e,t){e.setAttribute("animation",(0,d.xZ)(t))}function u(e,t){e.setAttribute("skeleton-screen",(0,d.xZ)(t))}null==i?(s(e,n),r(e,n),l(e,a),u(e,t)):(n.name!==i.name&&s(e,n),n.icon!==i.icon&&r(e,n),a!==k&&l(e,a),t!==w&&u(e,t))}var s=e.folders,r=s.length,u=(0,o.jg)(b,".ag").length;if(r!==u){var p=u-r;if(p<0){for(var m=new DocumentFragment,v=0,h=Math.abs(p);v<h;v++){var g=P();m.appendChild(g)}b.append(m)}else for(var C=(0,o.jg)(b,".ag"),I=0,L=Math.abs(p);I<L;I++){C[u-1-I].remove()}}for(var x=(0,o.jg)(b,".ag"),A=0;A<r;A++){var E=s[A].content.length,_=x[A],M=(0,o.aI)(_,".eg"),T=(0,o.jg)(M,".fg").length;if(E!==T){var j=T-E;if(j<0)for(var S=0,$=Math.abs(j);S<$;S++){var Q=D();M.appendChild(Q)}else for(var z=(0,o.jg)(M,".fg"),J=0,Z=Math.abs(j);J<Z;J++){z[T-1-J].remove()}}}for(var R=(0,o.jg)(b,".ag"),U=0;U<r;U++){var Y=s[U],F=Y.content,B=F.length,H=R[U],W=(0,o.aI)(H,".eg");if((0,d.mQ)(y,"folders"))if(y.folders[U])i(H,Y,y.folders[U]);else i(H,Y,null);else i(H,Y,null);for(var X=(0,o.jg)(W,".fg"),q=0;q<B;q++){var G=X[q],K=F[q];if((0,d.mQ)(y,"folders"))if(y.folders[U])if(y.folders[U].content[q])n(G,K,y.folders[U].content[q]);else n(G,K,null);else n(G,K,null);else n(G,K,null)}}y=e,k=a,w=t}function z(){return J.apply(this,arguments)}function J(){return(J=(0,n.A)(function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");x=t.dynamic,C=t.baseInterval,M=!0,_=(0,d.zx)(),g.setAttribute("refreshing","true"),g.classList.remove("ff"),document.addEventListener(_,S);var a=yield(0,s.R_)(_);Q(a,!1,e);var n=0;x&&(n=yield(0,i.wz)()),A=(new Date).getTime(),E=x?Math.max(A+I,a.dataUpdateTime+C/n):A+C,L=Math.max(I,E-A),M=!1,g.setAttribute("refreshing","false"),g.style.setProperty("--we",`${L}ms`),g.classList.add("ff")})).apply(this,arguments)}function Z(){return R.apply(this,arguments)}function R(){return(R=(0,n.A)(function*(){z().then(function(){T?setTimeout(function(){Z()},Math.max(I,E-(new Date).getTime())):j=!1}).catch(function(e){T?((0,u.a)("error","資料夾網路連線中斷，將在10秒後重試。"),setTimeout(function(){Z()},1e4)):j=!1})})).apply(this,arguments)}function U(){$(),T||(T=!0,j?z():(j=!0,Z()))}},2547(){},6082(e,t,a){a.d(t,{X:()=>b,m:()=>u});var n=a(467),i=a(9734),s=a(8011),r=a(9218),o=a(4293),d=a(6788),c=a(8179),l="downloadData",u=!1,f=(0,c.bv)(".re"),p=(0,c.aI)(f,".xe"),m=(0,c.aI)(p,".bf"),v=(0,c.aI)(m,'svg#download-svg path[progress="progress"]');function h(e){var t=e,a=189*(1-(0,d._M)(l));v.style.setProperty("--te",`${a}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,h),v.addEventListener("transitionend",function(){m.setAttribute("complete","true")},{once:!0}),v.style.setProperty("--te","0px"),u=!0)}function b(){return g.apply(this,arguments)}function g(){return(g=(0,n.A)(function*(){(0,d.Mf)(l,"getLocation_0",0,!1),(0,d.Mf)(l,"getLocation_1",0,!1),(0,d.Mf)(l,"getCarInfo_0",0,!1),(0,d.Mf)(l,"getCarInfo_1",0,!1),(0,d.Mf)(l,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(l,h),yield(0,o.a)(l,!0),yield(0,s.g)(l,1),yield(0,i.j)(l,!0),yield(0,r.l)(l),(0,d.LQ)(l),(0,d.gC)(l)})).apply(this,arguments)}},6091(e,t,a){a.d(t,{Q:()=>j,u:()=>Q});var n=a(467),i=a(5767),s=a(5314),r=a(3459),o=a(8179),d=a(8024),c=a(4884),l=a(4537),u=a(3030),f=a(4690),p=a(8194),m=(0,o.bv)(".re"),v=(0,o.aI)(m,".gf"),h=(0,o.aI)(v,".hf"),b=(0,o.aI)(h,".mf"),g={},y=!1,k=!1,w=15e3,C=5e3,I=!0,L=!1,x=0,A=0,E="",_=!1;function M(){var e=document.createElement("div");e.classList.add("tf");var t=document.createElement("div");t.classList.add("vf");var a=document.createElement("div");a.classList.add("wf"),a.appendChild((0,l.oC)());var n=document.createElement("div");n.classList.add("xf");var i=document.createElement("div");i.classList.add("yf"),t.appendChild(a),t.appendChild(n),t.appendChild(i);var s=document.createElement("div");return s.classList.add("zf"),e.appendChild(t),e.appendChild(s),e}function T(e,t,a){function n(e,n,i){function s(e,t){var a=(0,o.aI)(e,".vf"),n=(0,o.aI)(a,".wf"),i="";switch(t.type){case"route":i="route";break;case"location":i="location_on";break;case"bus":i="directions_bus";break;case"empty":i="lightbulb"}(0,l.yD)(n,i)}function r(e,t){var a=(0,o.aI)(e,".vf .xf"),n="";switch(t.type){case"route":n="路線";break;case"location":n="地點";break;case"bus":n="公車";break;case"empty":n="提示"}a.innerText=n}function p(e,t){(0,o.aI)(e,".vf .yf").innerText=t.time.relative}function m(e,t){(0,o.aI)(e,".zf").innerText=t.name}function v(e,t){switch(t.type){case"route":e.onclick=function(){(0,f.SR)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,u.so)(t.hash)};break;case"bus":e.onclick=function(){(0,c.$l)(t.id)};break;case"empty":e.onclick=null}}function h(e,t){e.setAttribute("animation",(0,d.xZ)(t))}function b(e,t){e.setAttribute("skeleton-screen",(0,d.xZ)(t))}if(null==i)s(e,n),r(e,n),p(e,n),m(e,n),v(e,n),h(e,a),b(e,t);else if(n.type!==i.type)s(e,n),r(e,n),p(e,n),m(e,n),v(e,n),h(e,a),b(e,t);else{switch(n.type){case"location":(0,d.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&p(e,n),(0,d.hw)(i.hash,n.hash)||v(e,n);break;case"route":(0,d.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&p(e,n),(0,d.hw)(i.id,n.id)&&(0,d.hw)(i.pid,n.pid)||v(e,n);break;case"bus":(0,d.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&p(e,n),(0,d.hw)(i.id,n.id)||v(e,n);break;case"empty":i.time!==n.time&&p(e,n)}a!==y&&h(e,a),t!==k&&b(e,t)}}var i=e.itemQuantity,s=(0,o.jg)(b,".tf").length;if(i!==s){var r=s-i;if(r<0){for(var p=new DocumentFragment,m=0,v=Math.abs(r);m<v;m++){var h=M();p.appendChild(h)}b.append(p)}else for(var w=(0,o.jg)(b,".tf"),C=0,I=Math.abs(r);C<I;C++){w[s-1-C].remove()}}for(var L=(0,o.jg)(b,".tf"),x=0;x<i;x++){var A=L[x],E=e.items[x];if((0,d.mQ)(g,"items"))if(g.items[x])n(A,E,g.items[x]);else n(A,E,null);else n(A,E,null)}g=e,y=a,k=t}function j(){for(var e=(0,r.Js)("playing_animation"),t=Math.floor((0,p.YC)("window")[1]/70/3)+2,a=[],n=0;n<t;n++)a.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});T({items:a,itemQuantity:a.length,dataUpdateTime:0},!0,e)}function D(){return P.apply(this,arguments)}function P(){return(P=(0,n.A)(function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");I=t.dynamic,w=t.baseInterval,E=(0,d.zx)();var a=yield(0,s.$i)(E);T(a,!1,e);var n=0;I&&(n=yield(0,i.wz)()),x=(new Date).getTime(),A=I?Math.max(x+C,a.dataUpdateTime+w/n):x+w,Math.max(C,A-x)})).apply(this,arguments)}function S(){return $.apply(this,arguments)}function $(){return($=(0,n.A)(function*(){D().then(function(){L?setTimeout(function(){S()},Math.max(C,A-(new Date).getTime())):_=!1}).catch(function(e){L?setTimeout(function(){S()},1e4):_=!1})})).apply(this,arguments)}function Q(){j(),L||(L=!0,_?D():(_=!0,S()))}},6110(){},6561(){},6971(){},7336(){},8933(){},9080(){}}]);
//# sourceMappingURL=8ec7020674e8c06460be.js.map