"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[794],{540:(e,t,n)=>{n.d(t,{F:()=>C,a:()=>J});var a=n(9566),i=n(904),r=n(4537),s=n(3459),o=n(5767),u=n(3648),c=n(8024),d=n(9119);function l(e,t,n,a,i,r,s){try{var o=e[r](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){l(r,a,i,s,o,"next",e)}function o(e){l(r,a,i,s,o,"throw",e)}s(void 0)}))}}var f=(0,u.bv)(".bd"),h=(0,u.aI)(f,".eg"),p=(0,u.aI)(f,".cd"),m=(0,u.aI)(p,".ed"),g=(0,u.aI)(h,".jg .kg"),b={},y=!1,w=!0,k=15e3,x=5e3,I=15e3,M=!0,T=0,L=0,_="",A=!1,P=!1,j=!1;function $(){var e=document.createElement("div");return e.classList.add("tg"),e.setAttribute("type","stop"),e.innerHTML=`<div class="ug"></div><div class="vg"></div><div class="wg"></div><div class="xg"><div class="_g"><div class="ia" code="0"></div><div class="ja" code="0"></div></div><div class="yg">${(0,r.Z)("keyboard_arrow_right")}</div><div class="zg"></div></div>`,{element:e,id:""}}function Z(e){var t=e;if(A){var n=t.detail.progress-1;g.style.setProperty("--cg",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,Z)}function C(){for(var e=(0,s.Js)("playing_animation"),t=(0,i.gO)("window"),n=(t.width,t.height),a=Math.floor(n/50/3)+2,r=[],o=0;o<3;o++){for(var u={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:a},c=0;c<a;c++){u.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}r.push(u)}D({folders:r,dataUpdateTime:0},!0,e)}function D(e,t,n){function a(e,a,i){function s(e,t){e.setAttribute("type",t.type)}function o(e,t){var n=(0,u.aI)(e,".ug"),a="";switch(t.type){case"stop":a="location_on";break;case"route":a="route";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb";break;default:a=""}n.innerHTML=(0,r.Z)(a)}function d(e,t,n){if("stop"===t.type){var a=e.getBoundingClientRect(),i=a.top,r=a.left,s=a.bottom,o=a.right,c=window.innerWidth,d=window.innerHeight,l=(0,u.aI)(e,".xg ._g"),v=(0,u.aI)(l,".ia"),f=(0,u.aI)(l,".ja");v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,n&&s>0&&i<d&&o>0&&r<c?(f.addEventListener("animationend",(function(){f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,f.classList.remove("_a")}),{once:!0}),f.classList.add("_a")):(f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text)}}function l(e,t){var n="";switch(t.type){case"stop":case"route":n=t.name;break;case"bus":n=t.busID;break;case"empty":n="沒有內容";break;default:n="null"}(0,u.aI)(e,".wg").innerText=n}function v(e,t){var n="";switch(t.type){case"stop":n=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":n=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"bus":break;case"empty":n="提示";break;default:n="null"}(0,u.aI)(e,".vg").innerText=n}function f(e,t){var n=(0,u.aI)(e,".xg .yg"),a="";switch(t.type){case"stop":a=`bus.route.openRoute(${t.route.id}, [${t.route.pathAttributeId.join(",")}])`;break;case"route":a=`bus.route.openRoute(${t.id}, [${t.pathAttributeId.join(",")}])`}n.setAttribute("onclick",a)}function h(e,t){e.setAttribute("animation",(0,c.xZ)(t))}function p(e,t){e.setAttribute("skeleton-screen",(0,c.xZ)(t))}if(null===i)s(e,a),o(e,a),d(e,a,n),l(e,a),v(e,a),f(e,a),h(e,n),p(e,t);else if(a.type!==i.type)s(e,a),o(e,a),d(e,a,n),l(e,a),v(e,a),f(e,a),h(e,n),p(e,t);else{switch(a.type){case"stop":(0,c.hw)(i.route,a.route)||(v(e,a),f(e,a)),(0,c.hw)(i.name,a.name)||l(e,a),a.status.code===i.status.code&&(0,c.hw)(i.status.text,a.status.text)||d(e,a,n);break;case"route":(0,c.hw)(i.id,a.id)||f(e,a),(0,c.hw)(i.endPoints,a.endPoints)||v(e,a),(0,c.hw)(i.name,a.name)||l(e,a);break;case"bus":(0,c.hw)(i.currentRoute,a.currentRoute)||v(e,a),(0,c.hw)(i.busID,a.busID)||l(e,a);break;case"empty":a.type!==i.type&&(v(e,a),l(e,a))}t!==y&&p(e,t),n!==w&&h(e,n)}}function i(e,a,i){function s(e,t){var n=(0,u.aI)(e,".og");(0,u.aI)(n,".rg").innerText=t.name}function o(e,t){var n=(0,u.aI)(e,".og");(0,u.aI)(n,".pg").innerHTML=(0,r.Z)(t.icon)}function d(e,t){e.setAttribute("animation",(0,c.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,c.xZ)(t))}null===i?(s(e,a),o(e,a),d(e,n),l(e,t)):(a.name!==i.name&&s(e,a),a.icon!==i.icon&&o(e,a),n!==w&&d(e,n),t!==y&&l(e,t))}var s,o=e.folders,d=o.length,l=(0,u.jg)(m,".ng").length;if(d!==l){var v=l-d;if(v<0){for(var f=new DocumentFragment,h=0;h<Math.abs(v);h++){var p=(s=void 0,(s=document.createElement("div")).classList.add("ng"),s.innerHTML='<div class="og"><div class="pg"></div><div class="rg"></div></div><div class="sg"></div>',{element:s,id:""});f.appendChild(p.element)}m.append(f)}else for(var g=(0,u.jg)(m,".ng"),k=0;k<Math.abs(v);k++){g[l-1-k].remove()}}for(var x=(0,u.jg)(m,".ng"),I=0;I<d;I++){var M=o[I].content.length,T=x[I],L=(0,u.aI)(T,".sg"),_=(0,u.jg)(L,".tg").length;if(M!==_){var A=_-M;if(A<0)for(var P=0;P<Math.abs(A);P++){var j=$();L.appendChild(j.element)}else for(var Z=(0,u.jg)(L,".tg"),C=0;C<Math.abs(A);C++){Z[_-1-C].remove()}}}for(var D=(0,u.jg)(m,".ng"),E=0;E<d;E++){var H=o[E],R=H.content,z=R.length,J=D[E],O=(0,u.aI)(J,".sg");if(b.hasOwnProperty("folders"))if(b.folders[E])i(J,H,b.folders[E]);else i(J,H,null);else i(J,H,null);for(var S=(0,u.jg)(O,".tg"),Q=0;Q<z;Q++){var U=S[Q],B=R[Q];if(b.hasOwnProperty("folders"))if(b.folders[E])if(b.folders[E].content[Q])a(U,B,b.folders[E].content[Q]);else a(U,B,null);else a(U,B,null);else a(U,B,null)}}b=e,w=n,y=t}function E(){return H.apply(this,arguments)}function H(){return(H=v((function*(){var e=(0,s.Js)("playing_animation"),t=(0,s.Js)("refresh_interval");M=t.dynamic,k=t.baseInterval,A=!0,_=(0,c.zx)("r"),g.setAttribute("refreshing","true"),g.classList.remove("mg"),document.addEventListener(_,Z);var n=yield(0,a.R_)(_);D(n,!1,e);var i=0;M&&(i=yield(0,o.wz)()),T=(new Date).getTime(),L=M?Math.max(T+x,n.dataUpdateTime+k/i):T+k,I=Math.max(x,L-T),A=!1,g.setAttribute("refreshing","false"),g.style.setProperty("--dg",`${I}ms`),g.classList.add("mg")}))).apply(this,arguments)}function R(){return z.apply(this,arguments)}function z(){return(z=v((function*(){E().then((function(){P?setTimeout((function(){R()}),Math.max(x,L-(new Date).getTime())):j=!1})).catch((function(e){console.error(e),P?((0,d.a)("資料夾網路連線中斷，將在10秒後重試。","error"),setTimeout((function(){R()}),1e4)):j=!1}))}))).apply(this,arguments)}function J(){C(),P||(P=!0,j?E():(j=!0,R()))}},4537:(e,t,n)=>{function a(e){return`<span class="le">${e}</span>`}n.d(t,{Z:()=>a})},6082:(e,t,n)=>{n.d(t,{X:()=>g,m:()=>l});var a=n(4293),i=n(8011),r=n(6788),s=n(3648),o=n(9930),u=n(9734);function c(e,t,n,a,i,r,s){try{var o=e[r](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,i)}var d="downloadData",l=!1,v=(0,s.bv)(".bd"),f=(0,s.aI)(v,".eg"),h=(0,s.aI)(f,".hg"),p=(0,s.aI)(h,'svg#download-svg path[progress="progress"]');function m(e){var t=e,n=189*(1-(0,r._M)(d));p.style.setProperty("--ag",`${n}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,m),p.addEventListener("transitionend",(function(){h.setAttribute("complete","true")}),{once:!0}),p.style.setProperty("--ag","0px"),l=!0)}function g(){return b.apply(this,arguments)}function b(){var e;return e=function*(){(0,r.Mf)(d,"getLocation_0",0,!1),(0,r.Mf)(d,"getLocation_1",0,!1),(0,r.Mf)(d,"getCarInfo_0",0,!1),(0,r.Mf)(d,"getCarInfo_1",0,!1),(0,r.Mf)(d,"getMaterialSymbols",0,!1),document.addEventListener(d,m),yield(0,a.a)(d,!0),yield(0,i.g)(d,1),yield(0,u.j)(d,!0),yield(0,o.z)(d),(0,r.LQ)(d),(0,r.gC)(d)},b=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){c(r,a,i,s,o,"next",e)}function o(e){c(r,a,i,s,o,"throw",e)}s(void 0)}))},b.apply(this,arguments)}},6091:(e,t,n)=>{n.d(t,{Q:()=>_,u:()=>Z});var a=n(5767),i=n(5314),r=n(3459),s=n(8024),o=n(3648),u=n(4537),c=n(904);function d(e,t,n,a,i,r,s){try{var o=e[r](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){d(r,a,i,s,o,"next",e)}function o(e){d(r,a,i,s,o,"throw",e)}s(void 0)}))}}var v=(0,o.bv)(".bd"),f=(0,o.aI)(v,".cd"),h=(0,o.aI)(f,".dd"),p={},m=!0,g=!1,b=15e3,y=5e3,w=!0,k=!1,x=0,I=0,M="",T=!1;function L(e,t,n,a){function i(e,t,i){function r(e,t){var n=(0,o.aI)(e,".gh .hh"),a="";switch(t.type){case"route":a="route";break;case"location":a="location_on";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb"}n.innerHTML=(0,u.Z)(a)}function c(e,t){var n=(0,o.aI)(e,".gh .ih"),a="";switch(t.type){case"route":a="路線";break;case"location":a="地點";break;case"bus":a="公車";break;case"empty":a="提示"}n.innerText=a}function d(e,t){(0,o.aI)(e,".gh .jh").innerText=t.time.relative}function l(e,t){(0,o.aI)(e,".kh").innerText=t.name}function v(e,t){var n="";switch(t.type){case"route":n=`bus.route.openRoute(${t.id}, [${t.pid.join(",")}])`;break;case"location":n=`bus.location.openLocation('${t.hash}')`;break;case"bus":n=`bus.bus.openBus(${t.id})`;break;case"empty":n=""}e.setAttribute("onclick",n)}function f(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function h(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null===i)r(e,t),c(e,t),d(e,t),l(e,t),v(e,t),f(e,a),h(e,n);else if(t.type!==i.type)r(e,t),c(e,t),d(e,t),l(e,t),v(e,t),f(e,a),h(e,n);else{switch(t.type){case"location":(0,s.hw)(i.name,t.name)||l(e,t),i.time!==t.time&&d(e,t),(0,s.hw)(i.hash,t.hash)||v(e,t);break;case"route":(0,s.hw)(i.name,t.name)||l(e,t),i.time!==t.time&&d(e,t),(0,s.hw)(i.id,t.id)&&(0,s.hw)(i.pid,t.pid)||v(e,t);break;case"bus":(0,s.hw)(i.name,t.name)||l(e,t),i.time!==t.time&&d(e,t),(0,s.hw)(i.id,t.id)||v(e,t);break;case"empty":i.time!==t.time&&d(e,t)}a!==m&&f(e,a),n!==g&&h(e,n)}}var r,c=t.itemQuantity,d=(0,o.jg)(e,".eh .fh").length;if(c!==d){var l=d-c;if(l<0)for(var v=(0,o.aI)(e,".eh"),f=0;f<Math.abs(l);f++){var h=(r=void 0,(r=document.createElement("div")).classList.add("fh"),r.innerHTML='<div class="gh"><div class="hh"></div><div class="ih"></div><div class="jh"></div></div><div class="kh"></div>',{element:r,id:""});v.appendChild(h.element)}else for(var b=(0,o.aI)(e,".eh"),y=(0,o.jg)(b,".fh"),w=0;w<Math.abs(l);w++){y[d-1-w].remove()}}for(var k=0;k<c;k++){var x=(0,o.jg)(e,".eh .fh")[k];x.setAttribute("skeleton-screen",(0,s.xZ)(n));var I=t.items[k];if(p.hasOwnProperty("items"))if(p.items[k])i(x,I,p.items[k]);else i(x,I,null);else i(x,I,null)}p=t,m=a,g=n}function _(e){for(var t=(0,r.Js)("playing_animation"),n=(0,c.gO)("window"),a=Math.floor(n.height/70/3)+2,i=[],s=0;s<a;s++)i.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});L(e,{items:i,itemQuantity:i.length,dataUpdateTime:0},!0,t)}function A(){return P.apply(this,arguments)}function P(){return(P=l((function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");w=t.dynamic,b=t.baseInterval,M=(0,s.zx)("r");var n=yield(0,i.$i)(M);L(h,n,!1,e);var o=0;w&&(o=yield(0,a.wz)()),x=(new Date).getTime(),I=w?Math.max(x+y,n.dataUpdateTime+b/o):x+b,Math.max(y,I-x)}))).apply(this,arguments)}function j(){return $.apply(this,arguments)}function $(){return($=l((function*(){A().then((function(){k?setTimeout((function(){j()}),Math.max(y,I-(new Date).getTime())):T=!1})).catch((function(e){console.error(e),k?setTimeout((function(){j()}),1e4):T=!1}))}))).apply(this,arguments)}function Z(){_(h),k||(k=!0,T?A():(T=!0,j()))}}}]);
//# sourceMappingURL=c42fb557c60db9362598.js.map