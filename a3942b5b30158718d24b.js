"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[374],{4225(t,e,a){a.d(e,{F:()=>p});var r=a(467),i=a(3453),n=a(7183),s=a(8024),o=a(4311);function m(t){var e=[["快取","cache"],["設定","settings"],["分析","analytics"],["分析","analytics"],["分析","analytics"],["分析","analytics"],["分析","analytics"],["個人化行程","personalSchedule"],["最近檢視","recentViews"],["通知","notification"],["通知","notification"],["資料夾","folders"],["資料夾","folders"],["資料夾","folders"]][t]||["其他","others"],a=(0,i.A)(e,2);return{name:a[0],key:a[1]}}function p(){return u.apply(this,arguments)}function u(){return(u=(0,r.A)(function*(){for(var t=0,e={},a=(0,o.le)(),r=0;r<a;r++){var i=yield(0,o.Su)(r),p=0;for(var u of i){var f=yield(0,o.Ct)(r,u),l=String(f).length+u.length;t+=l,p+=l}var d=m(r),v=d.key;(0,s.mQ)(e,v)||(e[v]={category:d,size:0}),e[d.key].size+=p}var y=(0,n.tH)(t),c={};for(var h in e){var g=e[h].category,S=e[h].size;c[h]={category:g,size:(0,n.tH)(S)}}return{totalSize:y,categorizedSizes:c}})).apply(this,arguments)}},5767(t,e,a){a.d(e,{Eu:()=>h,MN:()=>_,cy:()=>S,g4:()=>M,wz:()=>L});var r=a(3453),i=a(467),n=a(8024),s=a(5428),o=a(4311),m=[],p="",u=!1,f=0,l={data:{},timestamp:0,id:""},d=[],v={};function y(t){var e=0,a=0,r=0,i=0,n=0;for(var s of t){var o=s[0],m=s[1];n+=1,e+=o,r+=m,a+=Math.pow(o,2),i+=Math.pow(m,2)}var p=e/n,u=r/n,f=a/n-Math.pow(p,2),l=i/n-Math.pow(u,2),d=Math.sqrt(f),v=Math.sqrt(l),y=0;for(var c of t){y+=(c[0]-p)*(c[1]-u)}return{estimate_time:{average:p,stdev:d},timestamp:{average:u,stdev:v},length:n,correlation:(y/=n)/(d*v)}}function c(t,e){var a=t.length+e.length,r=(t.estimate_time.average*t.length+e.estimate_time.average*e.length)/a,i=(t.timestamp.average*t.length+e.timestamp.average*e.length)/a;return{estimate_time:{average:r,stdev:(0,s.VY)(t.estimate_time.average,t.estimate_time.stdev,t.length,e.estimate_time.average,e.estimate_time.stdev,e.length)},timestamp:{average:i,stdev:(0,s.VY)(t.timestamp.average,t.timestamp.stdev,t.length,e.timestamp.average,e.timestamp.stdev,e.length)},length:a,correlation:(0,s.Hi)(t.estimate_time.average,t.timestamp.average,t.estimate_time.stdev,t.timestamp.stdev,t.length,t.correlation,e.estimate_time.average,e.timestamp.average,e.estimate_time.stdev,e.timestamp.stdev,e.length,e.correlation)}}function h(t){return g.apply(this,arguments)}function g(){return(g=(0,i.A)(function*(t){var e=(new Date).getTime(),a=!1;if(!u){u=!0,m=[],p=(0,n.zx)(),l={data:{},timestamp:e,id:p},f=0;for(var r=t.length-1,i=0;i<32;i++){var s=t[Math.floor(Math.random()*r)];m.push(s.StopID)}}for(var h of t){var g=h.StopID,S=`s_${g}`;m.indexOf(g)>-1&&((0,n.mQ)(l.data,S)||(l.data[S]=[]),l.data[S].push([parseInt(h.EstimateTime),Math.floor((e-l.timestamp)/1e3)]))}if((f+=1)>45&&(a=!0),f%5==0&&(yield(0,o.mL)(4,p,JSON.stringify(l))),a){for(var w of m){var _=`s_${w}`,A=l.data[_],M={},N=yield(0,o.Ct)(3,_);if(N){var O=JSON.parse(N);M.stats=c(O.stats,y(A)),M.timestamp=O.timestamp,M.id=w}else M.stats=y(A),M.timestamp=e,M.id=w;if(yield(0,o.mL)(3,_,JSON.stringify(M)),(0,n.mQ)(v,_)){var J=v[_];d.splice(J,1,M)}else d[_]=d.length,d.push(M);yield(0,o.iQ)(4,p)}u=!1}})).apply(this,arguments)}function S(){return w.apply(this,arguments)}function w(){return(w=(0,i.A)(function*(){var t=(new Date).getTime()-252e5,e=yield(0,o.Su)(4);for(var a of e){var r=yield(0,o.Ct)(4,a);if(r){var i=JSON.parse(r),s=i.timestamp,m=i.id;if(s>t)for(var p in i.data){var u=i.data[p],f={},l=yield(0,o.Ct)(3,p);if(l){var h=JSON.parse(l);f.stats=c(h.stats,y(u)),f.timestamp=h.timestamp,f.id=h.id}else f.stats=y(u),f.timestamp=s,f.id=parseInt(p.split("_")[1]);if(yield(0,o.mL)(3,p,JSON.stringify(f)),(0,n.mQ)(v,p)){var g=v[p];d.splice(g,1,f)}else d[p]=d.length,d.push(f)}yield(0,o.iQ)(4,m)}}})).apply(this,arguments)}function _(){return A.apply(this,arguments)}function A(){return(A=(0,i.A)(function*(){var t=(new Date).getTime()-252e5,e=yield(0,o.Su)(3),a=0;for(var r of e){var i=yield(0,o.Ct)(3,r);if(i){var n=JSON.parse(i);n.timestamp>t&&(d.push(n),v[r]=a,a+=1)}}})).apply(this,arguments)}function M(){return N.apply(this,arguments)}function N(){return(N=(0,i.A)(function*(){var t=(new Date).getTime()-252e5,e=yield(0,o.Su)(3);for(var a of e){var r=yield(0,o.Ct)(3,a),i=JSON.parse(r);(i.timestamp<=t||"number"!=typeof i.stats.correlation)&&(yield(0,o.iQ)(3,a))}})).apply(this,arguments)}var O,J={};if("undefined"!=typeof SharedWorker){var D=new SharedWorker(new URL(a.p+a.u(662),a.b));(O=D.port).start()}else{var k=new Worker(new URL(a.p+a.u(281),a.b));O=k}function L(){return x.apply(this,arguments)}function x(){return(x=(0,i.A)(function*(){var t=yield function(){var t=(new Date).getTime()-252e5,e=[];for(var a of d)a.timestamp>t&&"number"==typeof a.stats.correlation&&e.push(a);return e}(),e=(0,n.zx)();return yield new Promise(function(a,r){J[e]=a,O.onerror=function(t){r(t.message)},O.postMessage([t,e])})})).apply(this,arguments)}O.onmessage=function(t){var e=(0,r.A)(t.data,2),a=e[0],i=e[1];J[i]&&(J[i](a),delete J[i])},O.onerror=function(t){}},6483(t,e,a){a.d(e,{$t:()=>N,Io:()=>C,VZ:()=>A});var r,i=a(467),n=a(3453),s=a(8024),o=a(5428),m=a(9566),p=a(5352),u=a(4311),f="",l=!1,d=[],v={data:{},timestamp:0,id:""},y=0,c={};if("undefined"!=typeof SharedWorker){var h=new SharedWorker(new URL(a.p+a.u(992),a.b));(r=h.port).start()}else{var g=new Worker(new URL(a.p+a.u(611),a.b));r=g}function S(t){return w.apply(this,arguments)}function w(){return(w=(0,i.A)(function*(t){var e=(0,s.zx)();return yield new Promise(function(a,i){c[e]=a,r.onerror=function(t){i(t.message)},r.postMessage([t,e])})})).apply(this,arguments)}function _(t,e){for(var a=new Uint32Array(1440),r=1439;r>=0;r--)a[r]=t[r]+e[r];return Array.from(a)}function A(t){return M.apply(this,arguments)}function M(){return(M=(0,i.A)(function*(t){var e=new Date,a=e.getTime(),r=e.getDay(),i=!1;if(!l){l=!0,f=(0,s.zx)(),v={id:f,timestamp:a,data:{}},y=0;var n=yield(0,m.$j)(["stop"]);d=n.map(function(t){return t.id})}if((0,p.vQ)(e)){for(var c of t){var h=c.StopID,g=`s_${h}_${r}`;d.indexOf(h)>-1&&((0,s.mQ)(v.data,g)||(v.data[g]=[]),v.data[g].push([parseInt(c.EstimateTime),a]))}if((y+=1)>32&&(i=!0),(i||y%8==0)&&(yield(0,u.mL)(5,f,JSON.stringify(v))),i){for(var w of d){var A=`s_${w}_${r}`,M=v.data[A],N={},O=yield(0,u.Ct)(6,A);if(O){var J=JSON.parse(O),D=yield S(M),k=_(J.stats,D);N.stats=k;var L=(0,o.no)(k);N.min=L[0],N.max=L[1],N.day=r,N.timestamp=J.timestamp,N.id=w}else{var x=yield S(M);N.stats=x;var C=(0,o.no)(x);N.min=C[0],N.max=C[1],N.day=r,N.timestamp=a,N.id=w}yield(0,u.mL)(6,A,JSON.stringify(N)),yield(0,u.iQ)(5,f)}l=!1}}})).apply(this,arguments)}function N(){return O.apply(this,arguments)}function O(){return(O=(0,i.A)(function*(){var t=yield(0,u.Su)(5);for(var e of t){var a=yield(0,u.Ct)(5,e),r=JSON.parse(a),i=r.id;for(var n in r.data){var s=r.data[n],m={},p=yield(0,u.Ct)(6,n),f=n.split("_"),l=parseInt(f[1]),d=parseInt(f[2]);if(p){var v=JSON.parse(p),y=yield S(s),c=_(v.stats,y);m.stats=c;var h=(0,o.no)(c);m.min=h[0],m.max=h[1],m.day=v.day,m.timestamp=v.timestamp,m.id=l}else{var g=yield S(s);m.stats=g;var w=(0,o.no)(g);m.min=w[0],m.max=w[1],m.day=d,m.timestamp=r.timestamp,m.id=l}yield(0,u.mL)(6,n,JSON.stringify(m))}yield(0,u.iQ)(5,i)}})).apply(this,arguments)}function J(){return(J=(0,i.A)(function*(){var t=yield(0,u.Su)(6),e=[];for(var a of t){var r=yield(0,u.Ct)(6,a);r&&e.push(JSON.parse(r))}return e})).apply(this,arguments)}r.onmessage=function(t){var e=(0,n.A)(t.data,2),a=e[0],r=e[1];c[r]&&(c[r](a),delete c[r])},r.onerror=function(t){};var D,k={};if("undefined"!=typeof SharedWorker){var L=new SharedWorker(new URL(a.p+a.u(906),a.b));(D=L.port).start()}else{var x=new Worker(new URL(a.p+a.u(525),a.b));D=x}function C(t,e){return b.apply(this,arguments)}function b(){return b=(0,i.A)(function*(t,e){var a=(0,s.zx)(),r=yield(0,p.ty)(),i=yield function(){return J.apply(this,arguments)}();return yield new Promise(function(n,s){k[a]=n,D.onerror=function(t){s(t.message)},D.postMessage([r,i,t,e,a])})}),b.apply(this,arguments)}D.onmessage=function(t){var e=(0,n.A)(t.data,2),a=e[0],r=e[1];k[r]&&(k[r](a),delete k[r])},D.onerror=function(t){}},8925(t,e,a){a.d(e,{Ir:()=>p,LN:()=>f,N$:()=>s});var r=a(467),i=a(5579),n=a(4311);function s(t,e){return o.apply(this,arguments)}function o(){return(o=(0,r.A)(function*(t,e){var a=`d_${(0,i.$T)(e,"YYYY_MM_DD")}`,r=60*e.getHours()+e.getMinutes(),s=yield(0,n.Ct)(2,a);if(s){var o=JSON.parse(s);o.stats.sum+=t,o.data[r]+=t;var m=o.data[r];m>o.stats.max&&(o.stats.max=m),m<o.stats.min&&(o.stats.min=m),yield(0,n.mL)(2,a,JSON.stringify(o))}else{var p={},u=new Uint32Array(1440);u[r]+=t,p.data=Array.from(u),p.stats={sum:t,max:t,min:0},p.date=[e.getFullYear(),e.getMonth()+1,e.getDate()],yield(0,n.mL)(2,a,JSON.stringify(p))}})).apply(this,arguments)}function m(){return(m=(0,r.A)(function*(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);for(var e=(0,i.S1)(t,-7,0,0),a=[],r=1;r<=7;r++){var s=(0,i.S1)(e,r,0,0),o=`d_${(0,i.$T)(s,"YYYY_MM_DD")}`,m=yield(0,n.Ct)(2,o);if(m){var p=JSON.parse(m);a.push(p)}else{var u={},f=new Uint32Array(1440);u.data=Array.from(f),u.stats={sum:0,max:0,min:0},u.date=[s.getFullYear(),s.getMonth()+1,s.getDate()],a.push(u)}}return a})).apply(this,arguments)}function p(){return u.apply(this,arguments)}function u(){return(u=(0,r.A)(function*(){var t=(new Date).getTime(),e=yield(0,n.Su)(2);for(var a of e){var r=yield(0,n.Ct)(2,a),s=JSON.parse(r);t-(0,i.uP)(s.date[0],s.date[1],s.date[2]).getTime()>6048e5&&(yield(0,n.iQ)(2,a))}})).apply(this,arguments)}function f(t,e,a){return l.apply(this,arguments)}function l(){return l=(0,r.A)(function*(t,e,r){var i=new Worker(new URL(a.p+a.u(778),a.b)),n=yield function(){return m.apply(this,arguments)}();return yield new Promise(function(a,s){i.onmessage=function(t){a(t.data),i.terminate()},i.onerror=function(t){s(t.message),i.terminate()},i.postMessage([n,t,e,r])})}),l.apply(this,arguments)}}}]);
//# sourceMappingURL=a3942b5b30158718d24b.js.map