"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[53,7374],{5767(t,e,r){r.d(e,{Eu:()=>b,MN:()=>_,cy:()=>A,fV:()=>N,wz:()=>L});var n=r(8024),a=r(5428),i=r(4311);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,a=t}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e,r,n,a,i,o){try{var s=t[i](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,a)}function u(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function o(t){s(i,n,a,o,u,"next",t)}function u(t){s(i,n,a,o,u,"throw",t)}o(void 0)})}}function l(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=f(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function f(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var m=[],y="",d=!1,p=0,v={data:{},timestamp:0,id:""},h=[],g={};function w(t){var e,r=0,n=0,a=0,i=0,o=0,s=l(t);try{for(s.s();!(e=s.n()).done;){var u=e.value,f=u[0],c=u[1];o+=1,r+=f,a+=c,n+=Math.pow(f,2),i+=Math.pow(c,2)}}catch(t){s.e(t)}finally{s.f()}var m,y=r/o,d=a/o,p=n/o-Math.pow(y,2),v=i/o-Math.pow(d,2),h=Math.sqrt(p),g=Math.sqrt(v),w=0,S=l(t);try{for(S.s();!(m=S.n()).done;){var b=m.value;w+=(b[0]-y)*(b[1]-d)}}catch(t){S.e(t)}finally{S.f()}return{estimate_time:{average:y,stdev:h},timestamp:{average:d,stdev:g},length:o,correlation:(w/=o)/(h*g)}}function S(t,e){var r=t.length+e.length,n=(t.estimate_time.average*t.length+e.estimate_time.average*e.length)/r,i=(t.timestamp.average*t.length+e.timestamp.average*e.length)/r;return{estimate_time:{average:n,stdev:(0,a.VY)(t.estimate_time.average,t.estimate_time.stdev,t.length,e.estimate_time.average,e.estimate_time.stdev,e.length)},timestamp:{average:i,stdev:(0,a.VY)(t.timestamp.average,t.timestamp.stdev,t.length,e.timestamp.average,e.timestamp.stdev,e.length)},length:r,correlation:(0,a.Hi)(t.estimate_time.average,t.timestamp.average,t.estimate_time.stdev,t.timestamp.stdev,t.length,t.correlation,e.estimate_time.average,e.timestamp.average,e.estimate_time.stdev,e.timestamp.stdev,e.length,e.correlation)}}function b(t){return O.apply(this,arguments)}function O(){return(O=u(function*(t){var e=(new Date).getTime(),r=!1;if(!d){d=!0,m=[],y=(0,n.zx)(),v={data:{},timestamp:e,id:y},p=0;for(var a=t.length-1,o=0;o<32;o++){var s=t[Math.floor(Math.random()*a)];m.push(s.StopID)}}var u,f=l(t);try{for(f.s();!(u=f.n()).done;){var c=u.value,b=c.StopID,O=`s_${b}`;m.indexOf(b)>-1&&(v.data.hasOwnProperty(O)||(v.data[O]=[]),v.data[O].push([parseInt(c.EstimateTime),Math.floor((e-v.timestamp)/1e3)]))}}catch(t){f.e(t)}finally{f.f()}if((p+=1)>45&&(r=!0),p%5==0&&(yield(0,i.mL)(4,y,JSON.stringify(v))),r){var A,M=l(m);try{for(M.s();!(A=M.n()).done;){var _=A.value,x=`s_${_}`,N=v.data[x],I={},D=yield(0,i.Ct)(3,x);if(D){var J=JSON.parse(D);I.stats=S(J.stats,w(N)),I.timestamp=J.timestamp,I.id=_}else I.stats=w(N),I.timestamp=e,I.id=_;if(yield(0,i.mL)(3,x,JSON.stringify(I)),g.hasOwnProperty(x)){var T=g[x];h.splice(T,1,I)}else h[x]=h.length,h.push(I);yield(0,i.iQ)(4,y)}}catch(t){M.e(t)}finally{M.f()}d=!1}})).apply(this,arguments)}function A(){return M.apply(this,arguments)}function M(){return(M=u(function*(){var t,e=(new Date).getTime()-252e5,r=l(yield(0,i.Su)(4));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,i.Ct)(4,n);if(a){var o=JSON.parse(a),s=o.timestamp,u=o.id;if(s>e)for(var f in o.data){var c=o.data[f],m={},y=yield(0,i.Ct)(3,f);if(y){var d=JSON.parse(y);m.stats=S(d.stats,w(c)),m.timestamp=d.timestamp,m.id=d.id}else m.stats=w(c),m.timestamp=s,m.id=parseInt(f.split("_")[1]);if(yield(0,i.mL)(3,f,JSON.stringify(m)),g.hasOwnProperty(f)){var p=g[f];h.splice(p,1,m)}else h[f]=h.length,h.push(m)}yield(0,i.iQ)(4,u)}}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}function _(){return x.apply(this,arguments)}function x(){return(x=u(function*(){var t,e=(new Date).getTime()-252e5,r=0,n=l(yield(0,i.Su)(3));try{for(n.s();!(t=n.n()).done;){var a=t.value,o=yield(0,i.Ct)(3,a);if(o){var s=JSON.parse(o);s.timestamp>e&&(h.push(s),g[a]=r,r+=1)}}}catch(t){n.e(t)}finally{n.f()}})).apply(this,arguments)}function N(){return I.apply(this,arguments)}function I(){return(I=u(function*(){var t,e=(new Date).getTime()-252e5,r=l(yield(0,i.Su)(3));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,i.Ct)(3,n);JSON.parse(a).timestamp<=e&&(yield(0,i.iQ)(3,n))}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}var D,J={};if("undefined"!=typeof SharedWorker){var T=new SharedWorker(new URL(r.p+r.u(7551),r.b));(D=T.port).start()}else{var C=new Worker(new URL(r.p+r.u(9932),r.b));D=C}function L(){return $.apply(this,arguments)}function $(){return($=u(function*(){var t,e=yield(t=(new Date).getTime()-252e5,h.filter(function(e){return e.timestamp>t})),r=(0,n.zx)();return yield new Promise(function(t,n){J[r]=t,D.onerror=function(t){n(t.message)},D.postMessage([e,r])})})).apply(this,arguments)}D.onmessage=function(t){var e=o(t.data,2),r=e[0],n=e[1];J[n]&&(J[n](r),delete J[n])},D.onerror=function(t){}},6483(t,e,r){r.d(e,{$t:()=>I,Io:()=>P,VZ:()=>x});var n=r(8024),a=r(5428),i=r(9566),o=r(5352),s=r(4311);function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=m(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(t,e,r,n,a,i,o){try{var s=t[i](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,a)}function f(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function o(t){l(i,n,a,o,s,"next",t)}function s(t){l(i,n,a,o,s,"throw",t)}o(void 0)})}}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,a=t}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}(t,e)||m(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var d,p="",v=!1,h=[],g={data:{},timestamp:0,id:""},w=0,S={};if("undefined"!=typeof SharedWorker){var b=new SharedWorker(new URL(r.p+r.u(5778),r.b));(d=b.port).start()}else{var O=new Worker(new URL(r.p+r.u(3397),r.b));d=O}function A(t){return M.apply(this,arguments)}function M(){return(M=f(function*(t){var e=(0,n.zx)();return yield new Promise(function(r,n){S[e]=r,d.onerror=function(t){n(t.message)},d.postMessage([t,e])})})).apply(this,arguments)}function _(t,e){for(var r=new Uint32Array(1440),n=1439;n>=0;n--)r[n]=t[n]+e[n];return Array.from(r)}function x(t){return N.apply(this,arguments)}function N(){return(N=f(function*(t){var e=new Date,r=e.getTime(),l=e.getDay(),f=!1;if(!v){v=!0,p=(0,n.zx)(),g={id:p,timestamp:r,data:{}},w=0;var c=yield(0,i.$j)(["stop"]);h=c.map(function(t){return t.id})}if((0,o.vQ)(e)){var m,y=u(t);try{for(y.s();!(m=y.n()).done;){var d=m.value,S=d.StopID,b=`s_${S}_${l}`;h.indexOf(S)>-1&&(g.data.hasOwnProperty(b)||(g.data[b]=[]),g.data[b].push([parseInt(d.EstimateTime),r]))}}catch(t){y.e(t)}finally{y.f()}if((w+=1)>32&&(f=!0),(f||w%8==0)&&(yield(0,s.mL)(5,p,JSON.stringify(g))),f){var O,M=u(h);try{for(M.s();!(O=M.n()).done;){var x=O.value,N=`s_${x}_${l}`,I=g.data[N],D={},J=yield(0,s.Ct)(6,N);if(J){var T=JSON.parse(J),C=A(I),L=_(T.stats,C);D.stats=L;var $=(0,a.no)(L);D.min=$[0],D.max=$[1],D.day=l,D.timestamp=T.timestamp,D.id=x}else{var P=A(I);D.stats=P;var k=(0,a.no)(P);D.min=k[0],D.max=k[1],D.day=l,D.timestamp=r,D.id=x}yield(0,s.mL)(6,N,JSON.stringify(D)),yield(0,s.iQ)(5,p)}}catch(t){M.e(t)}finally{M.f()}v=!1}}})).apply(this,arguments)}function I(){return D.apply(this,arguments)}function D(){return(D=f(function*(){var t,e=new Date,r=e.getTime(),n=e.getDay(),i=u(yield(0,s.Su)(5));try{for(i.s();!(t=i.n()).done;){var o=t.value,l=yield(0,s.Ct)(5,o),f=JSON.parse(l),c=f.id;for(var m in f.data){var y=f.data[m],d={},p=yield(0,s.Ct)(6,m),v=parseInt(m.split("_")[1]);if(p){var h=JSON.parse(p),g=A(y),w=_(h.stats,g);d.stats=w;var S=(0,a.no)(w);d.min=S[0],d.max=S[1],d.day=h.day,d.timestamp=h.timestamp,d.id=v}else{var b=A(y);d.stats=b;var O=(0,a.no)(b);d.min=O[0],d.max=O[1],d.day=n,d.timestamp=r,d.id=v}yield(0,s.mL)(6,m,JSON.stringify(d))}yield(0,s.iQ)(5,c)}}catch(t){i.e(t)}finally{i.f()}})).apply(this,arguments)}function J(){return(J=f(function*(){var t,e=[],r=u(yield(0,s.Su)(6));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,s.Ct)(6,n);if(a){var i=JSON.parse(a);e.push(i)}}}catch(t){r.e(t)}finally{r.f()}return e})).apply(this,arguments)}d.onmessage=function(t){var e=c(t.data,2),r=e[0],n=e[1];S[n]&&(S[n](r),delete S[n])},d.onerror=function(t){};var T,C={};if("undefined"!=typeof SharedWorker){var L=new SharedWorker(new URL(r.p+r.u(592),r.b));(T=L.port).start()}else{var $=new Worker(new URL(r.p+r.u(8211),r.b));T=$}function P(t,e){return k.apply(this,arguments)}function k(){return k=f(function*(t,e){var r=(0,n.zx)(),a=yield(0,o.ty)(),i=yield function(){return J.apply(this,arguments)}();return yield new Promise(function(n,o){C[r]=n,T.onerror=function(t){o(t.message)},T.postMessage([a,i,t,e,r])})}),k.apply(this,arguments)}T.onmessage=function(t){var e=c(t.data,2),r=e[0],n=e[1];C[n]&&(C[n](r),delete C[n])},T.onerror=function(t){}},8925(t,e,r){r.d(e,{Ir:()=>m,LN:()=>d,N$:()=>l});var n=r(5579),a=r(4311);function i(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw i}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e,r,n,a,i,o){try{var s=t[i](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,a)}function u(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function o(t){s(i,n,a,o,u,"next",t)}function u(t){s(i,n,a,o,u,"throw",t)}o(void 0)})}}function l(t,e){return f.apply(this,arguments)}function f(){return(f=u(function*(t,e){var r=`d_${(0,n.$T)(e,"YYYY_MM_DD")}`,i=60*e.getHours()+e.getMinutes(),o=yield(0,a.Ct)(2,r);if(o){var s=JSON.parse(o);s.stats.sum+=t,s.data[i]+=t;var u=s.data[i];u>s.stats.max&&(s.stats.max=u),u<s.stats.min&&(s.stats.min=u),yield(0,a.mL)(2,r,JSON.stringify(s))}else{var l={},f=new Uint32Array(1440);f[i]+=t,l.data=Array.from(f),l.stats={sum:t,max:t,min:0},l.date=[e.getFullYear(),e.getMonth()+1,e.getDate()],yield(0,a.mL)(2,r,JSON.stringify(l))}})).apply(this,arguments)}function c(){return(c=u(function*(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);for(var e=(0,n.S1)(t,-7,0,0),r=[],i=1;i<=7;i++){var o=(0,n.S1)(e,i,0,0),s=`d_${(0,n.$T)(o,"YYYY_MM_DD")}`,u=yield(0,a.Ct)(2,s);if(u){var l=JSON.parse(u);r.push(l)}else{var f={},c=new Uint32Array(1440);f.data=Array.from(c),f.stats={sum:0,max:0,min:0},f.date=[o.getFullYear(),o.getMonth()+1,o.getDate()],r.push(f)}}return r})).apply(this,arguments)}function m(){return y.apply(this,arguments)}function y(){return(y=u(function*(){var t,e=(new Date).getTime(),r=i(yield(0,a.Su)(2));try{for(r.s();!(t=r.n()).done;){var o=t.value,s=yield(0,a.Ct)(2,o),u=JSON.parse(s);e-(0,n.uP)(u.date[0],u.date[1],u.date[2]).getTime()>6048e5&&(yield(0,a.iQ)(2,o))}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}function d(t,e,r){return p.apply(this,arguments)}function p(){return p=u(function*(t,e,n){var a=new Worker(new URL(r.p+r.u(7425),r.b)),i=yield function(){return c.apply(this,arguments)}();return yield new Promise(function(r,o){a.onmessage=function(t){r(t.data),a.terminate()},a.onerror=function(t){o(t.message),a.terminate()},a.postMessage([i,t,e,n])})}),p.apply(this,arguments)}}}]);
//# sourceMappingURL=c7f774556af08a6c15b7.js.map