!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("bus",[],r):"object"==typeof exports?exports.bus=r():t.bus=r()}(self,()=>(()=>{"use strict";var t={778(t,r,e){function n(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function o(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a,s,i=[],f=!0,l=!1;try{if(a=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=a.call(e)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(t){l=!0,o=t}finally{try{if(!f&&null!=e.return&&(s=e.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(t,r)||function(t,r){if(t){if("string"==typeof t)return n(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?n(t,r):void 0}}(t,r)||function(){throw new TypeError("E2")}()}function a(t,r,e){var n=e[0]-r[0],o=e[1]-r[1],a=n*n+o*o,s=((t[0]-r[0])*n+(t[1]-r[1])*o)/a;if(s<0)n=t[0]-r[0],o=t[1]-r[1];else if(s>1)n=t[0]-e[0],o=t[1]-e[1];else{var i=[r[0]+s*n,r[1]+s*o];n=t[0]-i[0],o=t[1]-i[1]}return Math.sqrt(n*n+o*o)}function s(t,r){var e=t.length-1;if(e<2)return t;for(var n=0,o=0,i=1;i<e;i++){var f=a(t[i],t[0],t[e]);f>n&&(o=i,n=f)}if(n>r){var l=t.slice(0,o+1),u=t.slice(o),c=s(l,r),v=s(u,r);return c.pop(),c.concat(v)}return[t[0],t[e]]}function i(t,r,e){var n=new Date;return n.setDate(1),n.setMonth(0),n.setFullYear(t),n.setMonth(r-1),n.setDate(e),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n}function f(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return l(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("E0")}var a,s=!0,i=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){i=!0,a=t},f:function(){try{s||null==e.return||e.return()}finally{if(i)throw a}}}}function l(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}self.onmessage=function(t){var r=function(t){var r,e=o(t,4),n=e[0],a=e[1],l=e[2],c=e[3],v=n.length,d=[],p=0,y=f(n);try{for(y.s();!(r=y.n()).done;){var h=r.value;d.push(h.stats.max,h.stats.min),p+=h.stats.sum}}catch(t){y.e(t)}finally{y.f()}for(var $=function(t){var r=t.length;if(0===r)return[0,0];for(var e=1/0,n=-1/0,o=r-1;o>=0;o--){var a=t[o];a>n&&(n=a),a<e&&(e=a)}return[e,n]}(d),m=$[1],g=$[0],x=n[0].date,b=n[v-1].date,w=i(x[0],x[1],x[2]),A=i(b[0],b[1],b[2]),j=[],k=0,M=0,S=0;S<v;S++){var O=n[S];if(0!==O.stats.sum)for(var E=O.data,D=0;D<u;D++){k+=E[D];var L=c+(S+D/u)/8*a,z=c+(1-k/p)*l;j.push([L,z]),M=L}else{var C=c+S/8*a,G=c+(S+.9993055555555556)/8*a,I=c+l;j.push([C,I]),j.push([G,I]),M=G}}var T=`<line x1="${c}" y1="${l+c}" x2="${c+a}" y2="${l+c}" stroke="var(--a)" stroke-width="1" />`,U=`<line x1="${c}" y1="${c}" x2="${c}" y2="${l+c}" stroke="var(--a)" stroke-width="1" />`,q=`<text x="${c+a/2}" y="${c+l+c}" text-anchor="middle" font-size="12" fill="var(--a)">時間</text>`,B=`<text x="${c/2}" y="${c+l/2}" text-anchor="middle" font-size="12" fill="var(--a)" transform="rotate(-90, ${.7*c}, ${c+l/2})">累計傳輸量</text>`,F=function(t){var r=t.length-1;if(r<0)return"";for(var e=[`M${t[0][0]} ${t[0][1]}`],n=1;n<r;n++){var o=t[n],a=t[n+1]||o;e.push(`Q${o[0]} ${o[1]} ${(o[0]+a[0])/2} ${(o[1]+a[1])/2}`)}var s=t[r];return e.push(`L${s[0]} ${s[1]}`),e.join(" ")}(s(j,1.1)),H={stats:{max:m,min:g,sum:p},period:{start:w,end:A},chart:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${a+2*c} ${l+2*c}"><defs><linearGradient id="grad1" x1="50%" y1="0%" x2="50%" y2="100%"><stop offset="0%" style="stop-color:rgba(var(--c), var(--d), var(--e), 0.3);" /><stop offset="73%" style="stop-color:rgba(var(--c), var(--d), var(--e), 0.09);" /><stop offset="100%" style="stop-color:rgba(var(--c), var(--d), var(--e), 0);" /></linearGradient></defs><path d="M${c},${l+c} ${F} L${M},${l+c} L${c},${l+c}" stroke="none" stroke-width="0" fill="url(#grad1)"></path><path d="${F}" fill="none" stroke="var(--b)" stroke-width="0.9" stroke-linecap="round" stroke-linejoin="round" opacity="1"></path>${T}${U}${q}${B}</svg>`};return H}(t.data);self.postMessage(r)};var u=1440}},r={};r.m=t,r.u=t=>"18477368e617cc38110c.js",r.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r.p="./",r.b=self.location+"";var e={};return t[778](0,e,r),e=e.default})());
//# sourceMappingURL=18477368e617cc38110c.js.map