"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[794],{540(e,t,a){a.d(t,{F:()=>$,a:()=>Q});var n=a(467),i=a(5767),s=a(9566),r=a(3459),o=a(8024),c=a(8179),d=a(4537),u=a(904),l=a(3030),h=a(9119),p=a(4690),m=(0,c.bv)(".bg"),f=(0,c.aI)(m,".gg"),v=(0,c.aI)(m,".pg"),g=(0,c.aI)(v,".bh"),b=(0,c.aI)(f,".lg .mg"),y={},w=!1,k=!1,I=15e3,x=5e3,C=15e3,L=!0,E=0,A=0,T="",M=!1,_=!1,j=!1;function D(){var e=document.createElement("div");e.classList.add("hh"),e.setAttribute("type","stop");var t=document.createElement("div");t.classList.add("ih"),t.appendChild((0,d.YC)("location_on"));var a=document.createElement("div");a.classList.add("jh");var n=document.createElement("div");n.classList.add("kh");var i=document.createElement("div");i.classList.add("lh");var s=document.createElement("div");s.classList.add("oh");var r=document.createElement("div");r.classList.add("qa"),r.setAttribute("code","0"),r.setAttribute("displayed","false");var o=document.createElement("div");o.classList.add("ra"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),s.appendChild(r),s.appendChild(o);var c=document.createElement("div");c.classList.add("mh"),c.appendChild((0,d.YC)("keyboard_arrow_right"));var u=document.createElement("div");return u.classList.add("nh"),i.appendChild(s),i.appendChild(c),i.appendChild(u),e.appendChild(t),e.appendChild(a),e.appendChild(n),e.appendChild(i),{element:e,id:""}}function P(){var e=document.createElement("div");e.classList.add("ch");var t=document.createElement("div");t.classList.add("dh");var a=document.createElement("div");a.classList.add("eh"),a.appendChild((0,d.oC)());var n=document.createElement("div");n.classList.add("fh"),t.appendChild(a),t.appendChild(n);var i=document.createElement("div");return i.classList.add("gh"),e.appendChild(t),e.appendChild(i),{element:e,id:""}}function S(e){var t=e;if(M){var a=t.detail.progress-1;b.style.setProperty("--eg",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,S)}function $(){for(var e=(0,r.Js)("playing_animation"),t=(0,u.gO)("window"),a=(t.width,t.height),n=Math.floor(a/50/3)+2,i=[],s=0;s<3;s++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:n},c=0;c<n;c++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}R({folders:i,dataUpdateTime:0},!0,e)}function R(e,t,a){function n(e,n,i){function s(e,t){e.setAttribute("type",t.type)}function r(e,t){var a=(0,c.aI)(e,".ih"),n="";switch(t.type){case"stop":case"location":n="location_on";break;case"route":n="route";break;case"bus":n="directions_bus";break;case"empty":n="lightbulb";break;default:n=""}(0,d.yD)(a,n)}function u(e,t,a){if("stop"===t.type){var n=e.getBoundingClientRect(),i=n.top,s=n.left,r=n.bottom,o=n.right,d=window.innerWidth,u=window.innerHeight,l=(0,c.aI)(e,".lh .oh"),h=(0,c.aI)(l,".qa"),p=(0,c.aI)(l,".ra");h.setAttribute("code",t.status.code.toString()),h.innerText=t.status.text,a&&r>0&&i<u&&o>0&&s<d?(p.addEventListener("animationend",function(){p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,p.classList.remove("hb"),h.setAttribute("displayed","false")},{once:!0}),h.setAttribute("displayed","true"),p.classList.add("hb")):(p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text)}}function h(e,t){var a="";switch(t.type){case"stop":case"route":case"location":a=t.name;break;case"bus":a=t.busID;break;case"empty":a="沒有內容";break;default:a="null"}(0,c.aI)(e,".kh").innerText=a}function m(e,t){var a="";switch(t.type){case"stop":a=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":a=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":a="地點";break;case"bus":break;case"empty":a="提示";break;default:a="null"}(0,c.aI)(e,".jh").innerText=a}function f(e,t){var a=(0,c.aI)(e,".lh .mh");switch(t.type){case"stop":a.onclick=function(){(0,p.SR)(t.route.id,t.route.pathAttributeId)};break;case"route":a.onclick=function(){(0,p.SR)(t.id,t.pathAttributeId)};break;case"location":a.onclick=function(){(0,l.so)(t.id)}}}function v(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function g(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}if(null==i)s(e,n),r(e,n),u(e,n,a),h(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else if(n.type!==i.type)s(e,n),r(e,n),u(e,n,a),h(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else{switch(n.type){case"stop":(0,o.hw)(i.route,n.route)||(m(e,n),f(e,n)),(0,o.hw)(i.name,n.name)||h(e,n),n.status.code===i.status.code&&(0,o.hw)(i.status.text,n.status.text)||u(e,n,a);break;case"route":(0,o.hw)(i.id,n.id)||f(e,n),(0,o.hw)(i.endPoints,n.endPoints)||m(e,n),(0,o.hw)(i.name,n.name)||h(e,n);break;case"location":(0,o.hw)(i.id,n.id)||f(e,n),(0,o.hw)(i.name,n.name)||h(e,n);break;case"bus":(0,o.hw)(i.currentRoute,n.currentRoute)||m(e,n),(0,o.hw)(i.busID,n.busID)||h(e,n);break;case"empty":n.type!==i.type&&(m(e,n),h(e,n))}t!==k&&g(e,t),a!==w&&v(e,a)}}function i(e,n,i){function s(e,t){var a=(0,c.aI)(e,".dh");(0,c.aI)(a,".fh").innerText=t.name}function r(e,t){var a=(0,c.aI)(e,".dh"),n=(0,c.aI)(a,".eh");(0,d.yD)(n,t.icon)}function u(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}null==i?(s(e,n),r(e,n),u(e,a),l(e,t)):(n.name!==i.name&&s(e,n),n.icon!==i.icon&&r(e,n),a!==w&&u(e,a),t!==k&&l(e,t))}var s=e.folders,r=s.length,u=(0,c.jg)(g,".ch").length;if(r!==u){var h=u-r;if(h<0){for(var m=new DocumentFragment,f=0,v=Math.abs(h);f<v;f++){var b=P();m.appendChild(b.element)}g.append(m)}else for(var I=(0,c.jg)(g,".ch"),x=0,C=Math.abs(h);x<C;x++){I[u-1-x].remove()}}for(var L=(0,c.jg)(g,".ch"),E=0;E<r;E++){var A=s[E].content.length,T=L[E],M=(0,c.aI)(T,".gh"),_=(0,c.jg)(M,".hh").length;if(A!==_){var j=_-A;if(j<0)for(var S=0,$=Math.abs(j);S<$;S++){var R=D();M.appendChild(R.element)}else for(var Z=(0,c.jg)(M,".hh"),z=0,J=Math.abs(j);z<J;z++){Z[_-1-z].remove()}}}for(var O=(0,c.jg)(g,".ch"),Q=0;Q<r;Q++){var U=s[Q],q=U.content,F=q.length,Y=O[Q],B=(0,c.aI)(Y,".gh");if(y.hasOwnProperty("folders"))if(y.folders[Q])i(Y,U,y.folders[Q]);else i(Y,U,null);else i(Y,U,null);for(var H=(0,c.jg)(B,".hh"),W=0;W<F;W++){var X=H[W],G=q[W];if(y.hasOwnProperty("folders"))if(y.folders[Q])if(y.folders[Q].content[W])n(X,G,y.folders[Q].content[W]);else n(X,G,null);else n(X,G,null);else n(X,G,null)}}y=e,w=a,k=t}function Z(){return z.apply(this,arguments)}function z(){return(z=(0,n.A)(function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");L=t.dynamic,I=t.baseInterval,M=!0,T=(0,o.zx)(),b.setAttribute("refreshing","true"),b.classList.remove("og"),document.addEventListener(T,S);var a=yield(0,s.R_)(T);R(a,!1,e);var n=0;L&&(n=yield(0,i.wz)()),E=(new Date).getTime(),A=L?Math.max(E+x,a.dataUpdateTime+I/n):E+I,C=Math.max(x,A-E),M=!1,b.setAttribute("refreshing","false"),b.style.setProperty("--fg",`${C}ms`),b.classList.add("og")})).apply(this,arguments)}function J(){return O.apply(this,arguments)}function O(){return(O=(0,n.A)(function*(){Z().then(function(){_?setTimeout(function(){J()},Math.max(x,A-(new Date).getTime())):j=!1}).catch(function(e){_?((0,h.a)("資料夾網路連線中斷，將在10秒後重試。","error"),setTimeout(function(){J()},1e4)):j=!1})})).apply(this,arguments)}function Q(){$(),_||(_=!0,j?Z():(j=!0,J()))}},4537(e,t,a){a.d(t,{YC:()=>s,Zf:()=>i,oC:()=>r,yD:()=>o});var n=a(8179);function i(e){return`<span class="kc">${e}</span>`}function s(e){var t=document.createElement("span");return t.classList.add("kc"),t.innerText=e,t}function r(){var e=document.createElement("span");return e.classList.add("kc"),e}function o(e,t){(0,n.aI)(e,"span.kc").innerText=t}},6082(e,t,a){a.d(t,{X:()=>g,m:()=>l});var n=a(467),i=a(9734),s=a(8011),r=a(9218),o=a(4293),c=a(6788),d=a(8179),u="downloadData",l=!1,h=(0,d.bv)(".bg"),p=(0,d.aI)(h,".gg"),m=(0,d.aI)(p,".jg"),f=(0,d.aI)(m,'svg#download-svg path[progress="progress"]');function v(e){var t=e,a=189*(1-(0,c._M)(u));f.style.setProperty("--cg",`${a}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,v),f.addEventListener("transitionend",function(){m.setAttribute("complete","true")},{once:!0}),f.style.setProperty("--cg","0px"),l=!0)}function g(){return b.apply(this,arguments)}function b(){return(b=(0,n.A)(function*(){(0,c.Mf)(u,"getLocation_0",0,!1),(0,c.Mf)(u,"getLocation_1",0,!1),(0,c.Mf)(u,"getCarInfo_0",0,!1),(0,c.Mf)(u,"getCarInfo_1",0,!1),(0,c.Mf)(u,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(u,v),yield(0,o.a)(u,!0),yield(0,s.g)(u,1),yield(0,i.j)(u,!0),yield(0,r.l)(u),(0,c.LQ)(u),(0,c.gC)(u)})).apply(this,arguments)}},6091(e,t,a){a.d(t,{Q:()=>j,u:()=>R});var n=a(467),i=a(5767),s=a(5314),r=a(3459),o=a(8024),c=a(8179),d=a(4927),u=a(4537),l=a(904),h=a(3030),p=a(4690),m=(0,c.bv)(".bg"),f=(0,c.aI)(m,".pg"),v=(0,c.aI)(f,".qg"),g=(0,c.aI)(v,".vg"),b={},y=!1,w=!1,k=15e3,I=5e3,x=!0,C=!1,L=0,E=0,A="",T=!1;function M(){var e=document.createElement("div");e.classList.add("wg");var t=document.createElement("div");t.classList.add("xg");var a=document.createElement("div");a.classList.add("yg"),a.appendChild((0,u.oC)());var n=document.createElement("div");n.classList.add("zg");var i=document.createElement("div");i.classList.add("_g"),t.appendChild(a),t.appendChild(n),t.appendChild(i);var s=document.createElement("div");return s.classList.add("ah"),e.appendChild(t),e.appendChild(s),{element:e,id:""}}function _(e,t,a){function n(e,n,i){function s(e,t){var a=(0,c.aI)(e,".xg"),n=(0,c.aI)(a,".yg"),i="";switch(t.type){case"route":i="route";break;case"location":i="location_on";break;case"bus":i="directions_bus";break;case"empty":i="lightbulb"}(0,u.yD)(n,i)}function r(e,t){var a=(0,c.aI)(e,".xg .zg"),n="";switch(t.type){case"route":n="路線";break;case"location":n="地點";break;case"bus":n="公車";break;case"empty":n="提示"}a.innerText=n}function l(e,t){(0,c.aI)(e,".xg ._g").innerText=t.time.relative}function m(e,t){(0,c.aI)(e,".ah").innerText=t.name}function f(e,t){switch(t.type){case"route":e.onclick=function(){(0,p.SR)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,h.so)(t.hash)};break;case"bus":e.onclick=function(){(0,d.$)(t.id)};break;case"empty":e.onclick=null}}function v(e,t){e.setAttribute("animation",(0,o.xZ)(t))}function g(e,t){e.setAttribute("skeleton-screen",(0,o.xZ)(t))}if(null==i)s(e,n),r(e,n),l(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else if(n.type!==i.type)s(e,n),r(e,n),l(e,n),m(e,n),f(e,n),v(e,a),g(e,t);else{switch(n.type){case"location":(0,o.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&l(e,n),(0,o.hw)(i.hash,n.hash)||f(e,n);break;case"route":(0,o.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&l(e,n),(0,o.hw)(i.id,n.id)&&(0,o.hw)(i.pid,n.pid)||f(e,n);break;case"bus":(0,o.hw)(i.name,n.name)||m(e,n),i.time!==n.time&&l(e,n),(0,o.hw)(i.id,n.id)||f(e,n);break;case"empty":i.time!==n.time&&l(e,n)}a!==y&&v(e,a),t!==w&&g(e,t)}}var i=e.itemQuantity,s=(0,c.jg)(g,".wg").length;if(i!==s){var r=s-i;if(r<0){for(var l=new DocumentFragment,m=0,f=Math.abs(r);m<f;m++){var v=M();l.appendChild(v.element)}g.append(l)}else for(var k=(0,c.jg)(g,".wg"),I=0,x=Math.abs(r);I<x;I++){k[s-1-I].remove()}}for(var C=(0,c.jg)(g,".wg"),L=0;L<i;L++){var E=C[L],A=e.items[L];if(b.hasOwnProperty("items"))if(b.items[L])n(E,A,b.items[L]);else n(E,A,null);else n(E,A,null)}b=e,y=a,w=t}function j(){for(var e=(0,r.Js)("playing_animation"),t=(0,l.gO)("window"),a=Math.floor(t.height/70/3)+2,n=[],i=0;i<a;i++)n.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_({items:n,itemQuantity:n.length,dataUpdateTime:0},!0,e)}function D(){return P.apply(this,arguments)}function P(){return(P=(0,n.A)(function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");x=t.dynamic,k=t.baseInterval,A=(0,o.zx)();var a=yield(0,s.$i)(A);_(a,!1,e);var n=0;x&&(n=yield(0,i.wz)()),L=(new Date).getTime(),E=x?Math.max(L+I,a.dataUpdateTime+k/n):L+k,Math.max(I,E-L)})).apply(this,arguments)}function S(){return $.apply(this,arguments)}function $(){return($=(0,n.A)(function*(){D().then(function(){C?setTimeout(function(){S()},Math.max(I,E-(new Date).getTime())):T=!1}).catch(function(e){C?setTimeout(function(){S()},1e4):T=!1})})).apply(this,arguments)}function R(){j(),C||(C=!0,T?D():(T=!0,S()))}}}]);
//# sourceMappingURL=4e5cc6590d2e32197343.js.map