!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("bus",[],e):"object"==typeof exports?exports.bus=e():r.bus=e()}(self,()=>(()=>{var r,e,t={5241(r){for(var e="0123456789bcdefghjkmnpqrstuvwxyz",t={},o=0;o<32;o++)t[e.charAt(o)]=o;var n="auto",u=-90,a=90,i=-180,d=180,f=[0,5,7,8,11,12,13,15,16,17,18],l=function(r,t,o){if(o===n){if("number"==typeof r||"number"==typeof t)throw new Error("E2");var l=r.split(".")[1].length,s=t.split(".")[1].length,c=Math.max(l,s);o=f[c]}else void 0===o&&(o=9);for(var v,p=[],h=0,b=0,g=0,y=a,x=u,O=d,m=i;p.length<o;)if(b%2==0?t>(v=(O+m)/2)?(g=1+(g<<1),m=v):(g=0+(g<<1),O=v):r>(v=(y+x)/2)?(g=1+(g<<1),x=v):(g=0+(g<<1),y=v),b++,5===++h){var _=e[g];p.push(_),h=0,g=0}return p.join("")},s=function(r,e,t){t=t||52;for(var o,n=0,f=a,l=u,s=d,c=i,v=0;n<t;)v*=2,n%2==0?e>(o=(s+c)/2)?(v+=1,c=o):s=o:r>(o=(f+l)/2)?(v+=1,l=o):f=o,n++;return v},c=function(r){for(var e,o=!0,n=a,f=u,l=d,s=i,c=0,v=0,p=r.length;v<p;v++){var h=r[v].toLowerCase();c=t[h];for(var b=4;b>=0;b--){var g=c>>b&1;o?(e=(l+s)/2,1===g?s=e:l=e):(e=(n+f)/2,1===g?f=e:n=e),o=!o}}return[f,s,n,l]},v=function(r,e){for(var t=a,o=u,n=d,f=i,l=0,s=(e=e||52)/2,c=0;c<s;c++)l=p(r,2*(s-c)-1),0===p(r,2*(s-c)-2)?t=(t+o)/2:o=(t+o)/2,0===l?n=(n+f)/2:f=(n+f)/2;return[o,f,t,n]};function p(r,e){return r/Math.pow(2,e)&1}var h=function(r){var e=c(r),t=(e[0]+e[2])/2,o=(e[1]+e[3])/2;return{latitude:t,longitude:o,error:{latitude:e[2]-t,longitude:e[3]-o}}},b=function(r,e){var t=v(r,e),o=(t[0]+t[2])/2,n=(t[1]+t[3])/2;return{latitude:o,longitude:n,error:{latitude:t[2]-o,longitude:t[3]-n}}},g=function(r,e){var t=h(r),o=t.latitude+e[0]*t.error.latitude*2,n=t.longitude+e[1]*t.error.longitude*2;return n=x(n),o=O(o),l(o,n,r.length)},y=function(r,e,t){var o=b(r,t=t||52),n=o.latitude+e[0]*o.error.latitude*2,u=o.longitude+e[1]*o.error.longitude*2;return u=x(u),n=O(n),s(n,u,t)};function x(r){return r>d?i+r%d:r<i?d+r%d:r}function O(r){return r>a?a:r<u?u:r}var m={ENCODE_AUTO:n,encode:l,encode_uint64:s,encode_int:s,decode:h,decode_int:b,decode_uint64:b,decode_bbox:c,decode_bbox_uint64:v,decode_bbox_int:v,neighbor:g,neighbor_int:y,neighbors:function(r){var e,t,o=r.length,n=h(r),u=n.latitude,a=n.longitude,i=2*n.error.latitude,d=2*n.error.longitude;function f(r,n){return e=u+r*i,t=x(t=a+n*d),e=O(e),l(e,t,o)}return[f(1,0),f(1,1),f(0,1),f(-1,1),f(-1,0),f(-1,-1),f(0,-1),f(1,-1)]},neighbors_int:function(r,e){var t,o,n=b(r,e=e||52),u=n.latitude,a=n.longitude,i=2*n.error.latitude,d=2*n.error.longitude;function f(r,n){return t=u+r*i,o=x(o=a+n*d),t=O(t),s(t,o,e)}return[f(1,0),f(1,1),f(0,1),f(-1,1),f(-1,0),f(-1,-1),f(0,-1),f(1,-1)]},bboxes:function(r,e,t,o,n){for(var u=l(r,e,n=n||9),a=l(t,o,n),i=h(u),d=2*i.error.latitude,f=2*i.error.longitude,s=c(u),v=c(a),p=Math.round((v[0]-s[0])/d),b=Math.round((v[1]-s[1])/f),y=[],x=0;x<=p;x++)for(var O=0;O<=b;O++)y.push(g(u,[x,O]));return y},bboxes_int:function(r,e,t,o,n){for(var u=s(r,e,n=n||52),a=s(t,o,n),i=b(u,n),d=2*i.error.latitude,f=2*i.error.longitude,l=v(u,n),c=v(a,n),p=Math.round((c[0]-l[0])/d),h=Math.round((c[1]-l[1])/f),g=[],x=0;x<=p;x++)for(var O=0;O<=h;O++)g.push(y(u,[x,O],n));return g}};r.exports=m},7367(r,e,t){"use strict";var o=t(5241).encode;function n(r,e,t){return o(r,e,t)}var u=t(2284);t(3503),t(4462).sha512;function a(r,e){return null!=r&&"object"===(0,u.a)(r)&&!Array.isArray(r)&&Object.prototype.hasOwnProperty.call(r,e)}function i(r){var e=Math.hypot(r),t=r.length,o=new Float32Array(t);if(e>0){for(var n=1/e,u=t;u>0;u--)o[u]=r[u]*n;return Array.from(o)}return r}self.onmessage=function(r){var e=function(r){var e={};for(var t of r){var o=`r_${t.routeId}`;a(e,o)||(e[o]=[]),e[o].push(t)}for(var u in e)e[u].sort(function(r,e){return r.seqNo-e.seqNo});var d={};for(var f of r){for(var l=`r_${f.routeId}`,s=parseFloat(f.longitude),c=parseFloat(f.latitude),v=[0,0],p=e[l],h=p.length,b=null,g=0;g<h;g++)if(p[g].Id===f.Id){var y=0;g<h-1&&(y=g+1),b=p[y]}if(b)v=i([parseFloat(b.longitude)-s,parseFloat(b.latitude)-c]);var x=`l_${f.stopLocationId}`;if(a(d,x))d[x].r.indexOf(f.routeId)<0&&d[x].r.push(f.routeId),d[x].s.indexOf(f.Id)<0&&(d[x].s.push(f.Id),d[x].v.push(v)),d[x].a.push(f.address);else{var O={};O.n=f.nameZh,O.lo=s,O.la=c,O.g=n(c,s,6),O.r=[f.routeId],O.s=[f.Id],O.v=[v],O.a=[f.address],O.id=f.stopLocationId,d[x]=O}}return d}(r.data);self.postMessage(e)}}},o={};function n(r){var e=o[r];if(void 0!==e)return e.exports;var u=o[r]={exports:{}};return t[r](u,u.exports,n),u.exports}n.m=t,n.x=()=>{var r=n.O(void 0,[0],()=>n(7367));return r=n.O(r)},n.amdO={},r=[],n.O=(e,t,o,u)=>{if(!t){var a=1/0;for(l=0;l<r.length;l++){for(var[t,o,u]=r[l],i=!0,d=0;d<t.length;d++)(!1&u||a>=u)&&Object.keys(n.O).every(r=>n.O[r](t[d]))?t.splice(d--,1):(i=!1,u<a&&(a=u));if(i){r.splice(l--,1);var f=o();void 0!==f&&(e=f)}}return e}u=u||0;for(var l=r.length;l>0&&r[l-1][2]>u;l--)r[l]=r[l-1];r[l]=[t,o,u]},n.d=(r,e)=>{for(var t in e)n.o(e,t)&&!n.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},n.f={},n.e=r=>Promise.all(Object.keys(n.f).reduce((e,t)=>(n.f[t](r,e),e),[])),n.u=r=>"8a10acec40d83ac25b73.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),n.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),n.p="./",(()=>{var r={25:1};n.f.i=(e,t)=>{r[e]||importScripts(n.p+n.u(e))};var e=self.webpackChunkbus=self.webpackChunkbus||[],t=e.push.bind(e);e.push=e=>{var[o,u,a]=e;for(var i in u)n.o(u,i)&&(n.m[i]=u[i]);for(a&&a(n);o.length;)r[o.pop()]=1;t(e)}})(),e=n.x,n.x=()=>n.e(0).then(e);var u=n.x();return u=u.default})());
//# sourceMappingURL=ce5c88f6bc3dde7ffe28.js.map