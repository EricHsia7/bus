"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[4470],{1932(t,r,e){e.d(r,{L:()=>h});var n=e(4311),o=e(3153),i=e(6788);function a(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return u(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,f=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){f=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(f)throw i}}}}function u(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function f(t,r,e,n,o,i,a){try{var u=t[i](a),f=u.value}catch(t){return void e(t)}u.done?r(f):Promise.resolve(f).then(n,o)}function s(t){return function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){f(i,n,o,a,u,"next",t)}function u(t){f(i,n,o,a,u,"throw",t)}a(void 0)})}}var l=!1,c={};function y(t){return p.apply(this,arguments)}function p(){return(p=s(function*(t){var r=new Worker(new URL(e.p+e.u(5332),e.b));return yield new Promise(function(e,n){r.onmessage=function(t){e(t.data),r.terminate()},r.onerror=function(t){n(t.message),r.terminate()},r.postMessage(t)})})).apply(this,arguments)}function v(t){return d.apply(this,arguments)}function d(){return(d=s(function*(t){var r=new Worker(new URL(e.p+e.u(8892),e.b));return yield new Promise(function(e,n){r.onmessage=function(t){e(t.data),r.terminate()},r.onerror=function(t){n(t.message),r.terminate()},r.postMessage(t)})})).apply(this,arguments)}function h(t){return m.apply(this,arguments)}function m(){return m=s(function*(t){function r(){return e.apply(this,arguments)}function e(){return e=s(function*(){var r,e="",n=a([[0,15],[1,15]].map(function(t){return{url:(0,o.y)(t[0],t[1]),e:t}}));try{for(n.s();!(r=n.n()).done;){var u=r.value;e+=(yield(0,i.Fd)(u.url,t,`getSegmentBuffers_${u.e[0]}`,"xml")),(0,i.ZL)(t,-1)}}catch(t){n.e(t)}finally{n.f()}return e}),e.apply(this,arguments)}var u="bus_segment_buffers_cache",f=yield(0,n.Ct)(0,`${u}_timestamp`);if(null===f){var p=yield r(),d=yield y(p),h=yield v(d);return yield(0,n.mL)(0,`${u}_timestamp`,(new Date).getTime()),yield(0,n.mL)(0,u,JSON.stringify(h)),l||(l=!0,c=h),h}if((new Date).getTime()-parseInt(f)>2592e6){var m=yield r(),g=yield y(m),b=yield v(g);return yield(0,n.mL)(0,`${u}_timestamp`,(new Date).getTime()),yield(0,n.mL)(0,u,JSON.stringify(b)),b}if(!l){var w=yield(0,n.Ct)(0,u);l=!0,c=JSON.parse(w)}return(0,i.Mf)(t,"getSegmentBuffers_0",0,!0),(0,i.Mf)(t,"getSegmentBuffers_1",0,!0),(0,i.ZL)(t,-1),c}),m.apply(this,arguments)}},6160(t,r,e){e.d(r,{i:()=>v});var n=e(6802),o=e(7810),i=e(9734),a=e(8011),u=e(424),f=e(2303),s=e(6788),l=e(8134);function c(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return y(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?y(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function y(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function p(t,r,e,n,o,i,a){try{var u=t[i](a),f=u.value}catch(t){return void e(t)}u.done?r(f):Promise.resolve(f).then(n,o)}function v(t,r){return d.apply(this,arguments)}function d(){var t;return t=function*(t,r){var e=`c_${t}`,y=yield(0,i.j)(r,!0),p=yield(0,n.d)(r),v=yield(0,o.J)(r),d=yield(0,u.T)(r),h=yield(0,a.g)(r,0),m={properties:[],LocationName:""},g={};if(!y.hasOwnProperty(e))return m;var b=(g=y[e]).CarNum;m.properties.push({key:"car_number",icon:"tag",value:b});var w=g.CarType,S=(0,f.Ov)(w);m.properties.push({key:"car_type",icon:"directions_bus",value:S});var A,I={},P=c(p);try{for(P.s();!(A=P.n()).done;){var O=A.value;if(O.BusID===b){I=O;break}}}catch(t){P.e(t)}finally{P.f()}var _,$=parseInt(I.RouteID),k=I.BusStatus,x=(0,f.eu)(k),T=parseInt(I.GoBack),L={},j=c(v);try{for(j.s();!(_=j.n()).done;){var C=_.value;if(C.BusID===b){L=C;break}}}catch(t){j.e(t)}finally{j.f()}var B=L.CarOnStop,E=(0,f.zi)(B);m.properties.push({key:"status",icon:"vital_signs",value:`${E} | ${x}`});var M=L.StopID,D=yield(0,l.F6)($),U={};if(!(D.length>0))return m;var N=(U=D[0]).id,q=U.pid,F=U.n,Z=U.dep,J=[U.des,Z,""][T||0];m.properties.push({key:"route",icon:"route",value:`${F} - å¾€${J}`}),m.RouteID=N,m.FullPathAttributeId=q;var R=`s_${M}`;if(!d.hasOwnProperty(R))return m;var z=h[`l_${d[R].stopLocationId}`].n;return m.properties.push({key:"location_name",icon:"location_on",value:z}),(0,s.LQ)(r),(0,s.gC)(r),m},d=function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){p(i,n,o,a,u,"next",t)}function u(t){p(i,n,o,a,u,"throw",t)}a(void 0)})},d.apply(this,arguments)}},6788(t,r,e){e.d(r,{Fd:()=>y,LQ:()=>g,Mf:()=>h,ZL:()=>S,Zt:()=>A,_M:()=>m,gC:()=>I});var n=e(4750),o=e(5579),i=e(8925);function a(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return u(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,f=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){f=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(f)throw i}}}}function u(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function s(t,r,e,n,o,i,a){try{var u=t[i](a),f=u.value}catch(t){return void e(t)}u.done?r(f):Promise.resolve(f).then(n,o)}var l={},c=new Error("FetchError");function y(t,r,e,n){return p.apply(this,arguments)}function p(){var t;return t=function*(t,r,e,o){if(l.hasOwnProperty(t)){if(l[t].processing)return yield new Promise(function(n,o){l[t].requests.push([n,o,r,e])});if(null!==l[t].result&&(new Date).getTime()<=l[t].timestamp)return h(r,e,0,!0),l[t].result}else l[t]={processing:!0,requests:[],failed:!1,timestamp:-1,result:null};var u=yield fetch(t);if(!u.ok)throw h(r,e,0,!0),new Error(`HTTP error! status: ${u.status}`);for(var f=parseInt(String(u.headers.get("content-length"))),s=u.body.getReader(),p=[],d=0;;){var m=yield s.read(),g=m.done,b=m.value;if(g)break;p.push(b);var w=(d+=b.length)/f;if(h(r,e,w,!1),l.hasOwnProperty(t)){var S,A=a(l[t].requests);try{for(A.s();!(S=A.n()).done;){var I=S.value;h(I[2],I[3],w,!1)}}catch(t){A.e(t)}finally{A.f()}}}for(var P=new Uint8Array(d),O=0,_=0,$=p;_<$.length;_++){var k=$[_];P.set(k,O),O+=k.length}var x,T=new Blob([P],{type:"application/gzip"}),L=yield T.arrayBuffer(),j=yield(0,n.h)(L);switch(o){case"json":x=/^<!doctype html>/.test(j)?yield y(t.replace("https://tcgbusfs.blob.core.windows.net/","https://erichsia7.github.io/bus-alternative-static-apis/"),r,e,o):JSON.parse(j);break;case"xml":x=j}var C=new Date;if(yield(0,i.N$)(f,C),x){if(l.hasOwnProperty(t)){for(var B=d/f,E=l[t].requests.shift();E;)E[0](x),h(E[2],E[3],B,!1),E=l[t].requests.shift();l[t].result=x,l[t].timestamp=C.getTime()+3e4,l[t].processing=!1}return v(),x}if(l.hasOwnProperty(t)){for(var M=l[t].requests.shift();M;)M[1](c),h(M[2],M[3],0,!0),M=l[t].requests.shift();l[t].failed=!0}throw v(),c},p=function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){s(i,n,o,a,u,"next",t)}function u(t){s(i,n,o,a,u,"throw",t)}a(void 0)})},p.apply(this,arguments)}function v(){var t=(new Date).getTime();for(var r in l)if(l.hasOwnProperty(r)){if(!l[r].processing&&t>l[r].timestamp){delete l[r];continue}if(l[r].failed){delete l[r];continue}}}var d={};function h(t,r,e,n){d.hasOwnProperty(t)||(d[t]={}),d[t].hasOwnProperty(r)?(n?d[t][r].expel=!0:(d[t][r].expel=!1,d[t][r].progress=e),b(t,"run")):(d[t][r]={expel:!1,progress:e,total:1},b(t,"start"))}function m(t){if(d.hasOwnProperty(t)&&"object"===f(d[t])){var r=0,e=0;for(var n in d[t])d[t][n].expel||(r+=d[t][n].total,e+=d[t][n].progress);var o=Math.min(Math.max(e/r,0),1);return o===1/0||isNaN(o)?1:o}return 1}function g(t){d.hasOwnProperty(t)&&(delete d[t],b(t,"end"))}function b(t,r){var e={target:t,stage:r,progress:m(t)},n=new CustomEvent(t,{detail:e});document.dispatchEvent(n)}var w={};function S(t,r){w.hasOwnProperty(t)||(w[t]=0);var e=0;"string"==typeof r&&(e=(0,o.Zn)(r)),e>w[t]&&(w[t]=e)}function A(t){return w.hasOwnProperty(t)?1*w[t]:0}function I(t){w.hasOwnProperty(t)&&delete w[t]}},6802(t,r,e){e.d(r,{d:()=>f});var n=e(3153),o=e(6788);function i(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return a(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,f=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){f=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(f)throw i}}}}function a(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function u(t,r,e,n,o,i,a){try{var u=t[i](a),f=u.value}catch(t){return void e(t)}u.done?r(f):Promise.resolve(f).then(n,o)}function f(t){return s.apply(this,arguments)}function s(){var t;return t=function*(t){var r,e=[],a=i([[0,0],[1,0]].map(function(t){return{url:(0,n.y)(t[0],t[1]),e:t}}));try{for(a.s();!(r=a.n()).done;){var u=r.value,f=yield(0,o.Fd)(u.url,t,`getBusData_${u.e[0]}`,"json");e=e.concat(f.BusInfo),(0,o.ZL)(t,f.EssentialInfo.UpdateTime)}}catch(t){a.e(t)}finally{a.f()}return e},s=function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){u(i,n,o,a,f,"next",t)}function f(t){u(i,n,o,a,f,"throw",t)}a(void 0)})},s.apply(this,arguments)}},7810(t,r,e){e.d(r,{J:()=>f});var n=e(3153),o=e(6788);function i(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return a(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,f=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){f=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(f)throw i}}}}function a(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function u(t,r,e,n,o,i,a){try{var u=t[i](a),f=u.value}catch(t){return void e(t)}u.done?r(f):Promise.resolve(f).then(n,o)}function f(t){return s.apply(this,arguments)}function s(){var t;return t=function*(t){var r,e=[],a=i([[0,1],[1,1]].map(function(t){return{url:(0,n.y)(t[0],t[1]),e:t}}));try{for(a.s();!(r=a.n()).done;){var u=r.value,f=yield(0,o.Fd)(u.url,t,`getBusEvent_${u.e[0]}`,"json");e=e.concat(f.BusInfo),(0,o.ZL)(t,f.EssentialInfo.UpdateTime)}}catch(t){a.e(t)}finally{a.f()}return e},s=function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){u(i,n,o,a,f,"next",t)}function f(t){u(i,n,o,a,f,"throw",t)}a(void 0)})},s.apply(this,arguments)}}}]);
//# sourceMappingURL=d7f87e713873a5162673.js.map