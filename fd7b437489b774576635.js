!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("bus",[],e):"object"==typeof exports?exports.bus=e():r.bus=e()}(self,()=>(()=>{var r,e,t={5241(r){for(var e="0123456789bcdefghjkmnpqrstuvwxyz",t={},o=0;o<32;o++)t[e.charAt(o)]=o;var n="auto",u=-90,i=90,a=-180,d=180,f=[0,5,7,8,11,12,13,15,16,17,18],l=function(r,t,o){if(o===n){if("number"==typeof r||"number"==typeof t)throw new Error("E2");var l=r.split(".")[1].length,s=t.split(".")[1].length,c=Math.max(l,s);o=f[c]}else void 0===o&&(o=9);for(var v,p=[],h=0,b=0,g=0,y=i,x=u,m=d,O=a;p.length<o;)if(b%2==0?t>(v=(m+O)/2)?(g=1+(g<<1),O=v):(g=0+(g<<1),m=v):r>(v=(y+x)/2)?(g=1+(g<<1),x=v):(g=0+(g<<1),y=v),b++,5===++h){var _=e[g];p.push(_),h=0,g=0}return p.join("")},s=function(r,e,t){t=t||52;for(var o,n=0,f=i,l=u,s=d,c=a,v=0;n<t;)v*=2,n%2==0?e>(o=(s+c)/2)?(v+=1,c=o):s=o:r>(o=(f+l)/2)?(v+=1,l=o):f=o,n++;return v},c=function(r){for(var e,o=!0,n=i,f=u,l=d,s=a,c=0,v=0,p=r.length;v<p;v++){var h=r[v].toLowerCase();c=t[h];for(var b=4;b>=0;b--){var g=c>>b&1;o?(e=(l+s)/2,1===g?s=e:l=e):(e=(n+f)/2,1===g?f=e:n=e),o=!o}}return[f,s,n,l]},v=function(r,e){for(var t=i,o=u,n=d,f=a,l=0,s=(e=e||52)/2,c=0;c<s;c++)l=p(r,2*(s-c)-1),0===p(r,2*(s-c)-2)?t=(t+o)/2:o=(t+o)/2,0===l?n=(n+f)/2:f=(n+f)/2;return[o,f,t,n]};function p(r,e){return r/Math.pow(2,e)&1}var h=function(r){var e=c(r),t=(e[0]+e[2])/2,o=(e[1]+e[3])/2;return{latitude:t,longitude:o,error:{latitude:e[2]-t,longitude:e[3]-o}}},b=function(r,e){var t=v(r,e),o=(t[0]+t[2])/2,n=(t[1]+t[3])/2;return{latitude:o,longitude:n,error:{latitude:t[2]-o,longitude:t[3]-n}}},g=function(r,e){var t=h(r),o=t.latitude+e[0]*t.error.latitude*2,n=t.longitude+e[1]*t.error.longitude*2;return n=x(n),o=m(o),l(o,n,r.length)},y=function(r,e,t){var o=b(r,t=t||52),n=o.latitude+e[0]*o.error.latitude*2,u=o.longitude+e[1]*o.error.longitude*2;return u=x(u),n=m(n),s(n,u,t)};function x(r){return r>d?a+r%d:r<a?d+r%d:r}function m(r){return r>i?i:r<u?u:r}var O={ENCODE_AUTO:n,encode:l,encode_uint64:s,encode_int:s,decode:h,decode_int:b,decode_uint64:b,decode_bbox:c,decode_bbox_uint64:v,decode_bbox_int:v,neighbor:g,neighbor_int:y,neighbors:function(r){var e,t,o=r.length,n=h(r),u=n.latitude,i=n.longitude,a=2*n.error.latitude,d=2*n.error.longitude;function f(r,n){return e=u+r*a,t=x(t=i+n*d),e=m(e),l(e,t,o)}return[f(1,0),f(1,1),f(0,1),f(-1,1),f(-1,0),f(-1,-1),f(0,-1),f(1,-1)]},neighbors_int:function(r,e){var t,o,n=b(r,e=e||52),u=n.latitude,i=n.longitude,a=2*n.error.latitude,d=2*n.error.longitude;function f(r,n){return t=u+r*a,o=x(o=i+n*d),t=m(t),s(t,o,e)}return[f(1,0),f(1,1),f(0,1),f(-1,1),f(-1,0),f(-1,-1),f(0,-1),f(1,-1)]},bboxes:function(r,e,t,o,n){for(var u=l(r,e,n=n||9),i=l(t,o,n),a=h(u),d=2*a.error.latitude,f=2*a.error.longitude,s=c(u),v=c(i),p=Math.round((v[0]-s[0])/d),b=Math.round((v[1]-s[1])/f),y=[],x=0;x<=p;x++)for(var m=0;m<=b;m++)y.push(g(u,[x,m]));return y},bboxes_int:function(r,e,t,o,n){for(var u=s(r,e,n=n||52),i=s(t,o,n),a=b(u,n),d=2*a.error.latitude,f=2*a.error.longitude,l=v(u,n),c=v(i,n),p=Math.round((c[0]-l[0])/d),h=Math.round((c[1]-l[1])/f),g=[],x=0;x<=p;x++)for(var m=0;m<=h;m++)g.push(y(u,[x,m],n));return g}};r.exports=O},7367(r,e,t){"use strict";var o=t(5241).encode;function n(r,e,t){return o(r,e,t)}var u=t(2284);t(3503),t(4462).sha512;function i(r,e){return null!=r&&"object"===(0,u.A)(r)&&!Array.isArray(r)&&Object.prototype.hasOwnProperty.call(r,e)}function a(r){var e=Math.hypot(r),t=r.length,o=new Float32Array(t);if(e>0){for(var n=1/e,u=t;u>0;u--)o[u]=r[u]*n;return Array.from(o)}return r}self.onmessage=function(r){var e=function(r){var e={};for(var t of r){var o=`r_${t.routeId}`;i(e,o)||(e[o]=[]),e[o].push(t)}for(var u in e)e[u].sort(function(r,e){return r.seqNo-e.seqNo});var d={};for(var f of r){for(var l=`r_${f.routeId}`,s=parseFloat(f.longitude),c=parseFloat(f.latitude),v=[0,0],p=e[l],h=p.length,b=null,g=0;g<h;g++)if(p[g].Id===f.Id){var y=0;g<h-1&&(y=g+1),b=p[y]}if(b)v=a([parseFloat(b.longitude)-s,parseFloat(b.latitude)-c]);var x=`l_${f.stopLocationId}`;if(i(d,x))d[x].r.indexOf(f.routeId)<0&&d[x].r.push(f.routeId),d[x].s.indexOf(f.Id)<0&&(d[x].s.push(f.Id),d[x].v.push(v)),d[x].a.push(f.address);else{var m={};m.n=f.nameZh,m.lo=s,m.la=c,m.g=n(c,s,6),m.r=[f.routeId],m.s=[f.Id],m.v=[v],m.a=[f.address],m.id=f.stopLocationId,d[x]=m}}return d}(r.data);self.postMessage(e)}}},o={};function n(r){var e=o[r];if(void 0!==e)return e.exports;var u=o[r]={exports:{}};return t[r](u,u.exports,n),u.exports}n.m=t,n.x=()=>{var r=n.O(void 0,[35],()=>n(7367));return r=n.O(r)},n.amdO={},r=[],n.O=(e,t,o,u)=>{if(!t){var i=1/0;for(l=0;l<r.length;l++){for(var[t,o,u]=r[l],a=!0,d=0;d<t.length;d++)(!1&u||i>=u)&&Object.keys(n.O).every(r=>n.O[r](t[d]))?t.splice(d--,1):(a=!1,u<i&&(i=u));if(a){r.splice(l--,1);var f=o();void 0!==f&&(e=f)}}return e}u=u||0;for(var l=r.length;l>0&&r[l-1][2]>u;l--)r[l]=r[l-1];r[l]=[t,o,u]},n.d=(r,e)=>{for(var t in e)n.o(e,t)&&!n.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},n.f={},n.e=r=>Promise.all(Object.keys(n.f).reduce((e,t)=>(n.f[t](r,e),e),[])),n.u=r=>"9997b0caa6bcd919aea4.js",n.miniCssF=r=>{},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),n.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),n.p="./",(()=>{var r={367:1};n.f.i=(e,t)=>{r[e]||importScripts(n.p+n.u(e))};var e=self.webpackChunkbus=self.webpackChunkbus||[],t=e.push.bind(e);e.push=e=>{var[o,u,i]=e;for(var a in u)n.o(u,a)&&(n.m[a]=u[a]);for(i&&i(n);o.length;)r[o.pop()]=1;t(e)}})(),e=n.x,n.x=()=>n.e(35).then(e);var u=n.x();return u=u.default})());
//# sourceMappingURL=fd7b437489b774576635.js.map