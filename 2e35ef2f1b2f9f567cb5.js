"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[794],{540:(t,e,n)=>{n.d(e,{F:()=>H,a:()=>F});var a=n(9566),i=n(904),r=n(4537),o=n(3459),s=n(5767),c=n(3648),u=n(8024),d=n(6788),l=n(9119);function f(t,e,n,a,i,r,o){try{var s=t[r](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function v(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function o(t){f(r,a,i,o,s,"next",t)}function s(t){f(r,a,i,o,s,"throw",t)}o(void 0)}))}}var h=(0,c.bv)(".uc"),m=(0,c.aI)(h,".dg"),p=(0,c.aI)(h,".vc"),g=(0,c.aI)(p,".xc"),b=(0,c.aI)(m,".jg .kg"),y={},w=!1,k=!0,x=15e3,I=5e3,M=15e3,T=!0,_=!1,A=0,j=0,L=!1,P="",Z=-1,D=-1,C=!1;function R(){var t=document.createElement("div");return t.classList.add("sg"),t.setAttribute("type","stop"),t.innerHTML='<div class="tg"></div><div class="ug"></div><div class="vg"></div><div class="wg"><div class="zg"><div class="ia" code="0"></div><div class="ja" code="0"></div></div><div class="xg">'.concat((0,r.Z)("keyboard_arrow_right"),'</div><div class="yg"></div></div>'),{element:t,id:""}}function z(){var t=(new Date).getTime();L?(D=-1+(0,d._M)(P),Z+=.1*(D-Z)):(D=-1*Math.min(1,Math.max(0,Math.abs(t-A)/M)),Z=D),b.style.setProperty("--z",Z.toString()),window.requestAnimationFrame((function(){_&&z()}))}function H(){for(var t=(0,o.Js)("playing_animation"),e=(0,i.gO)("window"),n=(e.width,e.height),a=Math.floor(n/50/3)+2,r=[],s=0;s<3;s++){for(var c={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:a},u=0;u<a;u++){c.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}r.push(c)}E({folders:r,dataUpdateTime:0},!0,t)}function E(t,e,n){function a(t,a,i){function o(t,e){t.setAttribute("type",e.type)}function s(t,e){var n=(0,c.aI)(t,".tg"),a="";switch(e.type){case"stop":a="location_on";break;case"route":a="route";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb";break;default:a=""}n.innerHTML=(0,r.Z)(a)}function d(t,e,n){if("stop"===e.type){var a=t.getBoundingClientRect(),i=a.top,r=a.left,o=a.bottom,s=a.right,u=window.innerWidth,d=window.innerHeight,l=(0,c.aI)(t,".wg .zg"),f=(0,c.aI)(l,".ia"),v=(0,c.aI)(l,".ja");f.setAttribute("code",e.status.code.toString()),f.innerText=e.status.text,n&&o>0&&i<d&&s>0&&r<u?(v.addEventListener("animationend",(function(){v.setAttribute("code",e.status.code.toString()),v.innerText=e.status.text,v.classList.remove("_a")}),{once:!0}),v.classList.add("_a")):(v.setAttribute("code",e.status.code.toString()),v.innerText=e.status.text)}}function l(t,e){var n="";switch(e.type){case"stop":case"route":n=e.name;break;case"bus":n=e.busID;break;case"empty":n="沒有內容";break;default:n="null"}(0,c.aI)(t,".vg").innerText=n}function f(t,e){var n="";switch(e.type){case"stop":n="".concat(e.route?e.route.name:""," - 往").concat(e.route?[e.route.endPoints.destination,e.route.endPoints.departure,""][e.direction?e.direction:0]:"");break;case"route":n="".concat(e.endPoints.departure," ↔ ").concat(e.endPoints.destination);break;case"bus":break;case"empty":n="提示";break;default:n="null"}(0,c.aI)(t,".ug").innerText=n}function v(t,e){var n=(0,c.aI)(t,".wg .xg"),a="";switch(e.type){case"stop":a="bus.route.openRoute(".concat(e.route.id,", [").concat(e.route.pathAttributeId.join(","),"])");break;case"route":a="bus.route.openRoute(".concat(e.id,", [").concat(e.pathAttributeId.join(","),"])")}n.setAttribute("onclick",a)}function h(t,e){t.setAttribute("animation",(0,u.xZ)(e))}function m(t,e){t.setAttribute("skeleton-screen",(0,u.xZ)(e))}if(null===i)o(t,a),s(t,a),d(t,a,n),l(t,a),f(t,a),v(t,a),h(t,n),m(t,e);else if(a.type!==i.type)o(t,a),s(t,a),d(t,a,n),l(t,a),f(t,a),v(t,a),h(t,n),m(t,e);else{switch(a.type){case"stop":(0,u.hw)(i.route,a.route)||(f(t,a),v(t,a)),(0,u.hw)(i.name,a.name)||l(t,a),a.status.code===i.status.code&&(0,u.hw)(i.status.text,a.status.text)||d(t,a,n);break;case"route":(0,u.hw)(i.id,a.id)||v(t,a),(0,u.hw)(i.endPoints,a.endPoints)||f(t,a),(0,u.hw)(i.name,a.name)||l(t,a);break;case"bus":(0,u.hw)(i.currentRoute,a.currentRoute)||f(t,a),(0,u.hw)(i.busID,a.busID)||l(t,a);break;case"empty":a.type!==i.type&&(f(t,a),l(t,a))}e!==w&&m(t,e),n!==k&&h(t,n)}}function i(t,a,i){function o(t,e){var n=(0,c.aI)(t,".ng");(0,c.aI)(n,".qg").innerText=e.name}function s(t,e){var n=(0,c.aI)(t,".ng");(0,c.aI)(n,".og").innerHTML=(0,r.Z)(e.icon)}function d(t,e){t.setAttribute("animation",(0,u.xZ)(e))}function l(t,e){t.setAttribute("skeleton-screen",(0,u.xZ)(e))}null===i?(o(t,a),s(t,a),d(t,n),l(t,e)):(a.name!==i.name&&o(t,a),a.icon!==i.icon&&s(t,a),n!==k&&d(t,n),e!==w&&l(t,e))}var o,s=t.folders,d=s.length,l=(0,c.jg)(g,".mg").length;if(d!==l){var f=l-d;if(f<0){for(var v=new DocumentFragment,h=0;h<Math.abs(f);h++){var m=(o=void 0,(o=document.createElement("div")).classList.add("mg"),o.innerHTML='<div class="ng"><div class="og"></div><div class="qg"></div></div><div class="rg"></div>',{element:o,id:""});v.appendChild(m.element)}g.append(v)}else for(var p=(0,c.jg)(g,".mg"),b=0;b<Math.abs(f);b++){p[l-1-b].remove()}}for(var x=(0,c.jg)(g,".mg"),I=0;I<d;I++){var M=s[I].content.length,T=x[I],_=(0,c.aI)(T,".rg"),A=(0,c.jg)(_,".sg").length;if(M!==A){var j=A-M;if(j<0)for(var L=0;L<Math.abs(j);L++){var P=R();_.appendChild(P.element)}else for(var Z=(0,c.jg)(_,".sg"),D=0;D<Math.abs(j);D++){Z[A-1-D].remove()}}}for(var C=(0,c.jg)(g,".mg"),z=0;z<d;z++){var H=s[z],E=H.content,J=E.length,O=C[z],S=(0,c.aI)(O,".rg");if(y.hasOwnProperty("folders"))if(y.folders[z])i(O,H,y.folders[z]);else i(O,H,null);else i(O,H,null);for(var q=(0,c.jg)(S,".sg"),F=0;F<J;F++){var Q=q[F],U=E[F];if(y.hasOwnProperty("folders"))if(y.folders[z])if(y.folders[z].content[F])a(Q,U,y.folders[z].content[F]);else a(Q,U,null);else a(Q,U,null);else a(Q,U,null)}}y=t,k=n,w=e}function J(){return O.apply(this,arguments)}function O(){return(O=v((function*(){var t=(0,o.Js)("playing_animation"),e=(0,o.Js)("refresh_interval");T=e.dynamic,x=e.baseInterval,L=!0,P=(0,u.zx)("r"),b.setAttribute("refreshing","true");var n=yield(0,a.R_)(P);E(n,!1,t);var i=0;T&&(i=yield(0,s.wz)()),A=(new Date).getTime(),j=T?Math.max(A+I,n.dataUpdateTime+x/i):A+x,M=Math.max(I,j-A),L=!1,b.setAttribute("refreshing","false")}))).apply(this,arguments)}function S(){return q.apply(this,arguments)}function q(){return(q=v((function*(){J().then((function(){_?setTimeout((function(){S()}),Math.max(I,j-(new Date).getTime())):C=!1})).catch((function(t){console.error(t),_?((0,l.a)("（資料夾）發生網路錯誤，將在".concat(10,"秒後重試。"),"error"),setTimeout((function(){S()}),1e4)):C=!1}))}))).apply(this,arguments)}function F(){H(),_||(_=!0,C?J():(C=!0,S()),Z=-1,D=-1,z())}},4537:(t,e,n)=>{function a(t){return'<span class="me">'.concat(t,"</span>")}n.d(e,{Z:()=>a})},6082:(t,e,n)=>{n.d(e,{X:()=>m,m:()=>l});var a=n(4293),i=n(8011),r=n(6788),o=n(3648),s=n(9930),c=n(9734);function u(t,e,n,a,i,r,o){try{var s=t[r](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}var d="downloadData",l=!1,f=(0,o.bv)('.gg svg#download-svg path[progress="progress"]');function v(){var t=189*(1-(0,r._M)(d));f.style.setProperty("--hg","".concat(t,"px")),window.requestAnimationFrame((function(){!1===l&&v()}))}function h(){l&&(f.style.setProperty("--hg","".concat(0,"px")),(0,o.bv)(".gg").setAttribute("complete","true"),f.removeEventListener("transitioncancel",h))}function m(){return p.apply(this,arguments)}function p(){var t;return t=function*(){(0,r.Mf)(d,"getRoute_0",0,!1),(0,r.Mf)(d,"getRoute_1",0,!1),(0,r.Mf)(d,"getLocation_0",0,!1),(0,r.Mf)(d,"getLocation_1",0,!1),(0,r.Mf)(d,"getCarInfo_0",0,!1),(0,r.Mf)(d,"getCarInfo_1",0,!1),(0,r.Mf)(d,"getMaterialSymbols",0,!1),v(),f.addEventListener("transitioncancel",h),yield(0,a.a)(d,!0),yield(0,i.g)(d,!0),yield(0,c.j)(d,!0),yield(0,s.z)(d),l=!0,h(),(0,r.LQ)(d),(0,r.gC)(d)},p=function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function o(t){u(r,a,i,o,s,"next",t)}function s(t){u(r,a,i,o,s,"throw",t)}o(void 0)}))},p.apply(this,arguments)}},6091:(t,e,n)=>{n.d(e,{Q:()=>A,u:()=>D});var a=n(5767),i=n(5314),r=n(3459),o=n(8024),s=n(3648),c=n(4537),u=n(904);function d(t,e,n,a,i,r,o){try{var s=t[r](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function o(t){d(r,a,i,o,s,"next",t)}function s(t){d(r,a,i,o,s,"throw",t)}o(void 0)}))}}var f=(0,s.bv)(".uc"),v=(0,s.aI)(f,".vc"),h=(0,s.aI)(v,".wc"),m={},p=!0,g=!1,b=15e3,y=5e3,w=!0,k=!1,x=0,I=0,M="",T=!1;function _(t,e,n,a){function i(t,e,i){function r(t,e){var n=(0,s.aI)(t,".fh .gh"),a="";switch(e.type){case"route":a="route";break;case"location":a="location_on";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb"}n.innerHTML=(0,c.Z)(a)}function u(t,e){var n=(0,s.aI)(t,".fh .hh"),a="";switch(e.type){case"route":a="路線";break;case"location":a="地點";break;case"bus":a="公車";break;case"empty":a="提示"}n.innerText=a}function d(t,e){(0,s.aI)(t,".fh .ih").innerText=e.time.relative}function l(t,e){(0,s.aI)(t,".jh").innerText=e.name}function f(t,e){var n="";switch(e.type){case"route":n="bus.route.openRoute(".concat(e.id,", [").concat(e.pid.join(","),"])");break;case"location":n="bus.location.openLocation('".concat(e.hash,"')");break;case"bus":n="bus.bus.openBus(".concat(e.id,")");break;case"empty":n=""}t.setAttribute("onclick",n)}function v(t,e){t.setAttribute("animation",(0,o.xZ)(e))}function h(t,e){t.setAttribute("skeleton-screen",(0,o.xZ)(e))}if(null===i)r(t,e),u(t,e),d(t,e),l(t,e),f(t,e),v(t,a),h(t,n);else if(e.type!==i.type)r(t,e),u(t,e),d(t,e),l(t,e),f(t,e),v(t,a),h(t,n);else{switch(e.type){case"location":(0,o.hw)(i.name,e.name)||l(t,e),i.time!==e.time&&d(t,e),(0,o.hw)(i.hash,e.hash)||f(t,e);break;case"route":(0,o.hw)(i.name,e.name)||l(t,e),i.time!==e.time&&d(t,e),(0,o.hw)(i.id,e.id)&&(0,o.hw)(i.pid,e.pid)||f(t,e);break;case"bus":(0,o.hw)(i.name,e.name)||l(t,e),i.time!==e.time&&d(t,e),(0,o.hw)(i.id,e.id)||f(t,e);break;case"empty":i.time!==e.time&&d(t,e)}a!==p&&v(t,a),n!==g&&h(t,n)}}var r,u=e.itemQuantity,d=(0,s.jg)(t,".dh .eh").length;if(u!==d){var l=d-u;if(l<0)for(var f=(0,s.aI)(t,".dh"),v=0;v<Math.abs(l);v++){var h=(r=void 0,(r=document.createElement("div")).classList.add("eh"),r.innerHTML='<div class="fh"><div class="gh"></div><div class="hh"></div><div class="ih"></div></div><div class="jh"></div>',{element:r,id:""});f.appendChild(h.element)}else for(var b=(0,s.aI)(t,".dh"),y=(0,s.jg)(b,".eh"),w=0;w<Math.abs(l);w++){y[d-1-w].remove()}}for(var k=0;k<u;k++){var x=(0,s.jg)(t,".dh .eh")[k];x.setAttribute("skeleton-screen",(0,o.xZ)(n));var I=e.items[k];if(m.hasOwnProperty("items"))if(m.items[k])i(x,I,m.items[k]);else i(x,I,null);else i(x,I,null)}m=e,p=a,g=n}function A(t){for(var e=(0,r.Js)("playing_animation"),n=(0,u.gO)("window"),a=Math.floor(n.height/70/3)+2,i=[],o=0;o<a;o++)i.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_(t,{items:i,itemQuantity:i.length,dataUpdateTime:0},!0,e)}function j(){return L.apply(this,arguments)}function L(){return(L=l((function*(){var t=(0,r.Js)("playing_animation"),e=(0,r.Js)("refresh_interval");w=e.dynamic,b=e.baseInterval,M=(0,o.zx)("r");var n=yield(0,i.$i)(M);_(h,n,!1,t);var s=0;w&&(s=yield(0,a.wz)()),x=(new Date).getTime(),I=w?Math.max(x+y,n.dataUpdateTime+b/s):x+b,Math.max(y,I-x)}))).apply(this,arguments)}function P(){return Z.apply(this,arguments)}function Z(){return(Z=l((function*(){j().then((function(){k?setTimeout((function(){P()}),Math.max(y,I-(new Date).getTime())):T=!1})).catch((function(t){console.error(t),k?setTimeout((function(){P()}),1e4):T=!1}))}))).apply(this,arguments)}function D(){A(h),k||(k=!0,T?j():(T=!0,P()))}}}]);
//# sourceMappingURL=2e35ef2f1b2f9f567cb5.js.map