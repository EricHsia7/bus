{"version":3,"file":"871849a87aa2186b322e.js","mappings":"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","sources":["webpack://bus/./src/interface/bus/properties.ts","webpack://bus/./src/interface/bus/index.ts","webpack://bus/./src/interface/folder-creator/index.ts","webpack://bus/./src/data/route/index.ts","webpack://bus/./src/interface/animation.css?62fc","webpack://bus/./src/interface/data-usage/index.ts","webpack://bus/./src/interface/folder-icon-selector/index.ts","webpack://bus/./src/interface/animation.css?056c","webpack://bus/./src/index.ts","webpack://bus/./src/interface/folder-manager/index.ts","webpack://bus/./src/data/route/details.ts","webpack://bus/./src/interface/folder-editor/index.ts"],"sourcesContent":["import { getSettingOptionValue } from '../../data/settings/index';\nimport { compareThings } from '../../tools/index';\nimport { elementQuerySelector, elementQuerySelectorAll } from '../../tools/query-selector';\nimport { getIconHTML } from '../icons/index';\nimport { GeneratedElement } from '../index';\n\nlet previousProperties = [];\nlet previousSkeletonScreen: boolean = false;\nlet previousAnimation: boolean = true;\n\nfunction generateElementOfBusProperty(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_bus_property');\n  element.innerHTML = /*html*/ `<div class=\"css_bus_property_icon\"></div><div class=\"css_bus_property_value\"></div>`;\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nexport function setUpBusPropertiesFieldSkeletonScreen(Field: HTMLElement) {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultPropertyQuantity = 5;\n  let properties = [];\n  for (let i = 0; i < defaultPropertyQuantity; i++) {\n    properties.push({\n      key: i,\n      icon: 'none',\n      value: ''\n    });\n  }\n  updateBusPropertiesField(Field, properties, true, playing_animation);\n}\n\nexport function updateBusPropertiesField(Field: HTMLElement, properties: Array, skeletonScreen: boolean, animation: boolean): void {\n  function updateProperty(thisElement: HTMLElement, thisProperty: object, previousProperty: object): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: object): void {\n      elementQuerySelector(thisElement, '.css_bus_property_icon').innerHTML = getIconHTML(thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: object): void {\n      elementQuerySelector(thisElement, '.css_bus_property_value').innerText = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', animation);\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', skeletonScreen);\n    }\n\n    if (previousProperty === null) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n      updateAnimation(thisElement, animation);\n    } else {\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty, thisProperty)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (!(skeletonScreen === previousSkeletonScreen)) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n      if (!(animation === previousAnimation)) {\n        updateAnimation(thisElement, animation);\n      }\n    }\n  }\n\n  const propertyQuantity = properties.length;\n\n  // Field.setAttribute('skeleton-screen', skeletonScreen);\n\n  const currentPropertySeatQuantity = elementQuerySelectorAll(Field, `.css_bus_group_body .css_bus_property`).length;\n  if (!(propertyQuantity === currentPropertySeatQuantity)) {\n    const capacity = currentPropertySeatQuantity - propertyQuantity;\n    if (capacity < 0) {\n      for (let o = 0; o < Math.abs(capacity); o++) {\n        // const propertyIndex = currentPropertySeatQuantity + o;\n        const newPropertyElement = generateElementOfBusProperty(skeletonScreen);\n        elementQuerySelector(Field, '.css_bus_group_body').appendChild(newPropertyElement.element);\n      }\n    } else {\n      for (let o = 0; o < Math.abs(capacity); o++) {\n        const propertyIndex = currentPropertySeatQuantity - 1 - o;\n        elementQuerySelectorAll(Field, `.css_bus_group_body .css_bus_property`)[propertyIndex].remove();\n      }\n    }\n  }\n\n  const propertyElements = elementQuerySelectorAll(Field, `.css_bus_group_body .css_bus_property`);\n  for (let i = 0; i < propertyQuantity; i++) {\n    const thisPropertyElement = propertyElements[i];\n    const thisProperty = properties[i];\n    if (previousProperties.length === 0) {\n      updateProperty(thisPropertyElement, thisProperty, null);\n    } else {\n      updateProperty(thisPropertyElement, thisProperty, previousProperties[i]);\n    }\n  }\n\n  previousProperties = properties;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n","import { integrateBus } from '../../data/bus/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { getSettingOptionValue } from '../../data/settings/index';\nimport { generateIdentifier } from '../../tools/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/query-selector';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\nimport { setUpBusPropertiesFieldSkeletonScreen, updateBusPropertiesField } from './properties';\n\nconst BusField = documentQuerySelector('.css_bus_field');\nconst BusHead = elementQuerySelector(BusField, '.css_bus_head');\nconst BusBody = elementQuerySelector(BusField, '.css_bus_body');\nconst BusGroups = elementQuerySelector(BusBody, '.css_bus_groups');\nconst BusGroupProperties = elementQuerySelector(BusGroups, '.css_bus_group[group=\"properties\"]');\nconst BusGroupLocation = elementQuerySelector(BusGroups, '.css_bus_group[group=\"location\"]');\n\nexport function openBus(id: number): void {\n  pushPageHistory('Bus');\n  logRecentView('bus', id);\n  BusField.setAttribute('displayed', 'true');\n  initializeBusPage(id);\n  closePreviousPage();\n}\n\nexport function closeBus(): void {\n  // revokePageHistory('Bus');\n  BusField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nasync function initializeBusPage(id: number) {\n  setUpBusPropertiesFieldSkeletonScreen(BusGroupProperties);\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const requestID = generateIdentifier('r');\n  const integration = await integrateBus(id, requestID);\n  updateBusPropertiesField(BusGroupProperties, integration.properties, false, playing_animation);\n}\n\nfunction updateBusField(Field: HTMLElement, integration: object, skeletonScreen: boolean): void {\n  function updateProperty(thisElement: HTMLElement, thisItem: object): void {}\n  function updateLocation(thisElement: HTMLElement, thisItem: object): void {}\n}\n","import { createFolder } from '../../data/folder/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/query-selector';\nimport { closePreviousPage, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst FolderCreatorField = documentQuerySelector('.css_folder_creator_field');\nconst FolderCreatorBodyElement = elementQuerySelector(FolderCreatorField, '.css_folder_creator_body');\nconst FolderCreatorGroupsElement = elementQuerySelector(FolderCreatorBodyElement, '.css_folder_creator_groups');\nconst NameInputElement = elementQuerySelector(FolderCreatorGroupsElement, '.css_folder_creator_group[group=\"folder-name\"] .css_folder_creator_group_body input');\nconst IconInputElement = elementQuerySelector(FolderCreatorGroupsElement, '.css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input input');\n\nexport function createFormulatedFolder(): void {\n  const name = NameInputElement.value;\n  const icon = IconInputElement.value;\n  createFolder(name, icon).then((e) => {\n    if (e) {\n      closeFolderCreator();\n      promptMessage('已建立資料夾', 'folder');\n    } else {\n      promptMessage('無法建立資料夾', 'error');\n    }\n  });\n}\n\nexport function openFolderCreator(): void {\n  pushPageHistory('FolderCreator');\n  FolderCreatorField.setAttribute('displayed', 'true');\n  closePreviousPage();\n}\n\nexport function closeFolderCreator(): void {\n  // revokePageHistory('FolderCreator');\n  FolderCreatorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n","import { convertPositionsToDistance } from '../../tools/convert';\nimport { BusArrivalTime, getBusArrivalTimes } from '../analytics/bus-arrival-time/index';\nimport { getBusData } from '../apis/getBusData/index';\nimport { getBusEvent } from '../apis/getBusEvent/index';\nimport { getEstimateTime } from '../apis/getEstimateTime/index';\nimport { getLocation, IndexedLocation, IndexedLocationItem, MergedLocation, SimplifiedLocation, SimplifiedLocationItem } from '../apis/getLocation/index';\nimport { getRoute, SimplifiedRoute, SimplifiedRouteItem } from '../apis/getRoute/index';\nimport { getSegmentBuffers, SimplifiedSegmentBufferItem } from '../apis/getSegmentBuffers/index';\nimport { getStop, SimplifiedStopItem } from '../apis/getStop/index';\nimport { batchFindBusesForRoute, EstimateTimeStatus, formatBus, FormattedBus, parseEstimateTime } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime, getDataUpdateTime, setDataReceivingProgress } from '../apis/loader';\nimport { getSettingOptionValue } from '../settings/index';\nimport { getNearestPosition } from '../user-position/index';\n\ninterface formattedOverlappingRoute {\n  name: string;\n  RouteEndPoints: {\n    RouteDeparture: string;\n    RouteDestination: string;\n    text: string;\n    html: string;\n  };\n  RouteID: number;\n  PathAttributeId: Array<number>;\n}\n\nexport interface integratedStopItemPosition {\n  longitude: number;\n  latitude: number;\n}\n\nexport interface integratedStopItemSegmentBuffer {\n  isSegmentBuffer: boolean;\n  isStartingPoint: boolean;\n  isEndingPoint: boolean;\n}\n\nexport interface integratedStopItemNearbyLocationItem {\n  name: string;\n  distance: number;\n  hash: string;\n}\n\nexport interface integratedStopItem {\n  name: string;\n  goBack: '0' | '1' | '2';\n  status: EstimateTimeStatus;\n  buses: Array<FormattedBus>;\n  overlappingRoutes: Array<formattedOverlappingRoute>;\n  busArrivalTimes: Array<BusArrivalTime>;\n  nearbyLocations: Array<integratedStopItemNearbyLocationItem>;\n  sequence: number;\n  position: integratedStopItemPosition;\n  nearest: boolean;\n  segmentBuffer: integratedStopItemSegmentBuffer;\n  progress: number;\n  id: number;\n}\n\nexport interface IntegratedRoute {\n  groupedItems: { [key: string]: Array<integratedStopItem> };\n  groupQuantity: number;\n  itemQuantity: { [key: string]: number };\n  RouteName: string;\n  RouteEndPoints: {\n    RouteDeparture: string;\n    RouteDestination: string;\n  };\n  dataUpdateTime: number;\n  RouteID: number;\n  PathAttributeId: Array<number>;\n}\n\nexport async function integrateRoute(RouteID: number, PathAttributeId: Array<number>, chartWidth: number, chartHeight: number, requestID: string): Promise<IntegratedRoute> {\n  setDataReceivingProgress(requestID, 'getRoute_0', 0, false);\n  setDataReceivingProgress(requestID, 'getRoute_1', 0, false);\n  setDataReceivingProgress(requestID, 'getStop_0', 0, false);\n  setDataReceivingProgress(requestID, 'getStop_1', 0, false);\n  setDataReceivingProgress(requestID, 'getLocation_0', 0, false);\n  setDataReceivingProgress(requestID, 'getLocation_1', 0, false);\n  setDataReceivingProgress(requestID, 'getSegmentBuffers_0', 0, false);\n  setDataReceivingProgress(requestID, 'getSegmentBuffers_1', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_0', 0, false);\n  setDataReceivingProgress(requestID, 'getEstimateTime_1', 0, false);\n  setDataReceivingProgress(requestID, 'getBusEvent_0', 0, false);\n  setDataReceivingProgress(requestID, 'getBusEvent_1', 0, false);\n  setDataReceivingProgress(requestID, 'getBusData_0', 0, false);\n  setDataReceivingProgress(requestID, 'getBusData_1', 0, false);\n  const Route = (await getRoute(requestID, true)) as SimplifiedRoute;\n  const Stop = await getStop(requestID);\n  const SimplifiedLocation = (await getLocation(requestID, 0)) as SimplifiedLocation;\n  const MergedLocation = (await getLocation(requestID, 1)) as MergedLocation;\n  const IndexedLocation = (await getLocation(requestID, 2)) as IndexedLocation;\n  const SegmentBuffers = await getSegmentBuffers(requestID);\n  const EstimateTime = await getEstimateTime(requestID);\n  const BusEvent = await getBusEvent(requestID);\n  const BusData = await getBusData(requestID);\n  const BusArrivalTimes = await getBusArrivalTimes(chartWidth, chartHeight);\n\n  const batchFoundBuses = batchFindBusesForRoute(BusEvent, BusData, Route, RouteID, PathAttributeId);\n\n  let hasSegmentBuffers: boolean = false;\n  let thisSegmentBuffers: SimplifiedSegmentBufferItem = {};\n  if (SegmentBuffers.hasOwnProperty(`r_${RouteID}`)) {\n    hasSegmentBuffers = true;\n    thisSegmentBuffers = SegmentBuffers[`r_${RouteID}`];\n  }\n\n  const time_formatting_mode = getSettingOptionValue('time_formatting_mode') as number;\n\n  let result = [];\n  let positions = [];\n\n  for (const item of EstimateTime) {\n    let integratedStopItem = {} as integratedStopItem;\n\n    const thisRouteID = item.RouteID;\n\n    // Check whether this stop is on this route or not\n    if ([RouteID, RouteID * 10].includes(thisRouteID) || PathAttributeId.includes(thisRouteID)) {\n      // Parse estimate time\n      integratedStopItem.status = parseEstimateTime(item?.EstimateTime, time_formatting_mode);\n\n      // Collect data from 'Stop'\n      const thisStopKey = `s_${item.StopID}`;\n      let thisStop = {} as SimplifiedStopItem;\n      if (Stop.hasOwnProperty(thisStopKey)) {\n        thisStop = Stop[thisStopKey];\n      } else {\n        continue;\n      }\n      integratedStopItem.id = item.StopID;\n      integratedStopItem.sequence = thisStop.seqNo;\n      integratedStopItem.goBack = thisStop.goBack;\n\n      // Collect data from 'SimplifiedLocation'\n      const thisLocationKey = `l_${thisStop.stopLocationId}`;\n      let thisSimplifiedLocation = {} as SimplifiedLocationItem;\n      if (SimplifiedLocation.hasOwnProperty(thisLocationKey)) {\n        thisSimplifiedLocation = SimplifiedLocation[thisLocationKey];\n      } else {\n        continue;\n      }\n      integratedStopItem.name = thisSimplifiedLocation.n;\n      integratedStopItem.overlappingRoutes = thisSimplifiedLocation.r\n        .filter((id: number) => id !== RouteID)\n        .map((id: number) => {\n          const overlappingRouteKey = `r_${id}`;\n          if (Route.hasOwnProperty(overlappingRouteKey)) {\n            const overlappingRoute = Route[overlappingRouteKey] as SimplifiedRouteItem;\n            const formattedOverlappingRoute = {\n              name: overlappingRoute.n,\n              RouteEndPoints: {\n                RouteDeparture: overlappingRoute.dep,\n                RouteDestination: overlappingRoute.des,\n                text: `${overlappingRoute.dep} \\u2194 ${overlappingRoute.des}`, //u2194 -> '↔'\n                html: `<span>${overlappingRoute.dep}</span><span>\\u2194</span><span>${overlappingRoute.des}</span>`\n              },\n              RouteID: overlappingRoute.id,\n              PathAttributeId: overlappingRoute.pid\n            };\n            return formattedOverlappingRoute;\n          } else {\n            return null;\n          }\n        })\n        .filter((e) => {\n          return !(e === null);\n        });\n      integratedStopItem.position = {\n        longitude: thisSimplifiedLocation.lo,\n        latitude: thisSimplifiedLocation.la\n      };\n      positions.push({\n        latitude: thisSimplifiedLocation.la,\n        longitude: thisSimplifiedLocation.lo,\n        id: item.StopID\n      });\n\n      // Collect data from 'IndexedLocation' and 'MergedLocation'\n      const thisSimplifiedLocationGeohash = thisSimplifiedLocation.g;\n      let thisIndexedLocationItem: Array<IndexedLocationItem> = [];\n      if (IndexedLocation.hasOwnProperty(thisSimplifiedLocationGeohash)) {\n        thisIndexedLocationItem = IndexedLocation[thisSimplifiedLocationGeohash];\n      }\n      let nearbyLocations: Array<integratedStopItemNearbyLocationItem> = [];\n      for (const item of thisIndexedLocationItem) {\n        const mergedLocationKey = `ml_${item.hash}`;\n        if (MergedLocation.hasOwnProperty(mergedLocationKey)) {\n          const thisMergedLocation = MergedLocation[mergedLocationKey];\n          const nearbyLocationItem: integratedStopItemNearbyLocationItem = {\n            name: thisMergedLocation.n,\n            distance: convertPositionsToDistance(thisMergedLocation.la[0], thisMergedLocation.lo[0], thisSimplifiedLocation.la, thisSimplifiedLocation.lo) | 0,\n            hash: thisMergedLocation.hash\n          };\n          nearbyLocations.push(nearbyLocationItem);\n        }\n      }\n      nearbyLocations.sort(function (a, b) {\n        return a.distance - b.distance;\n      });\n      integratedStopItem.nearbyLocations = nearbyLocations;\n\n      // Collect data from 'batchFoundBuses'\n      let buses = []; // as Array<FormattedBus>\n      for (var overlappingStopID of thisSimplifiedLocation.s) {\n        const overlappingStopKey = `s_${overlappingStopID}`;\n        if (batchFoundBuses.hasOwnProperty(overlappingStopKey)) {\n          buses.push(batchFoundBuses[overlappingStopKey].map((e) => formatBus(e)));\n        }\n      }\n      integratedStopItem.buses = buses.flat().sort(function (a, b) {\n        return a.index - b.index;\n      });\n\n      // Collect data from 'BusArrivalTimes'\n      let thisBusArrivalTimes = [];\n      if (BusArrivalTimes.hasOwnProperty(thisStopKey)) {\n        thisBusArrivalTimes = BusArrivalTimes[thisStopKey];\n      }\n      integratedStopItem.busArrivalTimes = thisBusArrivalTimes;\n\n      // Check whether this stop is segment buffer\n      let isSegmentBuffer: boolean = false;\n      let isStartingPoint: boolean = false;\n      let isEndingPoint: boolean = false;\n      let useReversed: boolean = false;\n      if (hasSegmentBuffers) {\n        const groupKey = `g_${integratedStopItem.goBack}`;\n        let segmentBufferGroup = [];\n\n        if (thisSegmentBuffers.hasOwnProperty(groupKey)) {\n          segmentBufferGroup = thisSegmentBuffers[groupKey];\n        } else {\n          if (integratedStopItem.goBack === '1') {\n            useReversed = true;\n            segmentBufferGroup = thisSegmentBuffers['g_0'];\n          }\n        }\n\n        for (const thisBufferZone of segmentBufferGroup) {\n          if (thisBufferZone.OriginStopID === item.StopID || thisBufferZone.DestinationStopID === item.StopID) {\n            isSegmentBuffer = true;\n          }\n          if (useReversed) {\n            if (thisBufferZone.OriginStopID === item.StopID) {\n              isEndingPoint = true;\n            }\n            if (thisBufferZone.DestinationStopID === item.StopID) {\n              isStartingPoint = true;\n            }\n          } else {\n            if (thisBufferZone.OriginStopID === item.StopID) {\n              isStartingPoint = true;\n            }\n            if (thisBufferZone.DestinationStopID === item.StopID) {\n              isEndingPoint = true;\n            }\n          }\n        }\n      }\n      integratedStopItem.segmentBuffer = {\n        isSegmentBuffer,\n        isStartingPoint,\n        isEndingPoint\n      };\n\n      result.push(integratedStopItem);\n    }\n  }\n\n  result.sort(function (a, b) {\n    return a.sequence - b.sequence;\n  });\n\n  const nearestPosition = getNearestPosition(positions, 450);\n\n  let isBufferZoneOpened: boolean = false;\n  let isBufferZoneClosed: boolean = false;\n\n  let groupedItems: { [key: string]: Array<integratedStopItem> } = {};\n  let groupQuantity: number = 0;\n  let itemQuantity: { [key: string]: number } = {};\n\n  const resultLength = result.length;\n\n  for (let index = 0; index < resultLength; index++) {\n    let item = result[index];\n    const nextItem = result[index + 1] || item;\n    let progress = 0;\n\n    if (item.buses.length > 0) {\n      if (item.buses[0].onThisRoute) {\n        const [x, y] = [item.buses[0].position.longitude, item.buses[0].position.latitude];\n        const [x1, y1] = [item.position.longitude, item.position.latitude];\n        const [x2, y2] = [nextItem.position.longitude, nextItem.position.latitude];\n        const dotProduct = (x - x1) * (x2 - x) + (y - y1) * (y2 - y);\n        if (dotProduct >= 0) {\n          // ensure that (x, y) is between (x1, y1) and (x2, y2)\n          const distance1 = Math.hypot(x - x1, y - y1);\n          const distance2 = Math.hypot(x - x2, y - y2);\n          progress = Math.max(0, Math.min(distance1 / (distance1 + distance2), 1));\n        }\n      }\n    }\n    item.progress = progress;\n\n    if (item.segmentBuffer.isStartingPoint) {\n      isBufferZoneOpened = true;\n    }\n\n    if (item.segmentBuffer.isEndingPoint) {\n      if (isBufferZoneOpened) {\n        isBufferZoneClosed = true;\n      }\n    }\n\n    if (isBufferZoneOpened && !isBufferZoneClosed) {\n      item.segmentBuffer.isSegmentBuffer = true;\n    }\n\n    if (isBufferZoneOpened && isBufferZoneClosed) {\n      isBufferZoneOpened = false;\n      isBufferZoneClosed = false;\n    }\n\n    let isNearest = false;\n    if (!(nearestPosition === null)) {\n      if (nearestPosition.id === item.id) {\n        isNearest = true;\n      }\n    }\n    item.nearest = isNearest;\n\n    const groupKey = `g_${item.goBack}` || 'g_0';\n\n    if (!groupedItems.hasOwnProperty(groupKey)) {\n      groupedItems[groupKey] = [];\n      itemQuantity[groupKey] = 0;\n      groupQuantity += 1;\n    }\n\n    groupedItems[groupKey].push(item);\n    itemQuantity[groupKey] += 1;\n  }\n\n  const thisRoute = Route[`r_${RouteID}`];\n  const thisRouteName = thisRoute.n;\n  const thisRouteDeparture = thisRoute.dep;\n  const thisRouteDestination = thisRoute.des;\n\n  const result2: IntegratedRoute = {\n    groupedItems: groupedItems,\n    groupQuantity: groupQuantity,\n    itemQuantity: itemQuantity,\n    RouteName: thisRouteName,\n    RouteEndPoints: {\n      RouteDeparture: thisRouteDeparture,\n      RouteDestination: thisRouteDestination\n    },\n    dataUpdateTime: getDataUpdateTime(requestID),\n    RouteID,\n    PathAttributeId\n  };\n\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  // await recordEstimateTimeForUpdateRate(EstimateTime);\n  return result2;\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `// extracted by mini-css-extract-plugin\nexport {};`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/interface/animation.css\"],\"names\":[],\"mappings\":\"AAAA;QACS,CAAA\",\"sourcesContent\":[\"// extracted by mini-css-extract-plugin\\nexport {};\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { getDataUsageStats } from '../../data/analytics/data-usage/index';\nimport { convertBytes } from '../../tools/convert';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/query-selector';\nimport { dateToString } from '../../tools/time';\nimport { closePreviousPage, openPreviousPage, pushPageHistory, querySize } from '../index';\n\nconst dataUsageField = documentQuerySelector('.css_data_usage_field');\nconst dataUsageBodyElement = elementQuerySelector(dataUsageField, '.css_data_usage_body');\nconst chartElement = elementQuerySelector(dataUsageBodyElement, '.css_data_usage_chart');\nconst statisticsElement = elementQuerySelector(dataUsageBodyElement, '.css_data_usage_statistics');\nconst totalDataUsageElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"total-data-usage\"] .css_data_usage_statistics_item_value');\nconst startTimeElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"start-time\"] .css_data_usage_statistics_item_value');\nconst endTimeElement = elementQuerySelector(statisticsElement, '.css_data_usage_statistics_item[name=\"end-time\"] .css_data_usage_statistics_item_value');\n\nasync function initializeDataUsage() {\n  const WindowSize = querySize('window');\n  const graphWidth = WindowSize.width;\n  const graphHeight = Math.min((5 / 18) * graphWidth, WindowSize.height * 0.33);\n  const stats = await getDataUsageStats(graphWidth, graphHeight, 20);\n  totalDataUsageElement.innerText = convertBytes(stats.stats.sum);\n  startTimeElement.innerText = dateToString(stats.period.start, 'YYYY-MM-DD');\n  endTimeElement.innerText = dateToString(stats.period.end, 'YYYY-MM-DD');\n  chartElement.innerHTML = stats.chart;\n}\n\nexport function openDataUsage(): void {\n  pushPageHistory('DataUsage');\n  dataUsageField.setAttribute('displayed', 'true');\n  initializeDataUsage();\n  closePreviousPage();\n}\n\nexport function closeDataUsage(): void {\n  // revokePageHistory('DataUsage');\n  dataUsageField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n","import { getMaterialSymbols } from '../../data/apis/getMaterialSymbols/index';\nimport { prepareForMaterialSymbolsSearch, searchForMaterialSymbols } from '../../data/search/searchMaterialSymbols';\nimport { generateIdentifier } from '../../tools/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/query-selector';\nimport { containPhoneticSymbols } from '../../tools/text';\nimport { dataDownloadCompleted } from '../home/index';\nimport { getIconHTML } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\ntype Target = 'editor' | 'creator' | '';\n\nlet currentTarget: Target = '';\n\nconst folderEditorField = documentQuerySelector('.css_folder_editor_field');\nconst folderCreatorField = documentQuerySelector('.css_folder_creator_field');\nconst folderIconSelectorField = documentQuerySelector('.css_folder_icon_selector_field');\n\nfunction generateElementOfSymbol(symbol: string): GeneratedElement {\n  var identifier = generateIdentifier('i');\n  var element = document.createElement('div');\n  element.id = identifier;\n  element.classList.add('css_folder_icon_selector_symbol');\n  element.setAttribute('onclick', `bus.folder.selectFolderIcon('${symbol}', '${currentTarget}')`);\n  element.innerHTML = getIconHTML(symbol);\n  return {\n    element: element,\n    id: identifier\n  };\n}\n\nasync function initializeFolderIconSelectorField() {\n  const materialSymbolsElement = elementQuerySelector(folderIconSelectorField, '.css_folder_icon_selector_body .css_folder_icon_selector_material_symbols');\n  materialSymbolsElement.innerHTML = '';\n  const requestID: string = generateIdentifier('r');\n  const materialSymbols = await getMaterialSymbols(requestID);\n  for (const symbol of materialSymbols) {\n    const symbolElement = generateElementOfSymbol(symbol, currentTarget);\n    materialSymbolsElement.appendChild(symbolElement.element);\n  }\n}\n\nexport function updateMaterialSymbolsSearchResult(query: string): void {\n  const materialSymbolsSearchResultsElement = elementQuerySelector(folderIconSelectorField, '.css_folder_icon_selector_body .css_folder_icon_selector_material_symbols_search_results');\n  const materialSymbolsElement = elementQuerySelector(folderIconSelectorField, '.css_folder_icon_selector_body .css_folder_icon_selector_material_symbols');\n  materialSymbolsSearchResultsElement.innerHTML = '';\n  if (!containPhoneticSymbols(query)) {\n    const searchResults = searchForMaterialSymbols(query, 100);\n    for (const result of searchResults) {\n      const symbolElement = generateElementOfSymbol(result.item, currentTarget);\n      materialSymbolsSearchResultsElement.appendChild(symbolElement.element);\n    }\n    materialSymbolsSearchResultsElement.setAttribute('displayed', searchResults.length > 0 ? 'true' : 'false');\n    materialSymbolsElement.setAttribute('displayed', searchResults.length > 0 ? 'false' : 'true');\n  }\n}\n\nexport function selectFolderIcon(symbol: string): void {\n  var iconInputElement;\n  switch (currentTarget) {\n    case 'editor':\n      iconInputElement = elementQuerySelector(folderEditorField, '.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input input');\n      break;\n    case 'creator':\n      iconInputElement = elementQuerySelector(folderCreatorField, '.css_folder_creator_body .css_folder_creator_groups .css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input input');\n      break;\n    default:\n      break;\n  }\n  iconInputElement.value = symbol;\n  closeFolderIconSelector();\n}\n\nexport function openFolderIconSelector(target: Target): void {\n  pushPageHistory('FolderIconSelector');\n  var openFolderIconSelectorElement;\n  switch (target) {\n    case 'editor':\n      currentTarget = 'editor';\n      openFolderIconSelectorElement = elementQuerySelector(folderEditorField, '.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input .css_folder_editor_open_folder_icon_selector');\n      break;\n    case 'creator':\n      currentTarget = 'creator';\n      openFolderIconSelectorElement = elementQuerySelector(folderCreatorField, '.css_folder_creator_body .css_folder_creator_groups .css_folder_creator_group[group=\"folder-icon\"] .css_folder_creator_group_body .css_folder_creator_icon_input .css_folder_creator_open_folder_icon_selector');\n      break;\n    default:\n      break;\n  }\n  if (openFolderIconSelectorElement.getAttribute('disabled') === 'false') {\n    if (dataDownloadCompleted) {\n      folderIconSelectorField.setAttribute('displayed', 'true');\n      initializeFolderIconSelectorField(currentTarget);\n      prepareForMaterialSymbolsSearch();\n    } else {\n      promptMessage('資料還在下載中', 'download_for_offline');\n    }\n  }\n}\n\nexport function closeFolderIconSelector(): void {\n  revokePageHistory('FolderIconSelector');\n  folderIconSelectorField.setAttribute('displayed', 'false');\n}\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/dist/cjs.js!./animation.css?inline\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/dist/cjs.js!./animation.css?inline\";\n       export default content && content.locals ? content.locals : undefined;\n","import { recoverBusArrivalTimeDataFromWriteAheadLog } from './data/analytics/bus-arrival-time/index';\r\nimport { discardExpiredDataUsageStats } from './data/analytics/data-usage/index';\r\nimport { discardExpiredUpdateRateDataGroups, initializeUpdateRateDataGroups, recoverUpdateRateDataFromWriteAheadLog } from './data/analytics/update-rate/index';\r\nimport { initializeFolderList } from './data/folder/index';\r\nimport { discardExpiredNotificationSchedules, initializeNotificationSchedules, loadNotificationClient } from './data/notification/index';\r\nimport { discardExpiredRecentViews } from './data/recent-views/index';\r\nimport { initializeSettings } from './data/settings/index';\r\nimport { checkAppVersion } from './data/settings/version';\r\nimport { askForCalibratingPermission } from './data/user-orientation/index';\r\nimport { askForPositioningPermission } from './data/user-position/index';\r\nimport { closeBus, openBus } from './interface/bus/index';\r\nimport { closeDataUsage, openDataUsage } from './interface/data-usage/index';\r\nimport { closeFolderCreator, createFormulatedFolder, openFolderCreator } from './interface/folder-creator/index';\r\nimport { closeFolderEditor, moveItemOnFolderEditor, openFolderEditor, removeItemOnFolderEditor, saveEditedFolder } from './interface/folder-editor/index';\r\nimport { closeFolderIconSelector, openFolderIconSelector, selectFolderIcon, updateMaterialSymbolsSearchResult } from './interface/folder-icon-selector/index';\r\nimport { closeFolderManager, openFolderManager } from './interface/folder-manager/index';\r\nimport { initializeFolders, setUpFolderFieldSkeletonScreen } from './interface/home/folders/index';\r\nimport { downloadData } from './interface/home/index';\r\nimport { initializeRecentViews, setUpRecentViewsFieldSkeletonScreen } from './interface/home/recent-views/index';\r\nimport { fadeOutSplashScreen, setSplashScreenIconOffsetY } from './interface/index';\r\nimport { closeLocation, initializeLocationSliding, openLocation, stretchLocationItem, switchLocationBodyTab } from './interface/location/index';\r\nimport { cancelNotificationOnNotificationScheduleManager, closeNotificationScheduleManager, openNotificationScheduleManager } from './interface/notification-schedule-manager/index';\r\nimport { closePersonalScheduleCreator, createFormulatedPersonalSchedule, openPersonalScheduleCreator, switchPersonalScheduleCreatorDay } from './interface/personal-schedule-creator/index';\r\nimport { closePersonalScheduleEditor, openPersonalScheduleEditor, saveEditedPersonalSchedule, switchPersonalScheduleEditorDay } from './interface/personal-schedule-editor/index';\r\nimport { closePersonalScheduleManager, openPersonalScheduleManager } from './interface/personal-schedule-manager/index';\r\nimport { closeRegisterNotification, openRegisterNotification, saveFormulatedRegisterNotification } from './interface/register-notification/index';\r\nimport { shareRoutePermalink } from './interface/route/details/actions';\r\nimport { switchCalendarDay } from './interface/route/details/calendar';\r\nimport { closeRouteDetails, openRouteDetails } from './interface/route/details/index';\r\nimport { closeRoute, initializeRouteSliding, openRoute, stretchRouteItem, switchRoute, switchRouteBodyTab } from './interface/route/index';\r\nimport { closeSaveToFolder, openSaveToFolder, saveRouteOnDetailsPage, saveRouteOnRoute, saveStopItemOnLocation, saveStopItemOnRoute } from './interface/save-to-folder/index';\r\nimport { closeScheduleNotification, openScheduleNotification, scheduleNotificationForStopItemOnLocation, scheduleNotificationForStopItemOnRoute } from './interface/schedule-notification/index';\r\nimport { closeSearch, deleteCharFromInout, emptyInput, openSearch, openSystemKeyboard, resizeSearchInputCanvas, switchSearchTypeFilter, typeTextIntoInput, updateSearchInput, updateSearchResult } from './interface/search/index';\r\nimport { closeSettings, downloadExportFile, openFileToImportData, openSettings, showPromptToAskForPersistentStorage, viewCommitOfCurrentVersion } from './interface/settings/index';\r\nimport { closeSettingsOptions, openSettingsOptions, settingsOptionsHandler } from './interface/settings/options';\r\nimport { closeStorage, openStorage } from './interface/storage/index';\r\nimport { openPermalink } from './tools/permalink';\r\nimport { documentQuerySelector } from './tools/query-selector';\r\n\r\nimport './interface/theme.css?inline';\r\n\r\nimport './interface/index.css?inline';\r\n\r\nimport './interface/icons/index.css?inline';\r\n\r\nimport './interface/animation.css?inline';\r\n\r\nimport './interface/home/field.css?inline';\r\nimport './interface/home/head.css?inline';\r\nimport './interface/home/body.css?inline';\r\n\r\nimport './interface/home/folders/folders.css?inline';\r\nimport './interface/home/folders/item.css?inline';\r\n\r\nimport './interface/home/recent-views/recent-views.css?inline';\r\nimport './interface/home/recent-views/item.css?inline';\r\n\r\nimport './interface/search/field.css';\r\nimport './interface/search/head.css';\r\nimport './interface/search/body.css';\r\nimport './interface/search/keyboard.css';\r\n\r\nimport './interface/route/field.css';\r\nimport './interface/route/head.css';\r\nimport './interface/route/groups.css';\r\nimport './interface/route/item.css';\r\nimport './interface/route/thread.css';\r\nimport './interface/route/index.css';\r\n\r\nimport './interface/route/details/field.css';\r\nimport './interface/route/details/head.css';\r\nimport './interface/route/details/body.css';\r\nimport './interface/route/details/groups.css';\r\nimport './interface/route/details/actions.css';\r\nimport './interface/route/details/properties.css';\r\nimport './interface/route/details/calendar.css';\r\n\r\nimport './interface/location/field.css';\r\nimport './interface/location/head.css';\r\nimport './interface/location/groups.css';\r\nimport './interface/location/group-details.css';\r\nimport './interface/location/group-items.css';\r\nimport './interface/location/index.css';\r\n\r\nimport './interface/bus/field.css';\r\nimport './interface/bus/head.css';\r\nimport './interface/bus/body.css';\r\nimport './interface/bus/groups.css';\r\nimport './interface/bus/properties.css';\r\n\r\nimport './interface/settings/index.css';\r\n\r\nimport './interface/save-to-folder/field.css';\r\nimport './interface/save-to-folder/head.css';\r\nimport './interface/save-to-folder/body.css';\r\nimport './interface/save-to-folder/list.css';\r\nimport './interface/save-to-folder/item.css';\r\n\r\nimport './interface/folder-manager/field.css';\r\nimport './interface/folder-manager/head.css';\r\nimport './interface/folder-manager/body.css';\r\nimport './interface/folder-manager/list.css';\r\nimport './interface/folder-manager/item.css';\r\n\r\nimport './interface/folder-editor/field.css';\r\nimport './interface/folder-editor/head.css';\r\nimport './interface/folder-editor/body.css';\r\nimport './interface/folder-editor/groups.css';\r\nimport './interface/folder-editor/folder-name.css';\r\nimport './interface/folder-editor/folder-icon.css';\r\nimport './interface/folder-editor/folder-content.css';\r\n\r\nimport './interface/folder-creator/field.css';\r\nimport './interface/folder-creator/head.css';\r\nimport './interface/folder-creator/body.css';\r\nimport './interface/folder-creator/groups.css';\r\nimport './interface/folder-creator/folder-name.css';\r\nimport './interface/folder-creator/folder-icon.css';\r\n\r\nimport './interface/folder-icon-selector/field.css';\r\nimport './interface/folder-icon-selector/head.css';\r\nimport './interface/folder-icon-selector/body.css';\r\nimport './interface/folder-icon-selector/symbols.css';\r\n\r\nimport './interface/personal-schedule-manager/field.css';\r\nimport './interface/personal-schedule-manager/head.css';\r\nimport './interface/personal-schedule-manager/body.css';\r\nimport './interface/personal-schedule-manager/list.css';\r\nimport './interface/personal-schedule-manager/item.css';\r\n\r\nimport './interface/personal-schedule-creator/field.css';\r\nimport './interface/personal-schedule-creator/head.css';\r\nimport './interface/personal-schedule-creator/body.css';\r\nimport './interface/personal-schedule-creator/groups.css';\r\nimport './interface/personal-schedule-creator/schedule-name.css';\r\nimport './interface/personal-schedule-creator/schedule-start-time.css';\r\nimport './interface/personal-schedule-creator/schedule-end-time.css';\r\nimport './interface/personal-schedule-creator/schedule-days.css';\r\n\r\nimport './interface/personal-schedule-editor/field.css';\r\nimport './interface/personal-schedule-editor/head.css';\r\nimport './interface/personal-schedule-editor/body.css';\r\nimport './interface/personal-schedule-editor/groups.css';\r\nimport './interface/personal-schedule-editor/schedule-name.css';\r\nimport './interface/personal-schedule-editor/schedule-start-time.css';\r\nimport './interface/personal-schedule-editor/schedule-end-time.css';\r\nimport './interface/personal-schedule-editor/schedule-days.css';\r\n\r\nimport './interface/notification-schedule-manager/field.css';\r\nimport './interface/notification-schedule-manager/head.css';\r\nimport './interface/notification-schedule-manager/body.css';\r\nimport './interface/notification-schedule-manager/list.css';\r\nimport './interface/notification-schedule-manager/item.css';\r\n\r\nimport './interface/register-notification/field.css';\r\nimport './interface/register-notification/head.css';\r\nimport './interface/register-notification/body.css';\r\nimport './interface/register-notification/groups.css';\r\nimport './interface/register-notification/provider.css';\r\nimport './interface/register-notification/registration-key.css';\r\n\r\nimport './interface/schedule-notification/field.css';\r\nimport './interface/schedule-notification/head.css';\r\nimport './interface/schedule-notification/body.css';\r\nimport './interface/schedule-notification/list.css';\r\nimport './interface/schedule-notification/item.css';\r\n\r\nimport './interface/data-usage/field.css';\r\nimport './interface/data-usage/head.css';\r\nimport './interface/data-usage/body.css';\r\nimport './interface/data-usage/chart.css';\r\nimport './interface/data-usage/statistics.css';\r\n\r\nimport './interface/storage/field.css';\r\nimport './interface/storage/head.css';\r\nimport './interface/storage/body.css';\r\nimport './interface/storage/statistics.css';\r\n\r\nimport './interface/prompt/index.css';\r\n\r\nlet bus_initialized = false;\r\nlet bus_secondly_initialized = false;\r\n\r\nwindow.bus = {\r\n  initialize: function () {\r\n    if (bus_initialized === false) {\r\n      bus_initialized = true;\r\n      setSplashScreenIconOffsetY();\r\n      initializeSettings().then(function () {\r\n        const RecentViewsField = documentQuerySelector('.css_home_field .css_home_body .css_home_recent_views');\r\n        setUpRecentViewsFieldSkeletonScreen(RecentViewsField);\r\n        const FolderField = documentQuerySelector('.css_home_field .css_home_body .css_home_folders');\r\n        setUpFolderFieldSkeletonScreen(FolderField);\r\n        checkAppVersion()\r\n          .then((status) => {\r\n            if (status === 'ok') {\r\n              initializeRouteSliding();\r\n              initializeLocationSliding();\r\n              resizeSearchInputCanvas();\r\n              window.addEventListener('resize', () => {\r\n                resizeSearchInputCanvas();\r\n              });\r\n              if (screen) {\r\n                if (screen.orientation) {\r\n                  screen.orientation.addEventListener('change', () => {\r\n                    resizeSearchInputCanvas();\r\n                  });\r\n                }\r\n              }\r\n              initializeRecentViews();\r\n              initializeFolderList().then(() => {\r\n                initializeFolders();\r\n              });\r\n              const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n              const searchInputElement = documentQuerySelector('.css_search_field .css_search_head .css_search_search_input #search_input') as HTMLInputElement;\r\n              mediaQuery.addEventListener('change', function () {\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('paste', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('cut', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('selectionchange', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              document.addEventListener('selectionchange', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n              searchInputElement.addEventListener('keyup', function () {\r\n                updateSearchResult();\r\n                updateSearchInput(searchInputElement.selectionStart, searchInputElement.selectionEnd);\r\n              });\r\n\r\n              const searchMaterialSymbolsInputElement: HTMLElement = documentQuerySelector('.css_folder_icon_selector_field .css_folder_icon_selector_head .css_folder_icon_selector_search_input #search_material_symbols_input');\r\n              searchMaterialSymbolsInputElement.addEventListener('paste', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              searchMaterialSymbolsInputElement.addEventListener('cut', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              searchMaterialSymbolsInputElement.addEventListener('selectionchange', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              document.addEventListener('selectionchange', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              searchMaterialSymbolsInputElement.addEventListener('keyup', function () {\r\n                updateMaterialSymbolsSearchResult(searchMaterialSymbolsInputElement.value);\r\n              });\r\n              openPermalink();\r\n              fadeOutSplashScreen(function () {\r\n                loadNotificationClient();\r\n                initializeNotificationSchedules().then(function () {\r\n                  discardExpiredNotificationSchedules();\r\n                });\r\n                document.addEventListener(\r\n                  'click',\r\n                  function () {\r\n                    askForPositioningPermission();\r\n                    askForCalibratingPermission();\r\n                  },\r\n                  { once: true }\r\n                );\r\n              });\r\n            }\r\n            if (status === 'fetchError' || status === 'unknownError') {\r\n              fadeOutSplashScreen();\r\n              alert(status);\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            fadeOutSplashScreen();\r\n            alert(error);\r\n          });\r\n      });\r\n    }\r\n  },\r\n  secondlyInitialize: function () {\r\n    if (!bus_secondly_initialized) {\r\n      bus_secondly_initialized = true;\r\n      downloadData();\r\n      discardExpiredUpdateRateDataGroups();\r\n      discardExpiredDataUsageStats();\r\n      recoverBusArrivalTimeDataFromWriteAheadLog();\r\n      discardExpiredRecentViews();\r\n      discardExpiredUpdateRateDataGroups().then(function () {\r\n        initializeUpdateRateDataGroups().then(function () {\r\n          recoverUpdateRateDataFromWriteAheadLog();\r\n        });\r\n      });\r\n    }\r\n  },\r\n  route: {\r\n    stretchRouteItem,\r\n    openRoute,\r\n    closeRoute,\r\n    switchRoute,\r\n    switchRouteBodyTab,\r\n    openRouteDetails,\r\n    closeRouteDetails,\r\n    shareRoutePermalink,\r\n    switchCalendarDay\r\n  },\r\n  location: {\r\n    openLocation,\r\n    closeLocation,\r\n    stretchLocationItem,\r\n    switchLocationBodyTab\r\n  },\r\n  folder: {\r\n    openSaveToFolder,\r\n    closeSaveToFolder,\r\n    openFolderManager,\r\n    closeFolderManager,\r\n    openFolderEditor,\r\n    closeFolderEditor,\r\n    openFolderIconSelector,\r\n    closeFolderIconSelector,\r\n    openFolderCreator,\r\n    closeFolderCreator,\r\n    createFormulatedFolder,\r\n    saveEditedFolder,\r\n    selectFolderIcon,\r\n    saveStopItemOnRoute,\r\n    saveStopItemOnLocation,\r\n    saveRouteOnDetailsPage,\r\n    saveRouteOnRoute,\r\n    removeItemOnFolderEditor,\r\n    moveItemOnFolderEditor\r\n  },\r\n  search: {\r\n    openSearch,\r\n    closeSearch,\r\n    typeTextIntoInput,\r\n    deleteCharFromInout,\r\n    emptyInput,\r\n    openSystemKeyboard,\r\n    switchSearchTypeFilter\r\n  },\r\n  storage: {\r\n    openStorage,\r\n    closeStorage\r\n  },\r\n  dataUsage: {\r\n    openDataUsage,\r\n    closeDataUsage\r\n  },\r\n  personalSchedule: {\r\n    openPersonalScheduleManager,\r\n    closePersonalScheduleManager,\r\n    openPersonalScheduleCreator,\r\n    closePersonalScheduleCreator,\r\n    createFormulatedPersonalSchedule,\r\n    switchPersonalScheduleCreatorDay,\r\n    openPersonalScheduleEditor,\r\n    closePersonalScheduleEditor,\r\n    switchPersonalScheduleEditorDay,\r\n    saveEditedPersonalSchedule\r\n  },\r\n  settings: {\r\n    openSettings,\r\n    closeSettings,\r\n    openSettingsOptions,\r\n    closeSettingsOptions,\r\n    settingsOptionsHandler,\r\n    downloadExportFile,\r\n    openFileToImportData,\r\n    viewCommitOfCurrentVersion,\r\n    showPromptToAskForPersistentStorage\r\n  },\r\n  bus: {\r\n    openBus,\r\n    closeBus\r\n  },\r\n  notification: {\r\n    openNotificationScheduleManager,\r\n    closeNotificationScheduleManager,\r\n    openRegisterNotification,\r\n    closeRegisterNotification,\r\n    saveFormulatedRegisterNotification,\r\n    openScheduleNotification,\r\n    closeScheduleNotification,\r\n    scheduleNotificationForStopItemOnRoute,\r\n    scheduleNotificationForStopItemOnLocation,\r\n    cancelNotificationOnNotificationScheduleManager\r\n  }\r\n};\r\n\r\nexport default window.bus;\r\n","import { FolderWithContent, listFoldersWithContent } from '../../data/folder/index';\nimport { generateIdentifier } from '../../tools/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/query-selector';\nimport { getIconHTML } from '../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../index';\n\nfunction generateElementOfItem(item: FolderWithContent): GeneratedElement {\n  var identifier = generateIdentifier('i');\n  var element = document.createElement('div');\n  element.classList.add('css_folder_manager_folder_item');\n  element.id = identifier;\n  element.setAttribute('onclick', `bus.folder.openFolderEditor('${item.id}')`);\n  element.innerHTML = /*html*/ `<div class=\"css_folder_manager_folder_item_icon\">${getIconHTML(item.icon)}</div><div class=\"css_folder_manager_folder_item_name\">${item.name}</div><div class=\"css_folder_manager_folder_item_status\">${item.contentLength}</div><div class=\"css_folder_manager_folder_item_arrow\">${getIconHTML('arrow_forward_ios')}</div>`;\n  return {\n    element: element,\n    id: identifier\n  };\n}\n\nasync function initializeFolderManagerField() {\n  var Field = documentQuerySelector('.css_folder_manager_field');\n  var ListElement = elementQuerySelector(Field, '.css_folder_manager_body .css_folder_manager_folder_list');\n  ListElement.innerHTML = '';\n  var foldersWithContent = await listFoldersWithContent();\n  for (var item of foldersWithContent) {\n    var thisElement = generateElementOfItem(item);\n    ListElement.appendChild(thisElement.element);\n  }\n}\n\nexport function openFolderManager(): void {\n  pushPageHistory('FolderManager');\n  var Field = documentQuerySelector('.css_folder_manager_field');\n  Field.setAttribute('displayed', 'true');\n  initializeFolderManagerField();\n}\n\nexport function closeFolderManager(): void {\n  revokePageHistory('FolderManager');\n  var Field = documentQuerySelector('.css_folder_manager_field');\n  Field.setAttribute('displayed', 'false');\n}\n","import { MaterialSymbols } from '../../interface/icons/material-symbols-type';\nimport { dateToString, dateValueToDayOfWeek, getThisWeekOrigin, offsetDate } from '../../tools/time';\nimport { getProvider, Provider, ProviderItem } from '../apis/getProvider/index';\nimport { getRoute, Route, RouteItem } from '../apis/getRoute/index';\nimport { getSemiTimeTable } from '../apis/getSemiTimeTable/index';\nimport { getTimeTable } from '../apis/getTimeTable/index';\nimport { parseTimeCode, TimeMoment, TimeRange } from '../apis/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../apis/loader';\n\nfunction findRoute(Route: Route, RouteID: number): RouteItem {\n  let thisRoute = {} as RouteItem;\n  for (const item of Route) {\n    if (item.Id === RouteID) {\n      thisRoute = item;\n      break;\n    }\n  }\n  return thisRoute;\n}\n\nfunction findProvider(Provider: Provider, providerId: number): ProviderItem {\n  let thisProvider = {} as ProviderItem;\n  for (const item of Provider) {\n    if (item.id === providerId) {\n      thisProvider = item;\n    }\n  }\n  return thisProvider;\n}\n\nexport interface CalendarEvent {\n  date: Date;\n  dateString: string;\n  duration: number;\n  deviation: number;\n}\n\nexport type CalendarEventGroup = Array<CalendarEvent>;\n\nexport interface CalendarDay {\n  name: string;\n  day: number;\n  code: string;\n}\n\nexport interface Calendar {\n  calendarDays: {\n    [key: string]: CalendarDay;\n  };\n  calendarDayQuantity: 7;\n  calendarEventGroups: {\n    [key: string]: CalendarEventGroup;\n  };\n  calendarEventQuantity: {\n    [key: string]: number;\n  };\n}\n\nfunction generateCalendarFromTimeTables(RouteID: number, PathAttributeId: Array<number>, timeTableRules: object, SemiTimeTable: [], TimeTable: []): Calendar {\n  let calendar: Calendar = {\n    calendarDays: {\n      d_0: {\n        name: '日',\n        day: 0,\n        code: 'd_0'\n      },\n      d_1: {\n        name: '一',\n        day: 1,\n        code: 'd_1'\n      },\n      d_2: {\n        name: '二',\n        day: 2,\n        code: 'd_2'\n      },\n      d_3: {\n        name: '三',\n        day: 3,\n        code: 'd_3'\n      },\n      d_4: {\n        name: '四',\n        day: 4,\n        code: 'd_4'\n      },\n      d_5: {\n        name: '五',\n        day: 5,\n        code: 'd_5'\n      },\n      d_6: {\n        name: '六',\n        day: 6,\n        code: 'd_6'\n      }\n    },\n    calendarDayQuantity: 7,\n    calendarEventGroups: {\n      d_0: [],\n      d_1: [],\n      d_2: [],\n      d_3: [],\n      d_4: [],\n      d_5: [],\n      d_6: []\n    },\n    calendarEventQuantity: {\n      d_0: 0,\n      d_1: 0,\n      d_2: 0,\n      d_3: 0,\n      d_4: 0,\n      d_5: 0,\n      d_6: 0\n    }\n  };\n  const thisWeekOrigin = getThisWeekOrigin();\n  for (const item of SemiTimeTable) {\n    if (PathAttributeId.indexOf(item.PathAttributeId) > -1) {\n      if (item.DateType === '0') {\n        const dayOfWeek = dateValueToDayOfWeek(item.DateValue);\n        const thisDayOrigin = offsetDate(thisWeekOrigin, dayOfWeek.day, 0, 0);\n        const thisPeriodStartTime = parseTimeCode(item.StartTime, 0);\n        const thisPeriodStartTimeDateObject = offsetDate(thisDayOrigin, 0, thisPeriodStartTime.hours, thisPeriodStartTime.minutes);\n        const thisPeriodEndTime = parseTimeCode(item.EndTime, 0);\n        const thisPeriodEndTimeDateObject = offsetDate(thisDayOrigin, 0, thisPeriodEndTime.hours, thisPeriodEndTime.minutes);\n        const thisPeriodDurationInMinutes = Math.abs(thisPeriodEndTime.hours * 60 + thisPeriodEndTime.minutes - (thisPeriodStartTime.hours * 60 + thisPeriodStartTime.minutes));\n\n        const minWindow = parseInt(item.LongHeadway);\n        const maxWindow = parseInt(item.LowHeadway);\n        const averageWindow = (maxWindow + minWindow) / 2;\n        const headwayQuantity = thisPeriodDurationInMinutes / averageWindow;\n\n        for (let i = 0; i < headwayQuantity; i++) {\n          let violateRules = false;\n          const thisHeadwayDate = offsetDate(thisDayOrigin, 0, thisPeriodStartTime.hours, thisPeriodStartTime.minutes + maxWindow * i);\n          if (thisHeadwayDate.getTime() < thisPeriodStartTimeDateObject.getTime()) {\n            violateRules = true;\n          }\n          if (thisHeadwayDate.getTime() > thisPeriodEndTimeDateObject.getTime()) {\n            violateRules = true;\n          }\n          // TODO: check timeTableRules\n          if (violateRules === false) {\n            calendar.calendarEventGroups[dayOfWeek.code].push({\n              date: thisHeadwayDate,\n              dateString: dateToString(thisHeadwayDate, 'hh:mm'),\n              duration: maxWindow,\n              deviation: Math.abs(averageWindow - maxWindow)\n            });\n            calendar.calendarEventQuantity[dayOfWeek.code] += 1;\n          }\n        }\n      }\n    }\n  }\n  for (const item of TimeTable) {\n    if (PathAttributeId.indexOf(item.PathAttributeId) > -1) {\n      if (item.DateType === '0') {\n        let violateRules = false;\n        const dayOfWeek = dateValueToDayOfWeek(item.DateValue);\n        const thisDayOrigin = offsetDate(thisWeekOrigin, dayOfWeek.day, 0, 0);\n        const thisDepartureTime = parseTimeCode(item.DepartureTime, 0);\n        const thisHeadwayDate = offsetDate(thisDayOrigin, 0, thisDepartureTime.hours, thisDepartureTime.minutes);\n        // TODO: check timeTableRules\n        if (violateRules === false) {\n          calendar.calendarEventGroups[dayOfWeek.code].push({\n            date: thisHeadwayDate,\n            dateString: dateToString(thisHeadwayDate, 'hh:mm'),\n            duration: 15,\n            deviation: 0\n          });\n          calendar.calendarEventQuantity[dayOfWeek.code] += 1;\n        }\n      }\n    }\n  }\n  for (const code in calendar.calendarEventGroups) {\n    calendar.calendarEventGroups[code].sort(function (a, b) {\n      return a.date.getTime() - b.date.getTime();\n    });\n  }\n  return calendar;\n}\n\nexport interface TimeTableRules {\n  go: {\n    weekday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n    holiday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n  };\n  back: {\n    weekday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n    holiday: {\n      first: TimeMoment;\n      last: TimeMoment;\n      rushHourWindow: TimeRange;\n      offRushHourWindow: TimeRange;\n    };\n  };\n  realSequence: any;\n}\n\nfunction getTimeTableRules(thisRoute: RouteItem): TimeTableRules {\n  const thisRouteGoFirstBusTime = parseTimeCode(thisRoute.goFirstBusTime, 0);\n  const thisRouteGoLastBusTime = parseTimeCode(thisRoute.goLastBusTime, 0);\n\n  const thisRouteBackFirstBusTime = parseTimeCode(thisRoute.backFirstBusTime, 0);\n  const thisRouteBackLastBusTime = parseTimeCode(thisRoute.backLastBusTime, 0);\n\n  const thisRouteGoFirstBusTimeOnHoliday = parseTimeCode(thisRoute.holidayGoFirstBusTime, 0);\n  const thisRouteGoLastBusTimeOnHoliday = parseTimeCode(thisRoute.holidayGoLastBusTime, 0);\n\n  const thisRouteBackFirstBusTimeOnHoliday = parseTimeCode(thisRoute.holidayBackFirstBusTime, 0);\n  const thisRouteBackLastBusTimeOnHoliday = parseTimeCode(thisRoute.holidayBackLastBusTime, 0);\n\n  const rushHourWindow = parseTimeCode(thisRoute.peakHeadway, 1);\n  const offRushHourWindow = parseTimeCode(thisRoute.offPeakHeadway, 1);\n\n  const rushHourWindowOnHoliday = parseTimeCode(thisRoute.holidayPeakHeadway, 1);\n  const offRushHourWindowOnHoliday = parseTimeCode(thisRoute.holidayOffPeakHeadway, 1);\n  // window → the interval/gap between arrivals of buses\n\n  var realSequence = thisRoute.realSequence;\n  return {\n    go: {\n      weekday: {\n        first: thisRouteGoFirstBusTime,\n        last: thisRouteGoLastBusTime,\n        rushHourWindow: rushHourWindow,\n        offRushHourWindow: offRushHourWindow\n      },\n      holiday: {\n        first: thisRouteGoFirstBusTimeOnHoliday,\n        last: thisRouteGoLastBusTimeOnHoliday,\n        rushHourWindow: rushHourWindowOnHoliday,\n        offRushHourWindow: offRushHourWindowOnHoliday\n      }\n    },\n    back: {\n      weekday: {\n        first: thisRouteBackFirstBusTime,\n        last: thisRouteBackLastBusTime,\n        rushHourWindow: rushHourWindow,\n        offRushHourWindow: offRushHourWindow\n      },\n      holiday: {\n        first: thisRouteBackFirstBusTimeOnHoliday,\n        last: thisRouteBackLastBusTimeOnHoliday,\n        rushHourWindow: rushHourWindowOnHoliday,\n        offRushHourWindow: offRushHourWindowOnHoliday\n      }\n    },\n    realSequence: realSequence\n  };\n}\n\nexport interface integratedRouteDetailsProperty {\n  key: string;\n  icon: MaterialSymbols;\n  value: string;\n}\n\nexport type integratedRouteDetailsProperties = Array<integratedRouteDetailsProperty>;\n\nexport interface integratedRouteDetails {\n  timeTableRules: TimeTableRules;\n  calendar: Calendar;\n  properties: integratedRouteDetailsProperties;\n}\n\nexport async function integrateRouteDetails(RouteID: number, PathAttributeId: Array<number>, requestID: string): Promise<integratedRouteDetails> {\n  const Route = (await getRoute(requestID, false)) as Route;\n  const thisRoute = findRoute(Route, RouteID);\n\n  const SemiTimeTable = await getSemiTimeTable(requestID);\n  const TimeTable = await getTimeTable(requestID);\n  const Provider = await getProvider(requestID);\n  const timeTableRules = getTimeTableRules(thisRoute);\n  const calendar = generateCalendarFromTimeTables(RouteID, PathAttributeId, timeTableRules, SemiTimeTable, TimeTable);\n  const thisProviderId = thisRoute.providerId;\n  const thisProvider = findProvider(Provider, thisProviderId);\n\n  const result: integratedRouteDetails = {\n    timeTableRules: timeTableRules,\n    calendar: calendar,\n    properties: [\n      {\n        key: 'route_name',\n        icon: 'route',\n        value: thisRoute.nameZh\n      },\n      {\n        key: 'pricing',\n        icon: 'attach_money',\n        value: thisRoute.ticketPriceDescriptionZh\n      },\n      {\n        key: 'provider_name',\n        icon: 'corporate_fare',\n        value: thisProvider.nameZn\n      },\n      {\n        key: 'provider_phone',\n        icon: 'call',\n        value: thisProvider.phoneInfo\n      },\n      {\n        key: 'provider_email',\n        icon: 'alternate_email',\n        value: thisProvider.email\n      }\n    ]\n  };\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  return result;\n}\n","import { Folder, FolderContent, getFolder, listFolderContent, removeFromFolder, updateFolder, updateFolderContentIndex } from '../../data/folder/index';\nimport { generateIdentifier } from '../../tools/index';\nimport { documentQuerySelector, elementQuerySelector } from '../../tools/query-selector';\nimport { getIconHTML } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\n\nconst FolderEditorField = documentQuerySelector('.css_folder_editor_field');\nconst FolderEditorHeadElement = elementQuerySelector(FolderEditorField, '.css_folder_editor_head');\nconst LeftButtonElement = elementQuerySelector(FolderEditorHeadElement, '.css_folder_editor_button_left');\nconst FolderEditorBodyElement = elementQuerySelector(FolderEditorField, '.css_folder_editor_body');\nconst FolderEditorGroupsElement = elementQuerySelector(FolderEditorBodyElement, '.css_folder_editor_groups');\nconst NameInputElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-name\"] .css_folder_editor_group_body input');\nconst IconInputElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input input');\nconst OpenFolderIconSelectorElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-icon\"] .css_folder_editor_group_body .css_folder_editor_icon_input .css_folder_editor_open_folder_icon_selector');\nconst FolderContentElement = elementQuerySelector(FolderEditorGroupsElement, '.css_folder_editor_group[group=\"folder-content\"] .css_folder_editor_group_body');\n\nfunction generateElementOfItem(folder: Folder, item: FolderContent): GeneratedElement {\n  const identifier = generateIdentifier('i');\n  let element = document.createElement('div');\n  element.id = identifier;\n  element.classList.add('css_folder_editor_folder_item');\n  element.setAttribute('type', item.type);\n  let context = '';\n  let main = '';\n  let icon = '';\n  switch (item.type) {\n    case 'stop':\n      icon = 'location_on';\n      context = `${item.route ? item.route.name : ''} - 往${item.route ? [item.route.endPoints.destination, item.route.endPoints.departure, ''][item.direction ? item.direction : 0] : ''}`;\n      main = item.name;\n      break;\n    case 'route':\n      icon = 'route';\n      context = `${item.endPoints.departure} \\u2194 ${item.endPoints.destination}`;\n      main = item.name;\n      break;\n    case 'bus':\n      context = '';\n      main = item.name;\n      break;\n    case 'empty':\n      icon = 'lightbulb';\n      context = '提示';\n      main = '沒有內容';\n      break;\n    default:\n      icon = '';\n      context = 'null';\n      main = 'null';\n      break;\n  }\n  element.innerHTML = /*html*/ `<div class=\"css_folder_editor_folder_item_icon\">${getIconHTML(icon)}</div><div class=\"css_folder_editor_folder_item_context\">${context}</div><div class=\"css_folder_editor_folder_item_main\">${main}</div><div class=\"css_folder_editor_folder_item_capsule\"><div class=\"css_folder_editor_folder_item_sort_control_up\" onclick=\"bus.folder.moveItemOnFolderEditor('${identifier}', '${folder.id}', '${item.type}', ${item.id}, 'up')\">${getIconHTML('keyboard_arrow_down')}</div><div class=\"css_folder_editor_folder_item_sort_control_down\" onclick=\"bus.folder.moveItemOnFolderEditor('${identifier}', '${folder.id}', '${item.type}', ${item.id}, 'down')\">${getIconHTML('keyboard_arrow_down')}</div><div class=\"css_folder_editor_folder_item_delete\" onclick=\"bus.folder.removeItemOnFolderEditor('${identifier}', '${folder.id}', '${item.type}', ${item.id})\">${getIconHTML('delete')}</div><div class=\"css_folder_editor_folder_item_capsule_separator\"></div><div class=\"css_folder_editor_folder_item_capsule_separator\"></div></div>`;\n  return {\n    element: element,\n    id: identifier\n  };\n}\n\nfunction updateFolderEditorField(folder: Folder, content: Array<FolderContent>): void {\n  NameInputElement.value = folder.name;\n  IconInputElement.value = folder.icon;\n\n  if (folder.default) {\n    NameInputElement.setAttribute('readonly', 'readonly');\n    IconInputElement.setAttribute('readonly', 'readonly');\n    OpenFolderIconSelectorElement.setAttribute('disabled', 'true');\n  } else {\n    NameInputElement.removeAttribute('readonly');\n    IconInputElement.removeAttribute('readonly');\n    OpenFolderIconSelectorElement.setAttribute('disabled', 'false');\n  }\n\n  LeftButtonElement.setAttribute('onclick', `bus.folder.saveEditedFolder('${folder.id}')`);\n\n  FolderContentElement.innerHTML = '';\n  for (var item of content) {\n    var thisItemElement = generateElementOfItem(folder, item);\n    FolderContentElement.appendChild(thisItemElement.element);\n  }\n}\n\nasync function initializeFolderEditorField(folderID: string) {\n  //TODO: add skeleton screen\n  var folder = await getFolder(folderID);\n  var content = await listFolderContent(folderID);\n  updateFolderEditorField(folder, content);\n}\n\nexport function openFolderEditor(folderID: string): void {\n  pushPageHistory('FolderEditor');\n  FolderEditorField.setAttribute('displayed', 'true');\n  initializeFolderEditorField(folderID);\n  closePreviousPage();\n}\n\nexport function closeFolderEditor(): void {\n  // revokePageHistory('FolderEditor');\n  FolderEditorField.setAttribute('displayed', 'false');\n  openPreviousPage();\n}\n\nexport function removeItemOnFolderEditor(itemID: string, folderID: Folder['id'], type: FolderContent['type'], id: number): void {\n  const itemElement = elementQuerySelector(FolderEditorField, `.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-content\"] .css_folder_editor_group_body .css_folder_editor_folder_item#${itemID}`);\n  removeFromFolder(folderID, type, id).then((e) => {\n    if (e) {\n      itemElement.remove();\n      switch (type) {\n        case 'stop':\n          promptMessage('已移除站牌', 'delete');\n          break;\n        case 'route':\n          promptMessage('已移除路線', 'delete');\n          break;\n        default:\n          break;\n      }\n    } else {\n      promptMessage('無法移除', 'error');\n    }\n  });\n}\n\nexport function moveItemOnFolderEditor(itemID: string, folderID: Folder['id'], type: FolderContent['type'], id: FolderContent['id'], direction: 'up' | 'down'): void {\n  const itemElement = elementQuerySelector(FolderEditorField, `.css_folder_editor_body .css_folder_editor_groups .css_folder_editor_group[group=\"folder-content\"] .css_folder_editor_group_body .css_folder_editor_folder_item#${itemID}`);\n  updateFolderContentIndex(folderID, type, id, direction).then((e) => {\n    if (e) {\n      switch (direction) {\n        case 'up':\n          const previousSibling = itemElement.previousElementSibling;\n          if (previousSibling) {\n            itemElement.parentNode.insertBefore(itemElement, previousSibling);\n          }\n          promptMessage('已往上移', 'arrow_circle_up');\n          break;\n        case 'down':\n          const nextSibling = itemElement.nextElementSibling;\n          if (nextSibling) {\n            itemElement.parentNode.insertBefore(nextSibling, itemElement);\n          }\n          promptMessage('已往下移', 'arrow_circle_down');\n          break;\n        default:\n          break;\n      }\n    } else {\n      promptMessage('無法移動', 'error');\n    }\n  });\n}\n\nexport function saveEditedFolder(folderID: string): void {\n  const name = NameInputElement.value;\n  const icon = IconInputElement.value;\n  updateFolder(folderID, name, icon);\n  closeFolderEditor();\n}\n"],"names":["previousProperties","previousSkeletonScreen","previousAnimation","updateBusPropertiesField","Field","properties","skeletonScreen","animation","updateProperty","thisElement","thisProperty","previousProperty","updateIcon","elementQuerySelector","innerHTML","getIconHTML","icon","updateValue","innerText","value","updateAnimation","setAttribute","updateSkeletonScreen","compareThings","element","propertyQuantity","length","currentPropertySeatQuantity","elementQuerySelectorAll","capacity","o","Math","abs","newPropertyElement","document","createElement","classList","add","id","appendChild","propertyIndex","remove","propertyElements","i","thisPropertyElement","BusField","documentQuerySelector","BusBody","BusGroups","BusGroupProperties","openBus","pushPageHistory","logRecentView","_x","_initializeBusPage","apply","arguments","initializeBusPage","closePreviousPage","closeBus","openPreviousPage","playing_animation","getSettingOptionValue","push","key","setUpBusPropertiesFieldSkeletonScreen","requestID","generateIdentifier","integration","integrateBus","FolderCreatorField","FolderCreatorBodyElement","FolderCreatorGroupsElement","NameInputElement","IconInputElement","createFormulatedFolder","name","createFolder","then","e","closeFolderCreator","promptMessage","openFolderCreator","integrateRoute","_x2","_x3","_x4","_x5","_integrateRoute","RouteID","PathAttributeId","chartWidth","chartHeight","setDataReceivingProgress","Route","getRoute","Stop","getStop","SimplifiedLocation","getLocation","MergedLocation","IndexedLocation","SegmentBuffers","getSegmentBuffers","EstimateTime","getEstimateTime","BusEvent","getBusEvent","BusData","getBusData","BusArrivalTimes","getBusArrivalTimes","batchFoundBuses","batchFindBusesForRoute","hasSegmentBuffers","thisSegmentBuffers","hasOwnProperty","_step","time_formatting_mode","result","positions","_iterator","_createForOfIteratorHelper","s","n","done","item","integratedStopItem","thisRouteID","includes","status","parseEstimateTime","thisStopKey","StopID","thisStop","sequence","seqNo","goBack","thisLocationKey","stopLocationId","thisSimplifiedLocation","overlappingRoutes","r","filter","map","overlappingRouteKey","overlappingRoute","RouteEndPoints","RouteDeparture","dep","RouteDestination","des","text","html","pid","position","longitude","lo","latitude","la","thisSimplifiedLocationGeohash","g","thisIndexedLocationItem","_step2","nearbyLocations","_iterator2","mergedLocationKey","hash","thisMergedLocation","nearbyLocationItem","distance","convertPositionsToDistance","err","f","sort","a","b","_step3","buses","_iterator3","overlappingStopKey","formatBus","flat","index","thisBusArrivalTimes","busArrivalTimes","isSegmentBuffer","isStartingPoint","isEndingPoint","useReversed","groupKey","segmentBufferGroup","_step4","_iterator4","thisBufferZone","OriginStopID","DestinationStopID","segmentBuffer","nearestPosition","getNearestPosition","isBufferZoneOpened","isBufferZoneClosed","groupedItems","groupQuantity","itemQuantity","resultLength","nextItem","progress","onThisRoute","_ref","x","y","_ref2","x1","y1","_ref3","x2","y2","distance1","hypot","distance2","max","min","isNearest","nearest","thisRoute","result2","RouteName","dataUpdateTime","getDataUpdateTime","deleteDataReceivingProgress","deleteDataUpdateTime","___CSS_LOADER_EXPORT___","module","dataUsageField","dataUsageBodyElement","chartElement","statisticsElement","totalDataUsageElement","startTimeElement","endTimeElement","_initializeDataUsage","WindowSize","querySize","graphWidth","width","graphHeight","height","stats","getDataUsageStats","convertBytes","sum","dateToString","period","start","end","chart","currentTarget","folderEditorField","folderCreatorField","folderIconSelectorField","generateElementOfSymbol","symbol","identifier","_initializeFolderIconSelectorField","materialSymbolsElement","getMaterialSymbols","symbolElement","updateMaterialSymbolsSearchResult","query","materialSymbolsSearchResultsElement","containPhoneticSymbols","searchResults","searchForMaterialSymbols","closeFolderIconSelector","revokePageHistory","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","bus_initialized","bus_secondly_initialized","window","bus","initialize","setSplashScreenIconOffsetY","initializeSettings","RecentViewsField","setUpRecentViewsFieldSkeletonScreen","FolderField","setUpFolderFieldSkeletonScreen","checkAppVersion","initializeRouteSliding","initializeLocationSliding","resizeSearchInputCanvas","addEventListener","screen","orientation","initializeRecentViews","initializeFolderList","initializeFolders","mediaQuery","matchMedia","searchInputElement","updateSearchInput","selectionStart","selectionEnd","updateSearchResult","searchMaterialSymbolsInputElement","openPermalink","fadeOutSplashScreen","loadNotificationClient","initializeNotificationSchedules","discardExpiredNotificationSchedules","askForPositioningPermission","askForCalibratingPermission","once","alert","error","secondlyInitialize","downloadData","discardExpiredUpdateRateDataGroups","discardExpiredDataUsageStats","recoverBusArrivalTimeDataFromWriteAheadLog","discardExpiredRecentViews","initializeUpdateRateDataGroups","recoverUpdateRateDataFromWriteAheadLog","route","stretchRouteItem","openRoute","closeRoute","switchRoute","switchRouteBodyTab","openRouteDetails","closeRouteDetails","shareRoutePermalink","switchCalendarDay","location","openLocation","closeLocation","stretchLocationItem","switchLocationBodyTab","folder","openSaveToFolder","closeSaveToFolder","openFolderManager","closeFolderManager","openFolderEditor","closeFolderEditor","openFolderIconSelector","target","openFolderIconSelectorElement","getAttribute","dataDownloadCompleted","initializeFolderIconSelectorField","prepareForMaterialSymbolsSearch","saveEditedFolder","selectFolderIcon","iconInputElement","saveStopItemOnRoute","saveStopItemOnLocation","saveRouteOnDetailsPage","saveRouteOnRoute","removeItemOnFolderEditor","moveItemOnFolderEditor","search","openSearch","closeSearch","typeTextIntoInput","deleteCharFromInout","emptyInput","openSystemKeyboard","switchSearchTypeFilter","storage","openStorage","closeStorage","dataUsage","openDataUsage","initializeDataUsage","closeDataUsage","personalSchedule","openPersonalScheduleManager","closePersonalScheduleManager","openPersonalScheduleCreator","closePersonalScheduleCreator","createFormulatedPersonalSchedule","switchPersonalScheduleCreatorDay","openPersonalScheduleEditor","closePersonalScheduleEditor","switchPersonalScheduleEditorDay","saveEditedPersonalSchedule","settings","openSettings","closeSettings","openSettingsOptions","closeSettingsOptions","settingsOptionsHandler","downloadExportFile","openFileToImportData","viewCommitOfCurrentVersion","showPromptToAskForPersistentStorage","notification","openNotificationScheduleManager","closeNotificationScheduleManager","openRegisterNotification","closeRegisterNotification","saveFormulatedRegisterNotification","openScheduleNotification","closeScheduleNotification","scheduleNotificationForStopItemOnRoute","scheduleNotificationForStopItemOnLocation","cancelNotificationOnNotificationScheduleManager","generateElementOfItem","contentLength","_initializeFolderManagerField","ListElement","listFoldersWithContent","initializeFolderManagerField","integrateRouteDetails","_integrateRouteDetails","Id","findRoute","SemiTimeTable","getSemiTimeTable","TimeTable","getTimeTable","Provider","getProvider","timeTableRules","thisRouteGoFirstBusTime","parseTimeCode","goFirstBusTime","thisRouteGoLastBusTime","goLastBusTime","thisRouteBackFirstBusTime","backFirstBusTime","thisRouteBackLastBusTime","backLastBusTime","thisRouteGoFirstBusTimeOnHoliday","holidayGoFirstBusTime","thisRouteGoLastBusTimeOnHoliday","holidayGoLastBusTime","thisRouteBackFirstBusTimeOnHoliday","holidayBackFirstBusTime","thisRouteBackLastBusTimeOnHoliday","holidayBackLastBusTime","rushHourWindow","peakHeadway","offRushHourWindow","offPeakHeadway","rushHourWindowOnHoliday","holidayPeakHeadway","offRushHourWindowOnHoliday","holidayOffPeakHeadway","go","weekday","first","last","holiday","back","realSequence","getTimeTableRules","calendar","calendarDays","d_0","day","code","d_1","d_2","d_3","d_4","d_5","d_6","calendarDayQuantity","calendarEventGroups","calendarEventQuantity","thisWeekOrigin","getThisWeekOrigin","indexOf","DateType","dayOfWeek","dateValueToDayOfWeek","DateValue","thisDayOrigin","offsetDate","thisPeriodStartTime","StartTime","thisPeriodStartTimeDateObject","hours","minutes","thisPeriodEndTime","EndTime","thisPeriodEndTimeDateObject","thisPeriodDurationInMinutes","minWindow","parseInt","LongHeadway","maxWindow","LowHeadway","averageWindow","headwayQuantity","violateRules","thisHeadwayDate","getTime","date","dateString","duration","deviation","thisDepartureTime","DepartureTime","generateCalendarFromTimeTables","thisProvider","providerId","findProvider","nameZh","ticketPriceDescriptionZh","nameZn","phoneInfo","email","FolderEditorField","FolderEditorHeadElement","LeftButtonElement","FolderEditorBodyElement","FolderEditorGroupsElement","OpenFolderIconSelectorElement","FolderContentElement","type","context","main","endPoints","destination","departure","direction","_initializeFolderEditorField","folderID","content","removeAttribute","thisItemElement","updateFolderEditorField","getFolder","listFolderContent","initializeFolderEditorField","itemID","itemElement","removeFromFolder","updateFolderContentIndex","previousSibling","previousElementSibling","parentNode","insertBefore","nextSibling","nextElementSibling","updateFolder"],"sourceRoot":""}