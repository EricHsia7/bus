"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[796,6675],{7123(t,e,n){n.d(e,{R:()=>_});var r=n(467),a=n(7183),o=n(6483),i=n(6802),u=n(7810),s=n(2063),f=n(8011),l=n(4293),p=n(1932),d=n(424),c=n(2303),h=n(6788),y=n(3459),v=n(1531);function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return m(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){u=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e,n,r,a){return S.apply(this,arguments)}function S(){return(S=(0,r.A)(function*(t,e,n,r,m){(0,h.Mf)(m,"getRoute_0",0,!1),(0,h.Mf)(m,"getRoute_1",0,!1),(0,h.Mf)(m,"getStop_0",0,!1),(0,h.Mf)(m,"getStop_1",0,!1),(0,h.Mf)(m,"getLocation_0",0,!1),(0,h.Mf)(m,"getLocation_1",0,!1),(0,h.Mf)(m,"getSegmentBuffers_0",0,!1),(0,h.Mf)(m,"getSegmentBuffers_1",0,!1),(0,h.Mf)(m,"getEstimateTime_0",0,!1),(0,h.Mf)(m,"getEstimateTime_1",0,!1),(0,h.Mf)(m,"getBusEvent_0",0,!1),(0,h.Mf)(m,"getBusEvent_1",0,!1),(0,h.Mf)(m,"getBusData_0",0,!1),(0,h.Mf)(m,"getBusData_1",0,!1);var _=yield(0,l.a)(m,!0),S=yield(0,d.T)(m),b=yield(0,f.g)(m,0),w=yield(0,f.g)(m,1),I=yield(0,f.g)(m,2),D=yield(0,p.L)(m),$=yield(0,s.K)(m),B=yield(0,u.J)(m),P=yield(0,i.d)(m),O=yield(0,o.Io)(n,r),M=(0,c.w_)(B,P,_,t,e),A=!1,R={};D.hasOwnProperty(`r_${t}`)&&(A=!0,R=D[`r_${t}`]);var C,L=(0,y.Js)("time_formatting_mode"),k=[],x=[],E=g($);try{for(E.s();!(C=E.n()).done;){var T=C.value,Q={},j=T.RouteID;if([t,10*t].includes(j)||e.includes(j)){Q.status=(0,c.$Q)(null==T?void 0:T.EstimateTime,L);var N=`s_${T.StopID}`,q={};if(!S.hasOwnProperty(N))continue;q=S[N],Q.id=T.StopID,Q.sequence=q.seqNo,Q.goBack=q.goBack;var U=`l_${q.stopLocationId}`,z={};if(!b.hasOwnProperty(U))continue;z=b[U],Q.name=z.n,Q.overlappingRoutes=z.r.filter(function(e){return e!==t}).map(function(t){var e=`r_${t}`;if(_.hasOwnProperty(e)){var n=_[e];return{name:n.n,RouteEndPoints:{RouteDeparture:n.dep,RouteDestination:n.des,text:`${n.dep} ↔ ${n.des}`,html:`<span>${n.dep}</span><span>↔</span><span>${n.des}</span>`},RouteID:n.id,PathAttributeId:n.pid}}return null}).filter(function(t){return null!==t}),Q.position={longitude:z.lo,latitude:z.la},x.push({latitude:z.la,longitude:z.lo,id:T.StopID});var J=z.g,F=[];I.hasOwnProperty(J)&&(F=I[J]);var G,K=[],V=g(F);try{for(V.s();!(G=V.n()).done;){var Z=`ml_${G.value.hash}`;if(w.hasOwnProperty(Z)){var H=w[Z],W={name:H.n,distance:0|(0,a.aV)(H.la[0],H.lo[0],z.la,z.lo),hash:H.hash};K.push(W)}}}catch(t){V.e(t)}finally{V.f()}K.sort(function(t,e){return t.distance-e.distance}),Q.nearbyLocations=K;var X,Y=[],tt=g(z.s);try{for(tt.s();!(X=tt.n()).done;){var et=`s_${X.value}`;M.hasOwnProperty(et)&&Y.push(M[et].map(function(t){return(0,c.s$)(t)}))}}catch(t){tt.e(t)}finally{tt.f()}Q.buses=Y.flat().sort(function(t,e){return t.index-e.index});var nt=[];O.hasOwnProperty(N)&&(nt=O[N]),Q.busArrivalTimes=nt;var rt=!1,at=!1,ot=!1,it=!1;if(A){var ut=`g_${Q.goBack}`,st=[];R.hasOwnProperty(ut)?st=R[ut]:"1"===Q.goBack&&(it=!0,st=R.g_0);var ft,lt=g(st);try{for(lt.s();!(ft=lt.n()).done;){var pt=ft.value;pt.OriginStopID!==T.StopID&&pt.DestinationStopID!==T.StopID||(rt=!0),it?(pt.OriginStopID===T.StopID&&(ot=!0),pt.DestinationStopID===T.StopID&&(at=!0)):(pt.OriginStopID===T.StopID&&(at=!0),pt.DestinationStopID===T.StopID&&(ot=!0))}}catch(t){lt.e(t)}finally{lt.f()}}Q.segmentBuffer={isSegmentBuffer:rt,isStartingPoint:at,isEndingPoint:ot},k.push(Q)}}}catch(t){E.e(t)}finally{E.f()}k.sort(function(t,e){return t.sequence-e.sequence});for(var dt=(0,v.uQ)(x,450),ct=!1,ht=!1,yt={},vt=0,gt={},mt=k.length,_t=0;_t<mt;_t++){var St=k[_t],bt=k[_t+1]||St,wt=0;if(St.buses.length>0&&St.buses[0].onThisRoute){var It=[St.buses[0].position.longitude,St.buses[0].position.latitude],Dt=It[0],$t=It[1],Bt=[St.position.longitude,St.position.latitude],Pt=Bt[0],Ot=Bt[1],Mt=[bt.position.longitude,bt.position.latitude],At=Mt[0],Rt=Mt[1];if((Dt-Pt)*(At-Dt)+($t-Ot)*(Rt-$t)>=0){var Ct=Math.hypot(Dt-Pt,$t-Ot),Lt=Math.hypot(Dt-At,$t-Rt);wt=Math.max(0,Math.min(Ct/(Ct+Lt),1))}}St.progress=wt,St.segmentBuffer.isStartingPoint&&(ct=!0),St.segmentBuffer.isEndingPoint&&ct&&(ht=!0),ct&&!ht&&(St.segmentBuffer.isSegmentBuffer=!0),ct&&ht&&(ct=!1,ht=!1);var kt=!1;null!==dt&&dt.id===St.id&&(kt=!0),St.nearest=kt;var xt=`g_${St.goBack}`||"g_0";yt.hasOwnProperty(xt)||(yt[xt]=[],gt[xt]=0,vt+=1),yt[xt].push(St),gt[xt]+=1}var Et=_[`r_${t}`],Tt={groupedItems:yt,groupQuantity:vt,itemQuantity:gt,RouteName:Et.n,RouteEndPoints:{RouteDeparture:Et.dep,RouteDestination:Et.des},dataUpdateTime:(0,h.Zt)(m),RouteID:t,PathAttributeId:e};return(0,h.LQ)(m),(0,h.gC)(m),Tt})).apply(this,arguments)}},8134(t,e,n){n.d(e,{F6:()=>y,GU:()=>I,Rk:()=>c,dD:()=>S});var r=n(467),a=n(2129),o=n(8024),i=n(4781),u=n(9734),s=n(8011),f=n(4293),l=n(6788);function p(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return d(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){u=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function c(t){return h.apply(this,arguments)}function h(){return(h=(0,r.A)(function*(t){var e,n=(0,o.zx)(),r=yield(0,f.a)(n,!0),a=`r_${t}`;return!!r.hasOwnProperty(a)&&(e=r[a],(0,l.LQ)(n),(0,l.gC)(n),e)})).apply(this,arguments)}function y(t){return v.apply(this,arguments)}function v(){return(v=(0,r.A)(function*(t){var e=(0,o.zx)(),n=yield(0,f.a)(e,!0),r=[];for(var a in n){var i=n[a];String(i.pid).indexOf(t)>-1&&r.push(i)}return(0,l.LQ)(e),(0,l.gC)(e),r})).apply(this,arguments)}var g={},m=[],_=!1;function S(){return b.apply(this,arguments)}function b(){return(b=(0,r.A)(function*(){if(!_){var t=(0,o.zx)(),e=yield(0,f.a)(t,!0),n=yield(0,s.g)(t,1),r=yield(0,u.j)(t,!0);(0,l.LQ)(t),(0,l.gC)(t);var a={},d=[],c=0;for(var h in e){var y=e[h],v={id:y.id,pid:y.pid,dep:y.dep,des:y.des,n:y.n,hash:"",lo:"",la:"",r:"",s:"",type:0};d.push(v);var S,b=p((0,i.B5)(`${v.n.toLowerCase()}${v.dep.toLowerCase()}${v.des.toLowerCase()}`,!0));try{for(b.s();!(S=b.n()).done;){var w=`u_${S.value}`;a.hasOwnProperty(w)||(a[w]=[]),a[w].push(c)}}catch(t){b.e(t)}finally{b.f()}c+=1}for(var I in n){var D=n[I],$={id:D.id,n:D.n,lo:D.lo,la:D.la,r:D.r,s:D.s,hash:D.hash,dep:"",des:"",pid:[],type:1};d.push($);var B,P=p((0,i.B5)($.n.toLowerCase(),!0));try{for(P.s();!(B=P.n()).done;){var O=`u_${B.value}`;a.hasOwnProperty(O)||(a[O]=[]),a[O].push(c)}}catch(t){P.e(t)}finally{P.f()}c+=1}for(var M in r){var A=r[M],R={id:A.BusId,pid:[],dep:"",des:"",n:A.CarNum,hash:"",lo:"",la:"",r:"",s:"",type:2};d.push(R);var C,L=p((0,i.B5)(R.n.toLowerCase(),!0));try{for(L.s();!(C=L.n()).done;){var k=`u_${C.value}`;a.hasOwnProperty(k)||(a[k]=[]),a[k].push(c)}}catch(t){L.e(t)}finally{L.f()}c+=1}g=a,m=d,_=!0}})).apply(this,arguments)}function w(t,e){var n,r=0,a=0,o=p(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;r+=t.indexOf(i,a)-a,a+=1}}catch(t){o.e(t)}finally{o.f()}return t===e&&(r=10*Math.abs(r)),r}function I(t,e,n){if(!_)return[];var r,o=t.toLowerCase(),u=(0,i.B5)(o,!0),s=(0,i.B5)(o,!1),f=[],l=p(u);try{for(l.s();!(r=l.n()).done;){var d=`u_${r.value}`;g.hasOwnProperty(d)&&f.push(g[d])}}catch(t){l.e(t)}finally{l.f()}f.sort(function(t,e){return t.length-e.length});var c=f.length-1,h=[];if(0===c&&(h=f[0]),c>0)for(var y=0;y<c;y++){var v=f[y],S=f[y+1];h=0===y?(0,a._N)(v,S):(0,a._N)(h,S)}var b=[],I=0,D=new Set;if(-1===e||2===e){var $,B=m.filter(function(t){return t.n===o&&2===t.type}),P=p(B);try{for(P.s();!($=P.n()).done;){var O=$.value;if(b.push({item:O,score:1/0}),D.add(O.id),(I+=1)>=n)break}}catch(t){P.e(t)}finally{P.f()}}if(I<n){var M,A=p(h);try{for(A.s();!(M=A.n()).done;){var R=M.value,C=m[R];if((-1===e||e===C.type)&&!D.has(C.id)){var L=w(s,(0,i.B5)(C.n,!1));if(!(I<n))break;b.push({item:C,score:L}),I+=1}}}catch(t){A.e(t)}finally{A.f()}}return b.sort(function(t,e){return e.score-t.score}),b}}}]);
//# sourceMappingURL=796.efe51c24.js.map