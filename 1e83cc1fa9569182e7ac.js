"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[806],{904:(e,t,n)=>{n.d(t,{AE:()=>S,BM:()=>I,WR:()=>y,Z_:()=>b,gO:()=>_,kr:()=>g,l$:()=>w});var a=n(8024),o=n(3648),r=n(4927),i=n(6052),c=n(9333),s=n(8379),d=n(7908),u=n(5693),l=n(7891),f=n(5009),v=n(6104),p=100,h=(new Date).getTime(),m=["Home"];function y(e){var t=m.length;m[t-1]!==e&&m.push(e)}function g(e){if(m.indexOf(e)>-1){var t=m.length;m[t-1]===e&&m.pop()}}function b(){var e=m.length;if(e>1)switch(m[e-2]){case"Home":case"FolderIconSelector":case"Location":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":default:break;case"FolderCreator":(0,i.z1)();break;case"FolderEditor":(0,c.I6)();break;case"FolderManager":(0,s.m)();break;case"Search":(0,f.Bb)();break;case"Settings":(0,v.os)();break;case"PersonalScheduleManager":(0,l.Z)();break;case"PersonalScheduleEditor":(0,u.Xy)();break;case"Bus":(0,r.F)();break;case"RegisterNotification":(0,d.hy)()}}function w(){var e=m.length;if(e>1){var t=m[e-2];switch(m.pop(),t){case"Home":case"FolderIconSelector":case"Location":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":default:break;case"FolderCreator":(0,i.pd)();break;case"FolderEditor":(0,c.uy)();break;case"FolderManager":(0,s.g)();break;case"Search":(0,f.rf)();break;case"Settings":(0,v.Ow)();break;case"PersonalScheduleManager":(0,l.z)();break;case"PersonalScheduleEditor":(0,u.bF)();break;case"Bus":(0,r.$)();break;case"RegisterNotification":(0,d.XG)()}}}function I(){var e=0;(0,a.t9)()&&(e=-1*(window.outerHeight-window.innerHeight)/2),(0,o.bv)(".f svg.g").style.setProperty("--h","".concat(e,"px"))}function S(e){function t(){var t=(0,o.bv)(".f");t.classList.add("i"),t.addEventListener("animationend",(function(){t.setAttribute("displayed","false"),t.classList.remove("i"),"function"==typeof e&&e()}),{once:!0})}var n=(new Date).getTime();n-h<p?setTimeout(t,Math.max(1,n-h)):t()}function _(e){var t=0,n=0,a=window.innerWidth,o=window.innerHeight;switch(e){case"window":t=a,n=o;break;case"head":t=a,n=55;break;case"head-one-button":t=a-55,n=55;break;case"head-two-button":t=a-110,n=55;break;case"route-details-canvas":t=a-20-20,n=1440;break;case"route-bus-arrival-time-chart":t=a-45-15-20,n=75;break;case"location-bus-arrival-time-chart":t=a-30-20,n=75;break;default:t=0,n=0}return{width:t,height:n}}},3030:(e,t,n)=>{n.d(t,{Ms:()=>fe,dM:()=>ve,eS:()=>le,s_:()=>K,so:()=>ue,uj:()=>ee});var a=n(2757),o=n(4537),r=n(6788),i=n(3459),c=n(8024),s=n(7968),d=n(3648),u=n(5767),l=n(904),f=n(9119),v=n(5314),p=n(5579),h=n(9566),m=n(4636);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function b(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}var w=(0,d.bv)(".j"),I=(0,d.aI)(w,".k"),S=(0,d.aI)(I,".l"),_=(0,d.aI)(w,".m"),A=(0,d.aI)(I,".n"),k=(0,d.aI)(A,".o"),T=(0,d.aI)(I,".p"),M=(0,d.aI)(T,".q"),L=(0,d.aI)(I,".r .s"),x={},E=!0,P=!1,D=0,R=0,F=0,B={},O=0,H=!1,C=1e4,j=15e3,Z=5e3,N=15e3,U=!0,$=!1,z=0,q=0,W=!1,G="",Q=-1,Y=-1,J=!1,X="",V=20;function K(){_.addEventListener("touchstart",(function(){D=Math.round(_.scrollLeft/O)}),{passive:!0}),_.addEventListener("scroll",(function(e){H=!0;var t=e.target.scrollLeft/O;R=t>D?D+1:D-1;var n=B["g_".concat(D)]||{width:0,offset:0},a=B["g_".concat(R)]||{width:0,offset:0},o=n.width+(a.width-n.width)*Math.abs(t-D),r=-1*(n.offset+(a.offset-n.offset)*Math.abs(t-D))+.5*O-.5*o;te(F,r,o-V,t),t===R&&(D=Math.round(_.scrollLeft/O),H=!1)}),{passive:!0})}function ee(){var e=(0,l.gO)("window"),t=e.width,n=e.height;w.style.setProperty("--t","".concat(t,"px")),w.style.setProperty("--u","".concat(n,"px"))}function te(e,t,n,a){_.style.setProperty("--v",e.toString()),M.style.setProperty("--w",(n/10).toString()),k.style.setProperty("--x","".concat(t.toFixed(5),"px")),k.style.setProperty("--y",a.toFixed(5))}function ne(){var e=(new Date).getTime();W?(Y=-1+(0,r._M)(G),Q=.7*(Y-Q)):(Y=-1*Math.min(1,Math.max(0,Math.abs(e-z)/N)),Q=Y),L.style.setProperty("--z",Q.toString()),window.requestAnimationFrame((function(){$&&ne()}))}function ae(){var e=(0,c.zx)("i"),t=document.createElement("div");return t.classList.add("_"),t.id=e,t.setAttribute("stretched","false"),t.innerHTML='<div class="aa"><div class="ba"><div class="ca" code="-1"></div><div class="da" code="-1"></div></div><div class="ea"></div><div class="fa"></div><div class="ga"><div class="ha"><div class="ia" code="0"></div><div class="ja" code="0"></div></div><div class="ka" onclick="bus.location.stretchLocationItemBody(\''.concat(e,"')\">").concat((0,o.Z)("keyboard_arrow_down"),'</div><div class="la"></div></div></div><div class="ma" displayed="false"><div class="na"><div class="oa" highlighted="true" type="tab" onclick="bus.location.switchLocationBodyTab(\'').concat(e,'\', 0)" code="0"><div class="pa">').concat((0,o.Z)("directions_bus"),'</div>公車</div><div class="oa" highlighted="false" type="tab" onclick="bus.location.switchLocationBodyTab(\'').concat(e,'\', 1)" code="1"><div class="pa">').concat((0,o.Z)("departure_board"),'</div>抵達時間</div><div class="oa" highlighted="false" type="save-to-folder" onclick="bus.folder.openSaveToFolder(\'stop-on-location\', [\'').concat(e,'\', null, null])"><div class="pa">').concat((0,o.Z)("folder"),'</div>儲存至資料夾</div><div class="oa" highlighted="false" type="schedule-notification" onclick="bus.notification.openScheduleNotification(\'stop-on-location\', [\'').concat(e,'\', null, null, null])" enabled="true"><div class="pa">').concat((0,o.Z)("notifications"),'</div>設定到站通知</div></div><div class="qa" displayed="true"></div><div class="ra" displayed="false"></div></div>'),{element:t,id:e}}function oe(){var e=document.createElement("div");return e.classList.add("wa"),{element:e,id:""}}function re(){var e=document.createElement("div");return e.classList.add("xa"),e.innerHTML='<div class="ya"></div><div class="za"></div>',{element:e,id:""}}function ie(e,t,n){function a(e,a,r){function i(e,t,n){var a=e.getBoundingClientRect(),o=a.top,r=a.left,i=a.bottom,c=a.right,s=window.innerWidth,u=window.innerHeight,l=(0,d.aI)(e,".ha"),f=(0,d.aI)(l,".ia"),v=(0,d.aI)(l,".ja");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,n&&i>0&&o<u&&c>0&&r<s?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,v.classList.remove("_a")}),{once:!0}),v.classList.add("_a")):(v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text)}function s(e,t,n){var a=e.getBoundingClientRect(),o=a.top,r=a.left,i=a.bottom,c=a.right,s=window.innerWidth,u=window.innerHeight,l=(0,d.aI)(e,".ba"),f=(0,d.aI)(l,".ca"),v=(0,d.aI)(l,".da");f.setAttribute("code",t.ranking.code.toString()),f.innerText=t.ranking.text,n&&i>0&&o<u&&c>0&&r<s?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text,v.classList.remove("ab")}),{once:!0}),v.classList.add("ab")):(v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text)}function u(e,t){(0,d.aI)(e,".ea").innerText=t.route_direction}function l(e,t){(0,d.aI)(e,".fa").innerText=t.route_name}function f(e,t){(0,d.aI)(e,".qa").innerHTML=0===t.buses.length?'<div class="bb">目前沒有公車可顯示</div>':t.buses.map((function(e){return'<div class="cb" on-this-route="'.concat(e.onThisRoute,'"><div class="db"><div class="eb">').concat((0,o.Z)("directions_bus"),'</div><div class="fb">').concat(e.carNumber,'</div></div><div class="gb"><div class="hb">路線：').concat(e.RouteName,'</div><div class="ib">狀態：').concat(e.status.text,'</div><div class="jb">類型：').concat(e.type,"</div></div></div>")})).join("")}function v(e,t){(0,d.aI)(e,".ra").innerHTML=0===t.busArrivalTimes.length?'<div class="kb">目前沒有抵達時間可顯示</div>':t.busArrivalTimes.map((function(e){return'<div class="lb"><div class="mb"><div class="nb">'.concat((0,o.Z)("calendar_view_day"),'</div><div class="ob">').concat(e.personalSchedule.name,'</div><div class="pb">週').concat((0,p.kd)(e.day).name," ").concat((0,p.pn)(e.personalSchedule.period.start)," - ").concat((0,p.pn)(e.personalSchedule.period.end),'</div></div><div class="qb">').concat(e.chart,"</div></div>")})).join("")}function y(e,t){t&&e.setAttribute("stretched","false")}function g(e,t){e.setAttribute("animation",(0,c.xZ)(t))}function b(e,t){e.setAttribute("skeleton-screen",(0,c.xZ)(t))}function w(e,t){var n=(0,d.aI)(e,".ma"),a=(0,d.aI)(n,".na"),o=(0,d.aI)(a,'.oa[type="save-to-folder"]');o.setAttribute("onclick","bus.folder.openSaveToFolder('stop-on-location', ['".concat(e.id,"', ").concat(t.stopId,", ").concat(t.routeId,"])")),(0,h.LH)("stop",t.stopId).then((function(e){o.setAttribute("highlighted",(0,c.xZ)(e))}))}function I(e,t){var n=(0,d.aI)(e,".ma"),a=(0,d.aI)(n,".na"),o=(0,d.aI)(a,'.oa[type="schedule-notification"]');o.setAttribute("onclick","bus.notification.openScheduleNotification('stop-on-location', ['".concat(e.id,"', ").concat(t.stopId,", ").concat(t.routeId,", ").concat(t.status.time,"])"));var r=(0,m.Zc)(t.stopId);o.setAttribute("highlighted",(0,c.xZ)(r))}null===r?(i(e,a,n),s(e,a,n),u(e,a),l(e,a),f(e,a),v(e,a),y(e,t),g(e,n),b(e,t),w(e,a),I(e,a)):(a.status.time!==r.status.time&&(i(e,a,n),I(e,a)),r.ranking.number===a.ranking.number&&r.ranking.code===a.ranking.code||s(e,a,n),r.stopId!==a.stopId&&(u(e,a),l(e,a),w(e,a)),(0,c.hw)(r.buses,a.buses)||f(e,a),(0,c.hw)(r.busArrivalTimes,a.busArrivalTimes)||v(e,a),n!==E&&g(e,n),t!==P&&(y(e,t),b(e,t)))}function r(e,a,r){function i(e,t){(0,d.aI)(e,".ya").innerHTML=(0,o.Z)(t.icon)}function s(e,t){(0,d.aI)(e,".za").innerHTML=t.value}function u(e,t){e.setAttribute("animation",(0,c.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,c.xZ)(t))}null===r?(i(e,a),s(e,a),u(e,n),l(e,t)):((0,c.hw)(r.icon,a.icon)||i(e,a),(0,c.hw)(r.value,a.value)||s(e,a),n!==E&&u(e,n),t!==P&&l(e,t))}var i=(0,l.gO)("window"),u=i.width,f=i.height,v=e.groupQuantity,y=e.itemQuantity,g=e.groupedItems,b=e.groups;F=v,O=u;for(var w=0,I=0;I<v;I++){var M=(0,s.q_)(b["g_".concat(I)].name,500,"17px",'"Noto Sans TC", sans-serif')+V;B["g_".concat(I)]={width:M,offset:w},w+=M}var L=-1*B["g_".concat(D)].offset+.5*O-.5*B["g_".concat(D)].width;H||te(F,L,B["g_".concat(D)].width-V,D),S.innerHTML="<span>".concat(e.LocationName,"</span>"),S.setAttribute("animation",(0,c.xZ)(n)),S.setAttribute("skeleton-screen",(0,c.xZ)(t)),A.setAttribute("animation",(0,c.xZ)(n)),A.setAttribute("skeleton-screen",(0,c.xZ)(t)),T.setAttribute("skeleton-screen",(0,c.xZ)(t));var R,C=(0,d.jg)(_,".sa").length;if(v!==C){var j=C-v;if(j<0)for(var Z=0;Z<Math.abs(j);Z++){var N=(R=void 0,(R=document.createElement("div")).classList.add("sa"),R.innerHTML='<div class="ta"><div class="ua"></div></div><div class="va"></div>',{element:R,id:""});_.appendChild(N.element);var U=oe();k.appendChild(U.element)}else for(var $=(0,d.jg)(_,".sa"),z=(0,d.jg)(k,".wa"),q=0;q<Math.abs(j);q++){var W=C-1-q;$[W].remove(),z[W].remove()}}for(var G=(0,d.jg)(_,".sa"),Q=0;Q<v;Q++){var Y="g_".concat(Q),J=G[Q],X=(0,d.jg)(J,".va ._").length;if(y[Y]!==X){var K=X-y[Y];if(K<0)for(var ee=(0,d.aI)(J,".va"),ne=0;ne<Math.abs(K);ne++){var ie=ae();ee.appendChild(ie.element)}else for(var ce=(0,d.jg)(J,".va ._"),se=0;se<Math.abs(K);se++){ce[X-1-se].remove()}}var de=(0,d.jg)((0,d.jg)(_,".sa")[Q],".ta .ua .xa").length,ue=b[Y].properties.length;if(ue!==de){var le=de-ue;if(le<0)for(var fe=(0,d.aI)(J,".ta"),ve=(0,d.aI)(fe,".ua"),pe=0;pe<Math.abs(le);pe++){var he=re();ve.appendChild(he.element)}else for(var me=(0,d.aI)(J,".ta"),ye=(0,d.aI)(me,".ua"),ge=0;ge<Math.abs(le);ge++){var be=de-1-ge;(0,d.jg)(ye,".xa")[be].remove()}}}for(var we=0;we<v;we++){var Ie="g_".concat(we),Se=(0,d.jg)(k,".wa")[we];Se.innerHTML="<span>".concat(b[Ie].name,"</span>"),Se.style.setProperty("--rb","".concat(B[Ie].width,"px")),Se.style.setProperty("--sb",we.toString());for(var _e=(0,d.jg)(_,".sa")[we],Ae=b[Ie].properties.length,ke=0;ke<Ae;ke++){var Te=b[Ie].properties[ke],Me=(0,d.jg)(_e,".ta .ua .xa")[ke];if(x.hasOwnProperty("groups"))if(x.groups.hasOwnProperty(Ie))if(x.groups[Ie].properties[ke])r(Me,Te,x.groups[Ie].properties[ke]);else r(Me,Te,null);else r(Me,Te,null);else r(Me,Te,null)}for(var Le=0;Le<y[Ie];Le++){var xe=(0,d.jg)(_e,".va ._")[Le],Ee=g[Ie][Le];if(x.hasOwnProperty("groupedItems"))if(x.groupedItems.hasOwnProperty(Ie))if(x.groupedItems[Ie][Le])a(xe,Ee,x.groupedItems[Ie][Le]);else a(xe,Ee,null);else a(xe,Ee,null);else a(xe,Ee,null)}}x=e,E=n,P=t}function ce(){return se.apply(this,arguments)}function se(){var e;return e=function*(){var e=(0,i.Js)("playing_animation"),t=(0,i.Js)("refresh_interval"),n=(0,l.gO)("location-bus-arrival-time-chart");U=t.dynamic,j=t.baseInterval,W=!0,G=(0,c.zx)("r"),L.setAttribute("refreshing","true");var o=yield(0,a.R)(X,n.width,n.height,G);ie(o,!1,e);var r=0;U&&(r=yield(0,u.wz)()),z=(new Date).getTime(),q=U?Math.max(z+Z,o.dataUpdateTime+j/r):z+j,N=Math.max(Z,q-z),W=!1,L.setAttribute("refreshing","false")},se=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){b(r,a,o,i,c,"next",e)}function c(e){b(r,a,o,i,c,"throw",e)}i(void 0)}))},se.apply(this,arguments)}function de(){ce().then((function(){$?setTimeout((function(){de()}),Math.max(Z,q-(new Date).getTime())):J=!1})).catch((function(e){console.error(e),$?((0,f.a)("（地點）發生網路錯誤，將在".concat(C/1e3,"秒後重試。"),"error"),setTimeout((function(){de()}),C)):J=!1}))}function ue(e){(0,l.WR)("Location"),(0,v.XK)("location",e),X=e,D=0,w.setAttribute("displayed","true"),_.scrollLeft=0,function(){for(var e=(0,i.Js)("playing_animation"),t=(0,l.gO)("window"),n=(t.width,t.height),a={g_0:Math.floor(n/50)+5,g_1:Math.floor(n/50)+5},o={},r=0;r<2;r++){var c="g_".concat(r);o[c]=[];for(var s=0;s<a[c];s++)o[c].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}ie({groupedItems:o,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""}]}},itemQuantity:a,LocationName:"載入中",dataUpdateTime:0},!0,e)}(),$||($=!0,J?ce():(J=!0,de()),Q=-1,Y=-1,ne()),(0,l.Z_)()}function le(){w.setAttribute("displayed","false"),$=!1,Q=-1,Y=-1,(0,l.l$)()}function fe(e){var t=(0,d.aI)(_,".sa .va ._#".concat(e)),n=(0,d.aI)(t,".ma");"true"===t.getAttribute("stretched")?("true"===t.getAttribute("animation")?n.addEventListener("transitionend",(function(){n.setAttribute("displayed","false")}),{once:!0}):n.setAttribute("displayed","false"),t.setAttribute("stretched","false")):(n.setAttribute("displayed","true"),t.setAttribute("stretched","true"))}function ve(e,t){var n,a=(0,d.aI)(_,".sa .va ._#".concat(e)),o=(0,d.aI)(a,".ma"),r=(0,d.aI)(o,".na"),i=y((0,d.jg)(r,'.oa[highlighted="true"][type="tab"]'));try{for(i.s();!(n=i.n()).done;){n.value.setAttribute("highlighted","false")}}catch(e){i.e(e)}finally{i.f()}switch((0,d.aI)(r,'.oa[code="'.concat(t,'"]')).setAttribute("highlighted","true"),t){case 0:(0,d.aI)(a,".qa").setAttribute("displayed","true"),(0,d.aI)(a,".ra").setAttribute("displayed","false");break;case 1:(0,d.aI)(a,".qa").setAttribute("displayed","false"),(0,d.aI)(a,".ra").setAttribute("displayed","true")}}},4572:(e,t,n)=>{n.d(t,{default:()=>ge});var a=n(5009),o=n(5767),r=n(8925),i=n(1531),c=n(4690),s=n(4474),d=n(8332),u=n(3030),l=n(9469),f=n(9856),v=n(9566),p=n(6082),h=n(3251),m=n(6104),y=n(6166),g=n(3459),b=n(904),w=n(3648),I=n(3041),S=n(8379),_=n(9333),A=n(9930),k=n(972),T=n(8024),M=n(4781),L=n(4537),x=n(9119);function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function D(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}var R="",F=(0,w.bv)(".tb"),B=(0,w.bv)(".ub"),O=(0,w.bv)(".vb");function H(e){var t=(0,T.zx)("i"),n=document.createElement("div");return n.id=t,n.classList.add("wb"),n.setAttribute("onclick","bus.folder.selectFolderIcon('".concat(e,"', '").concat(R,"')")),n.innerHTML=(0,L.Z)(e),{element:n,id:t}}function C(){var e;return e=function*(){var e=(0,w.aI)(O,".xb .yb");e.innerHTML="";var t,n=(0,T.zx)("r"),a=E(yield(0,A.z)(n));try{for(a.s();!(t=a.n()).done;){var o=H(t.value);e.appendChild(o.element)}}catch(e){a.e(e)}finally{a.f()}},C=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){D(r,a,o,i,c,"next",e)}function c(e){D(r,a,o,i,c,"throw",e)}i(void 0)}))},C.apply(this,arguments)}function j(e){var t=(0,w.aI)(O,".xb .zb"),n=(0,w.aI)(O,".xb .yb");if(t.innerHTML="",!(0,M.iO)(e)){var a,o=(0,k.U)(e,100),r=E(o);try{for(r.s();!(a=r.n()).done;){var i=H(a.value.item);t.appendChild(i.element)}}catch(e){r.e(e)}finally{r.f()}t.setAttribute("displayed",o.length>0?"true":"false"),n.setAttribute("displayed",o.length>0?"false":"true")}}function Z(){(0,b.kr)("FolderIconSelector"),O.setAttribute("displayed","false")}var N={noto_sans_tc:!1,material_symbols:!1};function U(e,t){if(!1===N[t]){var n=document.createElement("link");n.setAttribute("href",e),n.setAttribute("rel","stylesheet"),document.head.appendChild(n),N[t]=!0}}var $=n(6052),z=n(540),q=n(7183),W=n(5579);function G(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}var Q=(0,w.bv)(".lc"),Y=(0,w.aI)(Q,".mc"),J=(0,w.aI)(Y,".nc"),X=(0,w.aI)(Y,".oc"),V=(0,w.aI)(X,'.pc[name="total-data-usage"] .qc'),K=(0,w.aI)(X,'.pc[name="start-time"] .qc'),ee=(0,w.aI)(X,'.pc[name="end-time"] .qc');function te(){var e;return e=function*(){console.log(0);var e=(0,b.gO)("window");console.log(1);var t=e.width;console.log(2);var n=Math.min(5/18*t,.33*e.height);console.log(3);var a=yield(0,r.LN)(t,n,20);console.log(4),V.innerText=(0,q.tH)(a.stats.sum),console.log(5),K.innerText=(0,W.$T)(a.period.start,"YYYY-MM-DD"),console.log(6),ee.innerText=(0,W.$T)(a.period.end,"YYYY-MM-DD"),console.log(7),J.innerHTML=a.chart,console.log(8)},te=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){G(r,a,o,i,c,"next",e)}function c(e){G(r,a,o,i,c,"throw",e)}i(void 0)}))},te.apply(this,arguments)}var ne=n(2994),ae=n(7891),oe=n(8380),re=n(5693),ie=n(6483),ce=n(4927),se=n(5314),de=n(6091),ue=n(7908),le=n(4636),fe=n(752),ve=n(2174),pe=n(9009),he=n(7599),me=!1,ye=!1;window.bus={initialize:function(){!1===me&&(me=!0,(0,b.BM)(),(0,g.Yq)().then((function(){var e=(0,w.bv)(".rc .sc .tc");(0,de.Q)(e);var t=(0,w.bv)(".rc .sc .uc");(0,z.F)(t),(0,h.A)().then((function(e){"ok"===e&&(0,he.P)().then((function(){(0,c.S5)(),(0,u.s_)(),(0,c.aB)(),(0,u.uj)(),(0,f.mr)(),window.addEventListener("resize",(function(){(0,c.aB)(),(0,u.uj)(),(0,f.mr)()})),screen&&screen.orientation&&screen.orientation.addEventListener("change",(function(){(0,c.aB)(),(0,u.uj)(),(0,f.mr)()})),(0,de.u)(),(0,v.Rh)().then((function(){(0,z.a)()}));var e=window.matchMedia("(prefers-color-scheme: dark)"),t=(0,w.bv)(".vc .wc .xc #search_input");e.addEventListener("change",(function(){(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("paste",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("cut",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("selectionchange",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),document.addEventListener("selectionchange",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("keyup",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)}));var n=(0,w.bv)(".vb .yc .zc #search_material_symbols_input");n.addEventListener("paste",(function(){j(n.value)})),n.addEventListener("cut",(function(){j(n.value)})),n.addEventListener("selectionchange",(function(){j(n.value)})),document.addEventListener("selectionchange",(function(){j(n.value)})),n.addEventListener("keyup",(function(){j(n.value)})),(0,l._)(),(0,b.AE)((function(){(0,le.Db)(),(0,le.cS)().then((function(){(0,le.z9)()})),(0,i.to)()}))})),"fetchError"!==e&&"unknownError"!==e||((0,b.AE)(),alert(e))})).catch((function(e){(0,b.AE)(),alert(e)}))})))},secondlyInitialize:function(){ye||(ye=!0,U("https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap","noto_sans_tc"),U("https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200","material_symbols"),(0,p.X)(),(0,o.fV)(),(0,r.HJ)(),(0,ie.$t)(),(0,se.FU)(),(0,o.fV)().then((function(){(0,o.MN)().then((function(){(0,o.cy)()}))})))},route:{stretchRouteItemBody:c.q0,openRoute:c.SR,closeRoute:c.U7,switchRoute:c.Ch,switchRouteBodyTab:c.py,openRouteDetails:s.GS,closeRouteDetails:s.GZ,shareRoutePermalink:d.w,switchCalendarDay:pe.f4},location:{openLocation:u.so,closeLocation:u.eS,stretchLocationItemBody:u.Ms,switchLocationBodyTab:u.dM},folder:{openSaveToFolder:I.BI,closeSaveToFolder:I.nS,openFolderManager:S.g,closeFolderManager:S.m,openFolderEditor:_.uy,closeFolderEditor:_.I6,openFolderIconSelector:function(e){var t;switch((0,b.WR)("FolderIconSelector"),e){case"editor":R="editor",t=(0,w.aI)(F,'._b .ac .bc[group="folder-icon"] .cc .dc .jc');break;case"creator":R="creator",t=(0,w.aI)(B,'.ec .fc .gc[group="folder-icon"] .hc .ic .kc')}"false"===t.getAttribute("disabled")&&(p.m?(O.setAttribute("displayed","true"),function(){C.apply(this,arguments)}(R),(0,k.L)()):(0,x.a)("資料還在下載中","download_for_offline"))},closeFolderIconSelector:Z,openFolderCreator:$.pd,closeFolderCreator:$.z1,createFormulatedFolder:$.c6,saveEditedFolder:_.Bo,selectFolderIcon:function(e){var t;switch(R){case"editor":t=(0,w.aI)(F,'._b .ac .bc[group="folder-icon"] .cc .dc input');break;case"creator":t=(0,w.aI)(B,'.ec .fc .gc[group="folder-icon"] .hc .ic input')}t.value=e,Z()},saveStopItemOnRoute:I.JL,saveStopItemOnLocation:I.Lb,saveRouteOnDetailsPage:I.Dh,saveRouteOnRoute:I.jD,removeItemOnFolderEditor:_.cG,moveItemOnFolderEditor:_.Lq},search:{openSearch:a.rf,closeSearch:a.Bb,typeTextIntoInput:f._O,deleteCharFromInout:f.d$,emptyInput:f.Wb,openSystemKeyboard:f.vp},storage:{openStorage:ne.G,closeStorage:ne.Q},dataUsage:{openDataUsage:function(){(0,b.WR)("DataUsage"),Q.setAttribute("displayed","true"),function(){te.apply(this,arguments)}(),(0,b.Z_)()},closeDataUsage:function(){Q.setAttribute("displayed","false"),(0,b.l$)()}},personalSchedule:{openPersonalScheduleManager:ae.z,closePersonalScheduleManager:ae.Z,openPersonalScheduleCreator:oe.I1,closePersonalScheduleCreator:oe.GJ,createFormulatedPersonalSchedule:oe.Ps,switchPersonalScheduleCreatorDay:oe.om,openPersonalScheduleEditor:re.bF,closePersonalScheduleEditor:re.Xy,switchPersonalScheduleEditorDay:re.Dn,saveEditedPersonalSchedule:re.gv},settings:{openSettings:m.Ow,closeSettings:m.os,openSettingsOptions:y.yH,closeSettingsOptions:y.wx,settingsOptionsHandler:y.Yi,downloadExportFile:m.vv,openFileToImportData:m.rY,viewCommitOfCurrentVersion:m.hP,showPromptToAskForPersistentStorage:m.jk},bus:{openBus:ce.$,closeBus:ce.F},notification:{openNotificationScheduleManager:ve.Sv,closeNotificationScheduleManager:ve.m_,openRegisterNotification:ue.XG,closeRegisterNotification:ue.hy,saveFormulatedRegisterNotification:ue.NW,openScheduleNotification:fe.Ho,closeScheduleNotification:fe.b$,scheduleNotificationForStopItemOnRoute:fe.H9,scheduleNotificationForStopItemOnLocation:fe.b6,cancelNotificationOnNotificationScheduleManager:ve.Gv}};const ge=window.bus},4927:(e,t,n)=>{n.d(t,{F:()=>w,$:()=>b});var a=n(6160),o=n(5314),r=n(3459),i=n(8024),c=n(3648),s=n(904),d=n(4537),u=[],l=!1,f=!0;function v(e,t,n,a){function o(e,t,o){function r(e,t){(0,c.aI)(e,".ad").innerHTML=(0,d.Z)(t.icon)}function s(e,t){(0,c.aI)(e,".bd").innerText=t.value}function u(e,t){e.setAttribute("animation",t)}function v(e,t){e.setAttribute("skeleton-screen",t)}null===o?(r(e,t),s(e,t),v(e,n),u(e,a)):((0,i.hw)(o,t)||r(e,t),(0,i.hw)(o,t)||s(e,t),n!==l&&v(e,n),a!==f&&u(e,a))}var r,s=t.length,v=(0,c.jg)(e,".cd ._c").length;if(s!==v){var p=v-s;if(p<0)for(var h=0;h<Math.abs(p);h++){var m=(r=void 0,(r=document.createElement("div")).classList.add("_c"),r.innerHTML='<div class="ad"></div><div class="bd"></div>',{element:r,id:""});(0,c.aI)(e,".cd").appendChild(m.element)}else for(var y=0;y<Math.abs(p);y++){var g=v-1-y;(0,c.jg)(e,".cd ._c")[g].remove()}}for(var b=(0,c.jg)(e,".cd ._c"),w=0;w<s;w++){var I=b[w],S=t[w];0===u.length?o(I,S,null):o(I,S,u[w])}u=t,f=a,l=n}function p(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}var h=(0,c.bv)(".dd"),m=((0,c.aI)(h,".ed"),(0,c.aI)(h,".fd")),y=(0,c.aI)(m,".gd"),g=(0,c.aI)(y,'.hd[group="properties"]');(0,c.aI)(y,'.hd[group="location"]');function b(e){(0,s.WR)("Bus"),(0,o.XK)("bus",e),h.setAttribute("displayed","true"),function(e){I.apply(this,arguments)}(e),(0,s.Z_)()}function w(){h.setAttribute("displayed","false"),(0,s.l$)()}function I(){var e;return e=function*(e){!function(e){for(var t=(0,r.Js)("playing_animation"),n=[],a=0;a<5;a++)n.push({key:a,icon:"none",value:""});v(e,n,!0,t)}(g);var t=(0,r.Js)("playing_animation"),n=(0,i.zx)("r"),o=yield(0,a.i)(e,n);v(g,o.properties,!1,t)},I=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){p(r,a,o,i,c,"next",e)}function c(e){p(r,a,o,i,c,"throw",e)}i(void 0)}))},I.apply(this,arguments)}},6052:(e,t,n)=>{n.d(t,{c6:()=>f,pd:()=>v,z1:()=>p});var a=n(9566),o=n(3648),r=n(904),i=n(9119),c=(0,o.bv)(".ub"),s=(0,o.aI)(c,".ec"),d=(0,o.aI)(s,".fc"),u=(0,o.aI)(d,'.gc[group="folder-name"] .hc input'),l=(0,o.aI)(d,'.gc[group="folder-icon"] .hc .ic input');function f(){var e=u.value,t=l.value;(0,a.vV)(e,t).then((function(e){e?(p(),(0,i.a)("已建立資料夾","folder")):(0,i.a)("無法建立資料夾","error")}))}function v(){(0,r.WR)("FolderCreator"),c.setAttribute("displayed","true"),(0,r.Z_)()}function p(){c.setAttribute("displayed","false"),(0,r.l$)()}},7123:(e,t,n)=>{n.d(t,{R:()=>g});var a=n(6483),o=n(6802),r=n(7810),i=n(2063),c=n(8011),s=n(4293),d=n(1932),u=n(424),l=n(2303),f=n(6788),v=n(3459),p=n(1531);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function y(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function g(e,t,n,a,o){return b.apply(this,arguments)}function b(){var e;return e=function*(e,t,n,m,y){(0,f.Mf)(y,"getRoute_0",0,!1),(0,f.Mf)(y,"getRoute_1",0,!1),(0,f.Mf)(y,"getStop_0",0,!1),(0,f.Mf)(y,"getStop_1",0,!1),(0,f.Mf)(y,"getLocation_0",0,!1),(0,f.Mf)(y,"getLocation_1",0,!1),(0,f.Mf)(y,"getSegmentBuffers_0",0,!1),(0,f.Mf)(y,"getSegmentBuffers_1",0,!1),(0,f.Mf)(y,"getEstimateTime_0",0,!1),(0,f.Mf)(y,"getEstimateTime_1",0,!1),(0,f.Mf)(y,"getBusEvent_0",0,!1),(0,f.Mf)(y,"getBusEvent_1",0,!1),(0,f.Mf)(y,"getBusData_0",0,!1),(0,f.Mf)(y,"getBusData_1",0,!1);var g=yield(0,s.a)(y,!0),b=yield(0,u.T)(y),w=yield(0,c.g)(y,!1),I=yield(0,d.L)(y),S=yield(0,i.K)(y),_=yield(0,r.J)(y),A=yield(0,o.d)(y),k=yield(0,a.Io)(n,m),T=(0,l.w_)(_,A,g,e,t),M=!1,L={};I.hasOwnProperty("r_".concat(e))&&(M=!0,L=I["r_".concat(e)]);var x,E=(0,v.Js)("time_formatting_mode"),P=[],D=[],R=h(S);try{for(R.s();!(x=R.n()).done;){var F=x.value,B={},O=F.RouteID;if([e,10*e].includes(O)||t.includes(O)){B.status=(0,l.$Q)(null==F?void 0:F.EstimateTime,E);var H="s_".concat(F.StopID),C={};if(!b.hasOwnProperty(H))continue;C=b[H],B.id=F.StopID,B.sequence=C.seqNo,B.goBack=C.goBack;var j="l_".concat(C.stopLocationId),Z={};if(!w.hasOwnProperty(j))continue;Z=w[j],B.name=Z.n,B.overlappingRoutes=Z.r.filter((function(t){return t!==e})).map((function(e){var t="r_".concat(e);if(g.hasOwnProperty(t)){var n=g[t];return{name:n.n,RouteEndPoints:{RouteDeparture:n.dep,RouteDestination:n.des,text:"".concat(n.dep," ↔ ").concat(n.des),html:"<span>".concat(n.dep,"</span><span>↔</span><span>").concat(n.des,"</span>")},RouteID:n.id,PathAttributeId:n.pid}}return null})).filter((function(e){return!(null===e)})),B.position={longitude:Z.lo,latitude:Z.la},D.push({latitude:Z.la,longitude:Z.lo,id:F.StopID});var N,U=[],$=h(Z.s);try{for($.s();!(N=$.n()).done;){var z=N.value,q="s_".concat(z);T.hasOwnProperty(q)&&U.push(T[q].map((function(e){return(0,l.s$)(e)})))}}catch(e){$.e(e)}finally{$.f()}B.buses=U.flat().sort((function(e,t){return e.index-t.index}));var W=[];k.hasOwnProperty(H)&&(W=k[H]),B.busArrivalTimes=W;var G=!1,Q=!1,Y=!1,J=!1;if(M){var X="g_".concat(B.goBack),V=[];L.hasOwnProperty(X)?V=L[X]:"1"===B.goBack&&(J=!0,V=L.g_0);var K,ee=h(V);try{for(ee.s();!(K=ee.n()).done;){var te=K.value;te.OriginStopID!==F.StopID&&te.DestinationStopID!==F.StopID||(G=!0),J?(te.OriginStopID===F.StopID&&(Y=!0),te.DestinationStopID===F.StopID&&(Q=!0)):(te.OriginStopID===F.StopID&&(Q=!0),te.DestinationStopID===F.StopID&&(Y=!0))}}catch(e){ee.e(e)}finally{ee.f()}}B.segmentBuffer={isSegmentBuffer:G,isStartingPoint:Q,isEndingPoint:Y},P.push(B)}}}catch(e){R.e(e)}finally{R.f()}P.sort((function(e,t){return e.sequence-t.sequence}));for(var ne=(0,p.uQ)(D,450),ae=!1,oe=!1,re={},ie=0,ce={},se=P.length,de=0;de<se;de++){var ue=P[de],le=P[de+1]||ue,fe=0;if(ue.buses.length>0&&ue.buses[0].onThisRoute){var ve=[ue.buses[0].position.longitude,ue.buses[0].position.latitude],pe=ve[0],he=ve[1],me=[ue.position.longitude,ue.position.latitude],ye=me[0],ge=me[1],be=[le.position.longitude,le.position.latitude],we=be[0],Ie=be[1];if((pe-ye)*(we-pe)+(he-ge)*(Ie-he)>=0){var Se=Math.hypot(pe-ye,he-ge),_e=Math.hypot(pe-we,he-Ie);fe=Math.max(0,Math.min(Se/(Se+_e),1))}}ue.progress=fe,ue.segmentBuffer.isStartingPoint&&(ae=!0),ue.segmentBuffer.isEndingPoint&&ae&&(oe=!0),ae&&!oe&&(ue.segmentBuffer.isSegmentBuffer=!0),ae&&oe&&(ae=!1,oe=!1);var Ae=!1;null!==ne&&ne.id===ue.id&&(Ae=!0),ue.nearest=Ae;var ke="g_".concat(ue.goBack)||0;re.hasOwnProperty(ke)||(re[ke]=[],ce[ke]=0,ie+=1),re[ke].push(ue),ce[ke]+=1}var Te=g["r_".concat(e)],Me={groupedItems:re,groupQuantity:ie,itemQuantity:ce,RouteName:Te.n,RouteEndPoints:{RouteDeparture:Te.dep,RouteDestination:Te.des},dataUpdateTime:(0,f.Zt)(y),RouteID:e,PathAttributeId:t};return(0,f.LQ)(y),(0,f.gC)(y),Me},b=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){y(r,a,o,i,c,"next",e)}function c(e){y(r,a,o,i,c,"throw",e)}i(void 0)}))},b.apply(this,arguments)}},8379:(e,t,n)=>{n.d(t,{g:()=>v,m:()=>p});var a=n(9566),o=n(8024),r=n(3648),i=n(4537),c=n(904);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function u(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function l(e){var t=(0,o.zx)("i"),n=document.createElement("div");return n.classList.add("id"),n.id=t,n.setAttribute("onclick","bus.folder.openFolderEditor('".concat(e.id,"')")),n.innerHTML='<div class="jd">'.concat((0,i.Z)(e.icon),'</div><div class="kd">').concat(e.name,'</div><div class="ld">').concat(e.contentLength,'</div><div class="md">').concat((0,i.Z)("arrow_forward_ios"),"</div>"),{element:n,id:t}}function f(){var e;return e=function*(){var e=(0,r.bv)(".nd"),t=(0,r.aI)(e,".od .pd");t.innerHTML="";var n,o=s(yield(0,a.Xi)());try{for(o.s();!(n=o.n()).done;){var i=l(n.value);t.appendChild(i.element)}}catch(e){o.e(e)}finally{o.f()}},f=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){u(r,a,o,i,c,"next",e)}function c(e){u(r,a,o,i,c,"throw",e)}i(void 0)}))},f.apply(this,arguments)}function v(){(0,c.WR)("FolderManager"),(0,r.bv)(".nd").setAttribute("displayed","true"),function(){f.apply(this,arguments)}()}function p(){(0,c.kr)("FolderManager"),(0,r.bv)(".nd").setAttribute("displayed","false")}},8621:(e,t,n)=>{n.d(t,{p:()=>v});var a=n(2303),o=n(313),r=n(4293),i=n(8201),c=n(8671),s=n(5579),d=n(6788);function u(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function v(e,t,n){return p.apply(this,arguments)}function p(){var e;return e=function*(e,t,n){var u=function(e,t){var n,a={},o=l(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.Id===t){a=r;break}}}catch(e){o.e(e)}finally{o.f()}return a}(yield(0,r.a)(n,!1),e),f=yield(0,i.Y)(n),v=yield(0,c.s)(n),p=yield(0,o.s)(n),h=function(e){var t=(0,a.aU)(e.goFirstBusTime,0),n=(0,a.aU)(e.goLastBusTime,0),o=(0,a.aU)(e.backFirstBusTime,0),r=(0,a.aU)(e.backLastBusTime,0),i=(0,a.aU)(e.holidayGoFirstBusTime,0),c=(0,a.aU)(e.holidayGoLastBusTime,0),s=(0,a.aU)(e.holidayBackFirstBusTime,0),d=(0,a.aU)(e.holidayBackLastBusTime,0),u=(0,a.aU)(e.peakHeadway,1),l=(0,a.aU)(e.offPeakHeadway,1),f=(0,a.aU)(e.holidayPeakHeadway,1),v=(0,a.aU)(e.holidayOffPeakHeadway,1);return{go:{weekday:{first:t,last:n,rushHourWindow:u,offRushHourWindow:l},holiday:{first:i,last:c,rushHourWindow:f,offRushHourWindow:v}},back:{weekday:{first:o,last:r,rushHourWindow:u,offRushHourWindow:l},holiday:{first:s,last:d,rushHourWindow:f,offRushHourWindow:v}},realSequence:e.realSequence}}(u),m=function(e,t,n,o,r){var i,c={calendarDays:{d_0:{name:"日",day:0,code:"d_0"},d_1:{name:"一",day:1,code:"d_1"},d_2:{name:"二",day:2,code:"d_2"},d_3:{name:"三",day:3,code:"d_3"},d_4:{name:"四",day:4,code:"d_4"},d_5:{name:"五",day:5,code:"d_5"},d_6:{name:"六",day:6,code:"d_6"}},calendarDayQuantity:7,calendarEventGroups:{d_0:[],d_1:[],d_2:[],d_3:[],d_4:[],d_5:[],d_6:[]},calendarEventQuantity:{d_0:0,d_1:0,d_2:0,d_3:0,d_4:0,d_5:0,d_6:0}},d=(0,s.P$)(),u=l(o);try{for(u.s();!(i=u.n()).done;){var f=i.value;if(t.indexOf(f.PathAttributeId)>-1&&"0"===f.DateType)for(var v=(0,s.mr)(f.DateValue),p=(0,s.S1)(d,v.day,0,0),h=(0,a.aU)(f.StartTime,0),m=(0,s.S1)(p,0,h.hours,h.minutes),y=(0,a.aU)(f.EndTime,0),g=(0,s.S1)(p,0,y.hours,y.minutes),b=Math.abs(60*y.hours+y.minutes-(60*h.hours+h.minutes)),w=parseInt(f.LongHeadway),I=parseInt(f.LowHeadway),S=(I+w)/2,_=b/S,A=0;A<_;A++){var k=!1,T=(0,s.S1)(p,0,h.hours,h.minutes+I*A);T.getTime()<m.getTime()&&(k=!0),T.getTime()>g.getTime()&&(k=!0),!1===k&&(c.calendarEventGroups[v.code].push({date:T,dateString:(0,s.$T)(T,"hh:mm"),duration:I,deviation:Math.abs(S-I)}),c.calendarEventQuantity[v.code]+=1)}}}catch(e){u.e(e)}finally{u.f()}var M,L=l(r);try{for(L.s();!(M=L.n()).done;){var x=M.value;if(t.indexOf(x.PathAttributeId)>-1&&"0"===x.DateType){var E=(0,s.mr)(x.DateValue),P=(0,s.S1)(d,E.day,0,0),D=(0,a.aU)(x.DepartureTime,0),R=(0,s.S1)(P,0,D.hours,D.minutes);c.calendarEventGroups[E.code].push({date:R,dateString:(0,s.$T)(R,"hh:mm"),duration:15,deviation:0}),c.calendarEventQuantity[E.code]+=1}}}catch(e){L.e(e)}finally{L.f()}for(var F in c.calendarEventGroups)c.calendarEventGroups[F].sort((function(e,t){return e.date.getTime()-t.date.getTime()}));return c}(0,t,0,f,v),y=function(e,t){var n,a={},o=l(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;r.id===t&&(a=r)}}catch(e){o.e(e)}finally{o.f()}return a}(p,u.providerId),g={timeTableRules:h,calendar:m,properties:[{key:"route_name",icon:"route",value:u.nameZh},{key:"pricing",icon:"attach_money",value:u.ticketPriceDescriptionZh},{key:"provider_name",icon:"corporate_fare",value:y.nameZn},{key:"provider_phone",icon:"call",value:y.phoneInfo},{key:"provider_email",icon:"alternate_email",value:y.email}]};return(0,d.LQ)(n),(0,d.gC)(n),g},p=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){u(r,a,o,i,c,"next",e)}function c(e){u(r,a,o,i,c,"throw",e)}i(void 0)}))},p.apply(this,arguments)}},9333:(e,t,n)=>{n.d(t,{Bo:()=>M,I6:()=>A,Lq:()=>T,cG:()=>k,uy:()=>_});var a=n(9566),o=n(8024),r=n(3648),i=n(904),c=n(4537),s=n(9119);function d(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var f=(0,r.bv)(".tb"),v=(0,r.aI)(f,".qd"),p=(0,r.aI)(v,".rd"),h=(0,r.aI)(f,"._b"),m=(0,r.aI)(h,".ac"),y=(0,r.aI)(m,'.bc[group="folder-name"] .cc input'),g=(0,r.aI)(m,'.bc[group="folder-icon"] .cc .dc input'),b=(0,r.aI)(m,'.bc[group="folder-icon"] .cc .dc .jc'),w=(0,r.aI)(m,'.bc[group="folder-content"] .cc');function I(e,t){var n=(0,o.zx)("i"),a=document.createElement("div");a.id=n,a.classList.add("sd"),a.setAttribute("type",t.type);var r="",i="",s="";switch(t.type){case"stop":s="location_on",r="".concat(t.route?t.route.name:""," - 往").concat(t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""),i=t.name;break;case"route":s="route",r="".concat(t.endPoints.departure," ↔ ").concat(t.endPoints.destination),i=t.name;break;case"bus":r="",i=t.name;break;case"empty":s="lightbulb",r="提示",i="沒有內容";break;default:s="",r="null",i="null"}return a.innerHTML='<div class="td">'.concat((0,c.Z)(s),'</div><div class="ud">').concat(r,'</div><div class="vd">').concat(i,'</div><div class="wd"><div class="xd" onclick="bus.folder.moveItemOnFolderEditor(\'').concat(n,"', '").concat(e.id,"', '").concat(t.type,"', ").concat(t.id,", 'up')\">").concat((0,c.Z)("keyboard_arrow_down"),'</div><div class="yd" onclick="bus.folder.moveItemOnFolderEditor(\'').concat(n,"', '").concat(e.id,"', '").concat(t.type,"', ").concat(t.id,", 'down')\">").concat((0,c.Z)("keyboard_arrow_down"),'</div><div class="zd" onclick="bus.folder.removeItemOnFolderEditor(\'').concat(n,"', '").concat(e.id,"', '").concat(t.type,"', ").concat(t.id,')">').concat((0,c.Z)("delete"),'</div><div class="_d"></div><div class="_d"></div></div>'),{element:a,id:n}}function S(){var e;return e=function*(e){!function(e,t){y.value=e.name,g.value=e.icon,e.default?(y.setAttribute("readonly","readonly"),g.setAttribute("readonly","readonly"),b.setAttribute("disabled","true")):(y.removeAttribute("readonly"),g.removeAttribute("readonly"),b.setAttribute("disabled","false")),p.setAttribute("onclick","bus.folder.saveEditedFolder('".concat(e.id,"')")),w.innerHTML="";var n,a=u(t);try{for(a.s();!(n=a.n()).done;){var o=I(e,n.value);w.appendChild(o.element)}}catch(e){a.e(e)}finally{a.f()}}(yield(0,a.L2)(e),yield(0,a.eD)(e))},S=function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){d(r,a,o,i,c,"next",e)}function c(e){d(r,a,o,i,c,"throw",e)}i(void 0)}))},S.apply(this,arguments)}function _(e){(0,i.WR)("FolderEditor"),f.setAttribute("displayed","true"),function(e){S.apply(this,arguments)}(e),(0,i.Z_)()}function A(){f.setAttribute("displayed","false"),(0,i.l$)()}function k(e,t,n,o){var i=(0,r.aI)(f,'._b .ac .bc[group="folder-content"] .cc .sd#'.concat(e));(0,a.NC)(t,n,o).then((function(e){if(e)switch(i.remove(),n){case"stop":(0,s.a)("已移除站牌","delete");break;case"route":(0,s.a)("已移除路線","delete")}else(0,s.a)("無法移除","error")}))}function T(e,t,n,o,i){var c=(0,r.aI)(f,'._b .ac .bc[group="folder-content"] .cc .sd#'.concat(e));(0,a.bq)(t,n,o,i).then((function(e){if(e)switch(i){case"up":var t=c.previousElementSibling;t&&c.parentNode.insertBefore(c,t),(0,s.a)("已往上移","arrow_circle_up");break;case"down":var n=c.nextElementSibling;n&&c.parentNode.insertBefore(n,c),(0,s.a)("已往下移","arrow_circle_down")}else(0,s.a)("無法移動","error")}))}function M(e){var t=y.value,n=g.value;(0,a.g$)(e,t,n),A()}}}]);
//# sourceMappingURL=1e83cc1fa9569182e7ac.js.map