"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[607],{972(e,t,n){n.d(t,{L:()=>v,U:()=>y});var r=n(467),i=n(2129),a=n(8024),o=n(9519),s=n(9218),u=n(6788);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("E0")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p={},f=!1;function v(){return d.apply(this,arguments)}function d(){return(d=(0,r.A)(function*(){if(!f){var e=(0,a.zx)(),t=yield(0,s.l)(e);(0,u.LQ)(e);var n=t.dictionary.split(","),r=t.symbols,i=[],o={},l=0;for(var v in r){for(var d=v.split("_"),y=d.length-1;y>=0;y--)d.splice(y,1,n[parseInt(d[y])]);var h=d.join("_");i.push(h);var m,g=c(r[v]);try{for(g.s();!(m=g.n()).done;){var _=`w${m.value}`;(0,a.mQ)(o,_)||(o[_]=[]),o[_].push(l)}}catch(e){g.e(e)}finally{g.f()}l++}p={dictionary:n,names:i,wordToSymbols:o},f=!0}})).apply(this,arguments)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.3;if(!f)return[];for(var a=p,s=a.dictionary,u=a.names,c=a.wordToSymbols,l=Math.round(u.length*r),v=Array.from(new Set(e.trim().toLowerCase().split(/[\s_-]+/))),d=v.length,y=new Uint8Array(d),h=new Int16Array(d).fill(-1),m=t;m<d;m++){y[m]=v[m].length;for(var g=0,_=s.length;g<_;g++){var b=(0,o.e)(v[m],s[g]);b<=y[m]&&(y[m]=b,h[m]=g)}}for(var w=[],S=d-1;S>=0;S--)if(!(h[S]<0)){var A=c[`w${h[S]}`]||[];n&&A.length>l||w.push(A)}var k=w.length;if(0===k)return[];w.sort(function(e,t){return e.length-t.length});for(var I=w[0],x=1;x<k;x++)I=(0,i._N)(I,w[x]);for(var $=[],C=0,L=I.length;C<L;C++){for(var U=0,E=d-1;E>=0;E--){if(!(h[E]<0))(c[`w${h[E]}`]||[]).indexOf(I[C])>-1&&(U-=E)}$.push({item:u[I[C]],score:U})}return $.sort(function(e,t){return t.score-e.score}),$}},1238(e,t,n){n.d(t,{Y:()=>s,q:()=>o});var r=n(574),i=n(3459),a={current:-1,permission:{gained:!1,asked:!1},id:0};function o(){!1===a.permission.asked&&!0===(0,i.Js)("display_user_orientation")&&(a.permission.asked=!0,"undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(e){"granted"===e&&window.addEventListener("deviceorientation",function(e){e.absolute?a.current=(null==e?void 0:e.alpha)||-1:e.webkitCompassHeading?a.current=e.webkitCompassHeading||-1:a.current=(null==e?void 0:e.alpha)||-1},!0)}).catch(function(e){}):console.log("DeviceOrientation isn't supported."))}function s(){var e=a.current;if(-1===e)return{degree:-1,cardinalDirection:r.AE};var t=e+90;t>360&&(t-=360),t*=Math.PI/180;var n=[Math.cos(t),Math.sin(t)];return{degree:e,cardinalDirection:(0,r.DK)(n)}}},1531(e,t,n){n.d(t,{to:()=>o,uQ:()=>u});var r=n(7183),i=n(3459),a={current:{latitude:0,longitude:0},permission:{gained:!1,asked:!1},id:0};function o(){!1===a.permission.asked&&(0,i.Js)("display_user_location")&&(a.permission.asked=!0,a.id=navigator.geolocation.watchPosition(function(e){a.permission.gained=!0,a.current.latitude=e.coords.latitude,a.current.longitude=e.coords.longitude},function(e){},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0}))}function s(){return a.permission.asked&&a.permission.gained?a.current:a.permission.asked||a.permission.gained?a.permission.asked&&!a.permission.gained?a.current:void 0:(o(),a.current)}function u(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:450,n=s(),i=1/0,a=-1,o=e.length-1;o>0;o--){var u=e[o],c=(0,r.aV)(n.latitude,n.longitude,u.latitude,u.longitude);c<=t&&c<i&&(a=o,i=c)}return a>0?e[a]:null}},3251(e,t,n){n.d(t,{A:()=>p,HL:()=>u,_P:()=>c,iJ:()=>l,kE:()=>s});var r=n(467),i=n(8179);function a(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new URLSearchParams(window.location.search);n.set("v",e);var r=window.location.pathname+"?"+n.toString();t?window.location.replace(r):history.replaceState(null,"",r)}function o(){return(o=(0,r.A)(function*(){try{var e=yield fetch(`./version.json?_=${(new Date).getTime()}`,{cache:"no-store"});if(!e.ok)throw new Error("E24");return e.json()}catch(e){return!1}})).apply(this,arguments)}function s(){return(0,i.bv)('head meta[name="version-hash"]').getAttribute("content")}function u(){return(0,i.bv)('head meta[name="version-branch-name"]').getAttribute("content")}function c(){return`https://github.com/EricHsia7/bus/tree/${(0,i.bv)('head meta[name="version-full-hash"]').getAttribute("content")}`}function l(){return(0,i.bv)('head meta[name="version-time-stamp"]').getAttribute("content")}function p(){return f.apply(this,arguments)}function f(){return f=(0,r.A)(function*(){var e=yield function(){return o.apply(this,arguments)}();return"boolean"==typeof e?!1===e?"fetchError":"unknownError":s()!==e.hash?(a(e.hash,!0),"refreshing"):(a(e.hash,!1),"ok")}),f.apply(this,arguments)}},3459(e,t,n){n.d(t,{Gn:()=>k,Js:()=>C,PL:()=>$,Yq:()=>b,aN:()=>I,cl:()=>S});var r=n(467),i=n(9499),a=n(8379),o=n(2174),s=n(7891),u=n(6104),c=n(6166),l=n(2994),p=n(8024),f=n(5579),v=n(3422),d=n(4311),y=n(3251);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("E0")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var g=["time_formatting_mode","refresh_interval","display_user_location","display_user_orientation","location_labels","proxy","folder","personal_schedule","notification","playing_animation","power_saving","data_usage","storage","persistent_storage","export","import","version","branch","last_update_date","github"],_={time_formatting_mode:{key:"time_formatting_mode",name:"預估時間格式",icon:"glyphs",status:"",action:function(){(0,c.yH)("time_formatting_mode")},type:"select",default_option:0,option:0,options:[{name:`${(0,f.fU)(11,3)}/${(0,f.fU)(61,3)}/${(0,f.fU)(3661,3)}`,value:{type:1,number:3},resourceIntensive:!1,powerSavingAlternative:-1},{name:`${(0,f.fU)(11,2)}/${(0,f.fU)(61,2)}/${(0,f.fU)(3661,2)}`,value:{type:1,number:2},resourceIntensive:!1,powerSavingAlternative:-1},{name:`${(0,f.fU)(11,1)}/${(0,f.fU)(61,1)}/${(0,f.fU)(3661,1)}`,value:{type:1,number:1},resourceIntensive:!1,powerSavingAlternative:-1},{name:`${(0,f.fU)(11,0)}/${(0,f.fU)(61,0)}/${(0,f.fU)(3661,0)}`,value:{type:1,number:0},resourceIntensive:!1,powerSavingAlternative:-1}],description:"在首頁、路線頁面、地點頁面上的預估公車到站時間的顯示格式。"},refresh_interval:{key:"refresh_interval",name:"預估時間更新頻率",icon:"pace",status:"",action:function(){(0,c.yH)("refresh_interval")},type:"select",default_option:0,option:0,options:[{name:"自動",value:{baseInterval:15e3,dynamic:!0,type:3},resourceIntensive:!0,powerSavingAlternative:2},{name:"10秒",value:{baseInterval:1e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:2},{name:"20秒",value:{baseInterval:2e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:3},{name:"30秒",value:{baseInterval:3e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:4},{name:"40秒",value:{baseInterval:4e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:5},{name:"50秒",value:{baseInterval:5e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:6},{name:"60秒",value:{baseInterval:6e4,dynamic:!1,type:3},resourceIntensive:!0,powerSavingAlternative:6}],description:"在首頁、路線頁面、地點頁面上的預估公車到站時間、公車等即時資料更新的頻率。"},display_user_location:{key:"display_user_location",name:"顯示所在位置",icon:"near_me",status:"",action:function(){(0,c.yH)("display_user_location")},type:"select",default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!0,powerSavingAlternative:1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}],description:"是否在路線頁面上標註目前所在位置。若設為開啟，本應用程式將要求位置存取權限。"},display_user_orientation:{key:"display_user_orientation",name:"顯示裝置指向",icon:"explore",status:"",action:function(){(0,c.yH)("display_user_orientation")},type:"select",default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!0,powerSavingAlternative:1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}],description:"是否在地點頁面上顯示裝置所指方向。若設為開啟，本應用程式將要求動作與方向存取權限。"},location_labels:{key:"location_labels",name:"站牌位置標籤",icon:"tag",status:"",action:function(){(0,c.yH)("location_labels")},type:"select",default_option:0,option:0,options:[{name:"行徑方向",value:{type:0,string:"directions"},resourceIntensive:!1,powerSavingAlternative:-1},{name:"地址特徵",value:{type:0,string:"address"},resourceIntensive:!1,powerSavingAlternative:-1},{name:"英文字母",value:{type:0,string:"letters"},resourceIntensive:!1,powerSavingAlternative:-1}],description:"用於區分位於同個地點的不同站牌。行徑方向表示可搭乘路線從本站到下一站的方向（與車流同向）；地址特徵表示不同站牌的地址差異處；英文字母表示按照順序以字母編號。"},proxy:{key:"proxy",name:"網路代理",icon:"router",status:"",action:function(){(0,c.yH)("proxy")},type:"select",default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!1,powerSavingAlternative:-1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}],description:"使用網路代理來擷取資料。"},folder:{key:"folder",name:"資料夾",icon:"folder",status:"",type:"page",action:a.g,description:""},personal_schedule:{key:"personal_schedule",name:"個人化行程",icon:"calendar_view_day",status:"",action:s.z,type:"page",description:""},notification:{key:"notification",name:"通知",icon:"notifications",status:"",action:o.Sv,type:"page",description:""},playing_animation:{key:"playing_animation",name:"動畫",icon:"animation",description:"是否在介面中播放動畫。",status:"",type:"select",action:function(){(0,c.yH)("playing_animation")},default_option:0,option:0,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!0,powerSavingAlternative:1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}]},power_saving:{key:"power_saving",name:"省電模式",icon:"battery_low",description:"暫停使用耗電功能來節省電力。",status:"",type:"select",action:function(){(0,c.yH)("power_saving")},default_option:1,option:1,options:[{name:"開啟",value:{type:2,boolean:!0},resourceIntensive:!1,powerSavingAlternative:-1},{name:"關閉",value:{type:2,boolean:!1},resourceIntensive:!1,powerSavingAlternative:-1}]},data_usage:{key:"data_usage",name:"網路使用量",icon:"bigtop_updates",status:"",type:"page",action:i.k,description:""},storage:{key:"storage",name:"儲存空間",icon:"database",status:"",type:"page",action:l.G,description:""},persistent_storage:{key:"persistent_storage",name:"永久儲存",icon:"storage",status:"",action:u.jk,type:"action",description:"開啟此選項以避免瀏覽器自動刪除重要資料。"},export:{key:"export",name:"匯出資料",icon:"upload",status:"",type:"action",action:u.vv,description:""},import:{key:"import",name:"匯入資料",icon:"download",status:"",type:"action",action:u.rY,description:""},version:{key:"version",name:"版本",icon:"commit",status:"",type:"info",action:u.gE,description:""},branch:{key:"branch",name:"分支",icon:"rebase",status:"",type:"info",action:function(){},description:""},last_update_date:{key:"last_update_date",name:"更新時間",icon:"update",status:"",type:"info",action:function(){},description:""},github:{key:"github",name:"GitHub",icon:"book_2",status:"@EricHsia7/bus",type:"info",action:u.ze,description:""}};function b(){return w.apply(this,arguments)}function w(){return(w=(0,r.A)(function*(){var e,t=h(yield(0,d.Su)(1));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(g.indexOf(n)>-1){var r=yield(0,d.Ct)(1,n);if(null!==r){if("select"===_[n].type){var i=parseInt(r);_[n].option=i}}else"select"===_[n].type&&(_[n].option=_[n].default_option)}}}catch(e){t.e(e)}finally{t.f()}return!0})).apply(this,arguments)}function S(){return A.apply(this,arguments)}function A(){return(A=(0,r.A)(function*(){var e=[];for(var t in _){var n=_[t];switch(n.type){case"select":n.status=n.options[n.option].name;break;case"page":if("notification"===t)n.status=(0,v.hc)()?"已註冊":"未註冊";else n.status="";break;case"action":n.status="","persistent_storage"===t&&(n.status=(yield(0,d.tH)())?"開啟":"關閉");break;case"info":if("version"===t&&(n.status=(0,y.kE)()),"branch"===t&&(n.status=(0,y.HL)()),"last_update_date"===t){var r=new Date((0,y.iJ)());n.status=(0,f.HN)(r)}}e.push(n)}return e})).apply(this,arguments)}function k(){var e=[];for(var t in _)if(g.indexOf(t)>-1&&(0,p.mQ)(_,t)&&"select"===_[t].type){var n={key:t,option:_[t].option};e.push(n)}return e}function I(e,t){return x.apply(this,arguments)}function x(){return(x=(0,r.A)(function*(e,t){return!!(g.indexOf(e)>-1&&(0,p.mQ)(_,e)&&"select"===_[e].type&&void 0!==_[e].options[t]&&null!==_[e].options[t])&&(yield(0,d.mL)(1,e,t),_[e].option=t,!0)})).apply(this,arguments)}function $(e){if(g.indexOf(e)>-1&&(0,p.mQ)(_,e))return _[e]}function C(e){if(g.indexOf(e)>-1&&(0,p.mQ)(_,e)){var t=_.power_saving,n=t.options[t.option].value.boolean,r=_[e],i=r.options[r.option];n&&i.resourceIntensive&&(i=r.options[i.powerSavingAlternative]);var a=i.value;switch(a.type){case 0:return a.string;case 1:return a.number;case 2:return a.boolean;case 3:return a;default:return""}}return""}},4311(e,t,n){n.d(t,{Ct:()=>p,Su:()=>y,VC:()=>b,iQ:()=>v,le:()=>m,mL:()=>c,tH:()=>g});var r=n(467),i=n(3790),a={cacheStore:!1,settingsStore:!1,dataUsageStatsStore:!1,updateRateDataStore:!1,updateRateDataWriteAheadLogStore:!1,busArrivalTimeDataWriteAheadLogStore:!1,busArrivalTimeDataStore:!1,personalScheduleStore:!1,recentViewsStore:!1,notificationStore:!1,notificationScheduleStore:!1,folderListStore:!1,folderContentIndexStore:!1,folderContentStore:!1},o=["cacheStore","settingsStore","dataUsageStatsStore","updateRateDataStore","updateRateDataWriteAheadLogStore","busArrivalTimeDataWriteAheadLogStore","busArrivalTimeDataStore","personalScheduleStore","recentViewsStore","notificationStore","notificationScheduleStore","folderListStore","folderContentIndexStore","folderContentStore"],s=!1;function u(){return(u=(0,r.A)(function*(){!1===s&&(s=yield i.createInstance({name:"dummyStorage"})),yield s.dropInstance(),s=!1})).apply(this,arguments)}function c(e,t,n){return l.apply(this,arguments)}function l(){return l=(0,r.A)(function*(e,t,n){try{var r=o[e];return!1===a[r]&&(a[r]=yield i.createInstance({name:r})),yield a[r].setItem(t,n)}catch(e){return function(){u.apply(this,arguments)}(),null}}),l.apply(this,arguments)}function p(e,t){return f.apply(this,arguments)}function f(){return(f=(0,r.A)(function*(e,t){try{var n=o[e];return!1===a[n]&&(a[n]=yield i.createInstance({name:n})),yield a[n].getItem(t)}catch(e){return null}})).apply(this,arguments)}function v(e,t){return d.apply(this,arguments)}function d(){return(d=(0,r.A)(function*(e,t){try{var n=o[e];return!1===a[n]&&(a[n]=yield i.createInstance({name:n})),yield a[n].removeItem(t)}catch(e){return null}})).apply(this,arguments)}function y(e){return h.apply(this,arguments)}function h(){return(h=(0,r.A)(function*(e){try{var t=o[e];return!1===a[t]&&(a[t]=yield i.createInstance({name:t})),yield a[t].keys()}catch(e){return[]}})).apply(this,arguments)}function m(){return o.length}function g(){return _.apply(this,arguments)}function _(){return(_=(0,r.A)(function*(){if(navigator.storage&&navigator.storage.persist)return yield navigator.storage.persisted();return!1})).apply(this,arguments)}function b(){return w.apply(this,arguments)}function w(){return(w=(0,r.A)(function*(){if(navigator.storage&&navigator.storage.persist)return(yield navigator.storage.persist())?"granted":"denied";return"unsupported"})).apply(this,arguments)}},8134(e,t,n){n.d(t,{F6:()=>m,GU:()=>I,Rk:()=>y,dD:()=>S,k9:()=>v});var r=n(467),i=n(2129),a=n(8024),o=n(4781),s=n(9734),u=n(8011),c=n(4293),l=n(6788);function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("E0")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e){return d.apply(this,arguments)}function d(){return(d=(0,r.A)(function*(e){var t=(0,a.zx)(),n=yield(0,c.a)(t,!0),r=[];for(var i in n){var o=n[i];String(o.n).indexOf(e)>-1&&r.push(o)}return(0,l.LQ)(t),(0,l.gC)(t),r})).apply(this,arguments)}function y(e){return h.apply(this,arguments)}function h(){return(h=(0,r.A)(function*(e){var t,n=(0,a.zx)(),r=yield(0,c.a)(n,!0),i=`r_${e}`;return!!(0,a.mQ)(r,i)&&(t=r[i],(0,l.LQ)(n),(0,l.gC)(n),t)})).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=(0,r.A)(function*(e){var t=(0,a.zx)(),n=yield(0,c.a)(t,!0),r=[];for(var i in n){var o=n[i];String(o.pid).indexOf(e)>-1&&r.push(o)}return(0,l.LQ)(t),(0,l.gC)(t),r})).apply(this,arguments)}var _={},b=[],w=!1;function S(){return A.apply(this,arguments)}function A(){return(A=(0,r.A)(function*(){if(!w){var e=(0,a.zx)(),t=yield(0,c.a)(e,!0),n=yield(0,u.g)(e,1),r=yield(0,s.j)(e,!0);(0,l.LQ)(e),(0,l.gC)(e);var i={},f=[],v=0;for(var d in t){var y=t[d],h={id:y.id,pid:y.pid,dep:y.dep,des:y.des,n:y.n,hash:"",lo:"",la:"",r:"",s:"",type:0};f.push(h);var m,g=p((0,o.B5)(`${h.n.toLowerCase()}${h.dep.toLowerCase()}${h.des.toLowerCase()}`,!0));try{for(g.s();!(m=g.n()).done;){var S=`u_${m.value}`;(0,a.mQ)(i,S)||(i[S]=[]),i[S].push(v)}}catch(e){g.e(e)}finally{g.f()}v+=1}for(var A in n){var k=n[A],I={id:k.id,n:k.n,lo:k.lo,la:k.la,r:k.r,s:k.s,hash:k.hash,dep:"",des:"",pid:[],type:1};f.push(I);var x,$=p((0,o.B5)(I.n.toLowerCase(),!0));try{for($.s();!(x=$.n()).done;){var C=`u_${x.value}`;(0,a.mQ)(i,C)||(i[C]=[]),i[C].push(v)}}catch(e){$.e(e)}finally{$.f()}v+=1}for(var L in r){var U=r[L],E={id:U.BusId,pid:[],dep:"",des:"",n:U.CarNum,hash:"",lo:"",la:"",r:"",s:"",type:2};f.push(E);var H,D=p((0,o.B5)(E.n.toLowerCase(),!0));try{for(D.s();!(H=D.n()).done;){var Q=`u_${H.value}`;(0,a.mQ)(i,Q)||(i[Q]=[]),i[Q].push(v)}}catch(e){D.e(e)}finally{D.f()}v+=1}_=i,b=f,w=!0}})).apply(this,arguments)}function k(e,t){var n,r=0,i=0,a=p(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;r+=e.indexOf(o,i)-i,i+=1}}catch(e){a.e(e)}finally{a.f()}return e===t&&(r=10*Math.abs(r)),r}function I(e,t,n){if(!w)return[];var r,s=e.toLowerCase(),u=(0,o.B5)(s,!0),c=(0,o.B5)(s,!1),l=[],f=p(u);try{for(f.s();!(r=f.n()).done;){var v=`u_${r.value}`;(0,a.mQ)(_,v)&&l.push(_[v])}}catch(e){f.e(e)}finally{f.f()}l.sort(function(e,t){return e.length-t.length});var d=l.length-1,y=[];if(0===d&&(y=l[0]),d>0)for(var h=0;h<d;h++){var m=l[h],g=l[h+1];y=0===h?(0,i._N)(m,g):(0,i._N)(y,g)}var S=[],A=0,I=new Set;if(-1===t||2===t){var x,$=b.filter(function(e){return e.n===s&&2===e.type}),C=p($);try{for(C.s();!(x=C.n()).done;){var L=x.value;if(S.push({item:L,score:1/0}),I.add(L.id),(A+=1)>=n)break}}catch(e){C.e(e)}finally{C.f()}}if(A<n){var U,E=p(y);try{for(E.s();!(U=E.n()).done;){var H=U.value,D=b[H];if((-1===t||t===D.type)&&!I.has(D.id)){var Q=k(c,(0,o.B5)(D.n,!1));if(!(A<n))break;S.push({item:D,score:Q}),A+=1}}}catch(e){E.e(e)}finally{E.f()}}return S.sort(function(e,t){return t.score-e.score}),S}}}]);
//# sourceMappingURL=30be76281934fea7bab6.js.map