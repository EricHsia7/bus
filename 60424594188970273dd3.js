"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[806],{904:(e,t,n)=>{n.d(t,{AE:()=>S,BM:()=>I,WR:()=>m,Z_:()=>b,gO:()=>_,kr:()=>g,l$:()=>w});var a=n(8024),r=n(3648),o=n(4927),i=n(6052),c=n(9333),s=n(8379),u=n(7908),d=n(5693),l=n(7891),f=n(5009),v=n(6104),h=100,p=(new Date).getTime(),y=["Home"];function m(e){var t=y.length;y[t-1]!==e&&y.push(e)}function g(e){if(y.indexOf(e)>-1){var t=y.length;y[t-1]===e&&y.pop()}}function b(){var e=y.length;if(e>1)switch(y[e-2]){case"Home":case"FolderIconSelector":case"Location":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":default:break;case"FolderCreator":(0,i.z1)();break;case"FolderEditor":(0,c.I6)();break;case"FolderManager":(0,s.m)();break;case"Search":(0,f.Bb)();break;case"Settings":(0,v.os)();break;case"PersonalScheduleManager":(0,l.Z)();break;case"PersonalScheduleEditor":(0,d.Xy)();break;case"Bus":(0,o.F)();break;case"RegisterNotification":(0,u.hy)()}}function w(){var e=y.length;if(e>1){var t=y[e-2];switch(y.pop(),t){case"Home":case"FolderIconSelector":case"Location":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":default:break;case"FolderCreator":(0,i.pd)();break;case"FolderEditor":(0,c.uy)();break;case"FolderManager":(0,s.g)();break;case"Search":(0,f.rf)();break;case"Settings":(0,v.Ow)();break;case"PersonalScheduleManager":(0,l.z)();break;case"PersonalScheduleEditor":(0,d.bF)();break;case"Bus":(0,o.$)();break;case"RegisterNotification":(0,u.XG)()}}}function I(){var e=0;(0,a.t9)()&&(e=-1*(window.outerHeight-window.innerHeight)/2),(0,r.bv)(".f svg.g").style.setProperty("--h","".concat(e,"px"))}function S(e){function t(){var t=(0,r.bv)(".f");t.classList.add("i"),t.addEventListener("animationend",(function(){t.setAttribute("displayed","false"),t.classList.remove("i"),"function"==typeof e&&e()}),{once:!0})}var n=(new Date).getTime();n-p<h?setTimeout(t,Math.max(1,n-p)):t()}function _(e){var t=0,n=0,a=window.innerWidth,r=window.innerHeight;switch(e){case"window":t=a,n=r;break;case"head":t=a,n=55;break;case"head-one-button":t=a-55,n=55;break;case"head-two-button":t=a-110,n=55;break;case"route-details-canvas":t=a-20-20,n=1440;break;case"route-bus-arrival-time-chart":t=a-45-15-20,n=75;break;case"location-bus-arrival-time-chart":t=a-30-20,n=75;break;default:t=0,n=0}return{width:t,height:n}}},3030:(e,t,n)=>{n.d(t,{Ms:()=>fe,dM:()=>ve,eS:()=>le,s_:()=>K,so:()=>de,uj:()=>ee});var a=n(2757),r=n(4537),o=n(6788),i=n(3459),c=n(8024),s=n(7968),u=n(3648),d=n(5767),l=n(904),f=n(9119),v=n(5314),h=n(5579),p=n(9566),y=n(4636);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function b(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}var w=(0,u.bv)(".j"),I=(0,u.aI)(w,".k"),S=(0,u.aI)(I,".l"),_=(0,u.aI)(w,".m"),A=(0,u.aI)(I,".n"),k=(0,u.aI)(A,".o"),T=(0,u.aI)(I,".p"),M=(0,u.aI)(T,".q"),L=(0,u.aI)(I,".r .s"),x={},E=!0,P=!1,D=0,R=0,F=0,O={},B=0,j=!1,H=1e4,C=15e3,Z=5e3,U=15e3,N=!0,$=!1,z=0,q=0,W=!1,G="",Q=-1,Y=-1,J=!1,X="",V=20;function K(){_.addEventListener("touchstart",(function(){D=Math.round(_.scrollLeft/B)})),_.addEventListener("scroll",(function(e){j=!0;var t=e.target.scrollLeft/B;R=t>D?D+1:D-1;var n=O["g_".concat(D)]||{width:0,offset:0},a=O["g_".concat(R)]||{width:0,offset:0},r=n.width+(a.width-n.width)*Math.abs(t-D),o=-1*(n.offset+(a.offset-n.offset)*Math.abs(t-D))+.5*B-.5*r;te(F,o,r-V,t),t===R&&(D=Math.round(_.scrollLeft/B),j=!1)}),{passive:!0})}function ee(){var e=(0,l.gO)("window"),t=e.width,n=e.height;w.style.setProperty("--t","".concat(t,"px")),w.style.setProperty("--u","".concat(n,"px"))}function te(e,t,n,a){_.style.setProperty("--v",e.toString()),M.style.setProperty("--w",(n/10).toString()),k.style.setProperty("--x","".concat(t.toFixed(5),"px")),k.style.setProperty("--y",a.toFixed(5))}function ne(){var e=(new Date).getTime();W?(Y=-1+(0,o._M)(G),Q=.7*(Y-Q)):(Y=-1*Math.min(1,Math.max(0,Math.abs(e-z)/U)),Q=Y),L.style.setProperty("--z",Q.toString()),window.requestAnimationFrame((function(){$&&ne()}))}function ae(){var e=(0,c.zx)("i"),t=document.createElement("div");return t.classList.add("_"),t.id=e,t.setAttribute("stretched","false"),t.innerHTML='<div class="aa"><div class="ba"><div class="ca" code="-1"></div><div class="da" code="-1"></div></div><div class="ea"></div><div class="fa"></div><div class="ga"><div class="ha"><div class="ia" code="0"></div><div class="ja" code="0"></div></div><div class="ka" onclick="bus.location.stretchLocationItemBody(\''.concat(e,"')\">").concat((0,r.Z)("keyboard_arrow_down"),'</div><div class="la"></div></div></div><div class="ma" displayed="false"><div class="na"><div class="oa" highlighted="true" type="tab" onclick="bus.location.switchLocationBodyTab(\'').concat(e,'\', 0)" code="0"><div class="pa">').concat((0,r.Z)("directions_bus"),'</div>公車</div><div class="oa" highlighted="false" type="tab" onclick="bus.location.switchLocationBodyTab(\'').concat(e,'\', 1)" code="1"><div class="pa">').concat((0,r.Z)("departure_board"),'</div>抵達時間</div><div class="oa" highlighted="false" type="save-to-folder" onclick="bus.folder.openSaveToFolder(\'stop-on-location\', [\'').concat(e,'\', null, null])"><div class="pa">').concat((0,r.Z)("folder"),'</div>儲存至資料夾</div><div class="oa" highlighted="false" type="schedule-notification" onclick="bus.notification.openScheduleNotification(\'stop-on-location\', [\'').concat(e,'\', null, null, null])" enabled="true"><div class="pa">').concat((0,r.Z)("notifications"),'</div>設定到站通知</div></div><div class="qa" displayed="true"></div><div class="ra" displayed="false"></div></div>'),{element:t,id:e}}function re(){var e=document.createElement("div");return e.classList.add("wa"),{element:e,id:""}}function oe(){var e=document.createElement("div");return e.classList.add("xa"),e.innerHTML='<div class="ya"></div><div class="za"></div>',{element:e,id:""}}function ie(e,t,n){function a(e,a,o){function i(e,t,n){var a=e.getBoundingClientRect(),r=a.top,o=a.left,i=a.bottom,c=a.right,s=window.innerWidth,d=window.innerHeight,l=(0,u.aI)(e,".ha"),f=(0,u.aI)(l,".ia"),v=(0,u.aI)(l,".ja");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,n&&i>0&&r<d&&c>0&&o<s?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,v.classList.remove("_a")}),{once:!0}),v.classList.add("_a")):(v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text)}function s(e,t,n){var a=e.getBoundingClientRect(),r=a.top,o=a.left,i=a.bottom,c=a.right,s=window.innerWidth,d=window.innerHeight,l=(0,u.aI)(e,".ba"),f=(0,u.aI)(l,".ca"),v=(0,u.aI)(l,".da");f.setAttribute("code",t.ranking.code.toString()),f.innerText=t.ranking.text,n&&i>0&&r<d&&c>0&&o<s?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text,v.classList.remove("ab")}),{once:!0}),v.classList.add("ab")):(v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text)}function d(e,t){(0,u.aI)(e,".ea").innerText=t.route_direction}function l(e,t){(0,u.aI)(e,".fa").innerText=t.route_name}function f(e,t){(0,u.aI)(e,".qa").innerHTML=0===t.buses.length?'<div class="bb">目前沒有公車可顯示</div>':t.buses.map((function(e){return'<div class="cb" on-this-route="'.concat(e.onThisRoute,'"><div class="db"><div class="eb">').concat((0,r.Z)("directions_bus"),'</div><div class="fb">').concat(e.carNumber,'</div></div><div class="gb"><div class="hb">路線：').concat(e.RouteName,'</div><div class="ib">狀態：').concat(e.status.text,'</div><div class="jb">類型：').concat(e.type,"</div></div></div>")})).join("")}function v(e,t){(0,u.aI)(e,".ra").innerHTML=0===t.busArrivalTimes.length?'<div class="kb">目前沒有抵達時間可顯示</div>':t.busArrivalTimes.map((function(e){return'<div class="lb"><div class="mb"><div class="nb">'.concat((0,r.Z)("calendar_view_day"),'</div><div class="ob">').concat(e.personalSchedule.name,'</div><div class="pb">週').concat((0,h.kd)(e.day).name," ").concat((0,h.pn)(e.personalSchedule.period.start)," - ").concat((0,h.pn)(e.personalSchedule.period.end),'</div></div><div class="qb">').concat(e.chart,"</div></div>")})).join("")}function m(e,t){t&&e.setAttribute("stretched","false")}function g(e,t){e.setAttribute("animation",(0,c.xZ)(t))}function b(e,t){e.setAttribute("skeleton-screen",(0,c.xZ)(t))}function w(e,t){var n=(0,u.aI)(e,".ma"),a=(0,u.aI)(n,".na"),r=(0,u.aI)(a,'.oa[type="save-to-folder"]');r.setAttribute("onclick","bus.folder.openSaveToFolder('stop-on-location', ['".concat(e.id,"', ").concat(t.stopId,", ").concat(t.routeId,"])")),(0,p.LH)("stop",t.stopId).then((function(e){r.setAttribute("highlighted",(0,c.xZ)(e))}))}function I(e,t){var n=(0,u.aI)(e,".ma"),a=(0,u.aI)(n,".na"),r=(0,u.aI)(a,'.oa[type="schedule-notification"]');r.setAttribute("onclick","bus.notification.openScheduleNotification('stop-on-location', ['".concat(e.id,"', ").concat(t.stopId,", ").concat(t.routeId,", ").concat(t.status.time,"])"));var o=(0,y.Zc)(t.stopId);r.setAttribute("highlighted",(0,c.xZ)(o))}null===o?(i(e,a,n),s(e,a,n),d(e,a),l(e,a),f(e,a),v(e,a),m(e,t),g(e,n),b(e,t),w(e,a),I(e,a)):(a.status.time!==o.status.time&&(i(e,a,n),I(e,a)),o.ranking.number===a.ranking.number&&o.ranking.code===a.ranking.code||s(e,a,n),o.stopId!==a.stopId&&(d(e,a),l(e,a),w(e,a)),(0,c.hw)(o.buses,a.buses)||f(e,a),(0,c.hw)(o.busArrivalTimes,a.busArrivalTimes)||v(e,a),n!==E&&g(e,n),t!==P&&(m(e,t),b(e,t)))}function o(e,a,o){function i(e,t){(0,u.aI)(e,".ya").innerHTML=(0,r.Z)(t.icon)}function s(e,t){(0,u.aI)(e,".za").innerHTML=t.value}function d(e,t){e.setAttribute("animation",(0,c.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,c.xZ)(t))}null===o?(i(e,a),s(e,a),d(e,n),l(e,t)):((0,c.hw)(o.icon,a.icon)||i(e,a),(0,c.hw)(o.value,a.value)||s(e,a),n!==E&&d(e,n),t!==P&&l(e,t))}var i=(0,l.gO)("window"),d=i.width,f=i.height,v=e.groupQuantity,m=e.itemQuantity,g=e.groupedItems,b=e.groups;F=v,B=d;for(var w=0,I=0;I<v;I++){var M=(0,s.q_)(b["g_".concat(I)].name,500,"17px",'"Noto Sans TC", sans-serif')+V;O["g_".concat(I)]={width:M,offset:w},w+=M}var L=-1*O["g_".concat(D)].offset+.5*B-.5*O["g_".concat(D)].width;j||te(F,L,O["g_".concat(D)].width-V,D),S.innerHTML="<span>".concat(e.LocationName,"</span>"),S.setAttribute("animation",(0,c.xZ)(n)),S.setAttribute("skeleton-screen",(0,c.xZ)(t)),A.setAttribute("animation",(0,c.xZ)(n)),A.setAttribute("skeleton-screen",(0,c.xZ)(t)),T.setAttribute("skeleton-screen",(0,c.xZ)(t));var R,H=(0,u.jg)(_,".sa").length;if(v!==H){var C=H-v;if(C<0)for(var Z=0;Z<Math.abs(C);Z++){var U=(R=void 0,(R=document.createElement("div")).classList.add("sa"),R.innerHTML='<div class="ta"><div class="ua"></div></div><div class="va"></div>',{element:R,id:""});_.appendChild(U.element);var N=re();k.appendChild(N.element)}else for(var $=(0,u.jg)(_,".sa"),z=(0,u.jg)(k,".wa"),q=0;q<Math.abs(C);q++){var W=H-1-q;$[W].remove(),z[W].remove()}}for(var G=(0,u.jg)(_,".sa"),Q=0;Q<v;Q++){var Y="g_".concat(Q),J=G[Q],X=(0,u.jg)(J,".va ._").length;if(m[Y]!==X){var K=X-m[Y];if(K<0)for(var ee=(0,u.aI)(J,".va"),ne=0;ne<Math.abs(K);ne++){var ie=ae();ee.appendChild(ie.element)}else for(var ce=(0,u.jg)(J,".va ._"),se=0;se<Math.abs(K);se++){ce[X-1-se].remove()}}var ue=(0,u.jg)((0,u.jg)(_,".sa")[Q],".ta .ua .xa").length,de=b[Y].properties.length;if(de!==ue){var le=ue-de;if(le<0)for(var fe=(0,u.aI)(J,".ta"),ve=(0,u.aI)(fe,".ua"),he=0;he<Math.abs(le);he++){var pe=oe();ve.appendChild(pe.element)}else for(var ye=(0,u.aI)(J,".ta"),me=(0,u.aI)(ye,".ua"),ge=0;ge<Math.abs(le);ge++){var be=ue-1-ge;(0,u.jg)(me,".xa")[be].remove()}}}for(var we=0;we<v;we++){var Ie="g_".concat(we),Se=(0,u.jg)(k,".wa")[we];Se.innerHTML="<span>".concat(b[Ie].name,"</span>"),Se.style.setProperty("--rb","".concat(O[Ie].width,"px")),Se.style.setProperty("--sb",we.toString());for(var _e=(0,u.jg)(_,".sa")[we],Ae=b[Ie].properties.length,ke=0;ke<Ae;ke++){var Te=b[Ie].properties[ke],Me=(0,u.jg)(_e,".ta .ua .xa")[ke];if(x.hasOwnProperty("groups"))if(x.groups.hasOwnProperty(Ie))if(x.groups[Ie].properties[ke])o(Me,Te,x.groups[Ie].properties[ke]);else o(Me,Te,null);else o(Me,Te,null);else o(Me,Te,null)}for(var Le=0;Le<m[Ie];Le++){var xe=(0,u.jg)(_e,".va ._")[Le],Ee=g[Ie][Le];if(x.hasOwnProperty("groupedItems"))if(x.groupedItems.hasOwnProperty(Ie))if(x.groupedItems[Ie][Le])a(xe,Ee,x.groupedItems[Ie][Le]);else a(xe,Ee,null);else a(xe,Ee,null);else a(xe,Ee,null)}}x=e,E=n,P=t}function ce(){return se.apply(this,arguments)}function se(){var e;return e=function*(){var e=(0,i.Js)("playing_animation"),t=(0,i.Js)("refresh_interval"),n=(0,l.gO)("location-bus-arrival-time-chart");N=t.dynamic,C=t.baseInterval,W=!0,G=(0,c.zx)("r"),L.setAttribute("refreshing","true");var r=yield(0,a.R)(X,n.width,n.height,G);ie(r,!1,e);var o=0;N&&(o=yield(0,d.wz)()),z=(new Date).getTime(),q=N?Math.max(z+Z,r.dataUpdateTime+C/o):z+C,U=Math.max(Z,q-z),W=!1,L.setAttribute("refreshing","false")},se=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){b(o,a,r,i,c,"next",e)}function c(e){b(o,a,r,i,c,"throw",e)}i(void 0)}))},se.apply(this,arguments)}function ue(){ce().then((function(){$?setTimeout((function(){ue()}),Math.max(Z,q-(new Date).getTime())):J=!1})).catch((function(e){console.error(e),$?((0,f.a)("（地點）發生網路錯誤，將在".concat(H/1e3,"秒後重試。"),"error"),setTimeout((function(){ue()}),H)):J=!1}))}function de(e){(0,l.WR)("Location"),(0,v.XK)("location",e),X=e,D=0,w.setAttribute("displayed","true"),_.scrollLeft=0,function(){for(var e=(0,i.Js)("playing_animation"),t=(0,l.gO)("window"),n=(t.width,t.height),a={g_0:Math.floor(n/50)+5,g_1:Math.floor(n/50)+5},r={},o=0;o<2;o++){var c="g_".concat(o);r[c]=[];for(var s=0;s<a[c];s++)r[c].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}ie({groupedItems:r,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""}]}},itemQuantity:a,LocationName:"載入中",dataUpdateTime:0},!0,e)}(),$||($=!0,J?ce():(J=!0,ue()),Q=-1,Y=-1,ne()),(0,l.Z_)()}function le(){w.setAttribute("displayed","false"),$=!1,Q=-1,Y=-1,(0,l.l$)()}function fe(e){var t=(0,u.aI)(_,".sa .va ._#".concat(e)),n=(0,u.aI)(t,".ma");"true"===t.getAttribute("stretched")?("true"===t.getAttribute("animation")?n.addEventListener("transitionend",(function(){n.setAttribute("displayed","false")}),{once:!0}):n.setAttribute("displayed","false"),t.setAttribute("stretched","false")):(n.setAttribute("displayed","true"),t.setAttribute("stretched","true"))}function ve(e,t){var n,a=(0,u.aI)(_,".sa .va ._#".concat(e)),r=(0,u.aI)(a,".ma"),o=(0,u.aI)(r,".na"),i=m((0,u.jg)(o,'.oa[highlighted="true"][type="tab"]'));try{for(i.s();!(n=i.n()).done;){n.value.setAttribute("highlighted","false")}}catch(e){i.e(e)}finally{i.f()}switch((0,u.aI)(o,'.oa[code="'.concat(t,'"]')).setAttribute("highlighted","true"),t){case 0:(0,u.aI)(a,".qa").setAttribute("displayed","true"),(0,u.aI)(a,".ra").setAttribute("displayed","false");break;case 1:(0,u.aI)(a,".qa").setAttribute("displayed","false"),(0,u.aI)(a,".ra").setAttribute("displayed","true")}}},4572:(e,t,n)=>{n.d(t,{default:()=>ke});var a=n(5009),r=n(5767),o=n(7910),i=n(1531),c=n(4690),s=n(4474),u=n(8332),d=n(3030),l=n(9469),f=n(9856),v=n(9566),h=n(6082),p=n(3251),y=n(6104),m=n(6166),g=n(3459),b=n(904),w=n(3648),I=n(3041),S=n(8379),_=n(9333),A=n(9930),k=n(972),T=n(8024),M=n(4781),L=n(4537),x=n(9119);function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function D(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}var R="",F=(0,w.bv)(".tb"),O=(0,w.bv)(".ub"),B=(0,w.bv)(".vb");function j(e){var t=(0,T.zx)("i"),n=document.createElement("div");return n.id=t,n.classList.add("wb"),n.setAttribute("onclick","bus.folder.selectFolderIcon('".concat(e,"', '").concat(R,"')")),n.innerHTML=(0,L.Z)(e),{element:n,id:t}}function H(){var e;return e=function*(){var e=(0,w.aI)(B,".xb .yb");e.innerHTML="";var t,n=(0,T.zx)("r"),a=E(yield(0,A.z)(n));try{for(a.s();!(t=a.n()).done;){var r=j(t.value);e.appendChild(r.element)}}catch(e){a.e(e)}finally{a.f()}},H=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){D(o,a,r,i,c,"next",e)}function c(e){D(o,a,r,i,c,"throw",e)}i(void 0)}))},H.apply(this,arguments)}function C(e){var t=(0,w.aI)(B,".xb .zb"),n=(0,w.aI)(B,".xb .yb");if(t.innerHTML="",!(0,M.iO)(e)){var a,r=(0,k.U)(e,100),o=E(r);try{for(o.s();!(a=o.n()).done;){var i=j(a.value.item);t.appendChild(i.element)}}catch(e){o.e(e)}finally{o.f()}t.setAttribute("displayed",r.length>0?"true":"false"),n.setAttribute("displayed",r.length>0?"false":"true")}}function Z(){(0,b.kr)("FolderIconSelector"),B.setAttribute("displayed","false")}var U={noto_sans_tc:!1,material_symbols:!1};function N(e,t){if(!1===U[t]){var n=document.createElement("link");n.setAttribute("href",e),n.setAttribute("rel","stylesheet"),document.head.appendChild(n),U[t]=!0}}var $=n(6052),z=n(540),q=n(5579);function W(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return G(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function Q(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}function Y(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){Q(o,a,r,i,c,"next",e)}function c(e){Q(o,a,r,i,c,"throw",e)}i(void 0)}))}}var J=(0,w.bv)(".lc"),X=(0,w.aI)(J,".mc"),V=(0,w.aI)(X,".nc"),K=(0,w.aI)(V,".oc"),ee=(0,w.aI)(V,".pc"),te=(0,w.aI)(X,".qc"),ne=(0,w.aI)(te,'.rc[name="total-data-usage"] .sc'),ae=(0,w.aI)(te,'.rc[name="start-time"] .sc'),re=(0,w.aI)(te,'.rc[name="end-time"] .sc');function oe(){return(oe=Y((function*(e){var t=(0,b.gO)("window"),n=t.width,a=Math.min(5/18*n,.33*t.height),r=yield(0,o.Ti)(e,n,a,20);"string"==typeof r?K.innerHTML=r:!1===r&&(K.innerText="目前資料不足，無法描繪圖表。")}))).apply(this,arguments)}function ie(){return(ie=Y((function*(){var e=yield(0,o.Uc)(),t=yield(0,o.rN)();ne.innerText=e,ae.innerText=(0,q.$T)(t.start,"YYYY-MM-DD hh:mm:ss"),re.innerText=(0,q.$T)(t.end,"YYYY-MM-DD hh:mm:ss")}))).apply(this,arguments)}function ce(){se("daily"),function(){ie.apply(this,arguments)}()}function se(e){var t,n=W((0,w.jg)(ee,".tc"));try{for(n.s();!(t=n.n()).done;){var a=t.value;a.getAttribute("period")===e?a.setAttribute("highlighted","true"):a.setAttribute("highlighted","false")}}catch(e){n.e(e)}finally{n.f()}!function(e){oe.apply(this,arguments)}(e)}var ue=n(2994),de=n(7891),le=n(8380),fe=n(5693),ve=n(6483),he=n(4927),pe=n(5314),ye=n(6091),me=n(7908),ge=n(4636),be=n(752),we=n(2174),Ie=n(9009),Se=n(7599),_e=!1,Ae=!1;window.bus={initialize:function(){!1===_e&&(_e=!0,(0,b.BM)(),(0,g.Yq)().then((function(){var e=(0,w.bv)(".uc .vc .wc");(0,ye.Q)(e);var t=(0,w.bv)(".uc .vc .xc");(0,z.F)(t),(0,p.A)().then((function(e){"ok"===e&&(0,Se.P)().then((function(){(0,c.S5)(),(0,d.s_)(),(0,c.aB)(),(0,d.uj)(),(0,f.mr)(),window.addEventListener("resize",(function(){(0,c.aB)(),(0,d.uj)(),(0,f.mr)()})),screen&&screen.orientation&&screen.orientation.addEventListener("change",(function(){(0,c.aB)(),(0,d.uj)(),(0,f.mr)()})),(0,ye.u)(),(0,v.Rh)().then((function(){(0,z.a)()}));var e=window.matchMedia("(prefers-color-scheme: dark)"),t=(0,w.bv)(".yc .zc ._c #search_input");e.addEventListener("change",(function(){(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("paste",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("cut",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("selectionchange",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),document.addEventListener("selectionchange",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)})),t.addEventListener("keyup",(function(){(0,a.RC)(t.value),(0,f.gn)(t.value,t.selectionStart,t.selectionEnd)}));var n=(0,w.bv)(".vb .ad .bd #search_material_symbols_input");n.addEventListener("paste",(function(){C(n.value)})),n.addEventListener("cut",(function(){C(n.value)})),n.addEventListener("selectionchange",(function(){C(n.value)})),document.addEventListener("selectionchange",(function(){C(n.value)})),n.addEventListener("keyup",(function(){C(n.value)})),(0,l._)(),(0,b.AE)((function(){(0,ge.Db)(),(0,ge.cS)().then((function(){(0,ge.z9)()})),(0,i.to)()}))})),"fetchError"!==e&&"unknownError"!==e||((0,b.AE)(),alert(e))})).catch((function(e){(0,b.AE)(),alert(e)}))})))},secondlyInitialize:function(){Ae||(Ae=!0,N("https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap","noto_sans_tc"),N("https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200","material_symbols"),(0,h.X)(),(0,r.fV)(),(0,o.HJ)(),(0,ve.$t)(),(0,pe.FU)(),(0,r.fV)().then((function(){(0,r.MN)().then((function(){(0,r.cy)()}))})))},route:{stretchRouteItemBody:c.q0,openRoute:c.SR,closeRoute:c.U7,switchRoute:c.Ch,switchRouteBodyTab:c.py,openRouteDetails:s.GS,closeRouteDetails:s.GZ,shareRoutePermalink:u.w,switchCalendarDay:Ie.f4},location:{openLocation:d.so,closeLocation:d.eS,stretchLocationItemBody:d.Ms,switchLocationBodyTab:d.dM},folder:{openSaveToFolder:I.BI,closeSaveToFolder:I.nS,openFolderManager:S.g,closeFolderManager:S.m,openFolderEditor:_.uy,closeFolderEditor:_.I6,openFolderIconSelector:function(e){var t;switch((0,b.WR)("FolderIconSelector"),e){case"editor":R="editor",t=(0,w.aI)(F,'._b .ac .bc[group="folder-icon"] .cc .dc .jc');break;case"creator":R="creator",t=(0,w.aI)(O,'.ec .fc .gc[group="folder-icon"] .hc .ic .kc')}"false"===t.getAttribute("disabled")&&(h.m?(B.setAttribute("displayed","true"),function(){H.apply(this,arguments)}(R),(0,k.L)()):(0,x.a)("資料還在下載中","download_for_offline"))},closeFolderIconSelector:Z,openFolderCreator:$.pd,closeFolderCreator:$.z1,createFormulatedFolder:$.c6,saveEditedFolder:_.Bo,selectFolderIcon:function(e){var t;switch(R){case"editor":t=(0,w.aI)(F,'._b .ac .bc[group="folder-icon"] .cc .dc input');break;case"creator":t=(0,w.aI)(O,'.ec .fc .gc[group="folder-icon"] .hc .ic input')}t.value=e,Z()},saveStopItemOnRoute:I.JL,saveStopItemOnLocation:I.Lb,saveRouteOnDetailsPage:I.Dh,saveRouteOnRoute:I.jD,removeItemOnFolderEditor:_.cG,moveItemOnFolderEditor:_.Lq},search:{openSearch:a.rf,closeSearch:a.Bb,typeTextIntoInput:f._O,deleteCharFromInout:f.d$,emptyInput:f.Wb,openSystemKeyboard:f.vp},storage:{openStorage:ue.G,closeStorage:ue.Q},dataUsage:{openDataUsage:function(){(0,b.WR)("DataUsage"),J.setAttribute("displayed","true"),ce(),(0,b.Z_)()},closeDataUsage:function(){J.setAttribute("displayed","false"),(0,b.l$)()},switchDataUsageGraphAggregationPeriod:se},personalSchedule:{openPersonalScheduleManager:de.z,closePersonalScheduleManager:de.Z,openPersonalScheduleCreator:le.I1,closePersonalScheduleCreator:le.GJ,createFormulatedPersonalSchedule:le.Ps,switchPersonalScheduleCreatorDay:le.om,openPersonalScheduleEditor:fe.bF,closePersonalScheduleEditor:fe.Xy,switchPersonalScheduleEditorDay:fe.Dn,saveEditedPersonalSchedule:fe.gv},settings:{openSettings:y.Ow,closeSettings:y.os,openSettingsOptions:m.yH,closeSettingsOptions:m.wx,settingsOptionsHandler:m.Yi,downloadExportFile:y.vv,openFileToImportData:y.rY,viewCommitOfCurrentVersion:y.hP,showPromptToAskForPersistentStorage:y.jk},bus:{openBus:he.$,closeBus:he.F},notification:{openNotificationScheduleManager:we.Sv,closeNotificationScheduleManager:we.m_,openRegisterNotification:me.XG,closeRegisterNotification:me.hy,saveFormulatedRegisterNotification:me.NW,openScheduleNotification:be.Ho,closeScheduleNotification:be.b$,scheduleNotificationForStopItemOnRoute:be.H9,scheduleNotificationForStopItemOnLocation:be.b6,cancelNotificationOnNotificationScheduleManager:we.Gv}};const ke=window.bus},4927:(e,t,n)=>{n.d(t,{F:()=>w,$:()=>b});var a=n(6160),r=n(5314),o=n(3459),i=n(8024),c=n(3648),s=n(904),u=n(4537),d=[],l=!1,f=!0;function v(e,t,n,a){function r(e,t,r){function o(e,t){(0,c.aI)(e,".dd").innerHTML=(0,u.Z)(t.icon)}function s(e,t){(0,c.aI)(e,".ed").innerText=t.value}function d(e,t){e.setAttribute("animation",t)}function v(e,t){e.setAttribute("skeleton-screen",t)}null===r?(o(e,t),s(e,t),v(e,n),d(e,a)):((0,i.hw)(r,t)||o(e,t),(0,i.hw)(r,t)||s(e,t),n!==l&&v(e,n),a!==f&&d(e,a))}var o,s=t.length,v=(0,c.jg)(e,".fd .cd").length;if(s!==v){var h=v-s;if(h<0)for(var p=0;p<Math.abs(h);p++){var y=(o=void 0,(o=document.createElement("div")).classList.add("cd"),o.innerHTML='<div class="dd"></div><div class="ed"></div>',{element:o,id:""});(0,c.aI)(e,".fd").appendChild(y.element)}else for(var m=0;m<Math.abs(h);m++){var g=v-1-m;(0,c.jg)(e,".fd .cd")[g].remove()}}for(var b=(0,c.jg)(e,".fd .cd"),w=0;w<s;w++){var I=b[w],S=t[w];0===d.length?r(I,S,null):r(I,S,d[w])}d=t,f=a,l=n}function h(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}var p=(0,c.bv)(".gd"),y=((0,c.aI)(p,".hd"),(0,c.aI)(p,".id")),m=(0,c.aI)(y,".jd"),g=(0,c.aI)(m,'.kd[group="properties"]');(0,c.aI)(m,'.kd[group="location"]');function b(e){(0,s.WR)("Bus"),(0,r.XK)("bus",e),p.setAttribute("displayed","true"),function(e){I.apply(this,arguments)}(e),(0,s.Z_)()}function w(){p.setAttribute("displayed","false"),(0,s.l$)()}function I(){var e;return e=function*(e){!function(e){for(var t=(0,o.Js)("playing_animation"),n=[],a=0;a<5;a++)n.push({key:a,icon:"none",value:""});v(e,n,!0,t)}(g);var t=(0,o.Js)("playing_animation"),n=(0,i.zx)("r"),r=yield(0,a.i)(e,n);v(g,r.properties,!1,t)},I=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){h(o,a,r,i,c,"next",e)}function c(e){h(o,a,r,i,c,"throw",e)}i(void 0)}))},I.apply(this,arguments)}},6052:(e,t,n)=>{n.d(t,{c6:()=>f,pd:()=>v,z1:()=>h});var a=n(9566),r=n(3648),o=n(904),i=n(9119),c=(0,r.bv)(".ub"),s=(0,r.aI)(c,".ec"),u=(0,r.aI)(s,".fc"),d=(0,r.aI)(u,'.gc[group="folder-name"] .hc input'),l=(0,r.aI)(u,'.gc[group="folder-icon"] .hc .ic input');function f(){var e=d.value,t=l.value;(0,a.vV)(e,t).then((function(e){e?(h(),(0,i.a)("已建立資料夾","folder")):(0,i.a)("無法建立資料夾","error")}))}function v(){(0,o.WR)("FolderCreator"),c.setAttribute("displayed","true"),(0,o.Z_)()}function h(){c.setAttribute("displayed","false"),(0,o.l$)()}},7123:(e,t,n)=>{n.d(t,{R:()=>g});var a=n(6483),r=n(6802),o=n(7810),i=n(2063),c=n(8011),s=n(4293),u=n(1932),d=n(424),l=n(2303),f=n(6788),v=n(3459),h=n(1531);function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function m(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}function g(e,t,n,a,r){return b.apply(this,arguments)}function b(){var e;return e=function*(e,t,n,y,m){(0,f.Mf)(m,"getRoute_0",0,!1),(0,f.Mf)(m,"getRoute_1",0,!1),(0,f.Mf)(m,"getStop_0",0,!1),(0,f.Mf)(m,"getStop_1",0,!1),(0,f.Mf)(m,"getLocation_0",0,!1),(0,f.Mf)(m,"getLocation_1",0,!1),(0,f.Mf)(m,"getSegmentBuffers_0",0,!1),(0,f.Mf)(m,"getSegmentBuffers_1",0,!1),(0,f.Mf)(m,"getEstimateTime_0",0,!1),(0,f.Mf)(m,"getEstimateTime_1",0,!1),(0,f.Mf)(m,"getBusEvent_0",0,!1),(0,f.Mf)(m,"getBusEvent_1",0,!1),(0,f.Mf)(m,"getBusData_0",0,!1),(0,f.Mf)(m,"getBusData_1",0,!1);var g=yield(0,s.a)(m,!0),b=yield(0,d.T)(m),w=yield(0,c.g)(m,!1),I=yield(0,u.L)(m),S=yield(0,i.K)(m),_=yield(0,o.J)(m),A=yield(0,r.d)(m),k=yield(0,a.Io)(n,y),T=(0,l.w_)(_,A,g,e,t),M=!1,L={};I.hasOwnProperty("r_".concat(e))&&(M=!0,L=I["r_".concat(e)]);var x,E=(0,v.Js)("time_formatting_mode"),P=[],D=[],R=p(S);try{for(R.s();!(x=R.n()).done;){var F=x.value,O={},B=F.RouteID;if([e,10*e].includes(B)||t.includes(B)){O.status=(0,l.$Q)(null==F?void 0:F.EstimateTime,E);var j="s_".concat(F.StopID),H={};if(!b.hasOwnProperty(j))continue;H=b[j],O.id=F.StopID,O.sequence=H.seqNo,O.goBack=H.goBack;var C="l_".concat(H.stopLocationId),Z={};if(!w.hasOwnProperty(C))continue;Z=w[C],O.name=Z.n,O.overlappingRoutes=Z.r.filter((function(t){return t!==e})).map((function(e){var t="r_".concat(e);if(g.hasOwnProperty(t)){var n=g[t];return{name:n.n,RouteEndPoints:{RouteDeparture:n.dep,RouteDestination:n.des,text:"".concat(n.dep," ↔ ").concat(n.des),html:"<span>".concat(n.dep,"</span><span>↔</span><span>").concat(n.des,"</span>")},RouteID:n.id,PathAttributeId:n.pid}}return null})).filter((function(e){return!(null===e)})),O.position={longitude:Z.lo,latitude:Z.la},D.push({latitude:Z.la,longitude:Z.lo,id:F.StopID});var U,N=[],$=p(Z.s);try{for($.s();!(U=$.n()).done;){var z=U.value,q="s_".concat(z);T.hasOwnProperty(q)&&N.push(T[q].map((function(e){return(0,l.s$)(e)})))}}catch(e){$.e(e)}finally{$.f()}O.buses=N.flat().sort((function(e,t){return e.index-t.index}));var W=[];k.hasOwnProperty(j)&&(W=k[j]),O.busArrivalTimes=W;var G=!1,Q=!1,Y=!1,J=!1;if(M){var X="g_".concat(O.goBack),V=[];L.hasOwnProperty(X)?V=L[X]:"1"===O.goBack&&(J=!0,V=L.g_0);var K,ee=p(V);try{for(ee.s();!(K=ee.n()).done;){var te=K.value;te.OriginStopID!==F.StopID&&te.DestinationStopID!==F.StopID||(G=!0),J?(te.OriginStopID===F.StopID&&(Y=!0),te.DestinationStopID===F.StopID&&(Q=!0)):(te.OriginStopID===F.StopID&&(Q=!0),te.DestinationStopID===F.StopID&&(Y=!0))}}catch(e){ee.e(e)}finally{ee.f()}}O.segmentBuffer={isSegmentBuffer:G,isStartingPoint:Q,isEndingPoint:Y},P.push(O)}}}catch(e){R.e(e)}finally{R.f()}P.sort((function(e,t){return e.sequence-t.sequence}));for(var ne=(0,h.uQ)(D,450),ae=!1,re=!1,oe={},ie=0,ce={},se=P.length,ue=0;ue<se;ue++){var de=P[ue],le=P[ue+1]||de,fe=0;if(de.buses.length>0&&de.buses[0].onThisRoute){var ve=[de.buses[0].position.longitude,de.buses[0].position.latitude],he=ve[0],pe=ve[1],ye=[de.position.longitude,de.position.latitude],me=ye[0],ge=ye[1],be=[le.position.longitude,le.position.latitude],we=be[0],Ie=be[1];if((he-me)*(we-he)+(pe-ge)*(Ie-pe)>=0){var Se=Math.hypot(he-me,pe-ge),_e=Math.hypot(he-we,pe-Ie);fe=Math.max(0,Math.min(Se/(Se+_e),1))}}de.progress=fe,de.segmentBuffer.isStartingPoint&&(ae=!0),de.segmentBuffer.isEndingPoint&&ae&&(re=!0),ae&&!re&&(de.segmentBuffer.isSegmentBuffer=!0),ae&&re&&(ae=!1,re=!1);var Ae=!1;null!==ne&&ne.id===de.id&&(Ae=!0),de.nearest=Ae;var ke="g_".concat(de.goBack)||0;oe.hasOwnProperty(ke)||(oe[ke]=[],ce[ke]=0,ie+=1),oe[ke].push(de),ce[ke]+=1}var Te=g["r_".concat(e)],Me={groupedItems:oe,groupQuantity:ie,itemQuantity:ce,RouteName:Te.n,RouteEndPoints:{RouteDeparture:Te.dep,RouteDestination:Te.des},dataUpdateTime:(0,f.Zt)(m),RouteID:e,PathAttributeId:t};return(0,f.LQ)(m),(0,f.gC)(m),Me},b=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){m(o,a,r,i,c,"next",e)}function c(e){m(o,a,r,i,c,"throw",e)}i(void 0)}))},b.apply(this,arguments)}},8379:(e,t,n)=>{n.d(t,{g:()=>v,m:()=>h});var a=n(9566),r=n(8024),o=n(3648),i=n(4537),c=n(904);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function d(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}function l(e){var t=(0,r.zx)("i"),n=document.createElement("div");return n.classList.add("ld"),n.id=t,n.setAttribute("onclick","bus.folder.openFolderEditor('".concat(e.id,"')")),n.innerHTML='<div class="md">'.concat((0,i.Z)(e.icon),'</div><div class="nd">').concat(e.name,'</div><div class="od">').concat(e.contentLength,'</div><div class="pd">').concat((0,i.Z)("arrow_forward_ios"),"</div>"),{element:n,id:t}}function f(){var e;return e=function*(){var e=(0,o.bv)(".qd"),t=(0,o.aI)(e,".rd .sd");t.innerHTML="";var n,r=s(yield(0,a.Xi)());try{for(r.s();!(n=r.n()).done;){var i=l(n.value);t.appendChild(i.element)}}catch(e){r.e(e)}finally{r.f()}},f=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){d(o,a,r,i,c,"next",e)}function c(e){d(o,a,r,i,c,"throw",e)}i(void 0)}))},f.apply(this,arguments)}function v(){(0,c.WR)("FolderManager"),(0,o.bv)(".qd").setAttribute("displayed","true"),function(){f.apply(this,arguments)}()}function h(){(0,c.kr)("FolderManager"),(0,o.bv)(".qd").setAttribute("displayed","false")}},8621:(e,t,n)=>{n.d(t,{p:()=>v});var a=n(2303),r=n(313),o=n(4293),i=n(8201),c=n(8671),s=n(5579),u=n(6788);function d(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function v(e,t,n){return h.apply(this,arguments)}function h(){var e;return e=function*(e,t,n){var d=function(e,t){var n,a={},r=l(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.Id===t){a=o;break}}}catch(e){r.e(e)}finally{r.f()}return a}(yield(0,o.a)(n,!1),e),f=yield(0,i.Y)(n),v=yield(0,c.s)(n),h=yield(0,r.s)(n),p=function(e){var t=(0,a.aU)(e.goFirstBusTime,0),n=(0,a.aU)(e.goLastBusTime,0),r=(0,a.aU)(e.backFirstBusTime,0),o=(0,a.aU)(e.backLastBusTime,0),i=(0,a.aU)(e.holidayGoFirstBusTime,0),c=(0,a.aU)(e.holidayGoLastBusTime,0),s=(0,a.aU)(e.holidayBackFirstBusTime,0),u=(0,a.aU)(e.holidayBackLastBusTime,0),d=(0,a.aU)(e.peakHeadway,1),l=(0,a.aU)(e.offPeakHeadway,1),f=(0,a.aU)(e.holidayPeakHeadway,1),v=(0,a.aU)(e.holidayOffPeakHeadway,1);return{go:{weekday:{first:t,last:n,rushHourWindow:d,offRushHourWindow:l},holiday:{first:i,last:c,rushHourWindow:f,offRushHourWindow:v}},back:{weekday:{first:r,last:o,rushHourWindow:d,offRushHourWindow:l},holiday:{first:s,last:u,rushHourWindow:f,offRushHourWindow:v}},realSequence:e.realSequence}}(d),y=function(e,t,n,r,o){var i,c={calendarDays:{d_0:{name:"日",day:0,code:"d_0"},d_1:{name:"一",day:1,code:"d_1"},d_2:{name:"二",day:2,code:"d_2"},d_3:{name:"三",day:3,code:"d_3"},d_4:{name:"四",day:4,code:"d_4"},d_5:{name:"五",day:5,code:"d_5"},d_6:{name:"六",day:6,code:"d_6"}},calendarDayQuantity:7,calendarEventGroups:{d_0:[],d_1:[],d_2:[],d_3:[],d_4:[],d_5:[],d_6:[]},calendarEventQuantity:{d_0:0,d_1:0,d_2:0,d_3:0,d_4:0,d_5:0,d_6:0}},u=(0,s.P$)(),d=l(r);try{for(d.s();!(i=d.n()).done;){var f=i.value;if(t.indexOf(f.PathAttributeId)>-1&&"0"===f.DateType)for(var v=(0,s.mr)(f.DateValue),h=(0,s.S1)(u,v.day,0,0),p=(0,a.aU)(f.StartTime,0),y=(0,s.S1)(h,0,p.hours,p.minutes),m=(0,a.aU)(f.EndTime,0),g=(0,s.S1)(h,0,m.hours,m.minutes),b=Math.abs(60*m.hours+m.minutes-(60*p.hours+p.minutes)),w=parseInt(f.LongHeadway),I=parseInt(f.LowHeadway),S=(I+w)/2,_=b/S,A=0;A<_;A++){var k=!1,T=(0,s.S1)(h,0,p.hours,p.minutes+I*A);T.getTime()<y.getTime()&&(k=!0),T.getTime()>g.getTime()&&(k=!0),!1===k&&(c.calendarEventGroups[v.code].push({date:T,dateString:(0,s.$T)(T,"hh:mm"),duration:I,deviation:Math.abs(S-I)}),c.calendarEventQuantity[v.code]+=1)}}}catch(e){d.e(e)}finally{d.f()}var M,L=l(o);try{for(L.s();!(M=L.n()).done;){var x=M.value;if(t.indexOf(x.PathAttributeId)>-1&&"0"===x.DateType){var E=(0,s.mr)(x.DateValue),P=(0,s.S1)(u,E.day,0,0),D=(0,a.aU)(x.DepartureTime,0),R=(0,s.S1)(P,0,D.hours,D.minutes);c.calendarEventGroups[E.code].push({date:R,dateString:(0,s.$T)(R,"hh:mm"),duration:15,deviation:0}),c.calendarEventQuantity[E.code]+=1}}}catch(e){L.e(e)}finally{L.f()}for(var F in c.calendarEventGroups)c.calendarEventGroups[F].sort((function(e,t){return e.date.getTime()-t.date.getTime()}));return c}(0,t,0,f,v),m=function(e,t){var n,a={},r=l(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.id===t&&(a=o)}}catch(e){r.e(e)}finally{r.f()}return a}(h,d.providerId),g={timeTableRules:p,calendar:y,properties:[{key:"route_name",icon:"route",value:d.nameZh},{key:"pricing",icon:"attach_money",value:d.ticketPriceDescriptionZh},{key:"provider_name",icon:"corporate_fare",value:m.nameZn},{key:"provider_phone",icon:"call",value:m.phoneInfo},{key:"provider_email",icon:"alternate_email",value:m.email}]};return(0,u.LQ)(n),(0,u.gC)(n),g},h=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){d(o,a,r,i,c,"next",e)}function c(e){d(o,a,r,i,c,"throw",e)}i(void 0)}))},h.apply(this,arguments)}},9333:(e,t,n)=>{n.d(t,{Bo:()=>M,I6:()=>A,Lq:()=>T,cG:()=>k,uy:()=>_});var a=n(9566),r=n(8024),o=n(3648),i=n(904),c=n(4537),s=n(9119);function u(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var f=(0,o.bv)(".tb"),v=(0,o.aI)(f,".td"),h=(0,o.aI)(v,".ud"),p=(0,o.aI)(f,"._b"),y=(0,o.aI)(p,".ac"),m=(0,o.aI)(y,'.bc[group="folder-name"] .cc input'),g=(0,o.aI)(y,'.bc[group="folder-icon"] .cc .dc input'),b=(0,o.aI)(y,'.bc[group="folder-icon"] .cc .dc .jc'),w=(0,o.aI)(y,'.bc[group="folder-content"] .cc');function I(e,t){var n=(0,r.zx)("i"),a=document.createElement("div");a.id=n,a.classList.add("vd"),a.setAttribute("type",t.type);var o="",i="",s="";switch(t.type){case"stop":s="location_on",o="".concat(t.route?t.route.name:""," - 往").concat(t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""),i=t.name;break;case"route":s="route",o="".concat(t.endPoints.departure," ↔ ").concat(t.endPoints.destination),i=t.name;break;case"bus":o="",i=t.name;break;case"empty":s="lightbulb",o="提示",i="沒有內容";break;default:s="",o="null",i="null"}return a.innerHTML='<div class="wd">'.concat((0,c.Z)(s),'</div><div class="xd">').concat(o,'</div><div class="yd">').concat(i,'</div><div class="zd"><div class="_d" onclick="bus.folder.moveItemOnFolderEditor(\'').concat(n,"', '").concat(e.id,"', '").concat(t.type,"', ").concat(t.id,", 'up')\">").concat((0,c.Z)("keyboard_arrow_down"),'</div><div class="ae" onclick="bus.folder.moveItemOnFolderEditor(\'').concat(n,"', '").concat(e.id,"', '").concat(t.type,"', ").concat(t.id,", 'down')\">").concat((0,c.Z)("keyboard_arrow_down"),'</div><div class="be" onclick="bus.folder.removeItemOnFolderEditor(\'').concat(n,"', '").concat(e.id,"', '").concat(t.type,"', ").concat(t.id,')">').concat((0,c.Z)("delete"),'</div><div class="ce"></div><div class="ce"></div></div>'),{element:a,id:n}}function S(){var e;return e=function*(e){!function(e,t){m.value=e.name,g.value=e.icon,e.default?(m.setAttribute("readonly","readonly"),g.setAttribute("readonly","readonly"),b.setAttribute("disabled","true")):(m.removeAttribute("readonly"),g.removeAttribute("readonly"),b.setAttribute("disabled","false")),h.setAttribute("onclick","bus.folder.saveEditedFolder('".concat(e.id,"')")),w.innerHTML="";var n,a=d(t);try{for(a.s();!(n=a.n()).done;){var r=I(e,n.value);w.appendChild(r.element)}}catch(e){a.e(e)}finally{a.f()}}(yield(0,a.L2)(e),yield(0,a.eD)(e))},S=function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){u(o,a,r,i,c,"next",e)}function c(e){u(o,a,r,i,c,"throw",e)}i(void 0)}))},S.apply(this,arguments)}function _(e){(0,i.WR)("FolderEditor"),f.setAttribute("displayed","true"),function(e){S.apply(this,arguments)}(e),(0,i.Z_)()}function A(){f.setAttribute("displayed","false"),(0,i.l$)()}function k(e,t,n,r){var i=(0,o.aI)(f,'._b .ac .bc[group="folder-content"] .cc .vd#'.concat(e));(0,a.NC)(t,n,r).then((function(e){if(e)switch(i.remove(),n){case"stop":(0,s.a)("已移除站牌","delete");break;case"route":(0,s.a)("已移除路線","delete")}else(0,s.a)("無法移除","error")}))}function T(e,t,n,r,i){var c=(0,o.aI)(f,'._b .ac .bc[group="folder-content"] .cc .vd#'.concat(e));(0,a.bq)(t,n,r,i).then((function(e){if(e)switch(i){case"up":var t=c.previousElementSibling;t&&c.parentNode.insertBefore(c,t),(0,s.a)("已往上移","arrow_circle_up");break;case"down":var n=c.nextElementSibling;n&&c.parentNode.insertBefore(n,c),(0,s.a)("已往下移","arrow_circle_down")}else(0,s.a)("無法移動","error")}))}function M(e){var t=m.value,n=g.value;(0,a.g$)(e,t,n),A()}}}]);
//# sourceMappingURL=60424594188970273dd3.js.map