"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[139],{540(e,t,a){a.d(t,{a:()=>B,b:()=>U});var n=a(467),i=a(5767),s=a(9566),r=a(3459),o=a(8179),c=a(8024),d=a(4537),u=a(904),l=a(3030),f=a(9119),p=a(4690),m=(0,o.c)(".fe"),h=(0,o.e)(m,".ke"),b=(0,o.e)(m,".te"),v=(0,o.e)(b,".ff"),y=(0,o.e)(h,".pe .qe"),g={},k=!1,L=!1,w=15e3,C=5e3,A=15e3,x=!0,T=0,_=0,P="",I=!1,M=!1,D=!1;function E(){var e=(0,o.a)();e.classList.add("lf"),e.setAttribute("type","stop");var t=(0,o.a)();t.classList.add("mf"),t.appendChild((0,d.b)("location_on"));var a=(0,o.a)();a.classList.add("nf");var n=(0,o.a)();n.classList.add("of");var i=(0,o.a)();i.classList.add("pf");var s=(0,o.a)();s.classList.add("sf");var r=(0,o.a)();r.classList.add("tf"),r.setAttribute("code","0"),r.setAttribute("displayed","false");var c=(0,o.a)();c.classList.add("uf"),c.setAttribute("code","0"),c.setAttribute("displayed","true"),s.appendChild(r),s.appendChild(c);var u=(0,o.a)();u.classList.add("qf"),u.appendChild((0,d.b)("keyboard_arrow_right"));var l=(0,o.a)();return l.classList.add("rf"),i.appendChild(s),i.appendChild(u),i.appendChild(l),e.appendChild(t),e.appendChild(a),e.appendChild(n),e.appendChild(i),e}function S(){var e=(0,o.a)();e.classList.add("gf");var t=(0,o.a)();t.classList.add("hf");var a=(0,o.a)();a.classList.add("if"),a.appendChild((0,d.a)());var n=(0,o.a)();n.classList.add("jf"),t.appendChild(a),t.appendChild(n);var i=(0,o.a)();return i.classList.add("kf"),e.appendChild(t),e.appendChild(i),e}function $(e){var t=e;if(I){var a=t.detail.progress-1;y.style.setProperty("--ie",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,$)}function U(){for(var e=(0,r.b)("playing_animation"),t=(0,u.e)("window"),a=(t.width,t.height),n=Math.floor(a/50/3)+2,i=[],s=0;s<3;s++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:n},c=0;c<n;c++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}j({folders:i,dataUpdateTime:0},!0,e)}function j(e,t,a){function n(e,n,i){function s(e,t){e.setAttribute("type",t.type)}function r(e,t){var a=(0,o.e)(e,".mf"),n="";switch(t.type){case"stop":case"location":n="location_on";break;case"route":n="route";break;case"bus":n="directions_bus";break;case"empty":n="lightbulb";break;default:n=""}(0,d.c)(a,n)}function u(e,t,a){if("stop"===t.type){var n=e.getBoundingClientRect(),i=n.top,s=n.left,r=n.bottom,c=n.right,d=window.innerWidth,u=window.innerHeight,l=(0,o.e)(e,".pf .sf"),f=(0,o.e)(l,".tf"),p=(0,o.e)(l,".uf");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,a&&r>0&&i<u&&c>0&&s<d?(p.addEventListener("animationend",function(){p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text,p.classList.remove("wf"),f.setAttribute("displayed","false")},{once:!0}),f.setAttribute("displayed","true"),p.classList.add("wf")):(p.setAttribute("code",t.status.code.toString()),p.innerText=t.status.text)}}function f(e,t){var a="";switch(t.type){case"stop":case"route":case"location":a=t.name;break;case"bus":a=t.busID;break;case"empty":a="沒有內容";break;default:a="null"}(0,o.e)(e,".of").innerText=a}function m(e,t){var a="";switch(t.type){case"stop":a=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":a=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"location":a="地點";break;case"bus":break;case"empty":a="提示";break;default:a="null"}(0,o.e)(e,".nf").innerText=a}function h(e,t){var a=(0,o.e)(e,".pf .qf");switch(t.type){case"stop":a.onclick=function(){(0,p.c)(t.route.id,t.route.pathAttributeId)};break;case"route":a.onclick=function(){(0,p.c)(t.id,t.pathAttributeId)};break;case"location":a.onclick=function(){(0,l.c)(t.id)}}}function b(e,t){e.setAttribute("animation",(0,c.a)(t))}function v(e,t){e.setAttribute("skeleton-screen",(0,c.a)(t))}if(null==i)s(e,n),r(e,n),u(e,n,a),f(e,n),m(e,n),h(e,n),b(e,a),v(e,t);else if(n.type!==i.type)s(e,n),r(e,n),u(e,n,a),f(e,n),m(e,n),h(e,n),b(e,a),v(e,t);else{switch(n.type){case"stop":(0,c.b)(i.route,n.route)||(m(e,n),h(e,n)),i.name!==n.name&&f(e,n),i.status.time!==n.status.time&&u(e,n,a);break;case"route":i.id!==n.id&&h(e,n),(0,c.b)(i.endPoints,n.endPoints)||m(e,n),i.name!==n.name&&f(e,n);break;case"location":i.id!==n.id&&h(e,n),i.name!==n.name&&f(e,n);break;case"bus":default:break;case"empty":n.type!==i.type&&(m(e,n),f(e,n))}t!==L&&v(e,t),a!==k&&b(e,a)}}function i(e,n,i){function s(e,t){var a=(0,o.e)(e,".hf");(0,o.e)(a,".jf").innerText=t.name}function r(e,t){var a=(0,o.e)(e,".hf"),n=(0,o.e)(a,".if");(0,d.c)(n,t.icon)}function u(e,t){e.setAttribute("animation",(0,c.a)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,c.a)(t))}null==i?(s(e,n),r(e,n),u(e,a),l(e,t)):(n.name!==i.name&&s(e,n),n.icon!==i.icon&&r(e,n),a!==k&&u(e,a),t!==L&&l(e,t))}var s=e.folders,r=s.length,u=Array.from((0,o.d)(v,".gf")),f=u.length;if(r!==f){var m=f-r;if(m<0){for(var h=new DocumentFragment,b=0;b>m;b--){var y=S();h.appendChild(y),u.push(y)}v.append(h)}else if(m>0)for(var w=f-1,C=f-m-1;w>C;w--)u[w].remove(),u.splice(w,1)}for(var A=0;A<r;A++){var x=s[A],T=x.content,_=T.length,P=u[A],I=(0,o.e)(P,".kf"),M=Array.from((0,o.d)(I,".lf")),D=M.length;if(_!==D){var $=D-_;if($<0)for(var U=0;U>$;U--){var j=E();I.appendChild(j),M.push(j)}else if($>0)for(var q=D-1,F=D-$-1;q>F;q--)M[q].remove(),M.splice(q,1)}if((0,c.e)(g,"folders"))if(g.folders[A])i(P,x,g.folders[A]);else i(P,x,null);else i(P,x,null);for(var Q=0;Q<_;Q++){var z=M[Q],B=T[Q];if((0,c.e)(g,"folders"))if(g.folders[A])if(g.folders[A].content[Q])n(z,B,g.folders[A].content[Q]);else n(z,B,null);else n(z,B,null);else n(z,B,null)}}g=e,k=a,L=t}function q(){return F.apply(this,arguments)}function F(){return(F=(0,n.a)(function*(){var e=(0,r.b)("playing_animation"),t=(0,r.b)("refresh_interval");x=t.dynamic,w=t.baseInterval,I=!0,P=(0,c.c)(),y.setAttribute("refreshing","true"),y.classList.remove("se"),document.addEventListener(P,$);var a=yield(0,s.d)(P);j(a,!1,e);var n=0;x&&(n=yield(0,i.c)()),T=(new Date).getTime(),_=x?Math.max(T+C,a.dataUpdateTime+w/n):T+w,A=Math.max(C,_-T),I=!1,y.setAttribute("refreshing","false"),y.style.setProperty("--je",`${A}ms`),y.classList.add("se")})).apply(this,arguments)}function Q(){return z.apply(this,arguments)}function z(){return(z=(0,n.a)(function*(){q().then(function(){M?setTimeout(function(){Q()},Math.max(C,_-(new Date).getTime())):D=!1}).catch(function(e){M?((0,f.a)("error","資料夾網路連線中斷，將在10秒後重試。"),setTimeout(function(){Q()},1e4)):D=!1})})).apply(this,arguments)}function B(){U(),M||(M=!0,D?q():(D=!0,Q()))}},2547(){},6082(e,t,a){a.d(t,{a:()=>l,b:()=>v});var n=a(467),i=a(9734),s=a(8011),r=a(9218),o=a(4293),c=a(6788),d=a(8179),u="downloadData",l=!1,f=(0,d.c)(".fe"),p=(0,d.e)(f,".ke"),m=(0,d.e)(p,".ne"),h=(0,d.e)(m,'svg#download-svg path[progress="progress"]');function b(e){var t=e,a=189*(1-(0,c.d)(u));h.style.setProperty("--ge",`${a}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,b),h.addEventListener("transitionend",function(){m.setAttribute("complete","true")},{once:!0}),h.style.setProperty("--ge","0px"),l=!0)}function v(){return y.apply(this,arguments)}function y(){return(y=(0,n.a)(function*(){(0,c.f)(u,"getLocation_0",0,!1),(0,c.f)(u,"getLocation_1",0,!1),(0,c.f)(u,"getCarInfo_0",0,!1),(0,c.f)(u,"getCarInfo_1",0,!1),(0,c.f)(u,"getMaterialSymbolsSearchIndex",0,!1),document.addEventListener(u,b),yield(0,o.a)(u,!0),yield(0,s.a)(u,1),yield(0,i.a)(u,!0),yield(0,r.a)(u),(0,c.a)(u),(0,c.b)(u)})).apply(this,arguments)}},6091(e,t,a){a.d(t,{a:()=>j,b:()=>D});var n=a(467),i=a(5767),s=a(5314),r=a(3459),o=a(8179),c=a(8024),d=a(4884),u=a(4537),l=a(904),f=a(3030),p=a(4690),m=(0,o.c)(".fe"),h=(0,o.e)(m,".te"),b=(0,o.e)(h,".ue"),v=(0,o.e)(b,".ze"),y={},g=!1,k=!1,L=15e3,w=5e3,C=!0,A=!1,x=0,T=0,_="",P=!1;function I(){var e=(0,o.a)();e.classList.add("_e");var t=(0,o.a)();t.classList.add("af");var a=(0,o.a)();a.classList.add("bf"),a.appendChild((0,u.a)());var n=(0,o.a)();n.classList.add("cf");var i=(0,o.a)();i.classList.add("df"),t.appendChild(a),t.appendChild(n),t.appendChild(i);var s=(0,o.a)();return s.classList.add("ef"),e.appendChild(t),e.appendChild(s),e}function M(e,t,a){function n(e,n,i){function s(e,t){var a=(0,o.e)(e,".af"),n=(0,o.e)(a,".bf"),i="";switch(t.type){case"route":i="route";break;case"location":i="location_on";break;case"bus":i="directions_bus";break;case"empty":i="lightbulb"}(0,u.c)(n,i)}function r(e,t){var a=(0,o.e)(e,".af"),n=(0,o.e)(a,".cf"),i="";switch(t.type){case"route":i="路線";break;case"location":i="地點";break;case"bus":i="公車";break;case"empty":i="提示"}n.innerText=i}function l(e,t){var a=(0,o.e)(e,".af");(0,o.e)(a,".df").innerText=t.time.relative}function m(e,t){(0,o.e)(e,".ef").innerText=t.name}function h(e,t){switch(t.type){case"route":e.onclick=function(){(0,p.c)(t.id,t.pid)};break;case"location":e.onclick=function(){(0,f.c)(t.hash)};break;case"bus":e.onclick=function(){(0,d.c)(t.id)};break;case"empty":e.onclick=null}}function b(e,t){e.setAttribute("animation",(0,c.a)(t))}function v(e,t){e.setAttribute("skeleton-screen",(0,c.a)(t))}if(null==i)s(e,n),r(e,n),l(e,n),m(e,n),h(e,n),b(e,a),v(e,t);else if(n.type!==i.type)s(e,n),r(e,n),l(e,n),m(e,n),h(e,n),b(e,a),v(e,t);else{switch(n.type){case"location":(0,c.b)(i.name,n.name)||m(e,n),i.time!==n.time&&l(e,n),(0,c.b)(i.hash,n.hash)||h(e,n);break;case"route":i.name!==n.name&&m(e,n),i.time!==n.time&&l(e,n),i.id===n.id&&(0,c.b)(i.pid,n.pid)||h(e,n);break;case"bus":i.name!==n.name&&m(e,n),i.time!==n.time&&l(e,n),i.id!==n.id&&h(e,n);break;case"empty":i.time!==n.time&&l(e,n)}g!==a&&b(e,a),k!==t&&v(e,t)}}var i=e.itemQuantity,s=Array.from((0,o.d)(v,"._e")),r=s.length;if(i!==r){var l=r-i;if(l<0){for(var m=new DocumentFragment,h=0;h>l;h--){var b=I();m.appendChild(b),s.push(b)}v.append(m)}else if(l>0)for(var L=r-1,w=r-l-1;L>w;L--)s[L].remove(),s.splice(L,1)}for(var C=0;C<i;C++){var A=s[C],x=e.items[C];if((0,c.e)(y,"items"))if(y.items[C])n(A,x,y.items[C]);else n(A,x,null);else n(A,x,null)}y=e,g=a,k=t}function D(){for(var e=(0,r.b)("playing_animation"),t=(0,l.e)("window"),a=Math.floor(t.height/70/3)+2,n=[],i=0;i<a;i++)n.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});M({items:n,itemQuantity:n.length,dataUpdateTime:0},!0,e)}function E(){return S.apply(this,arguments)}function S(){return(S=(0,n.a)(function*(){var e=(0,r.b)("playing_animation"),t=(0,r.b)("refresh_interval");C=t.dynamic,L=t.baseInterval,_=(0,c.c)();var a=yield(0,s.c)(_);M(a,!1,e);var n=0;C&&(n=yield(0,i.c)()),x=(new Date).getTime(),T=C?Math.max(x+w,a.dataUpdateTime+L/n):x+L,Math.max(w,T-x)})).apply(this,arguments)}function $(){return U.apply(this,arguments)}function U(){return(U=(0,n.a)(function*(){E().then(function(){A?setTimeout(function(){$()},Math.max(w,T-(new Date).getTime())):P=!1}).catch(function(e){A?setTimeout(function(){$()},1e4):P=!1})})).apply(this,arguments)}function j(){D(),A||(A=!0,P?E():(P=!0,$()))}},6110(){},6561(){},6971(){},7336(){},8933(){},9080(){}}]);
//# sourceMappingURL=3057a575c0ad034566a8.js.map