"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[53,2434],{5767(t,e,r){r.d(e,{Eu:()=>w,MN:()=>O,cy:()=>A,fV:()=>_,wz:()=>C});var n=r(3453),a=r(467),i=r(8024),o=r(5428),s=r(4311);function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return l(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var f=[],m="",p=!1,d=0,y={data:{},timestamp:0,id:""},c=[],v={};function h(t){var e,r=0,n=0,a=0,i=0,o=0,s=u(t);try{for(s.s();!(e=s.n()).done;){var l=e.value,f=l[0],m=l[1];o+=1,r+=f,a+=m,n+=Math.pow(f,2),i+=Math.pow(m,2)}}catch(t){s.e(t)}finally{s.f()}var p,d=r/o,y=a/o,c=n/o-Math.pow(d,2),v=i/o-Math.pow(y,2),h=Math.sqrt(c),g=Math.sqrt(v),w=0,S=u(t);try{for(S.s();!(p=S.n()).done;){var A=p.value;w+=(A[0]-d)*(A[1]-y)}}catch(t){S.e(t)}finally{S.f()}return{estimate_time:{average:d,stdev:h},timestamp:{average:y,stdev:g},length:o,correlation:(w/=o)/(h*g)}}function g(t,e){var r=t.length+e.length,n=(t.estimate_time.average*t.length+e.estimate_time.average*e.length)/r,a=(t.timestamp.average*t.length+e.timestamp.average*e.length)/r;return{estimate_time:{average:n,stdev:(0,o.VY)(t.estimate_time.average,t.estimate_time.stdev,t.length,e.estimate_time.average,e.estimate_time.stdev,e.length)},timestamp:{average:a,stdev:(0,o.VY)(t.timestamp.average,t.timestamp.stdev,t.length,e.timestamp.average,e.timestamp.stdev,e.length)},length:r,correlation:(0,o.Hi)(t.estimate_time.average,t.timestamp.average,t.estimate_time.stdev,t.timestamp.stdev,t.length,t.correlation,e.estimate_time.average,e.timestamp.average,e.estimate_time.stdev,e.timestamp.stdev,e.length,e.correlation)}}function w(t){return S.apply(this,arguments)}function S(){return(S=(0,a.A)(function*(t){var e=(new Date).getTime(),r=!1;if(!p){p=!0,f=[],m=(0,i.zx)(),y={data:{},timestamp:e,id:m},d=0;for(var n=t.length-1,a=0;a<32;a++){var o=t[Math.floor(Math.random()*n)];f.push(o.StopID)}}var l,w=u(t);try{for(w.s();!(l=w.n()).done;){var S=l.value,A=S.StopID,b=`s_${A}`;f.indexOf(A)>-1&&(y.data.hasOwnProperty(b)||(y.data[b]=[]),y.data[b].push([parseInt(S.EstimateTime),Math.floor((e-y.timestamp)/1e3)]))}}catch(t){w.e(t)}finally{w.f()}if((d+=1)>45&&(r=!0),d%5==0&&(yield(0,s.mL)(4,m,JSON.stringify(y))),r){var O,M=u(f);try{for(M.s();!(O=M.n()).done;){var _=O.value,N=`s_${_}`,D=y.data[N],J={},x=yield(0,s.Ct)(3,N);if(x){var I=JSON.parse(x);J.stats=g(I.stats,h(D)),J.timestamp=I.timestamp,J.id=_}else J.stats=h(D),J.timestamp=e,J.id=_;if(yield(0,s.mL)(3,N,JSON.stringify(J)),v.hasOwnProperty(N)){var C=v[N];c.splice(C,1,J)}else c[N]=c.length,c.push(J);yield(0,s.iQ)(4,m)}}catch(t){M.e(t)}finally{M.f()}p=!1}})).apply(this,arguments)}function A(){return b.apply(this,arguments)}function b(){return(b=(0,a.A)(function*(){var t,e=(new Date).getTime()-252e5,r=u(yield(0,s.Su)(4));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,s.Ct)(4,n);if(a){var i=JSON.parse(a),o=i.timestamp,l=i.id;if(o>e)for(var f in i.data){var m=i.data[f],p={},d=yield(0,s.Ct)(3,f);if(d){var y=JSON.parse(d);p.stats=g(y.stats,h(m)),p.timestamp=y.timestamp,p.id=y.id}else p.stats=h(m),p.timestamp=o,p.id=parseInt(f.split("_")[1]);if(yield(0,s.mL)(3,f,JSON.stringify(p)),v.hasOwnProperty(f)){var w=v[f];c.splice(w,1,p)}else c[f]=c.length,c.push(p)}yield(0,s.iQ)(4,l)}}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}function O(){return M.apply(this,arguments)}function M(){return(M=(0,a.A)(function*(){var t,e=(new Date).getTime()-252e5,r=0,n=u(yield(0,s.Su)(3));try{for(n.s();!(t=n.n()).done;){var a=t.value,i=yield(0,s.Ct)(3,a);if(i){var o=JSON.parse(i);o.timestamp>e&&(c.push(o),v[a]=r,r+=1)}}}catch(t){n.e(t)}finally{n.f()}})).apply(this,arguments)}function _(){return N.apply(this,arguments)}function N(){return(N=(0,a.A)(function*(){var t,e=(new Date).getTime()-252e5,r=u(yield(0,s.Su)(3));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,s.Ct)(3,n);JSON.parse(a).timestamp<=e&&(yield(0,s.iQ)(3,n))}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}var D,J={};if("undefined"!=typeof SharedWorker){var x=new SharedWorker(new URL(r.p+r.u(5662),r.b));(D=x.port).start()}else{var I=new Worker(new URL(r.p+r.u(3281),r.b));D=I}function C(){return L.apply(this,arguments)}function L(){return(L=(0,a.A)(function*(){var t,e=yield(t=(new Date).getTime()-252e5,c.filter(function(e){return e.timestamp>t})),r=(0,i.zx)();return yield new Promise(function(t,n){J[r]=t,D.onerror=function(t){n(t.message)},D.postMessage([e,r])})})).apply(this,arguments)}D.onmessage=function(t){var e=(0,n.A)(t.data,2),r=e[0],a=e[1];J[a]&&(J[a](r),delete J[a])},D.onerror=function(t){}},6483(t,e,r){r.d(e,{$t:()=>N,Io:()=>T,VZ:()=>M});var n=r(467),a=r(3453),i=r(8024),o=r(5428),s=r(9566),u=r(5352),l=r(4311);function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return m(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var p,d="",y=!1,c=[],v={data:{},timestamp:0,id:""},h=0,g={};if("undefined"!=typeof SharedWorker){var w=new SharedWorker(new URL(r.p+r.u(1992),r.b));(p=w.port).start()}else{var S=new Worker(new URL(r.p+r.u(9611),r.b));p=S}function A(t){return b.apply(this,arguments)}function b(){return(b=(0,n.A)(function*(t){var e=(0,i.zx)();return yield new Promise(function(r,n){g[e]=r,p.onerror=function(t){n(t.message)},p.postMessage([t,e])})})).apply(this,arguments)}function O(t,e){for(var r=new Uint32Array(1440),n=1439;n>=0;n--)r[n]=t[n]+e[n];return Array.from(r)}function M(t){return _.apply(this,arguments)}function _(){return(_=(0,n.A)(function*(t){var e=new Date,r=e.getTime(),n=e.getDay(),a=!1;if(!y){y=!0,d=(0,i.zx)(),v={id:d,timestamp:r,data:{}},h=0;var m=yield(0,s.$j)(["stop"]);c=m.map(function(t){return t.id})}if((0,u.vQ)(e)){var p,g=f(t);try{for(g.s();!(p=g.n()).done;){var w=p.value,S=w.StopID,b=`s_${S}_${n}`;c.indexOf(S)>-1&&(v.data.hasOwnProperty(b)||(v.data[b]=[]),v.data[b].push([parseInt(w.EstimateTime),r]))}}catch(t){g.e(t)}finally{g.f()}if((h+=1)>32&&(a=!0),(a||h%8==0)&&(yield(0,l.mL)(5,d,JSON.stringify(v))),a){var M,_=f(c);try{for(_.s();!(M=_.n()).done;){var N=M.value,D=`s_${N}_${n}`,J=v.data[D],x={},I=yield(0,l.Ct)(6,D);if(I){var C=JSON.parse(I),L=A(J),T=O(C.stats,L);x.stats=T;var $=(0,o.no)(T);x.min=$[0],x.max=$[1],x.day=n,x.timestamp=C.timestamp,x.id=N}else{var k=A(J);x.stats=k;var U=(0,o.no)(k);x.min=U[0],x.max=U[1],x.day=n,x.timestamp=r,x.id=N}yield(0,l.mL)(6,D,JSON.stringify(x)),yield(0,l.iQ)(5,d)}}catch(t){_.e(t)}finally{_.f()}y=!1}}})).apply(this,arguments)}function N(){return D.apply(this,arguments)}function D(){return(D=(0,n.A)(function*(){var t,e=new Date,r=e.getTime(),n=e.getDay(),a=f(yield(0,l.Su)(5));try{for(a.s();!(t=a.n()).done;){var i=t.value,s=yield(0,l.Ct)(5,i),u=JSON.parse(s),m=u.id;for(var p in u.data){var d=u.data[p],y={},c=yield(0,l.Ct)(6,p),v=parseInt(p.split("_")[1]);if(c){var h=JSON.parse(c),g=A(d),w=O(h.stats,g);y.stats=w;var S=(0,o.no)(w);y.min=S[0],y.max=S[1],y.day=h.day,y.timestamp=h.timestamp,y.id=v}else{var b=A(d);y.stats=b;var M=(0,o.no)(b);y.min=M[0],y.max=M[1],y.day=n,y.timestamp=r,y.id=v}yield(0,l.mL)(6,p,JSON.stringify(y))}yield(0,l.iQ)(5,m)}}catch(t){a.e(t)}finally{a.f()}})).apply(this,arguments)}function J(){return(J=(0,n.A)(function*(){var t,e=[],r=f(yield(0,l.Su)(6));try{for(r.s();!(t=r.n()).done;){var n=t.value,a=yield(0,l.Ct)(6,n);if(a){var i=JSON.parse(a);e.push(i)}}}catch(t){r.e(t)}finally{r.f()}return e})).apply(this,arguments)}p.onmessage=function(t){var e=(0,a.A)(t.data,2),r=e[0],n=e[1];g[n]&&(g[n](r),delete g[n])},p.onerror=function(t){};var x,I={};if("undefined"!=typeof SharedWorker){var C=new SharedWorker(new URL(r.p+r.u(3113),r.b));(x=C.port).start()}else{var L=new Worker(new URL(r.p+r.u(5494),r.b));x=L}function T(t,e){return $.apply(this,arguments)}function $(){return $=(0,n.A)(function*(t,e){var r=(0,i.zx)(),n=yield(0,u.ty)(),a=yield function(){return J.apply(this,arguments)}();return yield new Promise(function(i,o){I[r]=i,x.onerror=function(t){o(t.message)},x.postMessage([n,a,t,e,r])})}),$.apply(this,arguments)}x.onmessage=function(t){var e=(0,a.A)(t.data,2),r=e[0],n=e[1];I[n]&&(I[n](r),delete I[n])},x.onerror=function(t){}},8925(t,e,r){r.d(e,{Ir:()=>m,LN:()=>d,N$:()=>u});var n=r(467),a=r(5579),i=r(4311);function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw i}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){return l.apply(this,arguments)}function l(){return(l=(0,n.A)(function*(t,e){var r=`d_${(0,a.$T)(e,"YYYY_MM_DD")}`,n=60*e.getHours()+e.getMinutes(),o=yield(0,i.Ct)(2,r);if(o){var s=JSON.parse(o);s.stats.sum+=t,s.data[n]+=t;var u=s.data[n];u>s.stats.max&&(s.stats.max=u),u<s.stats.min&&(s.stats.min=u),yield(0,i.mL)(2,r,JSON.stringify(s))}else{var l={},f=new Uint32Array(1440);f[n]+=t,l.data=Array.from(f),l.stats={sum:t,max:t,min:0},l.date=[e.getFullYear(),e.getMonth()+1,e.getDate()],yield(0,i.mL)(2,r,JSON.stringify(l))}})).apply(this,arguments)}function f(){return(f=(0,n.A)(function*(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);for(var e=(0,a.S1)(t,-7,0,0),r=[],n=1;n<=7;n++){var o=(0,a.S1)(e,n,0,0),s=`d_${(0,a.$T)(o,"YYYY_MM_DD")}`,u=yield(0,i.Ct)(2,s);if(u){var l=JSON.parse(u);r.push(l)}else{var f={},m=new Uint32Array(1440);f.data=Array.from(m),f.stats={sum:0,max:0,min:0},f.date=[o.getFullYear(),o.getMonth()+1,o.getDate()],r.push(f)}}return r})).apply(this,arguments)}function m(){return p.apply(this,arguments)}function p(){return(p=(0,n.A)(function*(){var t,e=(new Date).getTime(),r=o(yield(0,i.Su)(2));try{for(r.s();!(t=r.n()).done;){var n=t.value,s=yield(0,i.Ct)(2,n),u=JSON.parse(s);e-(0,a.uP)(u.date[0],u.date[1],u.date[2]).getTime()>6048e5&&(yield(0,i.iQ)(2,n))}}catch(t){r.e(t)}finally{r.f()}})).apply(this,arguments)}function d(t,e,r){return y.apply(this,arguments)}function y(){return y=(0,n.A)(function*(t,e,n){var a=new Worker(new URL(r.p+r.u(4444),r.b)),i=yield function(){return f.apply(this,arguments)}();return yield new Promise(function(r,o){a.onmessage=function(t){r(t.data),a.terminate()},a.onerror=function(t){o(t.message),a.terminate()},a.postMessage([i,t,e,n])})}),y.apply(this,arguments)}}}]);
//# sourceMappingURL=e770fe9a67758cc70673.js.map