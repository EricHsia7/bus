!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("bus",[],r):"object"==typeof exports?exports.bus=r():t.bus=r()}(self,()=>(()=>{"use strict";var t={778(t,r,e){function n(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function o(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a,s,i=[],l=!0,f=!1;try{if(a=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(i.push(n.value),i.length!==r);l=!0);}catch(t){f=!0,o=t}finally{try{if(!l&&null!=e.return&&(s=e.return(),Object(s)!==s))return}finally{if(f)throw o}}return i}}(t,r)||function(t,r){if(t){if("string"==typeof t)return n(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?n(t,r):void 0}}(t,r)||function(){throw new TypeError("E1")}()}function a(t,r,e){var n=e[0]-r[0],o=e[1]-r[1],a=n*n+o*o,s=((t[0]-r[0])*n+(t[1]-r[1])*o)/a;if(s<0)n=t[0]-r[0],o=t[1]-r[1];else if(s>1)n=t[0]-e[0],o=t[1]-e[1];else{var i=[r[0]+s*n,r[1]+s*o];n=t[0]-i[0],o=t[1]-i[1]}return Math.sqrt(n*n+o*o)}function s(t,r){var e=t.length-1;if(e<2)return t;for(var n=0,o=0,i=1;i<e;i++){var l=a(t[i],t[0],t[e]);l>n&&(o=i,n=l)}if(n>r){var f=t.slice(0,o+1),u=t.slice(o),c=s(f,r),v=s(u,r);return c.pop(),c.concat(v)}return[t[0],t[e]]}function i(t,r,e){var n=new Date;return n.setDate(1),n.setMonth(0),n.setFullYear(t),n.setMonth(r-1),n.setDate(e),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n}self.onmessage=function(t){var r=function(t){var r=o(t,4),e=r[0],n=r[1],a=r[2],f=r[3],u=e.length,c=[],v=0;for(var d of e)c.push(d.stats.max,d.stats.min),v+=d.stats.sum;for(var p=function(t){var r=t.length;if(0===r)return[0,0];for(var e=1/0,n=-1/0,o=r-1;o>=0;o--){var a=t[o];a>n&&(n=a),a<e&&(e=a)}return[e,n]}(c),$=p[1],h=p[0],y=e[0].date,x=e[u-1].date,m=i(y[0],y[1],y[2]),b=i(x[0],x[1],x[2]),g=[],w=0,j=0,k=0;k<u;k++){var M=e[k];if(0!==M.stats.sum)for(var A=M.data,O=0;O<l;O++){w+=A[O];var S=f+(k+O/l)/8*n,D=f+(1-w/v)*a;g.push([S,D]),j=S}else{var L=f+k/8*n,z=f+(k+.9993055555555556)/8*n,E=f+a;g.push([L,E]),g.push([z,E]),j=z}}var G=`<line x1="${f}" y1="${a+f}" x2="${f+n}" y2="${a+f}" stroke="var(--a)" stroke-width="1" />`,q=`<line x1="${f}" y1="${f}" x2="${f}" y2="${a+f}" stroke="var(--a)" stroke-width="1" />`,B=`<text x="${f+n/2}" y="${f+a+f}" text-anchor="middle" font-size="12" fill="var(--a)">時間</text>`,C=`<text x="${f/2}" y="${f+a/2}" text-anchor="middle" font-size="12" fill="var(--a)" transform="rotate(-90, ${.7*f}, ${f+a/2})">累計傳輸量</text>`,F=function(t){var r=t.length-1;if(r<0)return"";for(var e=[`M${t[0][0]} ${t[0][1]}`],n=1;n<r;n++){var o=t[n],a=t[n+1]||o;e.push(`Q${o[0]} ${o[1]} ${(o[0]+a[0])/2} ${(o[1]+a[1])/2}`)}var s=t[r];return e.push(`L${s[0]} ${s[1]}`),e.join(" ")}(s(g,1.1)),H={stats:{max:$,min:h,sum:v},period:{start:m,end:b},chart:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${n+2*f} ${a+2*f}"><defs><linearGradient id="grad1" x1="50%" y1="0%" x2="50%" y2="100%"><stop offset="0%" style="stop-color:var(--c);" /><stop offset="73%" style="stop-color:var(--d);" /><stop offset="100%" style="stop-color:rgba(0, 0, 0, 0);" /></linearGradient></defs><path d="M${f},${a+f} ${F} L${j},${a+f} L${f},${a+f}" stroke="none" stroke-width="0" fill="url(#grad1)"></path><path d="${F}" fill="none" stroke="var(--b)" stroke-width="0.9" stroke-linecap="round" stroke-linejoin="round" opacity="1"></path>${G}${q}${B}${C}</svg>`};return H}(t.data);self.postMessage(r)};var l=1440}},r={};r.m=t,r.u=t=>"738fe2eea9bd8eb6093f.js",r.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r.p="./",r.b=self.location+"";var e={};return t[778](0,e,r),e=e.default})());
//# sourceMappingURL=738fe2eea9bd8eb6093f.js.map