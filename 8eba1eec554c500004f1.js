"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[474],{4690(e,t,a){a.d(t,{Ch:()=>ge,S5:()=>te,SR:()=>be,U7:()=>fe});var n=a(467),i=a(5767),d=a(9566),s=a(3422),r=a(5314),o=a(7123),l=a(3459),u=a(8179),c=a(7968),p=a(8024),v=a(5579),m=a(4537),h=a(904),b=a(3030),f=a(9119),g=a(3041),A=a(752),y=a(5286);function C(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return L(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("E0")}var d,s=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){r=!0,d=e},f:function(){try{s||null==a.return||a.return()}finally{if(r)throw d}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var E=(0,u.bv)(".ba"),I=(0,u.aI)(E,".dn"),x=(0,u.aI)(I,".gn"),w=(0,u.aI)(x,"span"),T=(0,u.aI)(I,".fn"),R=(0,u.aI)(I,".nn .on"),_=(0,u.aI)(I,".hn"),k=(0,u.aI)(_,".in"),S=(0,u.aI)(I,".ln"),M=(0,u.aI)(S,".mn"),$=(0,u.aI)(E,".ca"),j={},P=!1,Z=!1,D=0,B=0,z=0,N={},Y=0,q=!1,F=15e3,H=5e3,Q=15e3,O=!0,U=0,J=0,W="",G=!1,K=!1,X=!1,V=0,ee=[];function te(){$.addEventListener("touchstart",function(){D=Math.round($.scrollLeft/Y)},{passive:!0}),$.addEventListener("scroll",function(e){q=!0;var t=e.target.scrollLeft/Y;B=t>D?D+1:D-1;var a=t-D,n=Math.abs(a);n>1&&(a>0?(D=Math.floor(t),B=D+1):(D=Math.ceil(t),B=D-1),n=Math.abs(t-D));var i=N[`g_${D}`]||{width:0,offset:0},d=N[`g_${B}`]||{width:0,offset:0},s=i.width+(d.width-i.width)*n,r=-1*(i.offset+(d.offset-i.offset)*n)+.5*Y-.5*s;ae(z,r,s-20,t),t===B&&(D=Math.round($.scrollLeft/Y),q=!1)},{passive:!0})}function ae(e,t,a,n){$.style.setProperty("--xm",e.toString()),M.style.setProperty("--_m",a.toString()),k.style.setProperty("--jn",`${t.toString()}px`),k.style.setProperty("--ym",n.toString())}function ne(e){var t=e;if(G){var a=t.detail.progress-1;R.style.setProperty("--bn",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,ne)}function ie(){var e=(0,p.zx)(),t=document.createElement("div");t.classList.add("rn"),t.id=e,t.setAttribute("stretched","false"),t.setAttribute("stretching","false"),t.setAttribute("push-direction","0"),t.setAttribute("push-state","0");var a=document.createElement("div");a.classList.add("sn");var n=document.createElement("div");n.classList.add("bo"),n.setAttribute("displayed","false"),a.appendChild(n);var i=document.createElement("div");i.classList.add("tn");var d=document.createElement("div");d.classList.add("_a"),d.setAttribute("code","0"),d.setAttribute("displayed","false"),i.appendChild(d);var s=document.createElement("div");return s.classList.add("ab"),s.setAttribute("code","0"),s.setAttribute("displayed","true"),i.appendChild(s),t.appendChild(a),t.appendChild(i),{element:t,id:e}}function de(e){var t=(0,p.zx)(),a=document.createElement("div");a.classList.add("ha"),a.id=t,a.setAttribute("stretched","false"),a.setAttribute("stretching","false"),a.setAttribute("push-direction","0"),a.setAttribute("push-state","0");var n=document.createElement("div");n.classList.add("na");var i=document.createElement("div");i.classList.add("oa"),n.appendChild(i);var d=document.createElement("div");d.classList.add("qa");var s=document.createElement("div");s.classList.add("za");var r=document.createElement("div");r.classList.add("_a"),r.setAttribute("code","0"),r.setAttribute("displayed","false"),s.appendChild(r);var o=document.createElement("div");o.classList.add("ab"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),s.appendChild(o),d.appendChild(s);var l=document.createElement("div");l.classList.add("xa"),l.appendChild((0,m.YC)("keyboard_arrow_down")),l.onclick=function(){!function(e,t){var a=(0,u.aI)(e,".lb"),n=e.parentElement,i=t.parentElement,d=(0,u.ji)(t,"rn"),s=(0,u.ji)(e,"ha"),r=s.length,o=n.getBoundingClientRect(),l=e.getBoundingClientRect(),c=i.getBoundingClientRect(),p=t.getBoundingClientRect(),v=p.top-c.top,m=l.top-o.top,h="true"===e.getAttribute("stretched"),b="true"===e.getAttribute("animation");if(b){var f=h?"2":"1";t.setAttribute("stretching","true"),t.style.setProperty("--fo",`${v}px`),e.setAttribute("stretching","true"),e.style.setProperty("--aa",`${m}px`);for(var g=0;g<r;g++){var A=s[g],y=d[g];y.style.setProperty("--go",(-1*g-1).toString()),y.setAttribute("push-direction",f),y.setAttribute("push-state","1"),A.setAttribute("push-direction",f),A.setAttribute("push-state","1")}e.addEventListener("transitionend",function(){for(var a=0;a<r;a++){var n=s[a],i=d[a];i.setAttribute("push-direction","0"),i.setAttribute("push-state","0"),n.setAttribute("push-direction","0"),n.setAttribute("push-state","0")}t.setAttribute("stretching","false"),e.setAttribute("stretching","false")},{once:!0}),e.addEventListener("transitionstart",function(){for(var e=0;e<r;e++){var t=s[e];d[e].setAttribute("push-state","2"),t.setAttribute("push-state","2")}},{once:!0})}h?(b?a.addEventListener("transitionend",function(){a.setAttribute("displayed","false")},{once:!0}):a.setAttribute("displayed","false"),e.setAttribute("stretched","false"),t.setAttribute("stretched","false")):(a.setAttribute("displayed","true"),e.setAttribute("stretched","true"),t.setAttribute("stretched","true"))}(a,e)},d.appendChild(l);var c=document.createElement("div");c.classList.add("va"),d.appendChild(c),n.appendChild(d);var v=document.createElement("div");v.classList.add("lb"),v.setAttribute("displayed","false");var h=document.createElement("div");h.classList.add("mb");var b=document.createElement("div");b.classList.add("nb"),b.setAttribute("highlighted","true"),b.setAttribute("type","tab"),b.setAttribute("code","0"),b.onclick=function(){Ae(t,0)};var f=document.createElement("div");f.classList.add("wb"),f.appendChild((0,m.YC)("directions_bus")),b.appendChild(f),b.appendChild(document.createTextNode("公車")),h.appendChild(b);var g=document.createElement("div");g.classList.add("nb"),g.setAttribute("highlighted","false"),g.setAttribute("type","tab"),g.setAttribute("code","1"),g.onclick=function(){Ae(t,1)};var A=document.createElement("div");A.classList.add("wb"),A.appendChild((0,m.YC)("departure_board")),g.appendChild(A),g.appendChild(document.createTextNode("抵達時間")),h.appendChild(g);var y=document.createElement("div");y.classList.add("nb"),y.setAttribute("highlighted","false"),y.setAttribute("type","tab"),y.setAttribute("code","2"),y.onclick=function(){Ae(t,2)};var C=document.createElement("div");C.classList.add("wb"),C.appendChild((0,m.YC)("route")),y.appendChild(C),y.appendChild(document.createTextNode("路線")),h.appendChild(y);var L=document.createElement("div");L.classList.add("nb"),L.setAttribute("highlighted","false"),L.setAttribute("type","tab"),L.setAttribute("code","3"),L.onclick=function(){Ae(t,3)};var E=document.createElement("div");E.classList.add("wb"),E.appendChild((0,m.YC)("location_on")),L.appendChild(E),L.appendChild(document.createTextNode("地點")),h.appendChild(L);var I=document.createElement("div");I.classList.add("nb"),I.setAttribute("highlighted","false"),I.setAttribute("type","save-to-folder");var x=document.createElement("div");x.classList.add("wb"),x.appendChild((0,m.YC)("folder")),I.appendChild(x),I.appendChild(document.createTextNode("儲存")),h.appendChild(I);var w=document.createElement("div");w.classList.add("nb"),w.setAttribute("highlighted","false"),w.setAttribute("type","schedule-notification"),w.setAttribute("enabled","true");var T=document.createElement("div");T.classList.add("wb"),T.appendChild((0,m.YC)("notifications")),w.appendChild(T),w.appendChild(document.createTextNode("通知")),h.appendChild(w),v.appendChild(h);var R=document.createElement("div");R.classList.add("yb"),R.setAttribute("displayed","true"),v.appendChild(R);var _=document.createElement("div");_.classList.add("zb"),_.setAttribute("displayed","false"),v.appendChild(_);var k=document.createElement("div");k.classList.add("_b"),k.setAttribute("displayed","false"),v.appendChild(k);var S=document.createElement("div");return S.classList.add("ac"),S.setAttribute("displayed","false"),v.appendChild(S),a.appendChild(n),a.appendChild(v),{element:a,id:t}}function se(){var e=document.createElement("div");e.classList.add("da");var t=document.createElement("div");t.classList.add("ea");var a=document.createElement("div");a.classList.add("qn");var n=document.createElement("div");n.classList.add("co");var i=document.createElement("div");i.classList.add("fa");var d=document.createElement("div");return d.classList.add("ga"),i.appendChild(d),a.appendChild(n),t.appendChild(a),t.appendChild(i),e.appendChild(t),{element:e,id:""}}function re(){var e=document.createElement("div");return e.classList.add("kn"),{element:e,id:""}}function oe(){var e=document.createElement("div");e.classList.add("bc"),e.setAttribute("on-this-route","false");var t=document.createElement("div");t.classList.add("sc");var a=document.createElement("div");a.classList.add("wc"),a.appendChild((0,m.YC)("directions_bus"));var n=document.createElement("div");n.classList.add("_c");var i=document.createElement("div");i.classList.add("fd");var d=document.createElement("div");d.classList.add("hd");var s=document.createElement("div");s.classList.add("id");var r=document.createElement("div");return r.classList.add("jd"),t.appendChild(a),t.appendChild(n),e.appendChild(t),i.appendChild(d),i.appendChild(s),i.appendChild(r),e.appendChild(i),{element:e,id:""}}function le(){var e=document.createElement("div");e.classList.add("cc");var t=document.createElement("div");t.classList.add("tc");var a=document.createElement("div");a.classList.add("xc"),a.appendChild((0,m.YC)("route"));var n=document.createElement("div");n.classList.add("ad");var i=document.createElement("div");i.classList.add("kd");var d=document.createElement("div");d.classList.add("nd");var s=document.createElement("div");s.classList.add("pd"),s.setAttribute("type","view-route"),s.innerText="查看路線";var r=document.createElement("div");return r.classList.add("pd"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存路線",t.appendChild(a),t.appendChild(n),e.appendChild(t),e.appendChild(i),d.appendChild(s),d.appendChild(r),e.appendChild(d),{element:e,id:""}}function ue(){var e=document.createElement("div");e.classList.add("dc");var t=document.createElement("div");t.classList.add("uc");var a=document.createElement("div");a.classList.add("yc"),a.appendChild((0,m.YC)("calendar_view_day"));var n=document.createElement("div");n.classList.add("bd");var i=document.createElement("div");i.classList.add("dd");var d=document.createElement("div");return d.classList.add("gd"),t.appendChild(a),t.appendChild(n),t.appendChild(i),e.appendChild(t),e.appendChild(d),{element:e,id:""}}function ce(){var e=document.createElement("div");e.classList.add("ec");var t=document.createElement("div");t.classList.add("vc");var a=document.createElement("div");a.classList.add("zc"),a.appendChild((0,m.YC)("location_on"));var n=document.createElement("div");n.classList.add("cd");var i=document.createElement("div");i.classList.add("ld");var d=document.createElement("div");d.classList.add("od");var s=document.createElement("div");s.classList.add("qd"),s.setAttribute("type","view-location"),s.innerText="查看地點";var r=document.createElement("div");return r.classList.add("qd"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存地點",t.appendChild(a),t.appendChild(n),e.appendChild(t),e.appendChild(i),d.appendChild(s),d.appendChild(r),e.appendChild(d),{element:e,id:""}}function pe(e,t,a){var n,i;function r(t,a,n,i,r,o){function l(e,t,a,n,i){var d=(0,u.aI)(t,".tn"),s=(0,u.aI)(d,".ab"),r=(0,u.aI)(d,"._a"),o=(0,u.aI)(e,".za"),l=(0,u.aI)(o,".ab"),c=(0,u.aI)(o,"._a");if(r.setAttribute("code",a.status.code.toString()),c.setAttribute("code",a.status.code.toString()),c.innerText=a.status.text,!n&&i){var p=e.getBoundingClientRect(),v=p.top,m=p.left,h=p.bottom,b=p.right,f=window.innerWidth,g=window.innerHeight;if(h>0&&v<g&&b>0&&m<f)return s.addEventListener("animationend",function(){s.setAttribute("code",a.status.code.toString()),s.classList.remove("kb"),r.setAttribute("displayed","false")},{once:!0}),l.addEventListener("animationend",function(){l.setAttribute("code",a.status.code.toString()),l.innerText=a.status.text,l.classList.remove("kb"),c.setAttribute("displayed","false")},{once:!0}),c.setAttribute("displayed","true"),r.setAttribute("displayed","true"),s.classList.add("kb"),void l.classList.add("kb")}s.setAttribute("code",a.status.code.toString()),l.setAttribute("code",a.status.code.toString()),l.innerText=a.status.text}function c(e,t,a){e.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer)),t.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer))}function m(e,t){(0,u.aI)(e,".oa").innerText=t.name}function h(e,t){var a=(0,u.aI)(e,".yb"),n=(0,u.jg)(a,".bc"),i=n.length,d=t.buses.length,s=i-d;if(s<0){for(var r=new DocumentFragment,o=0,l=Math.abs(s);o<l;o++){var c=oe();r.appendChild(c.element)}a.append(r)}else for(var v=0,m=Math.abs(s);v<m;v++){n[i-1-v].remove()}for(var h=(0,u.jg)(a,".bc"),b=0;b<d;b++){var f=t.buses[b],g=h[b],A=(0,u.aI)(g,".sc"),y=(0,u.aI)(A,"._c"),C=(0,u.aI)(g,".fd"),L=(0,u.aI)(C,".hd"),E=(0,u.aI)(C,".id"),I=(0,u.aI)(C,".jd");g.setAttribute("on-this-route",(0,p.xZ)(f.onThisRoute)),y.innerText=f.carNumber,L.innerText=`路線：${f.RouteName}`,E.innerText=`狀態：${f.status.text}`,I.innerText=`類型：${f.type}`}a.setAttribute("empty",(0,p.xZ)(0===d))}function f(e,t){var a=(0,u.aI)(e,".zb"),n=(0,u.jg)(a,".cc"),i=n.length,s=t.overlappingRoutes.length,r=i-s;if(r<0){for(var o=new DocumentFragment,l=0,c=Math.abs(r);l<c;l++){var v=le();o.appendChild(v.element)}a.append(o)}else for(var m=0,h=Math.abs(r);m<h;m++){n[i-1-m].remove()}for(var b=(0,u.jg)(a,".cc"),f=0;f<s;f++){var A=t.overlappingRoutes[f],y=b[f],C=(0,u.aI)(y,".tc"),L=(0,u.aI)(C,".ad"),E=(0,u.aI)(y,".kd"),I=(0,u.aI)(y,".nd"),x=(0,u.aI)(I,'.pd[type="view-route"]'),w=(0,u.aI)(I,'.pd[type="save-to-folder"]');L.innerText=A.name,E.innerText=A.RouteEndPoints.text,function(e,t,a){e.onclick=function(){ge(t,a)}}(x,A.RouteID,A.PathAttributeId),function(e,t){e.onclick=function(){(0,g.B)("route-on-route",[t])},(0,d.LH)("route",t).then(function(t){e.setAttribute("highlighted",(0,p.xZ)(t))})}(w,A.RouteID)}a.setAttribute("empty",(0,p.xZ)(0===s))}function y(e,t){var a=(0,u.aI)(e,"._b"),n=(0,u.jg)(a,".dc"),i=n.length,d=t.busArrivalTimes.length,s=i-d;if(s<0){for(var r=new DocumentFragment,o=0,l=Math.abs(s);o<l;o++){var c=ue();r.appendChild(c.element)}a.append(r)}else for(var m=0,h=Math.abs(s);m<h;m++){n[i-1-m].remove()}for(var b=(0,u.jg)(a,".dc"),f=0;f<d;f++){var g=t.busArrivalTimes[f],A=b[f],y=(0,u.aI)(A,".uc"),C=(0,u.aI)(y,".bd"),L=(0,u.aI)(y,".dd"),E=(0,u.aI)(A,".gd");C.innerText=g.personalSchedule.name,L.innerText=`週${(0,v.kd)(g.day).name} ${(0,v.pn)(g.personalSchedule.period.start)} - ${(0,v.pn)(g.personalSchedule.period.end)}`,E.innerHTML=g.chart}a.setAttribute("empty",(0,p.xZ)(0===d))}function C(e,t){var a=(0,u.aI)(e,".ac"),n=(0,u.jg)(a,".ec"),i=n.length,s=t.nearbyLocations.length,r=i-s;if(r<0){for(var o=new DocumentFragment,l=0,c=Math.abs(r);l<c;l++){var v=ce();o.appendChild(v.element)}a.append(o)}else for(var m=0,h=Math.abs(r);m<h;m++){n[i-1-m].remove()}for(var f=(0,u.jg)(a,".ec"),A=0;A<s;A++){var y=t.nearbyLocations[A],C=f[A],L=(0,u.aI)(C,".vc"),E=(0,u.aI)(L,".cd"),I=(0,u.aI)(C,".ld"),x=(0,u.aI)(C,".od"),w=(0,u.aI)(x,'.qd[type="view-location"]'),T=(0,u.aI)(x,'.qd[type="save-to-folder"]');E.innerText=y.name,I.innerText=`${y.distance}公尺`,function(e,t){e.onclick=function(){(0,b.so)(t)}}(w,y.hash),function(e,t){e.onclick=function(){(0,g.B)("location-on-route",[t])},(0,d.LH)("location",t).then(function(t){e.setAttribute("highlighted",(0,p.xZ)(t))})}(T,y.hash)}a.setAttribute("empty",(0,p.xZ)(0===s))}function L(e,t,a){e.setAttribute("nearest",(0,p.xZ)(a.nearest)),t.setAttribute("nearest",(0,p.xZ)(a.nearest))}function E(e,t,a,n,i){var d=(null==a?void 0:a.progress)||0,s=(null==t?void 0:t.progress)||0,r=(0,u.aI)(e,".sn .bo");if(!n&&i&&0!==d&&0===s&&Math.abs(s-d)>0)return r.style.setProperty("--do","100%"),void r.addEventListener("transitionend",function(){r.setAttribute("displayed","false"),r.style.setProperty("--do","-100%")},{once:!0});s>0?(r.setAttribute("displayed","true"),r.style.setProperty("--do",100*(s-1)+"%")):r.setAttribute("displayed","false")}function I(e,t,a){a&&((0,u.aI)(e,".lb").setAttribute("displayed","false"),e.setAttribute("stretched","false"),t.setAttribute("stretched","false"))}function x(e,t,a){e.setAttribute("animation",(0,p.xZ)(a)),t.setAttribute("animation",(0,p.xZ)(a))}function w(e,t,a){e.setAttribute("skeleton-screen",(0,p.xZ)(a)),t.setAttribute("skeleton-screen",(0,p.xZ)(a))}function T(t,a){var n=(0,u.aI)(t,'.lb .mb .nb[type="save-to-folder"]');n.onclick=function(){(0,g.B)("stop-on-route",[t.id,a.id,e.RouteID])},(0,d.LH)("stop",a.id).then(function(e){n.setAttribute("highlighted",(0,p.xZ)(e))})}function R(t,a){var n=(0,u.aI)(t,'.lb .mb .nb[type="schedule-notification"]');n.onclick=function(){(0,A.Ho)(n,a.id,e.RouteID,a.status.time)};var i=(0,s.Zc)(a.id);n.setAttribute("highlighted",(0,p.xZ)(i))}null===i?(l(t,a,n,r,o),m(t,n),h(t,n),f(t,n),y(t,n),C(t,n),c(t,a,n),L(t,a,n),E(a,n,i,r,o),I(t,a,r),x(t,a,o),w(t,a,r),T(t,n),R(t,n)):(n.status.time!==i.status.time&&(l(t,a,n,r,o),R(t,n)),(0,p.hw)(i.buses,n.buses)||h(t,n),(0,p.hw)(i.busArrivalTimes,n.busArrivalTimes)||y(t,n),i.nearest!==n.nearest&&L(t,a,n),i.progress!==n.progress&&E(a,n,i,r,o),i.id!==n.id&&(m(t,n),c(t,a,n),f(t,n),C(t,n),T(t,n),R(t,n)),P!==o&&x(t,a,o),Z!==r&&(I(t,a,r),w(t,a,r)))}var o=(0,h.gO)("window"),l=o.width,m=o.height,f=e.groupQuantity,C=e.itemQuantity,L=e.groupedItems;z=f,Y=l;for(var E=0,I=[e.RouteEndPoints.RouteDestination,e.RouteEndPoints.RouteDeparture,"未知"].map(function(e){return`往${e}`}),R=0;R<f;R++){var M=`g_${R}`,B=(0,c.q_)(I[R],500,"17px",'"Noto Sans TC", sans-serif')+20;N[M]={width:B,offset:E},E+=B}if(N[`g_${f}`]={width:0,offset:E},!q){var F=N[`g_${D}`],H=-1*F.offset+.5*Y-.5*F.width,Q=F.width-20;ae(z,H,Q,D)}Z!==t&&(x.setAttribute("skeleton-screen",(0,p.xZ)(t)),_.setAttribute("skeleton-screen",(0,p.xZ)(t)),S.setAttribute("skeleton-screen",(0,p.xZ)(t))),P!==a&&(x.setAttribute("animation",(0,p.xZ)(a)),_.setAttribute("animation",(0,p.xZ)(a)),S.setAttribute("animation",(0,p.xZ)(a))),(null===(n=j)||void 0===n?void 0:n.RouteID)!==e.RouteID&&(T.onclick=function(){(0,y.GS)(e.RouteID,e.PathAttributeId)}),(null===(i=j)||void 0===i?void 0:i.RouteName)!==e.RouteName&&(w.innerText=e.RouteName);var O=(0,u.jg)($,".da").length;if(f!==O){var U=O-f;if(U<0){for(var J=new DocumentFragment,W=new DocumentFragment,G=0,K=Math.abs(U);G<K;G++){var X=se();J.appendChild(X.element);var V=re();W.appendChild(V.element)}$.append(J),k.append(W)}else for(var ee=(0,u.jg)($,".da"),te=(0,u.jg)(k,".kn"),ne=0,pe=Math.abs(U);ne<pe;ne++){var ve=O-1-ne;ee[ve].remove(),te[ve].remove()}}for(var me=(0,u.jg)($,".da"),he=0;he<f;he++){var be=`g_${he}`,fe=me[he],Ae=(0,u.aI)(fe,".fa"),ye=(0,u.aI)(fe,".qn"),Ce=(0,u.jg)(Ae,".ha").length;if(C[be]!==Ce){var Le=Ce-C[be];if(Le<0){for(var Ee=new DocumentFragment,Ie=new DocumentFragment,xe=0,we=Math.abs(Le);xe<we;xe++){var Te=ie(),Re=de(Te.element);Ee.appendChild(Re.element),Ie.appendChild(Te.element)}Ae.append(Ee),ye.append(Ie)}else for(var _e=(0,u.jg)(Ae,".ha"),ke=(0,u.jg)(ye,".rn"),Se=0,Me=Math.abs(Le);Se<Me;Se++){var $e=Ce-1-Se;_e[$e].remove(),ke[$e].remove()}}}for(var je=(0,u.jg)(k,".kn"),Pe=0;Pe<f;Pe++){var Ze=`g_${Pe}`,De=je[Pe];De.innerHTML=[e.RouteEndPoints.RouteDestination,e.RouteEndPoints.RouteDeparture,""].map(function(e){return`<span>往${e}</span>`})[Pe],De.style.setProperty("--an",`${N[Ze].width}px`),De.style.setProperty("--zm",Pe.toString());var Be=me[Pe];t&&(Be.scrollTop=0);for(var ze=(0,u.aI)(Be,".fa"),Ne=(0,u.aI)(Be,".qn"),Ye=(0,u.jg)(ze,".ha"),qe=(0,u.jg)(Ne,".rn"),Fe=0;Fe<C[Ze];Fe++){var He=Ye[Fe],Qe=qe[Fe],Oe=L[Ze][Fe];if((0,p.mQ)(j,"groupedItems"))if((0,p.mQ)(j.groupedItems,Ze))if(j.groupedItems[Ze][Fe])r(He,Qe,Oe,j.groupedItems[Ze][Fe],t,a);else r(He,Qe,Oe,null,t,a);else r(He,Qe,Oe,null,t,a);else r(He,Qe,Oe,null,t,a)}}j=e,P=a,Z=t}function ve(){return me.apply(this,arguments)}function me(){return(me=(0,n.A)(function*(){var e=(0,l.Js)("playing_animation"),t=(0,l.Js)("refresh_interval"),a=(0,h.gO)("route-bus-arrival-time-chart");O=t.dynamic,F=t.baseInterval,G=!0,W=(0,p.zx)(),R.setAttribute("refreshing","true"),R.classList.remove("pn"),document.addEventListener(W,ne);var n=yield(0,o.R)(V,ee,a.width,a.height,W);pe(n,!1,e);var d=0;O&&(d=yield(0,i.wz)()),U=(new Date).getTime(),J=O?Math.max(U+H,n.dataUpdateTime+F/d):U+F,Q=Math.max(H,J-U),G=!1,R.setAttribute("refreshing","false"),R.style.setProperty("--cn",`${Q}ms`),R.classList.add("pn")})).apply(this,arguments)}function he(){ve().then(function(){K?setTimeout(function(){he()},Math.max(H,J-(new Date).getTime())):X=!1}).catch(function(e){K?((0,f.a)("error","路線網路連線中斷，將在10秒後重試。"),setTimeout(function(){he()},1e4)):X=!1})}function be(e,t){(0,h.WR)("Route"),(0,r.XK)("route",e),V=e,ee=t,D=0,N={},E.setAttribute("displayed","true"),$.scrollLeft=0,$.focus(),function(e,t){for(var a=(0,l.Js)("playing_animation"),n=(0,h.gO)("window"),i=(n.width,n.height),d=Math.floor(i/50)+5,s={},r=0;r<2;r++){var o=`g_${r}`;s[o]=[];for(var u=0;u<d;u++)s[o].push({name:"",goBack:"0",status:{code:8,text:"",time:-6},buses:[],overlappingRoutes:[],busArrivalTimes:[],nearbyLocations:[],sequence:u,position:{longitude:0,latitude:0},nearest:!1,progress:0,segmentBuffer:{isSegmentBuffer:!1,isStartingPoint:!1,isEndingPoint:!1},id:0})}pe({groupedItems:s,groupQuantity:2,itemQuantity:{g_0:d,g_1:d},RouteName:"載入中",RouteEndPoints:{RouteDeparture:"載入中",RouteDestination:"載入中"},RouteID:e,PathAttributeId:t,dataUpdateTime:0},!0,a)}(e,t),K||(K=!0,X?ve():(X=!0,he())),(0,h.Z_)()}function fe(){E.setAttribute("displayed","false"),K=!1,(0,h.l$)()}function ge(e,t){K=!1,be(e,t)}function Ae(e,t){var a,n=(0,u.aI)($,`.ha#${e}`),i=(0,u.aI)(n,".mb"),d=C((0,u.jg)(i,'.nb[highlighted="true"][type="tab"]'));try{for(d.s();!(a=d.n()).done;){a.value.setAttribute("highlighted","false")}}catch(e){d.e(e)}finally{d.f()}switch((0,u.aI)(i,`.nb[code="${t}"]`).setAttribute("highlighted","true"),t){case 0:(0,u.aI)(n,".yb").setAttribute("displayed","true"),(0,u.aI)(n,"._b").setAttribute("displayed","false"),(0,u.aI)(n,".zb").setAttribute("displayed","false"),(0,u.aI)(n,".ac").setAttribute("displayed","false");break;case 1:(0,u.aI)(n,".yb").setAttribute("displayed","false"),(0,u.aI)(n,"._b").setAttribute("displayed","true"),(0,u.aI)(n,".zb").setAttribute("displayed","false"),(0,u.aI)(n,".ac").setAttribute("displayed","false");break;case 2:(0,u.aI)(n,".yb").setAttribute("displayed","false"),(0,u.aI)(n,"._b").setAttribute("displayed","false"),(0,u.aI)(n,".zb").setAttribute("displayed","true"),(0,u.aI)(n,".ac").setAttribute("displayed","false");break;case 3:(0,u.aI)(n,".yb").setAttribute("displayed","false"),(0,u.aI)(n,"._b").setAttribute("displayed","false"),(0,u.aI)(n,".zb").setAttribute("displayed","false"),(0,u.aI)(n,".ac").setAttribute("displayed","true")}}}}]);
//# sourceMappingURL=8eba1eec554c500004f1.js.map