"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[474],{4690(t,e,a){a.d(e,{S5:()=>et,SR:()=>ft,U7:()=>bt});var n=a(467),i=a(5767),d=a(9566),s=a(3422),r=a(5314),o=a(7123),c=a(3459),l=a(8179),u=a(7968),p=a(8024),v=a(5579),m=a(4537),h=a(904),f=a(3030),b=a(9119),g=a(3041),A=a(752),y=a(8194),C=a(5286);function L(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return E(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?E(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("E0")}var d,s=!0,r=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){r=!0,d=t},f:function(){try{s||null==a.return||a.return()}finally{if(r)throw d}}}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=Array(e);a<e;a++)n[a]=t[a];return n}var I=(0,l.bv)(".ba"),w=(0,l.aI)(I,".ym"),x=(0,l.aI)(w,".an"),_=(0,l.aI)(x,"span"),T=(0,l.aI)(w,"._m"),R=(0,l.aI)(w,".hn .in"),k=(0,l.aI)(w,".bn"),M=(0,l.aI)(k,".cn"),S=(0,l.aI)(w,".fn"),$=(0,l.aI)(S,".gn"),j=(0,l.aI)(I,".ca"),P={},Z=!1,D=!1,Y=0,B=0,z=0,N={},F=!1,H=15e3,Q=5e3,q=15e3,U=!0,J=0,W=0,G="",K=!1,O=!1,X=!1,V=0,tt=[];function et(){j.addEventListener("touchstart",function(){Y=Math.round(j.scrollLeft/(0,y.YC)("window")[0])},{passive:!0}),j.addEventListener("scroll",function(t){F=!0;var e=t.target.scrollLeft/(0,y.YC)("window")[0];B=e>Y?Y+1:Y-1;var a=e-Y,n=Math.abs(a);n>1&&(a>0?(Y=Math.floor(e),B=Y+1):(Y=Math.ceil(e),B=Y-1),n=Math.abs(e-Y));var i=N[`g_${Y}`]||{width:0,offset:0},d=N[`g_${B}`]||{width:0,offset:0},s=i.width+(d.width-i.width)*n,r=-1*(i.offset+(d.offset-i.offset)*n)+.5*(0,y.YC)("window")[0]-.5*s;at(z,r,s-20,e)},{passive:!0}),j.addEventListener("scrollend",function(t){var e=t.target.scrollLeft/(0,y.YC)("window")[0];Y=Math.round(e),F=!1},{passive:!0}),window.addEventListener("resize",function(){if(!F){var t=j.scrollLeft/(0,y.YC)("window")[0];Y=Math.round(t);var e=N[`g_${Y}`],a=-1*e.offset+.5*(0,y.YC)("window")[0]-.5*e.width,n=e.width-20;at(z,a,n,Y)}}),screen&&screen.orientation&&screen.orientation.addEventListener("change",function(){if(!F){var t=j.scrollLeft/(0,y.YC)("window")[0];Y=Math.round(t);var e=N[`g_${Y}`],a=-1*e.offset+.5*(0,y.YC)("window")[0]-.5*e.width,n=e.width-20;at(z,a,n,Y)}})}function at(t,e,a,n){j.style.setProperty("--rm",t.toString()),$.style.setProperty("--um",a.toString()),M.style.setProperty("--dn",`${e.toString()}px`),M.style.setProperty("--sm",n.toString())}function nt(t){var e=t;if(K){var a=e.detail.progress-1;R.style.setProperty("--wm",a.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,nt)}function it(){var t=document.createElement("div");t.classList.add("ln"),t.setAttribute("stretched","false"),t.setAttribute("stretching","false"),t.setAttribute("push-direction","0"),t.setAttribute("push-state","0");var e=document.createElement("div");e.classList.add("mn");var a=document.createElement("div");a.classList.add("wn"),a.setAttribute("displayed","false"),e.appendChild(a);var n=document.createElement("div");n.classList.add("nn");var i=document.createElement("div");i.classList.add("_a"),i.setAttribute("code","0"),i.setAttribute("displayed","false"),n.appendChild(i);var d=document.createElement("div");return d.classList.add("ab"),d.setAttribute("code","0"),d.setAttribute("displayed","true"),n.appendChild(d),t.appendChild(e),t.appendChild(n),t}function dt(t){var e=document.createElement("div");e.classList.add("ha"),e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var a=document.createElement("div");a.classList.add("na");var n=document.createElement("div");n.classList.add("oa"),a.appendChild(n);var i=document.createElement("div");i.classList.add("qa");var d=document.createElement("div");d.classList.add("za");var s=document.createElement("div");s.classList.add("_a"),s.setAttribute("code","0"),s.setAttribute("displayed","false"),d.appendChild(s);var r=document.createElement("div");r.classList.add("ab"),r.setAttribute("code","0"),r.setAttribute("displayed","true"),d.appendChild(r),i.appendChild(d);var o=document.createElement("div");o.classList.add("xa"),o.appendChild((0,m.YC)("keyboard_arrow_down")),o.onclick=function(){!function(t,e){var a=(0,l.aI)(t,".lb"),n=t.parentElement,i=e.parentElement,d=(0,l.ji)(e,"ln"),s=(0,l.ji)(t,"ha"),r=s.length,o=n.getBoundingClientRect(),c=t.getBoundingClientRect(),u=i.getBoundingClientRect(),p=e.getBoundingClientRect(),v=p.top-u.top,m=c.top-o.top,h="true"===t.getAttribute("stretched"),f="true"===t.getAttribute("animation");if(f){var b=h?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--_n",`${v}px`),t.setAttribute("stretching","true"),t.style.setProperty("--aa",`${m}px`);for(var g=0;g<r;g++){var A=s[g],y=d[g];y.style.setProperty("--ao",(-1*g-1).toString()),y.setAttribute("push-direction",b),y.setAttribute("push-state","1"),A.setAttribute("push-direction",b),A.setAttribute("push-state","1")}t.addEventListener("transitionend",function(){for(var a=0;a<r;a++){var n=s[a],i=d[a];i.setAttribute("push-direction","0"),i.setAttribute("push-state","0"),n.setAttribute("push-direction","0"),n.setAttribute("push-state","0")}e.setAttribute("stretching","false"),t.setAttribute("stretching","false")},{once:!0}),t.addEventListener("transitionstart",function(){for(var t=0;t<r;t++){var e=s[t];d[t].setAttribute("push-state","2"),e.setAttribute("push-state","2")}},{once:!0})}h?(f?a.addEventListener("transitionend",function(){a.setAttribute("displayed","false")},{once:!0}):a.setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false")):(a.setAttribute("displayed","true"),t.setAttribute("stretched","true"),e.setAttribute("stretched","true"))}(e,t)},i.appendChild(o);var c=document.createElement("div");c.classList.add("va"),i.appendChild(c),a.appendChild(i);var u=document.createElement("div");u.classList.add("lb"),u.setAttribute("displayed","false");var p=document.createElement("div");p.classList.add("mb");var v=document.createElement("div");v.classList.add("nb"),v.setAttribute("highlighted","true"),v.setAttribute("type","tab"),v.setAttribute("code","0"),v.onclick=function(){At(e,0)};var h=document.createElement("div");h.classList.add("wb"),h.appendChild((0,m.YC)("directions_bus")),v.appendChild(h),v.appendChild(document.createTextNode("公車")),p.appendChild(v);var f=document.createElement("div");f.classList.add("nb"),f.setAttribute("highlighted","false"),f.setAttribute("type","tab"),f.setAttribute("code","1"),f.onclick=function(){At(e,1)};var b=document.createElement("div");b.classList.add("wb"),b.appendChild((0,m.YC)("departure_board")),f.appendChild(b),f.appendChild(document.createTextNode("抵達時間")),p.appendChild(f);var g=document.createElement("div");g.classList.add("nb"),g.setAttribute("highlighted","false"),g.setAttribute("type","tab"),g.setAttribute("code","2"),g.onclick=function(){At(e,2)};var A=document.createElement("div");A.classList.add("wb"),A.appendChild((0,m.YC)("route")),g.appendChild(A),g.appendChild(document.createTextNode("路線")),p.appendChild(g);var y=document.createElement("div");y.classList.add("nb"),y.setAttribute("highlighted","false"),y.setAttribute("type","tab"),y.setAttribute("code","3"),y.onclick=function(){At(e,3)};var C=document.createElement("div");C.classList.add("wb"),C.appendChild((0,m.YC)("location_on")),y.appendChild(C),y.appendChild(document.createTextNode("地點")),p.appendChild(y);var L=document.createElement("div");L.classList.add("nb"),L.setAttribute("highlighted","false"),L.setAttribute("type","save-to-folder");var E=document.createElement("div");E.classList.add("wb"),E.appendChild((0,m.YC)("folder")),L.appendChild(E),L.appendChild(document.createTextNode("儲存")),p.appendChild(L);var I=document.createElement("div");I.classList.add("nb"),I.setAttribute("highlighted","false"),I.setAttribute("type","schedule-notification"),I.setAttribute("enabled","true");var w=document.createElement("div");w.classList.add("wb"),w.appendChild((0,m.YC)("notifications")),I.appendChild(w),I.appendChild(document.createTextNode("通知")),p.appendChild(I),u.appendChild(p);var x=document.createElement("div");x.classList.add("yb"),x.setAttribute("displayed","true"),u.appendChild(x);var _=document.createElement("div");_.classList.add("zb"),_.setAttribute("displayed","false"),u.appendChild(_);var T=document.createElement("div");T.classList.add("_b"),T.setAttribute("displayed","false"),u.appendChild(T);var R=document.createElement("div");return R.classList.add("ac"),R.setAttribute("displayed","false"),u.appendChild(R),e.appendChild(a),e.appendChild(u),e}function st(){var t=document.createElement("div");t.classList.add("da");var e=document.createElement("div");e.classList.add("ea");var a=document.createElement("div");a.classList.add("kn");var n=document.createElement("div");n.classList.add("xn");var i=document.createElement("div");i.classList.add("fa");var d=document.createElement("div");return d.classList.add("ga"),i.appendChild(d),a.appendChild(n),e.appendChild(a),e.appendChild(i),t.appendChild(e),t}function rt(){var t=document.createElement("div");return t.classList.add("en"),t}function ot(){var t=document.createElement("div");t.classList.add("bc"),t.setAttribute("on-this-route","false");var e=document.createElement("div");e.classList.add("oc");var a=document.createElement("div");a.classList.add("sc"),a.appendChild((0,m.YC)("directions_bus"));var n=document.createElement("div");n.classList.add("wc");var i=document.createElement("div");i.classList.add("bd");var d=document.createElement("div");d.classList.add("dd");var s=document.createElement("div");s.classList.add("ed");var r=document.createElement("div");return r.classList.add("fd"),e.appendChild(a),e.appendChild(n),t.appendChild(e),i.appendChild(d),i.appendChild(s),i.appendChild(r),t.appendChild(i),t}function ct(){var t=document.createElement("div");t.classList.add("cc");var e=document.createElement("div");e.classList.add("pc");var a=document.createElement("div");a.classList.add("tc"),a.appendChild((0,m.YC)("route"));var n=document.createElement("div");n.classList.add("xc");var i=document.createElement("div");i.classList.add("gd");var d=document.createElement("div");d.classList.add("jd");var s=document.createElement("div");s.classList.add("ld"),s.setAttribute("type","view-route"),s.innerText="查看路線";var r=document.createElement("div");return r.classList.add("ld"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存路線",e.appendChild(a),e.appendChild(n),t.appendChild(e),t.appendChild(i),d.appendChild(s),d.appendChild(r),t.appendChild(d),t}function lt(){var t=document.createElement("div");t.classList.add("dc");var e=document.createElement("div");e.classList.add("qc");var a=document.createElement("div");a.classList.add("uc"),a.appendChild((0,m.YC)("calendar_view_day"));var n=document.createElement("div");n.classList.add("yc");var i=document.createElement("div");i.classList.add("_c");var d=document.createElement("div");return d.classList.add("cd"),e.appendChild(a),e.appendChild(n),e.appendChild(i),t.appendChild(e),t.appendChild(d),t}function ut(){var t=document.createElement("div");t.classList.add("ec");var e=document.createElement("div");e.classList.add("rc");var a=document.createElement("div");a.classList.add("vc"),a.appendChild((0,m.YC)("location_on"));var n=document.createElement("div");n.classList.add("zc");var i=document.createElement("div");i.classList.add("hd");var d=document.createElement("div");d.classList.add("kd");var s=document.createElement("div");s.classList.add("md"),s.setAttribute("type","view-location"),s.innerText="查看地點";var r=document.createElement("div");return r.classList.add("md"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存地點",e.appendChild(a),e.appendChild(n),t.appendChild(e),t.appendChild(i),d.appendChild(s),d.appendChild(r),t.appendChild(d),t}function pt(t,e,a){var n,i;function r(e,a,n,i,r,o){function c(t,e,a,n,i){var d=(0,l.aI)(e,".nn"),s=(0,l.aI)(d,".ab"),r=(0,l.aI)(d,"._a"),o=(0,l.aI)(t,".za"),c=(0,l.aI)(o,".ab"),u=(0,l.aI)(o,"._a");if(r.setAttribute("code",a.status.code.toString()),u.setAttribute("code",a.status.code.toString()),u.innerText=a.status.text,!n&&i){var p=t.getBoundingClientRect(),v=p.top,m=p.left,h=p.bottom,f=p.right,b=window.innerWidth,g=window.innerHeight;if(h>0&&v<g&&f>0&&m<b)return s.addEventListener("animationend",function(){s.setAttribute("code",a.status.code.toString()),s.classList.remove("kb"),r.setAttribute("displayed","false")},{once:!0}),c.addEventListener("animationend",function(){c.setAttribute("code",a.status.code.toString()),c.innerText=a.status.text,c.classList.remove("kb"),u.setAttribute("displayed","false")},{once:!0}),u.setAttribute("displayed","true"),r.setAttribute("displayed","true"),s.classList.add("kb"),void c.classList.add("kb")}s.setAttribute("code",a.status.code.toString()),c.setAttribute("code",a.status.code.toString()),c.innerText=a.status.text}function u(t,e,a){t.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer)),e.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer))}function m(t,e){(0,l.aI)(t,".oa").innerText=e.name}function h(t,e){var a=(0,l.aI)(t,".yb"),n=(0,l.jg)(a,".bc"),i=n.length,d=e.buses.length,s=i-d;if(s<0){for(var r=new DocumentFragment,o=0,c=Math.abs(s);o<c;o++){var u=ot();r.appendChild(u)}a.append(r)}else for(var v=0,m=Math.abs(s);v<m;v++){n[i-1-v].remove()}for(var h=(0,l.jg)(a,".bc"),f=0;f<d;f++){var b=e.buses[f],g=h[f],A=(0,l.aI)(g,".oc"),y=(0,l.aI)(A,".wc"),C=(0,l.aI)(g,".bd"),L=(0,l.aI)(C,".dd"),E=(0,l.aI)(C,".ed"),I=(0,l.aI)(C,".fd");g.setAttribute("on-this-route",(0,p.xZ)(b.onThisRoute)),y.innerText=b.carNumber,L.innerText=`路線：${b.RouteName}`,E.innerText=`狀態：${b.status.text}`,I.innerText=`類型：${b.type}`}a.setAttribute("empty",(0,p.xZ)(0===d))}function b(t,e){var a=(0,l.aI)(t,".zb"),n=(0,l.jg)(a,".cc"),i=n.length,s=e.overlappingRoutes.length,r=i-s;if(r<0){for(var o=new DocumentFragment,c=0,u=Math.abs(r);c<u;c++){var v=ct();o.appendChild(v)}a.append(o)}else for(var m=0,h=Math.abs(r);m<h;m++){n[i-1-m].remove()}for(var f=(0,l.jg)(a,".cc"),b=0;b<s;b++){var A=e.overlappingRoutes[b],y=f[b],C=(0,l.aI)(y,".pc"),L=(0,l.aI)(C,".xc"),E=(0,l.aI)(y,".gd"),I=(0,l.aI)(y,".jd"),w=(0,l.aI)(I,'.ld[type="view-route"]'),x=(0,l.aI)(I,'.ld[type="save-to-folder"]');L.innerText=A.name,E.innerText=A.RouteEndPoints.text,function(t,e,a){t.onclick=function(){gt(e,a)}}(w,A.RouteID,A.PathAttributeId),function(t,e){t.onclick=function(){(0,g.B)("route",[e],t)},(0,d.LH)("route",e).then(function(e){t.setAttribute("highlighted",(0,p.xZ)(e))})}(x,A.RouteID)}a.setAttribute("empty",(0,p.xZ)(0===s))}function y(t,e){var a=(0,l.aI)(t,"._b"),n=(0,l.jg)(a,".dc"),i=n.length,d=e.busArrivalTimes.length,s=i-d;if(s<0){for(var r=new DocumentFragment,o=0,c=Math.abs(s);o<c;o++){var u=lt();r.appendChild(u)}a.append(r)}else for(var m=0,h=Math.abs(s);m<h;m++){n[i-1-m].remove()}for(var f=(0,l.jg)(a,".dc"),b=0;b<d;b++){var g=e.busArrivalTimes[b],A=f[b],y=(0,l.aI)(A,".qc"),C=(0,l.aI)(y,".yc"),L=(0,l.aI)(y,"._c"),E=(0,l.aI)(A,".cd");C.innerText=g.personalSchedule.name,L.innerText=`週${(0,v.kd)(g.day).name} ${(0,v.pn)(g.personalSchedule.period.start)} - ${(0,v.pn)(g.personalSchedule.period.end)}`,E.innerHTML=g.chart}a.setAttribute("empty",(0,p.xZ)(0===d))}function C(t,e){var a=(0,l.aI)(t,".ac"),n=(0,l.jg)(a,".ec"),i=n.length,s=e.nearbyLocations.length,r=i-s;if(r<0){for(var o=new DocumentFragment,c=0,u=Math.abs(r);c<u;c++){var v=ut();o.appendChild(v)}a.append(o)}else for(var m=0,h=Math.abs(r);m<h;m++){n[i-1-m].remove()}for(var b=(0,l.jg)(a,".ec"),A=0;A<s;A++){var y=e.nearbyLocations[A],C=b[A],L=(0,l.aI)(C,".rc"),E=(0,l.aI)(L,".zc"),I=(0,l.aI)(C,".hd"),w=(0,l.aI)(C,".kd"),x=(0,l.aI)(w,'.md[type="view-location"]'),_=(0,l.aI)(w,'.md[type="save-to-folder"]');E.innerText=y.name,I.innerText=`${y.distance}公尺`,function(t,e){t.onclick=function(){(0,f.so)(e)}}(x,y.hash),function(t,e){t.onclick=function(){(0,g.B)("location",[e],t)},(0,d.LH)("location",e).then(function(e){t.setAttribute("highlighted",(0,p.xZ)(e))})}(_,y.hash)}a.setAttribute("empty",(0,p.xZ)(0===s))}function L(t,e,a){t.setAttribute("nearest",(0,p.xZ)(a.nearest)),e.setAttribute("nearest",(0,p.xZ)(a.nearest))}function E(t,e,a,n,i){var d=(null==a?void 0:a.progress)||0,s=(null==e?void 0:e.progress)||0,r=(0,l.aI)(t,".mn .wn");if(!n&&i&&0!==d&&0===s&&Math.abs(s-d)>0)return r.style.setProperty("--yn","100%"),void r.addEventListener("transitionend",function(){r.setAttribute("displayed","false"),r.style.setProperty("--yn","-100%")},{once:!0});s>0?(r.setAttribute("displayed","true"),r.style.setProperty("--yn",100*(s-1)+"%")):r.setAttribute("displayed","false")}function I(t,e,a){a&&((0,l.aI)(t,".lb").setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false"))}function w(t,e,a){t.setAttribute("animation",(0,p.xZ)(a)),e.setAttribute("animation",(0,p.xZ)(a))}function x(t,e,a){t.setAttribute("skeleton-screen",(0,p.xZ)(a)),e.setAttribute("skeleton-screen",(0,p.xZ)(a))}function _(e,a){var n=(0,l.aI)(e,'.lb .mb .nb[type="save-to-folder"]');n.onclick=function(){(0,g.B)("stop",[a.id,t.RouteID],n)},(0,d.LH)("stop",a.id).then(function(t){n.setAttribute("highlighted",(0,p.xZ)(t))})}function T(e,a){var n=(0,l.aI)(e,'.lb .mb .nb[type="schedule-notification"]');n.onclick=function(){(0,A.Ho)(n,a.id,t.RouteID,a.status.time)};var i=(0,s.Zc)(a.id);n.setAttribute("highlighted",(0,p.xZ)(i))}null===i?(c(e,a,n,r,o),m(e,n),h(e,n),b(e,n),y(e,n),C(e,n),u(e,a,n),L(e,a,n),E(a,n,i,r,o),I(e,a,r),w(e,a,o),x(e,a,r),_(e,n),T(e,n)):(n.status.time!==i.status.time&&(c(e,a,n,r,o),T(e,n)),(0,p.hw)(i.buses,n.buses)||h(e,n),(0,p.hw)(i.busArrivalTimes,n.busArrivalTimes)||y(e,n),i.nearest!==n.nearest&&L(e,a,n),i.progress!==n.progress&&E(a,n,i,r,o),i.id!==n.id&&(m(e,n),u(e,a,n),b(e,n),C(e,n),_(e,n),T(e,n)),Z!==o&&w(e,a,o),D!==r&&(I(e,a,r),x(e,a,r)))}var o=t.groupQuantity,c=t.itemQuantity,m=t.groupedItems;z=o;for(var h=0,b=[t.RouteEndPoints.RouteDestination,t.RouteEndPoints.RouteDeparture,"未知"].map(function(t){return`往${t}`}),L=0;L<o;L++){var E=`g_${L}`,I=(0,u.q_)(b[L],500,"17px",'"Noto Sans TC", sans-serif')+20;N[E]={width:I,offset:h},h+=I}if(N[`g_${o}`]={width:0,offset:h},!F){var w=N[`g_${Y}`],R=-1*w.offset+.5*(0,y.YC)("window")[0]-.5*w.width,$=w.width-20;at(z,R,$,Y)}D!==e&&(x.setAttribute("skeleton-screen",(0,p.xZ)(e)),k.setAttribute("skeleton-screen",(0,p.xZ)(e)),S.setAttribute("skeleton-screen",(0,p.xZ)(e))),Z!==a&&(x.setAttribute("animation",(0,p.xZ)(a)),k.setAttribute("animation",(0,p.xZ)(a)),S.setAttribute("animation",(0,p.xZ)(a))),(null===(n=P)||void 0===n?void 0:n.RouteID)!==t.RouteID&&(T.onclick=function(){(0,C.GS)(t.RouteID,t.PathAttributeId)}),(null===(i=P)||void 0===i?void 0:i.RouteName)!==t.RouteName&&(_.innerText=t.RouteName);var B=(0,l.jg)(j,".da").length;if(o!==B){var H=B-o;if(H<0){for(var Q=new DocumentFragment,q=new DocumentFragment,U=0,J=Math.abs(H);U<J;U++){var W=st();Q.appendChild(W);var G=rt();q.appendChild(G)}j.append(Q),M.append(q)}else for(var K=(0,l.jg)(j,".da"),O=(0,l.jg)(M,".en"),X=0,V=Math.abs(H);X<V;X++){var tt=B-1-X;K[tt].remove(),O[tt].remove()}}for(var et=(0,l.jg)(j,".da"),nt=0;nt<o;nt++){var pt=`g_${nt}`,vt=et[nt],mt=(0,l.aI)(vt,".fa"),ht=(0,l.aI)(vt,".kn"),ft=(0,l.jg)(mt,".ha").length;if(c[pt]!==ft){var bt=ft-c[pt];if(bt<0){for(var At=new DocumentFragment,yt=new DocumentFragment,Ct=0,Lt=Math.abs(bt);Ct<Lt;Ct++){var Et=it(),It=dt(Et);At.appendChild(It),yt.appendChild(Et)}mt.append(At),ht.append(yt)}else for(var wt=(0,l.jg)(mt,".ha"),xt=(0,l.jg)(ht,".ln"),_t=0,Tt=Math.abs(bt);_t<Tt;_t++){var Rt=ft-1-_t;wt[Rt].remove(),xt[Rt].remove()}}}for(var kt=(0,l.jg)(M,".en"),Mt=0;Mt<o;Mt++){var St=`g_${Mt}`,$t=kt[Mt];$t.innerHTML=[t.RouteEndPoints.RouteDestination,t.RouteEndPoints.RouteDeparture,""].map(function(t){return`<span>往${t}</span>`})[Mt],$t.style.setProperty("--vm",`${N[St].width}px`),$t.style.setProperty("--tm",Mt.toString());var jt=et[Mt];e&&(jt.scrollTop=0);for(var Pt=(0,l.aI)(jt,".fa"),Zt=(0,l.aI)(jt,".kn"),Dt=(0,l.jg)(Pt,".ha"),Yt=(0,l.jg)(Zt,".ln"),Bt=0;Bt<c[St];Bt++){var zt=Dt[Bt],Nt=Yt[Bt],Ft=m[St][Bt];if((0,p.mQ)(P,"groupedItems"))if((0,p.mQ)(P.groupedItems,St))if(P.groupedItems[St][Bt])r(zt,Nt,Ft,P.groupedItems[St][Bt],e,a);else r(zt,Nt,Ft,null,e,a);else r(zt,Nt,Ft,null,e,a);else r(zt,Nt,Ft,null,e,a)}}P=t,Z=a,D=e}function vt(){return mt.apply(this,arguments)}function mt(){return(mt=(0,n.A)(function*(){var t=(0,c.Js)("playing_animation"),e=(0,c.Js)("refresh_interval");U=e.dynamic,H=e.baseInterval,K=!0,G=(0,p.zx)(),R.setAttribute("refreshing","true"),R.classList.remove("jn"),document.addEventListener(G,nt);var a=yield(0,o.R)(V,tt,(0,y.YC)("route_details_canvas")[0],(0,y.YC)("route_details_canvas")[1],G);pt(a,!1,t);var n=0;U&&(n=yield(0,i.wz)()),J=(new Date).getTime(),W=U?Math.max(J+Q,a.dataUpdateTime+H/n):J+H,q=Math.max(Q,W-J),K=!1,R.setAttribute("refreshing","false"),R.style.setProperty("--xm",`${q}ms`),R.classList.add("jn")})).apply(this,arguments)}function ht(){vt().then(function(){O?setTimeout(function(){ht()},Math.max(Q,W-(new Date).getTime())):X=!1}).catch(function(t){O?((0,b.a)("error","路線網路連線中斷，將在10秒後重試。"),setTimeout(function(){ht()},1e4)):X=!1})}function ft(t,e){(0,h.WR)("Route"),(0,r.XK)("route",t),V=t,tt=e,Y=0,N={},I.setAttribute("displayed","true"),j.scrollLeft=0,j.focus(),function(t,e){for(var a=(0,c.Js)("playing_animation"),n=Math.floor((0,y.YC)("window")[1]/50)+5,i={},d=0;d<2;d++){var s=`g_${d}`;i[s]=[];for(var r=0;r<n;r++)i[s].push({name:"",goBack:"0",status:{code:8,text:"",time:-6},buses:[],overlappingRoutes:[],busArrivalTimes:[],nearbyLocations:[],sequence:r,position:{longitude:0,latitude:0},nearest:!1,progress:0,segmentBuffer:{isSegmentBuffer:!1,isStartingPoint:!1,isEndingPoint:!1},id:0})}pt({groupedItems:i,groupQuantity:2,itemQuantity:{g_0:n,g_1:n},RouteName:"載入中",RouteEndPoints:{RouteDeparture:"載入中",RouteDestination:"載入中"},RouteID:t,PathAttributeId:e,dataUpdateTime:0},!0,a)}(t,e),O||(O=!0,X?vt():(X=!0,ht())),(0,h.Z_)()}function bt(){I.setAttribute("displayed","false"),O=!1,(0,h.l$)()}function gt(t,e){O=!1,ft(t,e)}function At(t,e){var a,n=(0,l.aI)(t,".mb"),i=L((0,l.jg)(n,'.nb[highlighted="true"][type="tab"]'));try{for(i.s();!(a=i.n()).done;){a.value.setAttribute("highlighted","false")}}catch(t){i.e(t)}finally{i.f()}switch((0,l.aI)(n,`.nb[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:(0,l.aI)(t,".yb").setAttribute("displayed","true"),(0,l.aI)(t,"._b").setAttribute("displayed","false"),(0,l.aI)(t,".zb").setAttribute("displayed","false"),(0,l.aI)(t,".ac").setAttribute("displayed","false");break;case 1:(0,l.aI)(t,".yb").setAttribute("displayed","false"),(0,l.aI)(t,"._b").setAttribute("displayed","true"),(0,l.aI)(t,".zb").setAttribute("displayed","false"),(0,l.aI)(t,".ac").setAttribute("displayed","false");break;case 2:(0,l.aI)(t,".yb").setAttribute("displayed","false"),(0,l.aI)(t,"._b").setAttribute("displayed","false"),(0,l.aI)(t,".zb").setAttribute("displayed","true"),(0,l.aI)(t,".ac").setAttribute("displayed","false");break;case 3:(0,l.aI)(t,".yb").setAttribute("displayed","false"),(0,l.aI)(t,"._b").setAttribute("displayed","false"),(0,l.aI)(t,".zb").setAttribute("displayed","false"),(0,l.aI)(t,".ac").setAttribute("displayed","true")}}}}]);
//# sourceMappingURL=d6061e0ec2868b57cc0f.js.map