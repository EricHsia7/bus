{"version":3,"file":"8ebd1fc67ab0df5b9e39.js","mappings":"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","sources":["webpack://bus/./src/interface/location/details/index.ts","webpack://bus/./src/interface/location/index.ts"],"sourcesContent":["import { getLocation, MergedLocation, MergedLocationItem } from '../../../data/apis/getLocation/index';\nimport { deleteDataReceivingProgress, deleteDataUpdateTime } from '../../../data/apis/loader';\nimport { IntegratedLocationDetails, IntegratedLocationDetailsAction, integrateLocationDetails } from '../../../data/location/details';\nimport { getSettingOptionValue } from '../../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll } from '../../../tools/elements';\nimport { booleanToString, generateIdentifier, hasOwnProperty } from '../../../tools/index';\nimport { getPermalink } from '../../../tools/permalink';\nimport { getBlankIconElement, setIcon } from '../../icons/index';\nimport { GeneratedElement, pushPageHistory, revokePageHistory } from '../../index';\nimport { promptMessage } from '../../prompt/index';\nimport { openQRCode } from '../../qrcode/index';\n\nlet previousIntegration = {} as IntegratedLocationDetails;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nconst LocationDetailsField = documentQuerySelector('.css_location_details_field');\nconst LocationDetailsBodyElement = elementQuerySelector(LocationDetailsField, '.css_location_details_body');\nconst LocationDetailsActionsElement = elementQuerySelector(LocationDetailsBodyElement, '.css_location_details_actions');\n\nfunction generateElementOfItem(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_details_action');\n\n  // Icon\n  const icon = document.createElement('div');\n  icon.classList.add('css_location_details_action_icon');\n  icon.appendChild(getBlankIconElement());\n  element.appendChild(icon);\n\n  // Name\n  const name = document.createElement('div');\n  name.classList.add('css_location_details_action_name');\n  element.appendChild(name);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction updateLocationDetailsField(integration: IntegratedLocationDetails, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction, previousItem: IntegratedLocationDetailsAction | null): void {\n    function updateIcon(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_action_icon');\n      setIcon(thisIconElement, thisItem.icon);\n    }\n\n    function updateName(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      const nameElement = elementQuerySelector(thisElement, '.css_location_details_action_name');\n      nameElement.innerText = thisItem.name;\n    }\n\n    function updateOnclick(thisElement: HTMLElement, thisItem: IntegratedLocationDetailsAction): void {\n      thisElement.onclick = thisItem.action;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateIcon(thisElement, thisItem);\n      updateName(thisElement, thisItem);\n      updateOnclick(thisElement, thisItem);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (previousItem.key !== thisItem.key) {\n        updateIcon(thisElement, thisItem);\n        updateName(thisElement, thisItem);\n        updateOnclick(thisElement, thisItem);\n      }\n\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const actions = integration.actions;\n  const actionsQuantity = integration.actionsQuantity;\n\n  const currentActionsCapacity = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action').length;\n  if (actionsQuantity !== currentActionsCapacity) {\n    const difference = currentActionsCapacity - actionsQuantity;\n    if (difference < 0) {\n      const fragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newItemElement = generateElementOfItem();\n        fragment.appendChild(newItemElement.element);\n      }\n      LocationDetailsActionsElement.append(fragment);\n    } else {\n      const LocationActionElements = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const itemIndex = currentActionsCapacity - 1 - o;\n        LocationActionElements[itemIndex].remove();\n      }\n    }\n  }\n\n  const LocationActionElements = elementQuerySelectorAll(LocationDetailsActionsElement, '.css_location_details_action');\n\n  for (let i = 0; i < actionsQuantity; i++) {\n    const thisElement = LocationActionElements[i];\n    const thisItem = actions[i];\n    if (hasOwnProperty(previousIntegration, 'actions')) {\n      if (previousIntegration.actions[i]) {\n        const previousItem = previousIntegration.actions[i];\n        updateItem(thisElement, thisItem, previousItem);\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    } else {\n      updateItem(thisElement, thisItem, null);\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nfunction setUpLocationDetailsFieldSkeletonScreen(): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const actions: IntegratedLocationDetailsAction[] = [];\n  /*\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  */\n  const defaultActionsQuantity = 3;\n  for (let i = 0; i < defaultActionsQuantity; i++) {\n    actions.push({\n      name: '',\n      icon: '',\n      key: `action-${i}`,\n      action: function () {}\n    });\n  }\n\n  updateLocationDetailsField(\n    {\n      actions: actions,\n      actionsQuantity: defaultActionsQuantity,\n      hash: ''\n    },\n    true,\n    playing_animation\n  );\n}\n\nasync function initializeLocationDetailsField(hash: string) {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const requestID = generateIdentifier();\n  const integration = await integrateLocationDetails(hash, requestID);\n  updateLocationDetailsField(integration, false, playing_animation);\n}\n\nexport function openLocationDetails(hash: string): void {\n  pushPageHistory('LocationDetails');\n  LocationDetailsField.setAttribute('displayed', 'true');\n  setUpLocationDetailsFieldSkeletonScreen();\n  initializeLocationDetailsField(hash);\n}\n\nexport function closeLocationDetails(): void {\n  revokePageHistory('LocationDetails');\n  LocationDetailsField.setAttribute('displayed', 'false');\n}\n\nexport async function shareLocationPermalink(hash: string) {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  if (hasOwnProperty(Location, thisLocationKey)) {\n    const thisLocation = Location[thisLocationKey] as MergedLocationItem;\n    const link = getPermalink(1, {\n      hash: hash\n    });\n    if (navigator.share) {\n      navigator\n        .share({\n          title: thisLocation.n,\n          url: link\n        })\n        .then(() => {\n          promptMessage('check_circle', '已分享地點');\n        })\n        .catch((e) => {\n          promptMessage('cancel', '已取消分享');\n          console.error(e);\n        });\n    }\n  }\n}\n\nexport async function showLocationPermalinkQRCode(hash: string) {\n  const requestID = generateIdentifier();\n  const Location = (await getLocation(requestID, 1)) as MergedLocation;\n  deleteDataReceivingProgress(requestID);\n  deleteDataUpdateTime(requestID);\n  const thisLocationKey = `ml_${hash}`;\n  if (hasOwnProperty(Location, thisLocationKey)) {\n    const link = getPermalink(1, {\n      hash: hash\n    });\n    openQRCode(link);\n  }\n}\n","import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { isFolderContentSaved } from '../../data/folder/index';\nimport { IntegratedLocation, IntegratedLocationItem, integrateLocation, LocationGroupProperty } from '../../data/location/index';\nimport { stopHasNotifcationSchedules } from '../../data/notification/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll, getElementsBelow } from '../../tools/elements';\nimport { getTextWidth } from '../../tools/graphic';\nimport { booleanToString, compareThings, generateIdentifier, hasOwnProperty } from '../../tools/index';\nimport { indexToDay, timeObjectToString } from '../../tools/time';\nimport { getBlankIconElement, getIconElement, getIconHTML, setIcon } from '../icons/index';\nimport { closePreviousPage, GeneratedElement, GroupStyles, openPreviousPage, pushPageHistory, querySize } from '../index';\nimport { promptMessage } from '../prompt/index';\nimport { openSaveToFolder } from '../save-to-folder/index';\nimport { openScheduleNotification } from '../schedule-notification/index';\nimport { openLocationDetails } from './details/index';\n\nconst LocationField = documentQuerySelector('.css_location_field');\nconst LocationHeadElement = elementQuerySelector(LocationField, '.css_location_head');\nconst LocationNameElement = elementQuerySelector(LocationHeadElement, '.css_location_name');\nconst LocationNameSpanElement = elementQuerySelector(LocationNameElement, 'span');\nconst LocationButtonRightElement = elementQuerySelector(LocationHeadElement, '.css_location_button_right');\nconst LocationGroupsElement = elementQuerySelector(LocationField, '.css_location_groups');\nconst LocationGroupTabsElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tabs');\nconst LocationGroupTabsTrayElement = elementQuerySelector(LocationGroupTabsElement, '.css_location_group_tabs_tray');\nconst LocationGroupTabLineTrackElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tab_line_track');\nconst LocationGroupTabLineElement = elementQuerySelector(LocationGroupTabLineTrackElement, '.css_location_group_tab_line');\nconst LocationUpdateTimerElement = elementQuerySelector(LocationHeadElement, '.css_location_update_timer_box .css_location_update_timer');\n\nlet previousIntegration = {} as IntegratedLocation;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet locationSliding_initialIndex: number = 0;\nlet locationSliding_targetIndex: number = 0;\nlet locationSliding_groupQuantity: number = 0;\nlet locationSliding_groupStyles: GroupStyles = {};\nlet locationSliding_fieldWidth: number = 0;\nlet locationSliding_fieldHeight: number = 0;\nlet locationSliding_sliding: boolean = false;\n\nlet locationRefreshTimer_retryInterval: number = 10 * 1000;\nlet locationRefreshTimer_baseInterval: number = 15 * 1000;\nlet locationRefreshTimer_minInterval: number = 5 * 1000;\nlet locationRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet locationRefreshTimer_dynamic: boolean = true;\nlet locationRefreshTimer_lastUpdate: number = 0;\nlet locationRefreshTimer_nextUpdate: number = 0;\nlet locationRefreshTimer_currentRequestID: string = '';\nlet locationRefreshTimer_refreshing: boolean = false;\nlet locationRefreshTimer_streaming: boolean = false;\nlet locationRefreshTimer_streamStarted: boolean = false;\n\nlet currentHashSet_hash: string = '';\n\nlet tabPadding: number = 20;\n\nexport function initializeLocationSliding(): void {\n  LocationGroupsElement.addEventListener(\n    'touchstart',\n    function () {\n      locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / locationSliding_fieldWidth);\n    },\n    { passive: true }\n  );\n\n  LocationGroupsElement.addEventListener(\n    'scroll',\n    function (event: Event) {\n      locationSliding_sliding = true;\n      const target = event.target as HTMLElement;\n      const currentIndex = target.scrollLeft / locationSliding_fieldWidth;\n      if (currentIndex > locationSliding_initialIndex) {\n        locationSliding_targetIndex = locationSliding_initialIndex + 1;\n      } else {\n        locationSliding_targetIndex = locationSliding_initialIndex - 1;\n      }\n      const indexDifference = currentIndex - locationSliding_initialIndex;\n      let delta = Math.abs(indexDifference);\n      if (delta > 1) {\n        if (indexDifference > 0) {\n          locationSliding_initialIndex = Math.floor(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex + 1;\n        } else {\n          locationSliding_initialIndex = Math.ceil(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex - 1;\n        }\n        delta = Math.abs(currentIndex - locationSliding_initialIndex);\n      }\n      const initialSize = locationSliding_groupStyles[`g_${locationSliding_initialIndex}`] || { width: 0, offset: 0 };\n      const targetSize = locationSliding_groupStyles[`g_${locationSliding_targetIndex}`] || { width: 0, offset: 0 };\n      const tabWidth = initialSize.width + (targetSize.width - initialSize.width) * delta;\n      const offset = (initialSize.offset + (targetSize.offset - initialSize.offset) * delta) * -1 + locationSliding_fieldWidth * 0.5 - tabWidth * 0.5;\n      updateLocationCSS(locationSliding_groupQuantity, offset, tabWidth - tabPadding, currentIndex);\n      if (currentIndex === locationSliding_targetIndex) {\n        locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / locationSliding_fieldWidth);\n        locationSliding_sliding = false;\n      }\n    },\n    { passive: true }\n  );\n}\n\nexport function updateLocationCSS(groupQuantity: number, offset: number, tabLineWidth: number, percentage: number): void {\n  LocationGroupsElement.style.setProperty('--b-cssvar-location-group-quantity', groupQuantity.toString());\n  LocationGroupTabLineElement.style.setProperty('--b-cssvar-location-tab-line-width-scale', tabLineWidth.toString());\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-tabs-tray-offset', `${offset.toString()}px`);\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-percentage', percentage.toString());\n}\n\nfunction animateUpdateTimer(): void {\n  LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-interval', `${locationRefreshTimer_dynamicInterval}ms`);\n  LocationUpdateTimerElement.classList.add('css_location_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (locationRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfItem(): GeneratedElement {\n  const identifier = generateIdentifier();\n\n  // Main container\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_location_group_item');\n  itemElement.id = identifier;\n  itemElement.setAttribute('stretched', 'false');\n  itemElement.setAttribute('stretching', 'false');\n  itemElement.setAttribute('push-direction', '0');\n  itemElement.setAttribute('push-state', '0');\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_location_group_item_head');\n\n  // Rank\n  const rankElement = document.createElement('div');\n  rankElement.classList.add('css_location_group_item_rank');\n  const rankNextSlideElement = document.createElement('div');\n  rankNextSlideElement.classList.add('css_location_group_item_rank_next_slide');\n  rankNextSlideElement.setAttribute('code', '-1');\n  rankNextSlideElement.setAttribute('displayed', 'false');\n  const rankCurrentSlideElement = document.createElement('div');\n  rankCurrentSlideElement.classList.add('css_location_group_item_rank_current_slide');\n  rankCurrentSlideElement.setAttribute('code', '-1');\n  rankCurrentSlideElement.setAttribute('displayed', 'true');\n  rankElement.appendChild(rankNextSlideElement);\n  rankElement.appendChild(rankCurrentSlideElement);\n\n  // Route direction\n  const routeDirectionElement = document.createElement('div');\n  routeDirectionElement.classList.add('css_location_group_item_route_direction');\n\n  // Route name\n  const routeNameElement = document.createElement('div');\n  routeNameElement.classList.add('css_location_group_item_route_name');\n\n  // Capsule\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_location_group_item_capsule');\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_location_group_item_status');\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n  statusElement.appendChild(nextSlideElement);\n  statusElement.appendChild(currentSlideElement);\n\n  // Stretch button\n  const stretchElement = document.createElement('div');\n  stretchElement.classList.add('css_location_group_item_stretch');\n  stretchElement.appendChild(getIconElement('keyboard_arrow_down'));\n  stretchElement.onclick = () => {\n    stretchLocationItem(identifier);\n  };\n\n  // Capsule separator\n  const capsuleSeparatorElement = document.createElement('div');\n  capsuleSeparatorElement.classList.add('css_location_group_item_capsule_separator');\n\n  // Assemble capsule\n  capsuleElement.appendChild(statusElement);\n  capsuleElement.appendChild(stretchElement);\n  capsuleElement.appendChild(capsuleSeparatorElement);\n\n  // Assemble head\n  headElement.appendChild(rankElement);\n  headElement.appendChild(routeDirectionElement);\n  headElement.appendChild(routeNameElement);\n  headElement.appendChild(capsuleElement);\n\n  // Body\n  const bodyElement = document.createElement('div');\n  bodyElement.classList.add('css_location_group_item_body');\n  bodyElement.setAttribute('displayed', 'false');\n\n  // Buttons\n  const buttonsElement = document.createElement('div');\n  buttonsElement.classList.add('css_location_group_item_buttons');\n\n  // Tab: 公車\n  const busTabButtonElement = document.createElement('div');\n  busTabButtonElement.classList.add('css_location_group_item_button');\n  busTabButtonElement.setAttribute('highlighted', 'true');\n  busTabButtonElement.setAttribute('type', 'tab');\n  busTabButtonElement.setAttribute('code', '0');\n  const busTabIconElement = document.createElement('div');\n  busTabIconElement.classList.add('css_location_group_item_button_icon');\n  busTabIconElement.appendChild(getIconElement('directions_bus'));\n  busTabButtonElement.appendChild(busTabIconElement);\n  busTabButtonElement.appendChild(document.createTextNode('公車'));\n  busTabButtonElement.onclick = () => {\n    switchLocationBodyTab(identifier, 0);\n  };\n\n  // Tab: 抵達時間\n  const arrivalTabButtonElement = document.createElement('div');\n  arrivalTabButtonElement.classList.add('css_location_group_item_button');\n  arrivalTabButtonElement.setAttribute('highlighted', 'false');\n  arrivalTabButtonElement.setAttribute('type', 'tab');\n  arrivalTabButtonElement.setAttribute('code', '1');\n  const arrivalTabIconElement = document.createElement('div');\n  arrivalTabIconElement.classList.add('css_location_group_item_button_icon');\n  arrivalTabIconElement.appendChild(getIconElement('departure_board'));\n  arrivalTabButtonElement.appendChild(arrivalTabIconElement);\n  arrivalTabButtonElement.appendChild(document.createTextNode('抵達時間'));\n  arrivalTabButtonElement.onclick = () => {\n    switchLocationBodyTab(identifier, 1);\n  };\n\n  // Button: 儲存\n  const saveButtonElement = document.createElement('div');\n  saveButtonElement.classList.add('css_location_group_item_button');\n  saveButtonElement.setAttribute('highlighted', 'false');\n  saveButtonElement.setAttribute('type', 'save-to-folder');\n  const saveButtonIconElement = document.createElement('div');\n  saveButtonIconElement.classList.add('css_location_group_item_button_icon');\n  saveButtonIconElement.appendChild(getIconElement('folder'));\n  saveButtonElement.appendChild(saveButtonIconElement);\n  saveButtonElement.appendChild(document.createTextNode('儲存'));\n\n  // Button: 通知\n  const notifyButtonElement = document.createElement('div');\n  notifyButtonElement.classList.add('css_location_group_item_button');\n  notifyButtonElement.setAttribute('highlighted', 'false');\n  notifyButtonElement.setAttribute('type', 'schedule-notification');\n  notifyButtonElement.setAttribute('enabled', 'true');\n  const notifyButtonIconElement = document.createElement('div');\n  notifyButtonIconElement.classList.add('css_location_group_item_button_icon');\n  notifyButtonIconElement.appendChild(getIconElement('notifications'));\n  notifyButtonElement.appendChild(notifyButtonIconElement);\n  notifyButtonElement.appendChild(document.createTextNode('通知'));\n\n  // Assemble buttons\n  buttonsElement.appendChild(busTabButtonElement);\n  buttonsElement.appendChild(arrivalTabButtonElement);\n  buttonsElement.appendChild(saveButtonElement);\n  buttonsElement.appendChild(notifyButtonElement);\n\n  // Buses\n  const busesElement = document.createElement('div');\n  busesElement.classList.add('css_location_group_item_buses');\n  busesElement.setAttribute('displayed', 'true');\n\n  // Bus arrival times\n  const busArrivalTimesElement = document.createElement('div');\n  busArrivalTimesElement.classList.add('css_location_group_item_bus_arrival_times');\n  busArrivalTimesElement.setAttribute('displayed', 'false');\n\n  // Assemble body\n  bodyElement.appendChild(buttonsElement);\n  bodyElement.appendChild(busesElement);\n  bodyElement.appendChild(busArrivalTimesElement);\n\n  // Assemble item\n  itemElement.appendChild(headElement);\n  itemElement.appendChild(bodyElement);\n\n  return {\n    element: itemElement,\n    id: identifier\n  };\n}\n\nfunction generateElementOfGroup(): GeneratedElement {\n  // Main container\n  const groupElement = document.createElement('div');\n  groupElement.classList.add('css_location_group');\n\n  // Details\n  const detailsElement = document.createElement('div');\n  detailsElement.classList.add('css_location_group_details');\n\n  // Details body\n  const detailsBodyElement = document.createElement('div');\n  detailsBodyElement.classList.add('css_location_group_details_body');\n  detailsElement.appendChild(detailsBodyElement);\n\n  // Items\n  const itemsElement = document.createElement('div');\n  itemsElement.classList.add('css_location_group_items');\n\n  // Assemble group\n  groupElement.appendChild(detailsElement);\n  groupElement.appendChild(itemsElement);\n\n  return {\n    element: groupElement,\n    id: ''\n  };\n}\n\nfunction generateElementOfTab(): GeneratedElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_group_tab');\n\n  const span = document.createElement('span');\n  element.appendChild(span);\n\n  return {\n    element: element,\n    id: ''\n  };\n}\n\nfunction generateElementOfGroupDetailsProperty(): GeneratedElement {\n  // Main container\n  const propertyElement = document.createElement('div');\n  propertyElement.classList.add('css_location_group_details_property');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_location_details_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  // Value\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_location_details_property_value');\n\n  // Assemble\n  propertyElement.appendChild(iconElement);\n  propertyElement.appendChild(valueElement);\n\n  return {\n    element: propertyElement,\n    id: ''\n  };\n}\n\nfunction setUpLocationFieldSkeletonScreen(hash: IntegratedLocation['hash']): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n  const defaultItemQuantity: IntegratedLocation['itemQuantity'] = { g_0: Math.floor(FieldHeight / 50) + 5, g_1: Math.floor(FieldHeight / 50) + 5 };\n  const defaultGroupQuantity = 2;\n  let groupedItems: IntegratedLocation['groupedItems'] = {};\n  for (let i = 0; i < defaultGroupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    groupedItems[groupKey] = [];\n    for (let j = 0; j < defaultItemQuantity[groupKey]; j++) {\n      groupedItems[groupKey].push({\n        route_name: '',\n        route_direction: '',\n        routeId: 0,\n        stopId: 0,\n        status: {\n          code: 8,\n          text: '',\n          time: -6\n        },\n        ranking: {\n          number: 0,\n          text: '--',\n          code: -1\n        },\n        buses: [],\n        busArrivalTimes: []\n      });\n    }\n  }\n  updateLocationField(\n    {\n      groupedItems: groupedItems,\n      groupQuantity: defaultGroupQuantity,\n      groups: {\n        g_0: {\n          name: '載入中',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        },\n        g_1: {\n          name: '載入中',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        }\n      },\n      itemQuantity: defaultItemQuantity,\n      LocationName: '載入中',\n      hash: hash,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateLocationField(integration: IntegratedLocation, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationItem, previousItem: IntegratedLocationItem | null): void {\n    function updateStatus(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisItemStatusElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_status');\n      const nextSlideElement = elementQuerySelector(thisItemStatusElement, '.css_next_slide');\n      const currentSlideElement = elementQuerySelector(thisItemStatusElement, '.css_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.status.code.toString());\n      nextSlideElement.innerText = thisItem.status.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n            currentSlideElement.innerText = thisItem.status.text;\n            currentSlideElement.classList.remove('css_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n        currentSlideElement.innerText = thisItem.status.text;\n      }\n    }\n\n    function updateRank(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRankElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_rank');\n      const nextSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_next_slide');\n      const currentSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n      nextSlideElement.innerText = thisItem.ranking.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n            currentSlideElement.innerText = thisItem.ranking.text;\n            currentSlideElement.classList.remove('css_location_group_item_rank_current_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_location_group_item_rank_current_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n        currentSlideElement.innerText = thisItem.ranking.text;\n      }\n    }\n\n    function updateRouteDirection(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteDirectionElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_direction');\n      thisRouteDirectionElement.innerText = thisItem.route_direction;\n    }\n\n    function updateRouteName(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteNameElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_name');\n      thisRouteNameElement.innerText = thisItem.route_name;\n    }\n\n    function updateBuses(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buses');\n      thisBusesElement.innerHTML = thisItem.buses.length === 0 ? '<div class=\"css_location_group_item_buses_message\">目前沒有公車可顯示</div>' : thisItem.buses.map((bus) => `<div class=\"css_location_group_item_bus\" on-this-route=\"${bus.onThisRoute}\"><div class=\"css_location_group_item_bus_title\"><div class=\"css_location_group_item_bus_icon\">${getIconHTML('directions_bus')}</div><div class=\"css_location_group_item_bus_car_number\">${bus.carNumber}</div></div><div class=\"css_location_group_item_bus_attributes\"><div class=\"css_location_group_item_bus_route\">路線：${bus.RouteName}</div><div class=\"css_location_group_item_bus_car_status\">狀態：${bus.status.text}</div><div class=\"css_location_group_item_bus_car_type\">類型：${bus.type}</div></div></div>`).join('');\n    }\n\n    function updateBusArrivalTimes(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusArrivalTimesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_bus_arrival_times');\n      thisBusArrivalTimesElement.innerHTML = thisItem.busArrivalTimes.length === 0 ? '<div class=\"css_location_group_item_bus_arrival_message\">目前沒有抵達時間可顯示</div>' : thisItem.busArrivalTimes.map((busArrivalTime) => `<div class=\"css_location_group_item_bus_arrival_time\"><div class=\"css_location_group_item_bus_arrival_time_title\"><div class=\"css_location_group_item_bus_arrival_time_icon\">${getIconHTML('calendar_view_day')}</div><div class=\"css_location_group_item_bus_arrival_time_personal_schedule_name\">${busArrivalTime.personalSchedule.name}</div><div class=\"css_location_group_item_bus_arrival_time_personal_schedule_time\">週${indexToDay(busArrivalTime.day).name} ${timeObjectToString(busArrivalTime.personalSchedule.period.start)} - ${timeObjectToString(busArrivalTime.personalSchedule.period.end)}</div></div><div class=\"css_location_group_item_bus_arrival_time_chart\">${busArrivalTime.chart}</div></div>`).join('');\n    }\n\n    function updateStretch(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      if (skeletonScreen) {\n        thisElement.setAttribute('stretched', 'false');\n      }\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    function updateSaveToFolderButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const saveToFolderButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"save-to-folder\"]');\n      saveToFolderButtonElement.onclick = function () {\n        openSaveToFolder('stop-on-location', [thisItemElement.id, thisItem.stopId, thisItem.routeId]);\n      };\n      isFolderContentSaved('stop', thisItem.stopId).then((e) => {\n        saveToFolderButtonElement.setAttribute('highlighted', booleanToString(e));\n      });\n    }\n\n    function updateScheduleNotificationButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const scheduleNotificationButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"schedule-notification\"]');\n      scheduleNotificationButtonElement.onclick = function () {\n        openScheduleNotification('stop-on-location', [thisItemElement.id, thisItem.stopId, thisItem.routeId, thisItem.status.time]);\n      };\n      const havingNotifcationSchedules = stopHasNotifcationSchedules(thisItem.stopId);\n      scheduleNotificationButtonElement.setAttribute('highlighted', booleanToString(havingNotifcationSchedules));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateStatus(thisElement, thisItem, animation);\n      updateRank(thisElement, thisItem, animation);\n      updateRouteDirection(thisElement, thisItem);\n      updateRouteName(thisElement, thisItem);\n      updateBuses(thisElement, thisItem);\n      updateBusArrivalTimes(thisElement, thisItem);\n      updateStretch(thisElement, skeletonScreen);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n      updateSaveToFolderButton(thisElement, thisItem);\n      updateScheduleNotificationButton(thisElement, thisItem);\n    } else {\n      if (thisItem.status.time !== previousItem.status.time) {\n        updateStatus(thisElement, thisItem, animation);\n        updateScheduleNotificationButton(thisElement, thisItem);\n      }\n      if (previousItem.ranking.number !== thisItem.ranking.number || previousItem.ranking.code !== thisItem.ranking.code) {\n        updateRank(thisElement, thisItem, animation);\n      }\n      if (previousItem.stopId !== thisItem.stopId) {\n        updateRouteDirection(thisElement, thisItem);\n        updateRouteName(thisElement, thisItem);\n        updateSaveToFolderButton(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.buses, thisItem.buses)) {\n        updateBuses(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.busArrivalTimes, thisItem.busArrivalTimes)) {\n        updateBusArrivalTimes(thisElement, thisItem);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateStretch(thisElement, skeletonScreen);\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  function updateProperty(thisElement: HTMLElement, thisProperty: LocationGroupProperty, previousProperty: LocationGroupProperty | null): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_property_icon');\n      setIcon(thisIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      elementQuerySelector(thisElement, '.css_location_details_property_value').innerHTML = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (!compareThings(previousProperty.icon, thisProperty.icon)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty.value, thisProperty.value)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const WindowSize = querySize('window');\n  const FieldWidth = WindowSize.width;\n  const FieldHeight = WindowSize.height;\n\n  const groupQuantity = integration.groupQuantity;\n  const itemQuantity = integration.itemQuantity;\n  const groupedItems = integration.groupedItems;\n  const groups = integration.groups;\n\n  locationSliding_groupQuantity = groupQuantity;\n  locationSliding_fieldWidth = FieldWidth;\n  locationSliding_fieldHeight = FieldHeight;\n\n  let cumulativeOffset = 0;\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const width = getTextWidth(groups[groupKey].name, 500, '17px', `\"Noto Sans TC\", sans-serif`) + tabPadding;\n    locationSliding_groupStyles[groupKey] = {\n      width: width,\n      offset: cumulativeOffset\n    };\n    cumulativeOffset += width;\n  }\n  locationSliding_groupStyles[`g_${groupQuantity}`] = {\n    width: 0,\n    offset: cumulativeOffset\n  };\n\n  if (!locationSliding_sliding) {\n    const initialGroupKey = `g_${locationSliding_initialIndex}`;\n    const initialGroupStyle = locationSliding_groupStyles[initialGroupKey];\n    const offset = initialGroupStyle.offset * -1 + locationSliding_fieldWidth * 0.5 - initialGroupStyle.width * 0.5;\n    const tabLineWidth = initialGroupStyle.width - tabPadding;\n    updateLocationCSS(locationSliding_groupQuantity, offset, tabLineWidth, locationSliding_initialIndex);\n  }\n\n  if (previousIntegration?.hash !== integration.hash) {\n    LocationButtonRightElement.onclick = function () {\n      openLocationDetails(integration.hash);\n    };\n  }\n\n  if (previousIntegration?.LocationName !== integration.LocationName) {\n    LocationNameSpanElement.innerText = integration.LocationName;\n  }\n\n  if (previousAnimation !== animation) {\n    LocationNameElement.setAttribute('animation', booleanToString(animation));\n    LocationGroupTabsElement.setAttribute('animation', booleanToString(animation));\n  }\n\n  if (previousSkeletonScreen !== skeletonScreen) {\n    LocationNameElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabsElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabLineTrackElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  // TODO: updateTab\n  const currentGroupCapacity = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group').length;\n  if (groupQuantity !== currentGroupCapacity) {\n    const difference = currentGroupCapacity - groupQuantity;\n    if (difference < 0) {\n      const groupsFragment = new DocumentFragment();\n      const tabsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newGroupElement = generateElementOfGroup();\n        groupsFragment.appendChild(newGroupElement.element);\n        const newTabElement = generateElementOfTab();\n        tabsFragment.appendChild(newTabElement.element);\n      }\n      LocationGroupsElement.append(groupsFragment);\n      LocationGroupTabsTrayElement.append(tabsFragment);\n    } else {\n      const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n      const LocationGroupTabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const groupIndex = currentGroupCapacity - 1 - o;\n        LocationGroupElements[groupIndex].remove();\n        LocationGroupTabElements[groupIndex].remove();\n      }\n    }\n  }\n\n  const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisLocationGroupElement = LocationGroupElements[i];\n    const currentItemCapacity = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item').length;\n    if (itemQuantity[groupKey] !== currentItemCapacity) {\n      const difference = currentItemCapacity - itemQuantity[groupKey];\n      if (difference < 0) {\n        const LocationGroupItemsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_items');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newItemElement = generateElementOfItem();\n          LocationGroupItemsElement.appendChild(newItemElement.element);\n        }\n      } else {\n        const LocationGroupItemElements = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          LocationGroupItemElements[itemIndex].remove();\n        }\n      }\n    }\n\n    const currentGroupPropertyCapacity = elementQuerySelectorAll(elementQuerySelectorAll(LocationGroupsElement, '.css_location_group')[i], '.css_location_group_details .css_location_group_details_body .css_location_group_details_property').length;\n    const groupPropertyQuantity = groups[groupKey].properties.length;\n    if (groupPropertyQuantity !== currentGroupPropertyCapacity) {\n      const difference = currentGroupPropertyCapacity - groupPropertyQuantity;\n      if (difference < 0) {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          // var propertyIndex = currentGroupPropertyCapacity + o;\n          const newPropertyElement = generateElementOfGroupDetailsProperty();\n          thisLocationGroupDetailsBodyElement.appendChild(newPropertyElement.element);\n        }\n      } else {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        const propertyElements = elementQuerySelectorAll(thisLocationGroupDetailsBodyElement, '.css_location_group_details_property');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const propertyIndex = currentGroupPropertyCapacity - 1 - o;\n          propertyElements[propertyIndex].remove();\n        }\n      }\n    }\n  }\n\n  const tabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n  const groupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisTabElement = tabElements[i];\n    const thisTabSpanElement = elementQuerySelector(thisTabElement, 'span');\n    thisTabSpanElement.innerText = groups[groupKey].name;\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-width', `${locationSliding_groupStyles[groupKey].width}px`);\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-index', i.toString());\n    const thisGroupElement = groupElements[i];\n    const propertyElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_details .css_location_group_details_body .css_location_group_details_property`);\n    const itemElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_items .css_location_group_item`);\n\n    const groupPropertyQuantity = groups[groupKey].properties.length; // TODO: propertyQuantity\n    for (let k = 0; k < groupPropertyQuantity; k++) {\n      const thisProperty = groups[groupKey].properties[k];\n      const thisElement = propertyElements[k];\n      if (hasOwnProperty(previousIntegration, 'groups')) {\n        if (hasOwnProperty(previousIntegration.groups, groupKey)) {\n          if (previousIntegration.groups[groupKey].properties[k]) {\n            const previousProperty = previousIntegration.groups[groupKey].properties[k];\n            updateProperty(thisElement, thisProperty, previousProperty);\n          } else {\n            updateProperty(thisElement, thisProperty, null);\n          }\n        } else {\n          updateProperty(thisElement, thisProperty, null);\n        }\n      } else {\n        updateProperty(thisElement, thisProperty, null);\n      }\n    }\n\n    for (let j = 0; j < itemQuantity[groupKey]; j++) {\n      const thisElement = itemElements[j];\n      const thisItem = groupedItems[groupKey][j];\n      if (hasOwnProperty(previousIntegration, 'groupedItems')) {\n        if (hasOwnProperty(previousIntegration.groupedItems, groupKey)) {\n          if (previousIntegration.groupedItems[groupKey][j]) {\n            const previousItem = previousIntegration.groupedItems[groupKey][j];\n            updateItem(thisElement, thisItem, previousItem);\n          } else {\n            updateItem(thisElement, thisItem, null);\n          }\n        } else {\n          updateItem(thisElement, thisItem, null);\n        }\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nasync function refreshLocation() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  const busArrivalTimeChartSize = querySize('location-bus-arrival-time-chart');\n  locationRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  locationRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  locationRefreshTimer_refreshing = true;\n  locationRefreshTimer_currentRequestID = generateIdentifier();\n  LocationUpdateTimerElement.setAttribute('refreshing', 'true');\n  LocationUpdateTimerElement.classList.remove('css_location_update_timer_slide_rtl');\n  document.addEventListener(locationRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateLocation(currentHashSet_hash, busArrivalTimeChartSize.width, busArrivalTimeChartSize.height, locationRefreshTimer_currentRequestID);\n  updateLocationField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (locationRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  locationRefreshTimer_lastUpdate = new Date().getTime();\n  if (locationRefreshTimer_dynamic) {\n    locationRefreshTimer_nextUpdate = Math.max(locationRefreshTimer_lastUpdate + locationRefreshTimer_minInterval, integration.dataUpdateTime + locationRefreshTimer_baseInterval / updateRate);\n  } else {\n    locationRefreshTimer_nextUpdate = locationRefreshTimer_lastUpdate + locationRefreshTimer_baseInterval;\n  }\n  locationRefreshTimer_dynamicInterval = Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - locationRefreshTimer_lastUpdate);\n  locationRefreshTimer_refreshing = false;\n  LocationUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nexport function streamLocation(): void {\n  refreshLocation()\n    .then(function () {\n      if (locationRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamLocation();\n          },\n          Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (locationRefreshTimer_streaming) {\n        promptMessage('error', `地點網路連線中斷，將在${locationRefreshTimer_retryInterval / 1000}秒後重試。`);\n        setTimeout(function () {\n          streamLocation();\n        }, locationRefreshTimer_retryInterval);\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openLocation(hash: IntegratedLocation['hash']): void {\n  pushPageHistory('Location');\n  logRecentView('location', hash);\n  currentHashSet_hash = hash;\n  locationSliding_initialIndex = 0;\n  locationSliding_groupStyles = {};\n  LocationField.setAttribute('displayed', 'true');\n  LocationGroupsElement.scrollLeft = 0;\n  LocationGroupsElement.focus();\n  setUpLocationFieldSkeletonScreen(hash);\n  if (!locationRefreshTimer_streaming) {\n    locationRefreshTimer_streaming = true;\n    if (!locationRefreshTimer_streamStarted) {\n      locationRefreshTimer_streamStarted = true;\n      streamLocation();\n    } else {\n      refreshLocation();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeLocation(): void {\n  // revokePageHistory('Location');\n  LocationField.setAttribute('displayed', 'false');\n  locationRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport function stretchLocationItem(itemElementID: string): void {\n  const itemElement = elementQuerySelector(LocationGroupsElement, `.css_location_group .css_location_group_items .css_location_group_item#${itemElementID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n\n  const itemsElement = itemElement.parentElement as HTMLElement;\n\n  const elementsBelowItemElement = getElementsBelow(itemElement, 'css_location_group_item');\n  const elementsBelowLength = elementsBelowItemElement.length;\n\n  const itemsElementRect = itemsElement.getBoundingClientRect();\n  const itemElementRect = itemElement.getBoundingClientRect();\n\n  // const itemElementX = itemElementRect.left - itemsElementRect.left;\n  const itemElementY = itemElementRect.top - itemsElementRect.top;\n\n  const stretched = itemElement.getAttribute('stretched') === 'true' ? true : false;\n  const animation = itemElement.getAttribute('animation') === 'true' ? true : false;\n\n  if (animation) {\n    const pushDirection = stretched ? '2' : '1';\n\n    // Separate the elements from the document flow while keeping its position\n    itemElement.setAttribute('stretching', 'true');\n    // itemElement.style.setProperty('--b-cssvar-css-location-group-item-x', `${itemElementX}px`);\n    itemElement.style.setProperty('--b-cssvar-css-location-group-item-y', `${itemElementY}px`);\n\n    // Set push direction and push state\n    for (let i = 0; i < elementsBelowLength; i++) {\n      const thisItemElement = elementsBelowItemElement[i];\n      thisItemElement.setAttribute('push-direction', pushDirection);\n      thisItemElement.setAttribute('push-state', '1');\n    }\n\n    itemElement.addEventListener(\n      'transitionend',\n      function () {\n        // Reset the push direction and push state\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-direction', '0');\n          thisItemElement.setAttribute('push-state', '0');\n        }\n        // Deposit the element\n        itemElement.setAttribute('stretching', 'false');\n      },\n      { once: true }\n    );\n\n    itemElement.addEventListener(\n      'transitionstart',\n      function () {\n        // Transition the elements below\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-state', '2');\n        }\n      },\n      { once: true }\n    );\n  }\n\n  if (stretched) {\n    if (animation) {\n      itemBodyElement.addEventListener(\n        'transitionend',\n        function () {\n          itemBodyElement.setAttribute('displayed', 'false');\n        },\n        { once: true }\n      );\n    } else {\n      itemBodyElement.setAttribute('displayed', 'false');\n    }\n    itemElement.setAttribute('stretched', 'false');\n  } else {\n    itemBodyElement.setAttribute('displayed', 'true');\n    itemElement.setAttribute('stretched', 'true');\n  }\n}\n\nexport function switchLocationBodyTab(itemID: string, tabCode: number): void {\n  const itemElement = elementQuerySelector(LocationGroupsElement, `.css_location_group .css_location_group_items .css_location_group_item#${itemID}`);\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n  const buttonsElement = elementQuerySelector(itemBodyElement, '.css_location_group_item_buttons');\n  const buttonElements = elementQuerySelectorAll(buttonsElement, '.css_location_group_item_button[highlighted=\"true\"][type=\"tab\"]');\n  for (const t of buttonElements) {\n    t.setAttribute('highlighted', 'false');\n  }\n  elementQuerySelector(buttonsElement, `.css_location_group_item_button[code=\"${tabCode}\"]`).setAttribute('highlighted', 'true');\n  switch (tabCode) {\n    case 0:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      break;\n    case 1:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'true');\n      break;\n    default:\n      break;\n  }\n}\n"],"names":["previousIntegration","previousAnimation","previousSkeletonScreen","LocationDetailsField","documentQuerySelector","LocationDetailsBodyElement","elementQuerySelector","LocationDetailsActionsElement","generateElementOfItem","element","document","createElement","classList","add","icon","appendChild","getBlankIconElement","name","id","updateLocationDetailsField","integration","skeletonScreen","animation","updateItem","thisElement","thisItem","previousItem","updateIcon","thisIconElement","setIcon","updateName","innerText","updateOnclick","onclick","action","updateAnimation","setAttribute","booleanToString","updateSkeletonScreen","key","actions","actionsQuantity","currentActionsCapacity","elementQuerySelectorAll","length","difference","fragment","DocumentFragment","o","d","Math","abs","newItemElement","append","LocationActionElements","remove","i","hasOwnProperty","_initializeLocationDetailsField","_asyncToGenerator","hash","playing_animation","getSettingOptionValue","requestID","generateIdentifier","integrateLocationDetails","apply","arguments","openLocationDetails","pushPageHistory","push","setUpLocationDetailsFieldSkeletonScreen","_x","initializeLocationDetailsField","closeLocationDetails","revokePageHistory","shareLocationPermalink","_x2","_shareLocationPermalink","Location","getLocation","deleteDataReceivingProgress","deleteDataUpdateTime","thisLocationKey","thisLocation","link","getPermalink","navigator","share","title","n","url","then","promptMessage","e","showLocationPermalinkQRCode","_x3","_showLocationPermalinkQRCode","openQRCode","LocationField","LocationHeadElement","LocationNameElement","LocationNameSpanElement","LocationButtonRightElement","LocationGroupsElement","LocationGroupTabsElement","LocationGroupTabsTrayElement","LocationGroupTabLineTrackElement","LocationGroupTabLineElement","LocationUpdateTimerElement","locationSliding_initialIndex","locationSliding_targetIndex","locationSliding_groupQuantity","locationSliding_groupStyles","locationSliding_fieldWidth","locationSliding_sliding","locationRefreshTimer_baseInterval","locationRefreshTimer_minInterval","locationRefreshTimer_dynamicInterval","locationRefreshTimer_dynamic","locationRefreshTimer_lastUpdate","locationRefreshTimer_nextUpdate","locationRefreshTimer_currentRequestID","locationRefreshTimer_refreshing","locationRefreshTimer_streaming","locationRefreshTimer_streamStarted","currentHashSet_hash","initializeLocationSliding","addEventListener","round","scrollLeft","passive","event","currentIndex","target","indexDifference","delta","floor","ceil","initialSize","width","offset","targetSize","tabWidth","updateLocationCSS","groupQuantity","tabLineWidth","percentage","style","setProperty","toString","handleDataReceivingProgressUpdates","CustomEvent","offsetRatio","detail","progress","stage","removeEventListener","identifier","itemElement","headElement","rankElement","rankNextSlideElement","rankCurrentSlideElement","routeDirectionElement","routeNameElement","capsuleElement","statusElement","nextSlideElement","currentSlideElement","stretchElement","getIconElement","itemElementID","itemBodyElement","itemsElement","parentElement","elementsBelowItemElement","getElementsBelow","elementsBelowLength","itemsElementRect","getBoundingClientRect","itemElementRect","itemElementY","top","stretched","getAttribute","pushDirection","thisItemElement","once","stretchLocationItem","capsuleSeparatorElement","bodyElement","buttonsElement","busTabButtonElement","busTabIconElement","createTextNode","switchLocationBodyTab","arrivalTabButtonElement","arrivalTabIconElement","saveButtonElement","saveButtonIconElement","notifyButtonElement","notifyButtonIconElement","busesElement","busArrivalTimesElement","generateElementOfGroup","groupElement","detailsElement","detailsBodyElement","generateElementOfTab","span","generateElementOfGroupDetailsProperty","propertyElement","iconElement","valueElement","updateLocationField","_previousIntegration","_previousIntegration2","updateStatus","thisElementRect","left","bottom","right","windowWidth","window","innerWidth","windowHeight","innerHeight","thisHeadElement","thisItemStatusElement","status","code","text","updateRank","thisRankElement","ranking","updateRouteDirection","route_direction","updateRouteName","route_name","updateBuses","thisItemBodyElement","innerHTML","buses","map","bus","onThisRoute","getIconHTML","carNumber","RouteName","type","join","updateBusArrivalTimes","busArrivalTimes","busArrivalTime","personalSchedule","indexToDay","day","timeObjectToString","period","start","end","chart","updateStretch","updateSaveToFolderButton","thisItemButtonsElement","saveToFolderButtonElement","openSaveToFolder","stopId","routeId","isFolderContentSaved","updateScheduleNotificationButton","scheduleNotificationButtonElement","openScheduleNotification","time","havingNotifcationSchedules","stopHasNotifcationSchedules","number","compareThings","updateProperty","thisProperty","previousProperty","updateValue","value","WindowSize","querySize","FieldWidth","FieldHeight","height","itemQuantity","groupedItems","groups","cumulativeOffset","groupKey","getTextWidth","initialGroupStyle","LocationName","currentGroupCapacity","groupsFragment","tabsFragment","newGroupElement","newTabElement","LocationGroupElements","LocationGroupTabElements","groupIndex","thisLocationGroupElement","currentItemCapacity","LocationGroupItemsElement","LocationGroupItemElements","currentGroupPropertyCapacity","groupPropertyQuantity","properties","thisLocationGroupDetailsElement","thisLocationGroupDetailsBodyElement","newPropertyElement","propertyElements","tabElements","groupElements","thisTabElement","thisGroupElement","itemElements","k","j","refreshLocation","_refreshLocation","refresh_interval_setting","busArrivalTimeChartSize","dynamic","baseInterval","integrateLocation","updateRate","getUpdateRate","Date","getTime","max","dataUpdateTime","streamLocation","setTimeout","err","openLocation","logRecentView","focus","defaultItemQuantity","g_0","g_1","setUpLocationFieldSkeletonScreen","closePreviousPage","closeLocation","openPreviousPage","itemID","tabCode","_step","_iterator","_createForOfIteratorHelper","s","done","f"],"ignoreList":[],"sourceRoot":""}