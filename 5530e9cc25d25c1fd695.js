"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[794],{540:(e,t,n)=>{n.d(t,{F:()=>D,a:()=>J});var a=n(5767),i=n(9566),r=n(3459),s=n(8024),o=n(3648),u=n(4537),c=n(904),d=n(9119);function l(e,t,n,a,i,r,s){try{var o=e[r](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){l(r,a,i,s,o,"next",e)}function o(e){l(r,a,i,s,o,"throw",e)}s(void 0)}))}}var v=(0,o.bv)(".xf"),h=(0,o.aI)(v,".bg"),p=(0,o.aI)(v,".kg"),m=(0,o.aI)(p,".xg"),g=(0,o.aI)(h,".gg .hg"),b={},y=!1,w=!0,k=15e3,x=5e3,I=15e3,M=!0,T=0,L=0,_="",A=!1,j=!1,P=!1;function $(){var e=document.createElement("div");return e.classList.add("ch"),e.setAttribute("type","stop"),e.innerHTML=`<div class="dh"></div><div class="eh"></div><div class="fh"></div><div class="gh"><div class="jh"><div class="ia" code="0" displayed="false"></div><div class="ja" code="0" displayed="true"></div></div><div class="hh">${(0,u.Z)("keyboard_arrow_right")}</div><div class="ih"></div></div>`,{element:e,id:""}}function Z(e){var t=e;if(A){var n=t.detail.progress-1;g.style.setProperty("--_f",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,Z)}function D(){for(var e=(0,r.Js)("playing_animation"),t=(0,c.gO)("window"),n=(t.width,t.height),a=Math.floor(n/50/3)+2,i=[],s=0;s<3;s++){for(var o={name:"",icon:"",id:"",timestamp:0,content:[],contentLength:a},u=0;u<a;u++){o.content.push({type:"stop",id:0,timestamp:0,name:"",status:{code:8,text:"",time:-6},direction:0,route:{name:"",endPoints:{departure:"",destination:""},id:0,pathAttributeId:[]}})}i.push(o)}C({folders:i,dataUpdateTime:0},!0,e)}function C(e,t,n){function a(e,a,i){function r(e,t){e.setAttribute("type",t.type)}function c(e,t){var n=(0,o.aI)(e,".dh"),a="";switch(t.type){case"stop":a="location_on";break;case"route":a="route";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb";break;default:a=""}n.innerHTML=(0,u.Z)(a)}function d(e,t,n){if("stop"===t.type){var a=e.getBoundingClientRect(),i=a.top,r=a.left,s=a.bottom,u=a.right,c=window.innerWidth,d=window.innerHeight,l=(0,o.aI)(e,".gh .jh"),f=(0,o.aI)(l,".ia"),v=(0,o.aI)(l,".ja");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,n&&s>0&&i<d&&u>0&&r<c?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,v.classList.remove("_a"),f.setAttribute("displayed","false")}),{once:!0}),f.setAttribute("displayed","true"),v.classList.add("_a")):(v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text)}}function l(e,t){var n="";switch(t.type){case"stop":case"route":n=t.name;break;case"bus":n=t.busID;break;case"empty":n="沒有內容";break;default:n="null"}(0,o.aI)(e,".fh").innerText=n}function f(e,t){var n="";switch(t.type){case"stop":n=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`;break;case"route":n=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`;break;case"bus":break;case"empty":n="提示";break;default:n="null"}(0,o.aI)(e,".eh").innerText=n}function v(e,t){var n=(0,o.aI)(e,".gh .hh"),a="";switch(t.type){case"stop":a=`bus.route.openRoute(${t.route.id}, [${t.route.pathAttributeId.join(",")}])`;break;case"route":a=`bus.route.openRoute(${t.id}, [${t.pathAttributeId.join(",")}])`}n.setAttribute("onclick",a)}function h(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function p(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null===i)r(e,a),c(e,a),d(e,a,n),l(e,a),f(e,a),v(e,a),h(e,n),p(e,t);else if(a.type!==i.type)r(e,a),c(e,a),d(e,a,n),l(e,a),f(e,a),v(e,a),h(e,n),p(e,t);else{switch(a.type){case"stop":(0,s.hw)(i.route,a.route)||(f(e,a),v(e,a)),(0,s.hw)(i.name,a.name)||l(e,a),a.status.code===i.status.code&&(0,s.hw)(i.status.text,a.status.text)||d(e,a,n);break;case"route":(0,s.hw)(i.id,a.id)||v(e,a),(0,s.hw)(i.endPoints,a.endPoints)||f(e,a),(0,s.hw)(i.name,a.name)||l(e,a);break;case"bus":(0,s.hw)(i.currentRoute,a.currentRoute)||f(e,a),(0,s.hw)(i.busID,a.busID)||l(e,a);break;case"empty":a.type!==i.type&&(f(e,a),l(e,a))}t!==y&&p(e,t),n!==w&&h(e,n)}}function i(e,a,i){function r(e,t){var n=(0,o.aI)(e,".zg");(0,o.aI)(n,".ah").innerText=t.name}function c(e,t){var n=(0,o.aI)(e,".zg");(0,o.aI)(n,"._g").innerHTML=(0,u.Z)(t.icon)}function d(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function l(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}null===i?(r(e,a),c(e,a),d(e,n),l(e,t)):(a.name!==i.name&&r(e,a),a.icon!==i.icon&&c(e,a),n!==w&&d(e,n),t!==y&&l(e,t))}var r,c=e.folders,d=c.length,l=(0,o.jg)(m,".yg").length;if(d!==l){var f=l-d;if(f<0){for(var v=new DocumentFragment,h=0;h<Math.abs(f);h++){var p=(r=void 0,(r=document.createElement("div")).classList.add("yg"),r.innerHTML='<div class="zg"><div class="_g"></div><div class="ah"></div></div><div class="bh"></div>',{element:r,id:""});v.appendChild(p.element)}m.append(v)}else for(var g=(0,o.jg)(m,".yg"),k=0;k<Math.abs(f);k++){g[l-1-k].remove()}}for(var x=(0,o.jg)(m,".yg"),I=0;I<d;I++){var M=c[I].content.length,T=x[I],L=(0,o.aI)(T,".bh"),_=(0,o.jg)(L,".ch").length;if(M!==_){var A=_-M;if(A<0)for(var j=0;j<Math.abs(A);j++){var P=$();L.appendChild(P.element)}else for(var Z=(0,o.jg)(L,".ch"),D=0;D<Math.abs(A);D++){Z[_-1-D].remove()}}}for(var C=(0,o.jg)(m,".yg"),E=0;E<d;E++){var z=c[E],H=z.content,R=H.length,J=C[E],O=(0,o.aI)(J,".bh");if(b.hasOwnProperty("folders"))if(b.folders[E])i(J,z,b.folders[E]);else i(J,z,null);else i(J,z,null);for(var S=(0,o.jg)(O,".ch"),Q=0;Q<R;Q++){var U=S[Q],F=H[Q];if(b.hasOwnProperty("folders"))if(b.folders[E])if(b.folders[E].content[Q])a(U,F,b.folders[E].content[Q]);else a(U,F,null);else a(U,F,null);else a(U,F,null)}}b=e,w=n,y=t}function E(){return z.apply(this,arguments)}function z(){return(z=f((function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");M=t.dynamic,k=t.baseInterval,A=!0,_=(0,s.zx)(),g.setAttribute("refreshing","true"),g.classList.remove("jg"),document.addEventListener(_,Z);var n=yield(0,i.R_)(_);C(n,!1,e);var o=0;M&&(o=yield(0,a.wz)()),T=(new Date).getTime(),L=M?Math.max(T+x,n.dataUpdateTime+k/o):T+k,I=Math.max(x,L-T),A=!1,g.setAttribute("refreshing","false"),g.style.setProperty("--ag",`${I}ms`),g.classList.add("jg")}))).apply(this,arguments)}function H(){return R.apply(this,arguments)}function R(){return(R=f((function*(){E().then((function(){j?setTimeout((function(){H()}),Math.max(x,L-(new Date).getTime())):P=!1})).catch((function(e){j?((0,d.a)("資料夾網路連線中斷，將在10秒後重試。","error"),setTimeout((function(){H()}),1e4)):P=!1}))}))).apply(this,arguments)}function J(){D(),j||(j=!0,P?E():(P=!0,H()))}},4537:(e,t,n)=>{function a(e){return`<span class="he">${e}</span>`}n.d(t,{Z:()=>a})},6082:(e,t,n)=>{n.d(t,{X:()=>g,m:()=>l});var a=n(9734),i=n(8011),r=n(9930),s=n(4293),o=n(6788),u=n(3648);function c(e,t,n,a,i,r,s){try{var o=e[r](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,i)}var d="downloadData",l=!1,f=(0,u.bv)(".xf"),v=(0,u.aI)(f,".bg"),h=(0,u.aI)(v,".eg"),p=(0,u.aI)(h,'svg#download-svg path[progress="progress"]');function m(e){var t=e,n=189*(1-(0,o._M)(d));p.style.setProperty("--yf",`${n}px`),"end"===t.detail.stage&&(document.removeEventListener(t.detail.target,m),p.addEventListener("transitionend",(function(){h.setAttribute("complete","true")}),{once:!0}),p.style.setProperty("--yf","0px"),l=!0)}function g(){return b.apply(this,arguments)}function b(){var e;return e=function*(){(0,o.Mf)(d,"getLocation_0",0,!1),(0,o.Mf)(d,"getLocation_1",0,!1),(0,o.Mf)(d,"getCarInfo_0",0,!1),(0,o.Mf)(d,"getCarInfo_1",0,!1),(0,o.Mf)(d,"getMaterialSymbols",0,!1),document.addEventListener(d,m),yield(0,s.a)(d,!0),yield(0,i.g)(d,1),yield(0,a.j)(d,!0),yield(0,r.z)(d),(0,o.LQ)(d),(0,o.gC)(d)},b=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){c(r,a,i,s,o,"next",e)}function o(e){c(r,a,i,s,o,"throw",e)}s(void 0)}))},b.apply(this,arguments)}},6091:(e,t,n)=>{n.d(t,{Q:()=>A,u:()=>D});var a=n(5767),i=n(5314),r=n(3459),s=n(8024),o=n(3648),u=n(4537),c=n(904);function d(e,t,n,a,i,r,s){try{var o=e[r](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){d(r,a,i,s,o,"next",e)}function o(e){d(r,a,i,s,o,"throw",e)}s(void 0)}))}}var f=(0,o.bv)(".xf"),v=(0,o.aI)(f,".kg"),h=(0,o.aI)(v,".lg"),p=(0,o.aI)(h,".qg"),m={},g=!0,b=!1,y=15e3,w=5e3,k=!0,x=!1,I=0,M=0,T="",L=!1;function _(e,t,n){function a(e,a,i){function r(e,t){var n=(0,o.aI)(e,".sg .tg"),a="";switch(t.type){case"route":a="route";break;case"location":a="location_on";break;case"bus":a="directions_bus";break;case"empty":a="lightbulb"}n.innerHTML=(0,u.Z)(a)}function c(e,t){var n=(0,o.aI)(e,".sg .ug"),a="";switch(t.type){case"route":a="路線";break;case"location":a="地點";break;case"bus":a="公車";break;case"empty":a="提示"}n.innerText=a}function d(e,t){(0,o.aI)(e,".sg .vg").innerText=t.time.relative}function l(e,t){(0,o.aI)(e,".wg").innerText=t.name}function f(e,t){var n="";switch(t.type){case"route":n=`bus.route.openRoute(${t.id}, [${t.pid.join(",")}])`;break;case"location":n=`bus.location.openLocation('${t.hash}')`;break;case"bus":n=`bus.bus.openBus(${t.id})`;break;case"empty":n=""}e.setAttribute("onclick",n)}function v(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function h(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}if(null===i)r(e,a),c(e,a),d(e,a),l(e,a),f(e,a),v(e,n),h(e,t);else if(a.type!==i.type)r(e,a),c(e,a),d(e,a),l(e,a),f(e,a),v(e,n),h(e,t);else{switch(a.type){case"location":(0,s.hw)(i.name,a.name)||l(e,a),i.time!==a.time&&d(e,a),(0,s.hw)(i.hash,a.hash)||f(e,a);break;case"route":(0,s.hw)(i.name,a.name)||l(e,a),i.time!==a.time&&d(e,a),(0,s.hw)(i.id,a.id)&&(0,s.hw)(i.pid,a.pid)||f(e,a);break;case"bus":(0,s.hw)(i.name,a.name)||l(e,a),i.time!==a.time&&d(e,a),(0,s.hw)(i.id,a.id)||f(e,a);break;case"empty":i.time!==a.time&&d(e,a)}n!==g&&v(e,n),t!==b&&h(e,t)}}var i,r=e.itemQuantity,c=(0,o.jg)(p,".rg").length;if(r!==c){var d=c-r;if(d<0){for(var l=new DocumentFragment,f=0;f<Math.abs(d);f++){var v=(i=void 0,(i=document.createElement("div")).classList.add("rg"),i.innerHTML='<div class="sg"><div class="tg"></div><div class="ug"></div><div class="vg"></div></div><div class="wg"></div>',{element:i,id:""});l.appendChild(v.element)}p.append(l)}else for(var h=(0,o.jg)(p,".rg"),y=0;y<Math.abs(d);y++){h[c-1-y].remove()}}for(var w=(0,o.jg)(p,".rg"),k=0;k<r;k++){var x=w[k],I=e.items[k];if(m.hasOwnProperty("items"))if(m.items[k])a(x,I,m.items[k]);else a(x,I,null);else a(x,I,null)}m=e,g=n,b=t}function A(){for(var e=(0,r.Js)("playing_animation"),t=(0,c.gO)("window"),n=Math.floor(t.height/70/3)+2,a=[],i=0;i<n;i++)a.push({type:"route",id:0,pid:[],time:{absolute:0,relative:""},name:""});_({items:a,itemQuantity:a.length,dataUpdateTime:0},!0,e)}function j(){return P.apply(this,arguments)}function P(){return(P=l((function*(){var e=(0,r.Js)("playing_animation"),t=(0,r.Js)("refresh_interval");k=t.dynamic,y=t.baseInterval,T=(0,s.zx)();var n=yield(0,i.$i)(T);_(n,!1,e);var o=0;k&&(o=yield(0,a.wz)()),I=(new Date).getTime(),M=k?Math.max(I+w,n.dataUpdateTime+y/o):I+y,Math.max(w,M-I)}))).apply(this,arguments)}function $(){return Z.apply(this,arguments)}function Z(){return(Z=l((function*(){j().then((function(){x?setTimeout((function(){$()}),Math.max(w,M-(new Date).getTime())):L=!1})).catch((function(e){x?setTimeout((function(){$()}),1e4):L=!1}))}))).apply(this,arguments)}function D(){A(),x||(x=!0,L?j():(L=!0,$()))}}}]);
//# sourceMappingURL=5530e9cc25d25c1fd695.js.map