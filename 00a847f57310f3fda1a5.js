"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[155],{928(){},1077(){},1818(){},1844(){},2239(){},2994(t,e,n){n.d(e,{G:()=>b,Q:()=>g});var a=n(467),r=n(4225),i=n(3459),o=n(8179),c=n(8024),u=n(8194),l=[],d=!1,s=!1,f=(0,o.bv)(".sq"),p=(0,o.aI)(f,".wq"),v=(0,o.aI)(p,".xq");function h(){var t=document.createElement("div");t.classList.add("yq");var e=document.createElement("div");e.classList.add("zq");var n=document.createElement("div");return n.classList.add("_q"),t.appendChild(e),t.appendChild(n),t}function m(t,e,n){function a(t,a,r){function i(t,e){(0,o.aI)(t,"._q").innerText=e.size}function u(t,e){(0,o.aI)(t,".zq").innerText=e.category.name}function l(t,e){t.setAttribute("animation",(0,c.xZ)(e))}function f(t,e){t.setAttribute("skeleton-screen",(0,c.xZ)(e))}r?(a.category.key!==r.category.key&&(u(t,a),i(t,a)),a.size!==r.size&&i(t,a),d!==n&&l(t,n),s!==e&&f(t,e)):(i(t,a),u(t,a),l(t,n),f(t,e))}var r=[];for(var i in t.categorizedSizes){var u=t.categorizedSizes[i];r.push(u)}var f=r.length,p=(0,o.jg)(v,".yq").length;if(f!==p){var m=p-f;if(m<0){for(var y=new DocumentFragment,b=0,g=Math.abs(m);b<g;b++){var w=h();y.appendChild(w)}v.appendChild(y)}else for(var _=(0,o.jg)(v,".yq"),A=0,C=Math.abs(m);A<C;A++){_[p-1-A].remove()}}for(var k=(0,o.jg)(v,".yq"),q=0;q<f;q++){var x=l[q],E=r[q],S=k[q];a(S,E,x||null)}l=r,s=e,d=n}function y(){return(y=(0,a.A)(function*(){var t=(0,i.Js)("playing_animation");!function(){for(var t=(0,i.Js)("playing_animation"),e=Math.min(7,Math.floor((0,u.YC)("window")[1]/55)+2),n={categorizedSizes:{},totalSize:0},a=0;a<e;a++){var r=`store-${a}`;n.categorizedSizes[r]={category:{name:"",key:r},size:`size-${a}`}}m(n,!0,t)}(),m(yield(0,r.F)(),!1,t)})).apply(this,arguments)}function b(){f.setAttribute("displayed","true"),function(){y.apply(this,arguments)}()}function g(){f.setAttribute("displayed","false")}},3381(){},3425(){},4800(){},5009(t,e,n){n.d(e,{Bb:()=>lt,H2:()=>ct,RC:()=>ot,gn:()=>nt,ld:()=>at,rf:()=>ut});var a=n(8134),r=n(8179),i=n(7968),o=n(8024),c=n(6141),u=n(4781),l=n(4884),d=n(6082),s=n(4537),f=n(904),p=n(3030),v=n(9119),h=n(4690),m=n(8194);function y(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return b(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("E0")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var g=[],w=(0,r.bv)(".o"),_=(0,r.aI)(w,".p"),A=(0,r.aI)(w,".mp"),C=(0,r.aI)(_,".q #search_input"),k=(0,r.aI)(_,".q canvas"),q=(0,r.aI)(_,".lp"),x=(0,r.aI)(A,".np"),E=(0,r.aI)(A,".rp"),S=k.getContext("2d"),I=window.devicePixelRatio,L=15*I,M=1.8*I,T=.9*I,z=4*I,$=25*I,j=20*I,R=[["紅","藍","1","2","3"],["綠","棕","4","5","6"],["橘","小","7","8","9"],["鍵盤","幹線","清空","0","刪除"]],Y=(0,c.t)("--a"),D=(0,c.t)("--wa"),F=(0,c.t)("--b"),H=0,O=0,P=0,U=!1,W=0,Z=(0,m.YC)("head_two_button"),B=Z[0]*I,G=Z[1]*I,J=!1,N=!1;function Q(){var t=et(),e=t.substring(0,t.length-1);C.value=e,ot(),nt(-1,-1),(0,f.p9)()}function V(){C.value="",ot(),nt(-1,-1),(0,f.p9)()}function K(t){t.preventDefault(),C.focus(),(0,f.p9)()}function X(){!function(){if(!N){N=!0;var t,e=new DocumentFragment,n=y(R);try{for(n.s();!(t=n.n()).done;){var a,r=y(t.value);try{for(r.s();!(a=r.n()).done;){var i=a.value,c=document.createElement("button");c.classList.add("sp");var u=(0,o.p1)()?"touchstart":"mousedown";switch(i){case"刪除":c.addEventListener(u,Q),c.appendChild((0,s.YC)("backspace"));break;case"清空":c.addEventListener(u,V),c.innerText=i;break;case"鍵盤":c.addEventListener(u,K),c.appendChild((0,s.YC)("keyboard"));break;default:c.addEventListener(u,function(t){return function(){var e,n;e=t,n=`${et()}${e}`,C.value=n,ot(),nt(-1,-1),(0,f.p9)()}}(i)),c.innerText=i}e.appendChild(c)}}catch(t){r.e(t)}finally{r.f()}}}catch(t){n.e(t)}finally{n.f()}E.append(e)}}(),E.setAttribute("displayed","true"),J=!0,rt(),nt(-1,-1)}function tt(){return parseInt(q.getAttribute("type"))}function et(){return String(C.value)}function nt(t,e){var n=et(),a=!1;0===n.length?(n="搜尋路線、地點、公車",a=!0,t=0,e=0):-1===t&&-1===e&&(e=1*(t=n.length)),Z=(0,m.YC)("head_two_button"),B=Z[0]*I,G=Z[1]*I,Y=(0,c.t)("--a"),D=(0,c.t)("--wa"),F=(0,c.t)("--b"),S.font=`400 ${j}px "Noto Sans TC", sans-serif`,S.textAlign="center",S.textBaseline="middle",H=S.measureText(n).width,O=S.measureText(n.substring(0,t)).width,P=S.measureText(n.substring(t,e)).width,W=a?1:Math.max(1,O),S.clearRect(0,0,B,G),t===e?(U=!0,S.globalAlpha=1,S.fillStyle=a?D:Y,S.fillText(n,H/2+(Math.min(W,B-L)-W),G/2),(0,i.wg)(S,Math.min(W,B-L),(G-$)/2,M,$,T,F)):(U=!1,S.globalAlpha=.27,(0,i.wg)(S,Math.min(W,B-L),(G-$)/2,P,$,z,F),S.globalAlpha=1,S.fillStyle=a?D:Y,S.fillText(n,H/2+(Math.min(W,B-L)-W),G/2),S.globalAlpha=.08,(0,i.wg)(S,Math.min(W,B-L),(G-$)/2,P,$,z,F))}function at(){Z=(0,m.YC)("head_two_button"),B=Z[0]*I,G=Z[1]*I,k.width=B,k.height=G,nt(-1,-1)}function rt(){var t=performance.now(),e=1-Math.pow(Math.sin(Math.PI*t/960),4);U&&(S.globalAlpha=e,S.clearRect(Math.min(W,B-L)-1,0,M+2,G),(0,i.wg)(S,Math.min(W,B-L),(G-$)/2,M,$,T,F)),J&&window.requestAnimationFrame(rt)}function it(){var t=document.createElement("div");t.classList.add("op");var e=document.createElement("div");e.classList.add("qp");var n=document.createElement("div");return n.classList.add("pp"),n.appendChild((0,s.oC)()),t.appendChild(n),t.appendChild(e),t}function ot(){var t=["route","location_on","directions_bus"];function e(e,n,a){function i(e,n){var a=(0,r.aI)(n,".pp");(0,s.yD)(a,t[e.item.type])}function o(t,e){(0,r.aI)(e,".qp").innerText=t.item.n}function c(t,e){switch(t.item.type){case 0:e.onclick=function(){(0,h.SR)(t.item.id,t.item.pid)};break;case 1:e.onclick=function(){(0,p.so)(t.item.hash)};break;case 2:e.onclick=function(){(0,l.$l)(t.item.id)}}}a?(n.item.type!==a.item.type&&i(n,e),n.item.id!==a.item.id&&(o(n,e),c(n,e))):(i(n,e),o(n,e),c(n,e))}var n=tt(),i=et();if(!(0,u.iO)(i)){var o=(0,a.GU)(i,n,30),c=o.length,d=(0,r.jg)(x,".op").length;if(c!==d){var f=d-c;if(f<0){for(var v=new DocumentFragment,m=0,y=Math.abs(f);m<y;m++){var b=it();v.appendChild(b)}x.appendChild(v)}else for(var w=(0,r.jg)(x,".op"),_=0,A=Math.abs(f);_<A;_++){w[d-1-_].remove()}}for(var C=(0,r.jg)(x,".op"),k=0;k<c;k++){var q=g[k],E=o[k],S=C[k];e(S,E,q||null)}g=o}}function ct(){var t=tt(),e=-1;e=t>=-1&&t<2?t+1:-1;(0,s.yD)(q,["filter_list","route","location_on","directions_bus"][e+1]),q.setAttribute("type",e.toString()),ot()}function ut(){d.m?((0,f.WR)("Search"),w.setAttribute("displayed","true"),X(),(0,a.dD)()):(0,v.a)("download_for_offline","資料還在下載中")}function lt(){(0,f.kr)("Search"),E.setAttribute("displayed","false"),J=!1,w.setAttribute("displayed","false")}},6104(t,e,n){n.d(e,{Ow:()=>_,gE:()=>x,jk:()=>S,os:()=>A,rY:()=>q,vv:()=>C,ze:()=>E});var a=n(467),r=n(5976),i=n(5427),o=n(3459),c=n(3251),u=n(4311),l=n(8179),d=n(8024),s=n(4537),f=n(904),p=n(9119);function v(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("E0")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var m=(0,l.bv)(".tp"),y=(0,l.aI)(m,".cq"),b=(0,l.aI)(y,".eq");function g(t){var e=document.createElement("div");e.classList.add("gq"),e.setAttribute("type",t.type);var n=document.createElement("div");n.classList.add("iq");var a=document.createElement("span");a.appendChild((0,s.YC)(t.icon)),n.appendChild(a);var r=document.createElement("div");r.classList.add("jq"),r.innerText=t.name;var i=document.createElement("div");i.classList.add("lq"),i.innerText=t.status;var o=document.createElement("div");o.classList.add("mq");var c=document.createElement("span");return c.appendChild((0,s.YC)("arrow_forward_ios")),o.appendChild(c),"function"==typeof t.action?e.onclick=function(){t.action()}:"string"==typeof t.action&&e.setAttribute("onclick",t.action),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),e}function w(){return(w=(0,a.A)(function*(){var t=yield(0,o.cl)();b.innerHTML="";var e,n=new DocumentFragment,a=v(t);try{for(a.s();!(e=a.n()).done;){var r=g(e.value);n.appendChild(r)}}catch(t){a.e(t)}finally{a.f()}b.append(n)})).apply(this,arguments)}function _(){(0,f.WR)("Settings"),m.setAttribute("displayed","true"),function(){w.apply(this,arguments)}()}function A(){(0,f.kr)("Settings"),m.setAttribute("displayed","false")}function C(){return k.apply(this,arguments)}function k(){return(k=(0,a.A)(function*(){(0,p.a)("manufacturing","資料匯出中");var t=yield(0,r.R)();(0,d.MR)(t,"application/json","bus-export.json")})).apply(this,arguments)}function q(){var t=(0,d.zx)(),e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","application/json"),e.setAttribute("name",t),e.id=t,e.classList.add("rq"),e.addEventListener("change",function(e){if(0===e.target.files.length)(0,l.bv)(`body #${t}`).remove();else{var n=e.target.files[0],a=new FileReader;a.onload=function(e){var n=e.target.result;(0,i.Qx)(n).then(function(e){e?(0,p.a)("check_circle","已匯入資料"):(0,p.a)("error","無法匯入資料"),(0,l.bv)(`body #${t}`).remove()})},a.readAsText(n)}},{once:!0}),e.addEventListener("cancel",function(){(0,l.bv)(`body #${t}`).remove()},{once:!0}),document.body.append(e),(0,l.bv)(`body #${t}`).click()}function x(){var t=(0,c._P)();window.open(t)}function E(){window.open("https://github.com/EricHsia7/bus")}function S(){(0,u.VC)().then(function(t){switch(t){case"granted":(0,p.a)("check_circle","已開啟永久儲存");break;case"denied":(0,p.a)("cancel","永久儲存權限已被拒絕");break;case"unsupported":(0,p.a)("warning","此瀏覽器不支援永久儲存");break;default:(0,p.a)("error","發生錯誤")}})}},6166(t,e,n){n.d(e,{wx:()=>m,yH:()=>h});var a=n(3459),r=n(8179),i=n(904);function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return c(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("E0")}var i,o=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){u=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var u=(0,r.bv)(".up"),l=(0,r.aI)(u,".dq"),d=(0,r.aI)(l,".fq"),s=(0,r.aI)(l,".qq"),f=(0,r.aI)(u,".wp"),p=(0,r.aI)(f,".bq");function v(t,e,n){var i=document.createElement("div");i.classList.add("hq");var c=document.createElement("div");c.classList.add("kq"),c.innerText=e.name;var u=document.createElement("div");u.classList.add("nq");var l=document.createElement("input");return l.type="checkbox",l.checked=t.option===n,l.onclick=function(e){!function(t,e,n){var i,c=o((0,r.e0)('.up .dq .fq .hq .nq input[type="checkbox"]'));try{for(c.s();!(i=c.n()).done;){i.value.checked=!1}}catch(t){c.e(t)}finally{c.f()}var u=t.target;u.checked=!0,(0,a.aN)(e,n)}(e,t.key,n)},u.appendChild(l),i.appendChild(c),i.appendChild(u),i}function h(t){(0,i.WR)("SettingsOptions"),u.setAttribute("displayed","true"),function(t){var e=(0,a.PL)(t);p.innerText=e.name,s.innerText=e.description,d.innerHTML="";var n,r=new DocumentFragment,i=0,c=o(e.options);try{for(c.s();!(n=c.n()).done;){var u=v(e,n.value,i);r.appendChild(u),i+=1}}catch(t){c.e(t)}finally{c.f()}d.append(r)}(t),(0,i.Z_)()}function m(){u.setAttribute("displayed","false"),(0,i.l$)()}},6171(){},7037(){},7113(){},8073(){},8194(t,e,n){n.d(e,{YC:()=>r,u$:()=>i});var a={window:[0,0],head:[0,0],head_one_button:[0,0],head_two_button:[0,0],route_details_canvas:[0,0],route_bus_arrival_time_chart:[0,0],location_bus_arrival_time_chart:[0,0]};function r(t){return a[t]}function i(){var t=window.innerWidth,e=window.innerHeight;a.window=[t,e],a.head=[t,55],a.head_one_button=[t-55,55],a.head_two_button=[t-110,55],a.route_details_canvas=[t-20-20,1680],a.route_bus_arrival_time_chart=[t-45-15-20,75],a.location_bus_arrival_time_chart=[t-30-20,75]}},9205(){},9351(){},9590(){}}]);
//# sourceMappingURL=00a847f57310f3fda1a5.js.map