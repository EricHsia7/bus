!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("bus",[],r):"object"==typeof exports?exports.bus=r():t.bus=r()}(self,()=>(()=>{"use strict";var t={};function r(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a,i,s=[],l=!0,f=!1;try{if(a=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(s.push(n.value),s.length!==r);l=!0);}catch(t){f=!0,o=t}finally{try{if(!l&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(f)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return o(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){l=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(l)throw i}}}}function o(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}var a=[],i=!1;if("onconnect"in self)self.onconnect=function(t){var r=t.ports[0];r.onmessage=function(t){var n=e(t.data,5),o=n[0],i=n[1],s=n[2],l=n[3],f=n[4];a.push({personalSchedules:o,busArrivalTimeDataGroups:i,chartWidth:s,chartHeight:l,taskID:f,port:r}),p()}};else{var s=self;self.onmessage=function(t){var r=e(t.data,5),n=r[0],o=r[1],i=r[2],l=r[3],f=r[4];a.push({personalSchedules:n,busArrivalTimeDataGroups:o,chartWidth:i,chartHeight:l,taskID:f,port:s}),p()}}var l,f,u=400,c=10,d="'Noto Sans TC', sans-serif",h=!1;function p(){if(!i&&0!==a.length){i=!0;var t,r=a.shift(),e=r.personalSchedules,o=r.busArrivalTimeDataGroups,s=r.chartWidth,l=r.chartHeight,v=r.taskID,y=r.port,m={},$=n(e);try{for($.s();!(t=$.n()).done;){var g,b=t.value,w=60*b.period.start.hours+b.period.start.minutes,S=60*b.period.end.hours+b.period.end.minutes,x=s/(S-w),A=n(o);try{for(A.s();!(g=A.n()).done;){var j=g.value;if(!(b.days.indexOf(j.day)<0)){var I=j.max,O=j.stats.slice(w,S),k=O.length,D="",M="",T=0;T=k/30<=3?10:30;for(var C=Math.floor(k/T),L=s/C,B=C-1;B>=0;B--){var G=.175+B*L;M+=` M${G} 0`,M+=` L${G} ${l}`;var H=w+B*T,W=H%60,E=`${((H-W)/60).toString().padStart(2,"0")}:${W.toString().padStart(2,"0")}`,U=30,z=12;if(h){var N=f.measureText(E);U=N.width,z=N.actualBoundingBoxDescent}var P=(l-z)/2;D+=`<text x="${G+3}" y="${P}" transform="rotate(-90 ${(G+3+G+3+U)/2} ${(P+P+z)/2})" font-weight="${u}" font-size="${c}" font-family="${d}" component="label">${E}</text>`}var Z=`<path d="${M}" fill="none" stroke-width="0.35" component="vertical-gridline"/>`,_=`<path d="${`M0 ${l} L${s} ${l-.175}`}" fill="none" stroke-width="0.35" component="bottom-line"/>`,q="";if(q+=`M${s} ${l}`,0!==I)for(var F=k-1;F>=0;F--){var J=(F+1)/k*s,K=(1-O[F]/I)*l;q+=` L${J} ${K}`,q+=` L${J-x} ${K}`,q+=` L${J-x} ${l}`}var Q=`<svg width="${s}" height="${l}" viewBox="0 0 ${s} ${l}" xmlns="http://www.w3.org/2000/svg">${Z}${D}${_}${`<path d="${q+=" Z"}" stroke="none" stroke-width="0" component="bars"/>`}</svg>`,R=`s_${j.id}`;m.hasOwnProperty(R)||(m[R]=[]),m[R].push({personalSchedule:b,chart:Q,day:j.day})}}}catch(t){A.e(t)}finally{A.f()}}}catch(t){$.e(t)}finally{$.f()}y.postMessage([m,v]),i=!1,p()}}return"undefined"!=typeof OffscreenCanvas&&(l=new OffscreenCanvas(64,64),(f=l.getContext("2d")).font=`${u} ${c}px ${d}`,f.textBaseline="top",h=!0),t=t.default})());
//# sourceMappingURL=3113.1cb7bc5b.js.map