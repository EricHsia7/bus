"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[474],{4690(t,e,a){a.d(e,{Ch:()=>mt,S5:()=>tt,SR:()=>vt,U7:()=>ht});var i=a(467),n=a(5767),s=a(9566),d=a(3422),r=a(5314),o=a(7123),l=a(3459),u=a(8179),c=a(7968),p=a(8024),v=a(5579),h=a(4537),m=a(904),b=a(9119),f=a(3041),g=a(752),A=a(5286);function y(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return C(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?C(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("E0")}var s,d=!0,r=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return d=t.done,t},e:function(t){r=!0,s=t},f:function(){try{d||null==a.return||a.return()}finally{if(r)throw s}}}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}var L=(0,u.bv)(".ba"),I=(0,u.aI)(L,".dn"),E=(0,u.aI)(I,".gn"),x=(0,u.aI)(E,"span"),w=(0,u.aI)(I,".fn"),R=(0,u.aI)(I,".nn .on"),T=(0,u.aI)(I,".hn"),_=(0,u.aI)(T,".in"),k=(0,u.aI)(I,".ln"),$=(0,u.aI)(k,".mn"),S=(0,u.aI)(L,".ca"),P={},Z=!1,j=!1,M=0,D=0,z=0,B={},N=0,q=!1,Y=15e3,F=5e3,H=15e3,Q=!0,O=0,U=0,J="",W=!1,G=!1,K=!1,X=0,V=[];function tt(){S.addEventListener("touchstart",function(){M=Math.round(S.scrollLeft/N)},{passive:!0}),S.addEventListener("scroll",function(t){q=!0;var e=t.target.scrollLeft/N;D=e>M?M+1:M-1;var a=e-M,i=Math.abs(a);i>1&&(a>0?(M=Math.floor(e),D=M+1):(M=Math.ceil(e),D=M-1),i=Math.abs(e-M));var n=B[`g_${M}`]||{width:0,offset:0},s=B[`g_${D}`]||{width:0,offset:0},d=n.width+(s.width-n.width)*i,r=-1*(n.offset+(s.offset-n.offset)*i)+.5*N-.5*d;et(z,r,d-20,e),e===D&&(M=Math.round(S.scrollLeft/N),q=!1)},{passive:!0})}function et(t,e,a,i){S.style.setProperty("--xm",t.toString()),$.style.setProperty("--_m",a.toString()),_.style.setProperty("--jn",`${e.toString()}px`),_.style.setProperty("--ym",i.toString())}function at(t){var e=t;if(W){var a=e.detail.progress-1;R.style.setProperty("--bn",a.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,at)}function it(){var t=(0,p.zx)(),e=document.createElement("div");e.classList.add("rn"),e.id=t,e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var a=document.createElement("div");a.classList.add("sn");var i=document.createElement("div");i.classList.add("bo"),i.setAttribute("displayed","false"),a.appendChild(i);var n=document.createElement("div");n.classList.add("tn");var s=document.createElement("div");s.classList.add("_a"),s.setAttribute("code","0"),s.setAttribute("displayed","false"),n.appendChild(s);var d=document.createElement("div");return d.classList.add("ab"),d.setAttribute("code","0"),d.setAttribute("displayed","true"),n.appendChild(d),e.appendChild(a),e.appendChild(n),{element:e,id:t}}function nt(t){var e=(0,p.zx)(),a=document.createElement("div");a.classList.add("ha"),a.id=e,a.setAttribute("stretched","false"),a.setAttribute("stretching","false"),a.setAttribute("push-direction","0"),a.setAttribute("push-state","0");var i=document.createElement("div");i.classList.add("na");var n=document.createElement("div");n.classList.add("oa"),i.appendChild(n);var s=document.createElement("div");s.classList.add("qa");var d=document.createElement("div");d.classList.add("za");var r=document.createElement("div");r.classList.add("_a"),r.setAttribute("code","0"),r.setAttribute("displayed","false"),d.appendChild(r);var o=document.createElement("div");o.classList.add("ab"),o.setAttribute("code","0"),o.setAttribute("displayed","true"),d.appendChild(o),s.appendChild(d);var l=document.createElement("div");l.classList.add("xa"),l.appendChild((0,h.YC)("keyboard_arrow_down")),l.onclick=function(){!function(t,e){var a=(0,u.aI)(t,".lb"),i=t.parentElement,n=e.parentElement,s=(0,u.ji)(e,"rn"),d=(0,u.ji)(t,"ha"),r=d.length,o=i.getBoundingClientRect(),l=t.getBoundingClientRect(),c=n.getBoundingClientRect(),p=e.getBoundingClientRect(),v=p.top-c.top,h=l.top-o.top,m="true"===t.getAttribute("stretched"),b="true"===t.getAttribute("animation");if(b){var f=m?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--go",`${v}px`),t.setAttribute("stretching","true"),t.style.setProperty("--aa",`${h}px`);for(var g=0;g<r;g++){var A=d[g],y=s[g];y.style.setProperty("--ho",(-1*g-1).toString()),y.setAttribute("push-direction",f),y.setAttribute("push-state","1"),A.setAttribute("push-direction",f),A.setAttribute("push-state","1")}t.addEventListener("transitionend",function(){for(var a=0;a<r;a++){var i=d[a],n=s[a];n.setAttribute("push-direction","0"),n.setAttribute("push-state","0"),i.setAttribute("push-direction","0"),i.setAttribute("push-state","0")}e.setAttribute("stretching","false"),t.setAttribute("stretching","false")},{once:!0}),t.addEventListener("transitionstart",function(){for(var t=0;t<r;t++){var e=d[t];s[t].setAttribute("push-state","2"),e.setAttribute("push-state","2")}},{once:!0})}m?(b?a.addEventListener("transitionend",function(){a.setAttribute("displayed","false")},{once:!0}):a.setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false")):(a.setAttribute("displayed","true"),t.setAttribute("stretched","true"),e.setAttribute("stretched","true"))}(a,t)},s.appendChild(l);var c=document.createElement("div");c.classList.add("va"),s.appendChild(c),i.appendChild(s);var v=document.createElement("div");v.classList.add("lb"),v.setAttribute("displayed","false");var m=document.createElement("div");m.classList.add("mb");var b=document.createElement("div");b.classList.add("nb"),b.setAttribute("highlighted","true"),b.setAttribute("type","tab"),b.setAttribute("code","0"),b.onclick=function(){bt(e,0)};var f=document.createElement("div");f.classList.add("wb"),f.appendChild((0,h.YC)("directions_bus")),b.appendChild(f),b.appendChild(document.createTextNode("公車")),m.appendChild(b);var g=document.createElement("div");g.classList.add("nb"),g.setAttribute("highlighted","false"),g.setAttribute("type","tab"),g.setAttribute("code","1"),g.onclick=function(){bt(e,1)};var A=document.createElement("div");A.classList.add("wb"),A.appendChild((0,h.YC)("departure_board")),g.appendChild(A),g.appendChild(document.createTextNode("抵達時間")),m.appendChild(g);var y=document.createElement("div");y.classList.add("nb"),y.setAttribute("highlighted","false"),y.setAttribute("type","tab"),y.setAttribute("code","2"),y.onclick=function(){bt(e,2)};var C=document.createElement("div");C.classList.add("wb"),C.appendChild((0,h.YC)("route")),y.appendChild(C),y.appendChild(document.createTextNode("路線")),m.appendChild(y);var L=document.createElement("div");L.classList.add("nb"),L.setAttribute("highlighted","false"),L.setAttribute("type","tab"),L.setAttribute("code","3"),L.onclick=function(){bt(e,3)};var I=document.createElement("div");I.classList.add("wb"),I.appendChild((0,h.YC)("location_on")),L.appendChild(I),L.appendChild(document.createTextNode("地點")),m.appendChild(L);var E=document.createElement("div");E.classList.add("nb"),E.setAttribute("highlighted","false"),E.setAttribute("type","save-to-folder");var x=document.createElement("div");x.classList.add("wb"),x.appendChild((0,h.YC)("folder")),E.appendChild(x),E.appendChild(document.createTextNode("儲存")),m.appendChild(E);var w=document.createElement("div");w.classList.add("nb"),w.setAttribute("highlighted","false"),w.setAttribute("type","schedule-notification"),w.setAttribute("enabled","true");var R=document.createElement("div");R.classList.add("wb"),R.appendChild((0,h.YC)("notifications")),w.appendChild(R),w.appendChild(document.createTextNode("通知")),m.appendChild(w),v.appendChild(m);var T=document.createElement("div");T.classList.add("yb"),T.setAttribute("displayed","true"),v.appendChild(T);var _=document.createElement("div");_.classList.add("zb"),_.setAttribute("displayed","false"),v.appendChild(_);var k=document.createElement("div");k.classList.add("_b"),k.setAttribute("displayed","false"),v.appendChild(k);var $=document.createElement("div");return $.classList.add("ac"),$.setAttribute("displayed","false"),v.appendChild($),a.appendChild(i),a.appendChild(v),{element:a,id:e}}function st(){var t=document.createElement("div");t.classList.add("da");var e=document.createElement("div");e.classList.add("ea");var a=document.createElement("div");a.classList.add("qn");var i=document.createElement("div");i.classList.add("co");var n=document.createElement("div");n.classList.add("fa");var s=document.createElement("div");return s.classList.add("ga"),n.appendChild(s),a.appendChild(i),e.appendChild(a),e.appendChild(n),t.appendChild(e),{element:t,id:""}}function dt(){var t=document.createElement("div");return t.classList.add("kn"),{element:t,id:""}}function rt(){var t=document.createElement("div");t.classList.add("bc"),t.setAttribute("on-this-route","false");var e=document.createElement("div");e.classList.add("sc");var a=document.createElement("div");a.classList.add("wc"),a.appendChild((0,h.YC)("directions_bus"));var i=document.createElement("div");i.classList.add("_c");var n=document.createElement("div");n.classList.add("fd");var s=document.createElement("div");s.classList.add("hd");var d=document.createElement("div");d.classList.add("id");var r=document.createElement("div");return r.classList.add("jd"),e.appendChild(a),e.appendChild(i),t.appendChild(e),n.appendChild(s),n.appendChild(d),n.appendChild(r),t.appendChild(n),{element:t,id:""}}function ot(){var t=document.createElement("div");t.classList.add("cc");var e=document.createElement("div");e.classList.add("tc");var a=document.createElement("div");a.classList.add("xc"),a.appendChild((0,h.YC)("route"));var i=document.createElement("div");i.classList.add("ad");var n=document.createElement("div");n.classList.add("kd");var s=document.createElement("div");s.classList.add("nd");var d=document.createElement("div");d.classList.add("pd"),d.setAttribute("type","view-route"),d.innerText="查看路線";var r=document.createElement("div");return r.classList.add("pd"),r.setAttribute("type","save-to-folder"),r.setAttribute("highlighted","false"),r.innerText="儲存路線",e.appendChild(a),e.appendChild(i),t.appendChild(e),t.appendChild(n),s.appendChild(d),s.appendChild(r),t.appendChild(s),{element:t,id:""}}function lt(t,e,a){var i,n;function r(e,a,i,n,r,o){function l(t,e,a,i,n){var s=(0,u.aI)(e,".tn"),d=(0,u.aI)(s,".ab"),r=(0,u.aI)(s,"._a"),o=(0,u.aI)(t,".za"),l=(0,u.aI)(o,".ab"),c=(0,u.aI)(o,"._a");if(r.setAttribute("code",a.status.code.toString()),c.setAttribute("code",a.status.code.toString()),c.innerText=a.status.text,!i&&n){var p=t.getBoundingClientRect(),v=p.top,h=p.left,m=p.bottom,b=p.right,f=window.innerWidth,g=window.innerHeight;if(m>0&&v<g&&b>0&&h<f)return d.addEventListener("animationend",function(){d.setAttribute("code",a.status.code.toString()),d.classList.remove("kb"),r.setAttribute("displayed","false")},{once:!0}),l.addEventListener("animationend",function(){l.setAttribute("code",a.status.code.toString()),l.innerText=a.status.text,l.classList.remove("kb"),c.setAttribute("displayed","false")},{once:!0}),c.setAttribute("displayed","true"),r.setAttribute("displayed","true"),d.classList.add("kb"),void l.classList.add("kb")}d.setAttribute("code",a.status.code.toString()),l.setAttribute("code",a.status.code.toString()),l.innerText=a.status.text}function c(t,e,a){t.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer)),e.setAttribute("segment-buffer",(0,p.xZ)(a.segmentBuffer.isSegmentBuffer))}function m(t,e){(0,u.aI)(t,".oa").innerText=e.name}function b(t,e){var a=(0,u.aI)(t,".yb"),i=(0,u.jg)(a,".bc"),n=i.length,s=e.buses.length,d=n-s;if(d<0){for(var r=new DocumentFragment,o=0,l=Math.abs(d);o<l;o++){var c=rt();r.appendChild(c.element)}a.append(r)}else for(var v=0,h=Math.abs(d);v<h;v++){i[n-1-v].remove()}for(var m=(0,u.jg)(a,".bc"),b=0;b<s;b++){var f=e.buses[b],g=m[b],A=(0,u.aI)(g,".sc"),y=(0,u.aI)(A,"._c"),C=(0,u.aI)(g,".fd"),L=(0,u.aI)(C,".hd"),I=(0,u.aI)(C,".id"),E=(0,u.aI)(C,".jd");g.setAttribute("on-this-route",(0,p.xZ)(f.onThisRoute)),y.innerText=f.carNumber,L.innerText=`路線：${f.RouteName}`,I.innerText=`狀態：${f.status.text}`,E.innerText=`類型：${f.type}`}a.setAttribute("empty",(0,p.xZ)(0===s))}function A(t,e){var a=(0,u.aI)(t,".zb"),i=(0,u.jg)(a,".cc"),n=i.length,d=e.overlappingRoutes.length,r=n-d;if(r<0){for(var o=new DocumentFragment,l=0,c=Math.abs(r);l<c;l++){var v=ot();o.appendChild(v.element)}a.append(o)}else for(var h=0,m=Math.abs(r);h<m;h++){i[n-1-h].remove()}for(var b=(0,u.jg)(a,".cc"),g=0;g<d;g++){var A=e.overlappingRoutes[g],y=b[g],C=(0,u.aI)(y,".tc"),L=(0,u.aI)(C,".ad"),I=(0,u.aI)(y,".kd"),E=(0,u.aI)(y,".nd"),x=(0,u.aI)(E,'.pd[type="view-route"]'),w=(0,u.aI)(E,'.pd[type="save-to-folder"]');L.innerText=A.name,I.innerText=A.RouteEndPoints.text,function(t,e,a){t.onclick=function(){mt(e,a)}}(x,A.RouteID,A.PathAttributeId),function(t,e){t.onclick=function(){(0,f.B)("route-on-route",[e])},(0,s.LH)("route",e).then(function(e){t.setAttribute("highlighted",(0,p.xZ)(e))})}(w,A.RouteID)}a.setAttribute("empty",(0,p.xZ)(0===d))}function y(t,e){(0,u.aI)(t,"._b").innerHTML=0===e.busArrivalTimes.length?'<div class="qc">目前沒有抵達時間可顯示</div>':e.busArrivalTimes.map(function(t){return`<div class="dc"><div class="uc"><div class="yc">${(0,h.Zf)("calendar_view_day")}</div><div class="bd">${t.personalSchedule.name}</div><div class="dd">週${(0,v.kd)(t.day).name} ${(0,v.pn)(t.personalSchedule.period.start)} - ${(0,v.pn)(t.personalSchedule.period.end)}</div></div><div class="gd">${t.chart}</div></div>`}).join("")}function C(t,e){(0,u.aI)(t,".ac").innerHTML=0===e.nearbyLocations.length?'<div class="do">目前沒有地點可顯示</div>':e.nearbyLocations.map(function(t){return`<div class="ec"><div class="vc"><div class="zc">${(0,h.Zf)("location_on")}</div><div class="cd">${t.name}</div></div><div class="ld">${t.distance}公尺</div><div class="od"><div class="qd" onclick="bus.location.openLocation('${t.hash}')">查看地點</div><div class="qd" onclick="bus.folder.openSaveToFolder('location-on-route', ['${t.hash}'])">儲存地點</div></div></div>`}).join("")}function L(t,e,a){t.setAttribute("nearest",(0,p.xZ)(a.nearest)),e.setAttribute("nearest",(0,p.xZ)(a.nearest))}function I(t,e,a,i,n){var s=(null==a?void 0:a.progress)||0,d=(null==e?void 0:e.progress)||0,r=(0,u.aI)(t,".sn .bo");if(!i&&n&&0!==s&&0===d&&Math.abs(d-s)>0)return r.style.setProperty("--eo","100%"),void r.addEventListener("transitionend",function(){r.setAttribute("displayed","false"),r.style.setProperty("--eo","-100%")},{once:!0});d>0?(r.setAttribute("displayed","true"),r.style.setProperty("--eo",100*(d-1)+"%")):r.setAttribute("displayed","false")}function E(t,e,a){a&&((0,u.aI)(t,".lb").setAttribute("displayed","false"),t.setAttribute("stretched","false"),e.setAttribute("stretched","false"))}function x(t,e,a){t.setAttribute("animation",(0,p.xZ)(a)),e.setAttribute("animation",(0,p.xZ)(a))}function w(t,e,a){t.setAttribute("skeleton-screen",(0,p.xZ)(a)),e.setAttribute("skeleton-screen",(0,p.xZ)(a))}function R(e,a){var i=(0,u.aI)(e,'.lb .mb .nb[type="save-to-folder"]');i.onclick=function(){(0,f.B)("stop-on-route",[e.id,a.id,t.RouteID])},(0,s.LH)("stop",a.id).then(function(t){i.setAttribute("highlighted",(0,p.xZ)(t))})}function T(e,a){var i=(0,u.aI)(e,'.lb .mb .nb[type="schedule-notification"]');i.onclick=function(){(0,g.Ho)(i,a.id,t.RouteID,a.status.time)};var n=(0,d.Zc)(a.id);i.setAttribute("highlighted",(0,p.xZ)(n))}null===n?(l(e,a,i,r,o),m(e,i),b(e,i),A(e,i),y(e,i),C(e,i),c(e,a,i),L(e,a,i),I(a,i,n,r,o),E(e,a,r),x(e,a,o),w(e,a,r),R(e,i),T(e,i)):(i.status.time!==n.status.time&&(l(e,a,i,r,o),T(e,i)),(0,p.hw)(n.buses,i.buses)||b(e,i),(0,p.hw)(n.busArrivalTimes,i.busArrivalTimes)||y(e,i),n.nearest!==i.nearest&&L(e,a,i),n.progress!==i.progress&&I(a,i,n,r,o),n.id!==i.id&&(m(e,i),c(e,a,i),A(e,i),C(e,i),R(e,i),T(e,i)),Z!==o&&x(e,a,o),j!==r&&(E(e,a,r),w(e,a,r)))}var o=(0,m.gO)("window"),l=o.width,b=o.height,y=t.groupQuantity,C=t.itemQuantity,L=t.groupedItems;z=y,N=l;for(var I=0,R=[t.RouteEndPoints.RouteDestination,t.RouteEndPoints.RouteDeparture,"未知"].map(function(t){return`往${t}`}),$=0;$<y;$++){var D=`g_${$}`,Y=(0,c.q_)(R[$],500,"17px",'"Noto Sans TC", sans-serif')+20;B[D]={width:Y,offset:I},I+=Y}if(B[`g_${y}`]={width:0,offset:I},!q){var F=B[`g_${M}`],H=-1*F.offset+.5*N-.5*F.width,Q=F.width-20;et(z,H,Q,M)}j!==e&&(E.setAttribute("skeleton-screen",(0,p.xZ)(e)),T.setAttribute("skeleton-screen",(0,p.xZ)(e)),k.setAttribute("skeleton-screen",(0,p.xZ)(e))),Z!==a&&(E.setAttribute("animation",(0,p.xZ)(a)),T.setAttribute("animation",(0,p.xZ)(a)),k.setAttribute("animation",(0,p.xZ)(a))),(null===(i=P)||void 0===i?void 0:i.RouteID)!==t.RouteID&&(w.onclick=function(){(0,A.GS)(t.RouteID,t.PathAttributeId)}),(null===(n=P)||void 0===n?void 0:n.RouteName)!==t.RouteName&&(x.innerText=t.RouteName);var O=(0,u.jg)(S,".da").length;if(y!==O){var U=O-y;if(U<0){for(var J=new DocumentFragment,W=new DocumentFragment,G=0,K=Math.abs(U);G<K;G++){var X=st();J.appendChild(X.element);var V=dt();W.appendChild(V.element)}S.append(J),_.append(W)}else for(var tt=(0,u.jg)(S,".da"),at=(0,u.jg)(_,".kn"),lt=0,ut=Math.abs(U);lt<ut;lt++){var ct=O-1-lt;tt[ct].remove(),at[ct].remove()}}for(var pt=(0,u.jg)(S,".da"),vt=0;vt<y;vt++){var ht=`g_${vt}`,bt=pt[vt],ft=(0,u.aI)(bt,".fa"),gt=(0,u.aI)(bt,".qn"),At=(0,u.jg)(ft,".ha").length;if(C[ht]!==At){var yt=At-C[ht];if(yt<0){for(var Ct=new DocumentFragment,Lt=new DocumentFragment,It=0,Et=Math.abs(yt);It<Et;It++){var xt=it(),wt=nt(xt.element);Ct.appendChild(wt.element),Lt.appendChild(xt.element)}ft.append(Ct),gt.append(Lt)}else for(var Rt=(0,u.jg)(ft,".ha"),Tt=(0,u.jg)(gt,".rn"),_t=0,kt=Math.abs(yt);_t<kt;_t++){var $t=At-1-_t;Rt[$t].remove(),Tt[$t].remove()}}}for(var St=(0,u.jg)(_,".kn"),Pt=0;Pt<y;Pt++){var Zt=`g_${Pt}`,jt=St[Pt];jt.innerHTML=[t.RouteEndPoints.RouteDestination,t.RouteEndPoints.RouteDeparture,""].map(function(t){return`<span>往${t}</span>`})[Pt],jt.style.setProperty("--an",`${B[Zt].width}px`),jt.style.setProperty("--zm",Pt.toString());var Mt=pt[Pt];e&&(Mt.scrollTop=0);for(var Dt=(0,u.aI)(Mt,".fa"),zt=(0,u.aI)(Mt,".qn"),Bt=(0,u.jg)(Dt,".ha"),Nt=(0,u.jg)(zt,".rn"),qt=0;qt<C[Zt];qt++){var Yt=Bt[qt],Ft=Nt[qt],Ht=L[Zt][qt];if((0,p.mQ)(P,"groupedItems"))if((0,p.mQ)(P.groupedItems,Zt))if(P.groupedItems[Zt][qt])r(Yt,Ft,Ht,P.groupedItems[Zt][qt],e,a);else r(Yt,Ft,Ht,null,e,a);else r(Yt,Ft,Ht,null,e,a);else r(Yt,Ft,Ht,null,e,a)}}P=t,Z=a,j=e}function ut(){return ct.apply(this,arguments)}function ct(){return(ct=(0,i.A)(function*(){var t=(0,l.Js)("playing_animation"),e=(0,l.Js)("refresh_interval"),a=(0,m.gO)("route-bus-arrival-time-chart");Q=e.dynamic,Y=e.baseInterval,W=!0,J=(0,p.zx)(),R.setAttribute("refreshing","true"),R.classList.remove("pn"),document.addEventListener(J,at);var i=yield(0,o.R)(X,V,a.width,a.height,J);lt(i,!1,t);var s=0;Q&&(s=yield(0,n.wz)()),O=(new Date).getTime(),U=Q?Math.max(O+F,i.dataUpdateTime+Y/s):O+Y,H=Math.max(F,U-O),W=!1,R.setAttribute("refreshing","false"),R.style.setProperty("--cn",`${H}ms`),R.classList.add("pn")})).apply(this,arguments)}function pt(){ut().then(function(){G?setTimeout(function(){pt()},Math.max(F,U-(new Date).getTime())):K=!1}).catch(function(t){G?((0,b.a)("error","路線網路連線中斷，將在10秒後重試。"),setTimeout(function(){pt()},1e4)):K=!1})}function vt(t,e){(0,m.WR)("Route"),(0,r.XK)("route",t),X=t,V=e,M=0,B={},L.setAttribute("displayed","true"),S.scrollLeft=0,S.focus(),function(t,e){for(var a=(0,l.Js)("playing_animation"),i=(0,m.gO)("window"),n=(i.width,i.height),s=Math.floor(n/50)+5,d={},r=0;r<2;r++){var o=`g_${r}`;d[o]=[];for(var u=0;u<s;u++)d[o].push({name:"",goBack:"0",status:{code:8,text:"",time:-6},buses:[],overlappingRoutes:[],busArrivalTimes:[],nearbyLocations:[],sequence:u,position:{longitude:0,latitude:0},nearest:!1,progress:0,segmentBuffer:{isSegmentBuffer:!1,isStartingPoint:!1,isEndingPoint:!1},id:0})}lt({groupedItems:d,groupQuantity:2,itemQuantity:{g_0:s,g_1:s},RouteName:"載入中",RouteEndPoints:{RouteDeparture:"載入中",RouteDestination:"載入中"},RouteID:t,PathAttributeId:e,dataUpdateTime:0},!0,a)}(t,e),G||(G=!0,K?ut():(K=!0,pt())),(0,m.Z_)()}function ht(){L.setAttribute("displayed","false"),G=!1,(0,m.l$)()}function mt(t,e){G=!1,vt(t,e)}function bt(t,e){var a,i=(0,u.aI)(S,`.ha#${t}`),n=(0,u.aI)(i,".mb"),s=y((0,u.jg)(n,'.nb[highlighted="true"][type="tab"]'));try{for(s.s();!(a=s.n()).done;){a.value.setAttribute("highlighted","false")}}catch(t){s.e(t)}finally{s.f()}switch((0,u.aI)(n,`.nb[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:(0,u.aI)(i,".yb").setAttribute("displayed","true"),(0,u.aI)(i,"._b").setAttribute("displayed","false"),(0,u.aI)(i,".zb").setAttribute("displayed","false"),(0,u.aI)(i,".ac").setAttribute("displayed","false");break;case 1:(0,u.aI)(i,".yb").setAttribute("displayed","false"),(0,u.aI)(i,"._b").setAttribute("displayed","true"),(0,u.aI)(i,".zb").setAttribute("displayed","false"),(0,u.aI)(i,".ac").setAttribute("displayed","false");break;case 2:(0,u.aI)(i,".yb").setAttribute("displayed","false"),(0,u.aI)(i,"._b").setAttribute("displayed","false"),(0,u.aI)(i,".zb").setAttribute("displayed","true"),(0,u.aI)(i,".ac").setAttribute("displayed","false");break;case 3:(0,u.aI)(i,".yb").setAttribute("displayed","false"),(0,u.aI)(i,"._b").setAttribute("displayed","false"),(0,u.aI)(i,".zb").setAttribute("displayed","false"),(0,u.aI)(i,".ac").setAttribute("displayed","true")}}}}]);
//# sourceMappingURL=f25e48fd4bd9d4801511.js.map