"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[470],{2303(e,t,r){r.d(t,{a:()=>u,b:()=>s,c:()=>c,d:()=>d,e:()=>p,f:()=>f,g:()=>a,h:()=>o});var n=r(8024),i=r(5579);function a(e,t){if("string"==typeof e){var r=parseInt(e);if(-3===r)return{code:6,text:"末班駛離",time:r};if(-4===r)return{code:5,text:"今日停駛",time:r};if(-2===r)return{code:4,text:"交通管制",time:r};if(-1===r)return{code:3,text:"未發車",time:r};if(0<=r&&r<=10)return{code:2,text:"進站中",time:r};if(10<r&&r<=180)return{code:1,text:(0,i.e)(r,t),time:r};if(180<r&&r<=250)return{code:.5,text:(0,i.e)(r,t),time:r};if(250<r)return{code:0,text:(0,i.e)(r,t),time:r}}return{code:7,text:"發生錯誤",time:-5}}function o(e,t){var r=e.length;if(0===t){var n=0,i=0;return 4===r&&(n=parseInt(e.substring(0,2)),i=parseInt(e.substring(2,4))),2===r&&(i=parseInt(e)),{type:"moment",hours:n,minutes:i}}if(1===t){var a=0,o=0;if(4===r){var s=parseInt(e.substring(0,2)),u=parseInt(e.substring(2,4));a=Math.min(s,u),o=Math.max(s,u)}if(2===r){var f=parseInt(e);a=f,o=f}return{type:"range",min:a,max:o}}}function s(e,t,r,i,a){var o={},s={};for(var u of t){s[u.BusID]=u}for(var f of e){var p={};p.CarType=f.CarType,p.BusStatus=f.BusStatus,p.BusID=f.BusID,p.CarOnStop=f.CarOnStop;var d=parseInt(f.RouteID),c=String(f.BusID),l=!1,y=0;d===i||a.indexOf(d)>-1||d===10*i?(l=!0,y=c.charCodeAt(0)*Math.pow(10,-5)):(l=!1,y=c.charCodeAt(0)),p.onThisRoute=l,p.index=y;var v={};if((0,n.e)(s,c)){v=s[c],p.position={latitude:parseFloat(v.Latitude),longitude:parseFloat(v.Longitude)};var h={},m=!1;for(var g in r){var b=r[g];if(b.pid.indexOf(d)>-1){h=b,m=!0;break}}p.RouteName=m?h.n:"未知路線",p.RouteID=m?h.id:null;var _=`s_${f.StopID}`;(0,n.e)(o,_)||(o[_]=[]),o[_].push(p)}}return o}function u(e,t,r,i){var a={},o={};for(var s of t){o[s.BusID]=s}for(var u of e){var f={},p=parseInt(u.StopID),d=parseInt(u.RouteID),c=String(u.BusID);if(!(i.indexOf(p)<0)){f.index=c.charCodeAt(0),f.onThisRoute=!0,f.CarType=u.CarType,f.BusStatus=u.BusStatus,f.BusID=u.BusID,f.CarOnStop=u.CarOnStop;var l={};if((0,n.e)(o,c)){l=o[c],f.position={latitude:parseFloat(l.Latitude),longitude:parseFloat(l.Longitude)};var y={},v=!1;for(var h in r){var m=r[h];if(m.pid.indexOf(d)>-1){y=m,v=!0;break}}f.RouteName=v?y.n:"未知路線",f.RouteID=v?y.id:null;var g=`s_${p}`;(0,n.e)(a,g)||(a[g]=[]),a[g].push(f)}}}return a}function f(e){var t="";switch(e){case"0":t="一般";break;case"1":t="低底盤";break;case"2":t="大復康巴士";break;case"3":t="狗狗友善專車";break;default:t="未知類型"}return t}function p(e){var t="";switch(e){case"0":t="離站";break;case"1":t="進站";break;default:t="未知狀態"}return t}function d(e){var t="";switch(e){case"0":t="正常";break;case"1":t="車禍";break;case"2":t="故障";break;case"3":t="塞車";break;case"4":t="緊急求援";break;case"5":t="加油";break;case"99":t="非營運狀態";break;default:t="未知狀態"}return t}function c(e){var t={},r=f(e.CarType);t.type=r;var n=p(e.CarOnStop),i=d(e.BusStatus);return t.carNumber=e.BusID,t.status={onStop:n,situation:i,text:`${n} | ${i}`},t.RouteName=e.RouteName,t.onThisRoute=e.onThisRoute,t.index=e.index,t.position=e.position,t}},2757(e,t,r){r.d(t,{a:()=>I});var n=r(3453),i=r(467),a=r(4256),o=r(574),s=r(8024),u=r(2945),f=r(5428),p=r(6483),d=r(6802),c=r(7810),l=r(2063),y=r(8011),v=r(4293),h=r(424),m=r(2303),g=r(6788),b=r(3459),_=r(1238);function k(e,t){var r={},n=[];for(var i in e){var a=e[i],o=a.StopID,s=parseInt(a.EstimateTime);s>=0&&t.indexOf(o)>-1&&n.push([o,s])}var u=n.length;n.sort(function(e,t){return e[1]-t[1]});var f=1;for(var p of n){var d=f/u,c=(d-d%.25)/.25;r[`s_${p[0]}`]={number:f,text:f.toString(),code:c},f+=1}return r}function I(e,t,r,n){return S.apply(this,arguments)}function S(){return(S=(0,i.a)(function*(e,t,r,i){(0,g.f)(i,"getLocation_0",0,!1),(0,g.f)(i,"getLocation_1",0,!1),(0,g.f)(i,"getRoute_0",0,!1),(0,g.f)(i,"getRoute_1",0,!1),(0,g.f)(i,"getStop_0",0,!1),(0,g.f)(i,"getStop_1",0,!1),(0,g.f)(i,"getEstimateTime_0",0,!1),(0,g.f)(i,"getEstimateTime_1",0,!1),(0,g.f)(i,"getBusEvent_0",0,!1),(0,g.f)(i,"getBusEvent_1",0,!1),(0,g.f)(i,"getBusData_0",0,!1),(0,g.f)(i,"getBusData_1",0,!1);for(var I=yield Promise.all([yield(0,v.a)(i,!0),yield(0,h.a)(i),yield(0,y.a)(i,1)]),S=(0,n.a)(I,3),$=S[0],x=S[1],O=S[2],D=yield Promise.all([(0,l.a)(i),(0,c.a)(i),(0,d.a)(i),(0,p.b)(t,r)]),w=(0,n.a)(D,4),N=w[0],T=w[1],B=w[2],J=w[3],C=(0,b.b)("time_formatting_mode"),R=(0,b.b)("location_labels"),E=(0,b.b)("display_user_orientation"),L={},q={},A={},F=(0,_.b)(),P=O[`ml_${e}`],j=P.n,M=P.id,Q=P.v,U=[],z=[],G=M.length,H=0;H<G;H++)for(var K=0,V=P.s[H].length;K<V;K++)U.push(P.s[H][K]),z.push(P.r[H][K]);var W=function(e,t){var r={};for(var n of e)t.indexOf(n.StopID)>-1&&(r[`s_${n.StopID}`]=n);return r}(N,U),X=(0,m.a)(T,B,$,U),Y=[];for(var Z of Q){var ee=0,te=0;for(var re of Z)ee+=re[0],te+=re[1];var ne=(0,f.d)([ee,te]),ie=(0,o.b)(ne);Y.push(ie)}var ae=[];switch(R){case"address":ae=(0,a.b)(P.a);break;case"letters":ae=(0,u.b)(G);break;case"directions":ae=(0,u.a)(Y)}for(var oe=0;oe<G;oe++){var se=`g_${oe}`;L[se]=[],q[se]=0,A[se]={name:ae[oe],properties:[{key:"address",icon:"personal_places",value:(0,a.a)(P.a[oe])},{key:"exact_position",icon:"location_on",value:`${P.la[oe].toFixed(5)}, ${P.lo[oe].toFixed(5)}`},{key:"cardinal_direction",icon:Y[oe].icon,value:`${Y[oe].name}${E&&-1!==F.cardinalDirection.id&&F.cardinalDirection.id===Y[oe].id?"（目前指向）":""}`}]};for(var ue=P.s[oe],fe=ue.length,pe=k(W,ue),de=0;de<fe;de++){var ce={},le=P.s[oe][de],ye=`s_${le}`,ve={};if((0,s.e)(x,ye)){ve=x[ye],ce.stopId=le;var he={number:0,text:"--",code:-1};(0,s.e)(pe,ye)&&(he=pe[ye]),ce.ranking=he;var me=P.r[oe][de],ge=`r_${me}`,be={};if((0,s.e)($,ge)){be=$[ge],ce.route_name=be.n,ce.route_direction=`往${[be.des,be.dep,""][parseInt(ve.goBack)]}`,ce.routeId=me;var _e={};if((0,s.e)(W,ye)){_e=W[ye];var ke=(0,m.g)(_e.EstimateTime,C);ce.status=ke;var Ie=[];(0,s.e)(X,ye)&&(Ie=X[ye].map(function(e){return(0,m.c)(e)})),ce.buses=Ie;var Se=[];(0,s.e)(J,ye)&&(Se=J[ye]),ce.busArrivalTimes=Se,L[se].push(ce),q[se]+=1}}}}}for(var $e in L)L[$e].sort(function(e,t){return e.routeId-t.routeId});var xe={groupedItems:L,groups:A,groupQuantity:G,itemQuantity:q,LocationName:j,hash:e,dataUpdateTime:(0,g.e)(i)};return(0,g.a)(i),(0,g.b)(i),xe})).apply(this,arguments)}},5427(e,t,r){r.d(t,{a:()=>h});var n=r(467),i=r(9566),a=r(5352),o=r(5314),s=r(3459),u=r(4311);function f(e){return p.apply(this,arguments)}function p(){return(p=(0,n.a)(function*(e){for(var t of e){var r=t,n=!1,a=!1,o=`f_${r.id}`;if((yield(0,u.d)(11,o))?n=yield(0,i.q)(r.id,r.name,r.icon):a=yield(0,i.a)(r.name,r.icon),n)for(var s of t.content)yield(0,i.o)(t.id,s);if(a)for(var f of t.content)yield(0,i.o)(a,f)}})).apply(this,arguments)}function d(e){return c.apply(this,arguments)}function c(){return(c=(0,n.a)(function*(e){for(var t of e){var r=(0,s.c)(t.key);r&&"select"===r.type&&(yield(0,s.a)(t.key,t.option))}return!0})).apply(this,arguments)}function l(e){return y.apply(this,arguments)}function y(){return(y=(0,n.a)(function*(e){for(var t of e){(yield(0,a.b)(t.id))?yield(0,a.e)(t):yield(0,a.a)(t.name,t.period.start.hours,t.period.start.minutes,t.period.end.hours,t.period.end.minutes,t.days)}return!0})).apply(this,arguments)}function v(){return(v=(0,n.a)(function*(e){for(var t of e)switch(t.type){case"route":(yield(0,o.b)("route",t.id))||(yield(0,o.e)(t.type,t.id));break;case"location":(yield(0,o.b)("location",t.hash))||(yield(0,o.e)(t.type,t.hash));break;case"bus":(yield(0,o.b)("bus",t.id))||(yield(0,o.e)(t.type,t.id))}return!0})).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return m=(0,n.a)(function*(e){var t=JSON.parse(e);switch(t.version){case 1:return yield f(t.folders),!0;case 2:return yield f(t.folders),yield d(t.settings),!0;case 3:return yield f(t.folders),yield d(t.settings),yield l(t.personal_schedules),!0;case 4:return yield f(t.folders),yield d(t.settings),yield l(t.personal_schedules),yield function(e){return v.apply(this,arguments)}(t.recent_views),!0;default:return!1}}),m.apply(this,arguments)}},5976(e,t,r){r.d(t,{a:()=>u});var n=r(467),i=r(9566),a=r(5352),o=r(5314),s=r(3459);function u(){return f.apply(this,arguments)}function f(){return(f=(0,n.a)(function*(){var e=yield(0,i.i)(),t=(0,s.e)(),r=yield(0,a.d)(),n=yield(0,o.d)(),u={};return u.time=(new Date).toISOString(),u.version=4,u.folders=e,u.settings=t,u.personal_schedules=r,u.recent_views=n,JSON.stringify(u)})).apply(this,arguments)}},6160(e,t,r){r.d(t,{a:()=>l});var n=r(467),i=r(8024),a=r(6802),o=r(7810),s=r(9734),u=r(8011),f=r(424),p=r(2303),d=r(6788),c=r(8134);function l(e,t){return y.apply(this,arguments)}function y(){return(y=(0,n.a)(function*(e,t){var r=`c_${e}`,n=yield(0,s.a)(t,!0),l=yield(0,a.a)(t),y=yield(0,o.a)(t),v=yield(0,f.a)(t),h=yield(0,u.a)(t,0),m={properties:[],LocationName:""},g={};if(!(0,i.e)(n,r))return m;var b=(g=n[r]).CarNum;m.properties.push({key:"car_number",icon:"tag",value:b});var _=g.CarType,k=(0,p.f)(_);m.properties.push({key:"car_type",icon:"directions_bus",value:k});var I={};for(var S of l){if(S.BusID===b){I=S;break}}var $=parseInt(I.RouteID),x=I.BusStatus,O=(0,p.d)(x),D=parseInt(I.GoBack),w={};for(var N of y){if(N.BusID===b){w=N;break}}var T=w.CarOnStop,B=(0,p.e)(T);m.properties.push({key:"status",icon:"vital_signs",value:`${B} | ${O}`});var J=w.StopID,C=yield(0,c.d)($),R={};if(!(C.length>0))return m;var E=(R=C[0]).id,L=R.pid,q=R.n,A=R.dep,F=[R.des,A,""][D||0];m.properties.push({key:"route",icon:"route",value:`${q} - 往${F}`}),m.RouteID=E,m.FullPathAttributeId=L;var P=`s_${J}`;if(!(0,i.e)(v,P))return m;var j=h[`l_${v[P].stopLocationId}`].n;return m.properties.push({key:"location_name",icon:"location_on",value:j}),(0,d.a)(t),(0,d.b)(t),m})).apply(this,arguments)}},6788(e,t,r){r.d(t,{a:()=>m,b:()=>I,c:()=>d,d:()=>h,e:()=>k,f:()=>v,g:()=>_});var n=r(2284),i=r(467),a=r(8024),o=r(4750),s=r(5579),u=r(8925),f={},p=new Error("E21");function d(e,t,r,n){return c.apply(this,arguments)}function c(){return(c=(0,i.a)(function*(e,t,r,n){if((0,a.e)(f,e)){if(f[e].processing)return yield new Promise(function(n,i){f[e].requests.push([n,i,t,r])});if(null!==f[e].result&&(new Date).getTime()<=f[e].timestamp)return v(t,r,0,!0),f[e].result}else f[e]={processing:!0,requests:[],failed:!1,timestamp:-1,result:null};var i=yield fetch(e);if(!i.ok)throw v(t,r,0,!0),new Error("E22");for(var s=parseInt(String(i.headers.get("content-length"))),c=i.body.getReader(),y=[],h=0;;){var m=yield c.read(),g=m.done,b=m.value;if(g)break;y.push(b);var _=(h+=b.length)/s;if(v(t,r,_,!1),(0,a.e)(f,e))for(var k of f[e].requests)v(k[2],k[3],_,!1)}var I=new Uint8Array(h),S=0;for(var $ of y)I.set($,S),S+=$.length;var x,O=new Blob([I],{type:"application/gzip"}),D=yield O.arrayBuffer(),w=yield(0,o.a)(D);switch(n){case"json":x=/^<!doctype html>/.test(w)?yield d(e.replace("https://tcgbusfs.blob.core.windows.net/","https://erichsia7.github.io/bus-alternative-static-apis/"),t,r,n):JSON.parse(w);break;case"xml":x=w}var N=new Date;if(yield(0,u.d)(s,N),x){if((0,a.e)(f,e)){for(var T=h/s,B=f[e].requests.shift();B;)B[0](x),v(B[2],B[3],T,!1),B=f[e].requests.shift();f[e].result=x,f[e].timestamp=N.getTime()+3e4,f[e].processing=!1}return l(),x}if((0,a.e)(f,e)){for(var J=f[e].requests.shift();J;)J[1](p),v(J[2],J[3],0,!0),J=f[e].requests.shift();f[e].failed=!0}throw l(),p})).apply(this,arguments)}function l(){var e=(new Date).getTime();for(var t in f)if((0,a.e)(f,t)){if(!f[t].processing&&e>f[t].timestamp){delete f[t];continue}if(f[t].failed){delete f[t];continue}}}var y={};function v(e,t,r,n){(0,a.e)(y,e)||(y[e]={}),(0,a.e)(y[e],t)?(n?y[e][t].expel=!0:(y[e][t].expel=!1,y[e][t].progress=r),g(e,"run")):(y[e][t]={expel:!1,progress:r,total:1},g(e,"start"))}function h(e){if((0,a.e)(y,e)&&"object"===(0,n.a)(y[e])){var t=0,r=0;for(var i in y[e])y[e][i].expel||(t+=y[e][i].total,r+=y[e][i].progress);var o=Math.min(Math.max(r/t,0),1);return o===1/0||isNaN(o)?1:o}return 1}function m(e){(0,a.e)(y,e)&&(delete y[e],g(e,"end"))}function g(e,t){var r={target:e,stage:t,progress:h(e)},n=new CustomEvent(e,{detail:r});document.dispatchEvent(n)}var b={};function _(e,t,r){(0,a.e)(b,e)||(b[e]=0);var n=0;"string"==typeof t&&(n=(0,s.j)(t,r)),n>b[e]&&(b[e]=n)}function k(e){return(0,a.e)(b,e)?1*b[e]:0}function I(e){(0,a.e)(b,e)&&delete b[e]}},6983(e,t,r){r.d(t,{a:()=>f});var n=r(467),i=r(1351),a=r(3041),o=r(8024),s=r(8011),u=r(6788);function f(e,t){return p.apply(this,arguments)}function p(){return(p=(0,n.a)(function*(e,t){var r=yield(0,s.a)(t,1);(0,u.a)(t),(0,u.b)(t);var n=`ml_${e}`;if(!(0,o.e)(r,n))return{actions:[],actionsQuantity:0,hash:e};r[n];var f=[{icon:"folder",name:"儲存",key:"save-to-folder",action:function(){(0,a.c)("location",[e],null)}},{icon:"ios_share",name:"分享",key:"permalink",action:function(){(0,i.d)(e)}},{icon:"qr_code_2",name:"二維條碼",key:"permalink-qr-code",action:function(){(0,i.f)(e)}}];return{actions:f,actionsQuantity:f.length,hash:e}})).apply(this,arguments)}},9566(e,t,r){r.d(t,{a:()=>_,b:()=>$,c:()=>g,d:()=>L,e:()=>P,f:()=>R,g:()=>O,h:()=>J,i:()=>T,j:()=>x,k:()=>M,l:()=>K,m:()=>G,n:()=>U,o:()=>A,p:()=>W,q:()=>I});var n=r(2284),i=r(467),a=r(8024),o=r(6483),s=r(5767),u=r(2063),f=r(8011),p=r(9218),d=r(4293),c=r(424),l=r(2303),y=r(6788),v=r(3459),h=r(4311),m={};function g(){return b.apply(this,arguments)}function b(){return(b=(0,i.a)(function*(){var e=yield(0,h.e)(11);for(var t of e){var r=yield(0,h.d)(11,t);if(r){var n=JSON.parse(r);(0,a.e)(m,t)||(m[t]=n)}}})).apply(this,arguments)}function _(e,t){return k.apply(this,arguments)}function k(){return(k=(0,i.a)(function*(e,t){var r=(0,a.c)(),n=yield(0,p.a)(r);if((0,y.a)(r),!(0,a.e)(n.symbols,t))return!1;var i=(0,a.c)(),o=`f_${i}`;if((0,a.e)(m,o))return!1;if(yield(0,h.d)(11,o))return!1;var s={name:e,icon:t,id:i,timestamp:(new Date).getTime()};return m[o]=s,yield(0,h.g)(11,o,JSON.stringify(s)),yield(0,h.g)(12,o,JSON.stringify([])),i})).apply(this,arguments)}function I(e,t,r){return S.apply(this,arguments)}function S(){return(S=(0,i.a)(function*(e,t,r){var n=`f_${e}`,i=yield(0,h.d)(11,n);if(!i)return!1;var o=JSON.parse(i),s=(0,a.c)(),u=yield(0,p.a)(s);if((0,y.a)(s),!(0,a.e)(u.symbols,r))return!1;var f={name:t,icon:r,id:e,timestamp:o.timestamp};return m[n]=f,yield(0,h.g)(11,n,JSON.stringify(f)),!0})).apply(this,arguments)}function $(e){var t=`f_${e}`;return!!(0,a.e)(m,t)&&{name:m[t].name,icon:m[t].icon,id:m[t].id,timestamp:m[t].timestamp}}function x(){var e=[];for(var t in m){var r={name:m[t].name,icon:m[t].icon,id:m[t].id,timestamp:m[t].timestamp};e.push(r)}return e.sort(function(e,t){return e.timestamp-t.timestamp}),e}function O(e){return D.apply(this,arguments)}function D(){return(D=(0,i.a)(function*(e){var t=[],r=`f_${e}`,n=$(e);if("boolean"==typeof n&&!1===n)return t;var i=yield(0,h.d)(12,r);if(!i)return t;var a=JSON.parse(i);if(0===a.length){return t.push({type:"empty",id:0}),t}for(var o of a){var s=yield(0,h.d)(13,o);if(s){var u=JSON.parse(s);t.push(u)}}return t})).apply(this,arguments)}function w(e){return N.apply(this,arguments)}function N(){return(N=(0,i.a)(function*(e){var t=`f_${e}`,r=yield(0,h.d)(12,t);return r?JSON.parse(r).length:0})).apply(this,arguments)}function T(){return B.apply(this,arguments)}function B(){return(B=(0,i.a)(function*(){var e=x(),t=[];for(var r of e){var n=yield O(r.id),i=yield w(r.id);t.push({name:r.name,icon:r.icon,id:r.id,timestamp:r.timestamp,content:n,contentLength:i})}return t})).apply(this,arguments)}function J(){return C.apply(this,arguments)}function C(){return(C=(0,i.a)(function*(){var e=x(),t=[];for(var r of e){var n=yield w(r.id);t.push({name:r.name,icon:r.icon,id:r.id,timestamp:r.timestamp,contentLength:n})}return t})).apply(this,arguments)}function R(e){return E.apply(this,arguments)}function E(){return(E=(0,i.a)(function*(e){var t=!0;"object"===(0,n.a)(e)&&Array.isArray(e)||(t=!1);var r=[],i=yield(0,h.e)(13);for(var a of i){var o=yield(0,h.d)(13,a);if(o){var s=JSON.parse(o);t?e.indexOf(s.type)>-1&&r.push(s):r.push(s)}}return r})).apply(this,arguments)}function L(e){return q.apply(this,arguments)}function q(){return(q=(0,i.a)(function*(e){(0,y.f)(e,"getEstimateTime_0",0,!1),(0,y.f)(e,"getEstimateTime_1",0,!1),(0,y.f)(e,"getRoute_0",0,!1),(0,y.f)(e,"getRoute_1",0,!1);var t=yield(0,u.a)(e),r=yield(0,d.a)(e,!0),n=yield T(),i=(0,v.b)("time_formatting_mode"),f=(0,v.b)("power_saving"),p=(0,v.b)("refresh_interval"),c=[];for(var h of n)for(var m=0,g=h.content.length;m<g;m++)"stop"===h.content[m].type&&c.push(h.content[m].id);var b={};for(var _ of t){if(c.indexOf(_.StopID)>-1)b[`s_${_.StopID}`]=_}var k=[];for(var I of n){var S={name:I.name,icon:I.icon,id:I.id,timestamp:I.timestamp,content:[],contentLength:I.contentLength};for(var $ of I.content){var x=$;switch(x.type){case"stop":var O=`s_${x.id}`,D={};if(!(0,a.e)(b,O))break;D=b[O],x.status=(0,l.g)(D.EstimateTime,i);var w=r[`r_${x.route.id}`];x.route.pathAttributeId=w.pid;break;case"route":var N=r[`r_${x.id}`];x.pathAttributeId=N.pid}S.content.push(x)}k.push(S)}var B={folders:k,dataUpdateTime:(0,y.e)(e)};return(0,y.a)(e),(0,y.b)(e),f||(p.dynamic&&(yield(0,s.a)(t)),yield(0,o.a)(t)),B})).apply(this,arguments)}function A(e,t){return F.apply(this,arguments)}function F(){return(F=(0,i.a)(function*(e,t){var r=`f_${e}`,n=`${t.type}_${t.id}`,i=$(e);if("boolean"==typeof i&&!1===i)return!1;var a=yield(0,h.d)(12,r);if(!a)return!1;var o=JSON.parse(a);return(0===o.length||o.indexOf(n)<0)&&(o.push(n),yield(0,h.g)(12,r,JSON.stringify(o)),yield(0,h.g)(13,n,JSON.stringify(t)),!0)})).apply(this,arguments)}function P(e,t){return j.apply(this,arguments)}function j(){return(j=(0,i.a)(function*(e,t){var r=`${e}_${t}`,n=yield(0,h.e)(12);for(var i of n){var a=yield(0,h.d)(12,i);if(a)if(JSON.parse(a).indexOf(r)>-1)return!0}return!1})).apply(this,arguments)}function M(e,t,r){return Q.apply(this,arguments)}function Q(){return(Q=(0,i.a)(function*(e,t,r){var n=`f_${e}`,i=`${t}_${r}`,a=$(e);if("boolean"==typeof a&&!1===a)return!1;var o=yield(0,h.d)(12,n);if(!o)return!1;var s=JSON.parse(o),u=s.indexOf(i);return u>-1&&s.length>0&&(s.splice(u,1),yield(0,h.g)(12,n,JSON.stringify(s))),!1===(yield P(t,r))&&(yield(0,h.f)(13,i)),!0})).apply(this,arguments)}function U(e,t,r){return z.apply(this,arguments)}function z(){return(z=(0,i.a)(function*(e,t,r){var n=(0,a.c)(),i=yield(0,c.a)(n),o=yield(0,f.a)(n,0),s=yield(0,d.a)(n,!0),u=i[`s_${t}`],p=parseInt(u.goBack),l=o[`l_${u.stopLocationId}`].n,y=s[`r_${r}`],v=y.n,h=y.dep,m=y.des,g={type:"stop",id:t,timestamp:(new Date).getTime(),name:l,direction:p,route:{name:v,endPoints:{departure:h,destination:m},id:r}};return yield A(e,g)})).apply(this,arguments)}function G(e,t){return H.apply(this,arguments)}function H(){return(H=(0,i.a)(function*(e,t){var r=(0,a.c)(),n=yield(0,d.a)(r,!0);(0,y.a)(r),(0,y.b)(r);var i=`r_${t}`,o={};if(!(0,a.e)(n,i))return!1;o=n[i];var s={type:"route",id:t,timestamp:(new Date).getTime(),name:o.n,endPoints:{departure:o.dep,destination:o.des}};return yield A(e,s)})).apply(this,arguments)}function K(e,t){return V.apply(this,arguments)}function V(){return(V=(0,i.a)(function*(e,t){var r=(0,a.c)(),n=yield(0,f.a)(r,1);(0,y.a)(r),(0,y.b)(r);var i=`ml_${t}`,o={};if(!(0,a.e)(n,i))return!1;o=n[i];var s={type:"location",id:t,timestamp:(new Date).getTime(),name:o.n};return yield A(e,s)})).apply(this,arguments)}function W(e,t,r,n){return X.apply(this,arguments)}function X(){return(X=(0,i.a)(function*(e,t,r,n){var i=`f_${e}`,a=`${t}_${r}`,o=$(e);if("boolean"==typeof o&&!1===o)return!1;var s=yield(0,h.d)(12,i);if(!s)return!1;var u=JSON.parse(s),f=u.indexOf(a);if(f>-1&&u.length>1){var p=0;switch(n){case"up":p=-1;break;case"down":p=1;break;default:p=0}return u.splice(f,1),u.splice(f+p,0,a),yield(0,h.g)(12,i,JSON.stringify(u)),!0}return!1})).apply(this,arguments)}}}]);
//# sourceMappingURL=100e34917c99bfc55534.js.map