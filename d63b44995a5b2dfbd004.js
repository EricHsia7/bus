"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[5239],{1351(t,e,i){i.d(e,{ID:()=>C,k9:()=>L,qp:()=>w});var n=i(467),a=i(8011),r=i(6788),s=i(6983),d=i(3459),o=i(8179),u=i(8024),l=i(9469),c=i(4537),p=i(904),v=i(9119),h=i(8279),f={},m=!1,b=!1,g=(0,o.bv)(".wk"),y=(0,o.aI)(g,".al"),A=(0,o.aI)(y,".bl");function I(){var t=document.createElement("div");t.classList.add("cl");var e=document.createElement("div");e.classList.add("dl"),e.appendChild((0,c.oC)()),t.appendChild(e);var i=document.createElement("div");return i.classList.add("el"),t.appendChild(i),{element:t,id:""}}function j(t,e,i){function n(t,n,a){function r(t,e){var i=(0,o.aI)(t,".dl");(0,c.yD)(i,e.icon)}function s(t,e){(0,o.aI)(t,".el").innerText=e.name}function d(t,e){t.onclick=e.action}function l(t,e){t.setAttribute("animation",(0,u.xZ)(e))}function p(t,e){t.setAttribute("skeleton-screen",(0,u.xZ)(e))}null==a?(r(t,n),s(t,n),d(t,n),l(t,i),p(t,e)):(a.key!==n.key&&(r(t,n),s(t,n),d(t,n)),i!==m&&l(t,i),e!==b&&p(t,e))}var a=t.actions,r=t.actionsQuantity,s=(0,o.jg)(A,".cl").length;if(r!==s){var d=s-r;if(d<0){for(var l=new DocumentFragment,p=0,v=Math.abs(d);p<v;p++){var h=I();l.appendChild(h.element)}A.append(l)}else for(var g=(0,o.jg)(A,".cl"),y=0,j=Math.abs(d);y<j;y++){g[s-1-y].remove()}}for(var x=(0,o.jg)(A,".cl"),C=0;C<r;C++){var L=x[C],k=a[C];if(f.hasOwnProperty("actions"))if(f.actions[C])n(L,k,f.actions[C]);else n(L,k,null);else n(L,k,null)}f=t,m=i,b=e}function x(){return(x=(0,n.A)(function*(t){var e=(0,d.Js)("playing_animation"),i=(0,u.zx)();j(yield(0,s.v)(t,i),!1,e)})).apply(this,arguments)}function C(t){(0,p.WR)("LocationDetails"),g.setAttribute("displayed","true"),function(){for(var t=(0,d.Js)("playing_animation"),e=[],i=0;i<3;i++)e.push({name:"",icon:"",key:`action-${i}`,action:function(){}});j({actions:e,actionsQuantity:3,hash:""},!0,t)}(),function(t){x.apply(this,arguments)}(t)}function L(t){return k.apply(this,arguments)}function k(){return(k=(0,n.A)(function*(t){var e=(0,u.zx)(),i=yield(0,a.g)(e,1);(0,r.LQ)(e),(0,r.gC)(e);var n=`ml_${t}`;if(i.hasOwnProperty(n)){var s=i[n],d=(0,l.i)(1,{hash:t});navigator.share&&navigator.share({title:s.n,url:d}).then(function(){(0,v.a)("check_circle","已分享地點")}).catch(function(t){(0,v.a)("cancel","已取消分享")})}})).apply(this,arguments)}function w(t){return E.apply(this,arguments)}function E(){return(E=(0,n.A)(function*(t){var e=(0,u.zx)(),i=yield(0,a.g)(e,1);(0,r.LQ)(e),(0,r.gC)(e);var n=`ml_${t}`;if(i.hasOwnProperty(n)){var s=(0,l.i)(1,{hash:t});(0,h.X8)(s)}})).apply(this,arguments)}},2174(t,e,i){i.d(e,{Sv:()=>O});var n=i(467),a=i(5767),r=i(365),s=i(77),d=i(3459),o=i(8179),u=i(8024),l=i(4537),c=i(904),p=i(9119),v=(0,o.bv)(".fb"),h=(0,o.aI)(v,".gb"),f=(0,o.aI)(h,".hb"),m=(0,o.aI)(f,".ib"),b=(0,o.aI)(v,".jb"),g=(0,o.aI)(b,".kb"),y={},A=!1,I=15e3,j=5e3,x=15e3,C=!0,L=0,k=0,w="",E=!1,_=!1,T=!1;function $(t){var e=t;if(E){var i=e.detail.progress-1;m.style.setProperty("--nb",i.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,$)}function S(){var t=(0,u.zx)(),e=document.createElement("div");e.classList.add("ob"),e.id=t;var i=document.createElement("div");i.classList.add("pb"),e.appendChild(i);var n=document.createElement("div");n.classList.add("qb");var a=document.createElement("div");a.classList.add("rb"),n.appendChild(a);var r=document.createElement("div");r.classList.add("sb"),n.appendChild(r);var s=document.createElement("div");s.classList.add("tb"),n.appendChild(s);var d=document.createElement("div");d.classList.add("ub");var o=document.createElement("span");return o.appendChild((0,l.YC)("close")),d.appendChild(o),n.appendChild(d),e.appendChild(n),{element:e,id:t}}function M(t,e,i){function n(t,n,a){function r(t,e){(0,o.aI)(t,".pb").innerText=e.hours}function s(t,e){var i=(0,o.aI)(t,".qb");(0,o.aI)(i,".rb").innerText=e.minutes}function d(t,e){var i=(0,o.aI)(t,".qb");(0,o.aI)(i,".tb").innerText=e.name}function l(t,e){var i=(0,o.aI)(t,".qb");(0,o.aI)(i,".sb").innerText=`${e.route.name} - 往${e.route.direction}`}function c(t,e){var i=(0,o.aI)(t,".qb");(0,o.aI)(i,".ub").onclick=function(){!function(t,e){D.apply(this,arguments)}(t.id,e.schedule_id)}}function p(t,e){t.setAttribute("first",(0,u.xZ)(e.is_first))}function v(t,e){t.setAttribute("animation",(0,u.xZ)(e))}function h(t,e){t.setAttribute("skeleton-screen",(0,u.xZ)(e))}null==a?(r(t,n),s(t,n),d(t,n),l(t,n),c(t,n),p(t,n),v(t,i),h(t,e)):(n.hours!==a.hours&&r(t,n),n.minutes!==a.minutes&&s(t,n),(0,u.hw)(a.schedule_id,n.schedule_id)||(d(t,n),l(t,n),c(t,n)),a.is_first!==n.is_first&&p(t,n),false!==i&&v(t,i),A!==e&&h(t,e))}var a=t.itemQuantity,r=t.items,s=(0,o.jg)(g,".ob").length;if(a!==s){var d=s-a;if(d<0){for(var l=new DocumentFragment,c=0,p=Math.abs(d);c<p;c++){var v=S();l.appendChild(v.element)}g.append(l)}else for(var h=(0,o.jg)(g,".ob"),f=0,m=Math.abs(d);f<m;f++){h[s-1-f].remove()}}for(var b=(0,o.jg)(g,".ob"),I=0;I<a;I++){var j=b[I],x=r[I];if(y.hasOwnProperty("items"))if(y.items[I])n(j,x,y.items[I]);else n(j,x,null);else n(j,x,null)}y=t,A=e}function Z(){return z.apply(this,arguments)}function z(){return(z=(0,n.A)(function*(){var t=(0,d.Js)("playing_animation"),e=(0,d.Js)("refresh_interval");C=e.dynamic,I=e.baseInterval,E=!0,w=(0,u.zx)(),m.setAttribute("refreshing","true"),m.classList.remove("mb"),document.addEventListener(w,$);var i=yield(0,s.e3)(w);M(i,!1,t);var n=0;C&&(n=yield(0,a.wz)()),L=(new Date).getTime(),k=C?Math.max(L+j,i.dataUpdateTime+I/n):L+I,x=Math.max(j,k-L),E=!1,m.setAttribute("refreshing","false"),m.style.setProperty("--lb",`${x}ms`),m.classList.add("mb")})).apply(this,arguments)}function P(){return q.apply(this,arguments)}function q(){return(q=(0,n.A)(function*(){Z().then(function(){_?setTimeout(function(){P()},Math.max(j,k-(new Date).getTime())):T=!1}).catch(function(t){_?setTimeout(function(){P()},1e4):T=!1})})).apply(this,arguments)}function O(){(0,c.WR)("NotificationScheduleManager"),v.setAttribute("displayed","true"),function(){for(var t=(0,d.Js)("playing_animation"),e=(0,c.gO)("window"),i=(e.width,e.height),n=Math.floor(i/50)+5,a=[],r=0;r<n;r++)a.push({name:"",stop_id:0,estimate_time:0,schedule_id:"null",scheduled_time:0,route:{name:"",direction:"",id:0,pathAttributeId:[]},is_first:!0,date:"",hours:"",minutes:""});M({items:a,itemQuantity:n,dataUpdateTime:0},!0,t)}(),_||(_=!0,T?Z():(T=!0,P())),(0,c.Z_)()}function D(){return(D=(0,n.A)(function*(t,e){if((0,p.a)("manufacturing","處理中"),yield(0,r.G)(e)){if((0,o.aI)(g,`.ob#${t}`).remove(),(0,p.a)("check_circle","已取消通知"),!E){var i=(0,d.Js)("playing_animation");M(yield(0,s.e3)(w),!1,i)}}else(0,p.a)("error","取消失敗")})).apply(this,arguments)}},3030(t,e,i){i.d(e,{so:()=>ot});var n=i(467),a=i(5767),r=i(9566),s=i(2757),d=i(77),o=i(5314),u=i(3459),l=i(8179),c=i(7968),p=i(8024),v=i(5579),h=i(4537),f=i(904),m=i(9119),b=i(3041),g=i(752),y=i(1351);function A(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return I(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?I(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,d=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){d=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(d)throw r}}}}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var j=(0,l.bv)(".sh"),x=(0,l.aI)(j,".zh"),C=(0,l.aI)(x,".ci"),L=(0,l.aI)(C,"span"),k=(0,l.aI)(x,".bi"),w=(0,l.aI)(j,".ni"),E=(0,l.aI)(x,".ei"),_=(0,l.aI)(E,".fi"),T=(0,l.aI)(x,".ii"),$=(0,l.aI)(T,".ji"),S=(0,l.aI)(x,".ki .li"),M={},Z=!1,z=!1,P=0,q=0,O={},D=0,R=!1,N=15e3,Q=5e3,J=15e3,H=!0,W=0,Y=0,B="",F=!1,U=!1,X=!1,G="";function K(t,e,i,n){w.style.setProperty("--rh",t.toString()),$.style.setProperty("--uh",i.toString()),_.style.setProperty("--vh",`${e.toString()}px`),_.style.setProperty("--wh",n.toString())}function V(t){var e=t;if(F){var i=e.detail.progress-1;S.style.setProperty("--xh",i.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,V)}function tt(){var t=(0,p.zx)(),e=document.createElement("div");e.classList.add("yi"),e.id=t,e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var i=document.createElement("div");i.classList.add("zi");var n=document.createElement("div");n.classList.add("_i");var a=document.createElement("div");a.classList.add("bj"),a.setAttribute("code","-1"),a.setAttribute("displayed","false");var r=document.createElement("div");r.classList.add("cj"),r.setAttribute("code","-1"),r.setAttribute("displayed","true"),n.appendChild(a),n.appendChild(r);var s=document.createElement("div");s.classList.add("mj");var d=document.createElement("div");d.classList.add("nj");var o=document.createElement("div");o.classList.add("oj");var u=document.createElement("div");u.classList.add("rj");var c=document.createElement("div");c.classList.add("hh"),c.setAttribute("code","0"),c.setAttribute("displayed","false");var v=document.createElement("div");v.classList.add("ih"),v.setAttribute("code","0"),v.setAttribute("displayed","true"),u.appendChild(c),u.appendChild(v);var f=document.createElement("div");f.classList.add("qj"),f.appendChild((0,h.YC)("keyboard_arrow_down")),f.onclick=function(){!function(t){var e=(0,l.aI)(w,`.oi .xi .yi#${t}`),i=(0,l.aI)(e,".sj"),n=e.parentElement,a=(0,l.ji)(e,"yi"),r=a.length,s=n.getBoundingClientRect(),d=e.getBoundingClientRect(),o=d.top-s.top,u="true"===e.getAttribute("stretched"),c="true"===e.getAttribute("animation");if(c){var p=u?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--wi",`${o}px`);for(var v=0;v<r;v++){var h=a[v];h.setAttribute("push-direction",p),h.setAttribute("push-state","1")}e.addEventListener("transitionend",function(){for(var t=0;t<r;t++){var i=a[t];i.setAttribute("push-direction","0"),i.setAttribute("push-state","0")}e.setAttribute("stretching","false")},{once:!0}),e.addEventListener("transitionstart",function(){for(var t=0;t<r;t++){a[t].setAttribute("push-state","2")}},{once:!0})}u?(c?i.addEventListener("transitionend",function(){i.setAttribute("displayed","false")},{once:!0}):i.setAttribute("displayed","false"),e.setAttribute("stretched","false")):(i.setAttribute("displayed","true"),e.setAttribute("stretched","true"))}(t)};var m=document.createElement("div");m.classList.add("pj"),o.appendChild(u),o.appendChild(f),o.appendChild(m),i.appendChild(n),i.appendChild(s),i.appendChild(d),i.appendChild(o);var b=document.createElement("div");b.classList.add("sj"),b.setAttribute("displayed","false");var g=document.createElement("div");g.classList.add("tj");var y=document.createElement("div");y.classList.add("uj"),y.setAttribute("highlighted","true"),y.setAttribute("type","tab"),y.setAttribute("code","0");var A=document.createElement("div");A.classList.add("xj"),A.appendChild((0,h.YC)("directions_bus")),y.appendChild(A),y.appendChild(document.createTextNode("公車")),y.onclick=function(){ut(t,0)};var I=document.createElement("div");I.classList.add("uj"),I.setAttribute("highlighted","false"),I.setAttribute("type","tab"),I.setAttribute("code","1");var j=document.createElement("div");j.classList.add("xj"),j.appendChild((0,h.YC)("departure_board")),I.appendChild(j),I.appendChild(document.createTextNode("抵達時間")),I.onclick=function(){ut(t,1)};var x=document.createElement("div");x.classList.add("uj"),x.setAttribute("highlighted","false"),x.setAttribute("type","save-to-folder");var C=document.createElement("div");C.classList.add("xj"),C.appendChild((0,h.YC)("folder")),x.appendChild(C),x.appendChild(document.createTextNode("儲存"));var L=document.createElement("div");L.classList.add("uj"),L.setAttribute("highlighted","false"),L.setAttribute("type","schedule-notification"),L.setAttribute("enabled","true");var k=document.createElement("div");k.classList.add("xj"),k.appendChild((0,h.YC)("notifications")),L.appendChild(k),L.appendChild(document.createTextNode("通知")),g.appendChild(y),g.appendChild(I),g.appendChild(x),g.appendChild(L);var E=document.createElement("div");E.classList.add("yj"),E.setAttribute("displayed","true");var _=document.createElement("div");return _.classList.add("zj"),_.setAttribute("displayed","false"),b.appendChild(g),b.appendChild(E),b.appendChild(_),e.appendChild(i),e.appendChild(b),{element:e,id:t}}function et(){var t=document.createElement("div");t.classList.add("oi");var e=document.createElement("div");e.classList.add("pi");var i=document.createElement("div");i.classList.add("qi"),e.appendChild(i);var n=document.createElement("div");return n.classList.add("xi"),t.appendChild(e),t.appendChild(n),{element:t,id:""}}function it(){var t=document.createElement("div");t.classList.add("gi");var e=document.createElement("span");return t.appendChild(e),{element:t,id:""}}function nt(){var t=document.createElement("div");t.classList.add("si");var e=document.createElement("div");e.classList.add("ti"),e.appendChild((0,h.oC)());var i=document.createElement("div");return i.classList.add("ui"),t.appendChild(e),t.appendChild(i),{element:t,id:""}}function at(t,e,i){var n,a;function s(t,n,a){function s(t,e,i){var n=t.getBoundingClientRect(),a=n.top,r=n.left,s=n.bottom,d=n.right,o=window.innerWidth,u=window.innerHeight,c=(0,l.aI)(t,".zi"),p=(0,l.aI)(c,".rj"),v=(0,l.aI)(p,".hh"),h=(0,l.aI)(p,".ih");v.setAttribute("code",e.status.code.toString()),v.innerText=e.status.text,i&&s>0&&a<u&&d>0&&r<o?(h.addEventListener("animationend",function(){h.setAttribute("code",e.status.code.toString()),h.innerText=e.status.text,h.classList.remove("kh"),v.setAttribute("displayed","false")},{once:!0}),v.setAttribute("displayed","true"),h.classList.add("kh")):(h.setAttribute("code",e.status.code.toString()),h.innerText=e.status.text)}function o(t,e,i){var n=t.getBoundingClientRect(),a=n.top,r=n.left,s=n.bottom,d=n.right,o=window.innerWidth,u=window.innerHeight,c=(0,l.aI)(t,".zi"),p=(0,l.aI)(c,"._i"),v=(0,l.aI)(p,".bj"),h=(0,l.aI)(p,".cj");v.setAttribute("code",e.ranking.code.toString()),v.innerText=e.ranking.text,i&&s>0&&a<u&&d>0&&r<o?(h.addEventListener("animationend",function(){h.setAttribute("code",e.ranking.code.toString()),h.innerText=e.ranking.text,h.classList.remove("lj"),v.setAttribute("displayed","false")},{once:!0}),v.setAttribute("displayed","true"),h.classList.add("lj")):(h.setAttribute("code",e.ranking.code.toString()),h.innerText=e.ranking.text)}function u(t,e){var i=(0,l.aI)(t,".zi");(0,l.aI)(i,".mj").innerText=e.route_direction}function c(t,e){var i=(0,l.aI)(t,".zi");(0,l.aI)(i,".nj").innerText=e.route_name}function f(t,e){var i=(0,l.aI)(t,".sj");(0,l.aI)(i,".yj").innerHTML=0===e.buses.length?'<div class="rk">目前沒有公車可顯示</div>':e.buses.map(function(t){return`<div class="_j" on-this-route="${t.onThisRoute}"><div class="bk"><div class="dk">${(0,h.Zf)("directions_bus")}</div><div class="fk">${t.carNumber}</div></div><div class="ik"><div class="mk">路線：${t.RouteName}</div><div class="nk">狀態：${t.status.text}</div><div class="ok">類型：${t.type}</div></div></div>`}).join("")}function m(t,e){var i=(0,l.aI)(t,".sj");(0,l.aI)(i,".zj").innerHTML=0===e.busArrivalTimes.length?'<div class="sk">目前沒有抵達時間可顯示</div>':e.busArrivalTimes.map(function(t){return`<div class="ak"><div class="ck"><div class="ek">${(0,h.Zf)("calendar_view_day")}</div><div class="gk">${t.personalSchedule.name}</div><div class="hk">週${(0,v.kd)(t.day).name} ${(0,v.pn)(t.personalSchedule.period.start)} - ${(0,v.pn)(t.personalSchedule.period.end)}</div></div><div class="jk">${t.chart}</div></div>`}).join("")}function y(t,e){e&&t.setAttribute("stretched","false")}function A(t,e){t.setAttribute("animation",(0,p.xZ)(e))}function I(t,e){t.setAttribute("skeleton-screen",(0,p.xZ)(e))}function j(t,e){var i=(0,l.aI)(t,".sj"),n=(0,l.aI)(i,".tj"),a=(0,l.aI)(n,'.uj[type="save-to-folder"]');a.onclick=function(){(0,b.B)("stop-on-location",[t.id,e.stopId,e.routeId])},(0,r.LH)("stop",e.stopId).then(function(t){a.setAttribute("highlighted",(0,p.xZ)(t))})}function x(t,e){var i=(0,l.aI)(t,".sj"),n=(0,l.aI)(i,".tj"),a=(0,l.aI)(n,'.uj[type="schedule-notification"]');a.onclick=function(){(0,g.Ho)("stop-on-location",[t.id,e.stopId,e.routeId,e.status.time])};var r=(0,d.Zc)(e.stopId);a.setAttribute("highlighted",(0,p.xZ)(r))}null==a?(s(t,n,i),o(t,n,i),u(t,n),c(t,n),f(t,n),m(t,n),y(t,e),A(t,i),I(t,e),j(t,n),x(t,n)):(n.status.time!==a.status.time&&(s(t,n,i),x(t,n)),a.ranking.number===n.ranking.number&&a.ranking.code===n.ranking.code||o(t,n,i),a.stopId!==n.stopId&&(u(t,n),c(t,n),j(t,n)),(0,p.hw)(a.buses,n.buses)||f(t,n),(0,p.hw)(a.busArrivalTimes,n.busArrivalTimes)||m(t,n),i!==Z&&A(t,i),e!==z&&(y(t,e),I(t,e)))}function o(t,n,a){function r(t,e){var i=(0,l.aI)(t,".ti");(0,h.yD)(i,e.icon)}function s(t,e){(0,l.aI)(t,".ui").innerHTML=e.value}function d(t,e){t.setAttribute("animation",(0,p.xZ)(e))}function o(t,e){t.setAttribute("skeleton-screen",(0,p.xZ)(e))}null==a?(r(t,n),s(t,n),d(t,i),o(t,e)):((0,p.hw)(a.icon,n.icon)||r(t,n),(0,p.hw)(a.value,n.value)||s(t,n),i!==Z&&d(t,i),e!==z&&o(t,e))}var u=(0,f.gO)("window"),m=u.width,A=u.height,I=t.groupQuantity,j=t.itemQuantity,x=t.groupedItems,$=t.groups;q=I,D=m;for(var S=0,N=0;N<I;N++){var Q=`g_${N}`,J=(0,c.q_)($[Q].name,500,"17px",'"Noto Sans TC", sans-serif')+20;O[Q]={width:J,offset:S},S+=J}if(O[`g_${I}`]={width:0,offset:S},!R){var H=O[`g_${P}`],W=-1*H.offset+.5*D-.5*H.width,Y=H.width-20;K(q,W,Y,P)}(null===(n=M)||void 0===n?void 0:n.hash)!==t.hash&&(k.onclick=function(){(0,y.ID)(t.hash)}),(null===(a=M)||void 0===a?void 0:a.LocationName)!==t.LocationName&&(L.innerText=t.LocationName),Z!==i&&(C.setAttribute("animation",(0,p.xZ)(i)),E.setAttribute("animation",(0,p.xZ)(i))),z!==e&&(C.setAttribute("skeleton-screen",(0,p.xZ)(e)),E.setAttribute("skeleton-screen",(0,p.xZ)(e)),T.setAttribute("skeleton-screen",(0,p.xZ)(e)));var B=(0,l.jg)(w,".oi").length;if(I!==B){var F=B-I;if(F<0){for(var U=new DocumentFragment,X=new DocumentFragment,G=0,V=Math.abs(F);G<V;G++){var at=et();U.appendChild(at.element);var rt=it();X.appendChild(rt.element)}w.append(U),_.append(X)}else for(var st=(0,l.jg)(w,".oi"),dt=(0,l.jg)(_,".gi"),ot=0,ut=Math.abs(F);ot<ut;ot++){var lt=B-1-ot;st[lt].remove(),dt[lt].remove()}}for(var ct=(0,l.jg)(w,".oi"),pt=0;pt<I;pt++){var vt=`g_${pt}`,ht=ct[pt],ft=(0,l.jg)(ht,".xi .yi").length;if(j[vt]!==ft){var mt=ft-j[vt];if(mt<0)for(var bt=(0,l.aI)(ht,".xi"),gt=0,yt=Math.abs(mt);gt<yt;gt++){var At=tt();bt.appendChild(At.element)}else for(var It=(0,l.jg)(ht,".xi .yi"),jt=0,xt=Math.abs(mt);jt<xt;jt++){It[ft-1-jt].remove()}}var Ct=(0,l.jg)((0,l.jg)(w,".oi")[pt],".pi .qi .si").length,Lt=$[vt].properties.length;if(Lt!==Ct){var kt=Ct-Lt;if(kt<0)for(var wt=(0,l.aI)(ht,".pi"),Et=(0,l.aI)(wt,".qi"),_t=0,Tt=Math.abs(kt);_t<Tt;_t++){var $t=nt();Et.appendChild($t.element)}else for(var St=(0,l.aI)(ht,".pi"),Mt=(0,l.aI)(St,".qi"),Zt=(0,l.jg)(Mt,".si"),zt=0,Pt=Math.abs(kt);zt<Pt;zt++){Zt[Ct-1-zt].remove()}}}for(var qt=(0,l.jg)(_,".gi"),Ot=(0,l.jg)(w,".oi"),Dt=0;Dt<I;Dt++){var Rt=`g_${Dt}`,Nt=qt[Dt];(0,l.aI)(Nt,"span").innerText=$[Rt].name,Nt.style.setProperty("--th",`${O[Rt].width}px`),Nt.style.setProperty("--hi",Dt.toString());for(var Qt=Ot[Dt],Jt=(0,l.jg)(Qt,".pi .qi .si"),Ht=(0,l.jg)(Qt,".xi .yi"),Wt=$[Rt].properties.length,Yt=0;Yt<Wt;Yt++){var Bt=$[Rt].properties[Yt],Ft=Jt[Yt];if(M.hasOwnProperty("groups"))if(M.groups.hasOwnProperty(Rt))if(M.groups[Rt].properties[Yt])o(Ft,Bt,M.groups[Rt].properties[Yt]);else o(Ft,Bt,null);else o(Ft,Bt,null);else o(Ft,Bt,null)}for(var Ut=0;Ut<j[Rt];Ut++){var Xt=Ht[Ut],Gt=x[Rt][Ut];if(M.hasOwnProperty("groupedItems"))if(M.groupedItems.hasOwnProperty(Rt))if(M.groupedItems[Rt][Ut])s(Xt,Gt,M.groupedItems[Rt][Ut]);else s(Xt,Gt,null);else s(Xt,Gt,null);else s(Xt,Gt,null)}}M=t,Z=i,z=e}function rt(){return st.apply(this,arguments)}function st(){return(st=(0,n.A)(function*(){var t=(0,u.Js)("playing_animation"),e=(0,u.Js)("refresh_interval"),i=(0,f.gO)("location-bus-arrival-time-chart");H=e.dynamic,N=e.baseInterval,F=!0,B=(0,p.zx)(),S.setAttribute("refreshing","true"),S.classList.remove("mi"),document.addEventListener(B,V);var n=yield(0,s.R)(G,i.width,i.height,B);at(n,!1,t);var r=0;H&&(r=yield(0,a.wz)()),W=(new Date).getTime(),Y=H?Math.max(W+Q,n.dataUpdateTime+N/r):W+N,J=Math.max(Q,Y-W),F=!1,S.setAttribute("refreshing","false"),S.style.setProperty("--yh",`${J}ms`),S.classList.add("mi")})).apply(this,arguments)}function dt(){rt().then(function(){U?setTimeout(function(){dt()},Math.max(Q,Y-(new Date).getTime())):X=!1}).catch(function(t){U?((0,m.a)("error","地點網路連線中斷，將在10秒後重試。"),setTimeout(function(){dt()},1e4)):X=!1})}function ot(t){(0,f.WR)("Location"),(0,o.XK)("location",t),G=t,P=0,O={},j.setAttribute("displayed","true"),w.scrollLeft=0,w.focus(),function(t){for(var e=(0,u.Js)("playing_animation"),i=(0,f.gO)("window"),n=(i.width,i.height),a={g_0:Math.floor(n/50)+5,g_1:Math.floor(n/50)+5},r={},s=0;s<2;s++){var d=`g_${s}`;r[d]=[];for(var o=0;o<a[d];o++)r[d].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}at({groupedItems:r,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]}},itemQuantity:a,LocationName:"載入中",hash:t,dataUpdateTime:0},!0,e)}(t),U||(U=!0,X?rt():(X=!0,dt())),(0,f.Z_)()}function ut(t,e){var i,n=(0,l.aI)(w,`.oi .xi .yi#${t}`),a=(0,l.aI)(n,".sj"),r=(0,l.aI)(a,".tj"),s=A((0,l.jg)(r,'.uj[highlighted="true"][type="tab"]'));try{for(s.s();!(i=s.n()).done;){i.value.setAttribute("highlighted","false")}}catch(t){s.e(t)}finally{s.f()}switch((0,l.aI)(r,`.uj[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:(0,l.aI)(n,".yj").setAttribute("displayed","true"),(0,l.aI)(n,".zj").setAttribute("displayed","false");break;case 1:(0,l.aI)(n,".yj").setAttribute("displayed","false"),(0,l.aI)(n,".zj").setAttribute("displayed","true")}}},5693(t,e,i){i.d(e,{Xy:()=>j,bF:()=>I});var n=i(3453),a=i(467),r=i(5352),s=i(8179),d=i(5579),o=i(904),u=(0,s.bv)(".vb"),l=(0,s.aI)(u,".wb"),c=(0,s.aI)(u,".xb"),p=(0,s.aI)(c,".yb"),v=(0,s.aI)(l,".zb"),h=(0,s.aI)(v,'._b[group="schedule-name"] .ac input'),f=(0,s.aI)(v,'._b[group="schedule-start-time"] .ac input'),m=(0,s.aI)(v,'._b[group="schedule-end-time"] .ac input'),b=(0,s.aI)(v,'._b[group="schedule-days"] .ac'),g=(0,s.jg)(b,".bc");function y(){return(y=(0,a.A)(function*(t){for(var e=h.value,i=f.value,a=m.value,s=String(i).split(":").map(function(t){return parseInt(t)}),d=(0,n.A)(s,2),o=d[0],u=d[1],l=String(a).split(":").map(function(t){return parseInt(t)}),c=(0,n.A)(l,2),p=c[0],v=c[1],b=[],y=0;y<7;y++){var A=g[y],I=A.getAttribute("highlighted"),x=parseInt(A.getAttribute("day"));"true"===I&&b.push(x)}var C=yield(0,r.qZ)(t);C.name=e,C.days=b,C.period.start.hours=o,C.period.start.minutes=u,C.period.end.hours=p,C.period.end.minutes=v,yield(0,r.nL)(C),j()})).apply(this,arguments)}function A(){return A=(0,a.A)(function*(t){var e=yield(0,r.qZ)(t);h.value=e.name,f.value=(0,d.pn)(e.period.start),m.value=(0,d.pn)(e.period.end);for(var i=0;i<7;i++){var n=g[i];e.days.indexOf(i)>-1?n.setAttribute("highlighted","true"):n.setAttribute("highlighted","false")}p.onclick=function(){!function(t){y.apply(this,arguments)}(t)}}),A.apply(this,arguments)}function I(t){(0,o.WR)("PersonalScheduleEditor"),u.setAttribute("displayed","true"),function(t){A.apply(this,arguments)}(t),(0,o.Z_)()}function j(){u.setAttribute("displayed","false"),(0,o.l$)()}},8279(t,e,i){i.d(e,{X8:()=>o});var n=i(8179),a=i(2648),r=i(904),s=(0,n.bv)(".pc"),d=(0,n.aI)(s,".qc");function o(t){(0,r.WR)("QRCode"),s.setAttribute("displayed","true"),function(t){var e=(0,a.$)(t,"M",.5,.3,1,"var(--j)",4);d.innerHTML=e}(t)}}}]);
//# sourceMappingURL=d63b44995a5b2dfbd004.js.map