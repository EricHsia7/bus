"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[36],{904:(e,t,n)=>{n.d(t,{AE:()=>k,BM:()=>I,WR:()=>y,Z_:()=>A,f1:()=>C,gO:()=>x,kr:()=>w,l$:()=>L,p9:()=>E});var a=n(8024),i=n(3648),r=n(4927),o=n(6052),s=n(9333),d=n(8379),c=n(5693),l=n(7891),u=n(7908),f=n(5009),v=n(6104),p=(0,i.bv)(".ng"),h=(0,i.bv)(".og"),m=100,g=(new Date).getTime(),b=["Home"];function y(e){var t=b.length;b[t-1]!==e&&b.push(e)}function w(e){if(b.indexOf(e)>-1){var t=b.length;b[t-1]===e&&b.pop()}}function A(){var e=b.length;if(e>1)switch(b[e-2]){case"Home":case"FolderIconSelector":case"Location":case"LocationDetails":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":case"QRCode":default:break;case"FolderCreator":(0,o.z1)();break;case"FolderEditor":(0,s.I6)();break;case"FolderManager":(0,d.m)();break;case"Search":(0,f.Bb)();break;case"Settings":(0,v.os)();break;case"PersonalScheduleManager":(0,l.Z)();break;case"PersonalScheduleEditor":(0,c.Xy)();break;case"Bus":(0,r.F)();break;case"RegisterNotification":(0,u.hy)()}}function L(){var e=b.length;if(e>1){var t=b[e-2];switch(b.pop(),t){case"Home":case"FolderIconSelector":case"Location":case"LocationDetails":case"Route":case"RouteDetails":case"SaveToFolder":case"SettingsOptions":case"DataUsage":case"PersonalScheduleCreator":case"ScheduleNotification":case"NotificationScheduleManager":case"QRCode":default:break;case"FolderCreator":(0,o.pd)();break;case"FolderEditor":(0,s.uy)();break;case"FolderManager":(0,d.g)();break;case"Search":(0,f.rf)();break;case"Settings":(0,v.Ow)();break;case"PersonalScheduleManager":(0,l.z)();break;case"PersonalScheduleEditor":(0,c.bF)();break;case"Bus":(0,r.$)();break;case"RegisterNotification":(0,u.XG)()}}}function I(){var e=0;(0,a.t9)()&&(e=-1*(window.outerHeight-window.innerHeight)/2),(0,i.bv)(".ng svg.pg").style.setProperty("--qg",`${e}px`)}function k(e){function t(){p.classList.add("rg"),p.addEventListener("animationend",(function(){p.setAttribute("displayed","false"),p.classList.remove("rg"),"function"==typeof e&&e()}),{once:!0})}var n=(new Date).getTime();n-g<m?setTimeout(t,Math.max(1,n-g)):t()}function C(){h.setAttribute("displayed","true")}function x(e){var t=0,n=0,a=window.innerWidth,i=window.innerHeight;switch(e){case"window":t=a,n=i;break;case"head":t=a,n=55;break;case"head-one-button":t=a-55,n=55;break;case"head-two-button":t=a-110,n=55;break;case"route-details-canvas":t=a-20-20,n=1680;break;case"route-bus-arrival-time-chart":t=a-45-15-20,n=75;break;case"location-bus-arrival-time-chart":t=a-30-20,n=75;break;default:t=0,n=0}return{width:t,height:n}}function E(){window.scrollTo({top:0,behavior:"instant"})}},1351:(e,t,n)=>{n.d(t,{ID:()=>C,co:()=>x,k9:()=>E,qp:()=>T});var a=n(8011),i=n(6788),r=n(6983),o=n(3459),s=n(8024),d=n(9469),c=n(3648),l=n(4537),u=n(904),f=n(9119),v=n(8279);function p(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){p(r,a,i,o,s,"next",e)}function s(e){p(r,a,i,o,s,"throw",e)}o(void 0)}))}}var m={},g=!0,b=!1,y=(0,c.bv)(".sg"),w=(0,c.aI)(y,".tg"),A=(0,c.aI)(w,".ug");function L(){var e=document.createElement("div");e.classList.add("vg");var t=document.createElement("div");t.classList.add("wg"),e.appendChild(t);var n=document.createElement("div");return n.classList.add("xg"),e.appendChild(n),{element:e,id:""}}function I(e,t,n){function a(e,a,i){function r(e,t){(0,c.aI)(e,".wg").innerHTML=(0,l.Z)(t.icon)}function o(e,t){(0,c.aI)(e,".xg").innerText=t.name}function d(e,t){e.onclick=t.action}function u(e,t){e.setAttribute("animation",(0,s.xZ)(t))}function f(e,t){e.setAttribute("skeleton-screen",(0,s.xZ)(t))}null===i?(r(e,a),o(e,a),d(e,a),u(e,n),f(e,t)):(i.key!==a.key&&(r(e,a),o(e,a),d(e,a)),n!==g&&u(e,n),t!==b&&f(e,t))}var i=e.actions,r=e.actionsQuantity,o=(0,c.jg)(A,".vg").length;if(r!==o){var d=o-r;if(d<0){for(var u=new DocumentFragment,f=0;f<Math.abs(d);f++){var v=L();u.appendChild(v.element)}A.append(u)}else for(var p=(0,c.jg)(A,".vg"),h=0;h<Math.abs(d);h++){p[o-1-h].remove()}}for(var y=(0,c.jg)(A,".vg"),w=0;w<r;w++){var I=y[w],k=i[w];if(m.hasOwnProperty("actions"))if(m.actions[w])a(I,k,m.actions[w]);else a(I,k,null);else a(I,k,null)}m=e,g=n,b=t}function k(){return(k=h((function*(e){var t=(0,o.Js)("playing_animation"),n=(0,s.zx)();I(yield(0,r.v)(e,n),!1,t)}))).apply(this,arguments)}function C(e){(0,u.WR)("LocationDetails"),y.setAttribute("displayed","true"),function(){for(var e=(0,o.Js)("playing_animation"),t=[],n=0;n<3;n++)t.push({name:"",icon:"",key:`action-${n}`,action:function(){}});I({actions:t,actionsQuantity:3,hash:""},!0,e)}(),function(e){k.apply(this,arguments)}(e)}function x(){(0,u.kr)("LocationDetails"),y.setAttribute("displayed","false")}function E(e){return _.apply(this,arguments)}function _(){return(_=h((function*(e){var t=(0,s.zx)(),n=yield(0,a.g)(t,1);(0,i.LQ)(t),(0,i.gC)(t);var r=`ml_${e}`;if(n.hasOwnProperty(r)){var o=n[r],c=(0,d.i)(1,{hash:e});navigator.share&&navigator.share({title:o.n,url:c}).then((function(){(0,f.a)("已分享地點連結","link")})).catch((function(e){(0,f.a)("已取消分享連結","cancel")}))}}))).apply(this,arguments)}function T(e){return S.apply(this,arguments)}function S(){return(S=h((function*(e){var t=(0,s.zx)(),n=yield(0,a.g)(t,1);(0,i.LQ)(t),(0,i.gC)(t);var r=`ml_${e}`;if(n.hasOwnProperty(r)){var o=(0,d.i)(1,{hash:e});(0,v.X8)(o)}}))).apply(this,arguments)}},3030:(e,t,n)=>{n.d(t,{eS:()=>ue,s_:()=>ee,so:()=>le});var a=n(5767),i=n(9566),r=n(2757),o=n(77),s=n(5314),d=n(3459),c=n(7968),l=n(8024),u=n(3648),f=n(5579),v=n(4537),p=n(904),h=n(9119),m=n(3041),g=n(752),b=n(1351);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function A(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}var L=(0,u.bv)(".yg"),I=(0,u.aI)(L,".zg"),k=(0,u.aI)(I,"._g"),C=(0,u.aI)(I,".ah"),x=(0,u.aI)(L,".bh"),E=(0,u.aI)(I,".ch"),_=(0,u.aI)(E,".dh"),T=(0,u.aI)(I,".eh"),S=(0,u.aI)(T,".fh"),M=(0,u.aI)(I,".gh .hh"),$={},j=!0,P=!1,Z=0,H=0,F=0,D={},N=0,R=!1,z=1e4,O=15e3,B=5e3,Q=15e3,W=!0,q=0,U=0,J="",X=!1,G=!1,K=!1,V="",Y=20;function ee(){x.addEventListener("touchstart",(function(){Z=Math.round(x.scrollLeft/N)}),{passive:!0}),x.addEventListener("scroll",(function(e){R=!0;var t=e.target.scrollLeft/N;H=t>Z?Z+1:Z-1;var n=D[`g_${Z}`]||{width:0,offset:0},a=D[`g_${H}`]||{width:0,offset:0},i=n.width+(a.width-n.width)*Math.abs(t-Z),r=-1*(n.offset+(a.offset-n.offset)*Math.abs(t-Z))+.5*N-.5*i;te(F,r,i-Y,t),t===H&&(Z=Math.round(x.scrollLeft/N),R=!1)}),{passive:!0})}function te(e,t,n,a){x.style.setProperty("--ih",e.toString()),S.style.setProperty("--jh",n.toString()),_.style.setProperty("--kh",`${t.toFixed(5)}px`),_.style.setProperty("--lh",a.toFixed(5))}function ne(e){var t=e;if(X){var n=t.detail.progress-1;M.style.setProperty("--oh",n.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,ne)}function ae(){var e=(0,l.zx)(),t=document.createElement("div");t.classList.add("ph"),t.id=e,t.setAttribute("stretched","false"),t.setAttribute("stretching","false"),t.setAttribute("push-direction","0"),t.setAttribute("push-state","0");var n=document.createElement("div");n.classList.add("qh");var a=document.createElement("div");a.classList.add("rh");var i=document.createElement("div");i.classList.add("sh"),i.setAttribute("code","-1"),i.setAttribute("displayed","false");var r=document.createElement("div");r.classList.add("th"),r.setAttribute("code","-1"),r.setAttribute("displayed","true"),a.appendChild(i),a.appendChild(r);var o=document.createElement("div");o.classList.add("uh");var s=document.createElement("div");s.classList.add("vh");var d=document.createElement("div");d.classList.add("wh");var c=document.createElement("div");c.classList.add("xh");var f=document.createElement("div");f.classList.add("_a"),f.setAttribute("code","0"),f.setAttribute("displayed","false");var p=document.createElement("div");p.classList.add("ab"),p.setAttribute("code","0"),p.setAttribute("displayed","true"),c.appendChild(f),c.appendChild(p);var h=document.createElement("div");h.classList.add("yh"),h.innerHTML=(0,v.Z)("keyboard_arrow_down"),h.onclick=function(){!function(e){var t=(0,u.aI)(x,`.fi .ii .ph#${e}`),n=(0,u.aI)(t,"._h"),a=t.parentElement,i=(0,u.ji)(t,"ph"),r=i.length,o=a.getBoundingClientRect(),s=t.getBoundingClientRect(),d=s.top-o.top,c="true"===t.getAttribute("stretched"),l="true"===t.getAttribute("animation");if(l){var f=c?"2":"1";t.setAttribute("stretching","true"),t.style.setProperty("--gj",`${d}px`);for(var v=0;v<r;v++){var p=i[v];p.setAttribute("push-direction",f),p.setAttribute("push-state","1")}t.addEventListener("transitionend",(function(){for(var e=0;e<r;e++){var n=i[e];n.setAttribute("push-direction","0"),n.setAttribute("push-state","0")}t.setAttribute("stretching","false")}),{once:!0}),t.addEventListener("transitionstart",(function(){for(var e=0;e<r;e++){i[e].setAttribute("push-state","2")}}),{once:!0})}c?(l?n.addEventListener("transitionend",(function(){n.setAttribute("displayed","false")}),{once:!0}):n.setAttribute("displayed","false"),t.setAttribute("stretched","false")):(n.setAttribute("displayed","true"),t.setAttribute("stretched","true"))}(e)};var b=document.createElement("div");b.classList.add("zh"),d.appendChild(c),d.appendChild(h),d.appendChild(b),n.appendChild(a),n.appendChild(o),n.appendChild(s),n.appendChild(d);var y=document.createElement("div");y.classList.add("_h"),y.setAttribute("displayed","false");var w=document.createElement("div");w.classList.add("ai");var A=document.createElement("div");A.classList.add("bi"),A.setAttribute("highlighted","true"),A.setAttribute("type","tab"),A.setAttribute("code","0");var L=document.createElement("div");L.classList.add("ci"),L.innerHTML=(0,v.Z)("directions_bus"),A.appendChild(L),A.appendChild(document.createTextNode("公車")),A.onclick=function(){fe(e,0)};var I=document.createElement("div");I.classList.add("bi"),I.setAttribute("highlighted","false"),I.setAttribute("type","tab"),I.setAttribute("code","1");var k=document.createElement("div");k.classList.add("ci"),k.innerHTML=(0,v.Z)("departure_board"),I.appendChild(k),I.appendChild(document.createTextNode("抵達時間")),I.onclick=function(){fe(e,1)};var C=document.createElement("div");C.classList.add("bi"),C.setAttribute("highlighted","false"),C.setAttribute("type","save-to-folder");var E=document.createElement("div");E.classList.add("ci"),E.innerHTML=(0,v.Z)("folder"),C.appendChild(E),C.appendChild(document.createTextNode("儲存")),C.onclick=function(){(0,m.BI)("stop-on-location",[e,null,null])};var _=document.createElement("div");_.classList.add("bi"),_.setAttribute("highlighted","false"),_.setAttribute("type","schedule-notification"),_.setAttribute("enabled","true");var T=document.createElement("div");T.classList.add("ci"),T.innerHTML=(0,v.Z)("notifications"),_.appendChild(T),_.appendChild(document.createTextNode("到站通知")),_.onclick=function(){(0,g.Ho)("stop-on-location",[e,null,null,null])},w.appendChild(A),w.appendChild(I),w.appendChild(C),w.appendChild(_);var S=document.createElement("div");S.classList.add("di"),S.setAttribute("displayed","true");var M=document.createElement("div");return M.classList.add("ei"),M.setAttribute("displayed","false"),y.appendChild(w),y.appendChild(S),y.appendChild(M),t.appendChild(n),t.appendChild(y),{element:t,id:e}}function ie(){var e=document.createElement("div");e.classList.add("fi");var t=document.createElement("div");t.classList.add("gi");var n=document.createElement("div");n.classList.add("hi"),t.appendChild(n);var a=document.createElement("div");return a.classList.add("ii"),e.appendChild(t),e.appendChild(a),{element:e,id:""}}function re(){var e=document.createElement("div");e.classList.add("ki");var t=document.createElement("div");t.classList.add("li");var n=document.createElement("div");return n.classList.add("mi"),e.appendChild(t),e.appendChild(n),{element:e,id:""}}function oe(e,t,n){function a(e,a,r){function s(e,t,n){var a=e.getBoundingClientRect(),i=a.top,r=a.left,o=a.bottom,s=a.right,d=window.innerWidth,c=window.innerHeight,l=(0,u.aI)(e,".xh"),f=(0,u.aI)(l,"._a"),v=(0,u.aI)(l,".ab");f.setAttribute("code",t.status.code.toString()),f.innerText=t.status.text,n&&o>0&&i<c&&s>0&&r<d?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,v.classList.remove("kb"),f.setAttribute("displayed","false")}),{once:!0}),f.setAttribute("displayed","true"),v.classList.add("kb")):(v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text)}function d(e,t,n){var a=e.getBoundingClientRect(),i=a.top,r=a.left,o=a.bottom,s=a.right,d=window.innerWidth,c=window.innerHeight,l=(0,u.aI)(e,".rh"),f=(0,u.aI)(l,".sh"),v=(0,u.aI)(l,".th");f.setAttribute("code",t.ranking.code.toString()),f.innerText=t.ranking.text,n&&o>0&&i<c&&s>0&&r<d?(v.addEventListener("animationend",(function(){v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text,v.classList.remove("ni"),f.setAttribute("displayed","false")}),{once:!0}),f.setAttribute("displayed","true"),v.classList.add("ni")):(v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text)}function c(e,t){(0,u.aI)(e,".uh").innerText=t.route_direction}function p(e,t){(0,u.aI)(e,".vh").innerText=t.route_name}function h(e,t){(0,u.aI)(e,".di").innerHTML=0===t.buses.length?'<div class="oi">目前沒有公車可顯示</div>':t.buses.map((function(e){return`<div class="pi" on-this-route="${e.onThisRoute}"><div class="qi"><div class="ri">${(0,v.Z)("directions_bus")}</div><div class="si">${e.carNumber}</div></div><div class="ti"><div class="ui">路線：${e.RouteName}</div><div class="vi">狀態：${e.status.text}</div><div class="wi">類型：${e.type}</div></div></div>`})).join("")}function b(e,t){(0,u.aI)(e,".ei").innerHTML=0===t.busArrivalTimes.length?'<div class="xi">目前沒有抵達時間可顯示</div>':t.busArrivalTimes.map((function(e){return`<div class="yi"><div class="zi"><div class="_i">${(0,v.Z)("calendar_view_day")}</div><div class="aj">${e.personalSchedule.name}</div><div class="bj">週${(0,f.kd)(e.day).name} ${(0,f.pn)(e.personalSchedule.period.start)} - ${(0,f.pn)(e.personalSchedule.period.end)}</div></div><div class="cj">${e.chart}</div></div>`})).join("")}function y(e,t){t&&e.setAttribute("stretched","false")}function w(e,t){e.setAttribute("animation",(0,l.xZ)(t))}function A(e,t){e.setAttribute("skeleton-screen",(0,l.xZ)(t))}function L(e,t){var n=(0,u.aI)(e,"._h"),a=(0,u.aI)(n,".ai"),r=(0,u.aI)(a,'.bi[type="save-to-folder"]');r.onclick=function(){(0,m.BI)("stop-on-location",[e.id,t.stopId,t.routeId])},(0,i.LH)("stop",t.stopId).then((function(e){r.setAttribute("highlighted",(0,l.xZ)(e))}))}function I(e,t){var n=(0,u.aI)(e,"._h"),a=(0,u.aI)(n,".ai"),i=(0,u.aI)(a,'.bi[type="schedule-notification"]');i.onclick=function(){(0,g.Ho)("stop-on-location",[e.id,t.stopId,t.routeId,t.status.time])};var r=(0,o.Zc)(t.stopId);i.setAttribute("highlighted",(0,l.xZ)(r))}null===r?(s(e,a,n),d(e,a,n),c(e,a),p(e,a),h(e,a),b(e,a),y(e,t),w(e,n),A(e,t),L(e,a),I(e,a)):(a.status.time!==r.status.time&&(s(e,a,n),I(e,a)),r.ranking.number===a.ranking.number&&r.ranking.code===a.ranking.code||d(e,a,n),r.stopId!==a.stopId&&(c(e,a),p(e,a),L(e,a)),(0,l.hw)(r.buses,a.buses)||h(e,a),(0,l.hw)(r.busArrivalTimes,a.busArrivalTimes)||b(e,a),n!==j&&w(e,n),t!==P&&(y(e,t),A(e,t)))}function r(e,a,i){function r(e,t){(0,u.aI)(e,".li").innerHTML=(0,v.Z)(t.icon)}function o(e,t){(0,u.aI)(e,".mi").innerHTML=t.value}function s(e,t){e.setAttribute("animation",(0,l.xZ)(t))}function d(e,t){e.setAttribute("skeleton-screen",(0,l.xZ)(t))}null===i?(r(e,a),o(e,a),s(e,n),d(e,t)):((0,l.hw)(i.icon,a.icon)||r(e,a),(0,l.hw)(i.value,a.value)||o(e,a),n!==j&&s(e,n),t!==P&&d(e,t))}var s=(0,p.gO)("window"),d=s.width,h=s.height,y=e.groupQuantity,w=e.itemQuantity,A=e.groupedItems,L=e.groups;F=y,N=d;for(var I=0,S=0;S<y;S++){var M=(0,c.q_)(L[`g_${S}`].name,500,"17px",'"Noto Sans TC", sans-serif')+Y;D[`g_${S}`]={width:M,offset:I},I+=M}var H=-1*D[`g_${Z}`].offset+.5*N-.5*D[`g_${Z}`].width;R||te(F,H,D[`g_${Z}`].width-Y,Z),k.innerHTML=`<span>${e.LocationName}</span>`,k.setAttribute("animation",(0,l.xZ)(n)),k.setAttribute("skeleton-screen",(0,l.xZ)(t)),C.onclick=function(){(0,b.ID)(e.hash)},E.setAttribute("animation",(0,l.xZ)(n)),E.setAttribute("skeleton-screen",(0,l.xZ)(t)),T.setAttribute("skeleton-screen",(0,l.xZ)(t));var z,O=(0,u.jg)(x,".fi").length;if(y!==O){var B=O-y;if(B<0){for(var Q=new DocumentFragment,W=new DocumentFragment,q=0;q<Math.abs(B);q++){var U=ie();Q.appendChild(U.element);var J=(z=void 0,(z=document.createElement("div")).classList.add("ji"),{element:z,id:""});W.appendChild(J.element)}x.append(Q),_.append(W)}else for(var X=(0,u.jg)(x,".fi"),G=(0,u.jg)(_,".ji"),K=0;K<Math.abs(B);K++){var V=O-1-K;X[V].remove(),G[V].remove()}}for(var ee=(0,u.jg)(x,".fi"),ne=0;ne<y;ne++){var oe=`g_${ne}`,se=ee[ne],de=(0,u.jg)(se,".ii .ph").length;if(w[oe]!==de){var ce=de-w[oe];if(ce<0)for(var le=(0,u.aI)(se,".ii"),ue=0;ue<Math.abs(ce);ue++){var fe=ae();le.appendChild(fe.element)}else for(var ve=(0,u.jg)(se,".ii .ph"),pe=0;pe<Math.abs(ce);pe++){ve[de-1-pe].remove()}}var he=(0,u.jg)((0,u.jg)(x,".fi")[ne],".gi .hi .ki").length,me=L[oe].properties.length;if(me!==he){var ge=he-me;if(ge<0)for(var be=(0,u.aI)(se,".gi"),ye=(0,u.aI)(be,".hi"),we=0;we<Math.abs(ge);we++){var Ae=re();ye.appendChild(Ae.element)}else for(var Le=(0,u.aI)(se,".gi"),Ie=(0,u.aI)(Le,".hi"),ke=(0,u.jg)(Ie,".ki"),Ce=0;Ce<Math.abs(ge);Ce++){ke[he-1-Ce].remove()}}}for(var xe=(0,u.jg)(_,".ji"),Ee=(0,u.jg)(x,".fi"),_e=0;_e<y;_e++){var Te=`g_${_e}`,Se=xe[_e];Se.innerHTML=`<span>${L[Te].name}</span>`,Se.style.setProperty("--dj",`${D[Te].width}px`),Se.style.setProperty("--ej",_e.toString());for(var Me=Ee[_e],$e=(0,u.jg)(Me,".gi .hi .ki"),je=(0,u.jg)(Me,".ii .ph"),Pe=L[Te].properties.length,Ze=0;Ze<Pe;Ze++){var He=L[Te].properties[Ze],Fe=$e[Ze];if($.hasOwnProperty("groups"))if($.groups.hasOwnProperty(Te))if($.groups[Te].properties[Ze])r(Fe,He,$.groups[Te].properties[Ze]);else r(Fe,He,null);else r(Fe,He,null);else r(Fe,He,null)}for(var De=0;De<w[Te];De++){var Ne=je[De],Re=A[Te][De];if($.hasOwnProperty("groupedItems"))if($.groupedItems.hasOwnProperty(Te))if($.groupedItems[Te][De])a(Ne,Re,$.groupedItems[Te][De]);else a(Ne,Re,null);else a(Ne,Re,null);else a(Ne,Re,null)}}$=e,j=n,P=t}function se(){return de.apply(this,arguments)}function de(){var e;return e=function*(){var e=(0,d.Js)("playing_animation"),t=(0,d.Js)("refresh_interval"),n=(0,p.gO)("location-bus-arrival-time-chart");W=t.dynamic,O=t.baseInterval,X=!0,J=(0,l.zx)(),M.setAttribute("refreshing","true"),M.classList.remove("nh"),document.addEventListener(J,ne);var i=yield(0,r.R)(V,n.width,n.height,J);oe(i,!1,e);var o=0;W&&(o=yield(0,a.wz)()),q=(new Date).getTime(),U=W?Math.max(q+B,i.dataUpdateTime+O/o):q+O,Q=Math.max(B,U-q),X=!1,M.setAttribute("refreshing","false"),M.style.setProperty("--mh",`${Q}ms`),M.classList.add("nh")},de=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){A(r,a,i,o,s,"next",e)}function s(e){A(r,a,i,o,s,"throw",e)}o(void 0)}))},de.apply(this,arguments)}function ce(){se().then((function(){G?setTimeout((function(){ce()}),Math.max(B,U-(new Date).getTime())):K=!1})).catch((function(e){G?((0,h.a)(`地點網路連線中斷，將在${z/1e3}秒後重試。`,"error"),setTimeout((function(){ce()}),z)):K=!1}))}function le(e){(0,p.WR)("Location"),(0,s.XK)("location",e),V=e,Z=0,L.setAttribute("displayed","true"),x.scrollLeft=0,function(){for(var e=(0,d.Js)("playing_animation"),t=(0,p.gO)("window"),n=(t.width,t.height),a={g_0:Math.floor(n/50)+5,g_1:Math.floor(n/50)+5},i={},r=0;r<2;r++){var o=`g_${r}`;i[o]=[];for(var s=0;s<a[o];s++)i[o].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}oe({groupedItems:i,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]}},itemQuantity:a,LocationName:"載入中",hash:"",dataUpdateTime:0},!0,e)}(),G||(G=!0,K?se():(K=!0,ce())),(0,p.Z_)()}function ue(){L.setAttribute("displayed","false"),G=!1,(0,p.l$)()}function fe(e,t){var n,a=(0,u.aI)(x,`.fi .ii .ph#${e}`),i=(0,u.aI)(a,"._h"),r=(0,u.aI)(i,".ai"),o=y((0,u.jg)(r,'.bi[highlighted="true"][type="tab"]'));try{for(o.s();!(n=o.n()).done;){n.value.setAttribute("highlighted","false")}}catch(e){o.e(e)}finally{o.f()}switch((0,u.aI)(r,`.bi[code="${t}"]`).setAttribute("highlighted","true"),t){case 0:(0,u.aI)(a,".di").setAttribute("displayed","true"),(0,u.aI)(a,".ei").setAttribute("displayed","false");break;case 1:(0,u.aI)(a,".di").setAttribute("displayed","false"),(0,u.aI)(a,".ei").setAttribute("displayed","true")}}},6052:(e,t,n)=>{n.d(t,{c6:()=>f,pd:()=>v,z1:()=>p});var a=n(9566),i=n(3648),r=n(904),o=n(9119),s=(0,i.bv)(".rf"),d=(0,i.aI)(s,".wf"),c=(0,i.aI)(d,".xf"),l=(0,i.aI)(c,'.yf[group="folder-name"] .bg input'),u=(0,i.aI)(c,'.yf[group="folder-icon"] .bg .cg input');function f(){var e=l.value,t=u.value;(0,a.vV)(e,t).then((function(e){e?(p(),(0,o.a)("已建立資料夾","folder")):(0,o.a)("無法建立資料夾","error")}))}function v(){(0,r.WR)("FolderCreator"),s.setAttribute("displayed","true"),(0,r.Z_)()}function p(){s.setAttribute("displayed","false"),(0,r.l$)()}},6189:(e,t,n)=>{n.d(t,{Pk:()=>L,jW:()=>k,r7:()=>I});var a=n(9930),i=n(6788),r=n(972),o=n(8024),s=n(3648),d=n(4781),c=n(6082),l=n(4537),u=n(904),f=n(9119);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function h(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}var m="",g=(0,s.bv)(".ve"),b=(0,s.bv)(".rf"),y=(0,s.bv)(".i");function w(e){var t=document.createElement("div");return t.classList.add("ig"),t.onclick=function(){!function(e){var t;switch(m){case"editor":t=(0,s.aI)(g,'.ze ._e .af[group="folder-icon"] .ef .gf input');break;case"creator":t=(0,s.aI)(b,'.wf .xf .yf[group="folder-icon"] .bg .cg input')}t.value=e,k()}(e)},t.innerHTML=(0,l.Z)(e),{element:t,id:""}}function A(){var e;return e=function*(){var e=(0,s.aI)(y,".fg .gg");e.innerHTML="";var t=(0,o.zx)(),n=yield(0,a.z)(t);(0,i.LQ)(t);var r,d=new DocumentFragment,c=v(n);try{for(c.s();!(r=c.n()).done;){var l=w(r.value);d.appendChild(l.element)}}catch(e){c.e(e)}finally{c.f()}e.append(d)},A=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){h(r,a,i,o,s,"next",e)}function s(e){h(r,a,i,o,s,"throw",e)}o(void 0)}))},A.apply(this,arguments)}function L(e){var t=(0,s.aI)(y,".fg .hg"),n=(0,s.aI)(y,".fg .gg");if(!(0,d.iO)(e)){var a,i=(0,r.U)(e,100),o=new DocumentFragment,c=v(i);try{for(c.s();!(a=c.n()).done;){var l=w(a.value.item);o.appendChild(l.element)}}catch(e){c.e(e)}finally{c.f()}t.innerHTML="",t.append(o),t.setAttribute("displayed",i.length>0?"true":"false"),n.setAttribute("displayed",i.length>0?"false":"true")}}function I(e){var t;switch((0,u.WR)("FolderIconSelector"),e){case"editor":m="editor",t=(0,s.aI)(g,'.ze ._e .af[group="folder-icon"] .ef .gf .hf');break;case"creator":m="creator",t=(0,s.aI)(b,'.wf .xf .yf[group="folder-icon"] .bg .cg .dg')}"false"===t.getAttribute("disabled")&&(c.m?(y.setAttribute("displayed","true"),function(){A.apply(this,arguments)}(m),(0,r.L)()):(0,f.a)("資料還在下載中","download_for_offline"))}function k(){(0,u.kr)("FolderIconSelector"),y.setAttribute("displayed","false")}},8379:(e,t,n)=>{n.d(t,{g:()=>m,m:()=>g});var a=n(9566),i=n(3648),r=n(9333),o=n(4537),s=n(904);function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function l(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}var u=(0,i.bv)(".je"),f=(0,i.aI)(u,".oe"),v=(0,i.aI)(f,".pe");function p(e){var t=document.createElement("div");t.classList.add("qe"),t.onclick=function(){(0,r.uy)(e.id)};var n=document.createElement("div");n.classList.add("re"),n.innerHTML=(0,o.Z)(e.icon);var a=document.createElement("div");a.classList.add("se"),a.appendChild(document.createTextNode(e.name));var i=document.createElement("div");i.classList.add("te"),i.appendChild(document.createTextNode(String(e.contentLength)));var s=document.createElement("div");return s.classList.add("ue"),s.innerHTML=(0,o.Z)("arrow_forward_ios"),t.appendChild(n),t.appendChild(a),t.appendChild(i),t.appendChild(s),{element:t,id:""}}function h(){var e;return e=function*(){var e=yield(0,a.Xi)();v.innerHTML="";var t,n=new DocumentFragment,i=d(e);try{for(i.s();!(t=i.n()).done;){var r=p(t.value);n.appendChild(r.element)}}catch(e){i.e(e)}finally{i.f()}v.append(n)},h=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){l(r,a,i,o,s,"next",e)}function s(e){l(r,a,i,o,s,"throw",e)}o(void 0)}))},h.apply(this,arguments)}function m(){(0,s.WR)("FolderManager"),u.setAttribute("displayed","true"),function(){h.apply(this,arguments)}()}function g(){(0,s.kr)("FolderManager"),u.setAttribute("displayed","false")}},9333:(e,t,n)=>{n.d(t,{Bo:()=>E,I6:()=>C,uy:()=>k});var a=n(9566),i=n(8024),r=n(3648),o=n(6189),s=n(4537),d=n(904),c=n(9119);function l(e,t,n,a,i,r,o){try{var s=e[r](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(a,i)}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var v=(0,r.bv)(".ve"),p=(0,r.aI)(v,".we"),h=(0,r.aI)(p,".xe"),m=(0,r.aI)(v,".ze"),g=(0,r.aI)(m,"._e"),b=(0,r.aI)(g,'.af[group="folder-name"] .ef input'),y=(0,r.aI)(g,'.af[group="folder-icon"] .ef .gf input'),w=(0,r.aI)(g,'.af[group="folder-icon"] .ef .gf .hf'),A=(0,r.aI)(g,'.af[group="folder-content"] .ef');function L(e,t){var n=(0,i.zx)(),o=document.createElement("div");o.id=n,o.classList.add("if"),o.setAttribute("type",t.type);var d="",l="",u="";switch(t.type){case"stop":u="location_on",d=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`,l=t.name;break;case"route":u="route",d=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`,l=t.name;break;case"location":u="location_on",d="地點",l=t.name;break;case"bus":d="",l=t.name;break;case"empty":u="lightbulb",d="提示",l="沒有內容";break;default:u="",d="null",l="null"}var f=document.createElement("div");f.classList.add("jf"),f.innerHTML=(0,s.Z)(u);var p=document.createElement("div");p.classList.add("kf"),p.appendChild(document.createTextNode(d));var h=document.createElement("div");h.classList.add("lf"),h.appendChild(document.createTextNode(l));var m=document.createElement("div");m.classList.add("mf");var g=document.createElement("div");g.classList.add("nf"),g.innerHTML=(0,s.Z)("keyboard_arrow_down"),g.onclick=function(){x(n,e.id,t.type,t.id,"up")};var b=document.createElement("div");b.classList.add("of"),b.innerHTML=(0,s.Z)("keyboard_arrow_down"),b.onclick=function(){x(n,e.id,t.type,t.id,"down")};var y=document.createElement("div");y.classList.add("pf"),y.innerHTML=(0,s.Z)("delete"),y.onclick=function(){!function(e,t,n,i){var o=(0,r.aI)(v,`.ze ._e .af[group="folder-content"] .ef .if#${e}`);(0,a.NC)(t,n,i).then((function(e){if(e)switch(o.remove(),n){case"stop":(0,c.a)("已移除站牌","delete");break;case"route":(0,c.a)("已移除路線","delete");break;case"location":(0,c.a)("已移除地點","delete")}else(0,c.a)("無法移除","error")}))}(n,e.id,t.type,t.id)};var w=document.createElement("div");w.classList.add("qf");var A=document.createElement("div");return A.classList.add("qf"),m.appendChild(g),m.appendChild(b),m.appendChild(y),m.appendChild(w),m.appendChild(A),o.appendChild(f),o.appendChild(p),o.appendChild(h),o.appendChild(m),{element:o,id:n}}function I(){var e;return e=function*(e){!function(e,t){b.value=e.name,y.value=e.icon,h.onclick=function(){E(e.id)},A.innerHTML="";var n,a=new DocumentFragment,i=u(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=L(e,r);a.appendChild(o.element)}}catch(e){i.e(e)}finally{i.f()}A.append(a)}(yield(0,a.L2)(e),yield(0,a.eD)(e))},I=function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){l(r,a,i,o,s,"next",e)}function s(e){l(r,a,i,o,s,"throw",e)}o(void 0)}))},I.apply(this,arguments)}function k(e){(0,d.WR)("FolderEditor"),v.setAttribute("displayed","true"),function(e){I.apply(this,arguments)}(e),(0,d.Z_)()}function C(){v.setAttribute("displayed","false"),(0,d.l$)()}function x(e,t,n,i,o){var s=(0,r.aI)(v,`.ze ._e .af[group="folder-content"] .ef .if#${e}`);(0,a.bq)(t,n,i,o).then((function(e){if(e)switch(o){case"up":var t=s.previousElementSibling;t&&s.parentNode.insertBefore(s,t),(0,c.a)("已往上移","arrow_circle_up");break;case"down":var n=s.nextElementSibling;n&&s.parentNode.insertBefore(n,s),(0,c.a)("已往下移","arrow_circle_down")}else(0,c.a)("無法移動","error")}))}function E(e){var t=b.value,n=y.value;(0,a.g$)(e,t,n),C()}w.onclick=function(){(0,o.r7)("editor")}}}]);
//# sourceMappingURL=fd21f2668f46a9b6daac.js.map