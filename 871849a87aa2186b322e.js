"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[806],{4927:(e,t,n)=>{n.d(t,{F:()=>S,$:()=>b});var r=n(6160),a=n(5314),o=n(3459),i=n(8024),u=n(3648),s=n(904),l=n(4537),d=[],c=!1,f=!0;function v(e,t,n,r){function a(e,t,a){function o(e,t){(0,u.aI)(e,".g").innerHTML=(0,l.Z)(t.icon)}function s(e,t){(0,u.aI)(e,".h").innerText=t.value}function d(e,t){e.setAttribute("animation",t)}function v(e,t){e.setAttribute("skeleton-screen",t)}null===a?(o(e,t),s(e,t),v(e,n),d(e,r)):((0,i.hw)(a,t)||o(e,t),(0,i.hw)(a,t)||s(e,t),n!==c&&v(e,n),r!==f&&d(e,r))}var o,s=t.length,v=(0,u.jg)(e,".i .f").length;if(s!==v){var p=v-s;if(p<0)for(var h=0;h<Math.abs(p);h++){var y=(o=void 0,(o=document.createElement("div")).classList.add("f"),o.innerHTML='<div class="g"></div><div class="h"></div>',{element:o,id:""});(0,u.aI)(e,".i").appendChild(y.element)}else for(var m=0;m<Math.abs(p);m++){var g=v-1-m;(0,u.jg)(e,".i .f")[g].remove()}}for(var b=(0,u.jg)(e,".i .f"),S=0;S<s;S++){var w=b[S],I=t[S];0===d.length?a(w,I,null):a(w,I,d[S])}d=t,f=r,c=n}function p(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}var h=(0,u.bv)(".j"),y=((0,u.aI)(h,".k"),(0,u.aI)(h,".l")),m=(0,u.aI)(y,".m"),g=(0,u.aI)(m,'.n[group="properties"]');(0,u.aI)(m,'.n[group="location"]');function b(e){(0,s.WR)("Bus"),(0,a.XK)("bus",e),h.setAttribute("displayed","true"),function(e){w.apply(this,arguments)}(e),(0,s.Z_)()}function S(){h.setAttribute("displayed","false"),(0,s.l$)()}function w(){var e;return e=function*(e){!function(e){for(var t=(0,o.Js)("playing_animation"),n=[],r=0;r<5;r++)n.push({key:r,icon:"none",value:""});v(e,n,!0,t)}(g);var t=(0,o.Js)("playing_animation"),n=(0,i.zx)("r"),a=yield(0,r.i)(e,n);v(g,a.properties,!1,t)},w=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){p(o,r,a,i,u,"next",e)}function u(e){p(o,r,a,i,u,"throw",e)}i(void 0)}))},w.apply(this,arguments)}},6052:(e,t,n)=>{n.d(t,{c6:()=>f,pd:()=>v,z1:()=>p});var r=n(9566),a=n(3648),o=n(904),i=n(9119),u=(0,a.bv)(".o"),s=(0,a.aI)(u,".p"),l=(0,a.aI)(s,".q"),d=(0,a.aI)(l,'.r[group="folder-name"] .s input'),c=(0,a.aI)(l,'.r[group="folder-icon"] .s .t input');function f(){var e=d.value,t=c.value;(0,r.vV)(e,t).then((function(e){e?(p(),(0,i.a)("已建立資料夾","folder")):(0,i.a)("無法建立資料夾","error")}))}function v(){(0,o.WR)("FolderCreator"),u.setAttribute("displayed","true"),(0,o.Z_)()}function p(){u.setAttribute("displayed","false"),(0,o.l$)()}},7123:(e,t,n)=>{n.d(t,{R:()=>b});var r=n(7183),a=n(6483),o=n(6802),i=n(7810),u=n(2063),s=n(8011),l=n(4293),d=n(1932),c=n(424),f=n(2303),v=n(6788),p=n(3459),h=n(1531);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function b(e,t,n,r,a){return S.apply(this,arguments)}function S(){var e;return e=function*(e,t,n,m,g){(0,v.Mf)(g,"getRoute_0",0,!1),(0,v.Mf)(g,"getRoute_1",0,!1),(0,v.Mf)(g,"getStop_0",0,!1),(0,v.Mf)(g,"getStop_1",0,!1),(0,v.Mf)(g,"getLocation_0",0,!1),(0,v.Mf)(g,"getLocation_1",0,!1),(0,v.Mf)(g,"getSegmentBuffers_0",0,!1),(0,v.Mf)(g,"getSegmentBuffers_1",0,!1),(0,v.Mf)(g,"getEstimateTime_0",0,!1),(0,v.Mf)(g,"getEstimateTime_1",0,!1),(0,v.Mf)(g,"getBusEvent_0",0,!1),(0,v.Mf)(g,"getBusEvent_1",0,!1),(0,v.Mf)(g,"getBusData_0",0,!1),(0,v.Mf)(g,"getBusData_1",0,!1);var b=yield(0,l.a)(g,!0),S=yield(0,c.T)(g),w=yield(0,s.g)(g,0),I=yield(0,s.g)(g,1),_=yield(0,s.g)(g,2),A=yield(0,d.L)(g),E=yield(0,u.K)(g),$=yield(0,i.J)(g),k=yield(0,o.d)(g),P=yield(0,a.Io)(n,m),T=(0,f.w_)($,k,b,e,t),L=!1,M={};A.hasOwnProperty(`r_${e}`)&&(L=!0,M=A[`r_${e}`]);var D,R=(0,p.Js)("time_formatting_mode"),F=[],O=[],x=y(E);try{for(x.s();!(D=x.n()).done;){var B=D.value,C={},H=B.RouteID;if([e,10*e].includes(H)||t.includes(H)){C.status=(0,f.$Q)(null==B?void 0:B.EstimateTime,R);var U=`s_${B.StopID}`,j={};if(!S.hasOwnProperty(U))continue;j=S[U],C.id=B.StopID,C.sequence=j.seqNo,C.goBack=j.goBack;var N=`l_${j.stopLocationId}`,z={};if(!w.hasOwnProperty(N))continue;z=w[N],C.name=z.n,C.overlappingRoutes=z.r.filter((function(t){return t!==e})).map((function(e){var t=`r_${e}`;if(b.hasOwnProperty(t)){var n=b[t];return{name:n.n,RouteEndPoints:{RouteDeparture:n.dep,RouteDestination:n.des,text:`${n.dep} ↔ ${n.des}`,html:`<span>${n.dep}</span><span>↔</span><span>${n.des}</span>`},RouteID:n.id,PathAttributeId:n.pid}}return null})).filter((function(e){return!(null===e)})),C.position={longitude:z.lo,latitude:z.la},O.push({latitude:z.la,longitude:z.lo,id:B.StopID});var Z=z.g,W=[];_.hasOwnProperty(Z)&&(W=_[Z]);var q,G=[],Q=y(W);try{for(Q.s();!(q=Q.n()).done;){var Y=`ml_${q.value.hash}`;if(I.hasOwnProperty(Y)){var V=I[Y],J={name:V.n,distance:0|(0,r.aV)(V.la[0],V.lo[0],z.la,z.lo),hash:V.hash};G.push(J)}}}catch(e){Q.e(e)}finally{Q.f()}G.sort((function(e,t){return e.distance-t.distance})),C.nearbyLocations=G;var X,K=[],ee=y(z.s);try{for(ee.s();!(X=ee.n()).done;){var te=`s_${X.value}`;T.hasOwnProperty(te)&&K.push(T[te].map((function(e){return(0,f.s$)(e)})))}}catch(e){ee.e(e)}finally{ee.f()}C.buses=K.flat().sort((function(e,t){return e.index-t.index}));var ne=[];P.hasOwnProperty(U)&&(ne=P[U]),C.busArrivalTimes=ne;var re=!1,ae=!1,oe=!1,ie=!1;if(L){var ue=`g_${C.goBack}`,se=[];M.hasOwnProperty(ue)?se=M[ue]:"1"===C.goBack&&(ie=!0,se=M.g_0);var le,de=y(se);try{for(de.s();!(le=de.n()).done;){var ce=le.value;ce.OriginStopID!==B.StopID&&ce.DestinationStopID!==B.StopID||(re=!0),ie?(ce.OriginStopID===B.StopID&&(oe=!0),ce.DestinationStopID===B.StopID&&(ae=!0)):(ce.OriginStopID===B.StopID&&(ae=!0),ce.DestinationStopID===B.StopID&&(oe=!0))}}catch(e){de.e(e)}finally{de.f()}}C.segmentBuffer={isSegmentBuffer:re,isStartingPoint:ae,isEndingPoint:oe},F.push(C)}}}catch(e){x.e(e)}finally{x.f()}F.sort((function(e,t){return e.sequence-t.sequence}));for(var fe=(0,h.uQ)(O,450),ve=!1,pe=!1,he={},ye=0,me={},ge=F.length,be=0;be<ge;be++){var Se=F[be],we=F[be+1]||Se,Ie=0;if(Se.buses.length>0&&Se.buses[0].onThisRoute){var _e=[Se.buses[0].position.longitude,Se.buses[0].position.latitude],Ae=_e[0],Ee=_e[1],$e=[Se.position.longitude,Se.position.latitude],ke=$e[0],Pe=$e[1],Te=[we.position.longitude,we.position.latitude],Le=Te[0],Me=Te[1];if((Ae-ke)*(Le-Ae)+(Ee-Pe)*(Me-Ee)>=0){var De=Math.hypot(Ae-ke,Ee-Pe),Re=Math.hypot(Ae-Le,Ee-Me);Ie=Math.max(0,Math.min(De/(De+Re),1))}}Se.progress=Ie,Se.segmentBuffer.isStartingPoint&&(ve=!0),Se.segmentBuffer.isEndingPoint&&ve&&(pe=!0),ve&&!pe&&(Se.segmentBuffer.isSegmentBuffer=!0),ve&&pe&&(ve=!1,pe=!1);var Fe=!1;null!==fe&&fe.id===Se.id&&(Fe=!0),Se.nearest=Fe;var Oe=`g_${Se.goBack}`||"g_0";he.hasOwnProperty(Oe)||(he[Oe]=[],me[Oe]=0,ye+=1),he[Oe].push(Se),me[Oe]+=1}var xe=b[`r_${e}`],Be={groupedItems:he,groupQuantity:ye,itemQuantity:me,RouteName:xe.n,RouteEndPoints:{RouteDeparture:xe.dep,RouteDestination:xe.des},dataUpdateTime:(0,v.Zt)(g),RouteID:e,PathAttributeId:t};return(0,v.LQ)(g),(0,v.gC)(g),Be},S=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){g(o,r,a,i,u,"next",e)}function u(e){g(o,r,a,i,u,"throw",e)}i(void 0)}))},S.apply(this,arguments)}},7568:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(1354),a=n.n(r),o=n(6314),i=n.n(o)()(a());i.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/interface/animation.css"],names:[],mappings:"AAAA;QACS,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const u=i},7669:(e,t,n)=>{n.d(t,{default:()=>Te});var r=n(6483),a=n(8925),o=n(5767),i=n(9566),u=n(4636),s=n(5314),l=n(3459),d=n(3251),c=n(1238),f=n(1531),v=n(4927),p=n(7183),h=n(3648),y=n(5579),m=n(904);function g(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}var b=(0,h.bv)(".u"),S=(0,h.aI)(b,".v"),w=(0,h.aI)(S,".w"),I=(0,h.aI)(S,".x"),_=(0,h.aI)(I,'.y[name="total-data-usage"] .z'),A=(0,h.aI)(I,'.y[name="start-time"] .z'),E=(0,h.aI)(I,'.y[name="end-time"] .z');function $(){var e;return e=function*(){var e=(0,m.gO)("window"),t=e.width,n=Math.min(5/18*t,.33*e.height),r=yield(0,a.LN)(t,n,20);_.innerText=(0,p.tH)(r.stats.sum),A.innerText=(0,y.$T)(r.period.start,"YYYY-MM-DD"),E.innerText=(0,y.$T)(r.period.end,"YYYY-MM-DD"),w.innerHTML=r.chart},$=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){g(o,r,a,i,u,"next",e)}function u(e){g(o,r,a,i,u,"throw",e)}i(void 0)}))},$.apply(this,arguments)}var k=n(6052),P=n(9333),T=n(9930),L=n(972),M=n(8024),D=n(4781),R=n(6082),F=n(4537),O=n(9119);function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return B(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}var H="",U=(0,h.bv)("._"),j=(0,h.bv)(".o"),N=(0,h.bv)(".aa");function z(e){var t=(0,M.zx)("i"),n=document.createElement("div");return n.id=t,n.classList.add("ba"),n.setAttribute("onclick",`bus.folder.selectFolderIcon('${e}', '${H}')`),n.innerHTML=(0,F.Z)(e),{element:n,id:t}}function Z(){var e;return e=function*(){var e=(0,h.aI)(N,".ca .da");e.innerHTML="";var t,n=(0,M.zx)("r"),r=x(yield(0,T.z)(n));try{for(r.s();!(t=r.n()).done;){var a=z(t.value);e.appendChild(a.element)}}catch(e){r.e(e)}finally{r.f()}},Z=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){C(o,r,a,i,u,"next",e)}function u(e){C(o,r,a,i,u,"throw",e)}i(void 0)}))},Z.apply(this,arguments)}function W(e){var t=(0,h.aI)(N,".ca .ea"),n=(0,h.aI)(N,".ca .da");if(t.innerHTML="",!(0,D.iO)(e)){var r,a=(0,L.U)(e,100),o=x(a);try{for(o.s();!(r=o.n()).done;){var i=z(r.value.item);t.appendChild(i.element)}}catch(e){o.e(e)}finally{o.f()}t.setAttribute("displayed",a.length>0?"true":"false"),n.setAttribute("displayed",a.length>0?"false":"true")}}function q(){(0,m.kr)("FolderIconSelector"),N.setAttribute("displayed","false")}var G=n(8379),Q=n(540),Y=n(6091),V=n(3030),J=n(2174),X=n(8380),K=n(5693),ee=n(7891),te=n(7908),ne=n(8332),re=n(9009),ae=n(4474),oe=n(4690),ie=n(3041),ue=n(752),se=n(5009),le=n(6104),de=n(6166),ce=n(2994),fe=n(9469),ve=(n(2142),n(4587),n(3170),n(5072)),pe=n.n(ve),he=n(7825),ye=n.n(he),me=n(7659),ge=n.n(me),be=n(5056),Se=n.n(be),we=n(8159),Ie=n.n(we),_e=n(1113),Ae=n.n(_e),Ee=n(7568),$e={};$e.styleTagTransform=Ae(),$e.setAttributes=Se(),$e.insert=ge().bind(null,"head"),$e.domAPI=ye(),$e.insertStyleElement=Ie();pe()(Ee.A,$e);Ee.A&&Ee.A.locals&&Ee.A.locals;n(7671),n(1521),n(5415),n(8860),n(4242),n(9622),n(6741);var ke=!1,Pe=!1;window.bus={initialize:function(){!1===ke&&(ke=!0,(0,m.BM)(),(0,l.Yq)().then((function(){var e=(0,h.bv)(".ma .na .oa");(0,Y.Q)(e);var t=(0,h.bv)(".ma .na .pa");(0,Q.F)(t),(0,d.A)().then((function(e){if("ok"===e){(0,oe.S5)(),(0,V.s_)(),(0,se.ld)(),window.addEventListener("resize",(function(){(0,se.ld)()})),screen&&screen.orientation&&screen.orientation.addEventListener("change",(function(){(0,se.ld)()})),(0,Y.u)(),(0,i.Rh)().then((function(){(0,Q.a)()}));var t=window.matchMedia("(prefers-color-scheme: dark)"),n=(0,h.bv)(".qa .ra .sa #search_input");t.addEventListener("change",(function(){(0,se.gn)(n.selectionStart,n.selectionEnd)})),n.addEventListener("paste",(function(){(0,se.RC)(),(0,se.gn)(n.selectionStart,n.selectionEnd)})),n.addEventListener("cut",(function(){(0,se.RC)(),(0,se.gn)(n.selectionStart,n.selectionEnd)})),n.addEventListener("selectionchange",(function(){(0,se.RC)(),(0,se.gn)(n.selectionStart,n.selectionEnd)})),document.addEventListener("selectionchange",(function(){(0,se.RC)(),(0,se.gn)(n.selectionStart,n.selectionEnd)})),n.addEventListener("keyup",(function(){(0,se.RC)(),(0,se.gn)(n.selectionStart,n.selectionEnd)}));var r=(0,h.bv)(".aa .ta .ua #search_material_symbols_input");r.addEventListener("paste",(function(){W(r.value)})),r.addEventListener("cut",(function(){W(r.value)})),r.addEventListener("selectionchange",(function(){W(r.value)})),document.addEventListener("selectionchange",(function(){W(r.value)})),r.addEventListener("keyup",(function(){W(r.value)})),(0,fe._)(),(0,m.AE)((function(){(0,u.Db)(),(0,u.cS)().then((function(){(0,u.z9)()})),document.addEventListener("click",(function(){(0,f.to)(),(0,c.q)()}),{once:!0})}))}"fetchError"!==e&&"unknownError"!==e||((0,m.AE)(),alert(e))})).catch((function(e){(0,m.AE)(),alert(e)}))})))},secondlyInitialize:function(){Pe||(Pe=!0,(0,R.X)(),(0,o.fV)(),(0,a.Ir)(),(0,r.$t)(),(0,s.FU)(),(0,o.fV)().then((function(){(0,o.MN)().then((function(){(0,o.cy)()}))})))},route:{stretchRouteItem:oe.aU,openRoute:oe.SR,closeRoute:oe.U7,switchRoute:oe.Ch,switchRouteBodyTab:oe.py,openRouteDetails:ae.GS,closeRouteDetails:ae.GZ,shareRoutePermalink:ne.w,switchCalendarDay:re.f4},location:{openLocation:V.so,closeLocation:V.eS,stretchLocationItem:V.az,switchLocationBodyTab:V.dM},folder:{openSaveToFolder:ie.BI,closeSaveToFolder:ie.nS,openFolderManager:G.g,closeFolderManager:G.m,openFolderEditor:P.uy,closeFolderEditor:P.I6,openFolderIconSelector:function(e){var t;switch((0,m.WR)("FolderIconSelector"),e){case"editor":H="editor",t=(0,h.aI)(U,'.fa .ga .ha[group="folder-icon"] .ia .ja .ka');break;case"creator":H="creator",t=(0,h.aI)(j,'.p .q .r[group="folder-icon"] .s .t .la')}"false"===t.getAttribute("disabled")&&(R.m?(N.setAttribute("displayed","true"),function(){Z.apply(this,arguments)}(H),(0,L.L)()):(0,O.a)("資料還在下載中","download_for_offline"))},closeFolderIconSelector:q,openFolderCreator:k.pd,closeFolderCreator:k.z1,createFormulatedFolder:k.c6,saveEditedFolder:P.Bo,selectFolderIcon:function(e){var t;switch(H){case"editor":t=(0,h.aI)(U,'.fa .ga .ha[group="folder-icon"] .ia .ja input');break;case"creator":t=(0,h.aI)(j,'.p .q .r[group="folder-icon"] .s .t input')}t.value=e,q()},saveStopItemOnRoute:ie.JL,saveStopItemOnLocation:ie.Lb,saveRouteOnDetailsPage:ie.Dh,saveRouteOnRoute:ie.jD,removeItemOnFolderEditor:P.cG,moveItemOnFolderEditor:P.Lq},search:{openSearch:se.rf,closeSearch:se.Bb,typeTextIntoInput:se._O,deleteCharFromInout:se.d$,emptyInput:se.Wb,openSystemKeyboard:se.vp,switchSearchTypeFilter:se.H2},storage:{openStorage:ce.G,closeStorage:ce.Q},dataUsage:{openDataUsage:function(){(0,m.WR)("DataUsage"),b.setAttribute("displayed","true"),function(){$.apply(this,arguments)}(),(0,m.Z_)()},closeDataUsage:function(){b.setAttribute("displayed","false"),(0,m.l$)()}},personalSchedule:{openPersonalScheduleManager:ee.z,closePersonalScheduleManager:ee.Z,openPersonalScheduleCreator:X.I1,closePersonalScheduleCreator:X.GJ,createFormulatedPersonalSchedule:X.Ps,switchPersonalScheduleCreatorDay:X.om,openPersonalScheduleEditor:K.bF,closePersonalScheduleEditor:K.Xy,switchPersonalScheduleEditorDay:K.Dn,saveEditedPersonalSchedule:K.gv},settings:{openSettings:le.Ow,closeSettings:le.os,openSettingsOptions:de.yH,closeSettingsOptions:de.wx,settingsOptionsHandler:de.Yi,downloadExportFile:le.vv,openFileToImportData:le.rY,viewCommitOfCurrentVersion:le.hP,showPromptToAskForPersistentStorage:le.jk},bus:{openBus:v.$,closeBus:v.F},notification:{openNotificationScheduleManager:J.Sv,closeNotificationScheduleManager:J.m_,openRegisterNotification:te.XG,closeRegisterNotification:te.hy,saveFormulatedRegisterNotification:te.NW,openScheduleNotification:ue.Ho,closeScheduleNotification:ue.b$,scheduleNotificationForStopItemOnRoute:ue.H9,scheduleNotificationForStopItemOnLocation:ue.b6,cancelNotificationOnNotificationScheduleManager:J.Gv}};const Te=window.bus},8379:(e,t,n)=>{n.d(t,{g:()=>v,m:()=>p});var r=n(9566),a=n(8024),o=n(3648),i=n(4537),u=n(904);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function c(e){var t=(0,a.zx)("i"),n=document.createElement("div");return n.classList.add("va"),n.id=t,n.setAttribute("onclick",`bus.folder.openFolderEditor('${e.id}')`),n.innerHTML=`<div class="wa">${(0,i.Z)(e.icon)}</div><div class="xa">${e.name}</div><div class="ya">${e.contentLength}</div><div class="za">${(0,i.Z)("arrow_forward_ios")}</div>`,{element:n,id:t}}function f(){var e;return e=function*(){var e=(0,o.bv)("._a"),t=(0,o.aI)(e,".ab .bb");t.innerHTML="";var n,a=s(yield(0,r.Xi)());try{for(a.s();!(n=a.n()).done;){var i=c(n.value);t.appendChild(i.element)}}catch(e){a.e(e)}finally{a.f()}},f=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){d(o,r,a,i,u,"next",e)}function u(e){d(o,r,a,i,u,"throw",e)}i(void 0)}))},f.apply(this,arguments)}function v(){(0,u.WR)("FolderManager"),(0,o.bv)("._a").setAttribute("displayed","true"),function(){f.apply(this,arguments)}()}function p(){(0,u.kr)("FolderManager"),(0,o.bv)("._a").setAttribute("displayed","false")}},8621:(e,t,n)=>{n.d(t,{p:()=>v});var r=n(5579),a=n(313),o=n(4293),i=n(8201),u=n(8671),s=n(2303),l=n(6788);function d(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t,n){return p.apply(this,arguments)}function p(){var e;return e=function*(e,t,n){var d=function(e,t){var n,r={},a=c(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.Id===t){r=o;break}}}catch(e){a.e(e)}finally{a.f()}return r}(yield(0,o.a)(n,!1),e),f=yield(0,i.Y)(n),v=yield(0,u.s)(n),p=yield(0,a.s)(n),h=function(e){var t=(0,s.aU)(e.goFirstBusTime,0),n=(0,s.aU)(e.goLastBusTime,0),r=(0,s.aU)(e.backFirstBusTime,0),a=(0,s.aU)(e.backLastBusTime,0),o=(0,s.aU)(e.holidayGoFirstBusTime,0),i=(0,s.aU)(e.holidayGoLastBusTime,0),u=(0,s.aU)(e.holidayBackFirstBusTime,0),l=(0,s.aU)(e.holidayBackLastBusTime,0),d=(0,s.aU)(e.peakHeadway,1),c=(0,s.aU)(e.offPeakHeadway,1),f=(0,s.aU)(e.holidayPeakHeadway,1),v=(0,s.aU)(e.holidayOffPeakHeadway,1);return{go:{weekday:{first:t,last:n,rushHourWindow:d,offRushHourWindow:c},holiday:{first:o,last:i,rushHourWindow:f,offRushHourWindow:v}},back:{weekday:{first:r,last:a,rushHourWindow:d,offRushHourWindow:c},holiday:{first:u,last:l,rushHourWindow:f,offRushHourWindow:v}},realSequence:e.realSequence}}(d),y=function(e,t,n,a,o){var i,u={calendarDays:{d_0:{name:"日",day:0,code:"d_0"},d_1:{name:"一",day:1,code:"d_1"},d_2:{name:"二",day:2,code:"d_2"},d_3:{name:"三",day:3,code:"d_3"},d_4:{name:"四",day:4,code:"d_4"},d_5:{name:"五",day:5,code:"d_5"},d_6:{name:"六",day:6,code:"d_6"}},calendarDayQuantity:7,calendarEventGroups:{d_0:[],d_1:[],d_2:[],d_3:[],d_4:[],d_5:[],d_6:[]},calendarEventQuantity:{d_0:0,d_1:0,d_2:0,d_3:0,d_4:0,d_5:0,d_6:0}},l=(0,r.P$)(),d=c(a);try{for(d.s();!(i=d.n()).done;){var f=i.value;if(t.indexOf(f.PathAttributeId)>-1&&"0"===f.DateType)for(var v=(0,r.mr)(f.DateValue),p=(0,r.S1)(l,v.day,0,0),h=(0,s.aU)(f.StartTime,0),y=(0,r.S1)(p,0,h.hours,h.minutes),m=(0,s.aU)(f.EndTime,0),g=(0,r.S1)(p,0,m.hours,m.minutes),b=Math.abs(60*m.hours+m.minutes-(60*h.hours+h.minutes)),S=parseInt(f.LongHeadway),w=parseInt(f.LowHeadway),I=(w+S)/2,_=b/I,A=0;A<_;A++){var E=!1,$=(0,r.S1)(p,0,h.hours,h.minutes+w*A);$.getTime()<y.getTime()&&(E=!0),$.getTime()>g.getTime()&&(E=!0),!1===E&&(u.calendarEventGroups[v.code].push({date:$,dateString:(0,r.$T)($,"hh:mm"),duration:w,deviation:Math.abs(I-w)}),u.calendarEventQuantity[v.code]+=1)}}}catch(e){d.e(e)}finally{d.f()}var k,P=c(o);try{for(P.s();!(k=P.n()).done;){var T=k.value;if(t.indexOf(T.PathAttributeId)>-1&&"0"===T.DateType){var L=(0,r.mr)(T.DateValue),M=(0,r.S1)(l,L.day,0,0),D=(0,s.aU)(T.DepartureTime,0),R=(0,r.S1)(M,0,D.hours,D.minutes);u.calendarEventGroups[L.code].push({date:R,dateString:(0,r.$T)(R,"hh:mm"),duration:15,deviation:0}),u.calendarEventQuantity[L.code]+=1}}}catch(e){P.e(e)}finally{P.f()}for(var F in u.calendarEventGroups)u.calendarEventGroups[F].sort((function(e,t){return e.date.getTime()-t.date.getTime()}));return u}(0,t,0,f,v),m=function(e,t){var n,r={},a=c(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.id===t&&(r=o)}}catch(e){a.e(e)}finally{a.f()}return r}(p,d.providerId),g={timeTableRules:h,calendar:y,properties:[{key:"route_name",icon:"route",value:d.nameZh},{key:"pricing",icon:"attach_money",value:d.ticketPriceDescriptionZh},{key:"provider_name",icon:"corporate_fare",value:m.nameZn},{key:"provider_phone",icon:"call",value:m.phoneInfo},{key:"provider_email",icon:"alternate_email",value:m.email}]};return(0,l.LQ)(n),(0,l.gC)(n),g},p=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){d(o,r,a,i,u,"next",e)}function u(e){d(o,r,a,i,u,"throw",e)}i(void 0)}))},p.apply(this,arguments)}},9333:(e,t,n)=>{n.d(t,{Bo:()=>k,I6:()=>A,Lq:()=>$,cG:()=>E,uy:()=>_});var r=n(9566),a=n(8024),o=n(3648),i=n(4537),u=n(904),s=n(9119);function l(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=(0,o.bv)("._"),v=(0,o.aI)(f,".cb"),p=(0,o.aI)(v,".db"),h=(0,o.aI)(f,".fa"),y=(0,o.aI)(h,".ga"),m=(0,o.aI)(y,'.ha[group="folder-name"] .ia input'),g=(0,o.aI)(y,'.ha[group="folder-icon"] .ia .ja input'),b=(0,o.aI)(y,'.ha[group="folder-icon"] .ia .ja .ka'),S=(0,o.aI)(y,'.ha[group="folder-content"] .ia');function w(e,t){var n=(0,a.zx)("i"),r=document.createElement("div");r.id=n,r.classList.add("eb"),r.setAttribute("type",t.type);var o="",u="",s="";switch(t.type){case"stop":s="location_on",o=`${t.route?t.route.name:""} - 往${t.route?[t.route.endPoints.destination,t.route.endPoints.departure,""][t.direction?t.direction:0]:""}`,u=t.name;break;case"route":s="route",o=`${t.endPoints.departure} ↔ ${t.endPoints.destination}`,u=t.name;break;case"bus":o="",u=t.name;break;case"empty":s="lightbulb",o="提示",u="沒有內容";break;default:s="",o="null",u="null"}return r.innerHTML=`<div class="fb">${(0,i.Z)(s)}</div><div class="gb">${o}</div><div class="hb">${u}</div><div class="ib"><div class="jb" onclick="bus.folder.moveItemOnFolderEditor('${n}', '${e.id}', '${t.type}', ${t.id}, 'up')">${(0,i.Z)("keyboard_arrow_down")}</div><div class="kb" onclick="bus.folder.moveItemOnFolderEditor('${n}', '${e.id}', '${t.type}', ${t.id}, 'down')">${(0,i.Z)("keyboard_arrow_down")}</div><div class="lb" onclick="bus.folder.removeItemOnFolderEditor('${n}', '${e.id}', '${t.type}', ${t.id})">${(0,i.Z)("delete")}</div><div class="mb"></div><div class="mb"></div></div>`,{element:r,id:n}}function I(){var e;return e=function*(e){!function(e,t){m.value=e.name,g.value=e.icon,e.default?(m.setAttribute("readonly","readonly"),g.setAttribute("readonly","readonly"),b.setAttribute("disabled","true")):(m.removeAttribute("readonly"),g.removeAttribute("readonly"),b.setAttribute("disabled","false")),p.setAttribute("onclick",`bus.folder.saveEditedFolder('${e.id}')`),S.innerHTML="";var n,r=d(t);try{for(r.s();!(n=r.n()).done;){var a=w(e,n.value);S.appendChild(a.element)}}catch(e){r.e(e)}finally{r.f()}}(yield(0,r.L2)(e),yield(0,r.eD)(e))},I=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){l(o,r,a,i,u,"next",e)}function u(e){l(o,r,a,i,u,"throw",e)}i(void 0)}))},I.apply(this,arguments)}function _(e){(0,u.WR)("FolderEditor"),f.setAttribute("displayed","true"),function(e){I.apply(this,arguments)}(e),(0,u.Z_)()}function A(){f.setAttribute("displayed","false"),(0,u.l$)()}function E(e,t,n,a){var i=(0,o.aI)(f,`.fa .ga .ha[group="folder-content"] .ia .eb#${e}`);(0,r.NC)(t,n,a).then((function(e){if(e)switch(i.remove(),n){case"stop":(0,s.a)("已移除站牌","delete");break;case"route":(0,s.a)("已移除路線","delete")}else(0,s.a)("無法移除","error")}))}function $(e,t,n,a,i){var u=(0,o.aI)(f,`.fa .ga .ha[group="folder-content"] .ia .eb#${e}`);(0,r.bq)(t,n,a,i).then((function(e){if(e)switch(i){case"up":var t=u.previousElementSibling;t&&u.parentNode.insertBefore(u,t),(0,s.a)("已往上移","arrow_circle_up");break;case"down":var n=u.nextElementSibling;n&&u.parentNode.insertBefore(n,u),(0,s.a)("已往下移","arrow_circle_down")}else(0,s.a)("無法移動","error")}))}function k(e){var t=m.value,n=g.value;(0,r.g$)(e,t,n),A()}}}]);
//# sourceMappingURL=871849a87aa2186b322e.js.map