"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[532],{3030(e,t,a){a.d(t,{eS:()=>he,s_:()=>V,so:()=>pe});var i=a(467),n=a(5767),r=a(9566),s=a(2757),d=a(3422),o=a(5314),l=a(3459),u=a(8179),c=a(7968),p=a(8024),h=a(5579),v=a(4537),m=a(904),f=a(9119),g=a(3041),b=a(752),y=a(8194),A=a(1351);function C(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return I(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("E0")}var r,s=!0,d=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){d=!0,r=e},f:function(){try{s||null==a.return||a.return()}finally{if(d)throw r}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}var L=(0,u.bv)(".tg"),x=(0,u.aI)(L,"._g"),E=(0,u.aI)(x,".dh"),w=(0,u.aI)(E,"span"),_=(0,u.aI)(x,".ch"),j=(0,u.aI)(L,".oh"),k=(0,u.aI)(x,".eh"),T=(0,u.aI)(k,".fh"),M=(0,u.aI)(x,".ih"),S=(0,u.aI)(M,".jh"),$=(0,u.aI)(x,".lh .mh"),Y={},Z=!1,z=!1,N=0,P=0,D=0,Q={},R=!1,q=15e3,H=5e3,B=15e3,F=!0,J=0,U=0,W="",K=!1,O=!1,X=!1,G="";function V(){j.addEventListener("touchstart",function(){N=Math.round(j.scrollLeft/(0,y.YC)("window")[0])},{passive:!0}),j.addEventListener("scroll",function(e){R=!0;var t=e.target.scrollLeft/(0,y.YC)("window")[0];P=t>N?N+1:N-1;var a=t-N,i=Math.abs(a);i>1&&(a>0?(N=Math.floor(t),P=N+1):(N=Math.ceil(t),P=N-1),i=Math.abs(t-N));var n=Q[`g_${N}`]||{width:0,offset:0},r=Q[`g_${P}`]||{width:0,offset:0},s=n.width+(r.width-n.width)*i,d=-1*(n.offset+(r.offset-n.offset)*i)+.5*(0,y.YC)("window")[0]-.5*s;ee(D,d,s-20,t)},{passive:!0}),j.addEventListener("scrollend",function(e){var t=e.target.scrollLeft/(0,y.YC)("window")[0];N=Math.round(t),R=!1},{passive:!0})}function ee(e,t,a,i){j.style.setProperty("--sg",e.toString()),S.style.setProperty("--vg",a.toString()),T.style.setProperty("--wg",`${t.toString()}px`),T.style.setProperty("--xg",i.toString())}function te(e){var t=e;if(K){var a=t.detail.progress-1;$.style.setProperty("--yg",a.toString())}"end"===t.detail.stage&&document.removeEventListener(t.detail.target,te)}function ae(){var e=document.createElement("div");e.classList.add("yh"),e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var t=document.createElement("div");t.classList.add("zh");var a=document.createElement("div");a.classList.add("_h");var i=document.createElement("div");i.classList.add("bi"),i.setAttribute("code","-1"),i.setAttribute("displayed","false");var n=document.createElement("div");n.classList.add("ci"),n.setAttribute("code","-1"),n.setAttribute("displayed","true"),a.appendChild(i),a.appendChild(n);var r=document.createElement("div");r.classList.add("mi");var s=document.createElement("div");s.classList.add("ni");var d=document.createElement("div");d.classList.add("oi");var o=document.createElement("div");o.classList.add("ri");var l=document.createElement("div");l.classList.add("_a"),l.setAttribute("code","0"),l.setAttribute("displayed","false");var c=document.createElement("div");c.classList.add("ab"),c.setAttribute("code","0"),c.setAttribute("displayed","true"),o.appendChild(l),o.appendChild(c);var p=document.createElement("div");p.classList.add("qi"),p.appendChild((0,v.YC)("keyboard_arrow_down")),p.onclick=function(){!function(e){var t=(0,u.aI)(e,".si"),a=e.parentElement,i=(0,u.ji)(e,"yh"),n=i.length,r=a.getBoundingClientRect(),s=e.getBoundingClientRect().top-r.top,d="true"===e.getAttribute("stretched"),o="true"===e.getAttribute("animation");if(o){var l=d?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--wh",`${s}px`);for(var c=0;c<n;c++){var p=i[c];p.setAttribute("push-direction",l),p.setAttribute("push-state","1")}e.addEventListener("transitionend",function(){for(var t=0;t<n;t++){var a=i[t];a.setAttribute("push-direction","0"),a.setAttribute("push-state","0")}e.setAttribute("stretching","false")},{once:!0}),e.addEventListener("transitionstart",function(){for(var e=0;e<n;e++){i[e].setAttribute("push-state","2")}},{once:!0})}d?(o?t.addEventListener("transitionend",function(){t.setAttribute("displayed","false")},{once:!0}):t.setAttribute("displayed","false"),e.setAttribute("stretched","false")):(t.setAttribute("displayed","true"),e.setAttribute("stretched","true"))}(e)};var h=document.createElement("div");h.classList.add("pi"),d.appendChild(o),d.appendChild(p),d.appendChild(h),t.appendChild(a),t.appendChild(r),t.appendChild(s),t.appendChild(d);var m=document.createElement("div");m.classList.add("si"),m.setAttribute("displayed","false");var f=document.createElement("div");f.classList.add("ti");var g=document.createElement("div");g.classList.add("ui"),g.setAttribute("highlighted","true"),g.setAttribute("type","tab"),g.setAttribute("code","0");var b=document.createElement("div");b.classList.add("vi"),b.appendChild((0,v.YC)("directions_bus")),g.appendChild(b),g.appendChild(document.createTextNode("公車")),g.onclick=function(){ve(e,0)};var y=document.createElement("div");y.classList.add("ui"),y.setAttribute("highlighted","false"),y.setAttribute("type","tab"),y.setAttribute("code","1");var A=document.createElement("div");A.classList.add("vi"),A.appendChild((0,v.YC)("departure_board")),y.appendChild(A),y.appendChild(document.createTextNode("抵達時間")),y.onclick=function(){ve(e,1)};var C=document.createElement("div");C.classList.add("ui"),C.setAttribute("highlighted","false"),C.setAttribute("type","save-to-folder");var I=document.createElement("div");I.classList.add("vi"),I.appendChild((0,v.YC)("folder")),C.appendChild(I),C.appendChild(document.createTextNode("儲存"));var L=document.createElement("div");L.classList.add("ui"),L.setAttribute("highlighted","false"),L.setAttribute("type","schedule-notification"),L.setAttribute("enabled","true");var x=document.createElement("div");x.classList.add("vi"),x.appendChild((0,v.YC)("notifications")),L.appendChild(x),L.appendChild(document.createTextNode("通知")),f.appendChild(g),f.appendChild(y),f.appendChild(C),f.appendChild(L);var E=document.createElement("div");E.classList.add("wi"),E.setAttribute("displayed","true");var w=document.createElement("div");return w.classList.add("xi"),w.setAttribute("displayed","false"),m.appendChild(f),m.appendChild(E),m.appendChild(w),e.appendChild(t),e.appendChild(m),e}function ie(){var e=document.createElement("div");e.classList.add("ph");var t=document.createElement("div");t.classList.add("qh");var a=document.createElement("div");a.classList.add("rh"),t.appendChild(a);var i=document.createElement("div");return i.classList.add("xh"),e.appendChild(t),e.appendChild(i),e}function ne(){var e=document.createElement("div");e.classList.add("gh");var t=document.createElement("span");return e.appendChild(t),e}function re(){var e=document.createElement("div");e.classList.add("sh");var t=document.createElement("div");t.classList.add("th"),t.appendChild((0,v.oC)());var a=document.createElement("div");return a.classList.add("uh"),e.appendChild(t),e.appendChild(a),e}function se(){var e=document.createElement("div");e.classList.add("yi"),e.setAttribute("on-this-route","false");var t=document.createElement("div");t.classList.add("_i");var a=document.createElement("div");a.classList.add("bj"),a.appendChild((0,v.YC)("directions_bus"));var i=document.createElement("div");i.classList.add("dj");var n=document.createElement("div");n.classList.add("gj");var r=document.createElement("div");r.classList.add("ij");var s=document.createElement("div");s.classList.add("jj");var d=document.createElement("div");return d.classList.add("kj"),t.appendChild(a),t.appendChild(i),e.appendChild(t),n.appendChild(r),n.appendChild(s),n.appendChild(d),e.appendChild(n),e}function de(){var e=document.createElement("div");e.classList.add("zi");var t=document.createElement("div");t.classList.add("aj");var a=document.createElement("div");a.classList.add("cj"),a.appendChild((0,v.YC)("calendar_view_day"));var i=document.createElement("div");i.classList.add("ej");var n=document.createElement("div");n.classList.add("fj");var r=document.createElement("div");return r.classList.add("hj"),t.appendChild(a),t.appendChild(i),t.appendChild(n),e.appendChild(t),e.appendChild(r),e}function oe(e,t,a){var i,n;function s(e,i,n){function s(e,t,a){var i=e.getBoundingClientRect(),n=i.top,r=i.left,s=i.bottom,d=i.right,o=window.innerWidth,l=window.innerHeight,c=(0,u.aI)(e,".zh"),p=(0,u.aI)(c,".ri"),h=(0,u.aI)(p,"._a"),v=(0,u.aI)(p,".ab");h.setAttribute("code",t.status.code.toString()),h.innerText=t.status.text,a&&s>0&&n<l&&d>0&&r<o?(v.addEventListener("animationend",function(){v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text,v.classList.remove("kb"),h.setAttribute("displayed","false")},{once:!0}),h.setAttribute("displayed","true"),v.classList.add("kb")):(v.setAttribute("code",t.status.code.toString()),v.innerText=t.status.text)}function o(e,t,a){var i=e.getBoundingClientRect(),n=i.top,r=i.left,s=i.bottom,d=i.right,o=window.innerWidth,l=window.innerHeight,c=(0,u.aI)(e,".zh"),p=(0,u.aI)(c,"._h"),h=(0,u.aI)(p,".bi"),v=(0,u.aI)(p,".ci");h.setAttribute("code",t.ranking.code.toString()),h.innerText=t.ranking.text,a&&s>0&&n<l&&d>0&&r<o?(v.addEventListener("animationend",function(){v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text,v.classList.remove("li"),h.setAttribute("displayed","false")},{once:!0}),h.setAttribute("displayed","true"),v.classList.add("li")):(v.setAttribute("code",t.ranking.code.toString()),v.innerText=t.ranking.text)}function l(e,t){var a=(0,u.aI)(e,".zh");(0,u.aI)(a,".mi").innerText=t.route_direction}function c(e,t){var a=(0,u.aI)(e,".zh");(0,u.aI)(a,".ni").innerText=t.route_name}function v(e,t){var a=(0,u.aI)(e,".si"),i=(0,u.aI)(a,".wi"),n=(0,u.jg)(i,".yi"),r=n.length,s=t.buses.length,d=r-s;if(d<0){for(var o=new DocumentFragment,l=0,c=Math.abs(d);l<c;l++){var h=se();o.appendChild(h)}i.append(o)}else for(var v=0,m=Math.abs(d);v<m;v++){n[r-1-v].remove()}for(var f=(0,u.jg)(i,".yi"),g=0;g<s;g++){var b=t.buses[g],y=f[g],A=(0,u.aI)(y,"._i"),C=(0,u.aI)(A,".dj"),I=(0,u.aI)(y,".gj"),L=(0,u.aI)(I,".ij"),x=(0,u.aI)(I,".jj"),E=(0,u.aI)(I,".kj");y.setAttribute("on-this-route",(0,p.xZ)(b.onThisRoute)),C.innerText=b.carNumber,L.innerText=`路線：${b.RouteName}`,x.innerText=`狀態：${b.status.text}`,E.innerText=`類型：${b.type}`}i.setAttribute("empty",(0,p.xZ)(0===s))}function m(e,t){var a=(0,u.aI)(e,".si"),i=(0,u.aI)(a,".xi"),n=(0,u.jg)(i,".zi"),r=n.length,s=t.busArrivalTimes.length,d=r-s;if(d<0){for(var o=new DocumentFragment,l=0,c=Math.abs(d);l<c;l++){var v=de();o.appendChild(v)}i.append(o)}else for(var m=0,f=Math.abs(d);m<f;m++){n[r-1-m].remove()}for(var g=(0,u.jg)(i,".zi"),b=0;b<s;b++){var y=t.busArrivalTimes[b],A=g[b],C=(0,u.aI)(A,".aj"),I=(0,u.aI)(C,".ej"),L=(0,u.aI)(C,".fj"),x=(0,u.aI)(A,".hj");I.innerText=y.personalSchedule.name,L.innerText=`週${(0,h.kd)(y.day).name} ${(0,h.pn)(y.personalSchedule.period.start)} - ${(0,h.pn)(y.personalSchedule.period.end)}`,x.innerHTML=y.chart}i.setAttribute("empty",(0,p.xZ)(0===s))}function f(e,t){t&&e.setAttribute("stretched","false")}function y(e,t){e.setAttribute("animation",(0,p.xZ)(t))}function A(e,t){e.setAttribute("skeleton-screen",(0,p.xZ)(t))}function C(e,t){var a=(0,u.aI)(e,".si"),i=(0,u.aI)(a,".ti"),n=(0,u.aI)(i,'.ui[type="save-to-folder"]');n.onclick=function(){(0,g.B)("stop",[t.stopId,t.routeId],n)},(0,r.LH)("stop",t.stopId).then(function(e){n.setAttribute("highlighted",(0,p.xZ)(e))})}function I(e,t){var a=(0,u.aI)(e,".si"),i=(0,u.aI)(a,".ti"),n=(0,u.aI)(i,'.ui[type="schedule-notification"]');n.onclick=function(){(0,b.Ho)(n,t.stopId,t.routeId,t.status.time)};var r=(0,d.Zc)(t.stopId);n.setAttribute("highlighted",(0,p.xZ)(r))}null==n?(s(e,i,a),o(e,i,a),l(e,i),c(e,i),v(e,i),m(e,i),f(e,t),y(e,a),A(e,t),C(e,i),I(e,i)):(i.status.time!==n.status.time&&(s(e,i,a),I(e,i)),n.ranking.number===i.ranking.number&&n.ranking.code===i.ranking.code||o(e,i,a),n.stopId!==i.stopId&&(l(e,i),c(e,i),C(e,i)),(0,p.hw)(n.buses,i.buses)||v(e,i),(0,p.hw)(n.busArrivalTimes,i.busArrivalTimes)||m(e,i),a!==Z&&y(e,a),t!==z&&(f(e,t),A(e,t)))}function o(e,i,n){function r(e,t){var a=(0,u.aI)(e,".th");(0,v.yD)(a,t.icon)}function s(e,t){(0,u.aI)(e,".uh").innerHTML=t.value}function d(e,t){e.setAttribute("animation",(0,p.xZ)(t))}function o(e,t){e.setAttribute("skeleton-screen",(0,p.xZ)(t))}null==n?(r(e,i),s(e,i),d(e,a),o(e,t)):((0,p.hw)(n.icon,i.icon)||r(e,i),(0,p.hw)(n.value,i.value)||s(e,i),a!==Z&&d(e,a),t!==z&&o(e,t))}var l=e.groupQuantity,m=e.itemQuantity,f=e.groupedItems,C=e.groups;D=l;for(var I=0,L=0;L<l;L++){var x=`g_${L}`,S=(0,c.q_)(C[x].name,500,"17px",'"Noto Sans TC", sans-serif')+20;Q[x]={width:S,offset:I},I+=S}if(Q[`g_${l}`]={width:0,offset:I},!R){var $=Q[`g_${N}`],P=-1*$.offset+.5*(0,y.YC)("window")[0]-.5*$.width,q=$.width-20;ee(D,P,q,N)}(null===(i=Y)||void 0===i?void 0:i.hash)!==e.hash&&(_.onclick=function(){(0,A.ID)(e.hash)}),(null===(n=Y)||void 0===n?void 0:n.LocationName)!==e.LocationName&&(w.innerText=e.LocationName),Z!==a&&(E.setAttribute("animation",(0,p.xZ)(a)),k.setAttribute("animation",(0,p.xZ)(a))),z!==t&&(E.setAttribute("skeleton-screen",(0,p.xZ)(t)),k.setAttribute("skeleton-screen",(0,p.xZ)(t)),M.setAttribute("skeleton-screen",(0,p.xZ)(t)));var H=(0,u.jg)(j,".ph").length;if(l!==H){var B=H-l;if(B<0){for(var F=new DocumentFragment,J=new DocumentFragment,U=0,W=Math.abs(B);U<W;U++){var K=ie();F.appendChild(K);var O=ne();J.appendChild(O)}j.append(F),T.append(J)}else for(var X=(0,u.jg)(j,".ph"),G=(0,u.jg)(T,".gh"),V=0,te=Math.abs(B);V<te;V++){var oe=H-1-V;X[oe].remove(),G[oe].remove()}}for(var le=(0,u.jg)(j,".ph"),ue=0;ue<l;ue++){var ce=`g_${ue}`,pe=le[ue],he=(0,u.jg)(pe,".xh .yh").length;if(m[ce]!==he){var ve=he-m[ce];if(ve<0)for(var me=(0,u.aI)(pe,".xh"),fe=0,ge=Math.abs(ve);fe<ge;fe++){var be=ae();me.appendChild(be)}else for(var ye=(0,u.jg)(pe,".xh .yh"),Ae=0,Ce=Math.abs(ve);Ae<Ce;Ae++){ye[he-1-Ae].remove()}}var Ie=(0,u.jg)((0,u.jg)(j,".ph")[ue],".qh .rh .sh").length,Le=C[ce].properties.length;if(Le!==Ie){var xe=Ie-Le;if(xe<0)for(var Ee=(0,u.aI)(pe,".qh"),we=(0,u.aI)(Ee,".rh"),_e=0,je=Math.abs(xe);_e<je;_e++){var ke=re();we.appendChild(ke)}else for(var Te=(0,u.aI)(pe,".qh"),Me=(0,u.aI)(Te,".rh"),Se=(0,u.jg)(Me,".sh"),$e=0,Ye=Math.abs(xe);$e<Ye;$e++){Se[Ie-1-$e].remove()}}}for(var Ze=(0,u.jg)(T,".gh"),ze=(0,u.jg)(j,".ph"),Ne=0;Ne<l;Ne++){var Pe=`g_${Ne}`,De=Ze[Ne];(0,u.aI)(De,"span").innerText=C[Pe].name,De.style.setProperty("--ug",`${Q[Pe].width}px`),De.style.setProperty("--hh",Ne.toString());for(var Qe=ze[Ne],Re=(0,u.jg)(Qe,".qh .rh .sh"),qe=(0,u.jg)(Qe,".xh .yh"),He=C[Pe].properties.length,Be=0;Be<He;Be++){var Fe=C[Pe].properties[Be],Je=Re[Be];if((0,p.mQ)(Y,"groups"))if((0,p.mQ)(Y.groups,Pe))if(Y.groups[Pe].properties[Be])o(Je,Fe,Y.groups[Pe].properties[Be]);else o(Je,Fe,null);else o(Je,Fe,null);else o(Je,Fe,null)}for(var Ue=0;Ue<m[Pe];Ue++){var We=qe[Ue],Ke=f[Pe][Ue];if((0,p.mQ)(Y,"groupedItems"))if((0,p.mQ)(Y.groupedItems,Pe))if(Y.groupedItems[Pe][Ue])s(We,Ke,Y.groupedItems[Pe][Ue]);else s(We,Ke,null);else s(We,Ke,null);else s(We,Ke,null)}}Y=e,Z=a,z=t}function le(){return ue.apply(this,arguments)}function ue(){return(ue=(0,i.A)(function*(){var e=(0,l.Js)("playing_animation"),t=(0,l.Js)("refresh_interval");F=t.dynamic,q=t.baseInterval,K=!0,W=(0,p.zx)(),$.setAttribute("refreshing","true"),$.classList.remove("nh"),document.addEventListener(W,te);var a=yield(0,s.R)(G,(0,y.YC)("location_bus_arrival_time_chart")[0],(0,y.YC)("location_bus_arrival_time_chart")[1],W);oe(a,!1,e);var i=0;F&&(i=yield(0,n.wz)()),J=(new Date).getTime(),U=F?Math.max(J+H,a.dataUpdateTime+q/i):J+q,B=Math.max(H,U-J),K=!1,$.setAttribute("refreshing","false"),$.style.setProperty("--zg",`${B}ms`),$.classList.add("nh")})).apply(this,arguments)}function ce(){le().then(function(){O?setTimeout(function(){ce()},Math.max(H,U-(new Date).getTime())):X=!1}).catch(function(e){O?((0,f.a)("error","地點網路連線中斷，將在10秒後重試。"),setTimeout(function(){ce()},1e4)):X=!1})}function pe(e){(0,m.WR)("Location"),(0,o.XK)("location",e),G=e,N=0,Q={},L.setAttribute("displayed","true"),j.scrollLeft=0,j.focus(),function(e){for(var t=(0,l.Js)("playing_animation"),a={g_0:Math.floor((0,y.YC)("window")[1]/50)+5,g_1:Math.floor((0,y.YC)("window")[1]/50)+5},i={},n=0;n<2;n++){var r=`g_${n}`;i[r]=[];for(var s=0;s<a[r];s++)i[r].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}oe({groupedItems:i,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]}},itemQuantity:a,LocationName:"載入中",hash:e,dataUpdateTime:0},!0,t)}(e),O||(O=!0,X?le():(X=!0,ce())),(0,m.Z_)()}function he(){L.setAttribute("displayed","false"),O=!1,(0,m.l$)()}function ve(e,t){var a,i=(0,u.aI)(e,".si"),n=(0,u.aI)(i,".ti"),r=C((0,u.jg)(n,'.ui[highlighted="true"][type="tab"]'));try{for(r.s();!(a=r.n()).done;){a.value.setAttribute("highlighted","false")}}catch(e){r.e(e)}finally{r.f()}switch((0,u.aI)(n,`.ui[code="${t}"]`).setAttribute("highlighted","true"),t){case 0:(0,u.aI)(e,".wi").setAttribute("displayed","true"),(0,u.aI)(e,".xi").setAttribute("displayed","false");break;case 1:(0,u.aI)(e,".wi").setAttribute("displayed","false"),(0,u.aI)(e,".xi").setAttribute("displayed","true")}}}}]);
//# sourceMappingURL=0f889d79e95883d5aacf.js.map