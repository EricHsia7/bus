"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[537],{4131(t,e,n){n.d(e,{a:()=>$,b:()=>A,c:()=>k});var a=n(467),i=n(2937),r=n(8179),o=n(7968),d=n(8024),c=n(5579),l=n(904),s=(0,r.c)(".f"),u=(0,r.e)(s,".g"),f=(0,r.e)(u,".h"),p=(0,r.e)(s,".i"),v=Array.from((0,r.d)(p,".j")),h=new Date,g={},m=["","",""],b=0,y=!1;function w(t,e,n){for(var a="'Noto Sans TC', sans-serif",i=[],r=[],d=0;d<24;d++){var l=`${d.toString().padStart(2,"0")}:00`,s=70*d+10;i.push(`M35 ${s}`,"h"+(n-35)),r.push(`<text x="5" y="${s+3}" font-weight="400" font-size="10" font-family="${a}" component="gridline-label">${l}</text>`)}for(var u=`<path d="${i.join(" ")}" fill="none" stroke-width="0.35" component="gridline"/>`,f=1700,p=e.getDay(),v=p<1?6:p-1,h=t.repeated[v],g=t.scheduled,m=(0,c.h)(e,0,0,t.timeZoneOffset-e.getTimezoneOffset()),b=[m.getFullYear(),m.getMonth()+1,m.getDate()],y=g.length-1;y>=0;y--)b[0]===g[y].date[0]&&b[1]===g[y].date[1]&&b[2]===g[y].date[2]&&h.push({type:"repeated",time:g[y].time,interval:g[y].interval,count:g[y].count,day:p});for(var w=[],x=[],k=[],$=h.length-1;$>=0;$--){var A=h[$].time[0]/1440*f,D=n-35,T=(h[$].time[1]-h[$].time[0])/1440*f,S=h[$].time[0]%60,C=(h[$].time[0]-S)/60,M=h[$].time[1]%60,L=(h[$].time[1]-M)/60,_=`${C.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")} - ${L.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}`,Y=`每${h[$].interval[0]===h[$].interval[1]?h[$].interval[0]:h[$].interval.join(" - ")}分鐘一班 | ${h[$].count[0]===h[$].count[1]?h[$].count[0]:h[$].count.join(" - ")}班`;Array.prototype.push.apply(w,(0,o.b)(35,A,D,T,5,!1)),x.push(`M38 ${A+3}`,"v"+(T-6)),k.push(`<text x="44" y="${A+3+17}" font-weight="500" font-size="15" font-family="${a}" component="event-title">${_}</text>`,`<text x="44" y="${A+3+17+17}" font-weight="500" font-size="15" font-family="${a}" component="event-description">${Y}</text>`)}var j=`<path d="${w.join(" ")}" stroke="none" component="event-box"/>`,F=`<path d="${x.join(" ")}" fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" component="event-decoration"/>`;return`<svg width="${n}" height="1700" viewBox="0 0 ${n} 1700" xmlns="http://www.w3.org/2000/svg">${u}${r.join("")}${j}${F}${k.join("")}</svg>`}function x(){return(x=(0,a.a)(function*(t){var e=(0,l.d)("window");b=e.width,h=new Date;var n=(0,d.c)(),a=yield(0,i.a)(t,n);g=a;for(var r=0;r<3;r++){var o=(0,c.h)(h,r-1,0,0);m[r]=w(a,o,b),v[r].innerHTML=m[r]}f.innerText=(0,c.c)(h,"YYYY-MM-DD WW"),y||(y=!0,p.addEventListener("scrollend",function(){var t=p.scrollLeft,e=Math.round(t/b);if(0===e){h=(0,c.h)(h,-1,0,0);var n=(0,c.h)(h,-1,0,0);v[0].before(v[2]),p.scrollTo({left:b});var a=[v[2],v[0],v[1]];v[0]=a[0],v[1]=a[1],v[2]=a[2];var i=[w(g,n,b),m[0],m[1]];m[0]=i[0],m[1]=i[1],m[2]=i[2],v[0].innerHTML=m[0],f.innerText=(0,c.c)(h,"YYYY-MM-DD WW")}else if(2===e){h=(0,c.h)(h,1,0,0);var r=(0,c.h)(h,1,0,0);v[2].after(v[0]),p.scrollTo({left:b});var o=[v[1],v[2],v[0]];v[0]=o[0],v[1]=o[1],v[2]=o[2];var d=[m[1],m[2],w(g,r,b)];m[0]=d[0],m[1]=d[1],m[2]=d[2],v[2].innerHTML=m[2],f.innerText=(0,c.c)(h,"YYYY-MM-DD WW")}}),p.scrollTo({left:b}))})).apply(this,arguments)}function k(){s.setAttribute("displayed","true")}function $(){s.setAttribute("displayed","false")}function A(t){(0,l.c)("RouteCalendar"),k(),function(t){x.apply(this,arguments)}(t),(0,l.b)()}},5286(t,e,n){n.d(e,{a:()=>N,b:()=>Q,c:()=>I,d:()=>Z,e:()=>X,f:()=>U,g:()=>V,h:()=>K});var a=n(467),i=n(9566),r=n(8621),o=n(3459),d=n(8179),c=n(8024),l=n(904),s=n(3041),u=n(8134),f=n(9469),p=n(251),v=n(8279);function h(){return(h=(0,a.a)(function*(t){var e=yield(0,u.e)(t);if(!1!==e){var n=(0,f.a)(0,{id:t,name:e.n});(0,p.b)(e.n,n)}})).apply(this,arguments)}function g(){return(g=(0,a.a)(function*(t){var e=yield(0,u.e)(t);if(!1!==e){var n=(0,f.a)(0,{id:t,name:e.n});(0,v.c)(n)}})).apply(this,arguments)}var m=n(7968),b=n(6141),y='"Noto Sans TC", sans-serif',w=(0,l.d)("route-details-canvas"),x=w.width,k=w.height,$=Math.min(window.devicePixelRatio,1.875)||1,A={};function D(){var t=(0,d.a)();return t.classList.add("k"),t}function T(){var t=(0,d.a)();t.classList.add("l");var e=document.createElement("canvas");return e.classList.add("m"),t.appendChild(e),t}function S(t,e,n,a,i,r){t.innerText=e.name,t.setAttribute("day",r.toString()),t.onclick=function(){!function(t){for(var e=(0,o.b)("playing_animation"),n=(0,d.d)(N,".k"),a=(0,d.d)(Q,".l"),i=0;i<7;i++){var r,c,l=n[i],s=a[i],u=`d_${i}`,f=null===(r=A)||void 0===r?void 0:r.calendarEventGroups[u],p=null===(c=A)||void 0===c?void 0:c.calendarDays[u];if(f&&p){var v=(0,b.a)("--b"),h=(0,b.a)("--n"),g=(0,b.a)("--o");S(l,p,t,!1,e,i),C(s,f,t,v,h,g,i)}}}(r)},t.setAttribute("highlighted",n===r?"true":"false"),t.setAttribute("animation",(0,c.a)(i)),t.setAttribute("skeleton-screen",(0,c.a)(a))}function C(t,e,n,a,i,r,o){function s(t,e,n){var a=70*e;t.fillStyle=n,t.fillRect(45,a+5,x-45,1.2),t.font=`400 12px ${y}`,t.textBaseline="top";var i=`${String(e).padStart(2,"0")}:00`,r=t.measureText(i),o=r.width,d=r.actualBoundingBoxDescent;t.fillText(i,(45-o)/2,a+(10-d)/2,o)}function u(t,e,n,a){var i=new Date;i.setDate(1),i.setMonth(0),i.setFullYear(e.date.getFullYear()),i.setMonth(e.date.getMonth()),i.setDate(e.date.getDate()),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0);var r=(e.date.getTime()-i.getTime())/864e5*24*70,o=x-45,d=60*e.duration*1e3/864e5*24*70;(0,m.a)(t,45,r,o,d,3,a),(0,m.a)(t,45,r,3,d,{tl:3,tr:0,bl:3,br:0},n),t.font=`400 14px ${y}`,t.textBaseline="top",t.fillStyle=n;var c=e.dateString,l=t.measureText(c),s=l.width,u=l.actualBoundingBoxDescent;t.fillText(c,53,r+(d-u)/2,s)}var f=(0,d.e)(t,".m"),p=f.getContext("2d");if(function(t,e,n){var a=e===n;t.setAttribute("displayed",(0,c.a)(a))}(t,n,o),function(t){w=(0,l.d)("route-details-canvas"),x=w.width,k=w.height,$=Math.min(window.devicePixelRatio,1.875)||1,t.width=x*$,t.height=k*$;var e=t.getContext("2d");e.setTransform(1,0,0,1,0,0),e.scale($,$)}(f),n===o){p.clearRect(0,0,x,k);for(var v=0;v<24;v++)s(p,v,r);for(var h of e)u(p,h,a,i)}else p.clearRect(0,0,x,k)}function M(t,e,n){var a=(new Date).getDay(),i=(0,b.a)("--b"),r=(0,b.a)("--n"),o=(0,b.a)("--o"),c=t.calendarDays,l=t.calendarDayQuantity,s=t.calendarEventGroups,u=(t.calendarEventQuantity,Array.from((0,d.d)(Q,".l"))),f=Array.from((0,d.d)(N,".k")),p=u.length;if(l!==p){var v=p-l;if(v<0){for(var h=new DocumentFragment,g=new DocumentFragment,m=0;m>v;m--){var y=D();h.appendChild(y),f.push(y);var w=T();g.appendChild(w),u.push(w)}N.append(h),Q.append(g)}else if(v>0)for(var x=p-1,k=p-v-1;x>k;x--)f[x].remove(),f.splice(x,1),u[x].remove(),u.splice(x,1)}for(var $=0;$<l;$++){var M=`d_${$}`,L=c[M],_=s[M],Y=f[$],j=u[$];S(Y,L,a,e,n,$),C(j,_,a,i,r,o,$)}A=t}var L=n(4537),_=[],Y=!1,j=!1;function F(){var t=(0,d.a)();t.classList.add("p");var e=(0,d.a)();e.classList.add("q"),e.appendChild((0,L.a)()),t.appendChild(e);var n=(0,d.a)();return n.classList.add("r"),t.appendChild(n),t}function E(t,e,n){function a(t,a,i){function r(t,e){var n=(0,d.e)(t,".q");(0,L.c)(n,e.icon)}function o(t,e){(0,d.e)(t,".r").innerText=e.value}function l(t,e){t.setAttribute("animation",(0,c.a)(e))}function s(t,e){t.setAttribute("skeleton-screen",(0,c.a)(e))}null==i?(r(t,a),o(t,a),l(t,n),s(t,e)):((0,c.b)(i,a)||r(t,a),(0,c.b)(i,a)||o(t,a),Y!==n&&l(t,n),j!==e&&s(t,e))}var i=t.length;e!==j&&Z.setAttribute("skeleton-screen",(0,c.a)(e));var r=Array.from((0,d.d)(I,".p")),o=r.length;if(i!==o){var l=o-i;if(l<0){for(var s=new DocumentFragment,u=0;u>l;u--){var f=F();s.appendChild(f),r.push(f)}I.append(s)}else if(l>0)for(var p=o-1,v=o-l-1;p>v;p--)r[p].remove(),r.splice(p,1)}for(var h=0;h<i;h++){var g=r[h],m=t[h];0===_.length?a(g,m,null):a(g,m,_[h])}_=t,Y=n,j=e}var R=(0,d.c)(".s"),z=(0,d.e)(R,".t"),B=(0,d.e)(z,".u"),H=(0,d.e)(B,'.v[group="calendar"]'),W=(0,d.e)(H,".w"),N=(0,d.e)(W,".x"),Q=(0,d.e)(W,".y"),q=(0,d.e)(R,'.t .u .v[group="actions"]'),G=(0,d.e)(q,'.w .z[action="save-to-folder"]'),O=(0,d.e)(q,'.w .z[action="get-permalink"]'),P=(0,d.e)(q,'.w .z[action="show-permalink-qrcode"]'),Z=(0,d.e)(B,'.v[group="properties"]'),I=(0,d.e)(Z,".w");function J(){return J=(0,a.a)(function*(t,e){var n=(0,o.b)("playing_animation"),a=yield(0,i.e)("route",t);G.setAttribute("animation",(0,c.a)(n)),G.setAttribute("highlighted",(0,c.a)(a)),G.onclick=function(){(0,s.c)("route",[t],G)},O.setAttribute("animation",(0,c.a)(n)),O.onclick=function(){!function(t){h.apply(this,arguments)}(t)},P.setAttribute("animation",(0,c.a)(n)),P.onclick=function(){!function(t){g.apply(this,arguments)}(t)},function(){for(var t=(0,o.b)("playing_animation"),e=[],n=0;n<5;n++)e.push({key:n,icon:"none",value:""});E(e,!0,t)}(),function(){for(var t=(0,o.b)("playing_animation"),e={d_0:47,d_1:47,d_2:47,d_3:47,d_4:47,d_5:47,d_6:47},n={},a={},i=0;i<7;i++){var r=`d_${i}`;n[r]=[],a[r]={day:i,code:"d_{i}",name:""};for(var d=0;d<e[r];d++){var c=new Date;c.setHours(0),c.setMinutes(30*d),c.setSeconds(0),c.setMilliseconds(0),n[r].push({date:c,dateString:"",duration:15})}}M({calendarEventGroups:n,calendarDays:a,calendarDayQuantity:7,calendarEventQuantity:e},!0,t)}();var d=(0,c.c)(),l=yield(0,r.a)(t,e,d);E(l.properties,!1,n),M(l.calendar,!1,n)}),J.apply(this,arguments)}function K(){R.setAttribute("displayed","true")}function U(){R.setAttribute("displayed","false")}function V(t,e){(0,l.c)("RouteDetails"),K(),function(t,e){J.apply(this,arguments)}(t,e),(0,l.b)()}function X(){U(),(0,l.i)(),(0,l.e)("RouteDetails");var t=(0,d.d)(Q,".l");for(var e of t)e.remove();var n=(0,d.d)(N,".k");for(var a of n)a.remove()}},3041(t,e,n){n.d(e,{a:()=>k,b:()=>w,c:()=>x,d:()=>y});var a=n(9566),i=n(8179),r=n(8024),o=n(6052),d=n(4537),c=n(904),l=n(9119),s=(0,i.c)("._"),u=(0,i.e)(s,".aa"),f=(0,i.e)(u,".ba"),p=(0,i.e)(s,".ca"),v=(0,i.e)(p,".da"),h="已儲存至資料夾",g="無法儲存";function m(t,e,n,o){var c=(0,i.a)();c.classList.add("ea");var s=(0,i.a)();s.classList.add("fa");var u=document.createElement("span");u.appendChild((0,d.b)(t.icon)),s.appendChild(u);var f=(0,i.a)();switch(f.classList.add("ga"),f.innerText=t.name,c.appendChild(s),c.appendChild(f),e){case"stop":c.onclick=function(){(0,a.n)(t.id,n[0],n[1]).then(function(t){t?(0,a.e)("stop",n[0]).then(function(t){t&&(null!=o&&o.setAttribute("highlighted",(0,r.a)(t)),(0,l.a)("folder",h),k())}):(0,l.a)("warning",g)})};break;case"route":c.onclick=function(){(0,a.m)(t.id,n[0]).then(function(t){t?(0,a.e)("route",n[0]).then(function(t){t&&(null!=o&&o.setAttribute("highlighted",(0,r.a)(t)),(0,l.a)("folder",h),k())}):(0,l.a)("warning",g)})};break;case"location":c.onclick=function(){(0,a.l)(t.id,n[0]).then(function(t){t?(0,a.e)("location",n[0]).then(function(t){t&&(null!=o&&o.setAttribute("highlighted",(0,r.a)(t)),(0,l.a)("folder",h),k())}):(0,l.a)("warning",g)})}}return c}function b(t,e,n){v.onclick=function(){(0,o.c)(function(){b(t,e,n)})};var i=(0,a.j)();f.innerHTML="";var r=new DocumentFragment;for(var d of i){var c=m(d,t,e,n);r.appendChild(c)}f.append(r)}function y(){s.setAttribute("displayed","true")}function w(){s.setAttribute("displayed","false")}function x(t,e,n){(0,c.c)("SaveToFolder"),y(),b(t,e,n),(0,c.b)()}function k(){w(),(0,c.i)(),(0,c.e)("SaveToFolder")}},752(t,e,n){n.d(e,{a:()=>h,b:()=>p,c:()=>v,d:()=>f});var a=n(3422),i=n(8179),r=n(4537),o=n(904),d=n(9119),c=(0,i.c)(".ha"),l=(0,i.e)(c,".ia"),s=(0,i.e)(l,".ja");function u(t,e,n,o,c){var l=(0,i.a)();l.classList.add("ka");var s=(0,i.a)();s.classList.add("la");var u=document.createElement("span");u.appendChild((0,r.b)(t.icon)),s.appendChild(u);var f=(0,i.a)();f.classList.add("ma"),f.innerText=t.name;var p=t.index;return l.onclick=function(){!function(t,e,n,i,r){(0,d.a)("manufacturing","處理中"),t.setAttribute("enabled","false"),h(),(0,a.m)(e,n,i,r).then(function(e){switch(e){case 0:(0,d.a)("error","設定失敗"),t.setAttribute("enabled","true");break;case 1:(0,d.a)("check_circle","設定成功"),t.setAttribute("enabled","true"),t.setAttribute("highlighted","true");break;case 2:(0,d.a)("warning","在設定中註冊後才可設定到站通知"),t.setAttribute("enabled","true")}})}(e,n,o,c,p)},l.appendChild(s),l.appendChild(f),l}function f(){c.setAttribute("displayed","true")}function p(){c.setAttribute("displayed","false")}function v(t,e,n,i){(0,o.c)("ScheduleNotification"),f(),function(t,e,n,i){s.innerHTML="";var r=new DocumentFragment;for(var o of a.n){var d=u(o,t,e,n,i);r.appendChild(d)}s.append(r)}(t,e,n,i),(0,o.b)()}function h(){p(),(0,o.i)(),(0,o.e)("ScheduleNotification")}},4680(){},7820(){},1580(){},3127(){},7868(){},1306(){},3058(){},6388(){},1102(){},1743(){},6597(){},3777(){},9991(){},2421(){},2696(){},5461(){},5392(){},3534(){},6018(){},7225(){},1308(){},7723(){},1603(){},3749(){},7217(){},7287(){}}]);
//# sourceMappingURL=3420e03d29c3ac520131.js.map