"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[1496,8097],{77(t,e,r){r.d(e,{D7:()=>A,FX:()=>D,G7:()=>I,M3:()=>m,VJ:()=>$,Zc:()=>x,e3:()=>k,hc:()=>w,mD:()=>L,ms:()=>b,ph:()=>p,se:()=>h,uQ:()=>O});var n=r(467),i=r(8024),a=r(8011),o=r(4293),u=r(424),s=r(6788),f=r(3459),l=r(4311),c=r(3447);function d(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var p="",m="",h="",v=[],_={},g={};function b(){return S.apply(this,arguments)}function S(){return(S=(0,n.A)(function*(){var t={provider:p,client_id:m,secret:h};yield(0,l.mL)(9,"n_client",JSON.stringify(t))})).apply(this,arguments)}function w(){return""!==m&&""!==h}function A(){return String(p)}function O(t){void 0!==t&&(h=String(t))}function I(t,e,r,n,i,a,o,u,s,f){return N.apply(this,arguments)}function N(){return(N=(0,n.A)(function*(t,e,r,n,i,a,o,u,s,f){var c={schedule_id:t,stop_id:e,location_name:r,route_id:n,route_name:i,direction:a,estimate_time:o,time_formatting_mode:u,time_offset:s,scheduled_time:f},d=`s_${e}`,y=v.length;v.push(c),_[t]=y,g.hasOwnProperty(d)||(g[d]=[]),g[d].push(y),yield(0,l.mL)(10,t,JSON.stringify(c))})).apply(this,arguments)}function $(t){return J.apply(this,arguments)}function J(){return(J=(0,n.A)(function*(t){if(_.hasOwnProperty(t)){var e=_[t],r=`s_${v[e].stop_id}`;v.splice(e,1,null),g[r].splice(g[r].indexOf(e),1),delete _[t],yield(0,l.iQ)(10,t)}})).apply(this,arguments)}function x(t){var e=(new Date).getTime(),r=`s_${t}`;if(g.hasOwnProperty(r)){var n,i=d(g[r]);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=v[a];if(null!==o)if(o.scheduled_time>e)return!0}}catch(t){i.e(t)}finally{i.f()}}return!1}function k(t){return C.apply(this,arguments)}function C(){return(C=(0,n.A)(function*(t){var e,r=yield(0,o.a)(t,!0),n=function(){var t,e=(new Date).getTime(),r=[],n=d(v);try{for(n.s();!(t=n.n()).done;){var i=t.value;null!==i&&i.scheduled_time>e&&r.push(i)}}catch(t){n.e(t)}finally{n.f()}return r}(),i=(new Date).getTime(),a=[],u=d(n);try{for(u.s();!(e=u.n()).done;){var f=e.value,l={},c=f.location_name;l.name=c;var y=f.stop_id;l.stop_id=y;var p=f.estimate_time;l.estimate_time=p;var m=f.schedule_id;l.schedule_id=m;var h=f.scheduled_time;l.scheduled_time=h;var _=new Date(h),g=_.getDate(),b=_.getHours(),S=_.getMinutes();l.date=String(g).padStart(2,"0"),l.hours=String(b).padStart(2,"0"),l.minutes=String(S).padStart(2,"0"),l.route={};var w=f.route_name;l.route.name=w;var A=f.route_id;l.route.id=A;var O=f.direction;l.route.direction=O;var I=`r_${f.route_id}`;if(r.hasOwnProperty(I)){var N=r[I].pid;l.route.pathAttributeId=N,a.push(l)}}}catch(t){u.e(t)}finally{u.f()}a.sort(function(t,e){return t.scheduled_time-e.scheduled_time});for(var $=[],J=0,x={},k=0,C=a;k<C.length;k++){var D=C[k],L=`g_${D.date}_${D.hours}`;x.hasOwnProperty(L)?D.is_first=!1:(x[L]=!0,D.is_first=!0),$.push(D),J+=1}var P={items:$,itemQuantity:J,dataUpdateTime:Math.max((0,s.Zt)(t),i)};return(0,s.gC)(t),(0,s.LQ)(t),P})).apply(this,arguments)}var D=[{name:"到站前5分鐘",time_offset:-5,icon:"clock_loader_10",index:0},{name:"到站前10分鐘",time_offset:-10,icon:"clock_loader_20",index:1},{name:"到站前15分鐘",time_offset:-15,icon:"clock_loader_40",index:2},{name:"到站前20分鐘",time_offset:-20,icon:"clock_loader_60",index:3},{name:"到站前25分鐘",time_offset:-25,icon:"clock_loader_80",index:4},{name:"到站前30分鐘",time_offset:-30,icon:"clock_loader_90",index:5}];function L(t,e,r,n){return P.apply(this,arguments)}function P(){return(P=(0,n.A)(function*(t,e,r,n){if(w()){var l=(0,f.Js)("time_formatting_mode"),d=(0,i.zx)(),y=yield(0,u.T)(d),p=yield(0,a.g)(d,0),m=yield(0,o.a)(d,!0);(0,s.LQ)(d),(0,s.gC)(d);var h=`s_${t}`,v={};if(!y.hasOwnProperty(h))return 0;var _=(v=y[h]).stopLocationId,g=v.goBack,b=`l_${_}`;if(!p.hasOwnProperty(b))return 0;var S=p[b].n,A=`r_${e}`,O={};if(!m.hasOwnProperty(A))return 0;var I=(O=m[A]).n,N=O.dep,$=[O.des,N,""][g?parseInt(g):0],J=D[n].time_offset,x=(new Date).getTime()+1e3*r+60*J*1e3;return!1===(yield(0,c.Z)(t,S,e,I,$,r,l,J,x))?0:1}return 2})).apply(this,arguments)}},3937(t,e,r){r(77),r(4778),r(2571)},5314(t,e,r){r.d(e,{DF:()=>m,Qj:()=>c,XK:()=>y});var n=r(467),i=r(8024),a=r(9734),o=r(8011),u=r(4293),s=(r(6788),r(4311));function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return l(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(){return d.apply(this,arguments)}function d(){return(d=(0,n.A)(function*(){var t,e=[],r=(new Date).getTime(),n=f(yield(0,s.Su)(8));try{for(n.s();!(t=n.n()).done;){var i=t.value,a=yield(0,s.Ct)(8,i),o=JSON.parse(a);r-new Date(o.time).getTime()<=12096e5&&e.push(o)}}catch(t){n.e(t)}finally{n.f()}return 0===e.length&&e.push({type:"empty",time:(new Date).toISOString(),name:"沒有內容",id:0}),e})).apply(this,arguments)}function y(t,e){return p.apply(this,arguments)}function p(){return(p=(0,n.A)(function*(t,e){var r=(0,i.zx)(),n=`${t}_${e}`,f=(new Date).toISOString(),l=yield(0,s.Ct)(8,n);if(l){var c=JSON.parse(l);c.time=f,yield(0,s.mL)(8,n,JSON.stringify(c))}else switch(t){case"route":var d=yield(0,u.a)(r,!0),y=`r_${e}`;if(d.hasOwnProperty(y)){var p={type:"route",time:f,name:d[y].n,id:e};yield(0,s.mL)(8,n,JSON.stringify(p))}break;case"location":var m=yield(0,o.g)(r,1),h=`ml_${e}`;if(m.hasOwnProperty(h)){var v={type:"location",time:f,name:m[h].n,hash:e};yield(0,s.mL)(8,n,JSON.stringify(v))}break;case"bus":var _=yield(0,a.j)(r,!0),g=`c_${e}`;if(_.hasOwnProperty(g)){var b={type:"bus",time:f,name:_[g].CarNum,id:e};yield(0,s.mL)(8,n,JSON.stringify(b))}}})).apply(this,arguments)}function m(t,e){return h.apply(this,arguments)}function h(){return(h=(0,n.A)(function*(t,e){var r=`${t}_${e}`,n=yield(0,s.Ct)(8,r);return!!n&&JSON.parse(n)})).apply(this,arguments)}},5352(t,e,r){r.d(e,{Qh:()=>s,nL:()=>d,qZ:()=>l,ty:()=>p});var n=r(467),i=r(8024),a=r(4311);function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e,r,n,i,a){return f.apply(this,arguments)}function f(){return(f=(0,n.A)(function*(t,e,r,n,u,s){var f=(0,i.zx)();if(e<0||e>23||r<0||r>59||n<0||n>23||u<0||u>59)return!1;if(!(Number.isInteger(e)&&Number.isInteger(r)&&Number.isInteger(n)&&Number.isInteger(u)))return!1;if(s.length>7)return!1;var l,c=o(s);try{for(c.s();!(l=c.n()).done;){var d=l.value;if("number"==typeof d&&(d<0||d>6||!Number.isInteger(d)))return!1}}catch(t){c.e(t)}finally{c.f()}var y={name:t,period:{start:{hours:e,minutes:r},end:{hours:n,minutes:u}},days:s,id:f};return yield(0,a.mL)(7,f,JSON.stringify(y)),!0})).apply(this,arguments)}function l(t){return c.apply(this,arguments)}function c(){return(c=(0,n.A)(function*(t){var e=yield(0,a.Ct)(7,t);if(e)return JSON.parse(e)})).apply(this,arguments)}function d(t){return y.apply(this,arguments)}function y(){return(y=(0,n.A)(function*(t){(yield l(t.id))&&(yield(0,a.mL)(7,t.id,JSON.stringify(t)))})).apply(this,arguments)}function p(){return m.apply(this,arguments)}function m(){return(m=(0,n.A)(function*(){var t,e=[],r=o(yield(0,a.Su)(7));try{for(r.s();!(t=r.n()).done;){var n=t.value,i=yield(0,a.Ct)(7,n);if(i){var u=JSON.parse(i);e.push(u)}}}catch(t){r.e(t)}finally{r.f()}return e.sort(function(t,e){return 60*t.period.end.hours+t.period.end.minutes-(60*e.period.end.hours+e.period.end.minutes)}),e.sort(function(t,e){return 60*t.period.start.hours+t.period.start.minutes-(60*e.period.start.hours+e.period.start.minutes)}),e})).apply(this,arguments)}}}]);
//# sourceMappingURL=e8969b0dc28e80fef16b.js.map