{"version":3,"file":"2d32c2a28326411977a3.js","mappings":"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","sources":["webpack://bus/./src/interface/location/index.ts"],"sourcesContent":["import { getUpdateRate } from '../../data/analytics/update-rate/index';\nimport { DataReceivingProgressEvent } from '../../data/apis/loader';\nimport { isFolderContentSaved } from '../../data/folder/index';\nimport { IntegratedLocation, IntegratedLocationItem, integrateLocation, LocationGroupProperty } from '../../data/location/index';\nimport { stopHasNotifcationSchedules } from '../../data/notification/index';\nimport { logRecentView } from '../../data/recent-views/index';\nimport { getSettingOptionValue, SettingSelectOptionRefreshIntervalValue } from '../../data/settings/index';\nimport { documentQuerySelector, elementQuerySelector, elementQuerySelectorAll, getElementsBelow } from '../../tools/elements';\nimport { getTextWidth } from '../../tools/graphic';\nimport { booleanToString, compareThings, generateIdentifier, hasOwnProperty } from '../../tools/index';\nimport { indexToDay, timeObjectToString } from '../../tools/time';\nimport { getBlankIconElement, getIconElement, setIcon } from '../icons/index';\nimport { closePreviousPage, GroupStyles, openPreviousPage, pushPageHistory } from '../index';\nimport { promptMessage } from '../prompt/index';\nimport { openSaveToFolder } from '../save-to-folder/index';\nimport { openScheduleNotification } from '../schedule-notification/index';\nimport { getSize } from '../sizes';\nimport { openLocationDetails } from './details/index';\n\nconst LocationField = documentQuerySelector('.css_location_field');\nconst LocationHeadElement = elementQuerySelector(LocationField, '.css_location_head');\nconst LocationNameElement = elementQuerySelector(LocationHeadElement, '.css_location_name');\nconst LocationNameSpanElement = elementQuerySelector(LocationNameElement, 'span');\nconst LocationButtonRightElement = elementQuerySelector(LocationHeadElement, '.css_location_button_right');\nconst LocationGroupsElement = elementQuerySelector(LocationField, '.css_location_groups');\nconst LocationGroupTabsElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tabs');\nconst LocationGroupTabsTrayElement = elementQuerySelector(LocationGroupTabsElement, '.css_location_group_tabs_tray');\nconst LocationGroupTabLineTrackElement = elementQuerySelector(LocationHeadElement, '.css_location_group_tab_line_track');\nconst LocationGroupTabLineElement = elementQuerySelector(LocationGroupTabLineTrackElement, '.css_location_group_tab_line');\nconst LocationUpdateTimerElement = elementQuerySelector(LocationHeadElement, '.css_location_update_timer_box .css_location_update_timer');\n\nlet previousIntegration = {} as IntegratedLocation;\nlet previousAnimation: boolean = false;\nlet previousSkeletonScreen: boolean = false;\n\nlet locationSliding_initialIndex: number = 0;\nlet locationSliding_targetIndex: number = 0;\nlet locationSliding_groupQuantity: number = 0;\nlet locationSliding_groupStyles: GroupStyles = {};\nlet locationSliding_sliding: boolean = false;\n\nlet locationRefreshTimer_retryInterval: number = 10 * 1000;\nlet locationRefreshTimer_baseInterval: number = 15 * 1000;\nlet locationRefreshTimer_minInterval: number = 5 * 1000;\nlet locationRefreshTimer_dynamicInterval: number = 15 * 1000;\nlet locationRefreshTimer_dynamic: boolean = true;\nlet locationRefreshTimer_lastUpdate: number = 0;\nlet locationRefreshTimer_nextUpdate: number = 0;\nlet locationRefreshTimer_currentRequestID: string = '';\nlet locationRefreshTimer_refreshing: boolean = false;\nlet locationRefreshTimer_streaming: boolean = false;\nlet locationRefreshTimer_streamStarted: boolean = false;\n\nlet currentHashSet_hash: string = '';\n\nlet tabPadding: number = 20;\n\nexport function initializeLocationSliding(): void {\n  LocationGroupsElement.addEventListener(\n    'touchstart',\n    function () {\n      locationSliding_initialIndex = Math.round(LocationGroupsElement.scrollLeft / getSize('window')[0]);\n    },\n    { passive: true }\n  );\n\n  LocationGroupsElement.addEventListener(\n    'scroll',\n    function (event: Event) {\n      locationSliding_sliding = true;\n      const target = event.target as HTMLElement;\n      const currentIndex = target.scrollLeft / getSize('window')[0];\n      if (currentIndex > locationSliding_initialIndex) {\n        locationSliding_targetIndex = locationSliding_initialIndex + 1;\n      } else {\n        locationSliding_targetIndex = locationSliding_initialIndex - 1;\n      }\n      const indexDifference = currentIndex - locationSliding_initialIndex;\n      let delta = Math.abs(indexDifference);\n      if (delta > 1) {\n        if (indexDifference > 0) {\n          locationSliding_initialIndex = Math.floor(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex + 1;\n        } else {\n          locationSliding_initialIndex = Math.ceil(currentIndex);\n          locationSliding_targetIndex = locationSliding_initialIndex - 1;\n        }\n        delta = Math.abs(currentIndex - locationSliding_initialIndex);\n      }\n      const initialSize = locationSliding_groupStyles[`g_${locationSliding_initialIndex}`] || { width: 0, offset: 0 };\n      const targetSize = locationSliding_groupStyles[`g_${locationSliding_targetIndex}`] || { width: 0, offset: 0 };\n      const tabWidth = initialSize.width + (targetSize.width - initialSize.width) * delta;\n      const offset = (initialSize.offset + (targetSize.offset - initialSize.offset) * delta) * -1 + getSize('window')[0] * 0.5 - tabWidth * 0.5;\n      updateLocationCSS(locationSliding_groupQuantity, offset, tabWidth - tabPadding, currentIndex);\n      /*\n      if (currentIndex === locationSliding_targetIndex) {\n        locationSliding_initialIndex = Math.round(currentIndex);\n        locationSliding_sliding = false;\n      }\n      */\n    },\n    { passive: true }\n  );\n\n  LocationGroupsElement.addEventListener(\n    'scrollend',\n    function (event: Event) {\n      const target = event.target as HTMLElement;\n      const currentIndex = target.scrollLeft / getSize('window')[0];\n      locationSliding_initialIndex = Math.round(currentIndex);\n      locationSliding_sliding = false;\n    },\n    { passive: true }\n  );\n\n  window.addEventListener('resize', () => {\n    const currentIndex = LocationGroupsElement.scrollLeft / getSize('window')[0];\n    locationSliding_initialIndex = Math.round(currentIndex);\n    locationSliding_targetIndex = routeSliding_initialIndex;\n    const initialGroupKey = `g_${locationSliding_initialIndex}`;\n    const initialGroupStyle = locationSliding_groupStyles[initialGroupKey] || { width: 0, offset: 0 };\n    const offset = initialGroupStyle.offset * -1 + getSize('window')[0] * 0.5 - initialGroupStyle.width * 0.5;\n    const tabLineWidth = initialGroupStyle.width - tabPadding;\n    updateLocationCSS(locationSliding_groupQuantity, offset, tabLineWidth, locationSliding_initialIndex);\n  });\n\n  if ('screen' in self) {\n    if (screen.orientation) {\n      screen.orientation.addEventListener('change', () => {\n        const currentIndex = LocationGroupsElement.scrollLeft / getSize('window')[0];\n        locationSliding_initialIndex = Math.round(currentIndex);\n        locationSliding_targetIndex = routeSliding_initialIndex;\n        const initialGroupKey = `g_${locationSliding_initialIndex}`;\n        const initialGroupStyle = locationSliding_groupStyles[initialGroupKey] || { width: 0, offset: 0 };\n        const offset = initialGroupStyle.offset * -1 + getSize('window')[0] * 0.5 - initialGroupStyle.width * 0.5;\n        const tabLineWidth = initialGroupStyle.width - tabPadding;\n        updateLocationCSS(locationSliding_groupQuantity, offset, tabLineWidth, locationSliding_initialIndex);\n      });\n    }\n  }\n}\n\nexport function updateLocationCSS(groupQuantity: number, offset: number, tabLineWidth: number, percentage: number): void {\n  LocationGroupsElement.style.setProperty('--b-cssvar-location-group-quantity', groupQuantity.toString());\n  LocationGroupTabLineElement.style.setProperty('--b-cssvar-location-tab-line-width-scale', tabLineWidth.toString());\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-tabs-tray-offset', `${offset.toString()}px`);\n  LocationGroupTabsTrayElement.style.setProperty('--b-cssvar-location-percentage', percentage.toString());\n}\n\nfunction animateUpdateTimer(): void {\n  LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-interval', `${locationRefreshTimer_dynamicInterval}ms`);\n  LocationUpdateTimerElement.classList.add('css_location_update_timer_slide_rtl');\n}\n\nfunction handleDataReceivingProgressUpdates(event: Event): void {\n  const CustomEvent = event as DataReceivingProgressEvent;\n  if (locationRefreshTimer_refreshing) {\n    const offsetRatio = CustomEvent.detail.progress - 1;\n    LocationUpdateTimerElement.style.setProperty('--b-cssvar-location-update-timer-offset-ratio', offsetRatio.toString());\n  }\n  if (CustomEvent.detail.stage === 'end') {\n    document.removeEventListener(CustomEvent.detail.target, handleDataReceivingProgressUpdates);\n  }\n}\n\nfunction generateElementOfItem(): HTMLElement {\n  // Main container\n  const itemElement = document.createElement('div');\n  itemElement.classList.add('css_location_group_item');\n  itemElement.setAttribute('stretched', 'false');\n  itemElement.setAttribute('stretching', 'false');\n  itemElement.setAttribute('push-direction', '0');\n  itemElement.setAttribute('push-state', '0');\n\n  // Head\n  const headElement = document.createElement('div');\n  headElement.classList.add('css_location_group_item_head');\n\n  // Rank\n  const rankElement = document.createElement('div');\n  rankElement.classList.add('css_location_group_item_rank');\n  const rankNextSlideElement = document.createElement('div');\n  rankNextSlideElement.classList.add('css_location_group_item_rank_next_slide');\n  rankNextSlideElement.setAttribute('code', '-1');\n  rankNextSlideElement.setAttribute('displayed', 'false');\n  const rankCurrentSlideElement = document.createElement('div');\n  rankCurrentSlideElement.classList.add('css_location_group_item_rank_current_slide');\n  rankCurrentSlideElement.setAttribute('code', '-1');\n  rankCurrentSlideElement.setAttribute('displayed', 'true');\n  rankElement.appendChild(rankNextSlideElement);\n  rankElement.appendChild(rankCurrentSlideElement);\n\n  // Route direction\n  const routeDirectionElement = document.createElement('div');\n  routeDirectionElement.classList.add('css_location_group_item_route_direction');\n\n  // Route name\n  const routeNameElement = document.createElement('div');\n  routeNameElement.classList.add('css_location_group_item_route_name');\n\n  // Capsule\n  const capsuleElement = document.createElement('div');\n  capsuleElement.classList.add('css_location_group_item_capsule');\n\n  // Status\n  const statusElement = document.createElement('div');\n  statusElement.classList.add('css_location_group_item_status');\n  const nextSlideElement = document.createElement('div');\n  nextSlideElement.classList.add('css_next_slide');\n  nextSlideElement.setAttribute('code', '0');\n  nextSlideElement.setAttribute('displayed', 'false');\n  const currentSlideElement = document.createElement('div');\n  currentSlideElement.classList.add('css_current_slide');\n  currentSlideElement.setAttribute('code', '0');\n  currentSlideElement.setAttribute('displayed', 'true');\n  statusElement.appendChild(nextSlideElement);\n  statusElement.appendChild(currentSlideElement);\n\n  // Stretch button\n  const stretchElement = document.createElement('div');\n  stretchElement.classList.add('css_location_group_item_stretch');\n  stretchElement.appendChild(getIconElement('keyboard_arrow_down'));\n  stretchElement.onclick = () => {\n    stretchLocationItem(itemElement);\n  };\n\n  // Capsule separator\n  const capsuleSeparatorElement = document.createElement('div');\n  capsuleSeparatorElement.classList.add('css_location_group_item_capsule_separator');\n\n  // Assemble capsule\n  capsuleElement.appendChild(statusElement);\n  capsuleElement.appendChild(stretchElement);\n  capsuleElement.appendChild(capsuleSeparatorElement);\n\n  // Assemble head\n  headElement.appendChild(rankElement);\n  headElement.appendChild(routeDirectionElement);\n  headElement.appendChild(routeNameElement);\n  headElement.appendChild(capsuleElement);\n\n  // Body\n  const bodyElement = document.createElement('div');\n  bodyElement.classList.add('css_location_group_item_body');\n  bodyElement.setAttribute('displayed', 'false');\n\n  // Buttons\n  const buttonsElement = document.createElement('div');\n  buttonsElement.classList.add('css_location_group_item_buttons');\n\n  // Tab: 公車\n  const busTabButtonElement = document.createElement('div');\n  busTabButtonElement.classList.add('css_location_group_item_button');\n  busTabButtonElement.setAttribute('highlighted', 'true');\n  busTabButtonElement.setAttribute('type', 'tab');\n  busTabButtonElement.setAttribute('code', '0');\n  const busTabIconElement = document.createElement('div');\n  busTabIconElement.classList.add('css_location_group_item_button_icon');\n  busTabIconElement.appendChild(getIconElement('directions_bus'));\n  busTabButtonElement.appendChild(busTabIconElement);\n  busTabButtonElement.appendChild(document.createTextNode('公車'));\n  busTabButtonElement.onclick = () => {\n    switchLocationBodyTab(itemElement, 0);\n  };\n\n  // Tab: 抵達時間\n  const arrivalTabButtonElement = document.createElement('div');\n  arrivalTabButtonElement.classList.add('css_location_group_item_button');\n  arrivalTabButtonElement.setAttribute('highlighted', 'false');\n  arrivalTabButtonElement.setAttribute('type', 'tab');\n  arrivalTabButtonElement.setAttribute('code', '1');\n  const arrivalTabIconElement = document.createElement('div');\n  arrivalTabIconElement.classList.add('css_location_group_item_button_icon');\n  arrivalTabIconElement.appendChild(getIconElement('departure_board'));\n  arrivalTabButtonElement.appendChild(arrivalTabIconElement);\n  arrivalTabButtonElement.appendChild(document.createTextNode('抵達時間'));\n  arrivalTabButtonElement.onclick = () => {\n    switchLocationBodyTab(itemElement, 1);\n  };\n\n  // Button: 儲存\n  const saveButtonElement = document.createElement('div');\n  saveButtonElement.classList.add('css_location_group_item_button');\n  saveButtonElement.setAttribute('highlighted', 'false');\n  saveButtonElement.setAttribute('type', 'save-to-folder');\n  const saveButtonIconElement = document.createElement('div');\n  saveButtonIconElement.classList.add('css_location_group_item_button_icon');\n  saveButtonIconElement.appendChild(getIconElement('folder'));\n  saveButtonElement.appendChild(saveButtonIconElement);\n  saveButtonElement.appendChild(document.createTextNode('儲存'));\n\n  // Button: 通知\n  const notifyButtonElement = document.createElement('div');\n  notifyButtonElement.classList.add('css_location_group_item_button');\n  notifyButtonElement.setAttribute('highlighted', 'false');\n  notifyButtonElement.setAttribute('type', 'schedule-notification');\n  notifyButtonElement.setAttribute('enabled', 'true');\n  const notifyButtonIconElement = document.createElement('div');\n  notifyButtonIconElement.classList.add('css_location_group_item_button_icon');\n  notifyButtonIconElement.appendChild(getIconElement('notifications'));\n  notifyButtonElement.appendChild(notifyButtonIconElement);\n  notifyButtonElement.appendChild(document.createTextNode('通知'));\n\n  // Assemble buttons\n  buttonsElement.appendChild(busTabButtonElement);\n  buttonsElement.appendChild(arrivalTabButtonElement);\n  buttonsElement.appendChild(saveButtonElement);\n  buttonsElement.appendChild(notifyButtonElement);\n\n  // Buses\n  const busesElement = document.createElement('div');\n  busesElement.classList.add('css_location_group_item_buses');\n  busesElement.setAttribute('displayed', 'true');\n\n  // Bus arrival times\n  const busArrivalTimesElement = document.createElement('div');\n  busArrivalTimesElement.classList.add('css_location_group_item_bus_arrival_times');\n  busArrivalTimesElement.setAttribute('displayed', 'false');\n\n  // Assemble body\n  bodyElement.appendChild(buttonsElement);\n  bodyElement.appendChild(busesElement);\n  bodyElement.appendChild(busArrivalTimesElement);\n\n  // Assemble item\n  itemElement.appendChild(headElement);\n  itemElement.appendChild(bodyElement);\n\n  return itemElement;\n}\n\nfunction generateElementOfGroup(): HTMLElement {\n  // Main container\n  const groupElement = document.createElement('div');\n  groupElement.classList.add('css_location_group');\n\n  // Details\n  const detailsElement = document.createElement('div');\n  detailsElement.classList.add('css_location_group_details');\n\n  // Details body\n  const detailsBodyElement = document.createElement('div');\n  detailsBodyElement.classList.add('css_location_group_details_body');\n  detailsElement.appendChild(detailsBodyElement);\n\n  // Items\n  const itemsElement = document.createElement('div');\n  itemsElement.classList.add('css_location_group_items');\n\n  // Assemble group\n  groupElement.appendChild(detailsElement);\n  groupElement.appendChild(itemsElement);\n\n  return groupElement;\n}\n\nfunction generateElementOfTab(): HTMLElement {\n  const element = document.createElement('div');\n  element.classList.add('css_location_group_tab');\n\n  const span = document.createElement('span');\n  element.appendChild(span);\n\n  return element;\n}\n\nfunction generateElementOfGroupDetailsProperty(): HTMLElement {\n  // Main container\n  const propertyElement = document.createElement('div');\n  propertyElement.classList.add('css_location_group_details_property');\n\n  // Icon\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_location_details_property_icon');\n  iconElement.appendChild(getBlankIconElement());\n\n  // Value\n  const valueElement = document.createElement('div');\n  valueElement.classList.add('css_location_details_property_value');\n\n  // Assemble\n  propertyElement.appendChild(iconElement);\n  propertyElement.appendChild(valueElement);\n\n  return propertyElement;\n}\n\nfunction generateElementOfBus(): HTMLElement {\n  const busElement = document.createElement('div');\n  busElement.classList.add('css_location_group_item_bus');\n  busElement.setAttribute('on-this-route', 'false');\n\n  const titleElement = document.createElement('div');\n  titleElement.classList.add('css_location_group_item_bus_title');\n\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_location_group_item_bus_icon');\n  iconElement.appendChild(getIconElement('directions_bus'));\n\n  const carNumberElement = document.createElement('div');\n  carNumberElement.classList.add('css_location_group_item_bus_car_number');\n\n  const attributesElement = document.createElement('div');\n  attributesElement.classList.add('css_location_group_item_bus_attributes');\n\n  const routeAttributeElement = document.createElement('div');\n  routeAttributeElement.classList.add('css_location_group_item_bus_route');\n\n  const carStatusAttributeElement = document.createElement('div');\n  carStatusAttributeElement.classList.add('css_location_group_item_bus_car_status');\n\n  const carTypeAttributeElement = document.createElement('div');\n  carTypeAttributeElement.classList.add('css_location_group_item_bus_car_type');\n\n  titleElement.appendChild(iconElement);\n  titleElement.appendChild(carNumberElement);\n  busElement.appendChild(titleElement);\n\n  attributesElement.appendChild(routeAttributeElement);\n  attributesElement.appendChild(carStatusAttributeElement);\n  attributesElement.appendChild(carTypeAttributeElement);\n  busElement.appendChild(attributesElement);\n\n  return busElement;\n}\n\nfunction generateElementOfBusArrivalTime(): HTMLElement {\n  const busArrivalTimeElement = document.createElement('div');\n  busArrivalTimeElement.classList.add('css_location_group_item_bus_arrival_time');\n\n  const titleElement = document.createElement('div');\n  titleElement.classList.add('css_location_group_item_bus_arrival_time_title');\n\n  const iconElement = document.createElement('div');\n  iconElement.classList.add('css_location_group_item_bus_arrival_time_icon');\n  iconElement.appendChild(getIconElement('calendar_view_day'));\n\n  const personalScheduleNameElement = document.createElement('div');\n  personalScheduleNameElement.classList.add('css_location_group_item_bus_arrival_time_personal_schedule_name');\n\n  const personalScheduleTimeElement = document.createElement('div');\n  personalScheduleTimeElement.classList.add('css_location_group_item_bus_arrival_time_personal_schedule_time');\n\n  const chartElement = document.createElement('div');\n  chartElement.classList.add('css_location_group_item_bus_arrival_time_chart');\n\n  titleElement.appendChild(iconElement);\n  titleElement.appendChild(personalScheduleNameElement);\n  titleElement.appendChild(personalScheduleTimeElement);\n  busArrivalTimeElement.appendChild(titleElement);\n  busArrivalTimeElement.appendChild(chartElement);\n\n  return busArrivalTimeElement;\n}\n\nfunction setUpLocationFieldSkeletonScreen(hash: IntegratedLocation['hash']): void {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const defaultItemQuantity: IntegratedLocation['itemQuantity'] = { g_0: Math.floor(getSize('window')[1] / 50) + 5, g_1: Math.floor(getSize('window')[1] / 50) + 5 };\n  const defaultGroupQuantity = 2;\n  let groupedItems: IntegratedLocation['groupedItems'] = {};\n  for (let i = 0; i < defaultGroupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    groupedItems[groupKey] = [];\n    for (let j = 0; j < defaultItemQuantity[groupKey]; j++) {\n      groupedItems[groupKey].push({\n        route_name: '',\n        route_direction: '',\n        routeId: 0,\n        stopId: 0,\n        status: {\n          code: 8,\n          text: '',\n          time: -6\n        },\n        ranking: {\n          number: 0,\n          text: '--',\n          code: -1\n        },\n        buses: [],\n        busArrivalTimes: []\n      });\n    }\n  }\n  updateLocationField(\n    {\n      groupedItems: groupedItems,\n      groupQuantity: defaultGroupQuantity,\n      groups: {\n        g_0: {\n          name: '載入中',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        },\n        g_1: {\n          name: '載入中',\n          properties: [\n            {\n              key: '0',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '1',\n              icon: '',\n              value: ''\n            },\n            {\n              key: '2',\n              icon: '',\n              value: ''\n            }\n          ]\n        }\n      },\n      itemQuantity: defaultItemQuantity,\n      LocationName: '載入中',\n      hash: hash,\n      dataUpdateTime: 0\n    },\n    true,\n    playing_animation\n  );\n}\n\nfunction updateLocationField(integration: IntegratedLocation, skeletonScreen: boolean, animation: boolean): void {\n  function updateItem(thisElement: HTMLElement, thisItem: IntegratedLocationItem, previousItem: IntegratedLocationItem | null): void {\n    function updateStatus(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisItemStatusElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_status');\n      const nextSlideElement = elementQuerySelector(thisItemStatusElement, '.css_next_slide');\n      const currentSlideElement = elementQuerySelector(thisItemStatusElement, '.css_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.status.code.toString());\n      nextSlideElement.innerText = thisItem.status.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n            currentSlideElement.innerText = thisItem.status.text;\n            currentSlideElement.classList.remove('css_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.status.code.toString());\n        currentSlideElement.innerText = thisItem.status.text;\n      }\n    }\n\n    function updateRank(thisElement: HTMLElement, thisItem: IntegratedLocationItem, animation: boolean): void {\n      const thisElementRect = thisElement.getBoundingClientRect();\n      const top = thisElementRect.top;\n      const left = thisElementRect.left;\n      const bottom = thisElementRect.bottom;\n      const right = thisElementRect.right;\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRankElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_rank');\n      const nextSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_next_slide');\n      const currentSlideElement = elementQuerySelector(thisRankElement, '.css_location_group_item_rank_current_slide');\n\n      nextSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n      nextSlideElement.innerText = thisItem.ranking.text;\n\n      if (animation && bottom > 0 && top < windowHeight && right > 0 && left < windowWidth) {\n        currentSlideElement.addEventListener(\n          'animationend',\n          function () {\n            currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n            currentSlideElement.innerText = thisItem.ranking.text;\n            currentSlideElement.classList.remove('css_location_group_item_rank_current_slide_fade_out');\n            nextSlideElement.setAttribute('displayed', 'false');\n          },\n          { once: true }\n        );\n        nextSlideElement.setAttribute('displayed', 'true');\n        currentSlideElement.classList.add('css_location_group_item_rank_current_slide_fade_out');\n      } else {\n        currentSlideElement.setAttribute('code', thisItem.ranking.code.toString());\n        currentSlideElement.innerText = thisItem.ranking.text;\n      }\n    }\n\n    function updateRouteDirection(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteDirectionElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_direction');\n      thisRouteDirectionElement.innerText = thisItem.route_direction;\n    }\n\n    function updateRouteName(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisHeadElement = elementQuerySelector(thisElement, '.css_location_group_item_head');\n      const thisRouteNameElement = elementQuerySelector(thisHeadElement, '.css_location_group_item_route_name');\n      thisRouteNameElement.innerText = thisItem.route_name;\n    }\n\n    function updateBuses(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buses');\n      const currentBusElements = elementQuerySelectorAll(thisBusesElement, '.css_location_group_item_bus');\n      const currentBusElementsQuantity = currentBusElements.length;\n      const busesQuantity = thisItem.buses.length;\n      const difference = currentBusElementsQuantity - busesQuantity;\n      if (difference < 0) {\n        const fragment = new DocumentFragment();\n        for (let p = 0, d = Math.abs(difference); p < d; p++) {\n          const newBusElement = generateElementOfBus();\n          fragment.appendChild(newBusElement);\n        }\n        thisBusesElement.append(fragment);\n      } else {\n        for (let p = 0, d = Math.abs(difference); p < d; p++) {\n          const busIndex = currentBusElementsQuantity - 1 - p;\n          currentBusElements[busIndex].remove();\n        }\n      }\n\n      const busElements = elementQuerySelectorAll(thisBusesElement, '.css_location_group_item_bus');\n      for (let i = 0; i < busesQuantity; i++) {\n        const busItem = thisItem.buses[i];\n        const busElement = busElements[i];\n        const titleElement = elementQuerySelector(busElement, '.css_location_group_item_bus_title');\n        const carNumberElement = elementQuerySelector(titleElement, '.css_location_group_item_bus_car_number');\n        const attributesElement = elementQuerySelector(busElement, '.css_location_group_item_bus_attributes');\n        const routeAttributeElement = elementQuerySelector(attributesElement, '.css_location_group_item_bus_route');\n        const carStatusAttributeElement = elementQuerySelector(attributesElement, '.css_location_group_item_bus_car_status');\n        const carTypeAttributeElement = elementQuerySelector(attributesElement, '.css_location_group_item_bus_car_type');\n        busElement.setAttribute('on-this-route', booleanToString(busItem.onThisRoute));\n        carNumberElement.innerText = busItem.carNumber;\n        routeAttributeElement.innerText = `路線：${busItem.RouteName}`;\n        carStatusAttributeElement.innerText = `狀態：${busItem.status.text}`;\n        carTypeAttributeElement.innerText = `類型：${busItem.type}`;\n      }\n\n      thisBusesElement.setAttribute('empty', booleanToString(busesQuantity === 0));\n    }\n\n    function updateBusArrivalTimes(thisElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisElement, '.css_location_group_item_body');\n      const thisBusArrivalTimesElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_bus_arrival_times');\n      const currentBusArrivalTimeElements = elementQuerySelectorAll(thisBusArrivalTimesElement, '.css_location_group_item_bus_arrival_time');\n      const currentBusArrivalTimeElementsQuantity = currentBusArrivalTimeElements.length;\n      const busArrivalTimesQuantity = thisItem.busArrivalTimes.length;\n      const difference = currentBusArrivalTimeElementsQuantity - busArrivalTimesQuantity;\n      if (difference < 0) {\n        const fragment = new DocumentFragment();\n        for (let p = 0, d = Math.abs(difference); p < d; p++) {\n          const newBusArrivalTimeElement = generateElementOfBusArrivalTime();\n          fragment.appendChild(newBusArrivalTimeElement);\n        }\n        thisBusArrivalTimesElement.append(fragment);\n      } else {\n        for (let p = 0, d = Math.abs(difference); p < d; p++) {\n          const overlappingRouteIndex = currentBusArrivalTimeElementsQuantity - 1 - p;\n          currentBusArrivalTimeElements[overlappingRouteIndex].remove();\n        }\n      }\n\n      const busArrivalTimeElements = elementQuerySelectorAll(thisBusArrivalTimesElement, '.css_location_group_item_bus_arrival_time');\n      for (let i = 0; i < busArrivalTimesQuantity; i++) {\n        const busArrivalTimeItem = thisItem.busArrivalTimes[i];\n        const busArrivalTimeElement = busArrivalTimeElements[i];\n        const titleElement = elementQuerySelector(busArrivalTimeElement, '.css_location_group_item_bus_arrival_time_title');\n        const personalScheduleNameElement = elementQuerySelector(titleElement, '.css_location_group_item_bus_arrival_time_personal_schedule_name');\n        const personalScheduleTimeElement = elementQuerySelector(titleElement, '.css_location_group_item_bus_arrival_time_personal_schedule_time');\n        const chartElement = elementQuerySelector(busArrivalTimeElement, '.css_location_group_item_bus_arrival_time_chart');\n        personalScheduleNameElement.innerText = busArrivalTimeItem.personalSchedule.name;\n        personalScheduleTimeElement.innerText = `週${indexToDay(busArrivalTimeItem.day).name} ${timeObjectToString(busArrivalTimeItem.personalSchedule.period.start)} - ${timeObjectToString(busArrivalTimeItem.personalSchedule.period.end)}`;\n        chartElement.innerHTML = busArrivalTimeItem.chart;\n      }\n\n      thisBusArrivalTimesElement.setAttribute('empty', booleanToString(busArrivalTimesQuantity === 0));\n    }\n\n    function updateStretch(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      if (skeletonScreen) {\n        thisElement.setAttribute('stretched', 'false');\n      }\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    function updateSaveToFolderButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const saveToFolderButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"save-to-folder\"]');\n      saveToFolderButtonElement.onclick = function () {\n        openSaveToFolder('stop', [thisItem.stopId, thisItem.routeId], saveToFolderButtonElement);\n      };\n      isFolderContentSaved('stop', thisItem.stopId).then((e) => {\n        saveToFolderButtonElement.setAttribute('highlighted', booleanToString(e));\n      });\n    }\n\n    function updateScheduleNotificationButton(thisItemElement: HTMLElement, thisItem: IntegratedLocationItem): void {\n      const thisItemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n      const thisItemButtonsElement = elementQuerySelector(thisItemBodyElement, '.css_location_group_item_buttons');\n      const scheduleNotificationButtonElement = elementQuerySelector(thisItemButtonsElement, '.css_location_group_item_button[type=\"schedule-notification\"]');\n      scheduleNotificationButtonElement.onclick = function () {\n        openScheduleNotification(scheduleNotificationButtonElement, thisItem.stopId, thisItem.routeId, thisItem.status.time);\n      };\n      const havingNotifcationSchedules = stopHasNotifcationSchedules(thisItem.stopId);\n      scheduleNotificationButtonElement.setAttribute('highlighted', booleanToString(havingNotifcationSchedules));\n    }\n\n    if (previousItem === null || previousItem === undefined) {\n      updateStatus(thisElement, thisItem, animation);\n      updateRank(thisElement, thisItem, animation);\n      updateRouteDirection(thisElement, thisItem);\n      updateRouteName(thisElement, thisItem);\n      updateBuses(thisElement, thisItem);\n      updateBusArrivalTimes(thisElement, thisItem);\n      updateStretch(thisElement, skeletonScreen);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n      updateSaveToFolderButton(thisElement, thisItem);\n      updateScheduleNotificationButton(thisElement, thisItem);\n    } else {\n      if (thisItem.status.time !== previousItem.status.time) {\n        updateStatus(thisElement, thisItem, animation);\n        updateScheduleNotificationButton(thisElement, thisItem);\n      }\n      if (previousItem.ranking.number !== thisItem.ranking.number || previousItem.ranking.code !== thisItem.ranking.code) {\n        updateRank(thisElement, thisItem, animation);\n      }\n      if (previousItem.stopId !== thisItem.stopId) {\n        updateRouteDirection(thisElement, thisItem);\n        updateRouteName(thisElement, thisItem);\n        updateSaveToFolderButton(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.buses, thisItem.buses)) {\n        updateBuses(thisElement, thisItem);\n      }\n      if (!compareThings(previousItem.busArrivalTimes, thisItem.busArrivalTimes)) {\n        updateBusArrivalTimes(thisElement, thisItem);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateStretch(thisElement, skeletonScreen);\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  function updateProperty(thisElement: HTMLElement, thisProperty: LocationGroupProperty, previousProperty: LocationGroupProperty | null): void {\n    function updateIcon(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      const thisIconElement = elementQuerySelector(thisElement, '.css_location_details_property_icon');\n      setIcon(thisIconElement, thisProperty.icon);\n    }\n\n    function updateValue(thisElement: HTMLElement, thisProperty: LocationGroupProperty): void {\n      elementQuerySelector(thisElement, '.css_location_details_property_value').innerHTML = thisProperty.value;\n    }\n\n    function updateAnimation(thisElement: HTMLElement, animation: boolean): void {\n      thisElement.setAttribute('animation', booleanToString(animation));\n    }\n\n    function updateSkeletonScreen(thisElement: HTMLElement, skeletonScreen: boolean): void {\n      thisElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    }\n\n    if (previousProperty === null || previousProperty === undefined) {\n      updateIcon(thisElement, thisProperty);\n      updateValue(thisElement, thisProperty);\n      updateAnimation(thisElement, animation);\n      updateSkeletonScreen(thisElement, skeletonScreen);\n    } else {\n      if (!compareThings(previousProperty.icon, thisProperty.icon)) {\n        updateIcon(thisElement, thisProperty);\n      }\n      if (!compareThings(previousProperty.value, thisProperty.value)) {\n        updateValue(thisElement, thisProperty);\n      }\n      if (animation !== previousAnimation) {\n        updateAnimation(thisElement, animation);\n      }\n      if (skeletonScreen !== previousSkeletonScreen) {\n        updateSkeletonScreen(thisElement, skeletonScreen);\n      }\n    }\n  }\n\n  const groupQuantity = integration.groupQuantity;\n  const itemQuantity = integration.itemQuantity;\n  const groupedItems = integration.groupedItems;\n  const groups = integration.groups;\n\n  locationSliding_groupQuantity = groupQuantity;\n\n  let cumulativeOffset = 0;\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const width = getTextWidth(groups[groupKey].name, 500, '17px', `\"Noto Sans TC\", sans-serif`) + tabPadding;\n    locationSliding_groupStyles[groupKey] = {\n      width: width,\n      offset: cumulativeOffset\n    };\n    cumulativeOffset += width;\n  }\n  locationSliding_groupStyles[`g_${groupQuantity}`] = {\n    width: 0,\n    offset: cumulativeOffset\n  };\n\n  if (!locationSliding_sliding) {\n    const initialGroupKey = `g_${locationSliding_initialIndex}`;\n    const initialGroupStyle = locationSliding_groupStyles[initialGroupKey];\n    const offset = initialGroupStyle.offset * -1 + getSize('window')[0] * 0.5 - initialGroupStyle.width * 0.5;\n    const tabLineWidth = initialGroupStyle.width - tabPadding;\n    updateLocationCSS(locationSliding_groupQuantity, offset, tabLineWidth, locationSliding_initialIndex);\n  }\n\n  if (previousIntegration?.hash !== integration.hash) {\n    LocationButtonRightElement.onclick = function () {\n      openLocationDetails(integration.hash);\n    };\n  }\n\n  if (previousIntegration?.LocationName !== integration.LocationName) {\n    LocationNameSpanElement.innerText = integration.LocationName;\n  }\n\n  if (previousAnimation !== animation) {\n    LocationNameElement.setAttribute('animation', booleanToString(animation));\n    LocationGroupTabsElement.setAttribute('animation', booleanToString(animation));\n  }\n\n  if (previousSkeletonScreen !== skeletonScreen) {\n    LocationNameElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabsElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n    LocationGroupTabLineTrackElement.setAttribute('skeleton-screen', booleanToString(skeletonScreen));\n  }\n\n  // TODO: updateTab\n  const currentGroupCapacity = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group').length;\n  if (groupQuantity !== currentGroupCapacity) {\n    const difference = currentGroupCapacity - groupQuantity;\n    if (difference < 0) {\n      const groupsFragment = new DocumentFragment();\n      const tabsFragment = new DocumentFragment();\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const newGroupElement = generateElementOfGroup();\n        groupsFragment.appendChild(newGroupElement);\n        const newTabElement = generateElementOfTab();\n        tabsFragment.appendChild(newTabElement);\n      }\n      LocationGroupsElement.append(groupsFragment);\n      LocationGroupTabsTrayElement.append(tabsFragment);\n    } else {\n      const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n      const LocationGroupTabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n      for (let o = 0, d = Math.abs(difference); o < d; o++) {\n        const groupIndex = currentGroupCapacity - 1 - o;\n        LocationGroupElements[groupIndex].remove();\n        LocationGroupTabElements[groupIndex].remove();\n      }\n    }\n  }\n\n  const LocationGroupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisLocationGroupElement = LocationGroupElements[i];\n    const currentItemCapacity = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item').length;\n    if (itemQuantity[groupKey] !== currentItemCapacity) {\n      const difference = currentItemCapacity - itemQuantity[groupKey];\n      if (difference < 0) {\n        const LocationGroupItemsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_items');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const newItemElement = generateElementOfItem();\n          LocationGroupItemsElement.appendChild(newItemElement);\n        }\n      } else {\n        const LocationGroupItemElements = elementQuerySelectorAll(thisLocationGroupElement, '.css_location_group_items .css_location_group_item');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const itemIndex = currentItemCapacity - 1 - o;\n          LocationGroupItemElements[itemIndex].remove();\n        }\n      }\n    }\n\n    const currentGroupPropertyCapacity = elementQuerySelectorAll(elementQuerySelectorAll(LocationGroupsElement, '.css_location_group')[i], '.css_location_group_details .css_location_group_details_body .css_location_group_details_property').length;\n    const groupPropertyQuantity = groups[groupKey].properties.length;\n    if (groupPropertyQuantity !== currentGroupPropertyCapacity) {\n      const difference = currentGroupPropertyCapacity - groupPropertyQuantity;\n      if (difference < 0) {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          // var propertyIndex = currentGroupPropertyCapacity + o;\n          const newPropertyElement = generateElementOfGroupDetailsProperty();\n          thisLocationGroupDetailsBodyElement.appendChild(newPropertyElement);\n        }\n      } else {\n        const thisLocationGroupDetailsElement = elementQuerySelector(thisLocationGroupElement, '.css_location_group_details');\n        const thisLocationGroupDetailsBodyElement = elementQuerySelector(thisLocationGroupDetailsElement, '.css_location_group_details_body');\n        const propertyElements = elementQuerySelectorAll(thisLocationGroupDetailsBodyElement, '.css_location_group_details_property');\n        for (let o = 0, d = Math.abs(difference); o < d; o++) {\n          const propertyIndex = currentGroupPropertyCapacity - 1 - o;\n          propertyElements[propertyIndex].remove();\n        }\n      }\n    }\n  }\n\n  const tabElements = elementQuerySelectorAll(LocationGroupTabsTrayElement, '.css_location_group_tab');\n  const groupElements = elementQuerySelectorAll(LocationGroupsElement, '.css_location_group');\n  for (let i = 0; i < groupQuantity; i++) {\n    const groupKey = `g_${i}`;\n    const thisTabElement = tabElements[i];\n    const thisTabSpanElement = elementQuerySelector(thisTabElement, 'span');\n    thisTabSpanElement.innerText = groups[groupKey].name;\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-width', `${locationSliding_groupStyles[groupKey].width}px`);\n    thisTabElement.style.setProperty('--b-cssvar-location-tab-index', i.toString());\n    const thisGroupElement = groupElements[i];\n    const propertyElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_details .css_location_group_details_body .css_location_group_details_property`);\n    const itemElements = elementQuerySelectorAll(thisGroupElement, `.css_location_group_items .css_location_group_item`);\n\n    const groupPropertyQuantity = groups[groupKey].properties.length; // TODO: propertyQuantity\n    for (let k = 0; k < groupPropertyQuantity; k++) {\n      const thisProperty = groups[groupKey].properties[k];\n      const thisElement = propertyElements[k];\n      if (hasOwnProperty(previousIntegration, 'groups')) {\n        if (hasOwnProperty(previousIntegration.groups, groupKey)) {\n          if (previousIntegration.groups[groupKey].properties[k]) {\n            const previousProperty = previousIntegration.groups[groupKey].properties[k];\n            updateProperty(thisElement, thisProperty, previousProperty);\n          } else {\n            updateProperty(thisElement, thisProperty, null);\n          }\n        } else {\n          updateProperty(thisElement, thisProperty, null);\n        }\n      } else {\n        updateProperty(thisElement, thisProperty, null);\n      }\n    }\n\n    for (let j = 0; j < itemQuantity[groupKey]; j++) {\n      const thisElement = itemElements[j];\n      const thisItem = groupedItems[groupKey][j];\n      if (hasOwnProperty(previousIntegration, 'groupedItems')) {\n        if (hasOwnProperty(previousIntegration.groupedItems, groupKey)) {\n          if (previousIntegration.groupedItems[groupKey][j]) {\n            const previousItem = previousIntegration.groupedItems[groupKey][j];\n            updateItem(thisElement, thisItem, previousItem);\n          } else {\n            updateItem(thisElement, thisItem, null);\n          }\n        } else {\n          updateItem(thisElement, thisItem, null);\n        }\n      } else {\n        updateItem(thisElement, thisItem, null);\n      }\n    }\n  }\n\n  previousIntegration = integration;\n  previousAnimation = animation;\n  previousSkeletonScreen = skeletonScreen;\n}\n\nasync function refreshLocation() {\n  const playing_animation = getSettingOptionValue('playing_animation') as boolean;\n  const refresh_interval_setting = getSettingOptionValue('refresh_interval') as SettingSelectOptionRefreshIntervalValue;\n  locationRefreshTimer_dynamic = refresh_interval_setting.dynamic;\n  locationRefreshTimer_baseInterval = refresh_interval_setting.baseInterval;\n  locationRefreshTimer_refreshing = true;\n  locationRefreshTimer_currentRequestID = generateIdentifier();\n  LocationUpdateTimerElement.setAttribute('refreshing', 'true');\n  LocationUpdateTimerElement.classList.remove('css_location_update_timer_slide_rtl');\n  document.addEventListener(locationRefreshTimer_currentRequestID, handleDataReceivingProgressUpdates);\n  const integration = await integrateLocation(currentHashSet_hash, getSize('location_bus_arrival_time_chart')[0], getSize('location_bus_arrival_time_chart')[1], locationRefreshTimer_currentRequestID);\n  updateLocationField(integration, false, playing_animation);\n  let updateRate = 0;\n  if (locationRefreshTimer_dynamic) {\n    updateRate = await getUpdateRate();\n  }\n  locationRefreshTimer_lastUpdate = new Date().getTime();\n  if (locationRefreshTimer_dynamic) {\n    locationRefreshTimer_nextUpdate = Math.max(locationRefreshTimer_lastUpdate + locationRefreshTimer_minInterval, integration.dataUpdateTime + locationRefreshTimer_baseInterval / updateRate);\n  } else {\n    locationRefreshTimer_nextUpdate = locationRefreshTimer_lastUpdate + locationRefreshTimer_baseInterval;\n  }\n  locationRefreshTimer_dynamicInterval = Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - locationRefreshTimer_lastUpdate);\n  locationRefreshTimer_refreshing = false;\n  LocationUpdateTimerElement.setAttribute('refreshing', 'false');\n  animateUpdateTimer();\n}\n\nexport function streamLocation(): void {\n  refreshLocation()\n    .then(function () {\n      if (locationRefreshTimer_streaming) {\n        setTimeout(\n          function () {\n            streamLocation();\n          },\n          Math.max(locationRefreshTimer_minInterval, locationRefreshTimer_nextUpdate - new Date().getTime())\n        );\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    })\n    .catch((err) => {\n      console.error(err);\n      if (locationRefreshTimer_streaming) {\n        promptMessage('error', `地點網路連線中斷，將在${locationRefreshTimer_retryInterval / 1000}秒後重試。`);\n        setTimeout(function () {\n          streamLocation();\n        }, locationRefreshTimer_retryInterval);\n      } else {\n        locationRefreshTimer_streamStarted = false;\n      }\n    });\n}\n\nexport function openLocation(hash: IntegratedLocation['hash']): void {\n  pushPageHistory('Location');\n  logRecentView('location', hash);\n  currentHashSet_hash = hash;\n  locationSliding_initialIndex = 0;\n  locationSliding_groupStyles = {};\n  LocationField.setAttribute('displayed', 'true');\n  LocationGroupsElement.scrollLeft = 0;\n  LocationGroupsElement.focus();\n  setUpLocationFieldSkeletonScreen(hash);\n  if (!locationRefreshTimer_streaming) {\n    locationRefreshTimer_streaming = true;\n    if (!locationRefreshTimer_streamStarted) {\n      locationRefreshTimer_streamStarted = true;\n      streamLocation();\n    } else {\n      refreshLocation();\n    }\n  }\n  closePreviousPage();\n}\n\nexport function closeLocation(): void {\n  // revokePageHistory('Location');\n  LocationField.setAttribute('displayed', 'false');\n  locationRefreshTimer_streaming = false;\n  openPreviousPage();\n}\n\nexport function stretchLocationItem(thisItemElement: HTMLElement): void {\n  const itemBodyElement = elementQuerySelector(thisItemElement, '.css_location_group_item_body');\n\n  const itemsElement = thisItemElement.parentElement as HTMLElement;\n\n  const elementsBelowItemElement = getElementsBelow(thisItemElement, 'css_location_group_item');\n  const elementsBelowLength = elementsBelowItemElement.length;\n\n  const itemsElementRect = itemsElement.getBoundingClientRect();\n  const itemElementRect = thisItemElement.getBoundingClientRect();\n\n  // const itemElementX = itemElementRect.left - itemsElementRect.left;\n  const itemElementY = itemElementRect.top - itemsElementRect.top;\n\n  const stretched = thisItemElement.getAttribute('stretched') === 'true' ? true : false;\n  const animation = thisItemElement.getAttribute('animation') === 'true' ? true : false;\n\n  if (animation) {\n    const pushDirection = stretched ? '2' : '1';\n\n    // Separate the elements from the document flow while keeping its position\n    thisItemElement.setAttribute('stretching', 'true');\n    // itemElement.style.setProperty('--b-cssvar-css-location-group-item-x', `${itemElementX}px`);\n    thisItemElement.style.setProperty('--b-cssvar-css-location-group-item-y', `${itemElementY}px`);\n\n    // Set push direction and push state\n    for (let i = 0; i < elementsBelowLength; i++) {\n      const thisItemElement = elementsBelowItemElement[i];\n      thisItemElement.setAttribute('push-direction', pushDirection);\n      thisItemElement.setAttribute('push-state', '1');\n    }\n\n    thisItemElement.addEventListener(\n      'transitionend',\n      function () {\n        // Reset the push direction and push state\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-direction', '0');\n          thisItemElement.setAttribute('push-state', '0');\n        }\n        // Deposit the element\n        thisItemElement.setAttribute('stretching', 'false');\n      },\n      { once: true }\n    );\n\n    thisItemElement.addEventListener(\n      'transitionstart',\n      function () {\n        // Transition the elements below\n        for (let i = 0; i < elementsBelowLength; i++) {\n          const thisItemElement = elementsBelowItemElement[i];\n          thisItemElement.setAttribute('push-state', '2');\n        }\n      },\n      { once: true }\n    );\n  }\n\n  if (stretched) {\n    if (animation) {\n      itemBodyElement.addEventListener(\n        'transitionend',\n        function () {\n          itemBodyElement.setAttribute('displayed', 'false');\n        },\n        { once: true }\n      );\n    } else {\n      itemBodyElement.setAttribute('displayed', 'false');\n    }\n    thisItemElement.setAttribute('stretched', 'false');\n  } else {\n    itemBodyElement.setAttribute('displayed', 'true');\n    thisItemElement.setAttribute('stretched', 'true');\n  }\n}\n\nexport function switchLocationBodyTab(itemElement: HTMLElement, tabCode: number): void {\n  const itemBodyElement = elementQuerySelector(itemElement, '.css_location_group_item_body');\n  const buttonsElement = elementQuerySelector(itemBodyElement, '.css_location_group_item_buttons');\n  const buttonElements = elementQuerySelectorAll(buttonsElement, '.css_location_group_item_button[highlighted=\"true\"][type=\"tab\"]');\n  for (const t of buttonElements) {\n    t.setAttribute('highlighted', 'false');\n  }\n  elementQuerySelector(buttonsElement, `.css_location_group_item_button[code=\"${tabCode}\"]`).setAttribute('highlighted', 'true');\n  switch (tabCode) {\n    case 0:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'true');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'false');\n      break;\n    case 1:\n      elementQuerySelector(itemElement, '.css_location_group_item_buses').setAttribute('displayed', 'false');\n      elementQuerySelector(itemElement, '.css_location_group_item_bus_arrival_times').setAttribute('displayed', 'true');\n      break;\n    default:\n      break;\n  }\n}\n"],"names":["LocationField","documentQuerySelector","LocationHeadElement","elementQuerySelector","LocationNameElement","LocationNameSpanElement","LocationButtonRightElement","LocationGroupsElement","LocationGroupTabsElement","LocationGroupTabsTrayElement","LocationGroupTabLineTrackElement","LocationGroupTabLineElement","LocationUpdateTimerElement","previousIntegration","previousAnimation","previousSkeletonScreen","locationSliding_initialIndex","locationSliding_targetIndex","locationSliding_groupQuantity","locationSliding_groupStyles","locationSliding_sliding","locationRefreshTimer_baseInterval","locationRefreshTimer_minInterval","locationRefreshTimer_dynamicInterval","locationRefreshTimer_dynamic","locationRefreshTimer_lastUpdate","locationRefreshTimer_nextUpdate","locationRefreshTimer_currentRequestID","locationRefreshTimer_refreshing","locationRefreshTimer_streaming","locationRefreshTimer_streamStarted","currentHashSet_hash","initializeLocationSliding","addEventListener","Math","round","scrollLeft","getSize","passive","event","currentIndex","target","indexDifference","delta","abs","floor","ceil","initialSize","width","offset","targetSize","tabWidth","updateLocationCSS","window","routeSliding_initialIndex","initialGroupStyle","tabLineWidth","self","screen","orientation","groupQuantity","percentage","style","setProperty","toString","handleDataReceivingProgressUpdates","CustomEvent","offsetRatio","detail","progress","stage","document","removeEventListener","generateElementOfItem","itemElement","createElement","classList","add","setAttribute","headElement","rankElement","rankNextSlideElement","rankCurrentSlideElement","appendChild","routeDirectionElement","routeNameElement","capsuleElement","statusElement","nextSlideElement","currentSlideElement","stretchElement","getIconElement","onclick","thisItemElement","itemBodyElement","itemsElement","parentElement","elementsBelowItemElement","getElementsBelow","elementsBelowLength","length","itemsElementRect","getBoundingClientRect","itemElementY","top","stretched","getAttribute","animation","pushDirection","i","once","stretchLocationItem","capsuleSeparatorElement","bodyElement","buttonsElement","busTabButtonElement","busTabIconElement","createTextNode","switchLocationBodyTab","arrivalTabButtonElement","arrivalTabIconElement","saveButtonElement","saveButtonIconElement","notifyButtonElement","notifyButtonIconElement","busesElement","busArrivalTimesElement","generateElementOfGroup","groupElement","detailsElement","detailsBodyElement","generateElementOfTab","element","span","generateElementOfGroupDetailsProperty","propertyElement","iconElement","getBlankIconElement","valueElement","generateElementOfBus","busElement","titleElement","carNumberElement","attributesElement","routeAttributeElement","carStatusAttributeElement","carTypeAttributeElement","generateElementOfBusArrivalTime","busArrivalTimeElement","personalScheduleNameElement","personalScheduleTimeElement","chartElement","updateLocationField","integration","skeletonScreen","_previousIntegration","_previousIntegration2","updateItem","thisElement","thisItem","previousItem","updateStatus","thisElementRect","left","bottom","right","windowWidth","innerWidth","windowHeight","innerHeight","thisHeadElement","thisItemStatusElement","status","code","innerText","text","remove","updateRank","thisRankElement","ranking","updateRouteDirection","route_direction","updateRouteName","route_name","updateBuses","thisItemBodyElement","thisBusesElement","currentBusElements","elementQuerySelectorAll","currentBusElementsQuantity","busesQuantity","buses","difference","fragment","DocumentFragment","p","d","newBusElement","append","busElements","busItem","booleanToString","onThisRoute","carNumber","RouteName","type","updateBusArrivalTimes","thisBusArrivalTimesElement","currentBusArrivalTimeElements","currentBusArrivalTimeElementsQuantity","busArrivalTimesQuantity","busArrivalTimes","newBusArrivalTimeElement","busArrivalTimeElements","busArrivalTimeItem","personalSchedule","name","indexToDay","day","timeObjectToString","period","start","end","innerHTML","chart","updateStretch","updateAnimation","updateSkeletonScreen","updateSaveToFolderButton","thisItemButtonsElement","saveToFolderButtonElement","openSaveToFolder","stopId","routeId","isFolderContentSaved","then","e","updateScheduleNotificationButton","scheduleNotificationButtonElement","openScheduleNotification","time","havingNotifcationSchedules","stopHasNotifcationSchedules","number","compareThings","updateProperty","thisProperty","previousProperty","updateIcon","thisIconElement","setIcon","icon","updateValue","value","itemQuantity","groupedItems","groups","cumulativeOffset","groupKey","getTextWidth","hash","openLocationDetails","LocationName","currentGroupCapacity","groupsFragment","tabsFragment","o","newGroupElement","newTabElement","LocationGroupElements","LocationGroupTabElements","groupIndex","thisLocationGroupElement","currentItemCapacity","LocationGroupItemsElement","newItemElement","LocationGroupItemElements","currentGroupPropertyCapacity","groupPropertyQuantity","properties","thisLocationGroupDetailsElement","thisLocationGroupDetailsBodyElement","newPropertyElement","propertyElements","tabElements","groupElements","thisTabElement","thisGroupElement","itemElements","k","hasOwnProperty","j","refreshLocation","_refreshLocation","apply","arguments","_asyncToGenerator","playing_animation","getSettingOptionValue","refresh_interval_setting","dynamic","baseInterval","generateIdentifier","integrateLocation","updateRate","getUpdateRate","Date","getTime","max","dataUpdateTime","streamLocation","setTimeout","err","promptMessage","openLocation","pushPageHistory","logRecentView","focus","defaultItemQuantity","g_0","g_1","push","key","setUpLocationFieldSkeletonScreen","closePreviousPage","closeLocation","openPreviousPage","tabCode","_step","_iterator","_createForOfIteratorHelper","s","n","done","f"],"ignoreList":[],"sourceRoot":""}