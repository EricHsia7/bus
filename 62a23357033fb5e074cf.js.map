{"version":3,"file":"62a23357033fb5e074cf.js","mappings":"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","sources":["webpack://bus/webpack/universalModuleDefinition","webpack://bus/webpack/runtime/chunk loaded","webpack://bus/webpack/runtime/startup chunk dependencies","webpack://bus/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://bus/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://bus/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://bus/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://bus/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://bus/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://bus/./src/tools/index.ts","webpack://bus/./src/data/analytics/bus-arrival-time/getBusArrivalTimes-worker.ts","webpack://bus/webpack/bootstrap","webpack://bus/webpack/runtime/amd options","webpack://bus/webpack/runtime/define property getters","webpack://bus/webpack/runtime/ensure chunk","webpack://bus/webpack/runtime/get javascript chunk filename","webpack://bus/webpack/runtime/global","webpack://bus/webpack/runtime/hasOwnProperty shorthand","webpack://bus/webpack/runtime/publicPath","webpack://bus/webpack/runtime/importScripts chunk loading","webpack://bus/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"bus\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"bus\"] = factory();\n\telse\n\t\troot[\"bus\"] = factory();\n})(self, () => {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(35).then(next);\n};","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","import { promptMessage } from '../interface/prompt/index';\n\nexport const md5 = require('md5');\nexport const { sha512 } = require('js-sha512');\n\nexport function compareThings(a: any, b: any): boolean {\n  function anyToString(any: any): string {\n    return JSON.stringify({ e: any });\n  }\n  const ax = anyToString(a);\n  const bx = anyToString(b);\n  const length: number = 32;\n  const axLength: number = ax.length;\n  const bxLength: number = bx.length;\n  if (axLength === bxLength) {\n    if (axLength > length || bxLength > length) {\n      const hash_a: string = md5(ax);\n      const hash_b: string = md5(bx);\n\n      let equal: boolean = true;\n      for (let i = 0; i < 8; i++) {\n        const a_i: string = hash_a.charAt(i);\n        const b_i: string = hash_b.charAt(i);\n        if (a_i === b_i) {\n          continue;\n        } else {\n          equal = false;\n          break;\n        }\n      }\n      return equal;\n    } else {\n      if (ax === bx) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  } else {\n    return false;\n  }\n}\n\nexport function generateIdentifier(): string {\n  const chars = [\n    [48, 10], // 0-9: 48 - 57\n    [97, 26], // a-z: 97 - 122\n    [65, 26] // A-Z: 65 - 90\n  ];\n\n  let randomNumber1 = Math.floor(Math.random() * 0x10000000);\n  let randomNumber2 = Math.floor(Math.random() * 0x10000000);\n\n  const result = new Uint8Array(17);\n  result[0] = 95;\n  for (let i = 16; i > 0; i--) {\n    const n = randomNumber2 % 3;\n    const range = chars[n];\n    const code = range[0] + (randomNumber1 % range[1]);\n    result[i] = code;\n    randomNumber1 >>>= 1;\n    randomNumber2 >>>= 1;\n  }\n\n  return String.fromCharCode.apply(null, result);\n}\n\nexport function getNoCacheParameter(interval: number): string {\n  const time = new Date().getTime();\n  const number = (time / interval) | 0;\n  const string = number.toString(16);\n  return string;\n}\n\nexport function isRunningStandalone(): boolean {\n  return window.matchMedia('(display-mode: standalone)').matches;\n}\n\nexport function supportTouch(): boolean {\n  if ('ontouchstart' in window || navigator.maxTouchPoints) {\n    // Touch events are supported\n    return true;\n  } else {\n    // Touch events are not supported\n    return false;\n  }\n}\n\nexport function booleanToString(x: boolean): 'true' | 'false' | 'unsupported' {\n  if (typeof x === 'boolean') {\n    if (x) {\n      return 'true';\n    } else {\n      return 'false';\n    }\n  }\n  return 'unsupported';\n}\n\nexport function hasOwnProperty(x: any, property: string): boolean {\n  if (x === null || x === undefined || typeof x !== 'object' || Array.isArray(x)) {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(x, property);\n}\n\nexport function isValidURL(string: string): boolean {\n  try {\n    new URL(string);\n    return true; // If no error is thrown, it's a valid URL\n  } catch (_) {\n    return false; // Invalid URL\n  }\n}\n\nexport function nearestPowerOf2(x: number): number {\n  return 1 << (31 - Math.clz32(x));\n}\n\nexport function getSubpixelPrecision(): number {\n  return Math.ceil(Math.log2(window.devicePixelRatio || 1));\n}\n","import { hasOwnProperty } from '../../../tools/index';\nimport { PersonalScheduleArray } from '../../personal-schedule/index';\nimport { BusArrivalTimeDataGroupArray, BusArrivalTimes } from './index';\n\ninterface task {\n  personalSchedules: PersonalScheduleArray;\n  busArrivalTimeDataGroups: BusArrivalTimeDataGroupArray;\n  chartWidth: number;\n  chartHeight: number;\n  taskID: string;\n  port: any;\n}\n\nconst taskQueue: Array<task> = [];\nlet isProcessing: boolean = false;\n\n// Setup message handling (works for dedicated or shared workers)\nif ('onconnect' in self) {\n  self.onconnect = function (e) {\n    const port = e.ports[0];\n    port.onmessage = function (event) {\n      const [personalSchedules, busArrivalTimeDataGroups, chartWidth, chartHeight, taskID] = event.data;\n      taskQueue.push({ personalSchedules, busArrivalTimeDataGroups, chartWidth, chartHeight, taskID, port });\n      processWorkerTask();\n    };\n  };\n} else {\n  const port = self;\n  self.onmessage = function (event) {\n    const [personalSchedules, busArrivalTimeDataGroups, chartWidth, chartHeight, taskID] = event.data;\n    taskQueue.push({ personalSchedules, busArrivalTimeDataGroups, chartWidth, chartHeight, taskID, port });\n    processWorkerTask();\n  };\n}\n\nconst fontWeight = 400;\nconst fontSize = 10;\nconst fontFamily: string = \"'Noto Sans TC', sans-serif\";\n\nlet canvas;\nlet ctx;\nlet supportOffscreenCanvas: boolean = false;\nif (typeof OffscreenCanvas !== 'undefined') {\n  canvas = new OffscreenCanvas(64, 64);\n  ctx = canvas.getContext('2d') as OffscreenCanvasRenderingContext2D;\n  ctx.font = `${fontWeight} ${fontSize}px ${fontFamily}`;\n  ctx.textBaseline = 'top';\n  supportOffscreenCanvas = true;\n}\n\n// Main processing function\nfunction processWorkerTask(): void {\n  if (isProcessing || taskQueue.length === 0) return;\n  isProcessing = true;\n\n  // Dequeue the next task\n  const { personalSchedules, busArrivalTimeDataGroups, chartWidth, chartHeight, taskID, port }: task = taskQueue.shift();\n\n  const result: BusArrivalTimes = {};\n\n  // For each personalSchedule, build an SVG graph\n  for (const personalSchedule of personalSchedules) {\n    const startIndex = personalSchedule.period.start.hours * 60 + personalSchedule.period.start.minutes;\n    const endIndex = personalSchedule.period.end.hours * 60 + personalSchedule.period.end.minutes;\n    const barWidth = chartWidth / (endIndex - startIndex);\n    for (const busArrivalTimeDataGroup of busArrivalTimeDataGroups) {\n      if (personalSchedule.days.indexOf(busArrivalTimeDataGroup.day) < 0) {\n        continue;\n      }\n      const statsMax = busArrivalTimeDataGroup.max;\n      const statsArray = busArrivalTimeDataGroup.stats.slice(startIndex, endIndex);\n      const statsArrayLength = statsArray.length;\n\n      // Gridline and labels\n      let verticalGridlineLabels = '';\n      let verticalGridlinePathCommand = '';\n      let verticalGridlineInterval = 0; // minutes\n      if (statsArrayLength / 30 <= 3) {\n        verticalGridlineInterval = 10;\n      } else {\n        verticalGridlineInterval = 30;\n      }\n      const verticalGridlineQuantity = Math.floor(statsArrayLength / verticalGridlineInterval);\n      const verticalGridlineGap = chartWidth / verticalGridlineQuantity;\n      for (let i = verticalGridlineQuantity - 1; i >= 0; i--) {\n        const x = 0.35 / 2 + i * verticalGridlineGap;\n        verticalGridlinePathCommand += ` M${x} 0`;\n        verticalGridlinePathCommand += ` L${x} ${chartHeight}`;\n        // the stroke alignment is \"center\"\n        const labelTime = startIndex + i * verticalGridlineInterval;\n        const labelMinutes = labelTime % 60;\n        const labelHours = (labelTime - labelMinutes) / 60;\n        const label = `${labelHours.toString().padStart(2, '0')}:${labelMinutes.toString().padStart(2, '0')}`;\n        let labelWidth = 30;\n        let labelHeight = 12;\n        if (supportOffscreenCanvas) {\n          const textMeasurement = ctx.measureText(label) as TextMetrics;\n          labelWidth = textMeasurement.width;\n          labelHeight = textMeasurement.actualBoundingBoxDescent;\n        }\n        const y = (chartHeight - labelHeight) / 2;\n        verticalGridlineLabels += `<text x=\"${x + 3}\" y=\"${y}\" transform=\"rotate(-90 ${(x + 3 + x + 3 + labelWidth) / 2} ${(y + y + labelHeight) / 2})\" font-weight=\"${fontWeight}\" font-size=\"${fontSize}\" font-family=\"${fontFamily}\" component=\"label\">${label}</text>`;\n        // rotate(degree x y) x: absolute x of the origin, y: absolute y of the origin, origin: a point around which an element rotates\n      }\n      const verticalGridline = `<path d=\"${verticalGridlinePathCommand}\" fill=\"none\" stroke-width=\"0.35\" component=\"vertical-gridline\"/>`;\n\n      // Bottom line\n      const bottomLinePathCommand = `M0 ${chartHeight} L${chartWidth} ${chartHeight - 0.35 / 2}`;\n      const bottomLine = `<path d=\"${bottomLinePathCommand}\" fill=\"none\" stroke-width=\"0.35\" component=\"bottom-line\"/>`;\n\n      // Bars\n      let barsPathCommand = '';\n      barsPathCommand += `M${chartWidth} ${chartHeight}`;\n      if (statsMax !== 0) {\n        for (let j = statsArrayLength - 1; j >= 0; j--) {\n          const x = ((j + 1) / statsArrayLength) * chartWidth; // Shift right for correct alignment\n          const y = (1 - statsArray[j] / statsMax) * chartHeight;\n          barsPathCommand += ` L${x} ${y}`;\n          barsPathCommand += ` L${x - barWidth} ${y}`;\n          barsPathCommand += ` L${x - barWidth} ${chartHeight}`;\n        }\n      }\n      barsPathCommand += ' Z';\n      const bars = `<path d=\"${barsPathCommand}\" stroke=\"none\" stroke-width=\"0\" component=\"bars\"/>`;\n\n      const svg = `<svg width=\"${chartWidth}\" height=\"${chartHeight}\" viewBox=\"0 0 ${chartWidth} ${chartHeight}\" xmlns=\"http://www.w3.org/2000/svg\">${verticalGridline}${verticalGridlineLabels}${bottomLine}${bars}</svg>`;\n      const stopKey = `s_${busArrivalTimeDataGroup.id}`;\n      if (!hasOwnProperty(result, stopKey)) {\n        result[stopKey] = [];\n      }\n      result[stopKey].push({\n        personalSchedule: personalSchedule,\n        chart: svg,\n        day: busArrivalTimeDataGroup.day\n      });\n    }\n  }\n\n  // Send the complete HTML back to the main thread\n  port.postMessage([result, taskID]);\n\n  isProcessing = false;\n  processWorkerTask(); // Process next task in the queue if any\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [35], () => (__webpack_require__(3525)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","__webpack_require__.amdO = {};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and chunks that the entrypoint depends on\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + \"a6b82cb50ce1f17099de\" + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"./\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t525: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkbus\"] = self[\"webpackChunkbus\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["root","factory","exports","module","define","amd","self","deferred","next","_arrayLikeToArray","r","a","length","e","n","Array","_slicedToArray","isArray","l","t","Symbol","iterator","i","u","f","o","call","Object","done","push","value","toString","slice","constructor","name","from","test","TypeError","require","sha512","hasOwnProperty","x","property","_typeof","prototype","taskQueue","isProcessing","onconnect","port","ports","onmessage","event","_event$data","data","personalSchedules","busArrivalTimeDataGroups","chartWidth","chartHeight","taskID","processWorkerTask","_event$data2","canvas","ctx","fontFamily","supportOffscreenCanvas","_taskQueue$shift","shift","result","personalSchedule","startIndex","period","start","hours","minutes","endIndex","end","barWidth","busArrivalTimeDataGroup","days","indexOf","day","statsMax","max","statsArray","stats","statsArrayLength","verticalGridlineLabels","verticalGridlinePathCommand","verticalGridlineInterval","verticalGridlineQuantity","Math","floor","verticalGridlineGap","labelTime","labelMinutes","label","padStart","labelWidth","labelHeight","textMeasurement","measureText","width","actualBoundingBoxDescent","y","verticalGridline","bottomLine","barsPathCommand","j","svg","stopKey","id","chart","postMessage","OffscreenCanvas","getContext","font","textBaseline","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","__webpack_exports__","O","amdO","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","keys","every","key","splice","d","definition","defineProperty","enumerable","get","chunkId","Promise","all","reduce","promises","g","globalThis","this","Function","window","obj","prop","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","then"],"sourceRoot":""}