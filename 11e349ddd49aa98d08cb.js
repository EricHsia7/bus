"use strict";(self.webpackChunkbus=self.webpackChunkbus||[]).push([[5239],{1351(t,e,i){i.d(e,{ID:()=>L,k9:()=>k,qp:()=>_});var a=i(467),n=i(8011),r=i(6788),s=i(6983),d=i(3459),o=i(8179),u=i(8024),l=i(9469),c=i(4537),p=i(904),h=i(9119),v=i(8279),f={},m=!1,g=!1,b=(0,o.bv)(".ik"),y=(0,o.aI)(b,".nk"),A=(0,o.aI)(y,".ok");function I(){var t=document.createElement("div");t.classList.add("pk");var e=document.createElement("div");e.classList.add("qk"),e.appendChild((0,c.oC)()),t.appendChild(e);var i=document.createElement("div");return i.classList.add("rk"),t.appendChild(i),{element:t,id:""}}function j(t,e,i){function a(t,a,n){function r(t,e){var i=(0,o.aI)(t,".qk");(0,c.yD)(i,e.icon)}function s(t,e){(0,o.aI)(t,".rk").innerText=e.name}function d(t,e){t.onclick=e.action}function l(t,e){t.setAttribute("animation",(0,u.xZ)(e))}function p(t,e){t.setAttribute("skeleton-screen",(0,u.xZ)(e))}null==n?(r(t,a),s(t,a),d(t,a),l(t,i),p(t,e)):(n.key!==a.key&&(r(t,a),s(t,a),d(t,a)),i!==m&&l(t,i),e!==g&&p(t,e))}var n=t.actions,r=t.actionsQuantity,s=(0,o.jg)(A,".pk").length;if(r!==s){var d=s-r;if(d<0){for(var l=new DocumentFragment,p=0,h=Math.abs(d);p<h;p++){var v=I();l.appendChild(v.element)}A.append(l)}else for(var b=(0,o.jg)(A,".pk"),y=0,j=Math.abs(d);y<j;y++){b[s-1-y].remove()}}for(var C=(0,o.jg)(A,".pk"),L=0;L<r;L++){var k=C[L],x=n[L];if(f.hasOwnProperty("actions"))if(f.actions[L])a(k,x,f.actions[L]);else a(k,x,null);else a(k,x,null)}f=t,m=i,g=e}function C(){return(C=(0,a.A)(function*(t){var e=(0,d.Js)("playing_animation"),i=(0,u.zx)();j(yield(0,s.v)(t,i),!1,e)})).apply(this,arguments)}function L(t){(0,p.WR)("LocationDetails"),b.setAttribute("displayed","true"),function(){for(var t=(0,d.Js)("playing_animation"),e=[],i=0;i<3;i++)e.push({name:"",icon:"",key:`action-${i}`,action:function(){}});j({actions:e,actionsQuantity:3,hash:""},!0,t)}(),function(t){C.apply(this,arguments)}(t)}function k(t){return x.apply(this,arguments)}function x(){return(x=(0,a.A)(function*(t){var e=(0,u.zx)(),i=yield(0,n.g)(e,1);(0,r.LQ)(e),(0,r.gC)(e);var a=`ml_${t}`;if(i.hasOwnProperty(a)){var s=i[a],d=(0,l.i)(1,{hash:t});navigator.share&&navigator.share({title:s.n,url:d}).then(function(){(0,h.a)("check_circle","已分享地點")}).catch(function(t){(0,h.a)("cancel","已取消分享")})}})).apply(this,arguments)}function _(t){return w.apply(this,arguments)}function w(){return(w=(0,a.A)(function*(t){var e=(0,u.zx)(),i=yield(0,n.g)(e,1);(0,r.LQ)(e),(0,r.gC)(e);var a=`ml_${t}`;if(i.hasOwnProperty(a)){var s=(0,l.i)(1,{hash:t});(0,v.X8)(s)}})).apply(this,arguments)}},2174(t,e,i){i.d(e,{Sv:()=>D});var a=i(467),n=i(5767),r=i(365),s=i(77),d=i(3459),o=i(8179),u=i(8024),l=i(4537),c=i(904),p=i(9119),h=(0,o.bv)(".o"),v=(0,o.aI)(h,".p"),f=(0,o.aI)(v,".q"),m=(0,o.aI)(f,".r"),g=(0,o.aI)(h,".s"),b=(0,o.aI)(g,".t"),y={},A=!1,I=15e3,j=5e3,C=15e3,L=!0,k=0,x=0,_="",w=!1,E=!1,T=!1;function $(t){var e=t;if(w){var i=e.detail.progress-1;m.style.setProperty("--w",i.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,$)}function S(){var t=(0,u.zx)(),e=document.createElement("div");e.classList.add("x"),e.id=t;var i=document.createElement("div");i.classList.add("y"),e.appendChild(i);var a=document.createElement("div");a.classList.add("z");var n=document.createElement("div");n.classList.add("_"),a.appendChild(n);var r=document.createElement("div");r.classList.add("aa"),a.appendChild(r);var s=document.createElement("div");s.classList.add("ba"),a.appendChild(s);var d=document.createElement("div");d.classList.add("ca");var o=document.createElement("span");return o.appendChild((0,l.YC)("close")),d.appendChild(o),a.appendChild(d),e.appendChild(a),{element:e,id:t}}function M(t,e,i){function a(t,a,n){function r(t,e){(0,o.aI)(t,".y").innerText=e.hours}function s(t,e){var i=(0,o.aI)(t,".z");(0,o.aI)(i,"._").innerText=e.minutes}function d(t,e){var i=(0,o.aI)(t,".z");(0,o.aI)(i,".ba").innerText=e.name}function l(t,e){var i=(0,o.aI)(t,".z");(0,o.aI)(i,".aa").innerText=`${e.route.name} - 往${e.route.direction}`}function c(t,e){var i=(0,o.aI)(t,".z");(0,o.aI)(i,".ca").onclick=function(){!function(t,e){R.apply(this,arguments)}(t.id,e.schedule_id)}}function p(t,e){t.setAttribute("first",(0,u.xZ)(e.is_first))}function h(t,e){t.setAttribute("animation",(0,u.xZ)(e))}function v(t,e){t.setAttribute("skeleton-screen",(0,u.xZ)(e))}null==n?(r(t,a),s(t,a),d(t,a),l(t,a),c(t,a),p(t,a),h(t,i),v(t,e)):(a.hours!==n.hours&&r(t,a),a.minutes!==n.minutes&&s(t,a),(0,u.hw)(n.schedule_id,a.schedule_id)||(d(t,a),l(t,a),c(t,a)),n.is_first!==a.is_first&&p(t,a),false!==i&&h(t,i),A!==e&&v(t,e))}var n=t.itemQuantity,r=t.items,s=(0,o.jg)(b,".x").length;if(n!==s){var d=s-n;if(d<0){for(var l=new DocumentFragment,c=0,p=Math.abs(d);c<p;c++){var h=S();l.appendChild(h.element)}b.append(l)}else for(var v=(0,o.jg)(b,".x"),f=0,m=Math.abs(d);f<m;f++){v[s-1-f].remove()}}for(var g=(0,o.jg)(b,".x"),I=0;I<n;I++){var j=g[I],C=r[I];if(y.hasOwnProperty("items"))if(y.items[I])a(j,C,y.items[I]);else a(j,C,null);else a(j,C,null)}y=t,A=e}function Z(){return P.apply(this,arguments)}function P(){return(P=(0,a.A)(function*(){var t=(0,d.Js)("playing_animation"),e=(0,d.Js)("refresh_interval");L=e.dynamic,I=e.baseInterval,w=!0,_=(0,u.zx)(),m.setAttribute("refreshing","true"),m.classList.remove("v"),document.addEventListener(_,$);var i=yield(0,s.e3)(_);M(i,!1,t);var a=0;L&&(a=yield(0,n.wz)()),k=(new Date).getTime(),x=L?Math.max(k+j,i.dataUpdateTime+I/a):k+I,C=Math.max(j,x-k),w=!1,m.setAttribute("refreshing","false"),m.style.setProperty("--u",`${C}ms`),m.classList.add("v")})).apply(this,arguments)}function z(){return O.apply(this,arguments)}function O(){return(O=(0,a.A)(function*(){Z().then(function(){E?setTimeout(function(){z()},Math.max(j,x-(new Date).getTime())):T=!1}).catch(function(t){E?setTimeout(function(){z()},1e4):T=!1})})).apply(this,arguments)}function D(){(0,c.WR)("NotificationScheduleManager"),h.setAttribute("displayed","true"),function(){for(var t=(0,d.Js)("playing_animation"),e=(0,c.gO)("window"),i=(e.width,e.height),a=Math.floor(i/50)+5,n=[],r=0;r<a;r++)n.push({name:"",stop_id:0,estimate_time:0,schedule_id:"null",scheduled_time:0,route:{name:"",direction:"",id:0,pathAttributeId:[]},is_first:!0,date:"",hours:"",minutes:""});M({items:n,itemQuantity:a,dataUpdateTime:0},!0,t)}(),E||(E=!0,T?Z():(T=!0,z())),(0,c.Z_)()}function R(){return(R=(0,a.A)(function*(t,e){if((0,p.a)("manufacturing","處理中"),yield(0,r.G)(e)){if((0,o.aI)(b,`.x#${t}`).remove(),(0,p.a)("check_circle","已取消通知"),!w){var i=(0,d.Js)("playing_animation");M(yield(0,s.e3)(_),!1,i)}}else(0,p.a)("error","取消失敗")})).apply(this,arguments)}},3030(t,e,i){i.d(e,{so:()=>ot});var a=i(467),n=i(5767),r=i(9566),s=i(2757),d=i(77),o=i(5314),u=i(3459),l=i(8179),c=i(7968),p=i(8024),h=i(5579),v=i(4537),f=i(904),m=i(9119),g=i(3041),b=i(752),y=i(1351);function A(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return I(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?I(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,d=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){d=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(d)throw r}}}}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=Array(e);i<e;i++)a[i]=t[i];return a}var j=(0,l.bv)(".dh"),C=(0,l.aI)(j,".kh"),L=(0,l.aI)(C,".oh"),k=(0,l.aI)(L,"span"),x=(0,l.aI)(C,".nh"),_=(0,l.aI)(j,".zh"),w=(0,l.aI)(C,".qh"),E=(0,l.aI)(w,".rh"),T=(0,l.aI)(C,".uh"),$=(0,l.aI)(T,".vh"),S=(0,l.aI)(C,".wh .xh"),M={},Z=!1,P=!1,z=0,O=0,D={},R=0,N=!1,Q=15e3,q=5e3,J=15e3,H=!0,W=0,Y=0,B="",F=!1,U=!1,X=!1,G="";function K(t,e,i,a){_.style.setProperty("--ch",t.toString()),$.style.setProperty("--fh",i.toString()),E.style.setProperty("--gh",`${e.toString()}px`),E.style.setProperty("--hh",a.toString())}function V(t){var e=t;if(F){var i=e.detail.progress-1;S.style.setProperty("--ih",i.toString())}"end"===e.detail.stage&&document.removeEventListener(e.detail.target,V)}function tt(){var t=(0,p.zx)(),e=document.createElement("div");e.classList.add("ji"),e.id=t,e.setAttribute("stretched","false"),e.setAttribute("stretching","false"),e.setAttribute("push-direction","0"),e.setAttribute("push-state","0");var i=document.createElement("div");i.classList.add("ki");var a=document.createElement("div");a.classList.add("li");var n=document.createElement("div");n.classList.add("ni"),n.setAttribute("code","-1"),n.setAttribute("displayed","false");var r=document.createElement("div");r.classList.add("oi"),r.setAttribute("code","-1"),r.setAttribute("displayed","true"),a.appendChild(n),a.appendChild(r);var s=document.createElement("div");s.classList.add("yi");var d=document.createElement("div");d.classList.add("zi");var o=document.createElement("div");o.classList.add("_i");var u=document.createElement("div");u.classList.add("cj");var c=document.createElement("div");c.classList.add("tg"),c.setAttribute("code","0"),c.setAttribute("displayed","false");var h=document.createElement("div");h.classList.add("ug"),h.setAttribute("code","0"),h.setAttribute("displayed","true"),u.appendChild(c),u.appendChild(h);var f=document.createElement("div");f.classList.add("bj"),f.appendChild((0,v.YC)("keyboard_arrow_down")),f.onclick=function(){!function(t){var e=(0,l.aI)(_,`._h .ii .ji#${t}`),i=(0,l.aI)(e,".dj"),a=e.parentElement,n=(0,l.ji)(e,"ji"),r=n.length,s=a.getBoundingClientRect(),d=e.getBoundingClientRect(),o=d.top-s.top,u="true"===e.getAttribute("stretched"),c="true"===e.getAttribute("animation");if(c){var p=u?"2":"1";e.setAttribute("stretching","true"),e.style.setProperty("--hi",`${o}px`);for(var h=0;h<r;h++){var v=n[h];v.setAttribute("push-direction",p),v.setAttribute("push-state","1")}e.addEventListener("transitionend",function(){for(var t=0;t<r;t++){var i=n[t];i.setAttribute("push-direction","0"),i.setAttribute("push-state","0")}e.setAttribute("stretching","false")},{once:!0}),e.addEventListener("transitionstart",function(){for(var t=0;t<r;t++){n[t].setAttribute("push-state","2")}},{once:!0})}u?(c?i.addEventListener("transitionend",function(){i.setAttribute("displayed","false")},{once:!0}):i.setAttribute("displayed","false"),e.setAttribute("stretched","false")):(i.setAttribute("displayed","true"),e.setAttribute("stretched","true"))}(t)};var m=document.createElement("div");m.classList.add("aj"),o.appendChild(u),o.appendChild(f),o.appendChild(m),i.appendChild(a),i.appendChild(s),i.appendChild(d),i.appendChild(o);var g=document.createElement("div");g.classList.add("dj"),g.setAttribute("displayed","false");var b=document.createElement("div");b.classList.add("ej");var y=document.createElement("div");y.classList.add("fj"),y.setAttribute("highlighted","true"),y.setAttribute("type","tab"),y.setAttribute("code","0");var A=document.createElement("div");A.classList.add("ij"),A.appendChild((0,v.YC)("directions_bus")),y.appendChild(A),y.appendChild(document.createTextNode("公車")),y.onclick=function(){ut(t,0)};var I=document.createElement("div");I.classList.add("fj"),I.setAttribute("highlighted","false"),I.setAttribute("type","tab"),I.setAttribute("code","1");var j=document.createElement("div");j.classList.add("ij"),j.appendChild((0,v.YC)("departure_board")),I.appendChild(j),I.appendChild(document.createTextNode("抵達時間")),I.onclick=function(){ut(t,1)};var C=document.createElement("div");C.classList.add("fj"),C.setAttribute("highlighted","false"),C.setAttribute("type","save-to-folder");var L=document.createElement("div");L.classList.add("ij"),L.appendChild((0,v.YC)("folder")),C.appendChild(L),C.appendChild(document.createTextNode("儲存"));var k=document.createElement("div");k.classList.add("fj"),k.setAttribute("highlighted","false"),k.setAttribute("type","schedule-notification"),k.setAttribute("enabled","true");var x=document.createElement("div");x.classList.add("ij"),x.appendChild((0,v.YC)("notifications")),k.appendChild(x),k.appendChild(document.createTextNode("通知")),b.appendChild(y),b.appendChild(I),b.appendChild(C),b.appendChild(k);var w=document.createElement("div");w.classList.add("jj"),w.setAttribute("displayed","true");var E=document.createElement("div");return E.classList.add("kj"),E.setAttribute("displayed","false"),g.appendChild(b),g.appendChild(w),g.appendChild(E),e.appendChild(i),e.appendChild(g),{element:e,id:t}}function et(){var t=document.createElement("div");t.classList.add("_h");var e=document.createElement("div");e.classList.add("ai");var i=document.createElement("div");i.classList.add("bi"),e.appendChild(i);var a=document.createElement("div");return a.classList.add("ii"),t.appendChild(e),t.appendChild(a),{element:t,id:""}}function it(){var t=document.createElement("div");t.classList.add("sh");var e=document.createElement("span");return t.appendChild(e),{element:t,id:""}}function at(){var t=document.createElement("div");t.classList.add("di");var e=document.createElement("div");e.classList.add("ei"),e.appendChild((0,v.oC)());var i=document.createElement("div");return i.classList.add("fi"),t.appendChild(e),t.appendChild(i),{element:t,id:""}}function nt(t,e,i){var a,n;function s(t,a,n){function s(t,e,i){var a=t.getBoundingClientRect(),n=a.top,r=a.left,s=a.bottom,d=a.right,o=window.innerWidth,u=window.innerHeight,c=(0,l.aI)(t,".ki"),p=(0,l.aI)(c,".cj"),h=(0,l.aI)(p,".tg"),v=(0,l.aI)(p,".ug");h.setAttribute("code",e.status.code.toString()),h.innerText=e.status.text,i&&s>0&&n<u&&d>0&&r<o?(v.addEventListener("animationend",function(){v.setAttribute("code",e.status.code.toString()),v.innerText=e.status.text,v.classList.remove("wg"),h.setAttribute("displayed","false")},{once:!0}),h.setAttribute("displayed","true"),v.classList.add("wg")):(v.setAttribute("code",e.status.code.toString()),v.innerText=e.status.text)}function o(t,e,i){var a=t.getBoundingClientRect(),n=a.top,r=a.left,s=a.bottom,d=a.right,o=window.innerWidth,u=window.innerHeight,c=(0,l.aI)(t,".ki"),p=(0,l.aI)(c,".li"),h=(0,l.aI)(p,".ni"),v=(0,l.aI)(p,".oi");h.setAttribute("code",e.ranking.code.toString()),h.innerText=e.ranking.text,i&&s>0&&n<u&&d>0&&r<o?(v.addEventListener("animationend",function(){v.setAttribute("code",e.ranking.code.toString()),v.innerText=e.ranking.text,v.classList.remove("xi"),h.setAttribute("displayed","false")},{once:!0}),h.setAttribute("displayed","true"),v.classList.add("xi")):(v.setAttribute("code",e.ranking.code.toString()),v.innerText=e.ranking.text)}function u(t,e){var i=(0,l.aI)(t,".ki");(0,l.aI)(i,".yi").innerText=e.route_direction}function c(t,e){var i=(0,l.aI)(t,".ki");(0,l.aI)(i,".zi").innerText=e.route_name}function f(t,e){var i=(0,l.aI)(t,".dj");(0,l.aI)(i,".jj").innerHTML=0===e.buses.length?'<div class="dk">目前沒有公車可顯示</div>':e.buses.map(function(t){return`<div class="lj" on-this-route="${t.onThisRoute}"><div class="oj"><div class="qj">${(0,v.Zf)("directions_bus")}</div><div class="sj">${t.carNumber}</div></div><div class="vj"><div class="zj">路線：${t.RouteName}</div><div class="_j">狀態：${t.status.text}</div><div class="ak">類型：${t.type}</div></div></div>`}).join("")}function m(t,e){var i=(0,l.aI)(t,".dj");(0,l.aI)(i,".kj").innerHTML=0===e.busArrivalTimes.length?'<div class="ek">目前沒有抵達時間可顯示</div>':e.busArrivalTimes.map(function(t){return`<div class="mj"><div class="pj"><div class="rj">${(0,v.Zf)("calendar_view_day")}</div><div class="tj">${t.personalSchedule.name}</div><div class="uj">週${(0,h.kd)(t.day).name} ${(0,h.pn)(t.personalSchedule.period.start)} - ${(0,h.pn)(t.personalSchedule.period.end)}</div></div><div class="wj">${t.chart}</div></div>`}).join("")}function y(t,e){e&&t.setAttribute("stretched","false")}function A(t,e){t.setAttribute("animation",(0,p.xZ)(e))}function I(t,e){t.setAttribute("skeleton-screen",(0,p.xZ)(e))}function j(t,e){var i=(0,l.aI)(t,".dj"),a=(0,l.aI)(i,".ej"),n=(0,l.aI)(a,'.fj[type="save-to-folder"]');n.onclick=function(){(0,g.B)("stop-on-location",[t.id,e.stopId,e.routeId])},(0,r.LH)("stop",e.stopId).then(function(t){n.setAttribute("highlighted",(0,p.xZ)(t))})}function C(t,e){var i=(0,l.aI)(t,".dj"),a=(0,l.aI)(i,".ej"),n=(0,l.aI)(a,'.fj[type="schedule-notification"]');n.onclick=function(){(0,b.Ho)("stop-on-location",[t.id,e.stopId,e.routeId,e.status.time])};var r=(0,d.Zc)(e.stopId);n.setAttribute("highlighted",(0,p.xZ)(r))}null==n?(s(t,a,i),o(t,a,i),u(t,a),c(t,a),f(t,a),m(t,a),y(t,e),A(t,i),I(t,e),j(t,a),C(t,a)):(a.status.time!==n.status.time&&(s(t,a,i),C(t,a)),n.ranking.number===a.ranking.number&&n.ranking.code===a.ranking.code||o(t,a,i),n.stopId!==a.stopId&&(u(t,a),c(t,a),j(t,a)),(0,p.hw)(n.buses,a.buses)||f(t,a),(0,p.hw)(n.busArrivalTimes,a.busArrivalTimes)||m(t,a),i!==Z&&A(t,i),e!==P&&(y(t,e),I(t,e)))}function o(t,a,n){function r(t,e){var i=(0,l.aI)(t,".ei");(0,v.yD)(i,e.icon)}function s(t,e){(0,l.aI)(t,".fi").innerHTML=e.value}function d(t,e){t.setAttribute("animation",(0,p.xZ)(e))}function o(t,e){t.setAttribute("skeleton-screen",(0,p.xZ)(e))}null==n?(r(t,a),s(t,a),d(t,i),o(t,e)):((0,p.hw)(n.icon,a.icon)||r(t,a),(0,p.hw)(n.value,a.value)||s(t,a),i!==Z&&d(t,i),e!==P&&o(t,e))}var u=(0,f.gO)("window"),m=u.width,A=u.height,I=t.groupQuantity,j=t.itemQuantity,C=t.groupedItems,$=t.groups;O=I,R=m;for(var S=0,Q=0;Q<I;Q++){var q=`g_${Q}`,J=(0,c.q_)($[q].name,500,"17px",'"Noto Sans TC", sans-serif')+20;D[q]={width:J,offset:S},S+=J}if(D[`g_${I}`]={width:0,offset:S},!N){var H=D[`g_${z}`],W=-1*H.offset+.5*R-.5*H.width,Y=H.width-20;K(O,W,Y,z)}(null===(a=M)||void 0===a?void 0:a.hash)!==t.hash&&(x.onclick=function(){(0,y.ID)(t.hash)}),(null===(n=M)||void 0===n?void 0:n.LocationName)!==t.LocationName&&(k.innerText=t.LocationName),Z!==i&&(L.setAttribute("animation",(0,p.xZ)(i)),w.setAttribute("animation",(0,p.xZ)(i))),P!==e&&(L.setAttribute("skeleton-screen",(0,p.xZ)(e)),w.setAttribute("skeleton-screen",(0,p.xZ)(e)),T.setAttribute("skeleton-screen",(0,p.xZ)(e)));var B=(0,l.jg)(_,"._h").length;if(I!==B){var F=B-I;if(F<0){for(var U=new DocumentFragment,X=new DocumentFragment,G=0,V=Math.abs(F);G<V;G++){var nt=et();U.appendChild(nt.element);var rt=it();X.appendChild(rt.element)}_.append(U),E.append(X)}else for(var st=(0,l.jg)(_,"._h"),dt=(0,l.jg)(E,".sh"),ot=0,ut=Math.abs(F);ot<ut;ot++){var lt=B-1-ot;st[lt].remove(),dt[lt].remove()}}for(var ct=(0,l.jg)(_,"._h"),pt=0;pt<I;pt++){var ht=`g_${pt}`,vt=ct[pt],ft=(0,l.jg)(vt,".ii .ji").length;if(j[ht]!==ft){var mt=ft-j[ht];if(mt<0)for(var gt=(0,l.aI)(vt,".ii"),bt=0,yt=Math.abs(mt);bt<yt;bt++){var At=tt();gt.appendChild(At.element)}else for(var It=(0,l.jg)(vt,".ii .ji"),jt=0,Ct=Math.abs(mt);jt<Ct;jt++){It[ft-1-jt].remove()}}var Lt=(0,l.jg)((0,l.jg)(_,"._h")[pt],".ai .bi .di").length,kt=$[ht].properties.length;if(kt!==Lt){var xt=Lt-kt;if(xt<0)for(var _t=(0,l.aI)(vt,".ai"),wt=(0,l.aI)(_t,".bi"),Et=0,Tt=Math.abs(xt);Et<Tt;Et++){var $t=at();wt.appendChild($t.element)}else for(var St=(0,l.aI)(vt,".ai"),Mt=(0,l.aI)(St,".bi"),Zt=(0,l.jg)(Mt,".di"),Pt=0,zt=Math.abs(xt);Pt<zt;Pt++){Zt[Lt-1-Pt].remove()}}}for(var Ot=(0,l.jg)(E,".sh"),Dt=(0,l.jg)(_,"._h"),Rt=0;Rt<I;Rt++){var Nt=`g_${Rt}`,Qt=Ot[Rt];(0,l.aI)(Qt,"span").innerText=$[Nt].name,Qt.style.setProperty("--eh",`${D[Nt].width}px`),Qt.style.setProperty("--th",Rt.toString());for(var qt=Dt[Rt],Jt=(0,l.jg)(qt,".ai .bi .di"),Ht=(0,l.jg)(qt,".ii .ji"),Wt=$[Nt].properties.length,Yt=0;Yt<Wt;Yt++){var Bt=$[Nt].properties[Yt],Ft=Jt[Yt];if(M.hasOwnProperty("groups"))if(M.groups.hasOwnProperty(Nt))if(M.groups[Nt].properties[Yt])o(Ft,Bt,M.groups[Nt].properties[Yt]);else o(Ft,Bt,null);else o(Ft,Bt,null);else o(Ft,Bt,null)}for(var Ut=0;Ut<j[Nt];Ut++){var Xt=Ht[Ut],Gt=C[Nt][Ut];if(M.hasOwnProperty("groupedItems"))if(M.groupedItems.hasOwnProperty(Nt))if(M.groupedItems[Nt][Ut])s(Xt,Gt,M.groupedItems[Nt][Ut]);else s(Xt,Gt,null);else s(Xt,Gt,null);else s(Xt,Gt,null)}}M=t,Z=i,P=e}function rt(){return st.apply(this,arguments)}function st(){return(st=(0,a.A)(function*(){var t=(0,u.Js)("playing_animation"),e=(0,u.Js)("refresh_interval"),i=(0,f.gO)("location-bus-arrival-time-chart");H=e.dynamic,Q=e.baseInterval,F=!0,B=(0,p.zx)(),S.setAttribute("refreshing","true"),S.classList.remove("yh"),document.addEventListener(B,V);var a=yield(0,s.R)(G,i.width,i.height,B);nt(a,!1,t);var r=0;H&&(r=yield(0,n.wz)()),W=(new Date).getTime(),Y=H?Math.max(W+q,a.dataUpdateTime+Q/r):W+Q,J=Math.max(q,Y-W),F=!1,S.setAttribute("refreshing","false"),S.style.setProperty("--jh",`${J}ms`),S.classList.add("yh")})).apply(this,arguments)}function dt(){rt().then(function(){U?setTimeout(function(){dt()},Math.max(q,Y-(new Date).getTime())):X=!1}).catch(function(t){U?((0,m.a)("error","地點網路連線中斷，將在10秒後重試。"),setTimeout(function(){dt()},1e4)):X=!1})}function ot(t){(0,f.WR)("Location"),(0,o.XK)("location",t),G=t,z=0,D={},j.setAttribute("displayed","true"),_.scrollLeft=0,_.focus(),function(t){for(var e=(0,u.Js)("playing_animation"),i=(0,f.gO)("window"),a=(i.width,i.height),n={g_0:Math.floor(a/50)+5,g_1:Math.floor(a/50)+5},r={},s=0;s<2;s++){var d=`g_${s}`;r[d]=[];for(var o=0;o<n[d];o++)r[d].push({route_name:"",route_direction:"",routeId:0,stopId:0,status:{code:8,text:"",time:-6},ranking:{number:0,text:"--",code:-1},buses:[],busArrivalTimes:[]})}nt({groupedItems:r,groupQuantity:2,groups:{g_0:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]},g_1:{name:"載入中",properties:[{key:"0",icon:"",value:""},{key:"1",icon:"",value:""},{key:"2",icon:"",value:""}]}},itemQuantity:n,LocationName:"載入中",hash:t,dataUpdateTime:0},!0,e)}(t),U||(U=!0,X?rt():(X=!0,dt())),(0,f.Z_)()}function ut(t,e){var i,a=(0,l.aI)(_,`._h .ii .ji#${t}`),n=(0,l.aI)(a,".dj"),r=(0,l.aI)(n,".ej"),s=A((0,l.jg)(r,'.fj[highlighted="true"][type="tab"]'));try{for(s.s();!(i=s.n()).done;){i.value.setAttribute("highlighted","false")}}catch(t){s.e(t)}finally{s.f()}switch((0,l.aI)(r,`.fj[code="${e}"]`).setAttribute("highlighted","true"),e){case 0:(0,l.aI)(a,".jj").setAttribute("displayed","true"),(0,l.aI)(a,".kj").setAttribute("displayed","false");break;case 1:(0,l.aI)(a,".jj").setAttribute("displayed","false"),(0,l.aI)(a,".kj").setAttribute("displayed","true")}}},5693(t,e,i){i.d(e,{Xy:()=>j,bF:()=>I});var a=i(3453),n=i(467),r=i(5352),s=i(8179),d=i(5579),o=i(904),u=(0,s.bv)(".da"),l=(0,s.aI)(u,".ea"),c=(0,s.aI)(u,".fa"),p=(0,s.aI)(c,".ga"),h=(0,s.aI)(l,".ha"),v=(0,s.aI)(h,'.ia[group="schedule-name"] .ja input'),f=(0,s.aI)(h,'.ia[group="schedule-start-time"] .ja input'),m=(0,s.aI)(h,'.ia[group="schedule-end-time"] .ja input'),g=(0,s.aI)(h,'.ia[group="schedule-days"] .ja'),b=(0,s.jg)(g,".ka");function y(){return(y=(0,n.A)(function*(t){for(var e=v.value,i=f.value,n=m.value,s=String(i).split(":").map(function(t){return parseInt(t)}),d=(0,a.A)(s,2),o=d[0],u=d[1],l=String(n).split(":").map(function(t){return parseInt(t)}),c=(0,a.A)(l,2),p=c[0],h=c[1],g=[],y=0;y<7;y++){var A=b[y],I=A.getAttribute("highlighted"),C=parseInt(A.getAttribute("day"));"true"===I&&g.push(C)}var L=yield(0,r.qZ)(t);L.name=e,L.days=g,L.period.start.hours=o,L.period.start.minutes=u,L.period.end.hours=p,L.period.end.minutes=h,yield(0,r.nL)(L),j()})).apply(this,arguments)}function A(){return A=(0,n.A)(function*(t){var e=yield(0,r.qZ)(t);v.value=e.name,f.value=(0,d.pn)(e.period.start),m.value=(0,d.pn)(e.period.end);for(var i=0;i<7;i++){var a=b[i];e.days.indexOf(i)>-1?a.setAttribute("highlighted","true"):a.setAttribute("highlighted","false")}p.onclick=function(){!function(t){y.apply(this,arguments)}(t)}}),A.apply(this,arguments)}function I(t){(0,o.WR)("PersonalScheduleEditor"),u.setAttribute("displayed","true"),function(t){A.apply(this,arguments)}(t),(0,o.Z_)()}function j(){u.setAttribute("displayed","false"),(0,o.l$)()}},8279(t,e,i){i.d(e,{X8:()=>o});var a=i(8179),n=i(2648),r=i(904),s=(0,a.bv)("._a"),d=(0,a.aI)(s,".ab");function o(t){(0,r.WR)("QRCode"),s.setAttribute("displayed","true"),function(t){var e=(0,n.$)(t,"M",.5,.3,1,"var(--a)",4);d.innerHTML=e}(t)}}}]);
//# sourceMappingURL=11e349ddd49aa98d08cb.js.map